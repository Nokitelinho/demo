<?xml version="1.0"?>
<QRY:Definitions xmlns:QRY="http://www.ibsplc.com/xibase/persistence/queries" module="mail.mra.gpareporting">
		<!-- Added By prem for findClaimDetails  -->
		<!--modified by A-3447 for AirNZ CR-175  -->
		

	




	<!-- Added by Sandeep for GpaProcessing Begins -->
		<QRY:Definition>
			<QRY:Id>3</QRY:Id>
								<QRY:Source Name="mailtracking.mra.gpareporting.processgpareport" Type="PROCEDURE">
									<![CDATA[
									CALL PKG_MAL_MRA_GPAREPORTING.spr_manproc_mail (
															?,
															?,
															?,
															?,
															?,
															?,
															?,
															?
														    )
									]]>
							</QRY:Source>
		</QRY:Definition>

		<!-- Added by Sandeep ends -->



	<!-- Added by divya for gpa reports  -->
	

	
	



	<QRY:Definition>
	<QRY:Id>8</QRY:Id>
		<QRY:Source Name="mailtracking.mra.gpareporting.listInvoicDetailsBase" Type="NATIVE">
			<![CDATA[

SELECT MALMST.MALIDR,
  GPABLGDTL.UPDGRSWGT AS GRSWGT,
  GPABLGDTL.APLRAT,
  GPABLGDTL.NETAMT,
  BLGMST.DSPWGTUNT UNTCOD,
  GPABLGDTL.DISINCAMT,
  GPABLGDTL.INCAMT,
  GPABLGDTL.UPDNETAMT,
  COALESCE(GPABLGDTL.CTRCURCOD,BLGMST.CURCOD,POADTL.STLCUR) CTRCURCOD,
  BLGMST.CSGDOCNUM,
  MALMST.ORGCOD,
  MALMST.DSTCOD,
  MALMST.MALSUBCLS,
  BLGMST.CMPCOD,
  BLGMST.MALSEQNUM,
  MALMST.MALCLS,
  GPABLGDTL.UPDBILTOOPOA,
  CNTMST.REGCOD,
  BLGDTL.FLTCARCOD CODSHRCAR,
  (BLGDTL.WGTCHGUSD+BLGDTL.OTHCHGUSD) OALAMT,
  MALMST.REQDLVTIM,
  0 CLMLESSFIV,
  0 CLMFIVTOTEN,
  0 CLMTENTOTWENTYFIV,
  0 CLMTWENTYFIVTOFIFTY,
  0 CLMFIFTYTOHUNDRED,
  0 CLMHUNDREDTOFIVHUNDRED,
  0 CLMGRTFIVHUNDRED,
   CASE WHEN (blgmst.dstarpcod='XXX' OR blgmst.orgarpcod='XXX') THEN 0 ELSE 1  END CNTAWTINC,
  case when blgmst.dstarpcod = 'XXX' THEN 1 ELSE 0 end dummydst,
  case when blgmst.orgarpcod = 'XXX' AND blgmst.dstarpcod <> 'XXX' THEN 1 ELSE 0 end dummyorg,
  case when blgmst.penrsncod = 'INVDLVPRT' THEN 1 ELSE 0 end dlvscnwrg,
  BLGMST.FORMJRSTA,
  0 INVAMT,
  0 CLMAMT,

  CASE WHEN blgmst.dstarpcod='XXX' THEN 'DUMMYDST' WHEN blgmst.orgarpcod='XXX' THEN 'DUMMYORG' WHEN blgmst.penrsncod='INVDLVPRT' THEN 'DLVSCNWRG' ELSE 'AWTINC' END prosta,

  'TBR' INVPAYSTA,
  '' CLMSTA,
  GPABLGDTL.INCRMK RMK,
0 VERNUM,
 GPABLGDTL.SERNUM,
  0 TOTSTLAMT
FROM MALMRAGPABLGDTL GPABLGDTL
        INNER JOIN MALMRABLGMST BLGMST
        ON (GPABLGDTL.CMPCOD    = BLGMST.CMPCOD
        AND GPABLGDTL.MALSEQNUM = BLGMST.MALSEQNUM)
        INNER JOIN MALMST MALMST
        ON (GPABLGDTL.CMPCOD    = MALMST.CMPCOD
        AND GPABLGDTL.MALSEQNUM = MALMST.MALSEQNUM)
        INNER JOIN MALPOADTL POADTL
        ON (BLGMST.CMPCOD =POADTL.CMPCOD
AND BLGMST.POACOD          =POADTL.POACOD
        AND POADTL.PARCOD ='STLINFO')
        INNER JOIN MALEXGOFCMST EXGMST
        ON (MALMST.CMPCOD    = EXGMST.CMPCOD
        AND MALMST.ORGEXGOFC = EXGMST.EXGOFCCOD)
        INNER JOIN SHRCNTMST CNTMST
        ON (EXGMST.CMPCOD = CNTMST.CMPCOD
        AND EXGMST.CNTCOD = CNTMST.CNTCOD)
        LEFT OUTER JOIN MALMRABLGDTL BLGDTL
        ON (GPABLGDTL.CMPCOD       = BLGDTL.CMPCOD
        AND GPABLGDTL.MALSEQNUM    = BLGDTL.MALSEQNUM
        AND BLGDTL.PAYFLG          = 'P'
        AND BLGDTL.BILTOOPTYTYP    ='A')
        WHERE GPABLGDTL.BLGSTA     = 'TR'
			]]>
		</QRY:Source>
	</QRY:Definition>

		<QRY:Definition>
	<QRY:Id>9</QRY:Id>
		<QRY:Source Name="mailtracking.mra.gpareporting.listInvoicDetails" Type="NATIVE">
			<![CDATA[

SELECT INCDTL.MALIDR ,
  COALESCE(GPABLGDTL.UPDGRSWGT,0) GRSWGT,
  COALESCE(GPABLGDTL.APLRAT,0) APLRAT,
  COALESCE(GPABLGDTL.NETAMT,0) NETAMT,
  BLGMST.DSPWGTUNT UNTCOD,
  GPABLGDTL.DISINCAMT,
  GPABLGDTL.INCAMT,
  GPABLGDTL.UPDNETAMT,
  COALESCE(GPABLGDTL.CTRCURCOD,BLGMST.CURCOD,POADTL.STLCUR) CTRCURCOD,
  BLGMST.CSGDOCNUM,
  MST.ORGCOD,
  MST.DSTCOD,
  MST.MALSUBCLS,
  BLGMST.CMPCOD,
  BLGMST.MALSEQNUM,
  MST.MALCLS,
  COALESCE(GPABLGDTL.UPDBILTOOPOA,INCDTL.POACOD) UPDBILTOOPOA,
  CNTMST.REGCOD,
  BLGDTL.FLTCARCOD CODSHRCAR,
  (BLGDTL.WGTCHGUSD+BLGDTL.OTHCHGUSD) OALAMT,
  MST.REQDLVTIM,
  SUM(
  CASE
    WHEN INCDTL.UPDCLMAMT <= 5
    THEN 1
    ELSE 0
  END) OVER(PARTITION BY INCDTL.CMPCOD) CLMLESSFIV,
  SUM(
  CASE
    WHEN INCDTL.UPDCLMAMT > 5
    AND INCDTL.UPDCLMAMT <=10
    THEN 1
    ELSE 0
  END) OVER(PARTITION BY INCDTL.CMPCOD) CLMFIVTOTEN,
  SUM(
  CASE
    WHEN INCDTL.UPDCLMAMT > 10
    AND INCDTL.UPDCLMAMT <=25
    THEN 1
    ELSE 0
  END) OVER(PARTITION BY INCDTL.CMPCOD) CLMTENTOTWENTYFIV,
  SUM(
  CASE
    WHEN INCDTL.UPDCLMAMT >25
    AND INCDTL.UPDCLMAMT <=50
    THEN 1
    ELSE 0
  END) OVER(PARTITION BY INCDTL.CMPCOD) CLMTWENTYFIVTOFIFTY,
  SUM(
  CASE
    WHEN INCDTL.UPDCLMAMT > 50
    AND INCDTL.UPDCLMAMT <=100
    THEN 1
    ELSE 0
  END) OVER(PARTITION BY INCDTL.CMPCOD) CLMFIFTYTOHUNDRED,
  SUM(
  CASE
    WHEN INCDTL.UPDCLMAMT > 100
    AND INCDTL.UPDCLMAMT <=500
    THEN 1
    ELSE 0
  END) OVER(PARTITION BY INCDTL.CMPCOD) CLMHUNDREDTOFIVHUNDRED,
  SUM(
  CASE
    WHEN INCDTL.UPDCLMAMT > 501
    THEN 1
    ELSE 0
  END) OVER(PARTITION BY INCDTL.CMPCOD) CLMGRTFIVHUNDRED,
  0 CNTAWTINC,
  0 DUMMYDST,
  0 DUMMYORG,
  0 DLVSCNWRG,
  BLGMST.FORMJRSTA,
]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>9</QRY:Id>
		<QRY:Source Name="mailtracking.mra.gpareporting.listInvoicDetailsJoin1" Type="NATIVE">
			<![CDATA[
 FROM MALMRAGPAINCDTL INCDTL
        INNER JOIN MALMRAGPAINCSTLDTL STLDTL
        ON (INCDTL.CMPCOD    = STLDTL.CMPCOD
AND INCDTL.MALSEQNUM       = STLDTL.MALSEQNUM
        AND INCDTL.SERNUM    = STLDTL.SERNUM)
        INNER JOIN MALMRABLGMST BLGMST
        ON (INCDTL.CMPCOD    = BLGMST.CMPCOD
        AND INCDTL.MALSEQNUM = BLGMST.MALSEQNUM)
        LEFT OUTER JOIN MALMST MST
        ON (BLGMST.CMPCOD    = MST.CMPCOD
        AND BLGMST.MALSEQNUM = MST.MALSEQNUM)
        LEFT OUTER JOIN MALMRAGPABLGDTL GPABLGDTL
        ON (BLGMST.CMPCOD    = GPABLGDTL.CMPCOD
        AND BLGMST.MALSEQNUM = GPABLGDTL.MALSEQNUM)
        

]]>
		</QRY:Source>
	</QRY:Definition>
			<QRY:Definition>
	<QRY:Id>9</QRY:Id>
		<QRY:Source Name="mailtracking.mra.gpareporting.listInvoicDetailsJoin2" Type="NATIVE">
			<![CDATA[
LEFT OUTER JOIN MALMRABLGDTL BLGDTL
        ON (GPABLGDTL.CMPCOD    = BLGDTL.CMPCOD
        AND GPABLGDTL.MALSEQNUM = BLGDTL.MALSEQNUM
        AND BLGDTL.PAYFLG       = 'P'
        AND BLGDTL.BILTOOPTYTYP ='A')
        INNER JOIN MALPOADTL POADTL
        ON (BLGMST.CMPCOD =POADTL.CMPCOD
AND BLGMST.POACOD          =POADTL.POACOD
        AND POADTL.PARCOD ='STLINFO')
        LEFT OUTER JOIN MALEXGOFCMST EXGMST
        ON (MST.CMPCOD    = EXGMST.CMPCOD
        AND MST.ORGEXGOFC = EXGMST.EXGOFCCOD)
        LEFT OUTER JOIN SHRCNTMST CNTMST
        ON (EXGMST.CMPCOD   = CNTMST.CMPCOD
        AND EXGMST.CNTCOD   = CNTMST.CNTCOD)




			]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
						<QRY:Id>10</QRY:Id>
						<QRY:Source Name="mail.mra.gpareporting.savegroupremarks" Type="PROCEDURE">
						<![CDATA[
                              							CALL PKG_MAL_MRA_INVOIC_CALC.SPR_MRA_UPDATE_GRPRMK(
								?,
								?,
								?,
								?,
								?,
								?,
								?,
								?,
								?,
								?,
								?,
								?,
								?,
								?
							)
							]]>
						</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
		<QRY:Id>11</QRY:Id>
		<QRY:Source Name="mail.mra.gpareporting.findinvoiclov" Type="NATIVE">
		<![CDATA[
			   SELECT gpaincmst.INVREFNUM                         ,
			   		  gpaincmst.POACOD                         ,
			   		  gpaincmst.RPTPRDFRM                         ,
			      	  gpaincmst.RPTPRDTOO
					   FROM MALMRAGPAINCMST gpaincmst
						 WHERE gpaincmst.CMPCOD = ?


		]]>
	</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>12</QRY:Id>
		<QRY:Source Name="mailtracking.mra.gpareporting.ux.listInvoic" Type="NATIVE">
			<![CDATA[
			SELECT LISTINV.CMPCOD,
			LISTINV.INVREFNUM,
			LISTINV.PAYTYP,
				LISTINV.FILNAM,
				SUM(LISTINV.NUMMALBAG)NUMMALBAG,
				SUM(LISTINV.TOTINVAMT)TOTINVAMT,
				LISTINV.POACOD POACOD,
				MAX(LISTINV.INVDAT) INVDAT,
				MAX(LISTINV.RPTPRDFRM) RPTPRDFRM,
				MAX(LISTINV.RPTPRDTOO) RPTPRDTOO,
				MAX(LISTINV.LSTUPDUSR) LSTUPDUSR,
				MAX(
				CASE
				  WHEN LISTINV.INVSTA = 'PE'
				  THEN LISTINV.RMK
				  ELSE ''
				END) RMK,
				MAX(LISTINV.INVSTA) INVSTA
			FROM MALMRAGPAINCMST LISTINV
			WHERE LISTINV.CMPCOD=?
			]]>
		</QRY:Source>
	</QRY:Definition>

<QRY:Definition>
<QRY:Id>13</QRY:Id>
		<QRY:Source Name="mail.mra.gpareporting.findbucketwisesums" Type="NATIVE">
			<![CDATA[
	SELECT
SUM(CASE WHEN INCDTL.PROSTA = 'OVRNOTMRA' THEN 1 ELSE 0  END) CNTOVRNOTMRA,
SUM(CASE WHEN INCDTL.PROSTA = 'CLMZROPAY' AND INCDTL.CLMSTA IS NULL THEN 1 ELSE 0  END) CLMZROPAY,
SUM(CASE WHEN INCDTL.PROSTA = 'CLMNOINC' AND INCDTL.CLMSTA IS NULL THEN 1 ELSE 0  END) CLMNOINC,
SUM(CASE WHEN INCDTL.PROSTA = 'CLMRATDIF' AND INCDTL.CLMSTA IS NULL THEN 1 ELSE 0  END) CLMRATDIF,
SUM(CASE WHEN INCDTL.PROSTA = 'CLMWGTDIF' AND INCDTL.CLMSTA IS NULL THEN 1 ELSE 0  END) CLMWGTDIF,
SUM(CASE WHEN INCDTL.PROSTA = 'AMOTOBEACT'  THEN 1 ELSE 0  END) AMOTOBEACT,
SUM(CASE WHEN INCDTL.PROSTA = 'AMOTACT'  THEN 1 ELSE 0  END) AMOTACT,
SUM(CASE WHEN INCDTL.PROSTA = 'CLMMISSCN' AND INCDTL.CLMSTA IS NULL THEN 1 ELSE 0  END) CLMMISSCN,
SUM(CASE WHEN INCDTL.PROSTA = 'CLMLATDLV' AND INCDTL.CLMSTA IS NULL THEN 1 ELSE 0  END) CLMLATDLV,
SUM(CASE WHEN INCDTL.PROSTA = 'CLMSRVRSP' AND INCDTL.CLMSTA IS NULL THEN 1 ELSE 0  END) CLMSRVRSP,
SUM(CASE WHEN INCDTL.PROSTA = 'LATDLV' THEN 1 ELSE 0  END) LATDLV,
SUM(CASE WHEN INCDTL.PROSTA = 'MISORGSCN' THEN 1 ELSE 0  END) MISORGSCN,
SUM(CASE WHEN INCDTL.PROSTA = 'MISDSTSCN' THEN 1 ELSE 0  END) MISDSTSCN,
SUM(CASE WHEN INCDTL.PROSTA = 'FULPAID' THEN 1 ELSE 0  END) FULPAID,
SUM(CASE WHEN INCDTL.PROSTA = 'OVRRATDIF' THEN 1 ELSE 0  END) OVRRATDIF,
SUM(CASE WHEN INCDTL.PROSTA = 'OVRWGTDIF' THEN 1 ELSE 0  END) OVRWGTDIF,
SUM(CASE WHEN INCDTL.PROSTA = 'OVRCLSDIF' THEN 1 ELSE 0  END) OVRCLSDIF,
SUM(CASE WHEN INCDTL.PROSTA = 'OVRSRVRSP' THEN 1 ELSE 0  END) OVRSRVRSP,
SUM(CASE WHEN INCDTL.PROSTA = 'OVROTH' THEN 1 ELSE 0  END) OVROTH,
SUM(CASE WHEN INCDTL.PROSTA = 'OTH' AND INCDTL.CLMSTA IS NULL THEN 1 ELSE 0  END) CLMOTH,
SUM(CASE WHEN INCDTL.PROSTA = 'CLMNOTINV' AND INCDTL.CLMSTA IS NULL THEN 1 ELSE 0  END) CLMNOTINV,
SUM(CASE WHEN INCDTL.PROSTA = 'OVRPAYACP' THEN 1 ELSE 0  END) OVRPAYACP,
SUM(CASE WHEN INCDTL.PROSTA = 'OVRPAYREJ' THEN 1 ELSE 0  END) OVRPAYREJ,
SUM(CASE WHEN INCDTL.PROSTA = 'CLMFRCMJR' AND INCDTL.CLMSTA IS NULL THEN 1 ELSE 0  END) CLMFRCMJR,
SUM(CASE WHEN INCDTL.PROSTA = 'SHRPAYACP' AND INCDTL.CLMSTA IS NULL THEN 1 ELSE 0 END) SHRPAYACP,
SUM(CASE WHEN INCDTL.CLMSTA = 'GEN' THEN 1 ELSE 0 END) CLMSTAGEN,
SUM(CASE WHEN INCDTL.CLMSTA = 'SUB' THEN 1 ELSE 0 END) CLMSTASUB

FROM MALMRAGPAINCDTL INCDTL,MALMRABLGMST MST,MALMRAGPAINCSTLDTL STLDTL
WHERE INCDTL.CMPCOD        = MST.CMPCOD
AND INCDTL.MALSEQNUM=MST.MALSEQNUM
AND INCDTL.CMPCOD          = STLDTL.CMPCOD
AND INCDTL.MALSEQNUM       = STLDTL.MALSEQNUM
--AND INCDTL.SERNUM          = STLDTL.SERNUM
]]>
		</QRY:Source>
	</QRY:Definition>
<QRY:Definition>
<QRY:Id>14</QRY:Id>
		<QRY:Source Name="mailtracking.mra.gpareporting.ux.listgenclaimdtls" Type="NATIVE">
			<![CDATA[
	SELECT
	LISTGCLM.CMPCOD,
	LISTGCLM.POACOD,
	--LISTGCLM.SERNUM,
	LISTGCLM.RPTPRDFRM,
	LISTGCLM.RPTPRDTOO,
	LISTGCLM.TOTCLMAMT,
	LISTGCLM.TOTMALCNT,
	LISTGCLM.CURCOD,
	--LISTGCLM.CLMGENFLG,
	LISTGCLM.CLMSND,
	LISTGCLM.LSTUPDUSR,
	LISTGCLM.LSTUPDTIM
	FROM MALMRAGPACLM LISTGCLM
	WHERE LISTGCLM.CMPCOD=?
	AND LISTGCLM.POACOD=?
	AND   to_date(to_char(LISTGCLM.RPTPRDFRM,'dd-Mon-yyyy'))  >= to_date(?)
	AND   to_date(to_char(LISTGCLM.RPTPRDTOO,'dd-Mon-yyyy')) <= to_date(?)
]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
<QRY:Id>15</QRY:Id>
		<QRY:Source Name="mailtracking.mra.gpareporting.ux.listclaimdtls" Type="NATIVE">
			<![CDATA[
	SELECT
	LISTCLM.CMPCOD,
	LISTCLM.POACOD,
    LISTCLM.MALSEQNUM,
    LISTCLM.MALIDR,
    LISTCLM.RCVDAT,
    LISTCLM.CLMSTA,
	LISTGECLM.RPTPRDFRM,
	LISTGECLM.RPTPRDTOO,
	LISTCLM.CLMTYP,
	LISTCLM.CLMAMT,
	LISTGECLM.CURCOD,
	LISTGECLM.CLMSUBDAT,
	LISTCLM.LSTUPDUSR,
	LISTCLM.LSTUPDTIM,
	LISTGECLM.CLMFILNAM
	FROM MALMRAGPACLM LISTGECLM,MALMRAGPACLMDTL LISTCLM
	WHERE LISTGECLM.CMPCOD=LISTCLM.CMPCOD
	AND LISTGECLM.POACOD=LISTCLM.POACOD
	AND LISTCLM.CLMREFNUM=LISTGECLM.CLMREFNUM
    AND LISTCLM.CMPCOD=?
  	AND  to_number(to_char(LISTGECLM.RPTPRDFRM,'YYYYMMDD')) >=?
	AND to_number(to_char(LISTGECLM.RPTPRDTOO,'YYYYMMDD')) <=?
]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
<QRY:Id>16</QRY:Id>
		<QRY:Source Name="mail.mra.gpareporting.findserialnumberfrominvoic" Type="NATIVE">
			<![CDATA[
	SELECT SERNUM FROM MALMRAGPAINCMST where CMPCOD=? and INVREFNUM=?

]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>19</QRY:Id>
		<QRY:Source Name="mailtracking.mra.gpareporting.processinvoic" Type="PROCEDURE">
		<![CDATA[
			CALL PKG_MAL_MRA_INVOIC_CALC.CREATE_INCPROCESSING_JOB(
				?,
				?,
				?,
				?,
				?,
				?,
				?,
				?,
				?,
				?,
				?,
				?,
				?,
				?
			)
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>20</QRY:Id>
		<QRY:Source Name="mailtracking.mra.gpareporting.processinvoicformails" Type="PROCEDURE">
		<![CDATA[
			CALL PKG_MAL_MRA_INVOIC_CALC.SPR_MRA_PROCESS_INCMSG_MAIL(
				?,
				?,
				?,
				?,
				?,
				?
			)
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>21</QRY:Id>
			<QRY:Source Name="mailtracking.mra.gpareporting.invoicprocesscount" Type="NATIVE">
				<![CDATA[
		SELECT 1 PRCCNT
			FROM MALMRAGPAINCMSGMST
			WHERE PRCSTA = 'IN'
			AND cmpcod   = ?
	]]>
			</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>22</QRY:Id>
		<QRY:Source Name="mailtracking.mra.gpareporting.ux.listInvoicUnion" Type="NATIVE">
			<![CDATA[
			SELECT
				LISTINV.CMPCOD,
			LISTINV.INVREFNUM,
			LISTINV.PAYTYP,
				LISTINV.FILNAM,
				SUM(LISTINV.NUMMALBAG) NUMMALBAG,
				SUM(CASE
				  WHEN LISTINV.TOTINVAMT >0
				  THEN LISTINV.TOTINVAMT
				  ELSE LISTINV.TOTADJAMT
				END) TOTINVAMT,
				LISTINV.POACOD,
				MAX(LISTINV.INVDAT) INVDAT,
				MAX(LISTINV.RPTPRDFRM) RPTPRDFRM,
				MAX(LISTINV.RPTPRDTOO) RPTPRDTOO,
				MAX(LISTINV.LSTUPDUSR) LSTUPDUSR,
				MAX(LISTINV.RMK) RMK,
				MAX(LISTINV.PRCSTA) INVSTA
			FROM MALMRAGPAINCMSGMST LISTINV
			WHERE LISTINV.CMPCOD = ?

			]]>
		</QRY:Source>
	</QRY:Definition>



<QRY:Definition>
		<QRY:Id>23</QRY:Id>
			<QRY:Source Name="mailtracking.mra.gpareporting.checkautoprocessing" Type="NATIVE">
				<![CDATA[
		select Case when splcnt=totcnt then 'Y' ELSE 'N' END  ISAUTOPROCESSING FROM
(SELECT FILNAM, COUNT(splcnt) splcnt,max(TOTSPLCNT) totcnt FROM
MALMRAGPAINCMSGMST WHERE CMPCOD=? and FILNAM=?
GROUP BY FILNAM) QRY
	]]>
			</QRY:Source>
	</QRY:Definition>

   <QRY:Definition>
		<QRY:Id>24</QRY:Id>
		<QRY:Source Name="mailtracking.mra.gpareporting.updatebatchnumber" Type="PROCEDURE">
		<![CDATA[
			CALL PKG_MAL_MRA_INVOIC_CALC.UPDATE_BATCH_NUMBER(
				?,
				?,
				?,
				?,
				?,
				?,
				?,
				?,
				?,
				?,
				?,
				?
			)
			]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
		<QRY:Id>25</QRY:Id>
		<QRY:Source Name="mailtracking.mra.gpareporting.updateinvoicstatus" Type="PROCEDURE">
		<![CDATA[
			CALL PKG_MAL_MRA_INVOIC_CALC.SPR_MRA_UPDATE_INVOIC_STATUS(
				?,
				?,
				?,
				?,
				?
			)
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>26</QRY:Id>
		<QRY:Source Name="mailtracking.mra.gpareporting.processinvoicforinvoice" Type="PROCEDURE">
		<![CDATA[
			CALL PKG_MAL_MRA_INVOIC_CALC.SPR_MRA_PROCESS_INCMSG_INVREF(
				?,
				?,
				?,
				?,
				?,
				?,
				?,
				?,
				?,
				?,
				?,
				?,
				?,
				?,
				?,
				?,
				?,
				?,
				?
			)
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>27</QRY:Id>
		<QRY:Source Name="mailtracking.mra.gpareporting.findInvoicAndClaimDetails" Type="NATIVE">
		<![CDATA[
			SELECT 'I' TYPDAT,
			  DTL.MALIDR,
			  MST.INVREFNUM,
			  DTL.INVAMT,
			  MST.RPTPRDFRM,
			  MST.RPTPRDTOO,
			  MST.PAYTYP,
			  MST.INCTYP,
			  CASE WHEN MST.INVSTA='RV' THEN 'Invoic Deleted' ELSE
			 (CASE
				WHEN MST.INCTYP = 'I'
				THEN
				  (SELECT FLDDES
				  FROM SHRONETIM
				  WHERE CMPCOD = MST.CMPCOD
				  AND FLDTYP   = 'mailtracking.mra.gpareporting.intinvoicpaytype'
				  AND FLDVAL   = trim(LEADING '0' FROM mst.paytyp::TEXT)
				  )
				ELSE
				  (SELECT FLDDES
				  FROM SHRONETIM
				  WHERE CMPCOD = MST.CMPCOD
				  AND FLDTYP   = 'mailtracking.mra.gpareporting.dominvoiccpaytype'
				  AND FLDVAL   = trim(LEADING '0' FROM mst.paytyp::TEXT)
				  )
			  END ) END PAYDES,
			  MST.INVDAT INCRCVDAT,
			  POA.STLCUR,
			  NULL CLMTYP
			FROM MALMRAGPAINCSTLDTL DTL,
			  MALMRAGPAINCMST MST,
			  MALPOADTL POA
			WHERE DTL.CMPCOD  = MST.CMPCOD
			AND DTL.SERNUM    = MST.SERNUM
			AND POA.CMPCOD    = MST.CMPCOD
			AND POA.POACOD    = MST.POACOD
			AND DTL.RCVDAT BETWEEN POA.VLDFRM AND POA.VLDTOO
			AND POA.PARCOD = 'STLINFO'
			AND DTL.CMPCOD    = ?
			AND DTL.MALSEQNUM = ?
			AND DTL.INVREFNUM IS NOT NULL
			UNION ALL
			SELECT 'C' TYPDAT,
			  CLMDTL.MALIDR,
			  CLM.CLMREFNUM INVREFNUM,
			  CLMDTL.CLMAMT INVAMT,
			  CLM.RPTPRDFRM,
			  CLM.RPTPRDTOO,
			  CLMDTL.CLMTYP PAYTYP,
			  NULL,
			  NULL,
			  CLMDTL.RCVDAT,
			  CLM.CURCOD STLCUR,
			  CLMDTL.CLMTYP CLMTYP
			FROM MALMRAGPACLM CLM,
			  MALMRAGPACLMDTL CLMDTL
			WHERE CLM.CMPCOD     = CLMDTL.CMPCOD
			AND CLM.CLMREFNUM    = CLMDTL.CLMREFNUM
			AND CLM.POACOD       = CLMDTL.POACOD
			AND CLMDTL.CMPCOD    = ?
			AND CLMDTL.MALSEQNUM = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
<QRY:Definition>
	 <QRY:Id>26</QRY:Id>
		<QRY:Source Name="mailtracking.mra.gpareporting.saveclaimdetails" Type="PROCEDURE">
		<![CDATA[
			CALL PKG_MAL_MRA_INVOIC_CALC.SPR_MRA_GENERATE_CLAIM(
				?,
				?,
				?,
				?,
				?,
				?,
				?,
				?,
				?
			)
			]]>
		</QRY:Source>
	</QRY:Definition>

<QRY:Definition>
		<QRY:Id>27</QRY:Id>
			<QRY:Source Name="mailtracking.mra.gpareporting.findmailbagsforclaimgeneration" Type="NATIVE">
				<![CDATA[
		SELECT INCDTL.CMPCOD,INCDTL.MALSEQNUM ,INCDTL.INVREFNUM, INCDTL.MALIDR,INCDTL.CLMTYP,INCDTL.UPDCLMAMT CLMAMT,INCDTL.POACOD,INCDTL.MALCLS,INCDTL.ACTRAT,
MSG.SERNUM,
MSG.VERNUM,
MSG.CTLNUM,
MSG.REGCOD,
MSG.REFVERNUM,
MSG.TRKLOC,
MSG.ROUARRDAT,
COALESCE(INCDTL.LODFLTNUM,MSG.ORGFLTNUM) ORGFLTNUM,
COALESCE(INCDTL.LODSCNCARCOD,MSG.ORGCARCOD) ORGCARCOD,
COALESCE(INCDTL.ACPSCNCAR,MSG.POSSCNCAR) POSSCNCAR,
COALESCE(INCDTL.ACTORGCOD,MSG.POSSCNEXPSTE) POSSCNEXPSTE,
--MSG.LODSCANCAR,
COALESCE(INCDTL.LODSCNCARCOD,MSG.LODSCANCAR) LODSCANCAR,
--MSG.LODSCNFLTNUM,
COALESCE(INCDTL.LODFLTNUM,MSG.LODSCNFLTNUM) LODSCNFLTNUM,
COALESCE(INCDTL.LODSCNARPCOD,MSG.LODSCNEXPSTE)LODSCNEXPSTE,
COALESCE(INCDTL.LODSCNDAT,MSG.LODSCNDAT) LODSCNDAT,
MSG.TRFONECAR,
MSG.TRFONEFLTNUM,
MSG.TRFONEEXPSTE,
MSG.TRFONEDAT,
MSG.TRFTWOCAR,
MSG.TRFTWOFLTNUM,
MSG.TRFTWOEXPSTE,
MSG.TRFTWODAT,
MSG.TRFTHRCAR,
MSG.TRFTHRFLTNUM,
MSG.TRFTHREXPSTE,
MSG.TRFTHRDAT,
MSG.TRFFORCAR,
MSG.TRFFORFLTNUM,
MSG.TRFFOREXPSTE,
MSG.TRFFORDAT,
COALESCE(INCDTL.DLVARPCOD,MSG.DLVSCNACTSTE) DLVSCNACTSTE,
MSG.CARFNLDST,
MSG.RATTYPIND,
MSG.GCMORGDST,
MSG.CSGDOCNUM,
MSG.MALCTGCOD,
MSG.MALPRDTYP,
MSG.MALSUBCLSCOD,
MSG.PAYRATCOD,
MSG.LINHALUSDRAT,
MSG.LINHALSDRRAT,
MSG.TERHDLUSDRAT,
MSG.TERHDLSDRRAT,
MSG.SPLPERKGMUSDRAT,
MSG.SPLPERKGMSDRRAT,
MSG.CNTRAT,
COALESCE(BLGMST.ULDNUM,MSG.CONTYP)CONTYP,
MSG.MALWGTUNT,
MSG.CONWGTUNT,
MSG.CONGRSWGT,
COALESCE(BLGMST.RCVDAT,MSG.CSGCMPDAT)CSGCMPDAT,
COALESCE(MSG.CTRTYP,'D') CTRTYP,
--MSG.MALGRSWGT,
COALESCE(INCDTL.ACTWGT,INCDTL.GRSWGT) MALGRSWGT,
--MSG.CARTOOPAY,
COALESCE(INCDTL.ACPSCNCAR,MSG.CARTOOPAY) CARTOOPAY,
--MSG.ORGARPCOD,
COALESCE(INCDTL.ACTORGCOD,MSG.ORGARPCOD) ORGARPCOD,
--MSG.DSTARPCOD,
COALESCE(INCDTL.ACTDSTCOD,MSG.DSTARPCOD) DSTARPCOD,
MSG.OFLORGARP,
COALESCE(INCDTL.DLVSCNCAR,MSG.DLVSCNCAR) DLVSCNCAR,
COALESCE(INCDTL.ACTORGCOD,MSG.ORIORGARP) ORIORGARP,
--MSG.FNLDST,
COALESCE(INCDTL.ACTDSTCOD,MSG.FNLDST) FNLDST,
--MSG.ROUDEPDAT,
COALESCE(INCDTL.FSTFLTDAT,MSG.ROUDEPDAT) ROUDEPDAT,
INCDTL.ACTMALSRVLVL,
COALESCE(INCDTL.ACPDAT,MSG.POSSCNDAT) POSSCNDAT,
COALESCE(INCDTL.ACTDLVDAT,MSG.DLVSCNDAT) DLVSCNDAT,
COALESCE(INCDTL.ACTDSTCOD,MSG.DLVSCNEXPSTE) DLVSCNEXPSTE,
MSG.MSGTXT,
MSG.CLMREFNUM,
MSG.SORSCNCAR,
MSG.SORSCNACTSTE,
MSG.SORSCNEXPSTE,
MSG.SORSCNACTDAT,
MSG.SORSCNRCVDAT
FROM  MALMRAGPAINCMSGREF MSG,MALMRAGPAINCDTL INCDTL,MALMRABLGMST BLGMST
WHERE MSG.CMPCOD   = INCDTL.CMPCOD
AND MSG.SERNUM     = INCDTL.SERNUM
AND MSG.MALSEQNUM  = INCDTL.MALSEQNUM
AND INCDTL.CMPCOD   = BLGMST.CMPCOD
AND INCDTL.MALSEQNUM  = BLGMST.MALSEQNUM
--AND MSG.VERNUM = INCDTL.VERNUM 
AND BLGMST.POACOD IN ('US101','US001')
AND INCDTL.RCVDAT <= current_timestamp
AND INCDTL.UPDCLMAMT > 0
AND MSG.CMPCOD=?
AND MSG.MSGTXT IS NULL
	]]>
			</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	 <QRY:Id>28</QRY:Id>
		<QRY:Source Name="mailtracking.mra.gpareporting.findmailbagsforclaim" Type="NATIVE">
		<![CDATA[
		SELECT*
FROM
  (SELECT CLM.CMPCOD,
    CLM.CLMREFNUM,
    CLM.POACOD,
    CLMDTL.MSGTXT,
    TO_NUMBER( SUBSTR(CLMDTL.MSGTXT,INSTR(CLMDTL.MSGTXT,'+',1)+1,INSTR(CLMDTL.MSGTXT,'''',1)-2-INSTR(CLMDTL.MSGTXT,'+',1)+1)) RN,
    --LISTAGG(CLMDTL.MSGTXT,'')  WITHIN GROUP (ORDER BY CLMDTL.MSGTXT) MSGTXT,
        MAX(MST.TWOAPHCOD) TWOAPHCOD,
        MAX(MST.ARLNAM) ARLNAM,
        MAX(CLM.TOTCLMAMT) TOTCLMAMT,
        MAX(CLM.TOTMALCNT) TOTMALCNT,
        MAX(CLM.SCHINVDAT) SCHINVDAT,
        MAX(CLM.ASCASGCOD) ASCASGCOD,
        MAX(CLM.CTRNUM) CTRNUM,
        MAX(CLM.REGCOD) REGCOD,
		MAX(CLMDTL.MALSEQNUM) MALSEQNUM
        FROM MALMRAGPACLM CLM,MALMRAGPACLMDTL CLMDTL,SHRARLMST MST,SHRSYSPAR PAR
		WHERE CLM.CMPCOD = CLMDTL.CMPCOD
		AND CLM.POACOD = CLMDTL.POACOD
		AND CLM.CLMREFNUM = CLMDTL.CLMREFNUM
		AND PAR.CMPCOD = CLM.CMPCOD
		AND PAR.PARCOD = 'logonattributes.ownairlineidentifier'
		AND MST.CMPCOD = CLM.CMPCOD
		AND TO_CHAR(MST.ARLIDR) = PAR.PARVAL
		AND CLM.CMPCOD = ?
		AND CLM.CLMREFNUM = ?
        GROUP BY CLM.CMPCOD,
    CLM.CLMREFNUM,
    CLM.POACOD,
    CLMDTL.MSGTXT,
    MALSEQNUM
  )MST
ORDER BY RN

			]]>
		</QRY:Source>
	</QRY:Definition>
    <QRY:Definition>
	 <QRY:Id>28</QRY:Id>
		<QRY:Source Name="mailtracking.mra.gpareporting.findmailbagsforclaimforinternational" Type="NATIVE">
		<![CDATA[
	SELECT * FROM  (
SELECT CLM.CMPCOD CMPCOD,
    CLM.CLMREFNUM CLMREFNUM,
    CLM.POACOD POACOD,
    CLMDTL.MSGTXT MSGTXT,
    TO_NUMBER( SUBSTR(CLMDTL.MSGTXT,INSTR(CLMDTL.MSGTXT,'+',1)+1,INSTR(CLMDTL.MSGTXT,'''',1)-INSTR(CLMDTL.MSGTXT,'+',1)-1)) RN,
    --LISTAGG(CLMDTL.MSGTXT,'')  WITHIN GROUP (ORDER BY CLMDTL.MSGTXT) MSGTXT,
        MAX(MST.TWOAPHCOD) TWOAPHCOD,
        MAX(MST.ARLNAM) ARLNAM,
        MAX(CLM.TOTCLMAMT) TOTCLMAMT,
        MAX(CLM.TOTMALCNT) TOTMALCNT,
        MAX(CLM.SCHINVDAT) SCHINVDAT,
        MAX(CLM.ASCASGCOD) ASCASGCOD,
        MAX(CLM.CTRNUM) CTRNUM,
        MAX(CLMDTL.ACTREGCOD) ACTREGCOD,
        MAX(CLMDTL.NEWPAYINVNUM) NEWPAYINVNUM,
		MAX(CLMDTL.MALSEQNUM) MALSEQNUM
        FROM MALMRAGPACLM CLM,MALMRAGPACLMDTL CLMDTL,SHRARLMST MST,SHRSYSPAR PAR
		WHERE CLM.CMPCOD = CLMDTL.CMPCOD
		AND CLM.POACOD = CLMDTL.POACOD
		AND CLM.CLMREFNUM = CLMDTL.CLMREFNUM
		AND PAR.CMPCOD = CLM.CMPCOD
		AND PAR.PARCOD = 'logonattributes.ownairlineidentifier'
		AND MST.CMPCOD = CLM.CMPCOD
		
		AND TO_CHAR(MST.ARLIDR) = PAR.PARVAL
		AND CLM.CLMSND='N'
		AND CLM.CMPCOD = ?
        GROUP BY CLM.CMPCOD,
    CLM.CLMREFNUM,
    CLM.POACOD,
    CLMDTL.MSGTXT,
    MALSEQNUM )record ORDER BY CLMREFNUM,RN
			]]>
		</QRY:Source>
	</QRY:Definition>
    <QRY:Definition>
	 <QRY:Id>29</QRY:Id>
		<QRY:Source Name="mailtracking.mra.gpareporting.findgeneratedresditmessage" Type="NATIVE">
		<![CDATA[
			select * from (SELECT  MSG.CMPCOD,
 ROW_NUMBER() OVER(PARTITION BY MSG.CMPCOD,INC.POACOD,MSG.MSGTYP,MSG.EVTPRT,MSG.MSGVERNUM,CDTEXT, MSG.MSGIDR
 ORDER BY MSG.CMPCOD,INC.POACOD,MSG.MSGTYP,MSG.EVTPRT,MSG.MSGVERNUM,CDTEXT, MSG.MSGIDR)  RWNUM,
MSGDTL,INC.POACOD,MSG.MSGVERNUM,MSG.EVTPRT,MSG.MSGTYP,CDTEXT,MSG.MSGIDR
FROM MALMRAGPAINCDTL INC,
			MALRDT RDT,MALRDTMSGREF MSG
WHERE INC.CMPCOD = RDT.CMPCOD
AND INC.MALSEQNUM = RDT.MALSEQNUM
			AND RDT.CMPCOD = MSG.CMPCOD
AND RDT.MSGIDR = MSG.MSGIDR
AND INC.CMPCOD =?
AND INC.UPDCLMAMT >0
AND INC.INVPAYSTA = 'SP'
AND INC.RCVDAT BETWEEN ? AND ?
AND INC.POACOD =?
AND MSG.MSGDTL IS NOT NULL
			]]>
		</QRY:Source>
	</QRY:Definition>


			<QRY:Definition>
		<QRY:Id>30</QRY:Id>
		<QRY:Source Name="mailtracking.mra.gpareporting.findClaimMasterDetails" Type="NATIVE">
			<![CDATA[
				SELECT CLMREFNUM||'~'||RDTSND||'~'||CLMSND CLMDET FROM MALMRAGPACLM
WHERE CMPCOD=?
AND POACOD=?
AND to_number(to_char(RPTPRDFRM,'YYYYMMDD'))=?
AND to_number(to_char(RPTPRDTOO,'YYYYMMDD'))=?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
			<QRY:Id>8</QRY:Id>
								<QRY:Source Name="mailtracking.mra.gpareporting.triggerinvoicacc" Type="PROCEDURE">
									<![CDATA[
									CALL PKG_MAL_MRA_ACC_NEW.SPR_MRA_INVOIC_ACC (
															?,
															?,
															?,
															?,
															?,
															?,
															?,
															?,
															?,
															?
														    )
									]]>
							</QRY:Source>
		</QRY:Definition>

		<QRY:Definition>
		<QRY:Id>31</QRY:Id>
		<QRY:Source Name="mailtracking.mra.gpareporting.findClaimReferenceNumber" Type="NATIVE">
			<![CDATA[
SELECT PKG_MAL_MRA_DEFAULTS.FUN_GENERATECLAIMREFNUM(?,TO_CHAR(TO_DATE(?,'DD-MON-YYYY'),'MON'),TO_CHAR(TO_DATE(?,'DD-MON-YYYY'),'YY'),?,current_date) CLMREFNUM
FROM DUAL

			]]>
		</QRY:Source>
	</QRY:Definition>
<QRY:Definition>
<QRY:Id>18</QRY:Id>
		<QRY:Source Name="mailtracking.mra.gpareporting.ux.findclaimdtlsforEDIgeneration" Type="NATIVE">
			<![CDATA[
	SELECT
	INCDTL.CMPCOD,
	INCDTL.POACOD,
  INCDTL.MALSEQNUM,
	 INCDTL.MALIDR,
    INCDTL.RCVDAT,
    INCDTL.CLMSTA
FROM MALMRAGPAINCMSGREF MSG LEFT OUTER JOIN 
  MALMRAGPAINCDTL INCDTL ON (MSG.CMPCOD     = INCDTL.CMPCOD
AND MSG.SERNUM       = INCDTL.SERNUM
AND MSG.MALSEQNUM    = INCDTL.MALSEQNUM
AND MSG.VERNUM       = INCDTL.VERNUM) INNER JOIN 
  MALPOADTL DTL ON (DTL.CMPCOD       = INCDTL.CMPCOD
AND DTL.POACOD       = INCDTL.POACOD) LEFT OUTER JOIN 
  MALMRAGPAINCMST MST ON 

 MSG.CMPCOD       = MST.CMPCOD
AND MSG.SERNUM       = MST.SERNUM
 WHERE 
 DTL.PARCOD       ='STLINFO'
AND INCDTL.UPDCLMAMT >0
AND INCDTL.INVPAYSTA = 'SP'

AND INCDTL.CMPCOD    = ?
AND INCDTL.POACOD    = ?
]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
<QRY:Id>32</QRY:Id>
		<QRY:Source Name="mailtracking.mra.gpareporting.listinvoicouterquery" Type="NATIVE">
			<![CDATA[
	SELECT MALIDR MALIDR,
  GRSWGT GRSWGT,
  APLRAT APLRAT,
  NETAMT NETAMT,
  UNTCOD UNTCOD,
  DISINCAMT DISINCAMT,
  INCAMT INCAMT,
  UPDNETAMT UPDNETAMT,
  CTRCURCOD CTRCURCOD,
  CSGDOCNUM CSGDOCNUM,
  ORGCOD ORGCOD,
  DSTCOD DSTCOD,
  MALSUBCLS MALSUBCLS,
  CMPCOD CMPCOD,
  MALSEQNUM MALSEQNUM,
  MALCLS MALCLS,
  UPDBILTOOPOA UPDBILTOOPOA,
  REGCOD REGCOD,
  CODSHRCAR CODSHRCAR,
  OALAMT OALAMT,
  INVAMT INVAMT,
  CLMAMT CLMAMT,
  PROSTA PROSTA,
  INVPAYSTA INVPAYSTA,
  CLMSTA CLMSTA,
  RMK RMK,
  VERNUM VERNUM,
  REQDLVTIM REQDLVTIM,
  SERNUM SERNUM,
  TOTSTLAMT TOTSTLAMT,
  MAX (CLMLESSFIV) OVER(PARTITION BY CMPCOD) CLMLESSFIV,
  MAX(CLMFIVTOTEN) OVER(PARTITION BY CMPCOD) CLMFIVTOTEN,
  MAX(CLMTENTOTWENTYFIV) OVER(PARTITION BY CMPCOD) CLMTENTOTWENTYFIV,
  MAX(CLMTWENTYFIVTOFIFTY) OVER(PARTITION BY CMPCOD) CLMTWENTYFIVTOFIFTY,
  MAX(CLMFIFTYTOHUNDRED) OVER(PARTITION BY CMPCOD) CLMFIFTYTOHUNDRED,
  MAX(CLMHUNDREDTOFIVHUNDRED) OVER(PARTITION BY CMPCOD) CLMHUNDREDTOFIVHUNDRED,
  MAX(CLMGRTFIVHUNDRED) OVER(PARTITION BY CMPCOD) CLMGRTFIVHUNDRED,
  SUM(CNTAWTINC) OVER(PARTITION BY CMPCOD) CNTAWTINC,
   SUM (dummydst) over (partition by cmpcod) dummydst,
   SUM (dummyorg) over (partition by cmpcod) dummyorg,
    SUM (dlvscnwrg) over (partition by cmpcod) dlvscnwrg,

  FORMJRSTA FORMJRSTA
FROM
  (
]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
<QRY:Id>33</QRY:Id>
		<QRY:Source Name="mailtracking.mra.gpareporting.listinvoicgroupbyquery" Type="NATIVE">
			<![CDATA[
	)
GROUP BY MALIDR,
  GRSWGT,
  APLRAT,
  NETAMT,
  UNTCOD,
  DISINCAMT,
  INCAMT,
  UPDNETAMT,
  CTRCURCOD,
  CSGDOCNUM,
  ORGCOD,
  DSTCOD,
  MALSUBCLS,
  CMPCOD,
  MALSEQNUM,
  MALCLS,
  UPDBILTOOPOA,
  REGCOD,
  CODSHRCAR,
  OALAMT,
  INVAMT,
  CLMAMT,
  PROSTA,
  INVPAYSTA,
  CLMSTA,
  RMK,
  VERNUM,
  REQDLVTIM,
  SERNUM,
  TOTSTLAMT,
  --PRVSTLAMT,
  CLMLESSFIV,
  CLMFIVTOTEN,
  CLMTENTOTWENTYFIV,
  CLMTWENTYFIVTOFIFTY,
  CLMFIFTYTOHUNDRED,
  CLMHUNDREDTOFIVHUNDRED,
  CLMGRTFIVHUNDRED,
  CNTAWTINC,
  DUMMYDST,
  DUMMYORG,
  DLVSCNWRG
]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
<QRY:Id>34</QRY:Id>
		<QRY:Source Name="mail.mra.gpareporting.findbucketwisesumsnavigation" Type="NATIVE">
			<![CDATA[
	SELECT
SUM(CASE WHEN STLDTL.PROSTA = 'OVRNOTMRA' THEN 1 ELSE 0  END) CNTOVRNOTMRA,
SUM(CASE WHEN STLDTL.PROSTA = 'CLMZROPAY' AND STLDTL.CLMSTA IS NULL THEN 1 ELSE 0  END) CLMZROPAY,
SUM(CASE WHEN STLDTL.PROSTA = 'CLMNOINC' AND STLDTL.CLMSTA IS NULL THEN 1 ELSE 0  END) CLMNOINC,
SUM(CASE WHEN STLDTL.PROSTA = 'CLMRATDIF' AND STLDTL.CLMSTA IS NULL THEN 1 ELSE 0  END) CLMRATDIF,
SUM(CASE WHEN STLDTL.PROSTA = 'CLMWGTDIF' AND STLDTL.CLMSTA IS NULL THEN 1 ELSE 0  END) CLMWGTDIF,
SUM(CASE WHEN STLDTL.PROSTA = 'CLMMISSCN' AND STLDTL.CLMSTA IS NULL THEN 1 ELSE 0  END) CLMMISSCN,
SUM(CASE WHEN STLDTL.PROSTA = 'CLMLATDLV' AND STLDTL.CLMSTA IS NULL THEN 1 ELSE 0  END) CLMLATDLV,
SUM(CASE WHEN STLDTL.PROSTA = 'CLMSRVRSP' AND STLDTL.CLMSTA IS NULL THEN 1 ELSE 0  END) CLMSRVRSP,
SUM(CASE WHEN STLDTL.PROSTA = 'LATDLV' THEN 1 ELSE 0  END) LATDLV,
SUM(CASE WHEN STLDTL.PROSTA = 'MISORGSCN' THEN 1 ELSE 0  END) MISORGSCN,
SUM(CASE WHEN STLDTL.PROSTA = 'MISDSTSCN' THEN 1 ELSE 0  END) MISDSTSCN,
SUM(CASE WHEN STLDTL.PROSTA = 'FULPAID' THEN 1 ELSE 0  END) FULPAID,
SUM(CASE WHEN STLDTL.PROSTA = 'OVRRATDIF' THEN 1 ELSE 0  END) OVRRATDIF,
SUM(CASE WHEN STLDTL.PROSTA = 'OVRWGTDIF' THEN 1 ELSE 0  END) OVRWGTDIF,
SUM(CASE WHEN STLDTL.PROSTA = 'OVRCLSDIF' THEN 1 ELSE 0  END) OVRCLSDIF,
SUM(CASE WHEN STLDTL.PROSTA = 'OVRSRVRSP' THEN 1 ELSE 0  END) OVRSRVRSP,
SUM(CASE WHEN STLDTL.PROSTA = 'OVROTH' THEN 1 ELSE 0  END) OVROTH,
SUM(CASE WHEN STLDTL.PROSTA = 'OTH' AND STLDTL.CLMSTA IS NULL THEN 1 ELSE 0  END) CLMOTH,
SUM(CASE WHEN STLDTL.PROSTA = 'CLMNOTINV' AND STLDTL.CLMSTA IS NULL THEN 1 ELSE 0  END) CLMNOTINV,
SUM(CASE WHEN STLDTL.PROSTA = 'OVRPAYACP' THEN 1 ELSE 0  END) OVRPAYACP,
SUM(CASE WHEN STLDTL.PROSTA = 'OVRPAYREJ' THEN 1 ELSE 0  END) OVRPAYREJ,
SUM(CASE WHEN STLDTL.PROSTA = 'CLMFRCMJR' AND STLDTL.CLMSTA IS NULL THEN 1 ELSE 0  END) CLMFRCMJR,
SUM(CASE WHEN STLDTL.PROSTA = 'SHRPAYACP' AND STLDTL.CLMSTA IS NULL THEN 1 ELSE 0 END) SHRPAYACP,
SUM(CASE WHEN STLDTL.CLMSTA = 'GEN' THEN 1 ELSE 0 END) CLMSTAGEN,
SUM(CASE WHEN STLDTL.CLMSTA = 'SUB' THEN 1 ELSE 0 END) CLMSTASUB
FROM MALMRAGPAINCDTL INCDTL,MALMRABLGMST MST,MALMRAGPAINCSTLDTL STLDTL
WHERE INCDTL.CMPCOD        = MST.CMPCOD
AND INCDTL.MALSEQNUM       = MST.MALSEQNUM
AND INCDTL.CMPCOD          = STLDTL.CMPCOD
AND INCDTL.MALSEQNUM       = STLDTL.MALSEQNUM
]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>37</QRY:Id>
			<QRY:Source Name="mailtracking.mra.gpareporting.findinvoicsbyfilename" Type="NATIVE">
				<![CDATA[
		SELECT SERNUM
			FROM MALMRAGPAINCMSGMST
			WHERE CMPCOD   = ?
			AND FILNAM    = ?
			AND PRCSTA    = 'NW'
]]>
		</QRY:Source>
	</QRY:Definition>
<QRY:Definition>
		<QRY:Id>38</QRY:Id>
			<QRY:Source Name="mailtracking.mra.gpareporting.findmailbagsforrejection" Type="NATIVE">
				<![CDATA[
SELECT COUNT(*) COUNT  FROM MALMRAGPAINCMST MST, MALMRAGPAINCSTLDTL STL, MALMRAGPAINCDTL DTL
WHERE MST.CMPCOD = STL.CMPCOD
AND MST.SERNUM =STL.SERNUM
AND STL.CMPCOD =DTL.CMPCOD
AND STL.MALSEQNUM = DTL.MALSEQNUM
AND MST.CMPCOD = ?
AND MST.FILNAM =?
AND (DTL.invpaysta in ('ASP','AOP') OR DTL.CLMSTA IN ('GEN','SUB'))
]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>39</QRY:Id>
			<QRY:Source Name="mailtracking.mra.gpareporting.findbatchnumber" Type="NATIVE">
				<![CDATA[
 SELECT MAX(coalesce(DTL.BTHNUM,0)) TOTMALCNT
                FROM MALMRAGPAINCMSGDTL DTL,
                  MALMRAGPAINCMSGMST MST
                WHERE MST.CMPCOD  = DTL.CMPCOD
                AND MST.SERNUM    = DTL.SERNUM
                AND MST.CMPCOD    = ?               
                AND MST.FILNAM    = COALESCE(?,MST.FILNAM)
]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>40</QRY:Id>
			<QRY:Source Name="mailtracking.mra.gpareporting.processinvoicjob" Type="PROCEDURE">
				<![CDATA[
CALL PKG_MAL_MRA_INVOIC_CALC.SPR_MRA_PROCESS_INVREF_JOB(
	?,
	?,
	?,
	?,
	?,
	?,
	?,
	?,
	?,
	?,
	?,
	?,
	?
	)
]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>41</QRY:Id>
			<QRY:Source Name="mailtracking.mra.gpareporting.updateconcurrentstatus" Type="PROCEDURE">
				<![CDATA[
CALL PKG_MAL_MRA_INVOIC_CALC.UPDATE_FILE_PROCESSING_STATUS(
	?,
	?
	)
]]>
		</QRY:Source>
	</QRY:Definition>
</QRY:Definitions>