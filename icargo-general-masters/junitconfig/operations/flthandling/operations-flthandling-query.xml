<?xml version="1.0" encoding="UTF-8"?>
<!--Testing Version-->
<QRY:Definitions xmlns:QRY="http://www.ibsplc.com/xibase/persistence/queries" module="operations.flthandling">
	<QRY:Definition>
		<QRY:Id>1</QRY:Id>
		<QRY:Source Name="operations.flthandling.findctmdetails" Type="NATIVE">
			<![CDATA[
									SELECT CTM.CTMREFNUM,
									  MIS.SCICOD,
									  MST.ORGCOD,
									  ORGCTY.CTYCOD,
									  DSTCTY.CTYCOD,
									  CTM.CTMSERNUM,
									  CTM.CMPCOD,
									  CTM.CTMTYP,

CTM.OUTCARIDR,

									  CTM.OUTCARCOD,
									  CTM.ACTTRFDAT,
									  CTM.OUTFLTNUM,

CTM.OUTFLTDAT,

									  CTM.OUTSEGSERNUM,
									  CTM.INBCARIDR,
									  CTM.INBCARCOD,

CTM.INBFLTNUM,

									  CTM.INBFLTDAT,
									  CTM.INBSEGSERNUM,
									  CTM.CRNDAT,

CTM.INBFLTSEQNUM,

									  CTM.OUTFLTSEQNUM,
									  CTM.ARPCOD,
									  CTM.INBCARTRKIND,

CTM.OUTCARTRKIND,
									  MST.STDWGTCOD STDWGTCOD,
									  MST.STDWGT STDWGT,


MST.GRSVOLUNT STDVOLUNT,
									  MST.GRSVOL STDVOL,
									  MST.STDPCS STDPCS,
									  MST.SHPPFX,


									  MST.SHPDES SHPDCL,
									  MST.SCCCOD SCCCOD,
									  SHP.RMK,
									  MST.OWRCOD,


									  MST.ORGCOD ORGCOD,
									  MST.DSTCOD DSTCOD,
									  MST.PLTFLG,
									  MST.STDDISWGT
DISSTDWGT,

									  MST.GRSDISVOL DISSTDVOL,
									  MST.EFTAWBFLG,
									  SHP.CTMSERNUM
SHPCTMSERNUM,

									  SHP.CTMREFNUM SHPCTMREFNUM,
									  SHP.CMPCOD SHPCMPCOD,

SHP.ACTWGTCOD,
									  SHP.ACTWGT,

									  SHP.ACTVOLUNT,
									  SHP.ACTVOL,

SHP.ACTPCS,
									  SHP.ACTDISWGT,
									  SHP.ACTDISVOL,

									  SHP.TRFPCS,

SHP.TRFWGT,
									  SHP.TRFVOL,
									  SHP.TRFDISWGT,
									  SHP.TRFDISVOL,


SHP.TRFVOLUNT,
									  SHP.TRFWGTUNT,
									  AGTGRP.GRPNAM AGTGRP,
									  SHP.MSTDOCNUM,


									  SHP.DUPNUM,
									  SHP.SEQNUM,
									  SHP.DOCOWRIDR,
									  DTL.PLTUSEFLG,

MST.CONFLG,

									  MST.EXEFLG,
									  CTM.LSTUPDTIM CTMUPDTIM,
									  SHP.LSTUPDTIM
CTMSHPUPDTIM,
									  ARPSHP.LSTUPDTIM
ARPLSTUPDTIM,
									  SHP.TRFENDFLG,
									  MST.AGTCOD,

SHP.SHPREJFLG,
									  MST.SHPNAM

									FROM OPRMFTCTM CTM
									LEFT OUTER JOIN OPRMFTCTMSHP
SHP
									ON CTM.CTMREFNUM  = SHP.CTMREFNUM

									AND CTM.CMPCOD    = SHP.CMPCOD

AND CTM.CTMSERNUM = SHP.CTMSERNUM
									LEFT OUTER JOIN OPRSHPMST
MST
									ON SHP.MSTDOCNUM
= MST.MSTDOCNUM
									AND SHP.DOCOWRIDR = MST.DOCOWRIDR
									AND
SHP.DUPNUM    = MST.DUPNUM

AND SHP.SEQNUM    = MST.SEQNUM
									AND SHP.CMPCOD    = MST.CMPCOD

									LEFT OUTER
JOIN OPRSHPDTL DTL
									ON MST.MSTDOCNUM  = DTL.MSTDOCNUM
									AND MST.DOCOWRIDR =
DTL.DOCOWRIDR

AND MST.DUPNUM    = DTL.DUPNUM
									AND MST.CMPCOD    = DTL.CMPCOD

AND MST.SEQNUM    =
DTL.SEQNUM
									LEFT OUTER JOIN OPRSHPMSTMIS MIS
									ON MST.DOCOWRIDR  =
MIS.DOCOWRIDR

AND MST.MSTDOCNUM = MIS.MSTDOCNUM
									AND MST.DUPNUM    = MIS.DUPNUM

AND MST.SEQNUM
= MIS.SEQNUM
									AND MST.CMPCOD    = MIS.CMPCOD
									LEFT OUTER JOIN SHRARPMST
ARPMSTORG

ON MST.CMPCOD  = ARPMSTORG.CMPCOD
									AND MST.ORGCOD = ARPMSTORG.ARPCOD

LEFT OUTER JOIN
SHRCTYMST ORGCTY
									ON ORGCTY.CMPCOD  = ARPMSTORG.CMPCOD
									AND ORGCTY.CTYCOD
= ARPMSTORG.CTYCOD

LEFT OUTER JOIN SHRARPMST ARPMSTDST
									ON CTM.CMPCOD  = ARPMSTDST.CMPCOD

									AND
CTM.ARPCOD = ARPMSTDST.ARPCOD
									LEFT OUTER JOIN SHRCTYMST DSTCTY
									ON DSTCTY.CMPCOD
=
ARPMSTDST.CMPCOD
									AND DSTCTY.CTYCOD = ARPMSTDST.CTYCOD
									LEFT OUTER JOIN SHRGENMSTGRPDTL

AGTGRP
									ON MST.CMPCOD        = AGTGRP.CMPCOD
									AND MST.AGTCOD       = AGTGRP.GRPENT


									AND AGTGRP.GRPCATCOD = 'GEN'
									LEFT OUTER JOIN OPRARPSHP ARPSHP
									ON SHP.MSTDOCNUM
= ARPSHP.MSTDOCNUM

									AND SHP.DOCOWRIDR = ARPSHP.DOCOWRIDR
									AND SHP.DUPNUM
= ARPSHP.DUPNUM
									AND SHP.SEQNUM
= ARPSHP.SEQNUM
									AND SHP.CMPCOD    = ARPSHP.CMPCOD

LEFT OUTER JOIN CSTARPTXNMAP_VW CSTMAP

									ON CTM.CMPCOD  = CSTMAP.CMPCOD
									AND
CTM.ARPCOD = CSTMAP.ARPCOD
									AND (
									  CASE

										WHEN CTM.CTMTYP !='I'

THEN CTM.OUTCARIDR
										ELSE CTM.INBCARIDR
									  END
= CSTMAP.ARLIDR )

WHERE ARPSHP.ARPCOD =?
									AND CTM.CTMREFNUM   =?
									AND CTM.CMPCOD
=?
									AND
CTM.CTMSERNUM   =?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>2</QRY:Id>
		<QRY:Source Name="operations.flthandling.findctms" Type="NATIVE">
			<![CDATA[
	SELECT
		CTMREFNUM, CTMSERNUM, CMPCOD,
		CTMTYP, OUTCARIDR, OUTCARCOD,
		OUTFLTNUM, OUTFLTDAT, OUTSEGSERNUM,
		INBCARIDR, INBCARCOD, INBFLTNUM, INBFLTDAT,
		INBSEGSERNUM, CRNDAT, LSTUPDTIM,CRNDAT,
		LSTUPDUSR, INBFLTSEQNUM, OUTFLTSEQNUM
	FROM OPRMFTCTM
	WHERE
	CTMREFNUM=? AND
	CMPCOD=?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>3</QRY:Id>
		<QRY:Source Name="operations.flthandling.findctmenquirydetails" Type="NATIVE">
			<![CDATA[
	SELECT
		CTM.CTMREFNUM, CTM.CMPCOD, CTM.OUTCARIDR,
		CTM.OUTCARCOD, CTM.OUTFLTNUM, CTM.OUTFLTDAT, CTM.OUTSEGSERNUM,



		CTM.INBCARIDR, CTM.INBCARCOD, CTM.INBFLTNUM, CTM.INBFLTDAT,CTM.CTMTYP,
		CTM.INBSEGSERNUM, CTM.INBFLTSEQNUM,


CTM.OUTFLTSEQNUM, CTM.ARPCOD, CTM.ACTTRFDAT,
		MST.STDDISWGT, MST.STDWGTCOD, MST.GRSDISVOL, MST.GRSVOLUNT,



		MST.SCCCOD, MST.ORGCOD, MST.DSTCOD, MST.STDPCS, MST.SHPDES,
		MST.SHPPFX,	CTMSHP.ACTWGTCOD, CTMSHP.ACTWGT,


CTMSHP.ACTVOLUNT, CTM.CTMSERNUM,
		CTMSHP.ACTVOL, CTMSHP.ACTPCS, CTMSHP.RMK, CTMSHP.DUPNUM,
	    CTMSHP.TRFPCS,CTMSHP.TRFWGT,CTMSHP.TRFVOL,CTMSHP.TRFDISWGT,



		CTMSHP.TRFDISVOL,CTMSHP.TRFVOLUNT,CTMSHP.TRFWGTUNT,
		CTMSHP.SEQNUM, CTMSHP.MSTDOCNUM, CTMSHP.CRASTA,


CTMSHP.DOCOWRIDR,MST.AGTCOD,CTMSHP.SHPREJFLG,ARPSHP.PLTUSEFLG,SHPDTL.PLTUSEFLG AS SHPPLTUSEFLG, MST.PLTFLG
	FROM OPRMFTCTM CTM
LEFT OUTER JOIN OPRMFTCTMSHP CTMSHP
ON CTM.CTMREFNUM     = CTMSHP.CTMREFNUM
AND CTM.CMPCOD          = CTMSHP.CMPCOD
AND CTM.CTMSERNUM       = CTMSHP.CTMSERNUM
LEFT OUTER JOIN OPRSHPMST MST
on CTMSHP.CMPCOD       = MST.CMPCOD
AND CTMSHP.DOCOWRIDR    = MST.DOCOWRIDR
AND CTMSHP.MSTDOCNUM    = MST.MSTDOCNUM
AND CTMSHP.DUPNUM       = MST.DUPNUM
AND CTMSHP.SEQNUM       = MST.SEQNUM
LEFT OUTER JOIN OPRSHPDTL SHPDTL
ON CTMSHP.CMPCOD     = SHPDTL.CMPCOD
AND CTMSHP.DOCOWRIDR = SHPDTL.DOCOWRIDR
AND CTMSHP.MSTDOCNUM = SHPDTL.MSTDOCNUM
AND CTMSHP.DUPNUM    = SHPDTL.DUPNUM
AND CTMSHP.SEQNUM    = SHPDTL.SEQNUM
LEFT OUTER JOIN OPRARPSHP ARPSHP
ON CTMSHP.CMPCOD       = ARPSHP.CMPCOD
AND CTMSHP.DOCOWRIDR    = ARPSHP.DOCOWRIDR
AND CTMSHP.MSTDOCNUM    = ARPSHP.MSTDOCNUM
AND CTMSHP.DUPNUM       = ARPSHP.DUPNUM
AND CTMSHP.SEQNUM       = ARPSHP.SEQNUM


	  AND CTM.ARPCOD       = ARPSHP.ARPCOD
	  WHERE CTM.CMPCOD = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>4</QRY:Id>
		<QRY:Source Name="operations.flthandling.findctmtransactionpcs" Type="NATIVE">
			<![CDATA[
	SELECT
			PCS.CMPCOD PCSCMPCOD, PCS.DOCOWRIDR PCSDOCOWRIDR, PCS.MSTDOCNUM PCSMSTDOCNUM,
			PCS.DUPNUM


PCSDUPNUM, PCS.SEQNUM PCSSEQNUM, PCS.GRPIDR PCSPCSIDR,
			PCS.ARPCOD PCSARPCOD, PCS.TXNCOD PCSTXNCOD,


PCS.TXNREFONE PCSTXNREFONE,
			PCS.TXNREFTWO PCSTXNREFTWO, PCS.TXNREFTHR PCSTXNREFTHR, PCS.TXNREFFOR


PCSTXNREFFOR,
			PCS.TXNREFFIV PCSTXNREFFIV
			FROM OPRSHPTXNPCSGRPHIS PCS,OPRSHPPCSGRP


SHPPCS
			WHERE
			PCS.CMPCOD= SHPPCS.CMPCOD AND
			PCS.DOCOWRIDR = SHPPCS.DOCOWRIDR AND
			PCS.MSTDOCNUM


= SHPPCS.MSTDOCNUM AND
			PCS.DUPNUM= SHPPCS.DUPNUM AND
			PCS.SEQNUM= SHPPCS.SEQNUM AND
			PCS.GRPIDR= SHPPCS.GRPIDR AND
			PCS.CMPCOD=? AND
			PCS.DOCOWRIDR=? AND
			PCS.MSTDOCNUM=? AND
			PCS.DUPNUM=?

AND

			PCS.SEQNUM=? AND
			PCS.TXNREFONE=? AND
		PCS.TXNCOD='CTM'
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>5</QRY:Id>
		<QRY:Source Name="operations.manifest.findmanifestedulds" Type="NATIVE">
			<![CDATA[
	SELECT  SEGULD.ULDNUM,FLTSEG.POL, FLTSEG.POU,SEGULD.SEGSERNUM
	FROM OPRSEGULD  SEGULD,OPRFLTSEG FLTSEG
	WHERE SEGULD.CMPCOD=FLTSEG.CMPCOD
	AND SEGULD.FLTCARIDR=FLTSEG.FLTCARIDR
	AND SEGULD.FLTNUM=FLTSEG.FLTNUM
	AND SEGULD.FLTSEQNUM=FLTSEG.FLTSEQNUM
	AND SEGULD.SEGSERNUM=FLTSEG.SEGSERNUM
	AND SEGULD.CMPCOD=?
	AND SEGULD.FLTCARIDR=?
	AND SEGULD.FLTNUM=?
	AND SEGULD.FLTSEQNUM=?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>6</QRY:Id>
		<QRY:Source Name="operations.manifest.findmanifestversions" Type="NATIVE">
			<![CDATA[
	SELECT  MFTVER
	FROM OPRMFTVER
	WHERE CMPCOD=?
	  AND FLTCARIDR=?
	  AND FLTNUM=?
	  AND FLTSEQNUM=?
	  AND LEGSERNUM=?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>7</QRY:Id>
		<QRY:Source Name="operations.manifest.findfreightmanifestdetailswithoutversion" Type="NATIVE">
			<![CDATA[

		SELECT ULD.BSEFLG,ULD.BSEPLT,
			   ULD.CMPCOD ULDCMPCOD, ULD.FLTCARIDR ULDFLTCARIDR, ULD.FLTNUM ULDFLTNUM,ULD.BDPCMPSTA BDPCMPSTA,



ULD.FLTSEQNUM ULDFLTSEQNUM, ULD.SEGSERNUM ULDSEGSERNUM, ULD.CONIDR ULDCONIDR,
		       CASE WHEN ULD.BARROWFLG


= 'Y' AND ISPRINT = 'Y' THEN 'BULK' ELSE ULD.ULDNUM END ULDULDNUM, ULD.ULDOCP ULDULDOCP, ULD.ULDDST

ULDULDDST,

		       SHP.CUSREF SHPCUSREF, SHP.MFTPCS SHPPCS, SHP.MFTWGT SHPWGT,
		       SHP.MFTVOL

SHPVOL, SHP.FLTCARIDR
SHPFLTCARIDR, SHP.FLTNUM SHPFLTNUM,
		       ULD.GRSWGT, ULD.NETWGT, ULD.THRUNT,ULD.BDNITN, 

ULD.ULDCTR, ULD.TARWGT,nvl(ULD.INRSTWLSS,0)
INRSTWLSS,NVL(ULD.OUTSTWLSS,0)OUTSTWLSS,ULD.BDPFLG,


		       SHP.FLTSEQNUM SHPFLTSEQNUM, SHP.SEGSERNUM
SHPSEGSERNUM,
		       CASE WHEN ULD.BARROWFLG =
'Y' AND ISPRINT
= 'Y' THEN 'BULK' ELSE SHP.ULDNUM END
SHPULDNUM, SHP.DOCOWRIDR SHPDOCOWRIDR,

CASE WHEN ULD.BARROWFLG
= 'Y' AND ISPRINT = 'Y' AND NVL(EXPFLT.FINFLG,'
') NOT IN('F','R') THEN SHP.ULDNUM
ELSE SHP.RMK END
MFTRMK,
		       SHP.MSTDOCNUM SHPMSTDOCNUM, SHP.DUPNUM
SHPDUPNUM, SHP.SEQNUM SHPSEQNUM,

		       SHP.RMK
SHPRMK, SHP.CMPCOD SHPCMPCOD,SHP.SLCPCS,



SEG.CMPCOD SEGCMPCOD, SEG.FLTCARIDR
SEGFLTCARIDR,
SEG.FLTNUM SEGFLTNUM,
		       SEG.FLTSEQNUM SEGFLTSEQNUM,
SEG.POL SEGPOL, SEG.POU SEGPOU,


		       SEG.SEGSERNUM SEGSEGSERNUM, RTG.SERNUM RTGSERNUM,
		       RTG.SEGSERNUM
RTGSEGSERNUM, RTG.FLTSEQNUM

RTGFLTSEQNUM,
		       RTG.FLTNUM RTGFLTNUM, RTG.FLTCARIDR RTGCARIDR, RTG.CMPCOD
RTGCMPCOD,


CASE WHEN ULD.BARROWFLG = 'Y' AND ISPRINT = 'Y' THEN 'BULK' ELSE RTG.ULDNUM END RTGULDNUM,
RTG.THRCARIDR

RTGTHRCARIDR,
		       RTG.THRCARCOD RTGTHRCARCOD, RTG.THRFLTNUM RTGTHRFLTNUM,

		       RTG.THRFLTDAT

RTGTHRFLTDAT, RTG.THRDSTCOD RTGTHRDSTCOD, SEGSHP.PLNPCS,
		       SEGSHP.PLNWGT, SEGSHP.PLNVOL,



SEGSHP.MFTPCS SEGSHPMFTPCS, SEGSHP.MFTWGT SEGSHPMFTWGT,
		       SEGSHP.MFTVOL SEGSHPMFTVOL, SHP.LODPRT,


SHP.ADDSCC ADDSCCSCCCOD,ULD.RMK ULDRMK,
		       EXPFLT.FINFLG, EXPFLT.FLTCARCOD, EXPFLT.FLTDAT,



SHP.BDPPCS SHPBDPPCS, SHP.BDPWGT SHPBDPWGT,
		       SHP.BDPVOL SHPBDPVOL, SEGSHP.BDPPCS SEGSHPBDPPCS,



		       SEGSHP.BDPWGT SEGSHPBDPWGT, SEGSHP.BDPVOL SEGSHPBDPVOL,
		       ULD.MFTFLG ULDMFTFLG, ULD.ACTWGT

ACTWGT,MST.RDYCRGFLG,MST.STDWGTCOD,

ULD.LSTUPDTIM ULDLSTUPDTIM, ULD.LSTUPDUSR ULDLSTUPDUSR,


SEGSHP.LSTUPDTIM SEGSHPLSTUPDTIM, SEGSHP.LSTUPDUSR
SEGSHPLSTUPDUSR,
		       RTG.LSTUPDTIM RTGLSTUPDTIM,

RTG.LSTUPDUSR RTGLSTUPDUSR,
		       ARPSHP.LSTUPDTIM
ARPSHPLSTUPDTIM, ARPSHP.LSTUPDUSR ARPSHPLSTUPDUSR,


		       EXPFLT.LSTUPDTIM EXPFLTLSTUPDTIM, EXPFLT.LSTUPDUSR
EXPFLTLSTUPDUSR,
		       DTL.LSTUPDTIM
DTLLSTUPDTIM,
DTL.LSTUPDUSR DTLLSTUPDUSR, ULD.ULDSTA,

		       COALESCE(ULD.BARROWFLG, 'N')
BARROWFLG
		        ,EXPFLT.ARPCOD, 



MST.SHPPFX, ULD.LOCCOD,
					   ULD.BUPFLG BUPFLG,  ULD.ULDBKGIDR ULDBKGIDR,  ULD.ULDLKGCNFFLG ULDCNFFLG,


ULD.BKGTYP BKGTYP,MST.EFTAWBFLG,MST.SCCCOD MSTSCCCOD,MST.PLTFLG PLTFLG,DTL.PLTUSEFLG PLTUSEFLG,MST.CONFLG,MIS.SCICOD SCICOD,ACC.SRVCRGCLS, ARPSHP.PLTUSEFLG ARPPLTUSEFLG

		  FROM OPRSEGULD ULD,

OPRSEGULDSHP
SHP,

OPRFLTSEG SEG,
		       OPRULDTHRRTG RTG,
		       OPRSEGSHP SEGSHP,

OPRARPEXPFLT
EXPFLT,


		       OPRSHPDTL DTL,
		       OPRARPSHP ARPSHP,
			   OPRSHPMST MST,
		       (SELECT ? ISPRINT FROM DUAL),
			   OPRSHPMSTMIS MIS,
		       OPRSHPMSTACC ACC
		 WHERE EXPFLT.FLTCARIDR

= SEG.FLTCARIDR(+)

			AND EXPFLT.FLTNUM        = SEG.FLTNUM(+)
			AND EXPFLT.FLTSEQNUM     = SEG.FLTSEQNUM(+)


			AND EXPFLT.CMPCOD
= SEG.CMPCOD(+)
			AND EXPFLT.ARPCOD        = SEG.POL(+)
			AND SEG.FLTCARIDR

= ULD.FLTCARIDR(+)

			AND SEG.FLTNUM           = ULD.FLTNUM(+)
			AND SEG.FLTSEQNUM        = ULD.FLTSEQNUM(+)


			AND SEG.CMPCOD
= ULD.CMPCOD(+)
			AND SEG.SEGSERNUM        = ULD.SEGSERNUM(+)
			AND ULD.FLTCARIDR

= SHP.FLTCARIDR(+)

AND ULD.FLTNUM           = SHP.FLTNUM(+)
			AND ULD.FLTSEQNUM        = SHP.FLTSEQNUM(+)


AND ULD.SEGSERNUM
= SHP.SEGSERNUM(+)
			AND ULD.CMPCOD           = SHP.CMPCOD(+)
			AND ULD.ULDNUM

= SHP.ULDNUM(+)

AND SHP.DOCOWRIDR        = SEGSHP.DOCOWRIDR(+)
			AND SHP.MSTDOCNUM        = SEGSHP.MSTDOCNUM(+)


			AND
SHP.DUPNUM           = SEGSHP.DUPNUM(+)
			AND SHP.SEQNUM           = SEGSHP.SEQNUM(+)
			AND
SHP.CMPCOD

= SEGSHP.CMPCOD(+)
			AND SHP.FLTCARIDR        = SEGSHP.FLTCARIDR(+)
			AND SHP.FLTNUM
= SEGSHP.FLTNUM(+)


AND SHP.FLTSEQNUM        = SEGSHP.FLTSEQNUM(+)
			AND SHP.SEGSERNUM        =
SEGSHP.SEGSERNUM(+)

			AND
ULD.FLTCARIDR        = RTG.FLTCARIDR(+)
			AND ULD.FLTNUM           =
RTG.FLTNUM(+)
			AND ULD.FLTSEQNUM

= RTG.FLTSEQNUM(+)
			AND ULD.SEGSERNUM        = RTG.SEGSERNUM(+)

AND ULD.CMPCOD           = RTG.CMPCOD(+)


AND ULD.ULDNUM           = RTG.ULDNUM(+)
			AND SHP.DOCOWRIDR
= MST.DOCOWRIDR(+)
			AND SHP.MSTDOCNUM

= MST.MSTDOCNUM(+)
			AND SHP.DUPNUM           = MST.DUPNUM(+)

AND SHP.SEQNUM           = MST.SEQNUM(+)


			AND SHP.CMPCOD           = MST.CMPCOD(+)
			AND MST.DOCOWRIDR
= DTL.DOCOWRIDR(+)
			AND MST.MSTDOCNUM

= DTL.MSTDOCNUM(+)
			AND MST.DUPNUM           = DTL.DUPNUM(+)

AND MST.SEQNUM           = DTL.SEQNUM(+)


			AND MST.CMPCOD           = DTL.CMPCOD(+)
			AND DTL.DOCOWRIDR
= ARPSHP.DOCOWRIDR(+)
			AND
DTL.MSTDOCNUM
= ARPSHP.MSTDOCNUM(+)
			AND DTL.DUPNUM
= ARPSHP.DUPNUM(+)
			AND DTL.SEQNUM
= ARPSHP.SEQNUM(+)

			AND DTL.CMPCOD           =
ARPSHP.CMPCOD(+)
			AND ( ARPSHP.ARPCOD IS NULL
OR EXPFLT.ARPCOD = ARPSHP.ARPCOD)
			AND MST.DOCOWRIDR      = MIS.DOCOWRIDR(+)
			AND MST.MSTDOCNUM      = MIS.MSTDOCNUM(+)
			AND MST.DUPNUM         = MIS.DUPNUM(+)
			AND MST.SEQNUM         = MIS.SEQNUM(+)
			AND MST.CMPCOD         = MIS.CMPCOD(+)
			AND MST.DOCOWRIDR      = ACC.DOCOWRIDR(+)
			AND MST.MSTDOCNUM      = ACC.MSTDOCNUM(+)
			AND MST.DUPNUM         = ACC.DUPNUM(+)
			AND MST.SEQNUM         = ACC.SEQNUM(+)
			AND MST.CMPCOD         = ACC.CMPCOD(+)
		    AND EXPFLT.FLTCARIDR = ?
		    AND EXPFLT.FLTNUM = ?
		    AND EXPFLT.FLTSEQNUM = ?
		    AND EXPFLT.CMPCOD = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>8</QRY:Id>
		<QRY:Source Name="operations.manifest.findfreightmanifestdetailswithversion" Type="NATIVE">
			<![CDATA[
		SELECT ULD.BSEFLG,ULD.BSEPLT,
			ULD.CMPCOD ULDCMPCOD,  ULD.ARPCOD ULDARPCOD, ULD.FLTCARIDR ULDFLTCARIDR,



			ULD.FLTNUM ULDFLTNUM, ULD.FLTSEQNUM ULDFLTSEQNUM, ULD.LEGSERNUM ULDLEGSERNUM, ULD.BDPCMPSTA BDPCMPSTA,
			ULD.MFTVER ULDMFTVER,


CASE WHEN ULD.BARROWFLG = 'Y' AND ISPRINT = 'Y' THEN 'BULK' ELSE ULD.ULDNUM END ULDULDNUM, ULD.GRSWGT


ULDGRSWGT, ULD.NETWGT ULDNETWGT,
			ULD.POL ULDPOL, ULD.POU ULDPOU, ULD.THRUNT ULDTHRUNT, ULD.ULDCTR,



			SHP.CMPCOD SHPCMPCOD, SHP.ARPCOD SHPARPCOD, SHP.FLTCARIDR SHPFLTCARIDR, SHP.FLTNUM SHPFLTNUM,


SHP.FLTSEQNUM
SHPFLTSEQNUM, SHP.LEGSERNUM SHPLEGSERNUM, CASE WHEN ULD.BARROWFLG = 'Y' AND ISPRINT =

'Y' THEN 'BULK'
ELSE SHP.ULDNUM END SHPULDNUM,
			CASE WHEN ULD.BARROWFLG = 'Y' AND ISPRINT = 'Y'
THEN
SHP.ULDNUM ELSE
SHP.RMK END MFTRMK,
			SHP.DOCOWRIDR SHPDOCOWRIDR, SHP.MSTDOCNUM SHPMSTDOCNUM,
SHP.DUPNUM
SHPDUPNUM,
SHP.SEQNUM SHPSEQNUM,
			SHP.CUSREF SHPCUSREF, SHP.DSTCOD SHPDSTCOD, SHP.ORGCOD
SHPORGCOD,
SHP.MFTPCS
SHPMFTPCS,
			SHP.MFTWGT SHPMFTWGT, SHP.MFTVOL SHPMFTVOL,  SHP.LODPRT SHPPRDPRT,

SHP.PRDCOD
SHPPRDCOD,
SHP.SCCCOD SHPSCCCOD, SHP.SHPDES SHPSHPDES, SHP.RMK SHPRMK,
			RTG.CMPCOD RTGCMPCOD,
RTG.ARPCOD
RTGARPCOD,
RTG.FLTCARIDR RTGFLTCARIDR,
			RTG.FLTNUM RTGFLTNUM, RTG.FLTSEQNUM RTGFLTSEQNUM,

RTG.LEGSERNUM
RTGLEGSERNUM,
CASE WHEN ULD.BARROWFLG = 'Y' AND ISPRINT = 'Y' THEN 'BULK' ELSE RTG.ULDNUM
END RTGULDNUM,
RTG.SERNUM
RTGSERNUM,
			RTG.THRCARCOD RTGTHRCARCOD, RTG.THRCARIDR RTGTHRCARIDR,

RTG.THRDSTCOD RTGTHRDSTCOD,

RTG.THRFLTDAT RTGTHRFLTDAT, RTG.THRFLTNUM RTGTHRFLTNUM,
			PCS.CMPCOD PCSCMPCOD,
PCS.DOCOWRIDR PCSDOCOWRIDR,

PCS.MSTDOCNUM PCSMSTDOCNUM,
			 PCS.DUPNUM PCSDUPNUM, PCS.SEQNUM PCSSEQNUM,

			PCS.GRPIDR PCSPCSIDR,  

PCS.ARPCOD PCSARPCOD, PCS.TXNCOD,
			PCS.TXNREFONE, PCS.TXNREFTWO, PCS.TXNREFTHR,

PCS.TXNREFFOR,
PCS.TXNREFFIV,
PCS.TXNREFSIX,
			PCS.TXNREFSEV ,SHP.ADDSCC ADDSCCSCCCOD,ULD.RMK ULDRMK,

			SHP.STDPCS,SHP.STDWGT


			FROM
			OPRMFTULD ULD,OPRMFTULDSHP SHP,OPRMFTTHRRTG RTG,

OPRSHPTXNPCSGRPHIS PCS,OPRSHPPCSGRP SHPPCS,(SELECT

? ISPRINT FROM DUAL)
			WHERE
			ULD.CMPCOD=SHP.CMPCOD(+)
AND
			ULD.ARPCOD=SHP.ARPCOD(+) AND
			ULD.FLTCARIDR=SHP.FLTCARIDR(+)

AND
			ULD.FLTNUM=SHP.FLTNUM(+)
AND
			ULD.FLTSEQNUM=SHP.FLTSEQNUM(+) AND
			ULD.LEGSERNUM=SHP.LEGSERNUM(+)

AND
			ULD.ULDNUM=SHP.ULDNUM(+)
AND
			ULD.MFTVER=SHP.MFTVER(+) AND

			ULD.CMPCOD=RTG.CMPCOD(+) AND


			ULD.ARPCOD=RTG.ARPCOD(+)
AND
			ULD.FLTCARIDR=RTG.FLTCARIDR(+) AND
			ULD.FLTNUM=RTG.FLTNUM(+) AND


			ULD.FLTSEQNUM=RTG.FLTSEQNUM(+)
AND
			ULD.LEGSERNUM=RTG.LEGSERNUM(+) AND
			ULD.ULDNUM=RTG.ULDNUM(+)

AND
			ULD.MFTVER=RTG.MFTVER(+)
AND

			SHP.DOCOWRIDR=PCS.DOCOWRIDR(+) AND
			SHP.MSTDOCNUM=PCS.MSTDOCNUM(+)

AND
			SHP.DUPNUM=PCS.DUPNUM(+)
AND
			SHP.SEQNUM=PCS.SEQNUM(+) AND
			SHP.CMPCOD= PCS.CMPCOD(+) AND





			to_char(SHP.FLTNUM)=PCS.TXNREFONE(+)
AND
			to_char(SHP.FLTCARIDR)=PCS.TXNREFTWO(+) AND
			to_char(SHP.FLTSEQNUM)=PCS.TXNREFTHR(+)

AND


SHP.ULDNUM=PCS.TXNREFSEV(+) AND

			PCS.DOCOWRIDR=SHPPCS.DOCOWRIDR(+) AND
			PCS.MSTDOCNUM=SHPPCS.MSTDOCNUM(+)


AND
			PCS.DUPNUM=SHPPCS.DUPNUM(+) AND
			PCS.SEQNUM=SHPPCS.SEQNUM(+) AND
			PCS.CMPCOD= SHPPCS.CMPCOD(+)


AND
			PCS.GRPIDR= SHPPCS.GRPIDR(+)


			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>9</QRY:Id>
		<QRY:Source Name="operations.flthandling.findarrivalinformation" Type="NATIVE">
			<![CDATA[
	SELECT IMPFLT.FLTCARCOD, SHP.FLTNUM, SHP.RCVPCS, SHP.RCVWGT, IMPFLT.FLTDAT,
	       SHP.MFTPCS, SHP.MFTWGT,


IMPFLT.FLTCARIDR, IMPFLT.FLTSEQNUM,
	       IMPFLT.LEGSERNUM
	  FROM OPRSEGSHP SHP, OPRARPIMPFLT IMPFLT,


OPRFLTSEG FLTSEG
	 WHERE FLTSEG.CMPCOD = IMPFLT.CMPCOD
	   AND FLTSEG.FLTNUM = IMPFLT.FLTNUM
	   AND


FLTSEG.FLTSEQNUM = IMPFLT.FLTSEQNUM
	   AND FLTSEG.FLTCARIDR = IMPFLT.FLTCARIDR
	   AND FLTSEG.POU
=

IMPFLT.ARPCOD
	   AND FLTSEG.CMPCOD = SHP.CMPCOD
	   AND FLTSEG.FLTNUM = SHP.FLTNUM
	   AND FLTSEG.FLTSEQNUM


= SHP.FLTSEQNUM
	   AND FLTSEG.FLTCARIDR = SHP.FLTCARIDR
	   AND FLTSEG.SEGSERNUM = SHP.SEGSERNUM



	   AND SHP.RCVPCS > 0
	   AND SHP.CMPCOD = ?
	   AND IMPFLT.ARPCOD = ?
	   AND SHP.DOCOWRIDR =
?

	   AND
SHP.MSTDOCNUM = ?
	   AND SHP.DUPNUM = ?
	   AND SHP.SEQNUM = ?


			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>10</QRY:Id>
		<QRY:Source Name="operations.manifest.findloadplandetails" Type="NATIVE">
			<![CDATA[
	SELECT

			SHP.FLTCARIDR SHPFLTCARIDR, SHP.CMPCOD SHPCMPCOD,

			SHP.FLTNUM SHPFLTNUM, SHP.FLTSEQNUM


SHPFLTSEQNUM,
			 SHP.SEGSERNUM SHPSEGSERNUM,
			SHP.DOCOWRIDR SHPDOCOWRIDR, SHP.MSTDOCNUM SHPMSTDOCNUM,
			MST.OWRCOD OWRCOD,


			SHP.DUPNUM SHPDUPNUM, SHP.SEQNUM SHPSEQNUM,
			SHP.PLNPCS SHPPCS, SHP.PLNWGT SHPWGT,
			SHP.PLNVOL

SHPVOL,SHP.MFTPCS,SHP.MFTWGT,SHP.MFTVOL,

			FLT.FLTCARIDR FLTFLTCARIDR ,FLT.FLTNUM FLTFLTNUM,


			FLT.FLTSEQNUM FLTFLTSEQNUM,
			FLT.SEGSERNUM FLTSEGSERNUM,
FLT.CMPCOD FLTCMPCOD,
			FLT.POL FLTPOL,

FLT.POU FLTPOU,MST.SHPPFX,
			SHP.BDPPCS,SHP.BDPWGT,SHP.BDPVOL,ARPMST.AVLPCS,
ARPMST.AVLVOL,
			ARPMST.AVLWGT,ARPMST.PLTUSEFLG PLTFLG,MST.STDPCS,MST.STDWGT,MST.SHPDES,MST.SCCCOD,


			MST.ORGCOD,MST.DSTCOD,MST.STDWGTCOD,MST.GRSVOL,MST.GRSVOLUNT,MST.EFTAWBFLG,
			(SELECT COUNT(SRVRCVSTA) 
			FROM QMSSRVRCVCSE SRVCSE 
			WHERE ARPMST.CMPCOD = SRVCSE.CMPCOD 
			AND ARPMST.ARPCOD = SRVCSE.ARPCOD 
			AND ARPMST.DOCOWRIDR = SRVCSE.DOCOWRIDR 
			AND ARPMST.MSTDOCNUM = SRVCSE.MSTDOCNUM 
			AND ARPMST.DUPNUM = SRVCSE.DUPNUM 
			AND ARPMST.SEQNUM = SRVCSE.SEQNUM 
			AND SHP.FLTCARIDR     =SRVCSE.FLTCARIDR
			AND SHP.FLTNUM        =SRVCSE.FLTNUM
			AND SHP.FLTSEQNUM     =SRVCSE.FLTSEQNUM
			AND (SRVCSE.SYSACTTYP ='CP' OR SRVCSE.MANACTTYP ='CP' OR SRVCSE.MANACTTYP ='FP' ) 
			AND SRVCSE.CSETYP ='S' 
			AND SRVCSE.SRVRCVSTA ='A' 
			AND SRVCSE.OPRTYP ='E' 
			)SRVRCVCNT 			

			FROM OPRSEGSHP SHP,OPRFLTSEG FLT, OPRSHPMST MST,OPRARPSHP ARPMST
			WHERE

			SHP.FLTCARIDR=FLT.FLTCARIDR(+)


AND
			SHP.FLTNUM=FLT.FLTNUM(+) AND
			SHP.FLTSEQNUM=FLT.FLTSEQNUM(+) AND
			SHP.SEGSERNUM= FLT.SEGSERNUM(+)


AND
			SHP.CMPCOD=FLT.CMPCOD(+) AND

			SHP.DOCOWRIDR=MST.DOCOWRIDR AND
			SHP.MSTDOCNUM=MST.MSTDOCNUM


AND
			SHP.DUPNUM=MST.DUPNUM AND
			SHP.SEQNUM=MST.SEQNUM AND


			MST.DOCOWRIDR=ARPMST.DOCOWRIDR(+)


AND
			MST.MSTDOCNUM=ARPMST.MSTDOCNUM(+) AND
			MST.DUPNUM=ARPMST.DUPNUM(+) AND
			MST.SEQNUM=ARPMST.SEQNUM(+)


AND
			MST.CMPCOD=ARPMST.CMPCOD(+) AND


			SHP.FLTCARIDR=? AND
			SHP.FLTNUM=? AND
			SHP.FLTSEQNUM=?


AND

			SHP.CMPCOD=? AND

			FLT.POL = ? AND
			ARPMST.ARPCOD(+)=?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>11</QRY:Id>
		<QRY:Source Name="operations.manifest.findshipmentdetailsformanifest" Type="NATIVE">
			<![CDATA[
	SELECT SEGSHP.FLTCARIDR SHPFLTCARIDR,
		  SEGSHP.CMPCOD SHPCMPCOD,
		  SEGSHP.FLTNUM SHPFLTNUM,


		  SEGSHP.FLTSEQNUM SHPFLTSEQNUM,
		  SEGSHP.SEGSERNUM SHPSEGSERNUM,
		  SEGSHP.DOCOWRIDR SHPDOCOWRIDR,


		  SEGSHP.MSTDOCNUM SHPMSTDOCNUM,
		  SEGSHP.DUPNUM SHPDUPNUM,
		  SEGSHP.SEQNUM SHPSEQNUM,
		  SHP.MFTPCS

SHPMFTPCS,
		  SHP.MFTWGT SHPMFTWGT,
		  SHP.MFTVOL SHPMFTVOL,
		  SHP.BDPPCS SHPBDPPCS,
		  SHP.BDPWGT

SHPBDPWGT,
		  SHP.BDPVOL SHPBDPVOL,
		  SEGSHP.PLNPCS,
		  SEGSHP.PLNWGT,
		  SEGSHP.PLNVOL,
		  SEGSHP.MFTVOL

SEGSHPMFTVOL,
		  SEGSHP.MFTWGT SEGSHPMFTWGT,
		  SEGSHP.MFTPCS SEGSHPMFTPCS,
		  SEGSHP.BDPpcs SEGSHPBDPpcs,


		  ARPSHP.AVLPCS,
		  ARPSHP.AVLWGT,
		  ARPSHP.AVLVOL,
		  ARPSHP.PLTUSEFLG ARPPLTUSEFLG,
		  MST.PLTFLG PLTFLG,
		  SEGSHP.BDPWGT SEGSHPBDPWGT,
		  SEGSHP.BDPVOL
SEGSHPBDPVOL,

		  SHP.ADDSCC ADDSCCSCCCOD,
		  FLTSEG.POL,
		  MIS.CRSREFONE,
		  MIS.CRSREFTWO,

SEGSHP.LSTUPDTIM SEGSHPLSTUPDTIM,

		  SEGSHP.LSTUPDUSR SEGSHPLSTUPDUSR,
		  ARPSHP.LSTUPDTIM ARPSHPLSTUPDTIM,

ARPSHP.LSTUPDUSR ARPSHPLSTUPDUSR,

		  MST.RDYCRGFLG,
		  MST.STDPCS,
		  MST.STDWGT,
		  MST.STDWGTCOD,

		  MST.ORGCOD MSTORGCOD,MST.OWRCOD OWRCOD,
		  MST.DSTCOD
MSTDSTCOD,

		 FLT.LEGSERNUM SHPLEGSERNUM,
		  SHP.ULDNUM ULDULDNUM,

FLTSEG.POU,
		 FLT.FLTCARCOD,
		 MIS.SCICOD SCICOD


		FROM OPRSEGULDSHP SHP,
		  OPRSEGSHP SEGSHP,
		  OPRFLTSEG FLTSEG,

OPRARPSHP ARPSHP,
		  OPRSHPMSTMIS
MIS,
		  OPRSHPMST MST,
		  OPRARPEXPFLT FLT

		WHERE MST.DOCOWRIDR
=SEGSHP.DOCOWRIDR
		AND MST.MSTDOCNUM
=SEGSHP.MSTDOCNUM
		AND MST.DUPNUM      =SEGSHP.DUPNUM
		AND
MST.SEQNUM      =SEGSHP.SEQNUM
		AND MST.CMPCOD
=SEGSHP.CMPCOD
		AND FLT.FLTNUM  = SEGSHP.FLTNUM

AND FLT.FLTCARIDR = SEGSHP.FLTCARIDR
		AND FLT.CMPCOD
= SEGSHP.CMPCOD
		AND FLT.FLTSEQNUM = SEGSHP.FLTSEQNUM

AND FLT.ARPCOD    = FLTSEG.POL

		AND SEGSHP.DOCOWRIDR=MIS.DOCOWRIDR(+)

		AND SEGSHP.MSTDOCNUM=MIS.MSTDOCNUM(+)

AND SEGSHP.DUPNUM   =MIS.DUPNUM(+)
		AND SEGSHP.SEQNUM   =MIS.SEQNUM(+)

		AND SEGSHP.CMPCOD   =MIS.CMPCOD(+)

AND SEGSHP.DOCOWRIDR=SHP.DOCOWRIDR(+)
		AND SEGSHP.MSTDOCNUM=SHP.MSTDOCNUM(+)

		AND SEGSHP.DUPNUM
=SHP.DUPNUM(+)
		AND SEGSHP.SEQNUM   =SHP.SEQNUM(+)
		AND SEGSHP.CMPCOD   =SHP.CMPCOD(+)

		AND SEGSHP.DOCOWRIDR=ARPSHP.DOCOWRIDR(+)

AND SEGSHP.MSTDOCNUM=ARPSHP.MSTDOCNUM(+)
		AND SEGSHP.DUPNUM
=ARPSHP.DUPNUM(+)
		AND SEGSHP.SEQNUM
=ARPSHP.SEQNUM(+)
		AND SEGSHP.CMPCOD   =ARPSHP.CMPCOD(+)
		AND
SEGSHP.FLTCARIDR=SHP.FLTCARIDR(+)

AND SEGSHP.FLTNUM   =SHP.FLTNUM(+)
		AND SEGSHP.FLTSEQNUM=SHP.FLTSEQNUM(+)

		AND SEGSHP.SEGSERNUM=SHP.SEGSERNUM(+)

AND SEGSHP.FLTCARIDR=FLTSEG.FLTCARIDR
		AND SEGSHP.FLTNUM   =FLTSEG.FLTNUM

		AND SEGSHP.FLTSEQNUM=FLTSEG.FLTSEQNUM

AND SEGSHP.SEGSERNUM=FLTSEG.SEGSERNUM
		AND SEGSHP.FLTNUM   =?

		AND SEGSHP.FLTSEQNUM=?
		AND SEGSHP.FLTCARIDR=?

AND SEGSHP.DOCOWRIDR=?
		AND SEGSHP.MSTDOCNUM=?
		AND
SEGSHP.DUPNUM   =?
		AND SEGSHP.SEQNUM   =?

AND SEGSHP.CMPCOD   =?
		AND ARPSHP.ARPCOD(+)=?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>11</QRY:Id>
		<QRY:Source Name="operations.manifest.findplannedinformation" Type="NATIVE">
			<![CDATA[
			SELECT PLNPCS, PLNWGT, PLNVOL
			FROM
			OPRSEGSHP
			WHERE DOCOWRIDR=? AND
			MSTDOCNUM=? AND
			DUPNUM=? AND
			SEQNUM=? AND
			FLTNUM=? AND
			FLTSEQNUM=? AND

			FLTCARIDR=? AND
			SEGSERNUM =? AND
			CMPCOD=?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>12</QRY:Id>
		<QRY:Source Name="operations.manifest.findarrivaldetails" Type="NATIVE">
			<![CDATA[
SELECT ULD.CMPCOD ULDCMPCOD,
  ULD.FLTCARIDR ULDFLTCARIDR,
  ULD.FLTNUM ULDFLTNUM,
  ULD.FLTSEQNUM ULDFLTSEQNUM,
					  (
					  CASE ARLMST.APHCODUSE
	WHEN 2					        
	THEN ARLMST.TWOAPHCOD 
	ELSE ARLMST.THRAPHCOD 
			END) FLTCARCOD,
  ULD.SEGSERNUM ULDSEGSERNUM,
  ULD.THRUNT,
  ULD.CONIDR CONIDR,
  ULD.ULDNUM ULDULDNUM,
					  SHP.CUSREF SHPCUSREF,
					  SHP.MFTPCS SHPPCS,
					  SHP.MFTWGT SHPWGT,
					  SHP.MFTVOL SHPVOL,
					  SHP.FLTCARIDR SHPFLTCARIDR,
					  SHP.FLTNUM SHPFLTNUM,
					  SHP.RCVPCS SHPRCVPCS,
					  SHP.RCVWGT SHPRCVWGT,
					  SHP.FLTSEQNUM SHPFLTSEQNUM,
					  SHP.CUSREF SHPCUSREF,
					  SHP.SEGSERNUM SHPSEGSERNUM,
					  SHP.ULDNUM SHPULDNUM,
					  SHP.DOCOWRIDR SHPDOCOWRIDR,
					  SHP.MSTDOCNUM SHPMSTDOCNUM,
					  SHP.DUPNUM SHPDUPNUM,
					  SHP.SEQNUM SHPSEQNUM,
					  ULD.RMK ULDRMK,
					  SHP.CMPCOD SHPCMPCOD,
  SHP.FLTCARIDR 
SHPFLTCARIDR,
  SHP.FLTSEQNUM 
SHPFLTSEQNUM,
  SHP.DOCOWRIDR 
SHPDOCOWRIDR,
  ULD.RMK 
ULDRMK,
  MST.CNSNAM MSTCNSNAM,
  MST.STDWGT,
  MST.STDPCS,
  MST.GRSVOL,

MST.SCCCOD MSTSCCCOD,
					  MST.SHPDES MSTSHPDES,
					  MST.ORGCOD MSTORGCOD,
					  MST.DSTCOD MSTDSTCOD,
					  MST.STDWGTCOD MSTSTDWGTCOD,
					  MST.STDDISWGT MSTSTDDISWGT,
					  MST.PRDNAM MSTPRDNAM,
					  MST.PRDPRT MSTPRDPRT,
					  MST.SHPPFX,
					  SEG.CMPCOD SEGCMPCOD,
					  SEG.FLTCARIDR SEGFLTCARIDR,
					  SEG.FLTNUM SEGFLTNUM,
					  SEG.FLTSEQNUM SEGFLTSEQNUM,
					  SEG.POL SEGPOL,
					  SEG.POU SEGPOU,
					  SEG.SEGSERNUM SEGSEGSERNUM,
					  RTG.SERNUM RTGSERNUM,
					  RTG.SEGSERNUM RTGSEGSERNUM,
					  RTG.FLTSEQNUM RTGFLTSEQNUM,
					  RTG.FLTNUM RTGFLTNUM,
					  RTG.FLTCARIDR RTGCARIDR,
					  RTG.CMPCOD RTGCMPCOD,
  MST.STDWGTCOD 
MSTSTDWGTCOD,
 MST.EXEFLG,
  
  


RTG.ULDNUM RTGULDNUM,
  RTG.THRCARIDR RTGTHRCARIDR,
  RTG.THRCARCOD RTGTHRCARCOD,
					  RTG.THRFLTNUM RTGTHRFLTNUM,
					  RTG.THRFLTDAT RTGTHRFLTDAT,
					  RTG.THRDSTCOD RTGTHRDSTCOD,
					  MST.STDPCS,
					  MST.STDWGT,
					  MST.GRSVOL,


MST.EFTAWBFLG,
  SEGSHP.DOCOWRIDR SEGSHPDOCOWRIDR,
  SEGSHP.MSTDOCNUM SEGSHPMSTDOCNUM,
					  SEGSHP.DUPNUM SEGSHPDUPNUM,
					  SEGSHP.SEQNUM SEGSHPSEQNUM,
					  SEGSHP.FLTNUM SEGSHPFLTNUM,
					  SEGSHP.FLTSEQNUM SEGSHPFLTSEQNUM,
					  SEGSHP.SEGSERNUM SEGSHPSEGSERNUM,
					  SEGSHP.FLTCARIDR SEGSHPFLTCARIDR,
					  SEGSHP.CMPCOD SEGSHPCMPCOD,
					  SEGSHP.MFTPCS SEGSHPMFTPCS,
					  SEGSHP.MFTWGT SEGSHPMFTWGT,
					  SEGSHP.MFTVOL SEGSHPMFTVOL,
					  SEGSHP.RCVPCS SEGSHPRCVPCS,
					  SEGSHP.RCVWGT SEGSHPRCVWGT,
					  SEGSHP.RCVVOL SEGSHPRCVVOL,
					  SEGSHP.PLNPCS SEGSHPPLNPCS,



  

  SEGSHP.PLNWGT SEGSHPPLNWGT,
	SEGSHP.PLNVOL SEGSHPPLNVOL,
  SEGSHP.ARVRMK SEGSHPARVRMK,
  ARPSHP.CUSCLRREQFLG,

  ARPSHP.CUSCLRSTA,
  ARPSHP.SECCLRREQFLG,
  ARPSHP.SECCLRSTA,
  SHPDTL.PLTUSEFLG,

  MST.PLTFLG,
  ARPSHP.BNKRELREQFLG,
					  SEGSHP.LSTUPDTIM SHPUPDTIM,
					  ULD.LSTUPDTIM ULDUPDTIM,
					  RTG.LSTUPDTIM RTGUPDTIM,
					  ARPSHP.LSTUPDTIM ARPUPDTIM,
  MIS.SCICOD,
  MST.CONFLG,
  ARPSHP.DOCRCVFLG,
  CNT.CTTCUSCOD,
    MST.RDYCRGFLG,
     (SELECT DISTINCT TXNCOD
  FROM OPRSHPHIS
  WHERE DOCOWRIDR = SEGSHP.DOCOWRIDR
					  AND MSTDOCNUM   = SEGSHP.MSTDOCNUM
  AND DUPNUM      = SEGSHP.DUPNUM
  AND SEQNUM      = SEGSHP.SEQNUM
					  AND CMPCOD      = SEGSHP.CMPCOD

  AND TXNREFTWO   = SEGSHP.FLTCARIDR
  AND TXNREFTHR   = SEGSHP.FLTNUM
					  AND TXNREFFIV   = SEGSHP.FLTSEQNUM
  AND TXNCOD      = 'AWR'
  ) AS AWRRCVSTA,
					  (SELECT 'Y'
					  FROM DUAL
					  WHERE EXISTS
    (SELECT 1
    FROM OPRSHPHIS HIS
	WHERE HIS.CMPCOD = MST.CMPCOD
	AND HIS.DOCOWRIDR = MST.DOCOWRIDR

	AND HIS.MSTDOCNUM = MST.MSTDOCNUM
	AND HIS.DUPNUM = MST.DUPNUM
	AND HIS.SEQNUM = MST.SEQNUM
						AND HIS.ARPCOD    = MST.DSTCOD
						AND HIS.TXNREFTWO = SEGSHP.FLTCARIDR
	AND HIS.TXNREFTHR = SEGSHP.FLTNUM
	AND HIS.TXNREFFIV = SEGSHP.FLTSEQNUM
						AND HIS.TXNCOD    ='NFD'
    )
  ) CUSNFDFLG,
  CHG.PAYTYP
CHGPAYTYP,
  MST.PAYTYP MSTPAYTYP,
  ARPMST.CNTCOD CNTCODDST,
					  ARPMSTORG.CNTCOD CNTCODORG,
					  (
					  CASE
						WHEN MST.DSTCOD=SEG.POU
						THEN TO_CHAR(QMSPLN.MILSTNTIM,'dd-MON-YYYY/HH24:MI')
						ELSE
						  (SELECT (
							CASE
							  WHEN (BKGFLT.FLTCARCOD IS NOT NULL
							  AND ISSPRTARL           ='Y'
							  AND BKGFLT.FLTBKGSTA    ='C')
							  THEN BKGFLT.FLTCARCOD
								||BKGFLT.FLTNUM
								||' '
								||TO_CHAR(BKGFLT.FLTDAT,'dd-MON-YYYY')
							  WHEN (BKGFLT.FLTCARCOD IS NOT NULL
							  AND ISSPRTARL           ='Y'
							  AND BKGFLT.FLTBKGSTA   <> 'C')
							  THEN 'EXPORT '
								||MST.DSTCOD
							  WHEN (BKGFLT.UBRNUM   IS NOT NULL
							  AND (NVL(ISSPRTARL,'N')='N'))
							  THEN 'Transfer to '
								||BKGFLT.FLTCARCOD
							  ELSE ''
							END) AS ONWFLTINFO
						  FROM
							(SELECT ARLACTMST.ARLIDR,
							  CASE
								WHEN ARLACTMST.OWNARLIND = 'Y'
								THEN ARLACTMST.OWNARLIND
								WHEN ARLACTMST.ISSPRTARL = 'Y'
								THEN ARLACTMST.ISSPRTARL
							  END ISSPRTARL
							FROM SHRARLMST ARLACTMST
							WHERE ARLACTMST.CMPCOD = ?
							)
						  WHERE ARLIDR = BKGFLT.FLTCARIDR
						  )
					  END) AS ONWFLTINFO,
  (SELECT COUNT (1) FROM OPRSHPHSE HSE 
   WHERE HSE.CMPCOD  = MST.CMPCOD
    AND HSE.DOCOWRIDR = MST.DOCOWRIDR
    AND HSE.MSTDOCNUM = MST.MSTDOCNUM
    AND HSE.DUPNUM    = MST.DUPNUM) HWBCNT,
						 ARPSHP.PLTUSEFLG ARPPLTUSEFLG,
						 (SELECT 'Y'
					FROM DUAL
					WHERE EXISTS
					(SELECT 1
					FROM OPRSHPNOT SHPNOT
					WHERE SHPNOT.CMPCOD = MST.CMPCOD
					AND SHPNOT.DOCOWRIDR = MST.DOCOWRIDR
					AND SHPNOT.MSTDOCNUM = MST.MSTDOCNUM
					AND SHPNOT.DUPNUM = MST.DUPNUM
					AND SHPNOT.SEQNUM = MST.SEQNUM
					AND SHPNOT.TXNCOD ='NTF')
					) MNLNFDFLG
					FROM OPRSEGSHP SEGSHP
					JOIN OPRSHPMST MST
					ON SEGSHP.MSTDOCNUM  =MST.MSTDOCNUM
					AND SEGSHP.DOCOWRIDR =MST.DOCOWRIDR
					AND SEGSHP.DUPNUM    =MST.DUPNUM
	AND SEGSHP.SEQNUM =MST.SEQNUM 
	AND SEGSHP.CMPCOD =MST.CMPCOD 
					INNER JOIN OPRFLTSEG SEG
	ON SEGSHP.FLTCARIDR =SEG.FLTCARIDR
	AND SEGSHP.FLTNUM =SEG.FLTNUM
	AND
SEGSHP.FLTSEQNUM=SEG.FLTSEQNUM
	AND SEGSHP.SEGSERNUM=SEG.SEGSERNUM
	AND SEGSHP.CMPCOD =SEG.CMPCOD
					INNER JOIN OPRSEGULDSHP SHP

	ON SEGSHP.DOCOWRIDR =SHP.DOCOWRIDR
	AND SEGSHP.MSTDOCNUM=SHP.MSTDOCNUM

	AND SEGSHP.DUPNUM =SHP.DUPNUM
	AND SEGSHP.SEQNUM =SHP.SEQNUM
	AND SEGSHP.FLTCARIDR=SHP.FLTCARIDR

	AND SEGSHP.FLTNUM =SHP.FLTNUM
	AND SEGSHP.FLTSEQNUM=SHP.FLTSEQNUM
	AND SEGSHP.SEGSERNUM=SHP.SEGSERNUM
					INNER JOIN OPRSHPMSTMIS MIS
					ON MST.MSTDOCNUM  =MIS.MSTDOCNUM
					AND MST.DOCOWRIDR =MIS.DOCOWRIDR
					AND MST.DUPNUM    =MIS.DUPNUM
					AND MST.SEQNUM    =MIS.SEQNUM
					AND MST.CMPCOD    = MIS.CMPCOD
					INNER JOIN SHRARPMST ARPMST
					ON SEG.CMPCOD = ARPMST.CMPCOD
					AND SEG.POU   = ARPMST.ARPCOD
					INNER JOIN SHRARLMST ARLMST
					ON SEGSHP.CMPCOD     = ARLMST.CMPCOD
					AND SEGSHP.FLTCARIDR = ARLMST.ARLIDR
					LEFT OUTER JOIN OPRSHPCHGDTL CHG
					ON MST.MSTDOCNUM  = CHG.MSTDOCNUM
					AND MST.DOCOWRIDR = CHG.DOCOWRIDR
					AND MST.DUPNUM    = CHG.DUPNUM
					AND MST.SEQNUM    = CHG.SEQNUM
					AND MST.CMPCOD    = CHG.CMPCOD
					LEFT OUTER JOIN OPRSHPADLCNT CNT
					ON MST.MSTDOCNUM  =CNT.MSTDOCNUM
					AND MST.DOCOWRIDR =CNT.DOCOWRIDR
					AND MST.DUPNUM    =CNT.DUPNUM
					AND MST.SEQNUM    =CNT.SEQNUM
					AND MST.CMPCOD    = CNT.CMPCOD
					AND CNT.CNTTYP    = 'B'
	LEFT OUTER JOIN OPRARPSHP ARPSHP
	ON SEGSHP.DOCOWRIDR =ARPSHP.DOCOWRIDR
	AND SEGSHP.MSTDOCNUM=ARPSHP.MSTDOCNUM
	AND SEGSHP.DUPNUM =ARPSHP.DUPNUM
	AND SEGSHP.SEQNUM =ARPSHP.SEQNUM
					AND SEGSHP.CMPCOD   = ARPSHP.CMPCOD
					AND ARPSHP.ARPCOD   = ?
					LEFT OUTER JOIN OPRSHPDTL SHPDTL
					ON SEGSHP.DOCOWRIDR =SHPDTL.DOCOWRIDR
					AND SEGSHP.MSTDOCNUM=SHPDTL.MSTDOCNUM

	AND SEGSHP.DUPNUM =SHPDTL.DUPNUM
					AND SEGSHP.SEQNUM   =SHPDTL.SEQNUM
	AND SEGSHP.CMPCOD = SHPDTL.CMPCOD
	LEFT OUTER JOIN OPRSEGULD ULD
					ON SHP.FLTCARIDR =ULD.FLTCARIDR


	AND SHP.FLTNUM =ULD.FLTNUM
	AND SHP.FLTSEQNUM=ULD.FLTSEQNUM
	AND SHP.SEGSERNUM=ULD.SEGSERNUM
					AND SHP.ULDNUM   =ULD.ULDNUM
	
AND SHP.CMPCOD =ULD.CMPCOD
	LEFT OUTER JOIN OPRULDTHRRTG RTG
					ON ULD.FLTCARIDR =RTG.FLTCARIDR
					AND ULD.FLTNUM   =RTG.FLTNUM

	AND ULD.FLTSEQNUM=RTG.FLTSEQNUM
	AND ULD.SEGSERNUM=RTG.SEGSERNUM

	AND ULD.CMPCOD =RTG.CMPCOD
	AND ULD.ULDNUM =RTG.ULDNUM
	LEFT OUTER JOIN SHRARPMST ARPMSTORG
					ON SEG.CMPCOD = ARPMSTORG.CMPCOD
					AND SEG.POL   = ARPMSTORG.ARPCOD
					LEFT OUTER JOIN CAPBKGFLTDTL BKGFLT
					ON MST.CMPCOD     = BKGFLT.CMPCOD
					AND MST.UBRNUM    = BKGFLT.UBRNUM
					AND MST.DOCOWRIDR = BKGFLT.DOCOWRIDR
					AND MST.MSTDOCNUM = BKGFLT.MSTDOCNUM
					AND MST.DUPNUM    = BKGFLT.DUPNUM
					AND MST.SEQNUM    = BKGFLT.SEQNUM
					AND SEG.POU       = BKGFLT.FLTORG
					LEFT OUTER JOIN QMSSHPMILSTNPLN QMSPLN
					ON MST.CMPCOD        = QMSPLN.CMPCOD
					AND MST.DOCOWRIDR    = QMSPLN.DOCOWRIDR
					AND MST.MSTDOCNUM    = QMSPLN.MSTDOCNUM
					AND MST.DUPNUM       = QMSPLN.DUPNUM
					AND MST.SEQNUM       = QMSPLN.SEQNUM
					AND QMSPLN.PLNTYP    = 'SR' 
					AND QMSPLN.MILSTNCOD ='NFD' 





			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>11</QRY:Id>
		<QRY:Source Name="operations.manifest.validateuldformanifest" Type="NATIVE">
			<![CDATA[
	SELECT ULD.FLTCARIDR, ULD.FLTNUM, ULD.FLTSEQNUM, ULD.ULDNUM,FLTLEG.LEGORG AS POL,
			  (CASE ARLMST.APHCODUSE



			   WHEN 2
			      THEN ARLMST.TWOAPHCOD
			   ELSE ARLMST.THRAPHCOD
		     END) FLTCARCOD, FLTLEG.STD

FLTDAT

		  FROM OPRULDDTL ULD LEFT OUTER JOIN
				SHRARLMST ARLMST ON
				ULD.CMPCOD = ARLMST.CMPCOD


				AND  ULD.FLTCARIDR
= ARLMST.ARLIDR
			LEFT OUTER JOIN  FLTOPRLEG FLTLEG ON
				ULD.FLTNUM = FLTLEG.FLTNUM

AND
				ULD.FLTCARIDR
= FLTLEG.FLTCARIDR AND
				ULD.FLTSEQNUM = FLTLEG.FLTSEQNUM AND
				ULD.LEGSERNUM

= FLTLEG.LEGSERNUM
AND
				ULD.CMPCOD = FLTLEG.CMPCOD
	 WHERE (ULD.CLSFLG IS NULL OR ULD.CLSFLG = ?)


	   AND ULD.ULDNUM
= ?
	   AND ULD.CMPCOD = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<!--Modified by A-5103 for ICRD-72272 added mftpcs>0 -->
	<QRY:Definition>
		<QRY:Id>11</QRY:Id>
		<QRY:Source Name="operations.flthandling.arrival.findshipmentsegmentforvalidate" Type="NATIVE">
			<![CDATA[
			SELECT SEGSHP.FLTCARIDR, SEGSHP.CMPCOD, SEGSHP.FLTNUM,
				SEGSHP.FLTSEQNUM,  SEGSHP.SEGSERNUM,MST.ORGCOD,



				MST.DSTCOD,MST.STDPCS,MST.DTACPTFLG,IMPFLT.FLTDAT,IMPFLT.FLTCARCOD,
				SEGSHP.DOCOWRIDR, SEGSHP.MSTDOCNUM,


SEGSHP.DUPNUM,MST.SHPPFX,
				SEGSHP.SEQNUM, SEGSHP.MFTPCS, SEGSHP.MFTWGT, MST.SHPPFX,MST.OWRCOD,



				SEGSHP.MFTVOL, SEGSHP.RCVPCS, SEGSHP.RCVWGT, SEGSHP.RCVVOL,MST.CONFLG,FLTSEG.POL,FLTSEG.POU

FROM
OPRSEGSHP
SEGSHP,OPRSHPMST MST,OPRFLTSEG FLTSEG,OPRARPIMPFLT IMPFLT
				WHERE
				SEGSHP.CMPCOD=MST.CMPCOD(+)


AND
				SEGSHP.DOCOWRIDR=MST.DOCOWRIDR(+) AND
				SEGSHP.MSTDOCNUM=MST.MSTDOCNUM(+) AND
				SEGSHP.DUPNUM=MST.DUPNUM(+)


AND
				SEGSHP.SEQNUM=MST.SEQNUM(+) AND

				SEGSHP.FLTCARIDR=FLTSEG.FLTCARIDR(+) AND
				SEGSHP.FLTNUM=FLTSEG.FLTNUM(+)


AND
				SEGSHP.FLTSEQNUM=FLTSEG.FLTSEQNUM(+) AND
				SEGSHP.SEGSERNUM=FLTSEG.SEGSERNUM(+) AND
				SEGSHP.CMPCOD=FLTSEG.CMPCOD(+)


AND

				FLTSEG.FLTCARIDR=IMPFLT.FLTCARIDR(+) AND
				FLTSEG.FLTNUM=IMPFLT.FLTNUM(+) AND
				FLTSEG.FLTSEQNUM=IMPFLT.FLTSEQNUM(+)


AND
				FLTSEG.CMPCOD=IMPFLT.CMPCOD(+) AND
				FLTSEG.POU=IMPFLT.ARPCOD(+) AND

				SEGSHP.FLTNUM=?

AND

SEGSHP.FLTSEQNUM =? AND
				SEGSHP.FLTCARIDR =? AND
				SEGSHP.CMPCOD=?
				AND SEGSHP.MFTPCS    > 0
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>12</QRY:Id>
		<QRY:Source Name="operations.flthandling.findloadplanulds" Type="NATIVE">
			<![CDATA[
		SELECT ULD.CMPCOD ULDCMPCOD, ULD.FLTCARIDR ULDFLTCARIDR, ULD.FLTNUM ULDFLTNUM,
		       ULD.FLTSEQNUM


ULDFLTSEQNUM, ULD.SEGSERNUM ULDSEGSERNUM,
		       ULD.ULDNUM ULDULDNUM,  FLT.POL FLTPOL,

FLT.POU

FLTPOU,
			   ARPULD.GRSWGT ULDGRSWGT, ARPULD.NETWGT ULDNETWGT, ULDTYPMST.TAREWGT ULDTARWGT,
ULDSHP.NUMPCS,

ULDSHP.WGT, ARPULD.ULDCTR, ARPULD.ULDOCP, ARPULD.ACTWGT, ARPULD.BRWFLG
		  FROM OPRLODPLNULD
ULD, OPRFLTSEG FLT, OPRLODPLNPOL POL, OPRARPULD ARPULD,
		       SHRULDTYPMST

ULDTYPMST, OPRULDSHP
ULDSHP
		 WHERE FLT.FLTCARIDR = POL.FLTCARIDR
		   AND FLT.FLTNUM = POL.FLTNUM


		   AND FLT.FLTSEQNUM
= POL.FLTSEQNUM
		   AND FLT.CMPCOD = POL.CMPCOD
		   AND FLT.POL = POL.POL


		   AND
ULD.CMPCOD
= ARPULD.CMPCOD(+)
		   AND ULD.ACTULDNUM = ARPULD.ULDNUM(+)
   		   AND ULD.CMPCOD = ULDSHP.CMPCOD(+)


   		   AND ULD.ACTULDNUM = ULDSHP.ULDNUM(+)
		   AND ULD.FLTCARIDR = POL.FLTCARIDR
		   AND ULD.FLTNUM

= POL.FLTNUM

		   AND ULD.FLTSEQNUM = POL.FLTSEQNUM
		   AND ULD.CMPCOD = POL.CMPCOD
   		   AND
ULD.CMPCOD = ULDTYPMST.CMPCOD

   		   AND SUBSTR(ULD.ACTULDNUM,0,3) = ULDTYPMST.ULDTYPCOD


		   AND ULD.FLTCARIDR = ?
		   AND ULD.FLTNUM = ?

		   AND ULD.FLTSEQNUM = ?
		   AND ULD.CMPCOD
=
?
		   AND ((? <> 'null' AND FLT.POU = ?) OR ? = 'null')

		   AND FLT.POL = ?
		   AND ULD.ACTULDNUM
NOT IN (
		          SELECT SEG.ULDNUM
		            FROM OPRSEGULD
SEG
		           WHERE SEG.FLTCARIDR

= ULD.FLTCARIDR
		             AND SEG.FLTNUM = ULD.FLTNUM

AND SEG.FLTSEQNUM = ULD.FLTSEQNUM


		             AND SEG.SEGSERNUM = ULD.SEGSERNUM
             AND SEG.CMPCOD
= ULD.CMPCOD)
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>13</QRY:Id>
		<QRY:Source Name="operations.flthandling.findnotocdgrdetails" Type="NATIVE">
			<![CDATA[
	SELECT NTC.CMPCOD,
	  NTC.DOCOWRIDR,
	  NTC.MSTDOCNUM,
	  NTC.DUPNUM,
	  NTC.ULDNUM,
	  NTC.SCCCOD,



	  NTC.UNIIDR,
	  NTC.PKGGRP,
	  NTC.PKGINS,
	  NTC.NUMPKG,
	  NTC.PCSINNULD,
	  NTC.FLTCARIDR,

NTC.FLTNUM,


	  NTC.FLTSEQNUM,
	  NTC.LEGSERNUM,
	  NTC.SEQNUM,
	  NTC.SERNUM,
	  NTC.LSTUPDUSR,

NTC.LSTUPDTIM,


	  NTC.PROSHPNAM PRPSHPNAM,
	  NTC.RMC,
	  NTC.PKGGRPRMC,
	  NTC.SHPCLS,
	  NTC.SUBRSKONE,

NTC.SUBRSKTWO
,
	  NTC.SUBRSKTHR,

	  NVL(SEG.POL,FLTSEG.SEGORG) AS POL,
	  NVL(SEG.POU,FLTSEG.SEGDST) AS POU ,
	  NVL(SEG.SEGSERNUM,FLTSEG.SEGSERNUM) AS SEGSERNUM,
	  SHP.STDPCS,
	  SHP.STDWGT,
      SHP.DSTCOD,

	  NTC.DGRSERNUM ,
	  DGR.CARFLAG CAOFLG,
	  SHP.SHPPFX,

	  NTC.BDPPCS,
	  LEG.TALNUM,
	  NTC.PKGHGT,


	  NVL(NTC.ERGCOD,DGR.ERGCOD) ERGCOD,
	  NTC.TECNAM,
      NTC.ALLPCKSERNUM,
	  NTC.OVRVLDFLG,
      DGR.NUMPKG DGRNUMPKG,
      DGR.TOTTPTIND,

	  
	  DGR.RDOACTFLG,

	   DECODE( NVL(NTC.TPTIND,0) ,0,DGR.TPTIND ,NTC.TPTIND) TPTIND,
       DECODE( NVL(NTC.NETQTY,0) ,0,DGR.NETQTY ,NTC.NETQTY) NETQTY,
       NVL(NTC.NETQTYUNT,DGR.NETQTYUNT) AS NETQTYUNT ,
      DGR.NOOFALLPACKS,
	  DGR.NOOFOVRPACKS,

      NTC.OVRPCKSERNUM,DGR.SPLATHFLG,DGR.AUTCOD,DGR.PKGDIMHGT
      ,NTC.OVRPCKSERNUM,
	  DGR.SPLATHFLG,
	  DGR.AUTCOD,DGR.SRTDES,

	  NTC.CRGHLD,
	  NTC.POS
	FROM OPRNTCDGR NTC ,
				OPRFLTSEG SEG ,
				FLTOPRSEG FLTSEG,
				OPRSHPMST SHP,
				FLTOPRLEG LEG,
OPRSHPDGR DGR
	WHERE
NTC.CMPCOD = SEG.CMPCOD(+)
			AND NTC.FLTNUM =
SEG.FLTNUM(+)
			AND NTC.FLTCARIDR = 
SEG.FLTCARIDR(+)
			AND NTC.FLTSEQNUM 
= SEG.FLTSEQNUM(+)
And NTC.SEGSERNUM=SEG.SEGSERNUM(+)
And NTC.CMPCOD = FLTSEG.CMPCOD(+)
			AND NTC.FLTNUM = 
FLTSEG.FLTNUM(+)
			AND NTC.FLTCARIDR = 
FLTSEG.FLTCARIDR(+)
			AND NTC.FLTSEQNUM 
= FLTSEG.FLTSEQNUM(+)
And NTC.SEGSERNUM=FLTSEG.SEGSERNUM(+)			
			AND NTC.CMPCOD
= LEG.CMPCOD
			AND NTC.FLTNUM    = LEG.FLTNUM
			AND NTC.FLTCARIDR
= LEG.FLTCARIDR

			AND NTC.FLTSEQNUM
= LEG.FLTSEQNUM
			AND NVL(SEG.POL,FLTSEG.SEGORG) = LEG.LEGORG
			AND NTC.CMPCOD =
SHP.CMPCOD
			AND
NTC.DOCOWRIDR = SHP.DOCOWRIDR

AND NTC.MSTDOCNUM = SHP.MSTDOCNUM
			AND NTC.DUPNUM
= SHP.DUPNUM

AND NTC.SEQNUM = SHP.SEQNUM

AND NTC.CMPCOD    = DGR.CMPCOD
AND NTC.DOCOWRIDR = DGR.DOCOWRIDR
AND NTC.MSTDOCNUM
= DGR.MSTDOCNUM
AND
NTC.DUPNUM    = DGR.DUPNUM
AND NTC.SEQNUM    = DGR.SEQNUM
AND NTC.DGRSERNUM    =
DGR.SERNUM



AND NTC.CMPCOD = ?
			AND NTC.FLTNUM = ?
			AND NTC.FLTCARIDR
= ?
			AND NTC.FLTSEQNUM = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<!-- BY A-5170 for ICRD-21615 ends -->
	<QRY:Definition>
		<QRY:Id>14</QRY:Id>
		<QRY:Source Name="operations.flthandling.findnotocspecialloaddetails" Type="NATIVE">
			<![CDATA[
		 SELECT
				SPLLOD.CMPCOD, SPLLOD.DOCOWRIDR, SPLLOD.MSTDOCNUM, SPLLOD.DUPNUM,
				SPLLOD.ULDNUM, SPLLOD.NUMPKG,


SPLLOD.NETQTY, SPLLOD.SUPINF, SPLLOD.RMK,
				SPLLOD.FLTCARIDR, SPLLOD.FLTNUM, SPLLOD.FLTSEQNUM, SPLLOD.LEGSERNUM,



				SPLLOD.SEQNUM, SPLLOD.LSTUPDUSR, SPLLOD.LSTUPDTIM,
				FLTSEG.POL, FLTSEG.POU,
				SHP.CAOFLG,

COALESCE(SPLLOD.SPLLODSCC,SHP.SCCCOD)SCCCOD,SPLLOD.SPLLODUNT,SHP.SHPPFX,SHP.SHPDES,LEG.TALNUM,SPLLOD.SEGSERNUM,
SPLLOD.CRGHLD,
SPLLOD.POS,
SPLLOD.PCSINNULD,
SPLLOD.SPLLODCNT,
NVL(FLTSEG.POU,FLTOPRSEG.SEGDST) SPLPOU	

		FROM
				OPRNTCSPLLOD SPLLOD,

OPRFLTSEG FLTSEG,
				OPRSHPMST SHP,
				FLTOPRLEG LEG,
				FLTOPRSEG FLTOPRSEG
		WHERE
				SPLLOD.CMPCOD = FLTSEG.CMPCOD(+)
			
			AND 
SPLLOD.FLTNUM = FLTSEG.FLTNUM(+)
			AND SPLLOD.FLTCARIDR 

= FLTSEG.FLTCARIDR(+)
			AND SPLLOD.FLTSEQNUM 
= 
FLTSEG.FLTSEQNUM(+)

			AND SPLLOD.SEGSERNUM =
FLTSEG.SEGSERNUM(+)
AND SPLLOD.CMPCOD    = FLTOPRSEG.CMPCOD(+)
AND SPLLOD.FLTNUM    = FLTOPRSEG.FLTNUM(+)
AND SPLLOD.FLTCARIDR = FLTOPRSEG.FLTCARIDR(+)
AND SPLLOD.FLTSEQNUM = FLTOPRSEG.FLTSEQNUM(+)
AND SPLLOD.SEGSERNUM = FLTOPRSEG.SEGSERNUM(+)

			AND SPLLOD.CMPCOD = SHP.CMPCOD



			AND SPLLOD.DOCOWRIDR = SHP.DOCOWRIDR
			AND SPLLOD.MSTDOCNUM = SHP.MSTDOCNUM
			AND SPLLOD.DUPNUM

= SHP.DUPNUM

			AND SPLLOD.SEQNUM = SHP.SEQNUM
			AND SPLLOD.CMPCOD    = LEG.CMPCOD
			AND SPLLOD.FLTNUM

= LEG.FLTNUM

			AND SPLLOD.FLTCARIDR =
LEG.FLTCARIDR
			AND SPLLOD.FLTSEQNUM = LEG.FLTSEQNUM

AND
NVL(FLTSEG.POL,FLTOPRSEG.SEGORG) = LEG.LEGORG
			AND SPLLOD.CMPCOD
= ?
			AND SPLLOD.FLTNUM = ?
			AND SPLLOD.FLTCARIDR

= ?
			AND SPLLOD.FLTSEQNUM = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>15</QRY:Id>
		<QRY:Source Name="operations.flthandling.findshipmentsfornotoc" Type="NATIVE">
			<![CDATA[
		SELECT ULDSHP.CMPCOD,
		  ULDSHP.DOCOWRIDR,
		  ULDSHP.MSTDOCNUM,
		  ULDSHP.DUPNUM,
		  ULDSHP.RMK,



		  ULDSHP.ULDNUM,
		  ULDSHP.SEQNUM,
		  ULDSHP.FLTCARIDR,
		  ULDSHP.FLTNUM,
		  ULDSHP.FLTSEQNUM,



		  FLT.FLTDAT ,
		  SHP.CAOFLG,
		  DGR.SCCCOD DGSCCCOD,
		  DGR.SCCCODONE DGSCCCODONE,
		  DGR.SCCCODTWO DGSCCCODTWO,
		  SHP.SCCCOD MSTSCCCOD,
		  SCC.SCCCOD,
		  SHP.SHPPFX,


		  SCC.DGRIND,

		  SEG.POL,
		  SEG.POU,
		  SEG.SEGSERNUM,
		  FLT.LEGSERNUM,
		  SHP.STDPCS,


		  SHP.STDWGT,
		  DGR.UNIIDR,
		  DGR.PROSHPNAM,

		  DGR.TECNAM,
		  DGR.PKGGRP,
		  DGR.PKGINS,


		  DGR.RMC,
		  DGR.PKGGRPRMC,
		  DGR.ERGCOD,
		  DGR.SHPCLS,
		  DGR.SUBRSKONE,

		  ULDSHP.BDPPCS,

ULDSHP.BDPWGT,
		  DGR.SUBRSKTWO ,
		  DGR.SUBRSKTHR,
		  DGR.ALLPCKSERNUM,
		  DGR.OVRPCKSERNUM,


		  DGR.NOOFOVRPACKS,

		  DGR.NOOFALLPACKS,
		  DGR.PKGGRPDIMHGT,
		  DGR.PKGDIMHGT,
		  DGR.NUMPKG,


  DECODE( NVL(NTC.TPTIND,0) ,0,DGR.TPTIND ,NTC.TPTIND) TPTIND,
  DECODE( NVL(NTC.NETQTY,0) ,0,DGR.NETQTY ,NTC.NETQTY) NETQTY,
  NVL(NTC.NETQTYUNT,DGR.NETQTYUNT) AS NETQTYUNT ,

		  DGR.NETGRSIND,

		  DGR.RDOACTFLG,
		  ULDSHP.NONDGRFLG,

ULDSHP.NONSPLLODFLG
		  FROM OPRSEGULDSHP
ULDSHP,
		       OPRSHPMST SHP,

		  OPRSHPDGR DGR,

SHRSCCMST SCC,
		       OPRFLTSEG SEG,

		       OPRARPEXPFLT FLT,
			   SHRARLPAR 
PAR,  OPRNTCDGR NTC

		 WHERE ULDSHP.CMPCOD
= SHP.CMPCOD
		   AND ULDSHP.MSTDOCNUM = SHP.MSTDOCNUM
		   AND
ULDSHP.DOCOWRIDR
= SHP.DOCOWRIDR

AND ULDSHP.DUPNUM = SHP.DUPNUM
		   AND ULDSHP.SEQNUM = SHP.SEQNUM

		AND SHP.CMPCOD
= DGR.CMPCOD(+)

AND SHP.MSTDOCNUM = DGR.MSTDOCNUM(+)
		AND SHP.DOCOWRIDR = DGR.DOCOWRIDR(+)

		AND
SHP.DUPNUM = DGR.DUPNUM(+)

AND SHP.SEQNUM = DGR.SEQNUM(+)
		AND DGR.CMPCOD       = NTC.CMPCOD(+)
AND DGR.DOCOWRIDR    = NTC.DOCOWRIDR (+)
AND DGR.MSTDOCNUM    = NTC.MSTDOCNUM (+)
AND DGR.DUPNUM       = NTC.DUPNUM(+)
AND DGR.SEQNUM       = NTC.SEQNUM (+)
AND DGR.SERNUM       = NTC.DGRSERNUM (+)
		   AND SCC.CMPCOD = SHP.CMPCOD


		   AND ULDSHP.CMPCOD =
SEG.CMPCOD
		   AND ULDSHP.FLTCARIDR = SEG.FLTCARIDR
		   AND ULDSHP.FLTNUM = SEG.FLTNUM



AND ULDSHP.FLTSEQNUM = SEG.FLTSEQNUM
		   AND ULDSHP.SEGSERNUM = SEG.SEGSERNUM
		   AND ULDSHP.CMPCOD


= FLT.CMPCOD
		   AND ULDSHP.FLTCARIDR = FLT.FLTCARIDR
		   AND ULDSHP.FLTNUM = FLT.FLTNUM
		   AND

ULDSHP.FLTSEQNUM
= FLT.FLTSEQNUM
		AND FLT.CMPCOD                = PAR.CMPCOD(+)
		
AND FLT.FLTCARIDR             = PAR.ARLIDR(+)
		AND PAR.PARCOD(+)             = 'operations.flthandling.airlinespecificoslcodes'
		   
		   AND ULDSHP.CMPCOD = ?
		   AND ULDSHP.FLTNUM = ?
		   AND ULDSHP.FLTCARIDR

= ?

		   AND ULDSHP.FLTSEQNUM 
= ?
		   AND (SCC.NTCIND = ?
		   OR (PKG_FRMWRK.Fun_String_Check(SHP.SCCCOD,PAR.PARVAL,',') > 0 AND 
INSTR(PAR.PARVAL,SCC.SCCCOD) > 0))
		AND INSTR(SHP.SCCCOD,SCC.SCCCOD)
> 0

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>16</QRY:Id>
		<QRY:Source Name="operations.flthandling.findunidpackagelimit" Type="NATIVE">
			<![CDATA[
		SELECT DISTINCT
			   SHP.CMPCOD, SHP.DOCOWRIDR, SHP.DUPNUM, SHP.MSTDOCNUM, SHP.SEQNUM,
				SHP.PKGGRP, SHP.PKGINS, SHP.UNIIDR,
				(SHP.NUMPKG - NVL(NTC.NUMPKG,0)) AS AVLNUMPKG
		FROM
				OPRSHPDGR SHP, OPRNTCDGR NTC
		WHERE
				SHP.CMPCOD = NTC.CMPCOD(+)
			AND SHP.DOCOWRIDR = NTC.DOCOWRIDR(+)
			AND SHP.MSTDOCNUM = NTC.MSTDOCNUM(+)
			AND SHP.DUPNUM = NTC.DUPNUM(+)
			AND SHP.SEQNUM = NTC.SEQNUM(+)
			AND SHP.PKGGRP = NTC.PKGGRP(+)
			AND SHP.PKGINS = NTC.PKGINS(+)
			AND SHP.UNIIDR = NTC.UNIIDR(+)
			AND SHP.CMPCOD = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>17</QRY:Id>
		<QRY:Source Name="operations.flthandling.checkunidnetqtylimitexceeded" Type="NATIVE">
			<![CDATA[
		SELECT DISTINCT
				SHP.CMPCOD
		FROM
				OPRSHPDGR SHP, OPRNTCDGR NTC
		WHERE
				SHP.CMPCOD = NTC.CMPCOD(+) AND
				SHP.DOCOWRIDR = NTC.DOCOWRIDR(+) AND
				SHP.MSTDOCNUM = NTC.MSTDOCNUM(+) AND
				SHP.DUPNUM = NTC.DUPNUM(+) AND
				SHP.SEQNUM = NTC.SEQNUM(+) AND
				SHP.SERNUM = NTC.SERNUM(+) AND
				SHP.NETQTY - NTC.NETQTY(+) >= ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>18</QRY:Id>
		<QRY:Source Name="operations.flthandling.uldplannedinotherflight" Type="NATIVE">
			<![CDATA[
		SELECT PLN.ULDNUM
		FROM OPRLODPLNULD PLN,OPRARPEXPFLT EXPFLT
		WHERE
		PLN.FLTCARIDR=EXPFLT.FLTCARIDR(+) AND
		PLN.FLTNUM=EXPFLT.FLTNUM(+) AND
		PLN.FLTSEQNUM=EXPFLT.FLTSEQNUM(+) AND
		PLN.CMPCOD=EXPFLT.CMPCOD(+) AND
		(PLN.FLTCARIDR<>? OR
		PLN.FLTNUM<>? OR
		PLN.FLTSEQNUM<>? ) AND
		EXPFLT.FINFLG(+)<>'Y' AND
		PLN.ULDNUM=?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>19</QRY:Id>
		<QRY:Source Name="operations.flthandling.findtransactionpieces" Type="NATIVE">
			<![CDATA[
SELECT
		PCS.CMPCOD PCSCMPCOD, PCS.DOCOWRIDR PCSDOCOWRIDR, PCS.MSTDOCNUM PCSMSTDOCNUM,
		PCS.DUPNUM PCSDUPNUM,


PCS.SEQNUM PCSSEQNUM, PCS.GRPIDR PCSPCSIDR,
		PCS.ARPCOD PCSARPCOD, PCS.TXNCOD PCSTXNCOD, PCS.TXNREFONE


PCSTXNREFONE,
		PCS.TXNREFTWO PCSTXNREFTWO, PCS.TXNREFTHR PCSTXNREFTHR, PCS.TXNREFFOR PCSTXNREFFOR,



		PCS.TXNREFFIV PCSTXNREFFIV, PCS.TXNREFEGT , PCS.TXNREFNIN ,
		PCS.TXNREFTEN
		FROM
OPRSHPTXNPCSGRPHIS

PCS,OPRSHPPCSGRP SHPPCS
		WHERE
		PCS.CMPCOD=SHPPCS.CMPCOD(+) AND
		PCS.DOCOWRIDR=SHPPCS.DOCOWRIDR(+)


AND
		PCS.MSTDOCNUM=SHPPCS.MSTDOCNUM(+) AND
		PCS.DUPNUM=SHPPCS.DUPNUM(+) AND
		PCS.SEQNUM=SHPPCS.SEQNUM(+)


AND
		 pcs.GRPIDR = shppcs.GRPIDR(+) and
		 PCS.CMPCOD=? AND
		PCS.DOCOWRIDR=? AND
		PCS.MSTDOCNUM=?


AND
		PCS.DUPNUM=? AND
		PCS.SEQNUM=?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>20</QRY:Id>
		<QRY:Source Name="operations.flthandling.finduldsummary" Type="NATIVE">
			<![CDATA[
		SELECT
		THR.CMPCOD THRCMPCOD, THR.FLTCARIDR THRFLTCARIDR,
		THR.FLTNUM THRFLTNUM, THR.FLTSEQNUM THRFLTSEQNUM,



		THR.SEGSERNUM THRSEGSERNUM,THR.SERNUM THRSERNUM,
		THR.ULDNUM THRULDNUM, THR.THRCARIDR THRTHRCARIDR,



		THR.THRCARCOD THRTHRCARCOD,THR.THRFLTNUM THRTHRFLTNUM,
		THR.THRFLTDAT THRTHRFLTDAT,
		THR.THRDSTCOD


THRTHRDSTCOD,

		FLT.POL, FLT.POU,

		ULD.CMPCOD ULDCMPCOD, ULD.FLTCARIDR ULDFLTCARIDR,
		ULD.FLTNUM


ULDFLTNUM, ULD.FLTSEQNUM ULDFLTSEQNUM,
		ULD.SEGSERNUM ULDSEGSERNUM, ULD.ULDNUM ULDULDNUM,
		ULD.GRSWGT


ULDGRSWGT, ULD.NETWGT ULDNETWGT,
		ULD.ULDCTR ULDULDCTR, ULD.ULDSTA ULDULDSTA, ULD.TARWGT ULDTARWGT




		FROM OPRSEGULD ULD,OPRFLTSEG FLT,OPRULDTHRRTG THR
		WHERE
		ULD.CMPCOD=FLT.CMPCOD(+) AND
		ULD.FLTCARIDR=FLT.FLTCARIDR(+)


AND
		ULD.FLTNUM=FLT.FLTNUM(+) AND
		ULD.FLTSEQNUM=FLT.FLTSEQNUM(+) AND
		ULD.SEGSERNUM=FLT.SEGSERNUM(+)


AND
		ULD.CMPCOD=THR.CMPCOD(+) AND
		ULD.FLTCARIDR=THR.FLTCARIDR(+) AND
		ULD.FLTNUM=THR.FLTNUM(+)
AND


		ULD.FLTSEQNUM=THR.FLTSEQNUM(+) AND
		ULD.SEGSERNUM=THR.SEGSERNUM(+) AND
		ULD.ULDNUM=THR.ULDNUM(+)

AND


		ULD.CMPCOD=? AND
		ULD.FLTCARIDR=? AND
		ULD.FLTNUM=? AND
		ULD.FLTSEQNUM=? AND
		ULD.ULDNUM=?

and
		FLT.POU=?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<!-- ADDED FOR LOAD PLANNING -->
	<QRY:Definition>
		<QRY:Id>21</QRY:Id>
		<QRY:Source Name="operations.flthandling.checkflightexists" Type="NATIVE">
			<![CDATA[
			SELECT 'X' AS X FROM OPRARPEXPFLT EXPFLT
			WHERE EXPFLT.CMPCOD = ? AND
			  EXPFLT.ARPCOD = ? AND
			  EXPFLT.FLTCARIDR = ? AND
			  EXPFLT.FLTSEQNUM = ? AND
			  EXPFLT.FLTNUM = ? AND
			  EXPFLT.LEGSERNUM = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>22</QRY:Id>
		<QRY:Source Name="operations.flthandling.checkIfReleasedToOps" Type="NATIVE">
			<![CDATA[
			SELECT RELFLG
				FROM OPRARPEXPFLT
					WHERE  FLTCARIDR= ?
					   AND FLTNUM= ?
					   AND FLTSEQNUM = ?
					   AND LEGSERNUM = ?
					   AND ARPCOD= ?
					   AND CMPCOD= ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<!-- ADDED FOR LOAD PLANNING -->
	<QRY:Definition>
		<QRY:Id>23</QRY:Id>
		<QRY:Source Name="operations.flthandling.checkifflightisarrived" Type="NATIVE">
			<![CDATA[
	SELECT 1
	  FROM OPRARPIMPFLT FLT
	 WHERE 	FLT.FLTNUM = ?
	 	AND FLT.FLTSEQNUM = ?
	   	AND FLT.FLTCARIDR = ?
	   	AND FLT.CMPCOD = ?
	   	AND FLT.ARPCOD = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>24</QRY:Id>
		<QRY:Source Name="operations.shipment.checkforflightclosure" Type="NATIVE">
			<![CDATA[
	SELECT IMPFLT.FLTNUM
	  FROM OPRFLTSEG FLTSEG, OPRARPIMPFLT IMPFLT
	 WHERE IMPFLT.CMPCOD = FLTSEG.CMPCOD
	   AND IMPFLT.ARPCOD = FLTSEG.POU
	   AND IMPFLT.FLTCARIDR = FLTSEG.FLTCARIDR
	   AND IMPFLT.FLTNUM = FLTSEG.FLTNUM
	   AND IMPFLT.FLTSEQNUM = FLTSEG.FLTSEQNUM
	   AND IMPFLT.CMPCOD = ?
	   AND IMPFLT.ARPCOD = ?
	   AND IMPFLT.FLTCARIDR = ?
	   AND IMPFLT.FLTNUM = ?
	   AND IMPFLT.FLTSEQNUM = ?
	   AND FLTSEG.POL = ?
	   AND FLTSEG.POU = ?
   	   AND IMPFLT.CLSFLG = 'Y'
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>25</QRY:Id>
		<QRY:Source Name="operations.flthandling.findUldShipmentForLoadPlan" Type="NATIVE">
			<![CDATA[
	SELECT ULDSHP.MFTWGT AS WGT,
	   ULDSHP.MFTVOL AS VOL,
	   ULDSHP.MFTPCS AS NUMPCS,
	   ULDSHP.ULDNUM AS ULDNUM,
	   FLTSEG.POL AS POL,
	   FLTSEG.POU AS POU


FROM   OPRSEGULDSHP ULDSHP ,OPRFLTSEG FLTSEG


WHERE    ULDSHP.CMPCOD = FLTSEG.CMPCOD(+)
AND      ULDSHP.FLTNUM = FLTSEG.FLTNUM(+)
AND      ULDSHP.FLTSEQNUM = FLTSEG.FLTSEQNUM(+)
AND      ULDSHP.FLTCARIDR = FLTSEG.FLTCARIDR(+)
AND      ULDSHP.SEGSERNUM = FLTSEG.SEGSERNUM(+)
AND      ULDSHP.CMPCOD = ?
AND      ULDSHP.FLTNUM    = ?
AND      ULDSHP.FLTSEQNUM = ?
AND      ULDSHP.FLTCARIDR = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>26</QRY:Id>
		<QRY:Source Name="operations.flthandling.findoffloadreportdetails" Type="NATIVE">
			<![CDATA[
	SELECT OFL.MSTDOCNUM, MST.SHPPFX, MST.UBRNUM, OFL.FLTNUM, FLTSEG.POU,
	       MST.SCCCOD, OFL.OFLPCS,


OFL.OFLWGT, OFL.OFLVOL, OFL.OFLRSN, OFL.OFLDAT, EXP.FLTCARCOD
	  FROM OPRSHPMST MST, OPROFLDTL OFL,

OPRFLTSEG
FLTSEG,OPRARPEXPFLT EXP
	 WHERE OFL.MSTDOCNUM = MST.MSTDOCNUM(+)
	   AND OFL.DOCOWRIDR =
MST.DOCOWRIDR(+)


	   AND OFL.DUPNUM = MST.DUPNUM(+)
	   AND OFL.SEQNUM = MST.SEQNUM(+)
	   AND
OFL.CMPCOD = MST.CMPCOD(+)


	   AND OFL.FLTNUM = FLTSEG.FLTNUM(+)
	   AND OFL.FLTCARIDR = FLTSEG.FLTCARIDR(+)

AND OFL.SEGSERNUM
=
FLTSEG.SEGSERNUM(+)
	   AND OFL.FLTSEQNUM = FLTSEG.FLTSEQNUM(+)
	   AND OFL.CMPCOD
= FLTSEG.CMPCOD(+)


	   AND OFL.FLTNUM = EXP.FLTNUM(+)
	   AND OFL.FLTCARIDR = EXP.FLTCARIDR(+)

AND OFL.FLTSEQNUM =
EXP.FLTSEQNUM(+)

	   AND OFL.CMPCOD = EXP.CMPCOD(+)
   	   AND EXP.ARPCOD = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>27</QRY:Id>
		<QRY:Source Name="operations.flthandling.findulddetailsforexportramp" Type="NATIVE">
			<![CDATA[
	SELECT DISTINCT EXPFLT.CMPCOD ULDCMPCOD,
  EXPFLT.FLTCARIDR ULDFLTCARIDR,
  EXPFLT.ARPCOD ARPCOD,

EXPFLT.FLTCARCOD FLTCARCOD,
  EXPFLT.FLTNUM ULDFLTNUM,
  EXPFLT.FLTSEQNUM ULDFLTSEQNUM,
  EXPFLT.LEGSERNUM
LEGSERNUM,
  ULD.SEGSERNUM ULDSEGSERNUM,
  ULD.ULDNUM ULDNUM,
  ULD.ULDDST ULDULDDST,
  SHP.MFTPCS
SHPPCS,
  SHP.MFTWGT SHPWGT,
  SHP.MFTVOL SHPVOL,
  SHP.DOCOWRIDR SHPDOCOWRIDR,
  SHP.MSTDOCNUM SHPMSTDOCNUM,

  SHP.DUPNUM SHPDUPNUM,
  SHP.SEQNUM SHPSEQNUM,
  SHP.CMPCOD SHPCMPCOD,
  COALESCE(ULD.BARROWFLG,
'N') BARROWFLG ,
  MST.SHPPFX MSTSHPPFX,
  MST.SCCCOD MSTSCCCOD,
  MST.ORGCOD MSTORGCOD,
  MST.DSTCOD
MSTDSTCOD,
  MST.STDPCS MSTSTDPCS,
  MST.STDWGT MSTSTDWGT,
  MST.DOMFLG,
  STUMST.CURLOCCOD,
  STUMST.CURWHSCOD,

ULD.BSEFLG,
  ULD.BSEPLT ,
  EXPFLT.FLTDAT,
  LEG.DEPPOS FLTPRKPOS,
   SEG.POL,
  SEG.POU
FROM OPRSEGULD
ULD,
  OPRSEGULDSHP SHP,
  OPRFLTSEG SEG,
  OPRSEGSHP SEGSHP,
  OPRARPEXPFLT EXPFLT,
  FLTOPRLEG
LEG,
  OPRSHPMST MST,
  WHSSTUMST STUMST
WHERE EXPFLT.FLTCARIDR = LEG.FLTCARIDR
AND EXPFLT.FLTNUM =
LEG.FLTNUM
AND EXPFLT.FLTSEQNUM = LEG.FLTSEQNUM
AND EXPFLT.CMPCOD = LEG.CMPCOD
AND EXPFLT.ARPCOD = LEG.LEGORG
AND
EXPFLT.FLTCARIDR = SEG.FLTCARIDR(+)
AND EXPFLT.FLTNUM = SEG.FLTNUM(+)
AND EXPFLT.FLTSEQNUM = SEG.FLTSEQNUM(+)

AND EXPFLT.CMPCOD = SEG.CMPCOD(+)
AND EXPFLT.ARPCOD = SEG.POL(+)
AND SEG.FLTCARIDR = ULD.FLTCARIDR(+)

AND SEG.FLTNUM = ULD.FLTNUM(+)
AND SEG.FLTSEQNUM = ULD.FLTSEQNUM(+)
AND SEG.CMPCOD = ULD.CMPCOD(+)

AND SEG.SEGSERNUM = ULD.SEGSERNUM(+)
AND ULD.FLTCARIDR = SHP.FLTCARIDR(+)
AND ULD.FLTNUM = SHP.FLTNUM(+)

AND ULD.FLTSEQNUM = SHP.FLTSEQNUM(+)
AND ULD.SEGSERNUM = SHP.SEGSERNUM(+)
AND ULD.CMPCOD = SHP.CMPCOD(+)

AND ULD.ULDNUM = SHP.ULDNUM(+)
AND SHP.DOCOWRIDR = SEGSHP.DOCOWRIDR(+)
AND SHP.MSTDOCNUM = SEGSHP.MSTDOCNUM(+)

AND SHP.DUPNUM = SEGSHP.DUPNUM(+)
AND SHP.SEQNUM = SEGSHP.SEQNUM(+)
AND SHP.CMPCOD = SEGSHP.CMPCOD(+)

AND SHP.FLTCARIDR = SEGSHP.FLTCARIDR(+)
AND SHP.FLTNUM = SEGSHP.FLTNUM(+)
AND SHP.FLTSEQNUM = SEGSHP.FLTSEQNUM(+)

AND SHP.SEGSERNUM = SEGSHP.SEGSERNUM(+)
AND SHP.DOCOWRIDR = MST.DOCOWRIDR(+)
AND SHP.MSTDOCNUM = MST.MSTDOCNUM(+)

AND SHP.DUPNUM = MST.DUPNUM(+)
AND SHP.SEQNUM = MST.SEQNUM(+)
AND SHP.CMPCOD = MST.CMPCOD(+)
AND
ULD.CMPCOD = STUMST.CMPCOD(+)
AND ULD.ULDNUM = STUMST.STUCOD(+)
AND STUMST.ARPCOD(+) = ?
AND EXPFLT.CMPCOD
= ?
AND EXPFLT.ARPCOD = ?
AND EXPFLT.FLTCARIDR = ?
AND EXPFLT.FLTNUM = ?
AND EXPFLT.FLTSEQNUM = ?

AND EXPFLT.LEGSERNUM = ?
ORDER BY ULDNUM,
  ULDSEGSERNUM,
  SHP.DOCOWRIDR,
  SHP.MSTDOCNUM,
  SHP.DUPNUM,

  SHP.SEQNUM
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>29</QRY:Id>
		<QRY:Source Name="operations.flthandling.findulddetailsforimportramp" Type="NATIVE">
			<![CDATA[
	SELECT ULD.CMPCOD ULDCMPCOD,
  ULD.FLTCARIDR ULDFLTCARIDR,
  OPRLEG.LEGDST ARPCOD,
  IMPFLT.FLTCARCOD
FLTCARCOD,
  IMPFLT.FLTDAT,
  OPRLEG.LEGSERNUM LEGSERNUM,
  ULD.FLTNUM ULDFLTNUM,
  ULD.FLTSEQNUM ULDFLTSEQNUM,

  ULD.SEGSERNUM ULDSEGSERNUM,
  ULD.ULDNUM ULDNUM,
  SHP.MFTPCS SHPPCS,
  SHP.MFTWGT SHPWGT,
  SHP.MFTVOL
SHPVOL,
  SHP.FLTCARIDR SHPFLTCARIDR,
  SHP.FLTNUM SHPFLTNUM,
  SHP.FLTSEQNUM SHPFLTSEQNUM,
  SHP.DOCOWRIDR
SHPDOCOWRIDR,
  SHP.MSTDOCNUM SHPMSTDOCNUM,
  SHP.CMPCOD SHPCMPCOD,
  SHP.DUPNUM SHPDUPNUM,
  SHP.SEQNUM
SHPSEQNUM,
  MST.SHPPFX MSTSHPPFX,
  MST.ORGCOD MSTORGCOD,
  MST.DSTCOD MSTDSTCOD,
  MST.SCCCOD MSTSCCCOD,

  MST.STDPCS MSTSTDPCS,
  MST.STDWGT MSTSTDWGT,
  MST.DOMFLG,
  STUMST.CURLOCCOD,
  STUMST.CURWHSCOD,

STUMST.STUTYPNAM,
  OPRLEG.ARVPOS FLTPRKPOS,
 SEG.POL,
  SEG.POU
FROM OPRFLTSEG SEG
INNER JOIN FLTOPRLEG
OPRLEG
ON SEG.CMPCOD = OPRLEG.CMPCOD
AND SEG.FLTCARIDR = OPRLEG.FLTCARIDR
AND SEG.FLTNUM = OPRLEG.FLTNUM

AND SEG.FLTSEQNUM = OPRLEG.FLTSEQNUM
AND SEG.POU = OPRLEG.LEGDST
LEFT OUTER JOIN OPRARPIMPFLT IMPFLT

ON OPRLEG.CMPCOD = IMPFLT.CMPCOD
AND OPRLEG.FLTCARIDR = IMPFLT.FLTCARIDR
AND OPRLEG.FLTNUM = IMPFLT.FLTNUM

AND OPRLEG.FLTSEQNUM = IMPFLT.FLTSEQNUM
AND OPRLEG.LEGDST = IMPFLT.ARPCOD
LEFT OUTER JOIN OPRSEGULD
ULD
ON SEG.FLTCARIDR = ULD.FLTCARIDR
AND SEG.FLTNUM = ULD.FLTNUM
AND SEG.FLTSEQNUM = ULD.FLTSEQNUM

AND SEG.SEGSERNUM = ULD.SEGSERNUM
AND SEG.CMPCOD = ULD.CMPCOD
LEFT OUTER JOIN WHSSTUMST STUMST
ON
ULD.CMPCOD = STUMST.CMPCOD
AND ULD.ULDNUM = STUMST.STUCOD
AND SEG.POL = STUMST.ARPCOD
LEFT OUTER JOIN
OPRSEGULDSHP SHP
ON ULD.FLTCARIDR = SHP.FLTCARIDR
AND ULD.FLTNUM = SHP.FLTNUM
AND ULD.FLTSEQNUM =
SHP.FLTSEQNUM
AND ULD.SEGSERNUM = SHP.SEGSERNUM
AND ULD.CMPCOD = SHP.CMPCOD
AND ULD.ULDNUM = SHP.ULDNUM

LEFT OUTER JOIN OPRSHPMST MST
ON SHP.DOCOWRIDR = MST.DOCOWRIDR
AND SHP.MSTDOCNUM = MST.MSTDOCNUM
AND
SHP.DUPNUM = MST.DUPNUM
AND SHP.SEQNUM = MST.SEQNUM
AND SHP.CMPCOD = MST.CMPCOD
WHERE ULD.CMPCOD =
?
AND SEG.POU = ?
AND ULD.FLTCARIDR = ?
AND ULD.FLTNUM = ?
AND ULD.FLTSEQNUM = ?
AND ULD.MFTFLG ='Y'

AND NVL(SHP.MFTPCS,1)>0
ORDER BY SHP.ULDNUM,
  SHP.DOCOWRIDR,
  SHP.MSTDOCNUM,
  SHP.DUPNUM,

SHP.SEQNUM








			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>28</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findctomanifestdetails" Type="NATIVE">
			<![CDATA[
		SELECT ULD.CMPCOD ULDCMPCOD,
			  ULD.FLTCARIDR ULDFLTCARIDR,
			  ULD.FLTNUM ULDFLTNUM,
			  ULD.FLTSEQNUM

ULDFLTSEQNUM,
			  ULD.SEGSERNUM ULDSEGSERNUM,
			  ULD.ULDNUM ULDULDNUM,
			  ULD.GRSWGT,
			  ULD.NETWGT,


ULD.THRUNT,
			  ULD.ULDCTR,
			  ULD.TARWGT,
			  ULD.BDNCPLFLG,
			  ULD.RMK ULDRMK,
			  ULD.BDNITN

,ULD.RCVFLG,
			  ULD.ULDBKGIDR BKGIDR,
			  ULD.ULDLKGCNFFLG,
			  ULD.ALTIDR,
			  ULD.BKGTYP ULDBKGTYP,

ULD.ACTWGT,
			  ULD.ULDOCP,
			  ULD.BDNITN SHPTYP,
			  SHP.CUSREF SHPCUSREF,
			  SHP.MFTPCS SHPPCS,
			  SHP.MFTWGT SHPWGT,

SHP.MFTVOL SHPVOL,
			  SHP.FLTCARIDR
SHPFLTCARIDR,
			  SHP.FLTNUM SHPFLTNUM,
			  SHP.FLTSEQNUM SHPFLTSEQNUM,

SHP.SEGSERNUM SHPSEGSERNUM,

SHP.ULDNUM SHPULDNUM,
			  SHP.DOCOWRIDR SHPDOCOWRIDR,
			  SHP.MSTDOCNUM
SHPMSTDOCNUM,
			  SHP.DUPNUM
SHPDUPNUM,
			  SHP.SEQNUM SHPSEQNUM,
			  SHP.RMK SHPRMK,
			  SHP.CMPCOD
SHPCMPCOD,
			  SHP.LODPRT,
MST.DTACPTFLG,
MST.SCCCOD MSTSCCCOD,
			  SHP.RCVPCS SHPRCVPCS,
			  SHP.RCVWGT SHPRCVWGT,

SHP.RCVVOL SHPRCVVOL,

			  SHP.SLCPCS MFTSLCPCS,
			  MST.PAYTYP MSTPAYTYP,
			  MST.SHPDES MSTSHPDES,

MST.ORGCOD MSTORGCOD,

			  MST.DSTCOD MSTDSTCOD,
			  MST.STDWGTCOD MSTSTDWGTCOD,
			  MST.STDDISWGT
MSTSTDDISWGT,
			  MST.CONFLG,

			  MST.DTACPTFLG,
			  MST.PRDNAM MSTPRDNAM,
			  MST.PRDPRT MSTPRDPRT,

MST.SHPPFX,
			  MST.STDPCS,

			  MST.OWRCOD MSTOWRCOD,
			  MST.STDWGT,
			  MST.GRSVOL,

MST.SLCPCS STATEDSLCPCS,
			  MST.EFTAWBFLG,
			  MST.EXEFLG,
			  MST.PLTFLG,

			  SEG.CMPCOD SEGCMPCOD,
			  SEG.FLTCARIDR SEGFLTCARIDR,

SEG.FLTNUM SEGFLTNUM,
			  SEG.FLTSEQNUM
SEGFLTSEQNUM,
			  SEG.POL SEGPOL,
			  SEG.POU SEGPOU,

SEG.SEGSERNUM SEGSEGSERNUM,
			  SEGSHP.PLNVOL,

SEGSHP.MFTPCS SEGSHPMFTPCS,
			  SEGSHP.MFTWGT
SEGSHPMFTWGT,
			  SEGSHP.MFTVOL SEGSHPMFTVOL,
			  ARPSHP.DOCRCVFLG,

			  ULD.LSTUPDTIM ULDUPDTIM,

SEGSHP.LSTUPDTIM SEGSHPUPDTIM,
			  ARPSHP.LSTUPDTIM ARPSHPUPDTIM,

			  HSE.DOCNUM ,
			  HSE.PCS,

HSE.WGT,
			  HSE.TXNREFNIN HSESLACPCS,
			  HSE.MSTDOCNUM HSEMSTDOCNUM,

			  HSE.DUPNUM HSEDUPNUM,

HSE.DOCOWRIDR HSEDOCOWRIDR,
			  HSE.SEQNUM HSESEQNUM,
			  HSE.SERNUM HSESERNUM,

			  HSE.CMPCOD
HSECMPCOD,
			  HSE.TXNCOD HSETXNCOD,
			  HSE.ARPCOD,
			  HSEMST.STDPCS HSESTDPCS,
			  HSEMST.STDWGT
HSESTDWGT,
			  HSEMST.SHPDES HSESHPDES,
			  MST.STDWGT
HSESTDWGT,
			  MST.HDLINF,
			  ARPSHP.DCSREQFLG,

ARPSHP.RCVPCS,ARPSHP.CRSDCKFLG,
			  MIS.SCICOD,
			  BKGFLT.FLTCARIDR ONWFLTCARIDR,
			  BKGFLT.FLTCARCOD
ONWFLTCARCOD,
			  BKGFLT.FLTNUM
BKGFLTNUM,
			  BKGFLT.FLTDAT BKGFLTDAT,
			  BKGFLT.FLTBKGSTA,

(
			  CASE
				WHEN MST.DSTCOD=SEG.POU

				THEN TO_CHAR(QMSPLN.MILSTNTIM,'dd-MON-YYYY/HH24:MI')

ELSE
				  (SELECT (
					CASE
					  WHEN (BKGFLT.FLTCARCOD
IS NOT NULL
					  AND ISSPRTARL
='Y'
					  AND BKGFLT.FLTBKGSTA    ='C')
					  THEN BKGFLT.FLTCARCOD

||BKGFLT.FLTNUM
						||'
'
						||TO_CHAR(BKGFLT.FLTDAT,'dd-MON-YYYY')
					  WHEN (BKGFLT.FLTCARCOD
IS NOT NULL
					  AND
ISSPRTARL           ='Y'
					  AND BKGFLT.FLTBKGSTA   <> 'C')
					  THEN 'EXPORT
'
						||MST.DSTCOD

WHEN (BKGFLT.UBRNUM   IS NOT NULL
					  AND (NVL(ISSPRTARL,'N')='N'))

THEN 'Transfer to '

||BKGFLT.FLTCARCOD
					  ELSE ''
					END) AS ONWFLTINFO
				  FROM
					(SELECT
ARLACTMST.ARLIDR,

CASE
						WHEN ARLACTMST.OWNARLIND = 'Y'
						THEN ARLACTMST.OWNARLIND

WHEN ARLACTMST.ISSPRTARL
= 'Y'
						THEN ARLACTMST.ISSPRTARL
					  END ISSPRTARL
					FROM SHRARLMST
ARLACTMST
					WHERE ARLACTMST.CMPCOD
= ?
					)
				  WHERE ARLIDR = BKGFLT.FLTCARIDR
				  )
			  END)
AS ONWFLTINFO,
			  ROUND( (

CASE
				WHEN SHP.LPHVAL <> 0
				THEN SHP.LPHVAL
				WHEN MST.DSTCOD
=SEG.POU
				AND QMSPLN.MILSTNTIMUTC
IS NOT NULL
				AND OPRLEG.ATA          IS NOT NULL
				THEN DECODE(((QMSPLN.MILSTNTIMUTC
- (OPRLEG.ATA+(QMSPLN.MILSTNTIMUTC-QMSPLN.MILSTNTIM)))*24*60),0,1,((QMSPLN.MILSTNTIMUTC
- (OPRLEG.ATA+(QMSPLN.MILSTNTIMUTC-QMSPLN.MILSTNTIM)))*24*60))

WHEN BKGFLT.UBRNUM   IS NOT NULL

AND BKGFLT.FLTBKGSTA <>'X'
				AND OPRLEG.ATA       IS NOT NULL

				AND OPRLEGOUT.ETD    IS NOT
NULL
				THEN DECODE(((OPRLEGOUT.ETD - OPRLEG.ATA)*24*60),0,1,((OPRLEGOUT.ETD
- OPRLEG.ATA))*24*60)

WHEN BKGFLT.UBRNUM   IS NOT NULL
				AND BKGFLT.FLTBKGSTA <>'X'
				AND OPRLEG.ATA
IS NOT NULL

AND OPRLEGOUT.ETD    IS NULL
				THEN DECODE(((OPRLEGOUT.STD - OPRLEG.ATA)*24*60),0,1,((OPRLEGOUT.STD

- OPRLEG.ATA)*24*60))
				ELSE 0
			  END)) AS LPHTVAL,
			  QMSPLN.MILSTNTIMUTC NFDPLNDAT,
			  CASE


			WHEN ((IMPFLT.MFTSRC ='F' AND ULD.BKGTYP IS NULL) OR ULDBKGMST.BKGSTA ='XX')
			THEN 'BDN Unit'

WHEN
(ULD.BKGTYP = 'ULD' AND ULDBKGMST.BKGTYP IS NOT NULL)
				THEN (
				  CASE
					WHEN (ULDBDNDTL.ULDNUM

IS NOT NULL
					AND ULDBDNDTL.THRINTFLG   <>'T'
					AND ULDBDNDTL.THRINTFLG   <>'I')
					THEN 'BDN

Unit'
					ELSE ULDBKGMST.BKGTYP
				  END)
			WHEN (ULD.BKGTYP IS NOT NULL AND ULD.BKGTYP = 'NIL')


            THEN ('BDN Unit')
			WHEN (ULD.BKGTYP IS NOT NULL AND ULD.BKGTYP <> 'ULD')
			THEN (

CASE

							WHEN (ULDBDNDTL.ULDNUM IS NOT NULL
							AND ULDBDNDTL.THRINTFLG   <>'T'

AND ULDBDNDTL.THRINTFLG
<>'I')
				THEN 'BDN Unit'
				ELSE ULD.BKGTYP
			  END)
			ELSE 'BDN Unit'
END
ULDCHAR,
			  ULDBKGMST.ORGCOD
ULDBKGORG ,
			  ULDBKGMST.DSTCOD ULDBKGDST,
			  ULDBKGMST.ULDBKGIDR,

ULDBKGMST.BKGSTA ULDBKGSTA,

			  IMPFLT.MFTSRC,
			   COALESCE(ULD.ULDDST, ULDBKGMST.DSTCOD) ULDDST,
			( SELECT DISTINCT LAST_VALUE(RMK) IGNORE NULLS OVER ( PARTITION BY DOCOWRIDR, MSTDOCNUM, DUPNUM, SEQNUM, CMPCOD, TXNCOD ORDER BY DOCOWRIDR, MSTDOCNUM, DUPNUM, SEQNUM, CMPCOD, TXNCOD DESC) RMK
FROM OPRSHPNOT
WHERE CMPCOD  = segshp.cmpcod
AND MSTDOCNUM = segshp.mstdocnum
AND docowridr = segshp.docowridr
AND seqnum    = segshp.seqnum
AND dupnum    = segshp.dupnum
AND TXNCOD    = 'SPNOT'
) SHPSPLNOT,			   
RTG.THRCARIDR,
				RTG.THRCARCOD,
				RTG.THRFLTNUM,
				RTG.THRFLTDAT,
				RTG.THRDSTCOD,
				RTG.SERNUM
THRSERNUM,ARPSHP.PLTUSEFLG,ULDBDNDTL.THRINTFLG
			FROM OPRFLTSEG SEG
			INNER JOIN
FLTOPRLEG OPRLEG
			ON SEG.CMPCOD     = OPRLEG.CMPCOD

AND SEG.FLTCARIDR = OPRLEG.FLTCARIDR
			AND
SEG.FLTNUM    = OPRLEG.FLTNUM
			AND SEG.FLTSEQNUM = OPRLEG.FLTSEQNUM

AND SEG.POU       = OPRLEG.LEGDST

			LEFT OUTER JOIN OPRARPIMPFLT IMPFLT
			ON OPRLEG.CMPCOD
= IMPFLT.CMPCOD
			AND OPRLEG.FLTCARIDR =
IMPFLT.FLTCARIDR
			AND OPRLEG.FLTNUM    = IMPFLT.FLTNUM

AND OPRLEG.FLTSEQNUM = IMPFLT.FLTSEQNUM

AND OPRLEG.LEGDST    = IMPFLT.ARPCOD
			LEFT OUTER JOIN OPRSEGULD
ULD
			ON SEG.FLTCARIDR  = ULD.FLTCARIDR

AND SEG.FLTNUM    = ULD.FLTNUM
			AND SEG.FLTSEQNUM = ULD.FLTSEQNUM

AND SEG.SEGSERNUM = ULD.SEGSERNUM

AND SEG.CMPCOD    = ULD.CMPCOD
			LEFT OUTER JOIN OPRSEGULDSHP
SHP
			ON ULD.FLTCARIDR  = SHP.FLTCARIDR

AND ULD.FLTNUM    = SHP.FLTNUM
			AND ULD.FLTSEQNUM = SHP.FLTSEQNUM

AND ULD.SEGSERNUM = SHP.SEGSERNUM

			AND ULD.CMPCOD    = SHP.CMPCOD
			AND ULD.ULDNUM    = SHP.ULDNUM

AND NVL(SHP.MFTPCS,1)>0
			LEFT OUTER
JOIN OPRSEGSHP SEGSHP
			ON SHP.DOCOWRIDR  = SEGSHP.DOCOWRIDR

AND SHP.MSTDOCNUM = SEGSHP.MSTDOCNUM

AND SHP.DUPNUM    = SEGSHP.DUPNUM
			AND SHP.SEQNUM    = SEGSHP.SEQNUM

AND SHP.CMPCOD    = SEGSHP.CMPCOD

AND SHP.FLTCARIDR = SEGSHP.FLTCARIDR
			AND SHP.FLTNUM    = SEGSHP.FLTNUM

AND SHP.FLTSEQNUM = SEGSHP.FLTSEQNUM

			AND SHP.SEGSERNUM = SEGSHP.SEGSERNUM
			LEFT OUTER JOIN OPRSHPMST
MST
			ON SEGSHP.DOCOWRIDR  = MST.DOCOWRIDR

			AND SEGSHP.MSTDOCNUM = MST.MSTDOCNUM
			AND SEGSHP.DUPNUM
= MST.DUPNUM
			AND SEGSHP.SEQNUM    = MST.SEQNUM

			AND SEGSHP.CMPCOD    = MST.CMPCOD
			LEFT OUTER
JOIN OPRSHPMSTMIS MIS
			ON MST.DOCOWRIDR  = MIS.DOCOWRIDR

			AND MST.MSTDOCNUM = MIS.MSTDOCNUM

AND MST.DUPNUM    = MIS.DUPNUM
			AND MST.SEQNUM    = MIS.SEQNUM

			AND MST.CMPCOD    = MIS.CMPCOD

LEFT OUTER JOIN OPRARPSHP ARPSHP
			ON SEGSHP.DOCOWRIDR  = ARPSHP.DOCOWRIDR

			AND SEGSHP.MSTDOCNUM
= ARPSHP.MSTDOCNUM
			AND SEGSHP.DUPNUM    = ARPSHP.DUPNUM
			AND SEGSHP.SEQNUM
= ARPSHP.SEQNUM

AND SEGSHP.CMPCOD    = ARPSHP.CMPCOD
			AND ARPSHP.ARPCOD    = SEG.POU
			LEFT OUTER
JOIN OPRTXNHSE
HSE
			ON SHP.DOCOWRIDR            = HSE.DOCOWRIDR
			AND SHP.MSTDOCNUM           = HSE.MSTDOCNUM


AND SHP.DUPNUM              = HSE.DUPNUM
			AND SHP.CMPCOD              = HSE.CMPCOD
			AND TO_CHAR(

SHP.FLTCARIDR) =HSE.TXNREFTWO
			AND SHP.FLTNUM              = HSE.TXNREFTHR
			AND TO_CHAR(SHP.FLTSEQNUM

) = HSE.TXNREFFIV
			AND TO_CHAR( SHP.ULDNUM )   = HSE.TXNREFSIX
			AND HSE.TXNCOD = 'MFT'
			LEFT OUTER
JOIN OPRSHPMST HSEMST

			ON HSE.DOCOWRIDR  = HSEMST.DOCOWRIDR
			AND HSE.MSTDOCNUM = HSEMST.MSTDOCNUM

AND HSE.DUPNUM    = HSEMST.DUPNUM

			AND HSE.CMPCOD    = HSEMST.CMPCOD
			AND HSE.SEQNUM    = HSEMST.SEQNUM

LEFT OUTER JOIN CAPBKGFLTDTL
BKGFLT
			ON MST.CMPCOD     = BKGFLT.CMPCOD
			AND MST.UBRNUM    = BKGFLT.UBRNUM

AND MST.DOCOWRIDR
= BKGFLT.DOCOWRIDR
			AND MST.MSTDOCNUM = BKGFLT.MSTDOCNUM
			AND MST.DUPNUM    =
BKGFLT.DUPNUM
			AND
MST.SEQNUM    = BKGFLT.SEQNUM
			AND SEG.POU       = BKGFLT.FLTORG
			LEFT OUTER
JOIN FLTOPRLEG OPRLEGOUT

ON BKGFLT.CMPCOD     = OPRLEGOUT.CMPCOD
			AND BKGFLT.FLTCARIDR = OPRLEGOUT.FLTCARIDR

AND BKGFLT.FLTNUM
= OPRLEGOUT.FLTNUM
			AND BKGFLT.FLTSEQNUM = OPRLEGOUT.FLTSEQNUM
			AND BKGFLT.FLTORG
= OPRLEGOUT.LEGORG

			LEFT OUTER JOIN FLTOPRLEG OPRLEGOUT
			ON BKGFLT.CMPCOD     = OPRLEGOUT.CMPCOD

AND BKGFLT.FLTCARIDR = OPRLEGOUT.FLTCARIDR
			AND BKGFLT.FLTNUM    = OPRLEGOUT.FLTNUM
			AND BKGFLT.FLTSEQNUM
= OPRLEGOUT.FLTSEQNUM
			AND BKGFLT.FLTORG    = OPRLEGOUT.LEGORG
			AND BKGFLT.FLTDST    = OPRLEGOUT.LEGDST

LEFT OUTER JOIN CAPULDBKGMST ULDBKGMST
			ON ULD.CMPCOD     = ULDBKGMST.CMPCOD
			AND ULD.ULDBKGIDR
=
ULDBKGMST.ULDBKGIDR
			LEFT OUTER JOIN OPRULDBDNDTL ULDBDNDTL
			ON ULDBDNDTL.CMPCOD     = ULD.CMPCOD


			AND ULDBDNDTL.FLTCARIDR = ULD.FLTCARIDR
			AND ULDBDNDTL.FLTNUM    = ULD.FLTNUM
			AND ULDBDNDTL.FLTSEQNUM = ULD.FLTSEQNUM

			AND ULDBDNDTL.ULDNUM    = ULD.ULDNUM
			LEFT OUTER JOIN QMSSHPMILSTNPLN QMSPLN

			ON MST.CMPCOD        = QMSPLN.CMPCOD
			AND MST.DOCOWRIDR    = QMSPLN.DOCOWRIDR
			AND MST.MSTDOCNUM  	 = QMSPLN.MSTDOCNUM
			AND MST.DUPNUM       = QMSPLN.DUPNUM
			AND MST.SEQNUM       = QMSPLN.SEQNUM



			AND QMSPLN.PLNTYP    = 'SL'
			AND QMSPLN.MILSTNCOD ='NFD'
			LEFT OUTER JOIN
OPRULDTHRRTG RTG
ON ULD.FLTCARIDR      = RTG.FLTCARIDR
AND ULD.FLTNUM         = RTG.FLTNUM
AND ULD.FLTSEQNUM
= RTG.FLTSEQNUM
AND ULD.SEGSERNUM      = RTG.SEGSERNUM
AND ULD.CMPCOD         = RTG.CMPCOD
AND ULD.ULDNUM
= RTG.ULDNUM
			WHERE ULD.FLTCARIDR  = ?
			AND ULD.FLTNUM       = ?
			AND ULD.FLTSEQNUM    = ?

AND ULD.CMPCOD       = ?
			AND SEG.POU          = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>29</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findimportmanifestdetails" Type="NATIVE">
			<![CDATA[
	SELECT MST.MSTDOCNUM, MST.DUPNUM, MST.SEQNUM, MST.SCCCOD MSTSCCCOD,
			       MST.CMPCOD SEGCMPCOD,


MST.DOCOWRIDR, SEGSHP.RCVPCS SHPRCVPCS,
			       SEGSHP.RCVWGT SHPRCVWGT, SEGSHP.RCVVOL SHPRCVVOL,

MST.SHPDES
MSTSHPDES,
			       MST.ORGCOD MSTORGCOD, MST.DSTCOD MSTDSTCOD, MST.STDWGTCOD MSTSTDWGTCOD,



			       MST.STDDISWGT MSTSTDDISWGT, MST.CONFLG, MST.DTACPTFLG,
			       MST.PRDNAM MSTPRDNAM,
MST.PRDPRT
MSTPRDPRT,
MST.SHPPFX, MST.STDPCS,
			       MST.OWRCOD MSTOWRCOD, MST.STDWGT, MST.GRSVOL,MST.SLCPCS

STATEDSLCPCS,
SEG.CMPCOD ,
			       SEG.FLTCARIDR SEGFLTCARIDR, SEG.FLTNUM SEGFLTNUM,SEGSHP.RMK ARVRMK,



SEG.FLTSEQNUM SEGFLTSEQNUM, SEG.POL SEGPOL, SEG.POU SEGPOU,
			       SEG.SEGSERNUM SEGSEGSERNUM, SEGSHP.MFTPCS


SEGSHPMFTPCS,
			       SEGSHP.MFTWGT SEGSHPMFTWGT, SEGSHP.MFTVOL SEGSHPMFTVOL,
			       ARPSHP.DOCRCVFLG,ARPSHP.ARPCOD,ARPSHP.CRSDCKFLG,ARPSHP.DCSREQFLG,ARPSHP.RCVPCS,SHP.MFTPCS

TOTMFTPCS,SEGSHP.SLCPCS MFTSLCPCS,
			       SHP.MFTWGT TOTMFTWGT,
  (select SCICOD from OPRSHPMSTMIS

MIS
            where MIS .CMPCOD = MST.CMPCOD
              AND MIS.DOCOWRIDR = MST.DOCOWRIDR


              AND MIS.MSTDOCNUM = MST.MSTDOCNUM
              AND MIS.DUPNUM = MST.DUPNUM


              AND MIS.SEQNUM = MST.SEQNUM
  )SCICOD
			  FROM OPRSHPMST MST, OPRFLTSEG
SEG, OPRSEGULDSHP
SEGSHP,
OPRARPSHP ARPSHP
			  	   ,OPRSEGSHP SHP
			 WHERE MST.DOCOWRIDR = SHP.DOCOWRIDR(+)


AND
MST.MSTDOCNUM = SHP.MSTDOCNUM(+)
			   AND MST.DUPNUM = SHP.DUPNUM(+)
			   AND MST.SEQNUM = SHP.SEQNUM(+)



			   AND MST.CMPCOD = SHP.CMPCOD(+)
			   AND SHP.DOCOWRIDR = ARPSHP.DOCOWRIDR(+)
			   AND SHP.MSTDOCNUM


= ARPSHP.MSTDOCNUM(+)
			   AND SHP.DUPNUM = ARPSHP.DUPNUM(+)
			   AND SHP.SEQNUM = ARPSHP.SEQNUM(+)



			   AND SHP.CMPCOD = ARPSHP.CMPCOD(+)
			   AND SHP.FLTCARIDR = SEG.FLTCARIDR(+)
			   AND SHP.FLTNUM

= SEG.FLTNUM(+)

			   AND SHP.FLTSEQNUM = SEG.FLTSEQNUM(+)
			   AND SHP.SEGSERNUM = SEG.SEGSERNUM(+)



			   AND SHP.DOCOWRIDR
= SEGSHP.DOCOWRIDR(+)
			   AND SHP.MSTDOCNUM = SEGSHP.MSTDOCNUM(+)
			   AND
SHP.DUPNUM
= SEGSHP.DUPNUM(+)

AND SHP.SEQNUM = SEGSHP.SEQNUM(+)
			   AND SHP.CMPCOD = SEGSHP.CMPCOD(+)


AND SHP.FLTCARIDR = SEGSHP.FLTCARIDR(+)

AND SHP.FLTNUM = SEGSHP.FLTNUM(+)
			   AND SHP.FLTSEQNUM

= SEGSHP.FLTSEQNUM(+)
			   AND SHP.SEGSERNUM
= SEGSHP.SEGSERNUM(+)
			   AND SEGSHP.FLTCARIDR(+) =

?
			   AND SEGSHP.FLTNUM(+) = ?
			   AND SEGSHP.FLTSEQNUM(+)
= ?
			   AND SEGSHP.CMPCOD(+) = ?


			   AND ARPSHP.ARPCOD(+) = ?
			   AND SEG.POU(+) = ?
			   AND
MST.DOCOWRIDR = ?
			   AND MST.MSTDOCNUM

= ?
			   AND MST.DUPNUM = ?
			   AND MST.SEQNUM = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>30</QRY:Id>
		<QRY:Source Name="operations.flthandling.findbreakdownenquirydetails" Type="NATIVE">
			<![CDATA[
	SELECT ULD.ULDNUM, SHP.WHSCOD, ULD.FLTNUM, ULD.FLTCARIDR,
			FLT.FLTDAT,FLT.FLTCARCOD,ULD.THRINTFLG,



			COUNT(DISTINCT SHP.MSTDOCNUM) COUNT,MIN(HIS.STRTIM) MINIMUM,MAX(HIS.ENDTIM) MAXIMUM,HIS.BDNUSR


			FROM
OPRULDBDNDTL ULD,OPRSHPBDNDTL SHP,OPRULDBDNHIS HIS,OPRARPIMPFLT FLT, OPRSHPMST MST
			WHERE



			ULD.CMPCOD=FLT.CMPCOD

			AND ULD.ARPCOD=FLT.ARPCOD
			AND ULD.FLTCARIDR=FLT.FLTCARIDR
			AND
ULD.FLTNUM=FLT.FLTNUM

			AND ULD.FLTSEQNUM=FLT.FLTSEQNUM

			AND ULD.LEGSERNUM=FLT.LEGSERNUM


AND ULD.CMPCOD=SHP.CMPCOD

			AND ULD.ARPCOD=SHP.ARPCOD
			AND ULD.FLTCARIDR=SHP.FLTCARIDR


AND ULD.FLTNUM=SHP.FLTNUM
			AND
ULD.FLTSEQNUM=SHP.FLTSEQNUM
			AND ULD.LEGSERNUM=SHP.LEGSERNUM
			AND

ULD.ULDNUM=SHP.ULDNUM

			AND
ULD.CMPCOD=HIS.CMPCOD
			AND ULD.ARPCOD=HIS.ARPCOD
			AND ULD.FLTCARIDR=HIS.FLTCARIDR


			AND ULD.FLTNUM=HIS.FLTNUM

			AND ULD.FLTSEQNUM=HIS.FLTSEQNUM
			AND ULD.LEGSERNUM=HIS.LEGSERNUM

AND
ULD.ULDNUM=HIS.ULDNUM



			AND MST.DOCOWRIDR = SHP.DOCOWRIDR
			AND MST.MSTDOCNUM = SHP.MSTDOCNUM


			AND MST.DUPNUM = SHP.DUPNUM

			AND MST.SEQNUM = SHP.SEQNUM
			AND MST.CMPCOD = SHP.CMPCOD


AND ULD.CMPCOD
= ?
			AND ULD.ARPCOD = ?





			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>31</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findimportsummary" Type="NATIVE">
			<![CDATA[
	SELECT HIS.TXNCOD, FLT.CLSFLG, FLT.NILFLG, FLT.FLGFLG, FLT.MFTSRC,
	FLT.FLTOPRSTA, FLT.MANUPD,(SELECT MAX(MILSTNTIM)
  FROM QMSFLTMILSTNPLN FMP
  WHERE FMP.FLTNUM  = FLT.FLTNUM
  AND FMP.FLTSEQNUM = FLT.FLTSEQNUM
  AND FMP.FLTCARIDR = FLT.FLTCARIDR
  AND FMP.ARPCOD    = FLT.ARPCOD
  AND FMP.CMPCOD    = FLT.CMPCOD
  AND SERNUM        =
    (SELECT MAX(SERNUM)
    FROM QMSFLTMILSTNPLN FMP
    WHERE FMP.FLTNUM  = FLT.FLTNUM
    AND FMP.FLTSEQNUM = FLT.FLTSEQNUM
    AND FMP.FLTCARIDR = FLT.FLTCARIDR
    AND FMP.ARPCOD    = FLT.ARPCOD
    AND FMP.CMPCOD    = FLT.CMPCOD
    AND FMP.MILSTNCOD = 'IMP-PLN'
    AND FMP.PLNTYP    ='FP'
    AND FMP.OPRTYP    ='I'
    )
  AND FMP.MILSTNCOD = 'IMP-PLN'
  AND FMP.PLNTYP    ='FP'
  AND FMP.OPRTYP    ='I'
  )TIMTORELIMPPLN
		  FROM OPRIMPFLTHIS HIS, OPRARPIMPFLT FLT
		 WHERE FLT.CMPCOD = HIS.CMPCOD(+)
		   AND FLT.ARPCOD = HIS.ARPCOD(+)
		   AND FLT.FLTCARIDR = HIS.FLTCARIDR(+)
		   AND FLT.FLTNUM = HIS.FLTNUM(+)
		   AND FLT.FLTSEQNUM = HIS.FLTSEQNUM(+)
		   AND FLT.LEGSERNUM = HIS.LEGSERNUM(+)
		   AND HIS.TXNCOD(+)=?
		   AND FLT.CMPCOD = ?
		   AND FLT.ARPCOD = ?
		   AND FLT.FLTCARIDR = ?
		   AND FLT.FLTNUM = ?
	   	   AND FLT.FLTSEQNUM = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>32</QRY:Id>
		<QRY:Source Name="operations.flthandling.findUldSummaryDetails" Type="NATIVE">
			<![CDATA[
	SELECT ULD.ULDNUM,
  ULD.RCVFLG,
  ULD.MFTFLG,
	SUM( NVL(ULDSHP.MFTPCS,0) ) SUMMFTPCS,
  SUM(NVL(ULDSHP.RCVPCS,0)
) SUMRCVPCS,
	SUM(NVL(ULDSHP.MFTWGT,0)) SUMMFTWGT,
  COUNT( DISTINCT (
  CASE
    WHEN ULDSHP.MFTPCS
> 0
    THEN ( ULDSHP.MSTDOCNUM
      ||'`'
      || ULDSHP.DOCOWRIDR
      ||'`'
      || ULDSHP.SEQNUM

||'`'
      || ULDSHP.DUPNUM )
    ELSE NULL
END) ) MFTAWBS,
  COUNT( DISTINCT (
  CASE
    WHEN ULDSHP.RCVPCS
> 0
    THEN ( ULDSHP.MSTDOCNUM
      ||'`'
      || ULDSHP.DOCOWRIDR
      ||'`'
      || ULDSHP.SEQNUM

||'`'
      || ULDSHP.DUPNUM )
    ELSE NULL
  END) ) RCVAWBS,
  ULD.ULDPTY,
  ULD.ULDCTS,
  FLTSEG.POL,

(SELECT MIN(HIS.STRTIM)
  FROM OPRULDBDNHIS HIS
  WHERE HIS.CMPCOD  =ULD.CMPCOD
  AND HIS.FLTNUM    =ULD.FLTNUM

AND HIS.FLTCARIDR =ULD.FLTCARIDR
  AND HIS.FLTSEQNUM =ULD.FLTSEQNUM
  AND HIS.ULDNUM    =ULD.ULDNUM

AND HIS.ARPCOD    = FLTSEG.POU
  )BDNSTRTIM,
  HIS.ENDTIM ,
  HIS.BDNUSR,
  (SELECT SUM(COALESCE(DMG.DMGPCS,0
))
  FROM OPRDMGDTL DMG
  WHERE ULD.FLTNUM =DMG.FLTNUM
		        AND ULD.FLTCARIDR= DMG.FLTCARIDR

AND ULD.CMPCOD=
DMG.CMPCOD
		        AND ULD.FLTSEQNUM= DMG.FLTSEQNUM
	        AND ULD.ULDNUM= DMG.ULDNUM

) SUMDMGPCS
FROM OPRSEGULD ULD,
  OPRSEGULDSHP ULDSHP,
  OPRFLTSEG FLTSEG ,
  OPRULDBDNHIS HIS
WHERE
ULD.FLTCARIDR  =ULDSHP.FLTCARIDR(+)
AND ULD.FLTNUM       =ULDSHP.FLTNUM(+)
AND ULD.FLTSEQNUM    =ULDSHP.FLTSEQNUM(+)
AND
ULD.SEGSERNUM    =ULDSHP.SEGSERNUM(+)
AND ULD.ULDNUM       =ULDSHP.ULDNUM(+)
AND ULD.CMPCOD       =ULDSHP.CMPCOD(+)
AND
ULD.FLTNUM       =FLTSEG.FLTNUM
AND ULD.FLTCARIDR    =FLTSEG.FLTCARIDR
AND ULD.CMPCOD       =FLTSEG.CMPCOD
AND
ULD.FLTSEQNUM    =FLTSEG.FLTSEQNUM
AND ULD.SEGSERNUM    =FLTSEG.SEGSERNUM
AND ULD.CMPCOD       =HIS.CMPCOD(+)
AND
ULD.FLTNUM       =HIS.FLTNUM(+)
AND ULD.FLTCARIDR    =HIS.FLTCARIDR(+)
AND ULD.FLTSEQNUM    =HIS.FLTSEQNUM(+)
AND
ULD.ULDNUM       =HIS.ULDNUM(+)
AND NVL(HIS.ARPCOD,FLTSEG.POU) = FLTSEG.POU

	AND
ULD.SEGSERNUM=FLTSEG.SEGSERNUM


	AND ULDSHP.SEQNUM(+) = 1
AND ( HIS.SERNUM     =
  (SELECT MAX(SERNUM)
  FROM OPRULDBDNHIS
  WHERE FLTNUM
=ULD.FLTNUM
	AND FLTCARIDR=ULD.FLTCARIDR
  AND CMPCOD   =ULD.CMPCOD
	AND FLTSEQNUM=ULD.FLTSEQNUM
  AND
ULDNUM   =ULD.ULDNUM
  AND ARPCOD    =FLTSEG.POU
	)
OR NVL(HIS.SERNUM,0)       = 0 )
AND ( NVL(ULDSHP.MFTPCS,0)
> 0
OR NVL(ULDSHP.RCVPCS,0)    > 0 )
	AND ULD.FLTNUM=?
	AND ULD.FLTSEQNUM=?

	AND ULD.CMPCOD=?
	AND
ULD.FLTCARIDR=?
GROUP BY ULD.ULDNUM,
  ULD.RCVFLG,
  ULD.MFTFLG,
  ULD.ULDPTY,
  ULD.ULDCTS,
  FLTSEG.POL,

HIS.ENDTIM ,
  HIS.BDNUSR,
  ULDSHP.FLTCARIDR,
  ULDSHP.FLTNUM,
  ULDSHP.FLTSEQNUM,
  ULDSHP.SEGSERNUM,

ULDSHP.ULDNUM,
  ULDSHP.SEQNUM,
  ULD.FLTNUM,
  ULD.FLTCARIDR,
  ULD.CMPCOD,
  ULD.FLTSEQNUM,
  FLTSEG.POU


			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>33</QRY:Id>
		<QRY:Source Name="operations.flthandling.findShipmentSummaryDetails" Type="NATIVE">
			<![CDATA[
SELECT SHP.MFTPCS,SHP.RCVPCS,SHP.SEQNUM,SHPMST.SCCCOD,SHPMST.CONFLG,SHPMST.ORGCOD,SHPMST.DSTCOD,SHP.DOCOWRIDR,SHP.MSTDOCNUM,
	SHP.DUPNUM,SHP.SEQNUM FROM OPRSEGSHP SHP,OPRSHPMST SHPMST
	WHERE
	SHP.DOCOWRIDR=SHPMST.DOCOWRIDR
	AND SHP.MSTDOCNUM=SHPMST.MSTDOCNUM
	AND SHP.DUPNUM=SHPMST.DUPNUM
	AND SHP.SEQNUM=SHPMST.SEQNUM
	AND SHP.FLTNUM=?
	AND SHP.FLTSEQNUM=?
	AND SHP.CMPCOD=?
	AND SHP.FLTCARIDR=?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>34</QRY:Id>
		<QRY:Source Name="operations.flthandling.findFlightTransactions" Type="NATIVE">
			<![CDATA[
SELECT HIS.TXNCOD,HIS.STRTIM,HIS.ENDTIM
		FROM OPRIMPFLTHIS HIS
		WHERE HIS.ARPCOD=?
		AND HIS.CMPCOD=?
		AND HIS.FLTCARIDR=?
		AND HIS.FLTNUM=?
		AND HIS.FLTSEQNUM=?
		AND HIS.LEGSERNUM=?
		ORDER BY HIS.STRTIM,HIS.ENDTIM
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>35</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.finduldtagdetails" Type="NATIVE">
			<![CDATA[
		SELECT ULD.CMPCOD,
			  ULD.ULDNUM,
			  ULD.FLTNUM,
			  ULD.FLTCARIDR,
			  ULD.FLTSEQNUM,
			  ULD.SEGSERNUM,
ULD.DSTCOD,
			  ULD.ACRPOS,
				  CASE
					WHEN SEGULD.ULDNUM IS NOT NULL
					THEN SEGULD.TARWGT
					ELSE ULD.TARWGT
END TARWGT,
				  CASE
					WHEN SEGULD.ULDNUM IS NOT NULL
					THEN SEGULD.NETWGT
					ELSE ULD.NETWGT
				  END NETWGT,
				  CASE
					WHEN SEGULD.ULDNUM IS NOT NULL
					THEN SEGULD.GRSWGT
					ELSE ULD.GRSWGT
				  END GRSWGT,
				  CASE
					WHEN SEGULD.ULDNUM IS NOT NULL
					THEN SEGULD.ACTWGT
					ELSE ULD.ACTWGT
				  END ACTWGT,
			  ULD.ULDCON,
			  ULD.TAGRMK,
			  ULD.WABRMK,
TRF.TRFARPCOD,
			  TRF.TRFCARCOD,
			  TRF.TRFCARIDR,
			  TRFFLTDAT,
			  TRFFLTNUM,
				  TRF.ACRPOS AS TRFACRPOS,
			  TRF.SERNUM,
			  ULD.LSTUPDTIM,
			  ULD.LSTUPDUSR,
			  ULD.POU,
			  FLT.POL,
ULD.ULDTAGPTRFLG,
			  SEGULD.LWRDCKONE,
			  SEGULD.LWRDCKTWO,
			  SEGULD.UPRDCKONE,
			  SEGULD.UPRDCKTWO,
			  SEGULD.ULDCTR,
			  ULD.ULDCTR TAGCTR,
			  SEGULD.BARROWFLG,
			  ULD.ULDHGT,
	ULD.ULDLODCTG,
	ULD.DLCCOD,
SEGULD.ULDBKGIDR BKGID,
			  ULDSHP.SEQNUM,
			  MST.SCCCOD,
			  ULD.LODTYP,
			  ULD.DOLTARWGT,
				  SEGULD.BSEFLG,
				  ULD.ULDOCP,
				  MST.MSTDOCNUM,
				  MST.SHPPFX,
				  MST.ORGCOD,
				  ULDSHP.BDPPCS,
				  MST.STDPCS,
				  DGR.MSTDOCNUM DGRMSTDOCNUM,
				  MST.DSTCOD AS SHPDSTCOD,
				  (SELECT DISTINCT FLTSEG.POL
				  FROM OPRSEGULDSHP SEGSHP,
					OPRFLTSEG FLTSEG
				  WHERE ULDSHP.CMPCOD  = SEGSHP.CMPCOD
				  AND ULDSHP.ULDNUM    = SEGSHP.ULDNUM
				  AND ULDSHP.MSTDOCNUM = SEGSHP.MSTDOCNUM
				  AND ULDSHP.DOCOWRIDR = SEGSHP.DOCOWRIDR
				  AND ULDSHP.DUPNUM    = SEGSHP.DUPNUM
				  AND ULDSHP.SEQNUM    = SEGSHP.SEQNUM
				  AND SEGSHP.CMPCOD    = FLTSEG.CMPCOD
				  AND SEGSHP.FLTNUM    = FLTSEG.FLTNUM
				  AND SEGSHP.FLTCARIDR = FLTSEG.FLTCARIDR
				  AND SEGSHP.FLTSEQNUM = FLTSEG.FLTSEQNUM
				  AND SEGSHP.SEGSERNUM = FLTSEG.SEGSERNUM
				  AND FLTSEG.POU       = FLT.POL
				  AND ROWNUM           =1
				  )ULDORG,
					  (SELECT ULDWGTDTL.ACTWGT
			  FROM OPRULDWGTDTL ULDWGTDTL
			  WHERE ULD.CMPCOD  = ULDWGTDTL.CMPCOD
			  AND FLT.POL 		= ULDWGTDTL.ARPCOD
			  AND ULD.ULDNUM    = ULDWGTDTL.ULDNUM
			  AND ULD.FLTCARIDR = ULDWGTDTL.FLTCARIDR
			  AND ULD.FLTNUM    = ULDWGTDTL.FLTNUM
			  AND ULD.FLTSEQNUM = ULDWGTDTL.FLTSEQNUM
			  AND ULDWGTDTL.SERNUM =
				(SELECT MAX(SERNUM)
				FROM OPRULDWGTDTL DTL
				WHERE DTL.CMPCOD     = ULD.CMPCOD
				AND DTL.ARPCOD       = FLT.POL
				AND DTL.ULDNUM       = ULD.ULDNUM
				AND DTL.FLTCARIDR(+) = ULD.FLTCARIDR
				AND DTL.FLTNUM(+)    = ULD.FLTNUM
				AND DTL.FLTSEQNUM(+) = ULD.FLTSEQNUM
				)
			  )SCLACTWGT
FROM OPRULDTAG ULD
		JOIN OPRFLTSEG FLT
			ON ULD.CMPCOD     = FLT.CMPCOD
			AND ULD.FLTNUM    = FLT.FLTNUM
				AND ULD.FLTCARIDR = FLT.FLTCARIDR
				AND ULD.FLTSEQNUM = FLT.FLTSEQNUM
				AND ULD.SEGSERNUM = FLT.SEGSERNUM
		LEFT OUTER JOIN OPRULDTRFDTL TRF
			ON ULD.CMPCOD    =TRF.CMPCOD
		AND ULD.FLTCARIDR=TRF.FLTCARIDR
			AND ULD.FLTNUM   =TRF.FLTNUM
		AND ULD.FLTSEQNUM=TRF.FLTSEQNUM
		AND ULD.SEGSERNUM=TRF.SEGSERNUM
			AND ULD.ULDNUM   =TRF.ULDNUM
		LEFT OUTER JOIN OPRSEGULD SEGULD
			ON ULD.CMPCOD     = SEGULD.CMPCOD
AND ULD.FLTCARIDR = SEGULD.FLTCARIDR
			AND ULD.FLTNUM    = SEGULD.FLTNUM
		AND ULD.FLTSEQNUM = SEGULD.FLTSEQNUM
AND ULD.SEGSERNUM = SEGULD.SEGSERNUM
			AND ULD.ULDNUM    = SEGULD.ULDNUM
				LEFT OUTER JOIN OPRSEGULDSHP ULDSHP
			ON SEGULD.CMPCOD     = ULDSHP.CMPCOD
		AND SEGULD.FLTCARIDR = ULDSHP.FLTCARIDR
				AND SEGULD.FLTNUM    = ULDSHP.FLTNUM
				AND SEGULD.FLTSEQNUM = ULDSHP.FLTSEQNUM
				AND SEGULD.SEGSERNUM = ULDSHP.SEGSERNUM
				AND SEGULD.ULDNUM    = ULDSHP.ULDNUM
				LEFT OUTER JOIN OPRSHPMST MST
				ON ULDSHP.CMPCOD     = MST.CMPCOD
				AND ULDSHP.MSTDOCNUM = MST.MSTDOCNUM
				AND ULDSHP.DOCOWRIDR = MST.DOCOWRIDR
				AND ULDSHP.DUPNUM    = MST.DUPNUM
				AND ULDSHP.SEQNUM    = MST.SEQNUM
				LEFT OUTER JOIN OPRSHPDGR DGR
				ON MST.CMPCOD     = DGR.CMPCOD
				AND MST.MSTDOCNUM = DGR.MSTDOCNUM
				AND MST.DOCOWRIDR = DGR.DOCOWRIDR
				AND MST.DUPNUM    = DGR.DUPNUM
				AND MST.SEQNUM    = DGR.SEQNUM
				WHERE ULD.CMPCOD  = ?
				AND ULD.FLTNUM    = ?
				AND ULD.FLTCARIDR = ?
				AND ULD.FLTSEQNUM = ?
				AND FLT.POL       = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>36</QRY:Id>
		<QRY:Source Name="operations.flthandling.findbreakdownhistory" Type="NATIVE">
			<![CDATA[
	   SELECT BDNUSR,STRTIM,ENDTIM
			FROM OPRULDBDNHIS
			WHERE CMPCOD = ?
			AND ARPCOD = ?
			AND ULDNUM = ?
			AND FLTCARIDR = ?
			AND FLTNUM = ?
			AND FLTSEQNUM = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>37</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findoperationaluldforuldtag" Type="NATIVE">
			<![CDATA[
		SELECT ULD.CMPCOD,
			  ULD.ULDNUM,
			  ULD.FLTNUM,
			  ULD.FLTCARIDR,
			  ULD.FLTSEQNUM,
			  ULD.SEGSERNUM,
ULD.TARWGT,
			  ULD.GRSWGT,
			  ULD.NETWGT,
			  ULD.LSTUPDUSR,
			  ULD.LSTUPDTIM,
			  CASE WHEN DWSULD.BLKRMK IS NOT NULL THEN DWSULD.BLKRMK WHEN DWSBLK.BLKRMK IS NOT NULL THEN DWSBLK.BLKRMK ELSE ULD.RMK End TAGRMK,
ULD.CONIDR ULDCON,
			  ULD.ULDDST DSTCOD,
			  ULD.ULDPOS ACRPOS,
			  ULD.ULDCTR,
			  FLT.POU,
FLT.POL,
			  ULD.BARROWFLG,
			  ULD.LWRDCKONE,
			  ULD.LWRDCKTWO,
			  ULD.UPRDCKONE,
			  ULD.UPRDCKTWO,
ULD.ULDBKGIDR BKGID,
			  ULD.ACTWGT,
			  ULDSHP.SEQNUM,
			  MST.SCCCOD,
			  ULD.ULDOCP,
  MST.MSTDOCNUM,
MST.SHPPFX,
  MST.ORGCOD,
  ULDSHP.BDPPCS,
  MST.STDPCS,
  ULD.BSEFLG,
  MST.DSTCOD AS SHPDSTCOD,
		  (SELECT DISTINCT FLTSEG.POL
		  FROM OPRSEGULDSHP SEGSHP,
			OPRFLTSEG FLTSEG
		  WHERE ULDSHP.CMPCOD  = SEGSHP.CMPCOD
		  AND ULDSHP.ULDNUM    = SEGSHP.ULDNUM
		  AND ULDSHP.MSTDOCNUM = SEGSHP.MSTDOCNUM
					  AND ULDSHP.DOCOWRIDR = SEGSHP.DOCOWRIDR
					  AND ULDSHP.DUPNUM    = SEGSHP.DUPNUM
		  AND ULDSHP.SEQNUM    = SEGSHP.SEQNUM
		  AND ULDSHP.SEGSERNUM = SEGSHP.SEGSERNUM
		  AND SEGSHP.CMPCOD    = FLTSEG.CMPCOD
		  AND SEGSHP.FLTNUM    = FLTSEG.FLTNUM
		  AND SEGSHP.FLTCARIDR = FLTSEG.FLTCARIDR
		  AND SEGSHP.FLTSEQNUM = FLTSEG.FLTSEQNUM
		  AND SEGSHP.SEGSERNUM = FLTSEG.SEGSERNUM
		  AND FLTSEG.POU       = FLT.POL
		  AND ROWNUM           =1
		  )ULDORG,
		  (SELECT ULDWGTDTL.ACTWGT
		  FROM OPRULDWGTDTL ULDWGTDTL
		  WHERE ULD.CMPCOD     = ULDWGTDTL.CMPCOD
		  AND FLT.POL          = ULDWGTDTL.ARPCOD
		  AND ULD.ULDNUM       = ULDWGTDTL.ULDNUM
		  AND ULD.FLTCARIDR    = ULDWGTDTL.FLTCARIDR
		  AND ULD.FLTNUM       = ULDWGTDTL.FLTNUM
		  AND ULD.FLTSEQNUM    = ULDWGTDTL.FLTSEQNUM
		  AND ULDWGTDTL.SERNUM =
			(SELECT MAX(SERNUM)
			FROM OPRULDWGTDTL DTL
			WHERE DTL.CMPCOD     = ULD.CMPCOD
			AND DTL.ARPCOD       = FLT.POL
			AND DTL.ULDNUM       = ULD.ULDNUM
			AND DTL.FLTCARIDR(+) = ULD.FLTCARIDR
			AND DTL.FLTNUM(+)    = ULD.FLTNUM
			AND DTL.FLTSEQNUM(+) = ULD.FLTSEQNUM
			)
		  )SCLACTWGT
		FROM OPRSEGULD ULD
		JOIN OPRFLTSEG FLT
		ON ULD.FLTNUM     = FLT.FLTNUM
		AND ULD.FLTCARIDR = FLT.FLTCARIDR
		AND ULD.FLTSEQNUM = FLT.FLTSEQNUM
		AND ULD.SEGSERNUM = FLT.SEGSERNUM
		AND ULD.CMPCOD    = FLT.CMPCOD
		JOIN OPRARPEXPFLT EXPFLT 
		ON EXPFLT.FLTNUM = FLT.FLTNUM
		AND EXPFLT.FLTCARIDR = FLT.FLTCARIDR
		AND EXPFLT.FLTSEQNUM = FLT.FLTSEQNUM
		AND EXPFLT.CMPCOD    = FLT.CMPCOD
		AND EXPFLT.ARPCOD    = FLT.POL
	LEFT OUTER JOIN OPRSEGULDSHP ULDSHP
			ON ULD.FLTNUM     = ULDSHP.FLTNUM
	AND ULD.FLTCARIDR = ULDSHP.FLTCARIDR
	AND ULD.FLTSEQNUM = ULDSHP.FLTSEQNUM
	AND ULD.SEGSERNUM = ULDSHP.SEGSERNUM
			AND ULD.CMPCOD    = ULDSHP.CMPCOD
AND ULD.ULDNUM    = ULDSHP.ULDNUM
	LEFT OUTER JOIN OPRSHPMST MST
			ON ULDSHP.CMPCOD     = MST.CMPCOD
			AND ULDSHP.MSTDOCNUM = MST.MSTDOCNUM
			AND ULDSHP.DOCOWRIDR = MST.DOCOWRIDR
AND ULDSHP.DUPNUM    = MST.DUPNUM
			AND ULDSHP.SEQNUM    = MST.SEQNUM
			LEFT OUTER JOIN OPRDWSULD DWSULD
			ON DWSULD.CMPCOD     = ULD.CMPCOD
			AND DWSULD.FLTCARIDR = ULD.FLTCARIDR
			AND DWSULD.FLTNUM    = ULD.FLTNUM
			AND DWSULD.FLTSEQNUM = ULD.FLTSEQNUM
			AND DWSULD.LEGSERNUM = EXPFLT.LEGSERNUM
			AND DWSULD.ULDNUM    = ULD.ULDNUM
			LEFT OUTER JOIN OPRDWSBLK DWSBLK
			ON DWSBLK.CMPCOD     = ULD.CMPCOD
			AND DWSBLK.FLTCARIDR = ULD.FLTCARIDR
			AND DWSBLK.FLTNUM    = ULD.FLTNUM
			AND DWSBLK.FLTSEQNUM = ULD.FLTSEQNUM
			AND DWSBLK.LEGSERNUM = EXPFLT.LEGSERNUM
			AND DWSBLK.CNTIDR    = ULD.ULDNUM
		WHERE ULD.CMPCOD     	= ?
			AND ULD.FLTNUM       = ?
			AND ULD.ULDNUM       = ?
			AND ULD.FLTCARIDR    =?
			AND ULD.FLTSEQNUM    =?
			AND FLT.POL 		 =?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>38</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.finduldbreakdowndetails" Type="NATIVE">
			<![CDATA[
SELECT IMPFLT.CMPCOD, IMPFLT.FLTCARIDR, IMPFLT.FLTNUM, IMPFLT.FLTSEQNUM,IMPFLT.FLTOPRSTA,
	       SEGULD.SEGSERNUM,


IMPFLT.LEGSERNUM, FLTSEG.POL,FLTSEG.POU, SEGULD.ULDNUM,SEGULD.RCVFLG,
	       ULDBDN.THRINTFLG, IMPFLT.CLSFLG,


IMPFLT.NILFLG, IMPFLT.FLTDAT,
	       IMPFLT.ARPCOD, ULDBDN.WHSCOD, IMPFLT.FLTCARCOD, IMPHIS.TXNCOD



	       ,IMPFLT.FLTOPRSTA,SEGULD.MFTFLG, SEGULD.BDPFLG,SEGULD.BDNCPLFLG,THRUNT,
			  CASE
			WHEN
((IMPFLT.MFTSRC
='F' AND SEGULD.BKGTYP IS NULL) OR ULDBKG.BKGSTA ='XX')
			THEN 'BDN Unit'
				WHEN
(SEGULD.BKGTYP =
'ULD' AND ULDBKG.BKGTYP IS NOT NULL)
				THEN (
				  CASE
					WHEN (ULDBDN.ULDNUM
IS NOT NULL

					AND ULDBDN.THRINTFLG   <>'T'
					AND ULDBDN.THRINTFLG   <>'I')
					THEN 'BDN
Unit'
					ELSE ULDBKG.BKGTYP

				  END)
			WHEN (SEGULD.BKGTYP IS NOT NULL AND SEGULD.BKGTYP
<> 'ULD')
			THEN (
			  CASE
							WHEN (ULDBDN.ULDNUM
IS NOT NULL
							AND ULDBDN.THRINTFLG   <>'T'

AND ULDBDN.THRINTFLG   <>'I')
				THEN 'BDN Unit'

				ELSE SEGULD.BKGTYP
			  END)
			ELSE 'BDN
Unit'
END BKGTYP,
ULDBKG.ULDBKGIDR,SEGULD.ULDDST,SEGULD.BDNITN


	  FROM OPRULDBDNDTL ULDBDN,

OPRARPIMPFLT IMPFLT,
	       OPRFLTSEG FLTSEG,
	       OPRSEGULD
SEGULD,

	       OPRIMPFLTHIS
IMPHIS,
		     CAPULDBKGMST ULDBKG
	 WHERE IMPFLT.CMPCOD = FLTSEG.CMPCOD

	   AND IMPFLT.FLTCARIDR
= FLTSEG.FLTCARIDR

	   AND IMPFLT.FLTNUM = FLTSEG.FLTNUM
	   AND IMPFLT.FLTSEQNUM
= FLTSEG.FLTSEQNUM

AND IMPFLT.ARPCOD =
FLTSEG.POU
	   AND FLTSEG.CMPCOD = SEGULD.CMPCOD
	   AND
FLTSEG.FLTCARIDR = SEGULD.FLTCARIDR

AND
FLTSEG.FLTNUM = SEGULD.FLTNUM
	   AND FLTSEG.FLTSEQNUM =
SEGULD.FLTSEQNUM
	   AND FLTSEG.SEGSERNUM
=
SEGULD.SEGSERNUM
	   AND IMPFLT.CMPCOD = ULDBDN.CMPCOD(+)

	   AND IMPFLT.FLTCARIDR = ULDBDN.FLTCARIDR(+)


	   AND IMPFLT.FLTNUM = ULDBDN.FLTNUM(+)
	   AND IMPFLT.FLTSEQNUM
= ULDBDN.FLTSEQNUM(+)
	   AND IMPFLT.LEGSERNUM

= ULDBDN.LEGSERNUM(+)
	   AND IMPFLT.ARPCOD = ULDBDN.ARPCOD(+)

	   AND IMPFLT.CMPCOD = IMPHIS.CMPCOD(+)


	   AND IMPFLT.FLTCARIDR = IMPHIS.FLTCARIDR(+)
	   AND IMPFLT.FLTNUM
= IMPHIS.FLTNUM(+)
	   AND IMPFLT.FLTSEQNUM

= IMPHIS.FLTSEQNUM(+)
	   AND IMPFLT.ARPCOD = IMPHIS.ARPCOD(+)

	   AND IMPFLT.LEGSERNUM = IMPHIS.LEGSERNUM(+)

AND SEGULD.CMPCOD = ULDBKG.CMPCOD (+)
	   AND SEGULD.ULDBKGIDR
= ULDBKG.ULDBKGIDR (+)
           AND
SEGULD.CMPCOD = ?



			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>38</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findbreakdowndetails" Type="NATIVE">
			<![CDATA[
						SELECT BDNDTL.WHSCOD BDNDTLWHSCOD, BDNDTL.LOCCOD BDNDTLLOCCOD, SHPMST.DOCOWRIDR, SHPMST.MSTDOCNUM,
SHPMST.SEQNUM, SHPMST.CMPCOD, MIS.SCICOD,
				  SHPMST.DUPNUM, SHPMST.PARSEQNUM, ULDSHP.SEQNUM ULDSHPSEQNUM,
ULDSHP.FLTCARIDR, ULDSHP.FLTNUM, ULDSHP.FLTSEQNUM, ULDSHP.SEGSERNUM, ULDSHP.ULDNUM,
				  ULDSHP.MSTDOCNUM
BDNDTLMSTDOCNUM, ULDSHP.ULDNUM BDNDTLULDNUM, ULDSHP.FLTNUM BDNDTLFLTNUM, ULDSHP.FLTSEQNUM BDNDTLFLTSEQNUM,

				  ULDSHP.FLTCARIDR BDNDTLFLTCARIDR, ULDSHP.DOCOWRIDR BDNDTLDOCOWRIDR, BDNDTL.SERNUM BDNDTLSERNUM,
BDNDTL.SEQNUM BDNDTLSEQNUM,
				  ULDSHP.DUPNUM BDNDTLDUPNUM, BDNDTL.LEGSERNUM BDNDTLLEGSERNUM, BDNDTL.ARPCOD
BDNDTLARPCOD, ULDSHP.CMPCOD BDNDTLCMPCOD, FLTSEG.POU ARPCOD,
				  FLTSEG.POL, SHPMST.SHPPFX, SHPMST.OWRCOD,
BDNDTL.RCVPCS, BDNDTL.RCVWGT, BDNDTL.RCVVOL, ULDSHP.MFTPCS, ULDSHP.MFTWGT, TXNHSE.PCS, TXNHSE.WGT,

ULDSHP.MFTVOL, SHPMST.CONFLG, SHPMST.DOCNUM, SHPMST.DSTCOD, SHPMST.GRSVOL, SHPMST.ORGCOD, SHPMST.SCCCOD
MSTSCCCOD, SHPMST.SHPDES, SHPMST.STDPCS,
				  SHPMST.STDWGT,SHPMST.DOMFLG,BDNDTL.RCVPCS BDNDTLRCVPCS,
BDNDTL.RCVWGT BDNDTLRCVWGT, BDNDTL.RCVVOL BDNDTLRCVVOL, BDNDTL.SCCCOD BDNDTLSCCCOD,
				  BDNDTL.STUCOD
BDNDTLSTUCOD, DMG.MSTDOCNUM DMGMSTDOCNUM, DMG.ULDNUM DMGULDNUM, DMG.FLTNUM DMGFLTNUM, DMG.FLTSEQNUM DMGFLTSEQNUM,

DMG.FLTCARIDR DMGFLTCARIDR, DMG.DOCOWRIDR DMGDOCOWRIDR, DMG.SEQNUM DMGSEQNUM, DMG.DUPNUM DMGDUPNUM, DMG.LEGSERNUM
DMGLEGSERNUM,
				  DMG.ARPCOD DMGARPCOD, DMG.CMPCOD DMGCMPCOD, DMG.DMGCOD DMGDMGCOD, DMG.DMGPCS DMGDMGPCS,
DIS.IMGPTH, DIS.DISDAT, DIS.RMK, DIS.DISSEQNUM,
				  DMGREP.RPTSERNUM DMGREFNUM, SHPMST.PLTFLG, DTL.PLTUSEFLG,
DTL.APRFLG, ARP.PLTUSEFLG ARPPLTUSEFLG, ARP.CONBDNFLG CONBDNFLG, SHPHSE.HSEPTH,
				  SEGULD.THRUNT,
SHPMST.LSTUPDTIM SHPMSTLSTUPDTIM, SHPMST.LSTUPDUSR SHPMSTLSTUPDUSR, SEGULD.LSTUPDTIM SEGULDLSTUPDTIM,

				  SEGULD.LSTUPDUSR SEGULDLSTUPDUSR,ULDBKG.ULDBKGIDR, SEGULD.ULDDST, ARP.LSTUPDTIM ARPLSTUPDTIM,
ARP.LSTUPDUSR ARPLSTUPDUSR,
				  CASE
					WHEN ULDBKG.BKGTYP     IS NOT NULL
					AND SEGULD.ULDLKGCNFFLG
= 'Y'
					AND BKGSTA             <> 'XX'
					THEN ULDBKG.BKGTYP




























































































ELSE
SEGULD.BKGTYP
				  END BKGTYP, DTL.LSTUPDTIM DTLLSTUPDTIM, DTL.LSTUPDUSR DTLLSTUPDUSR, SHPHSE.LSTUPDTIM
SHPHSELSTUPDTIM, SHPHSE.LSTUPDUSR SHPHSELSTUPDUSR,
				  SEGSHP.LSTUPDTIM SEGSHPUPDTIM, SHPMST.PRDNAM,
SHPMST.PRDCOD, SHPMST.PRDPRT, SHPMST.CNSCOD,SHPMST.STDWGTCOD, 'F' SHPTYP, ARP.DCSREQFLG, ARP.DCSFLG,

				  ARP.RCVPCS ARPRCVPCS,ARP.RCVWGT ARPRCVWGT, ARP.DOCRCVFLG, ARP.DCSCPLFLG, ARPULD.LSTUPDTIM ARPULDLSTUPDTIM,
SEGULD.MFTFLG, SEGULD.BDPFLG, SRYDTL.CDSSTA,SHPMST.RDYCRGFLG
				FROM OPRSHPBDNDTL BDNDTL, OPRFLTSEG FLTSEG, OPRSEGULD
SEGULD, OPRSEGULDSHP ULDSHP, OPRSEGSHP SEGSHP, OPRSHPMST SHPMST, OPRSHPMSTMIS MIS,
				  OPRDMGDTL DMG,
OPRSHPDTL DTL, OPRDMGDIS DIS, OPRARPSHP ARP, OPRSHPHSE SHPHSE, TRCDMGREP DMGREP, OPRTXNHSE TXNHSE, CAPULDBKGMST
ULDBKG,












































				   
OPRARPULD ARPULD,  OPRDMGSRYDTL
SRYDTL
					   WHERE SHPMST.DOCOWRIDR = ULDSHP.DOCOWRIDR(+)


AND SHPMST.MSTDOCNUM = ULDSHP.MSTDOCNUM(+)

					     AND SHPMST.DUPNUM = ULDSHP.DUPNUM(+)


					     AND SHPMST.CMPCOD = ULDSHP.CMPCOD(+)

AND SHPMST.DOCOWRIDR = DTL.DOCOWRIDR(+)
				AND SHPMST.MSTDOCNUM    = DTL.MSTDOCNUM(+)


				AND SHPMST.DUPNUM
= DTL.DUPNUM(+)
				AND SHPMST.SEQNUM       = DTL.SEQNUM(+)


					     AND SHPMST.CMPCOD
= DTL.CMPCOD(+)
				AND SHPMST.DOCOWRIDR    = MIS.DOCOWRIDR
				AND SHPMST.MSTDOCNUM    = MIS.MSTDOCNUM



AND SHPMST.DUPNUM = MIS.DUPNUM

					    AND SHPMST.SEQNUM = MIS.SEQNUM

					    AND
SHPMST.CMPCOD = MIS.CMPCOD
				AND SEGULD.CMPCOD       = FLTSEG.CMPCOD
				AND SEGULD.FLTCARIDR    =
FLTSEG.FLTCARIDR


				AND SEGULD.FLTNUM = FLTSEG.FLTNUM

					     AND SEGULD.FLTSEQNUM = FLTSEG.FLTSEQNUM


					     AND SEGULD.SEGSERNUM = FLTSEG.SEGSERNUM

				AND SEGULD.CMPCOD = ULDSHP.CMPCOD
				AND
SEGULD.FLTCARIDR    = ULDSHP.FLTCARIDR
				AND SEGULD.FLTNUM       = ULDSHP.FLTNUM


					     AND SEGULD.FLTSEQNUM
= ULDSHP.FLTSEQNUM
				AND SEGULD.SEGSERNUM    = ULDSHP.SEGSERNUM


				AND SEGULD.ULDNUM = ULDSHP.ULDNUM

AND ULDSHP.FLTCARIDR    = FLTSEG.FLTCARIDR


				AND ULDSHP.FLTNUM = FLTSEG.FLTNUM
					     AND ULDSHP.FLTSEQNUM
= FLTSEG.FLTSEQNUM
				AND ULDSHP.SEGSERNUM    = FLTSEG.SEGSERNUM


				AND ULDSHP.CMPCOD = FLTSEG.CMPCOD

AND ULDSHP.FLTCARIDR    = SEGSHP.FLTCARIDR


				AND ULDSHP.FLTNUM = SEGSHP.FLTNUM
					     AND
ULDSHP.FLTSEQNUM = SEGSHP.FLTSEQNUM


					     AND ULDSHP.SEGSERNUM = SEGSHP.SEGSERNUM

AND ULDSHP.DOCOWRIDR = SEGSHP.DOCOWRIDR
				AND ULDSHP.MSTDOCNUM    = SEGSHP.MSTDOCNUM


				AND ULDSHP.DUPNUM
= SEGSHP.DUPNUM
					     AND ULDSHP.SEQNUM = SEGSHP.SEQNUM


						 AND ULDSHP.CMPCOD
= SEGSHP.CMPCOD
				AND ULDSHP.DOCOWRIDR = BDNDTL.DOCOWRIDR(+)
				AND ULDSHP.MSTDOCNUM    = BDNDTL.MSTDOCNUM(+)



AND ULDSHP.DUPNUM = BDNDTL.DUPNUM(+)
				AND ULDSHP.SEQNUM       = BDNDTL.SEQNUM(+)



AND ULDSHP.FLTCARIDR = BDNDTL.FLTCARIDR(+)
				AND ULDSHP.FLTNUM       = BDNDTL.FLTNUM(+)
				AND ULDSHP.FLTSEQNUM
= BDNDTL.FLTSEQNUM(+)


				AND ULDSHP.ULDNUM = BDNDTL.ULDNUM(+)

					     AND ULDSHP.CMPCOD = BDNDTL.CMPCOD(+)

AND SHPMST.MSTDOCNUM    = DMG.MSTDOCNUM(+)
				AND SHPMST.DOCOWRIDR    = DMG.DOCOWRIDR(+)
				AND SHPMST.DUPNUM
= DMG.DUPNUM(+)
				AND SHPMST.CMPCOD       = DMG.CMPCOD(+)
				AND SHPMST.SEQNUM       = DMG.SEQNUM(+)

AND SHPMST.MSTDOCNUM    = ARP.MSTDOCNUM(+)















				AND SHPMST.DOCOWRIDR = ARP.DOCOWRIDR(+)

AND SHPMST.DUPNUM       = ARP.DUPNUM(+)


				AND SHPMST.CMPCOD = ARP.CMPCOD(+)
					     AND SHPMST.SEQNUM
= ARP.SEQNUM(+)


					     AND SHPMST.DOCOWRIDR = SHPHSE.DOCOWRIDR(+)
				AND SHPMST.MSTDOCNUM
= SHPHSE.MSTDOCNUM(+)
				AND SHPMST.DUPNUM       = SHPHSE.DUPNUM(+)


				AND SHPMST.SEQNUM = SHPHSE.SEQNUM(+)

				AND SHPMST.CMPCOD       = SHPHSE.CMPCOD(+)
				AND DMG.FLTCARIDR       = DIS.FLTCARIDR(+)
				AND
DMG.FLTNUM          = DIS.FLTNUM(+)
				AND DMG.FLTSEQNUM       = DIS.FLTSEQNUM(+)
				AND DMG.DOCOWRIDR
= DIS.DOCOWRIDR(+)
				AND DMG.MSTDOCNUM       = DIS.MSTDOCNUM(+)
				AND DMG.DUPNUM          = DIS.DUPNUM(+)

AND DMG.SEQNUM          = DIS.SEQNUM(+)
				AND DMG.ARPCOD          = DIS.ARPCOD(+)
				AND DMG.CMPCOD
= DIS.CMPCOD(+)
				AND DMG.DMGCOD          = DIS.DMGCOD(+)









AND DIS.DISSEQNUM = SRYDTL.DISSEQNUM(+)

AND DIS.DOCOWRIDR       = SRYDTL.DOCOWRIDR(+)
				AND DIS.MSTDOCNUM       = SRYDTL.MSTDOCNUM(+)
				AND
DIS.SEQNUM          = SRYDTL.SEQNUM(+)

AND DIS.DUPNUM       = SRYDTL.DUPNUM(+)
				AND DIS.CMPCOD
= SRYDTL.CMPCOD(+)
				AND BDNDTL.FLTCARIDR    = DMGREP.FLTCARIDR(+)
				AND BDNDTL.FLTNUM       = DMGREP.FLTNUM(+)

AND BDNDTL.FLTSEQNUM    = DMGREP.FLTSEQNUM(+)
				AND BDNDTL.LEGSERNUM    = DMGREP.LEGSERNUM(+)
				AND
BDNDTL.DOCOWRIDR    = DMGREP.DOCOWRIDR(+)
				AND BDNDTL.MSTDOCNUM    = DMGREP.MSTDOCNUM(+)
				AND BDNDTL.DUPNUM
= DMGREP.DUPNUM(+)
				AND BDNDTL.SEQNUM       = DMGREP.SEQNUM(+)
				AND BDNDTL.ARPCOD       = DMGREP.ARPCOD(+)

AND BDNDTL.CMPCOD       = DMGREP.CMPCOD(+)









AND SHPMST.DOCOWRIDR   = TXNHSE.DOCOWRIDR(+)

AND SHPMST.MSTDOCNUM    = TXNHSE.MSTDOCNUM(+)


AND SHPMST.DUPNUM      = TXNHSE.DUPNUM(+)
				AND SHPMST.SEQNUM
= TXNHSE.SEQNUM(+)
				AND SHPMST.CMPCOD       = TXNHSE.CMPCOD(+)


 AND SEGULD.CMPCOD = ULDBKG.CMPCOD
(+)

	   AND SEGULD.ULDBKGIDR = ULDBKG.ULDBKGIDR (+)
	   AND ARP.CMPCOD      = ARPULD.CMPCOD(+)

AND ARP.ARPCOD          = ARPULD.ARPCOD(+)
				AND ULDSHP.FLTCARIDR    = ?




AND ULDSHP.FLTNUM = ?

AND ULDSHP.FLTSEQNUM = ?
			   AND ULDSHP.CMPCOD = ?
				AND BDNDTL.ARPCOD(+)    = ?


			   AND FLTSEG.POU
= ?
	   		  AND ARP.ARPCOD(+) = ?
				AND DMG.ARPCOD(+) 		= ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>38</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findbreakdowndetailsForHHT" Type="NATIVE">
			<![CDATA[
						SELECT SHPMST.DOCOWRIDR,
			  SHPMST.MSTDOCNUM,
			  SHPMST.SEQNUM,
			  SHPMST.CMPCOD,
			  SHPMST.DUPNUM,
			  SHPMST.RDYCRGFLG,
NVL(ULDSHP.SEQNUM, SHPMST.SEQNUM) ULDSHPSEQNUM,
			  NVL(ULDSHP.FLTCARIDR, SEGULD.FLTCARIDR) FLTCARIDR,

NVL(ULDSHP.FLTNUM, SEGULD.FLTNUM) FLTNUM,
			  NVL(ULDSHP.FLTSEQNUM, SEGULD.FLTSEQNUM) FLTSEQNUM,

NVL(ULDSHP.SEGSERNUM, SEGULD.SEGSERNUM) SEGSERNUM,
			  NVL(ULDSHP.ULDNUM, SEGULD.ULDNUM) ULDNUM,

SEGULD.BDNCPLFLG,
			  FLTSEG.POU ARPCOD,
			  SHPMST.SHPPFX,
			  SHPMST.OWRCOD,
			  ULDSHP.RCVPCS,

ULDSHP.RCVWGT,
			  ULDSHP.RCVVOL,
			  ARPSHP.RCVPCS ARPRCVPCS,
			  ARPSHP.RCVWGT ARPRCVWGT,
			  (

CASE
	  WHEN SHPMST.SEQNUM = 1
				THEN ULDSHP.MFTPCS
				ELSE TXNHSE.PCS
	  END) MFTPCS,
			  (

CASE
	  WHEN SHPMST.SEQNUM = 1
				THEN ULDSHP.MFTWGT
				ELSE TXNHSE.WGT
	  END) MFTWGT,
			  ULDSHP.MFTVOL,

SHPMST.CONFLG,
			  SHPMST.DOCNUM,
			  SHPMST.DSTCOD,
			  SHPMST.GRSVOL,
SHPMST.ORGCOD,
			  SHPMST.SCCCOD,

SHPMST.SHPDES,
			  SHPMST.STDPCS,
			  SHPMST.STDWGT,
	       SHPMST.DOCNUM, SHPMST.DSTCOD,
SHPMST.GRSVOL,



		   DMG.DUPNUM DMGDUPNUM,
DMG.LEGSERNUM ,
		   DMG.CMPCOD DMGCMPCOD, DMG.DMGCOD DMGDMGCOD,
DMG.DMGPCS
DMGDMGPCS,SHPMST.PLTFLG,












SHPMST.CNSCOD,
			  DMG.MSTDOCNUM DMGMSTDOCNUM,
			  DMG.ULDNUM DMGULDNUM,
			  DMG.FLTNUM DMGFLTNUM,

DMG.FLTSEQNUM DMGFLTSEQNUM,
			  DMG.FLTCARIDR DMGFLTCARIDR,
			  DMG.DOCOWRIDR DMGDOCOWRIDR,
			  DMG.SEQNUM
DMGSEQNUM,
			  DMG.DUPNUM DMGDUPNUM,
			  DMG.LEGSERNUM DMGLEGSERNUM,
			  DMG.ARPCOD DMGARPCOD,

DMG.CMPCOD DMGCMPCOD,
			  DMG.DMGCOD DMGDMGCOD,
			  DMG.DMGPCS DMGDMGPCS,
			  SHPMST.PLTFLG,

DTL.PLTUSEFLG,
			  ARPSHP.PLTUSEFLG ARPSHPPLTUSEFLG,
		  ARPSHP.DCSREQFLG,
		  ARPSHP.CRSDCKFLG,

BDNDTL.RCVPCS BDNDTLRCVPCS,
		  BDNDTL.RCVWGT BDNDTLRCVWGT,
		  BDNDTL.RCVVOL BDNDTLRCVVOL,
		  BDNDTL.SCCCOD
BDNDTLSCCCOD,
		  BDNDTL.STUCOD BDNDTLSTUCOD,
		    (
			CASE
				WHEN( (SELECT COUNT(1)
				  FROM OPRSEGULDSHP
SEGULDSHP
				  WHERE SEGULDSHP.CMPCOD  = SEGULD.CMPCOD
				  AND SEGULDSHP.FLTCARIDR = SEGULD.FLTCARIDR

AND SEGULDSHP.FLTNUM    = SEGULD.FLTNUM
				  AND SEGULDSHP.FLTSEQNUM = SEGULD.FLTSEQNUM
				  AND SEGULDSHP.ULDNUM
= SEGULD.ULDNUM
				  AND SEGULDSHP.RCVPCS    > 0 ) > 0)
				THEN 'Y'
				ELSE 'N'
			  END) BDNSTRFLG

FROM OPRFLTSEG FLTSEG
			INNER JOIN OPRSEGULD SEGULD
			ON SEGULD.FLTCARIDR  = FLTSEG.FLTCARIDR
			AND
SEGULD.FLTNUM    = FLTSEG.FLTNUM
			AND SEGULD.FLTSEQNUM = FLTSEG.FLTSEQNUM
			AND SEGULD.CMPCOD    =
FLTSEG.CMPCOD
			AND SEGULD.SEGSERNUM = FLTSEG.SEGSERNUM
			AND SEGULD.ULDNUM    = ?
INNER JOIN OPRSEGULDSHP ULDSHP
ON ULDSHP.ULDNUM
= SEGULD.ULDNUM
AND ULDSHP.FLTCARIDR = SEGULD.FLTCARIDR
AND ULDSHP.FLTNUM    = SEGULD.FLTNUM
AND ULDSHP.FLTSEQNUM
= SEGULD.FLTSEQNUM
AND ULDSHP.SEGSERNUM = SEGULD.SEGSERNUM
AND ULDSHP.CMPCOD    = SEGULD.CMPCOD
AND (
ULDSHP.MFTPCS  > 0
OR ULDSHP.RCVPCS     > 0)
INNER JOIN OPRSHPMST SHPMST
ON SHPMST.CMPCOD = ULDSHP.CMPCOD
AND
SHPMST.DOCOWRIDR  = ULDSHP.DOCOWRIDR
AND SHPMST.MSTDOCNUM = ULDSHP.MSTDOCNUM
AND SHPMST.DUPNUM    = ULDSHP.DUPNUM
AND
SHPMST.SEQNUM    = ULDSHP.SEQNUM
			LEFT OUTER JOIN OPRSHPDTL DTL
			ON SHPMST.DOCOWRIDR  = DTL. DOCOWRIDR
			AND SHPMST.MSTDOCNUM
= DTL.MSTDOCNUM
			AND SHPMST.DUPNUM    = DTL.DUPNUM
			AND SHPMST.SEQNUM    = DTL.SEQNUM
			AND SHPMST.CMPCOD
= DTL.CMPCOD
			LEFT OUTER JOIN OPRARPSHP ARPSHP
			ON SHPMST.CMPCOD     = ARPSHP.CMPCOD
			AND SHPMST.DOCOWRIDR
= ARPSHP.DOCOWRIDR
			AND SHPMST.MSTDOCNUM = ARPSHP.MSTDOCNUM
			AND SHPMST.DUPNUM    = ARPSHP.DUPNUM

AND SHPMST.SEQNUM    = ARPSHP.SEQNUM
			AND ARPSHP.ARPCOD    = FLTSEG.POU
			LEFT OUTER JOIN OPRTXNHSE
TXNHSE
			ON SHPMST.DOCOWRIDR  = TXNHSE.DOCOWRIDR
			AND SHPMST.MSTDOCNUM = TXNHSE.MSTDOCNUM
			AND SHPMST.DUPNUM
= TXNHSE.DUPNUM
			AND SHPMST.SEQNUM    = TXNHSE.SEQNUM
			AND SHPMST.CMPCOD    = TXNHSE.CMPCOD
			AND
FLTSEG.FLTCARIDR = TXNHSE.TXNREFTWO
			AND FLTSEG.FLTNUM    = TXNHSE.TXNREFTHR
			AND FLTSEG.FLTSEQNUM
= TXNHSE.TXNREFFIV
			AND FLTSEG.POU       = TXNHSE.TXNREFSEV
AND
TXNHSE.TXNCOD    = 'MFT'
			LEFT OUTER JOIN OPRSHPBDNDTL BDNDTL
			ON ULDSHP.FLTCARIDR  = BDNDTL.FLTCARIDR
			AND ULDSHP.FLTNUM
= BDNDTL.FLTNUM
			AND ULDSHP.FLTSEQNUM = BDNDTL.FLTSEQNUM
			AND ULDSHP.ULDNUM    = BDNDTL.ULDNUM

AND ULDSHP.CMPCOD    = BDNDTL.CMPCOD
			AND ULDSHP.DOCOWRIDR = BDNDTL.DOCOWRIDR
			AND ULDSHP.MSTDOCNUM
= BDNDTL.MSTDOCNUM
			AND ULDSHP.DUPNUM    = BDNDTL.DUPNUM
			AND ULDSHP.SEQNUM    = BDNDTL.SEQNUM

AND FLTSEG.POU       = BDNDTL.ARPCOD
            AND NVL(BDNDTL.STUCOD,'~$~') = ?
			LEFT OUTER JOIN
OPRDMGDTL DMG
			ON BDNDTL.DOCOWRIDR    = DMG.DOCOWRIDR
			AND BDNDTL.MSTDOCNUM   = DMG.MSTDOCNUM

AND BDNDTL.DUPNUM      = DMG.DUPNUM
			AND BDNDTL.FLTCARIDR   = DMG.FLTCARIDR
			AND BDNDTL.FLTNUM
= DMG.FLTNUM
			AND BDNDTL.FLTSEQNUM   = DMG.FLTSEQNUM
			AND BDNDTL.ULDNUM      = DMG.ULDNUM
AND BDNDTL.CMPCOD      = DMG.CMPCOD
WHERE
FLTSEG.FLTCARIDR = ?
AND FLTSEG.FLTNUM      = ?
AND FLTSEG.FLTSEQNUM   = ?
AND FLTSEG.CMPCOD      = ?
			AND
FLTSEG.POU         = ?
AND ULDSHP.DOCOWRIDR = ?
AND ULDSHP.MSTDOCNUM = ?
AND ULDSHP.DUPNUM = ?
AND ULDSHP.SEQNUM = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>39</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.finddwsmasterdetails" Type="NATIVE">
			<![CDATA[
	SELECT MST.CMPCOD,MST.ARPCOD,MST.FLTCARIDR,MST.FLTNUM,MST.FLTSEQNUM,MST.LEGSERNUM,
	MST.PRTDAT,MST.ESTBLKWGT,MST.ESTULDWGT,MST.LSTUPDUSR,MST.LSTUPDTIM,
		MST.DWSRMK,EXPFLT.FLTOPRSTA,MST.ESTBLKVOL,DCSSTA, DCSREJRSN,
		EXPFLT.OPRREFCARCOD,EXPFLT.OPRREFFLTDATUTC,EXPFLT.OPRREFFLTNUM
		FROM
		OPRDWSMST MST,OPRARPEXPFLT EXPFLT
		WHERE
		MST.CMPCOD=EXPFLT.CMPCOD(+)  AND
		MST.ARPCOD=EXPFLT.ARPCOD(+)  AND
		MST.FLTCARIDR=EXPFLT.FLTCARIDR(+) AND
		MST.FLTNUM=EXPFLT.FLTNUM(+) AND
		MST.FLTSEQNUM=EXPFLT.FLTSEQNUM(+) AND
		MST.LEGSERNUM=EXPFLT.LEGSERNUM(+) AND
		MST.LEGSERNUM=?	AND
		MST.CMPCOD=? AND
		MST.ARPCOD=? AND
		MST.FLTCARIDR=? AND
		MST.FLTSEQNUM=? AND
		MST.FLTNUM=?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>41</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.finddwsbulkdetails" Type="NATIVE">
			<![CDATA[
	SELECT SHPMST.SCCCOD,
			  SEGULD.NETWGT,
			  SEGULD.GRSWGT,
	       SEGULD.CMPCOD SEGULDCMPCOD,

EXPFLT.LEGSERNUM,

	       FLTSEG.SEGORG,
	       SEGULD.FLTCARIDR SEGULDFLTCARIDR,
	       SEGULD.FLTNUM
SEGULDFLTNUM,


	       SEGULD.FLTSEQNUM SEGULDFLTSEQNUM,
			  SEGULD.ULDNUM,
			  FLTSEG.SEGDST,

SEGULD.ULDDST,
			  ULDSHP.MFTVOL,
			  ULDSHP.MFTWGT,
			  ULDSHP.BDPVOL,
			  ULDSHP.BDPWGT,
			  ULDTAG.ULDTAGPTRFLG,

ULDTAG.ULDTAGPTRUSR,
			  ULDTAG.ULDTAGPTRDAT,
			  ULDTAG.TAGRMK,
			  SEGULD.ACTWGT,
			  FLTSEG.SEGSERNUM,
			  SEGULD.LSTUPDUSR BLTUSR,
			  SEGULD.ULDBDPTIM BLTDAT,

(SELECT ULDWGTDTL.WGTTIM
			  FROM OPRULDWGTDTL ULDWGTDTL
			  WHERE EXPFLT.CMPCOD  = ULDWGTDTL.CMPCOD

AND EXPFLT.ARPCOD    = ULDWGTDTL.ARPCOD
			  AND SEGULD.ULDNUM    = ULDWGTDTL.ULDNUM
			  AND EXPFLT.FLTCARIDR
= ULDWGTDTL.FLTCARIDR
			  AND EXPFLT.FLTNUM    = ULDWGTDTL.FLTNUM
			  AND EXPFLT.FLTSEQNUM = ULDWGTDTL.FLTSEQNUM

AND EXPFLT.LEGSERNUM = ULDWGTDTL.LEGSERNUM
			  AND ULDWGTDTL.SERNUM =
				(SELECT MAX(SERNUM)
				FROM
OPRULDWGTDTL DTL
				WHERE DTL.CMPCOD     = EXPFLT.CMPCOD
				AND DTL.ARPCOD       = EXPFLT.ARPCOD

AND DTL.ULDNUM       = SEGULD.ULDNUM
				AND DTL.FLTCARIDR(+) = EXPFLT.FLTCARIDR
				AND DTL.FLTNUM(+)
= EXPFLT.FLTNUM
				AND DTL.FLTSEQNUM(+) = EXPFLT.FLTSEQNUM
				AND DTL.LEGSERNUM(+) = EXPFLT.LEGSERNUM

)
   ) WGTTIM,
   (SELECT ULDWGTDTL.SCLNAM
  FROM OPRULDWGTDTL ULDWGTDTL
  WHERE EXPFLT.CMPCOD  = ULDWGTDTL.CMPCOD
  AND EXPFLT.ARPCOD    = ULDWGTDTL.ARPCOD
  AND SEGULD.ULDNUM    = ULDWGTDTL.ULDNUM
  AND EXPFLT.FLTCARIDR = ULDWGTDTL.FLTCARIDR
  AND EXPFLT.FLTNUM    = ULDWGTDTL.FLTNUM
  AND EXPFLT.FLTSEQNUM = ULDWGTDTL.FLTSEQNUM
  AND EXPFLT.LEGSERNUM = ULDWGTDTL.LEGSERNUM
  AND ULDWGTDTL.SERNUM =
    (SELECT MAX(SERNUM)
    FROM OPRULDWGTDTL DTL
    WHERE DTL.CMPCOD     = EXPFLT.CMPCOD
    AND DTL.ARPCOD       = EXPFLT.ARPCOD
    AND DTL.ULDNUM       = SEGULD.ULDNUM
    AND DTL.FLTCARIDR(+) = EXPFLT.FLTCARIDR
    AND DTL.FLTNUM(+)    = EXPFLT.FLTNUM
    AND DTL.FLTSEQNUM(+) = EXPFLT.FLTSEQNUM
    AND DTL.LEGSERNUM(+) = EXPFLT.LEGSERNUM
    )
  ) SCLNAM,
   'C' LODCTG
	  FROM FLTOPRSEG FLTSEG,
			  OPRARPEXPFLT EXPFLT,
			  OPRSEGULD SEGULD,

OPRSEGULDSHP ULDSHP,
			  OPRSHPMST SHPMST,
			  OPRULDTAG ULDTAG
			WHERE FLTSEG.CMPCOD  = EXPFLT.CMPCOD

AND FLTSEG.FLTCARIDR = EXPFLT.FLTCARIDR
			AND FLTSEG.FLTNUM    = EXPFLT.FLTNUM
			AND FLTSEG.FLTSEQNUM
= EXPFLT.FLTSEQNUM
			AND FLTSEG.SEGORG    = EXPFLT.ARPCOD
			AND FLTSEG.CMPCOD    = SEGULD.CMPCOD(+)

AND FLTSEG.FLTCARIDR = SEGULD.FLTCARIDR(+)
			AND FLTSEG.FLTNUM    = SEGULD.FLTNUM(+)
			AND FLTSEG.FLTSEQNUM
= SEGULD.FLTSEQNUM(+)

	   AND FLTSEG.SEGSERNUM = SEGULD.SEGSERNUM(+)
			AND SEGULD.ULDNUM(+)    ='BULK'

AND FLTSEG.CMPCOD = ULDSHP.CMPCOD(+)

	   AND FLTSEG.FLTCARIDR = ULDSHP.FLTCARIDR(+)
			AND FLTSEG.FLTNUM
= ULDSHP.FLTNUM(+)

	   AND FLTSEG.FLTSEQNUM = ULDSHP.FLTSEQNUM(+)
	   AND FLTSEG.SEGSERNUM = ULDSHP.SEGSERNUM(+)

AND ULDSHP.CMPCOD    = SHPMST.CMPCOD(+)

	   AND ULDSHP.MSTDOCNUM = SHPMST.MSTDOCNUM(+)
			AND ULDSHP.SEQNUM
= SHPMST.SEQNUM(+)
			AND ULDSHP.DUPNUM    = SHPMST.DUPNUM(+)
			AND ULDSHP.DOCOWRIDR = SHPMST.DOCOWRIDR(+)

AND ULDSHP.ULDNUM(+) = 'BULK'
			AND FLTSEG.CMPCOD    = ULDTAG.CMPCOD(+)
			AND FLTSEG.FLTCARIDR = ULDTAG.FLTCARIDR(+)

AND FLTSEG.FLTNUM    = ULDTAG.FLTNUM(+)
			AND FLTSEG.FLTSEQNUM = ULDTAG.FLTSEQNUM(+)
			AND FLTSEG.SEGSERNUM
= ULDTAG.SEGSERNUM(+)
			AND ULDTAG.ULDNUM(+) ='BULK'
			AND FLTSEG.CMPCOD    = ?
			AND FLTSEG.FLTCARIDR
= ?
			AND FLTSEG.FLTNUM    = ?
			AND FLTSEG.FLTSEQNUM = ?
		AND FLTSEG.SEGORG = ?
		UNION ALL
 SELECT
NULL     AS SCCCOD,
  MTKULD.BAGWGT AS NETWGT,
  MTKULD.BAGWGT AS GRSWGT,
  MTKULD.CMPCOD SEGULDCMPCOD,

MTKFLT.LEGSERNUM,
  OPRSEG.SEGORG,
  MTKFLT.FLTCARIDR SEGULDFLTCARIDR,
  MTKFLT.FLTNUM SEGULDFLTNUM,

MTKFLT.FLTSEQNUM SEGULDFLTSEQNUM,
  'BULK' ULDNUM,
  OPRSEG.SEGDST,
  NULL AS ULDDST,
  0    AS MFTVOL,

MTKULD.BAGWGT MFTWGT,
  0             AS BDPVOL,
  MTKULD.BAGWGT AS BDPWGT,
  NULL AS ULDTAGPTRFLG,

NULL AS ULDTAGPTRUSR,
  NULL AS ULDTAGPTRDAT,
  NULL AS TAGRMK,
  0 AS ACTWGT,
  0 AS SEGSERNUM,
  NULL AS BLTUSR,
  NULL AS BLTDAT,
  NULL          AS WGTTIM,
  NULL          AS SCLNAM,
   'M' LODCTG
FROM MALFLTSEG FLTSEG,
  MALULDSEG MTKULD,
  MALFLT MTKFLT,
  FLTOPRSEG
OPRSEG
WHERE FLTSEG.CMPCOD  = MTKULD.CMPCOD
AND FLTSEG.FLTCARIDR = MTKULD.FLTCARIDR
AND FLTSEG.FLTNUM
= MTKULD.FLTNUM
AND FLTSEG.FLTSEQNUM = MTKULD.FLTSEQNUM
AND FLTSEG.SEGSERNUM = MTKULD.SEGSERNUM
AND FLTSEG.CMPCOD
= MTKFLT.CMPCOD
AND FLTSEG.FLTCARIDR = MTKFLT.FLTCARIDR
AND FLTSEG.FLTNUM    = MTKFLT.FLTNUM
AND FLTSEG.FLTSEQNUM
= MTKFLT.FLTSEQNUM
AND FLTSEG.POL       = MTKFLT.ARPCOD
AND OPRSEG.CMPCOD    = MTKFLT.CMPCOD
AND OPRSEG.FLTCARIDR
= MTKFLT.FLTCARIDR
AND OPRSEG.FLTNUM    = MTKFLT.FLTNUM
AND OPRSEG.FLTSEQNUM = MTKFLT.FLTSEQNUM
AND OPRSEG.SEGORG
= MTKFLT.ARPCOD
AND OPRSEG.CMPCOD    = MTKULD.CMPCOD
AND OPRSEG.FLTCARIDR = MTKULD.FLTCARIDR
AND OPRSEG.FLTNUM
= MTKULD.FLTNUM
AND OPRSEG.FLTSEQNUM = MTKULD.FLTSEQNUM
AND OPRSEG.SEGSERNUM = MTKULD.SEGSERNUM
AND
MTKULD.ULDNUM  LIKE 'BULK%'
AND FLTSEG.CMPCOD    = ?
AND FLTSEG.FLTCARIDR = ?
AND FLTSEG.FLTNUM    =
?
AND FLTSEG.FLTSEQNUM = ?
AND FLTSEG.POL       = ?
AND NOT EXISTS
  (SELECT 1
  FROM OPRDWSULD DWSULD

WHERE MTKULD.CMPCOD  = DWSULD.CMPCOD
  AND MTKULD.FLTCARIDR = DWSULD.FLTCARIDR
  AND MTKULD.FLTNUM
= DWSULD.FLTNUM
  AND MTKULD.FLTSEQNUM = DWSULD.FLTSEQNUM
  AND FLTSEG.POL       = DWSULD.ARPCOD
  AND
MTKULD.ULDNUM    = DWSULD.ULDNUM
  )
  ORDER BY SEGSERNUM
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>42</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.finduldforflight" Type="NATIVE">
			<![CDATA[
	SELECT SEGULD.CMPCOD,SEGULD.FLTCARIDR,SEGULD.FLTNUM,SEGULD.FLTSEQNUM,SEGULD.SEGSERNUM,SEGULD.ULDNUM,SEGULD.ULDSTA,SEGULD.ULDCTR,
	ARPEXPFLT.FLTCARCOD,ARPEXPFLT.FLTDAT
	FROM OPRSEGULD SEGULD,OPRARPEXPFLT ARPEXPFLT
	WHERE
	SEGULD.CMPCOD=ARPEXPFLT.CMPCOD AND
	SEGULD.FLTCARIDR=ARPEXPFLT.FLTCARIDR AND
	SEGULD.FLTNUM=ARPEXPFLT.FLTNUM AND
	SEGULD.FLTSEQNUM=ARPEXPFLT.FLTSEQNUM AND
	(SEGULD.ULDSTA IS NULL OR SEGULD.ULDSTA = ? )AND
	SEGULD.ULDNUM=? AND
	SEGULD.CMPCOD=?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>43</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findulddetails" Type="NATIVE">
			<![CDATA[
	SELECT SEGULD.CMPCOD,SEGULD.FLTCARIDR,SEGULD.FLTNUM,SEGULD.FLTSEQNUM,SEGULD.SEGSERNUM,
	       SEGULD.ULDNUM,SEGULD.GRSWGT,SEGULD.NETWGT,SEGULD.THRUNT,SEGULD.ULDCTR,SEGULD.ULDCTS,SEGULD.ULDSTA,


	       SEGULD.TARWGT,SEGULD.ACTWGT,FLTSEG.POL
	FROM OPRSEGULD SEGULD,OPRFLTSEG FLTSEG
	WHERE
		SEGULD.CMPCOD=FLTSEG.CMPCOD

AND
		SEGULD.FLTCARIDR=FLTSEG.FLTCARIDR AND
		SEGULD.FLTNUM=FLTSEG.FLTNUM AND
		SEGULD.FLTSEQNUM=FLTSEG.FLTSEQNUM

AND
		SEGULD.SEGSERNUM=FLTSEG.SEGSERNUM AND
		SEGULD.CMPCOD=? AND
 		SEGULD.FLTCARIDR=? AND
		SEGULD.FLTNUM=?

AND
		SEGULD.FLTSEQNUM=? AND
		SEGULD.ULDNUM=? AND
		FLTSEG.POL=?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>44</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findlyinglistshipmentdetails" Type="NATIVE">
			<![CDATA[
	SELECT DENSE_RANK() OVER (ORDER BY SHPMST.CMPCOD,SHPMST.MSTDOCNUM,SHPMST.DUPNUM,SHPMST.SEQNUM,SHPMST.DOCOWRIDR)


RANK,
    FLTDTL.SERNUM,
	FLTDTL.FLTCARCOD,
    FLTDTL.FLTNUM,
    FLTDTL.SEQNUM BKDFLTSEQ,
    SHPMST.CMPCOD,



    SHPMST.SHPPFX,
    SHPMST.MSTDOCNUM,
    SHPMST.DOCOWRIDR,
    FLTDTL.FLTORG,
    FLTDTL.FLTDAT,



    FLTDTL.FLTDST,
    FLTDTL.NUMPCS,
	FLTDTL.WGT,
    FLTDTL.VOL,
    SHPMST.DUPNUM,
    SHPMST.SEQNUM,



    SHPMST.STDPCS,
    SHPMST.STDWGT,
    SHPMST.GRSVOL,
    SHPMST.SCCCOD,
    SHPMST.EXEDAT,

SHPMST.SHPDES,
    SHPMST.EXEFLG,
	SHPDTL.APRFLG,

    SHPMST.ORGCOD,
    SHPMST.DSTCOD,
	SHPMST.RDYCRGFLG,
    ARP.ACPDAT,
    ARP.ARPCOD,
    ARP.AVLPCS,

ARP.AVLWGT,

	ARP.AVLVOL,
	(SELECT COUNT(*) FROM
        OPRSHPBLK SHPBLK
       WHERE SHPBLK.CMPCOD
= SHPMST.CMPCOD

      AND SHPBLK.DOCOWRIDR = SHPMST.DOCOWRIDR
      AND SHPBLK.MSTDOCNUM = SHPMST.MSTDOCNUM

AND SHPBLK.DUPNUM
= SHPMST.DUPNUM
      AND SHPBLK.SEQNUM    = SHPMST.SEQNUM
      AND SHPBLK.BLKSTA='B')
AS BLKCNT,


	(SELECT FLDDES
    FROM SHRONETIM SHRONE
    WHERE SHRONE.CMPCOD= ?
    AND SHRONE.FLDTYP
='shared.defaults.volumeUnitCodes'


     AND SHRONE.FLDVAL  = COALESCE(FLTDTL.FRSDISVOLUNT,FLTDTL.DISVOLUNT,BKGDTL.DISVOLUNT)
    )AS DISVOLUNT,

(SELECT FLDDES
    FROM SHRONETIM SHRONE


    WHERE SHRONE.CMPCOD= ?
    AND SHRONE.FLDTYP  ='shared.defaults.weightUnitCodes'
    AND SHRONE.FLDVAL = COALESCE(FLTDTL.FRSDISWGTUNT,FLTDTL.DISWGTUNT,BKGDTL.DISWGTUNT)

    )AS DISWGTUNT,
    (SELECT FLDDES
    FROM
    SHRONETIM
SHRONE
    WHERE SHRONE.CMPCOD=?


    AND SHRONE.FLDTYP='capacity.booking.status'
    AND SHRONE.FLDVAL=FLTDTL.FLTBKGSTA

)AS FLTBKGSTA,


    (SELECT RTRIM(XMLAGG(XMLELEMENT(A, DSTCOD
      ||'-') ORDER BY RTGSERNUM).EXTRACT('//text()'),
'-') DSTCOD

           FROM
OPRSHPRTG SHPRTG
           WHERE SHPRTG.CMPCOD = SHPMST.CMPCOD

           AND SHPRTG.DOCOWRIDR
= SHPMST.DOCOWRIDR

           AND SHPRTG.MSTDOCNUM = SHPMST.MSTDOCNUM

           AND SHPRTG.DUPNUM
= SHPMST.DUPNUM

           AND SHPRTG.SEQNUM = SHPMST.SEQNUM

			)AS RTGDSTCOD,

	       (SELECT   SUM (OFLPCS)
    FROM OPRSEGSHP
SEGSHP,
      OPRFLTSEG
FLTSEG
	           WHERE SEGSHP.CMPCOD
= SHPMST.CMPCOD
	             AND SEGSHP.DOCOWRIDR
= SHPMST.DOCOWRIDR

AND SEGSHP.MSTDOCNUM
= SHPMST.MSTDOCNUM
	             AND SEGSHP.DUPNUM
= SHPMST.DUPNUM

AND SEGSHP.SEQNUM =
SHPMST.SEQNUM
	             AND SEGSHP.CMPCOD = FLTSEG.CMPCOD

AND
SEGSHP.FLTNUM = FLTSEG.FLTNUM

AND SEGSHP.FLTSEQNUM = FLTSEG.FLTSEQNUM

AND
SEGSHP.FLTCARIDR = FLTSEG.FLTCARIDR

AND SEGSHP.SEGSERNUM = FLTSEG.SEGSERNUM


	             AND FLTSEG.POL = ?
	        GROUP
BY SEGSHP.CMPCOD,
	                 SEGSHP.DOCOWRIDR,


	                 SEGSHP.MSTDOCNUM,

	                 SEGSHP.DUPNUM,
      SEGSHP.SEQNUM

    ) AS OFLPCS,
      (SELECT SUM (NUMPCS)
      FROM OPRULDSHP ULDSHP
      WHERE ULDSHP.CMPCOD  = SHPMST.CMPCOD
      AND ULDSHP.DOCOWRIDR = SHPMST.DOCOWRIDR
      AND ULDSHP.MSTDOCNUM = SHPMST.MSTDOCNUM
      AND ULDSHP.DUPNUM    = SHPMST.DUPNUM
      AND ULDSHP.SEQNUM    = SHPMST.SEQNUM
	  AND ULDSHP.CMPCOD  = ARP.CMPCOD
      AND ULDSHP.DOCOWRIDR = ARP.DOCOWRIDR
      AND ULDSHP.MSTDOCNUM = ARP.MSTDOCNUM
      AND ULDSHP.DUPNUM    = ARP.DUPNUM
      AND ULDSHP.SEQNUM    = ARP.SEQNUM
      AND ULDSHP.ARPCOD = ARP.ARPCOD
      ) AS ULDPCS,
      (SELECT SUM (WGT)
      FROM OPRULDSHP ULDSHP
      WHERE ULDSHP.CMPCOD  = SHPMST.CMPCOD
      AND ULDSHP.DOCOWRIDR = SHPMST.DOCOWRIDR
      AND ULDSHP.MSTDOCNUM = SHPMST.MSTDOCNUM
      AND ULDSHP.DUPNUM    = SHPMST.DUPNUM
      AND ULDSHP.SEQNUM    = SHPMST.SEQNUM
	  AND ULDSHP.CMPCOD  = ARP.CMPCOD
      AND ULDSHP.DOCOWRIDR = ARP.DOCOWRIDR
      AND ULDSHP.MSTDOCNUM = ARP.MSTDOCNUM
      AND ULDSHP.DUPNUM    = ARP.DUPNUM
      AND ULDSHP.SEQNUM    = ARP.SEQNUM
      AND ULDSHP.ARPCOD = ARP.ARPCOD
      ) AS ULDWGT,
	  ARLMST.ISSPRTARL,ARLMST.OWNARLIND,ARP.PLTUSEFLG PLTFLG,SHPDTL.PLTUSEFLG DTLPLTFLG,SHPMST.PLTFLG MSTPLTFLG
	  FROM OPRSHPMST 
SHPMST,
	       OPRSHPDTL SHPDTL,
	       
	       OPRARPSHP ARP,
    CAPBKGFLTDTL FLTDTL, CAPBKGDTL BKGDTL,
	SHRARLMST ARLMST
	 WHERE SHPMST.CMPCOD = SHPDTL.CMPCOD
	   AND SHPMST.DOCOWRIDR
= SHPDTL.DOCOWRIDR


	   AND SHPMST.MSTDOCNUM = SHPDTL.MSTDOCNUM
	   AND SHPMST.DUPNUM = SHPDTL.DUPNUM

	   AND SHPMST.SEQNUM

= SHPDTL.SEQNUM
	   AND SHPMST.CMPCOD = ARP.CMPCOD
	   AND SHPMST.DOCOWRIDR = ARP.DOCOWRIDR


AND
SHPMST.MSTDOCNUM = ARP.MSTDOCNUM
	   AND SHPMST.DUPNUM = ARP.DUPNUM
	   AND SHPMST.SEQNUM = ARP.SEQNUM

AND SHPMST.DSTCOD <> ARP.ARPCOD
	   AND CASE WHEN ARP.AVLPCS > 0 THEN 10 ELSE 100 END = 10
	   AND SHPMST.CMPCOD
= FLTDTL.CMPCOD(+)
	   AND SHPMST.DOCOWRIDR = FLTDTL.DOCOWRIDR(+)


	   AND SHPMST.MSTDOCNUM = FLTDTL.MSTDOCNUM(+)

AND SHPMST.DUPNUM = FLTDTL.DUPNUM(+)
	   AND SHPMST.SEQNUM

= FLTDTL.SEQNUM(+)
	   AND SHPMST.UBRNUM
= FLTDTL.UBRNUM(+)
  AND
FLTDTL.FLTBKGSTA(+) NOT IN ('R','X')
   AND SHPMST.UBRNUM = BKGDTL.UBRNUM(+)
   AND SHPMST.CMPCOD            = ARLMST.CMPCOD(+)
   AND SHPMST.DOCOWRIDR         = ARLMST.ARLIDR(+)
   AND SHPMST.CMPCOD = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>45</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findlyinglistulddetails" Type="NATIVE">
			<![CDATA[
			SELECT  DENSE_RANK ( ) OVER ( ORDER BY ULD.ULDNUM , ULD.ARPCOD , ULD.CMPCOD ) RANK , FLTDTL.sernum
, FLTDTL.FLTCARCOD , FLTDTL.FLTORG , FLTDTL.FLTNUM
		, FLTDTL.FLTDAT , FLTDTL.SEQNUM BKDFLTSEQ , arp.arpcod
, arp.pou , arp.uldctr , arp.ULDBKGIDR,arp.ALTIDR, arp.BUPFLG,  arp.BKGTYP, arp.BRWFLG, uld.cmpcod ,
uld.uldnum , uld.numpcs , uld.wgt , uld.vol ,
		shpmst.shppfx , shpmst.mstdocnum , shpmst.docowridr ,
shpmst.dupnum , shpmst.seqnum , shpmst.stdpcs , shpmst.stdwgt , shpmst.grsvol , shpmst.scccod
		, shpmst.exedat
, shpmst.shpdes , shpmst.orgcod , shpmst.dstcod , shpdtl.acpdat ,( SELECT RTRIM(XMLAGG(XMLELEMENT(A,
DSTCOD||'-')).EXTRACT('//text()'),

'-') DSTCOD
FROM OPRSHPRTG SHPRTG
			WHERE SHPRTG.CMPCOD =
SHPMST.CMPCOD
				AND SHPRTG.DOCOWRIDR = SHPMST.DOCOWRIDR
				AND SHPRTG.MSTDOCNUM = SHPMST.MSTDOCNUM

AND SHPRTG.DUPNUM = SHPMST.DUPNUM
				AND SHPRTG.SEQNUM = SHPMST.SEQNUM
		) AS RTGDSTCOD , ULDMST.ULDBKGIDR
ULDIDR, ULDMST.BKGTYP ULDBKGTYP, ONETIM.FLDDES RPLSTA , HNDULD.ULDNUM LNKULD,ARPSHP.PLTUSEFLG PLTFLG,shpmst.PLTFLG MSTPLTFLG,
shpdtl.PLTUSEFLG DTLPLTFLG
	FROM opruldshp uld , OPRSHPMST
shpmst , oprshpdtl shpdtl , oprarpuld arp , CAPBKGFLTDTL FLTDTL , CAPBKGFLTDTL FLTFLT , CAPULDBKGMST
ULDMST ,
		CAPULDBKGHNDDTL HNDULD,SHRONETIM ONETIM,OPRARPSHP ARPSHP
	   WHERE arp.cmpcod = uld.cmpcod
	     AND arp.arpcod
= uld.arpcod

		AND arp.uldnum = uld.uldnum
		AND uld.cmpcod = ARPSHP.cmpcod
	     AND uld.docowridr = ARPSHP.docowridr
	     AND uld.mstdocnum = ARPSHP.mstdocnum
	     AND uld.dupnum = ARPSHP.dupnum
	     AND uld.seqnum = ARPSHP.seqnum
		 AND uld.arpcod = ARPSHP.arpcod
		 AND ARPSHP.cmpcod = shpmst.cmpcod
	     AND ARPSHP.docowridr = shpmst.docowridr
		 AND ARPSHP.mstdocnum = shpmst.mstdocnum
	     AND ARPSHP.dupnum = shpmst.dupnum
	     AND ARPSHP.seqnum = shpmst.seqnum
		 
	     AND shpmst.cmpcod = shpdtl.cmpcod
	     AND shpmst.docowridr = shpdtl.docowridr

AND shpmst.mstdocnum = shpdtl.mstdocnum
	     AND shpmst.dupnum = shpdtl.dupnum
	     AND shpmst.seqnum
= shpdtl.seqnum
		AND SHPMST.CMPCOD = FLTDTL.CMPCOD(+)
		AND SHPMST.DOCOWRIDR = FLTDTL.DOCOWRIDR(+)

AND SHPMST.MSTDOCNUM = FLTDTL.MSTDOCNUM(+)
		AND SHPMST.DUPNUM = FLTDTL.DUPNUM(+)
		AND SHPMST.SEQNUM
= FLTDTL.SEQNUM(+)
		AND SHPMST.UBRNUM = FLTDTL.UBRNUM(+)
		AND FLTDTL.CMPCOD = FLTFLT.CMPCOD(+)
		AND
FLTDTL.DOCOWRIDR = FLTFLT.DOCOWRIDR(+)
		AND FLTDTL.SEQNUM = FLTFLT.SEQNUM(+)
		AND FLTDTL.UBRNUM = FLTFLT.UBRNUM(+)

AND FLTDTL.FLTBKGSTA(+) NOT IN ( 'R' , 'X' )
		AND arp.CMPCOD = ULDMST.CMPCOD (+)
		AND arp.ULDBKGIDR
= ULDMST.ULDBKGIDR (+)
		AND ULDMST.CMPCOD = HNDULD.CMPCOD (+)
		AND ULDMST.ULDBKGIDR = HNDULD.ULDBKGIDR
(+)
		AND ONETIM.CMPCOD(+) = ULDMST.CMPCOD
		AND ONETIM.FLDVAL(+) = ULDMST.RPLSTA
		AND ONETIM.FLDTYP(+)
= 'capacity.booking.uldreplanstatus'
		AND FLTDTL.FLTORG(+) = ?
	     AND shpmst.cmpcod = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>46</QRY:Id>
		<QRY:Source Name="operaions.flthandling.cto.findflightlistingdetails" Type="NATIVE">
			<![CDATA[
	  SELECT LEG.FLTCARIDR,  (CASE ARL.APHCODUSE
					           WHEN 2
					              THEN ARL.TWOAPHCOD


					           ELSE ARL.THRAPHCOD
					     END) FLTCARCOD, MST.FLTNUM, MST.FLTDAT, MST.FLTSEQNUM,MST.FLTSTA,
LEG.LEGSERNUM,

IMP.CLSFLG, LEG.LEGSTA, LEG.ATA, LEG.ETA, LEG.STA,
	 	       IMP.MFTSRC, IMP.FLGFLG,
HIS.TXNCOD, ULD.ULDNUM,

ULD.MFTFLG, ULD.RCVFLG,
	 	       MST.FLTROU, MST.CMPCOD
	 	  FROM OPRARPIMPFLT
IMP,
	 	       OPRIMPFLTHIS

HIS,
	 	       OPRSEGULD ULD,
	 	       FLTOPRLEG LEG,
	 	       FLTOPRMST
MST,
			   SHRARLMST ARL

	 	 WHERE LEG.FLTCARIDR
= IMP.FLTCARIDR(+)
	 	   AND LEG.FLTSEQNUM = IMP.FLTSEQNUM(+)

AND LEG.LEGSERNUM
= IMP.LEGSERNUM(+)

	 	   AND LEG.FLTNUM = IMP.FLTNUM(+)
	 	   AND LEG.CMPCOD
= IMP.CMPCOD(+)

	 	   AND IMP.FLTCARIDR = HIS.FLTCARIDR(+)

	 	   AND IMP.FLTSEQNUM = HIS.FLTSEQNUM(+)

AND IMP.LEGSERNUM
= HIS.LEGSERNUM(+)
	 	   AND IMP.FLTNUM
= HIS.FLTNUM(+)
	 	   AND LEG.FLTCARIDR = ULD.FLTCARIDR(+)
	 	   
	 	   AND LEG.FLTSEQNUM = ULD.FLTSEQNUM(+)
	 	   
	 	   AND LEG.FLTNUM = ULD.FLTNUM(+)
AND LEG.FLTCARIDR
= MST.FLTCARIDR
	 	   AND LEG.FLTSEQNUM = MST.FLTSEQNUM

	 	   AND LEG.CMPCOD
= MST.CMPCOD

	           AND LEG.FLTNUM = MST.FLTNUM
			AND MST.CMPCOD = ARL.CMPCOD
			AND
MST.FLTCARIDR	=ARL.ARLIDR
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>47</QRY:Id>
		<QRY:Source Name="operations.flthandling.findShipmentDtlsforBreakDown" Type="NATIVE">
			<![CDATA[
	SELECT ULD.MFTPCS,ULD.MFTWGT, ULD.RCVPCS, ULD.RCVWGT,
	       MST.SCCCOD, MST.SHPDES, MST.STDPCS, MST.STDWGT,



	       MST.ORGCOD, MST.DSTCOD,MST.PLTFLG,
		  DTL.PLTUSEFLG,
		  ARP.PLTUSEFLG ARPPLTFLG, ULD.SHPBDNITN,ULD.FLTCARIDR 
	  FROM OPRSEGULDSHP ULD, OPRSHPMST MST,
		OPRSHPDTL DTL,
		OPRARPSHP ARP
	 WHERE MST.CMPCOD = ULD.CMPCOD(+)



 		AND MST.MSTDOCNUM =  ULD.MSTDOCNUM(+)
 		AND MST.DOCOWRIDR =  ULD.DOCOWRIDR(+)
 		AND MST.DUPNUM

=  ULD.DUPNUM(+)
		AND MST.CMPCOD   = DTL.CMPCOD(+)
		AND MST.DOCOWRIDR   = DTL.DOCOWRIDR(+)
		AND MST.MSTDOCNUM   =DTL.MSTDOCNUM(+)
		AND MST.DUPNUM      =DTL.DUPNUM(+)
		AND MST.SEQNUM      =DTL.SEQNUM(+)
		AND MST.CMPCOD   = ARP.CMPCOD(+)
		AND MST.DOCOWRIDR   = ARP.DOCOWRIDR(+)
		AND MST.MSTDOCNUM   =ARP.MSTDOCNUM(+)
		AND MST.DUPNUM      =ARP.DUPNUM(+)
		AND MST.SEQNUM      =ARP.SEQNUM(+)
		AND ARP.ARPCOD(+)=?

	    AND MST.DOCOWRIDR = ?
	    AND MST.MSTDOCNUM=?


	    AND MST.DUPNUM=?

	    AND MST.SEQNUM=?
	    AND ULD.FLTCARIDR(+)=?
	    AND ULD.FLTNUM(+)=?


	    AND ULD.ULDNUM(+)=?
	    AND
ULD.CMPCOD(+)=?
	    AND ULD.FLTSEQNUM(+)=?
	    AND ULD.SEGSERNUM(+)=?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>48</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findflightdetailsforbreakdown" Type="NATIVE">
			<![CDATA[
	SELECT IMPFLT.CMPCOD, IMPFLT.FLTCARIDR, IMPFLT.FLTNUM, IMPFLT.FLTSEQNUM,
	       IMPFLT.LEGSERNUM, IMPFLT.CLSFLG,


IMPFLT.NILFLG, IMPFLT.FLTDAT,
	       IMPFLT.ARPCOD, IMPHIS.TXNCOD,IMPFLT.FLTCARCOD,IMPFLT.FLTOPRSTA



	  FROM OPRARPIMPFLT IMPFLT, OPRIMPFLTHIS IMPHIS
	 WHERE IMPFLT.CMPCOD = IMPHIS.CMPCOD(+)
	   AND IMPFLT.FLTCARIDR


= IMPHIS.FLTCARIDR(+)
	   AND IMPFLT.FLTNUM = IMPHIS.FLTNUM(+)
	   AND IMPFLT.FLTSEQNUM = IMPHIS.FLTSEQNUM(+)



AND IMPFLT.ARPCOD = IMPHIS.ARPCOD(+)
	   AND IMPFLT.LEGSERNUM = IMPHIS.LEGSERNUM(+)
	   AND IMPFLT.FLTCARIDR


= ?
	   AND IMPFLT.FLTNUM = ?
	   AND IMPFLT.FLTSEQNUM = ?
	   AND IMPFLT.LEGSERNUM = ?
	   AND IMPFLT.CMPCOD = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>49</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.offloadenquirydetails" Type="NATIVE">
			<![CDATA[
	SELECT
	  	DTL.MSTDOCNUM,DTL.ULDNUM,DTL.FLTNUM,FLT.FLTDAT,DTL.ASGFLTNUM,
	  	DTL.ASGFLTDAT,DTL.ASGCARCOD,FLT.FLTCARCOD,MST.SHPPFX,DTL.SEQNUM,



	  	DTL.DUPNUM,DTL.DOCOWRIDR,DTL.OFLDAT,DTL.OFLPCS,DTL.OFLTYP,
	  	DTL.OFLRSN,DTL.OFLWGT,DTL.RMK,SEG.POU,DTL.OFLUSR ,MST.SCCCOD, MST.SHPDES, MST.DSTCOD



	FROM OPROFLDTL DTL,OPRARPEXPFLT FLT,OPRSHPMST MST,OPRFLTSEG SEG
	WHERE
		DTL.MSTDOCNUM=MST.MSTDOCNUM(+)


and
		DTL.DOCOWRIDR=MST.DOCOWRIDR(+) and
		DTL.DUPNUM=MST.DUPNUM(+) and
		DTL.SEQNUM=MST.SEQNUM(+)
and


		DTL.CMPCOD=MST.CMPCOD(+) and
		DTL.CMPCOD=FLT.CMPCOD AND
		DTL.FLTNUM=FLT.FLTNUM AND
		DTL.FLTCARIDR=FLT.FLTCARIDR


AND
		DTL.FLTSEQNUM=FLT.FLTSEQNUM AND
		DTL.FLTNUM=SEG.FLTNUM AND
        DTL.FLTCARIDR=SEG.FLTCARIDR


AND
        DTL.FLTSEQNUM=SEG.FLTSEQNUM AND
        DTL.SEGSERNUM=SEG.SEGSERNUM AND
		DTL.CMPCOD=?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>50</QRY:Id>
		<QRY:Source Name="operations.manifest.findmanifestdetailsforbooking" Type="NATIVE">
			<![CDATA[
	SELECT
		SEGSHP.FLTCARIDR , SEGSHP.CMPCOD , SEGSHP.FLTNUM ,SEGSHP.FLTSEQNUM, SEGSHP.SEGSERNUM, SEGSHP.DOCOWRIDR,



		SEGSHP.MSTDOCNUM, SEGSHP.DUPNUM, SEGSHP.SEQNUM,

		SEGSHP.MFTVOL SEGMFTVOL, SEGSHP.MFTWGT SEGMFTWGT,SEGSHP.MFTPCS


SEGMFTPCS

		FROM OPRSEGSHP SEGSHP,OPRFLTSEG FLTSEG
		WHERE

		SEGSHP.FLTCARIDR=FLTSEG.FLTCARIDR(+)

AND

		SEGSHP.FLTNUM=FLTSEG.FLTNUM(+) AND
		SEGSHP.FLTSEQNUM=FLTSEG.FLTSEQNUM(+) AND

		SEGSHP.SEGSERNUM=FLTSEG.SEGSERNUM(+)


AND

		(( SEGSHP.FLTNUM, SEGSHP.FLTSEQNUM, SEGSHP.FLTCARIDR, SEGSHP.DOCOWRIDR, SEGSHP.MSTDOCNUM,SEGSHP.DUPNUM,



		SEGSHP.SEQNUM, SEGSHP.CMPCOD ) IN

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>407</QRY:Id>
		<QRY:Source Name="operations.manifest.findairmanifestdetailsforprint" Type="NATIVE">
			<![CDATA[
SELECT IMPFLT.NAT,
  FLTMST.FLTNUM,
  FLTMST.FLTDAT,
  FLTMST.FLTROU,
  FLTMST.FLTDST,
  FLTMST.FLTOWN,

SHPMST.SCCCOD,
  SHPMST.ORGCOD,
  SHPMST.DSTCOD,
  SHPMST.SHPPFX,
  SHPMST.MSTDOCNUM,
  SHPMST.DOCOWRIDR,

SHPMST.SEQNUM,
  SHPMST.SHPDES,
  SHPMST.DUPNUM,
  SHPMST.CNSNAM,
  SHPMST.SHPNAM,
  SEGSHP.MFTPCS,

SEGSHP.MFTWGT,
  SEGSHP.RCVPCS,
  SEGSHP.RCVWGT,
  FLTSEG.POU,
  FLTSEG.POL,
  ( SELECT ATA
					FROM
FLTOPRLEG FLTLEG
					WHERE FLTSEG.CMPCOD  = FLTLEG.CMPCOD
					AND FLTSEG.FLTCARIDR = FLTLEG.FLTCARIDR

AND FLTSEG.FLTNUM    = FLTLEG.FLTNUM
					AND FLTSEG.FLTSEQNUM = FLTLEG.FLTSEQNUM
					AND FLTLEG.LEGORG
= ?
				  ) ATA, MST.NATNTY
FROM OPRARPIMPFLT IMPFLT
JOIN OPRFLTSEG FLTSEG
ON IMPFLT.FLTCARIDR  = FLTSEG.FLTCARIDR
AND
IMPFLT.FLTNUM    = FLTSEG.FLTNUM
AND IMPFLT.FLTSEQNUM = FLTSEG.FLTSEQNUM
AND IMPFLT.CMPCOD    = FLTSEG.CMPCOD
JOIN
OPRSEGSHP SEGSHP
ON  IMPFLT.FLTCARIDR  = SEGSHP.FLTCARIDR
AND IMPFLT.FLTNUM     = SEGSHP.FLTNUM
AND IMPFLT.FLTSEQNUM
= SEGSHP.FLTSEQNUM
AND IMPFLT.CMPCOD     = SEGSHP.CMPCOD
AND SEGSHP.RCVPCS >0
JOIN FLTOPRMST FLTMST
ON
IMPFLT.FLTCARIDR  = FLTMST.FLTCARIDR
AND IMPFLT.FLTNUM    = FLTMST.FLTNUM
AND IMPFLT.FLTSEQNUM = FLTMST.FLTSEQNUM
AND
IMPFLT.CMPCOD    = FLTMST.CMPCOD
JOIN OPRSHPMST SHPMST
ON SEGSHP.DOCOWRIDR  = SHPMST.DOCOWRIDR
AND SEGSHP.MSTDOCNUM
= SHPMST.MSTDOCNUM
AND SEGSHP.DUPNUM    = SHPMST.DUPNUM
AND SEGSHP.SEQNUM    = SHPMST.SEQNUM
AND SEGSHP.CMPCOD
= SHPMST.CMPCOD
AND SHPMST.SEQNUM=1
JOIN SHRARLACTMST MST
ON IMPFLT.FLTCARIDR = MST.ARLIDR
AND IMPFLT.CMPCOD
= MST.CMPCOD
WHERE IMPFLT.FLTCARIDR = ?
AND IMPFLT.FLTNUM      = ?
AND IMPFLT.FLTSEQNUM   = ?
AND IMPFLT.CMPCOD      = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>51</QRY:Id>
		<QRY:Source Name="operations.manifest.findmanifestdetailsforprint" Type="NATIVE">
			<![CDATA[
				SELECT ULD.CMPCOD ULDCMPCOD,
				  ULD.FLTCARIDR ULDFLTCARIDR,
				  ULD.FLTNUM ULDFLTNUM ,



				  ULD.FLTSEQNUM ULDFLTSEQNUM,
				  ULD.SEGSERNUM ULDSEGSERNUM,
				  ULD.BSEPLT,
				  ULD.BSEFLG,

CASE
					WHEN ULD.BARROWFLG
=
'Y'
					AND ISPRINT = 'Y'
					THEN 'BULK'
					ELSE ULD.ULDNUM

				  END ULDULDNUM ,
 					ULD.RMK,
					ULD.BDNITN,

				  MST.SHPNAM,

				  MST.SHPADRONE,
				  CNT.SHPCTR,
				  CNT.SHPCTY,

CNT.SHPPSTCOD,
				  CNT.SHPSTT,


				  MST.CNSNAM,
				  MST.CNSADRONE,
				  CNT.CNSCTR,

CNT.CNSCTY,
				  CNT.CNSPSTCOD,

				  CNT.CNSSTT,

				  SHP.CUSREF SHPCUSREF ,
				  SHP.MFTPCS
SHPPCS ,
				  SHP.MFTWGT SHPWGT ,

				  SHP.MFTVOL
SHPVOL ,
				  SHP.FLTCARIDR SHPFLTCARIDR,

				  SHP.FLTNUM SHPFLTNUM ,
				  ULD.GRSWGT
,

				  ULD.NETWGT ,
				  ULD.THRUNT ,

ULD.ULDCTR ,
				  ULD.TARWGT ,
				  SHP.FLTSEQNUM
SHPFLTSEQNUM,

				  SHP.SEGSERNUM SHPSEGSERNUM,

				  ULD.BARROWFLG,
				  CASE
					WHEN ULD.BARROWFLG
= 'Y'

					AND ISPRINT = 'Y'

THEN 'BULK'
					ELSE SHP.ULDNUM
				  END SHPULDNUM ,

				  SHP.DOCOWRIDR
SHPDOCOWRIDR,

CASE
					WHEN ULD.BARROWFLG = 'Y'
					AND ISPRINT = 'Y'

					THEN SHP.ULDNUM

					ELSE SHP.RMK

				  END MFTRMK ,
				  SHP.MSTDOCNUM SHPMSTDOCNUM,
				  SHP.DUPNUM
SHPDUPNUM
,
				  SHP.SEQNUM
SHPSEQNUM ,
				  SHP.RMK SHPRMK ,
				  SHP.CMPCOD SHPCMPCOD ,

				  MST.SCCCOD
MSTSCCCOD
,
				  MST.SHPDES MSTSHPDES ,
				  MST.ORGCOD MSTORGCOD ,
				  MST.DSTCOD
MSTDSTCOD ,


MST.STDWGTCOD MSTSTDWGTCOD,
				  MST.STDDISWGT MSTSTDDISWGT,
				  MST.PRDNAM
MSTPRDNAM ,


				  MST.PRDPRT MSTPRDPRT ,
				  MST.SHPPFX ,
				  SEG.CMPCOD SEGCMPCOD ,

				  SEG.FLTCARIDR
SEGFLTCARIDR,

				  SEG.FLTNUM SEGFLTNUM ,
				  SEG.FLTSEQNUM SEGFLTSEQNUM,

				  SEG.POL
SEGPOL ,
				  SEG.POU
SEGPOU ,
				  SEG.SEGSERNUM SEGSEGSERNUM,
				  RTG.SERNUM RTGSERNUM, 
				  RTG.SEGSERNUM RTGSEGSERNUM, 
				  RTG.FLTSEQNUM RTGFLTSEQNUM, 
				  RTG.FLTNUM RTGFLTNUM, 
				  RTG.FLTCARIDR RTGCARIDR, 
				  RTG.CMPCOD RTGCMPCOD, 
				  CASE WHEN ULD.BARROWFLG = 'Y' AND ISPRINT = 'Y' 
				  THEN 'BULK' 
				  ELSE RTG.ULDNUM 
				  END RTGULDNUM, 
				  RTG.THRCARIDR RTGTHRCARIDR, 
				  RTG.THRCARCOD RTGTHRCARCOD, 
				  RTG.THRFLTNUM RTGTHRFLTNUM, 
				  RTG.THRFLTDAT RTGTHRFLTDAT, 
				  RTG.THRDSTCOD RTGTHRDSTCOD,
				  SEGSHP.PLNPCS ,


SEGSHP.PLNWGT ,
				  SEGSHP.PLNVOL
,
				  MST.STDPCS ,
				  MST.STDWGT ,
				  MST.GRSVOL ,


				  SEGSHP.MFTPCS SEGSHPMFTPCS,

				  SEGSHP.MFTWGT SEGSHPMFTWGT,
				  SEGSHP.MFTVOL SEGSHPMFTVOL,


				  SHP.LODPRT ,

				  SHP.BDPPCS
SHPBDPPCS ,
				  SHP.BDPWGT SHPBDPWGT ,
				  SEGSHP.BDPPCS

SEGSHPBDPPCS,
				  SEGSHP.BDPWGT SEGSHPBDPWGT,

				  MST.CONFLG ,
				  MIS.SCICOD,
				 (SELECT

'Y' FROM OPROFLDTL OFL
				  WHERE SHP.DOCOWRIDR
= OFL.DOCOWRIDR
				  AND SHP.MSTDOCNUM = OFL.MSTDOCNUM


				  AND SHP.DUPNUM = OFL.DUPNUM
				  AND
SHP.SEQNUM = OFL.SEQNUM
				  AND SHP.CMPCOD = OFL.CMPCOD


				  AND ROWNUM =1)OFLSTS ,
				  ( SELECT
TALNUM
					FROM FLTOPRLEG FLTLEG
					WHERE SEG.CMPCOD

= FLTLEG.CMPCOD
					AND SEG.FLTCARIDR = FLTLEG.FLTCARIDR

					AND SEG.FLTNUM    = FLTLEG.FLTNUM


					AND SEG.FLTSEQNUM = FLTLEG.FLTSEQNUM
					AND FLTLEG.LEGORG =
?
				  ) TALNUM,
				  ( SELECT

ATD
					FROM FLTOPRLEG FLTLEG
					WHERE SEG.CMPCOD  = FLTLEG.CMPCOD
					AND SEG.FLTCARIDR = FLTLEG.FLTCARIDR

AND SEG.FLTNUM    = FLTLEG.FLTNUM
					AND SEG.FLTSEQNUM = FLTLEG.FLTSEQNUM
					AND FLTLEG.LEGORG =

?
				  ) ATD,
				  (SELECT MAX(MFTVER)

  				 	FROM OPRMFTVER VER
					WHERE SEG.CMPCOD =
VER.CMPCOD

AND SEG.FLTCARIDR = VER.FLTCARIDR

					AND SEG.FLTNUM = VER.FLTNUM
					AND SEG.FLTSEQNUM
= VER.FLTSEQNUM

					)MFTVERS,
				  (SELECT
RTRIM ( XMLAGG (

					  XMLELEMENT ( OCI,
					  CUSINF
|| ',' ) )
.EXTRACT ( '//text()' ), ','

					  ) CUSINF
					  from OPRSHPOCI OCI
					  WHERE OCI.CMPCOD=

MST.CMPCOD AND
					  OCI.DOCOWRIDR =
MST.DOCOWRIDR AND
					  OCI.MSTDOCNUM = MST.MSTDOCNUM AND


					  OCI.SEQNUM = MST.SEQNUM and

					  OCI.DUPNUM = MST.DUPNUM and

OCI.CNTCOD= 'US'
and
                    OCI.INFIDF
= 'EXP' and
                    OCI.CUSINFIDF
= 'M'

                   )CUSINF
,
				 NVL((SELECT RTRIM ( XMLAGG ( XMLELEMENT
( BKGFLT, (
  CASE
    WHEN MST.DSTCOD=SEG.POU
    THEN
(SELECT TO_CHAR(QMSPLN.MILSTNTIM,'dd-MON-YYYY/HH24:MI')
FROM QMSSHPMILSTNPLN QMSPLN
WHERE MST.CMPCOD
= QMSPLN.CMPCOD
AND MST.DOCOWRIDR    = QMSPLN.DOCOWRIDR
AND
MST.MSTDOCNUM    = QMSPLN.MSTDOCNUM
AND MST.DUPNUM
= QMSPLN.DUPNUM
AND MST.SEQNUM       = QMSPLN.SEQNUM
AND
SEG.FLTCARIDR    = QMSPLN.FLTCARIDR
AND SEG.FLTNUM
= QMSPLN.FLTNUM
AND SEG.FLTSEQNUM    = QMSPLN.FLTSEQNUM
AND
QMSPLN.PLNTYP    = 'SR'
AND QMSPLN.MILSTNCOD
='NFD'
AND QMSPLN.VERNUM=(SELECT MAX(VERNUM) FROM QMSSHPMILSTNPLN
WHERE
CMPCOD        = QMSPLN.CMPCOD
AND
DOCOWRIDR    = QMSPLN.DOCOWRIDR
AND MSTDOCNUM    = QMSPLN.MSTDOCNUM
AND
DUPNUM       = QMSPLN.DUPNUM
AND
SEQNUM       = QMSPLN.SEQNUM
AND FLTCARIDR    = QMSPLN.FLTCARIDR
AND
FLTNUM       = QMSPLN.FLTNUM
AND
FLTSEQNUM    = QMSPLN.FLTSEQNUM
AND PLNTYP    = 'SR'
AND MILSTNCOD
='NFD'))
    ELSE
      (SELECT (

CASE
          WHEN (BKGFLT.FLTCARCOD IS NOT NULL

AND ISSPRTARL           ='Y'
          AND
BKGFLT.FLTBKGSTA    ='C')
          THEN BKGFLT.FLTCARCOD

||BKGFLT.FLTNUM
            ||'
'
            ||TO_CHAR(BKGFLT.FLTDAT,'dd-MON-YYYY')
            ELSE
'1'
          END) AS ONWFLTINFO

        FROM
          (SELECT ARLACTMST.ARLIDR,

CASE
              WHEN ARLACTMST.OWNARLIND = 'Y'

              THEN ARLACTMST.OWNARLIND

WHEN ARLACTMST.ISSPRTARL = 'Y'
              THEN ARLACTMST.ISSPRTARL

            END ISSPRTARL

FROM SHRARLMST ARLACTMST
          WHERE ARLACTMST.CMPCOD = ?
          )

        WHERE ARLIDR
= BKGFLT.FLTCARIDR
        )
    END)
    || ',' ) ) .EXTRACT ( '//text()' ), ',' ) ONWFLTINFO

  FROM
CAPBKGFLTDTL BKGFLT
  WHERE MST.MSTDOCNUM = BKGFLT.MSTDOCNUM
  AND MST.DOCOWRIDR   =BKGFLT.DOCOWRIDR


  AND MST.DUPNUM      =BKGFLT.DUPNUM
  AND MST.SEQNUM      =BKGFLT.SEQNUM
  AND MST.CMPCOD      =BKGFLT.CMPCOD


  and SEG.POU         = BKGFLT.FLTORG
  and BKGFLT.FLTBKGSTA = 'C'
  ),
  (SELECT RTRIM ( XMLAGG ( XMLELEMENT

( BKGFLT, (
    CASE
      WHEN MST.DSTCOD=SEG.POU
      THEN (SELECT TO_CHAR(QMSPLN.MILSTNTIM,'dd-MON-YYYY/HH24:MI')

FROM QMSSHPMILSTNPLN QMSPLN
WHERE MST.CMPCOD        = QMSPLN.CMPCOD
AND MST.DOCOWRIDR    = QMSPLN.DOCOWRIDR
AND

MST.MSTDOCNUM    = QMSPLN.MSTDOCNUM
AND MST.DUPNUM       = QMSPLN.DUPNUM
AND MST.SEQNUM       = QMSPLN.SEQNUM
AND

SEG.FLTCARIDR    = QMSPLN.FLTCARIDR
AND SEG.FLTNUM       = QMSPLN.FLTNUM
AND SEG.FLTSEQNUM    = QMSPLN.FLTSEQNUM
AND

QMSPLN.PLNTYP    = 'SR'
AND QMSPLN.MILSTNCOD ='NFD'
AND QMSPLN.VERNUM=(SELECT MAX(VERNUM) FROM QMSSHPMILSTNPLN
WHERE

CMPCOD        = QMSPLN.CMPCOD
AND DOCOWRIDR    = QMSPLN.DOCOWRIDR
AND MSTDOCNUM    = QMSPLN.MSTDOCNUM
AND

DUPNUM       = QMSPLN.DUPNUM
AND SEQNUM       = QMSPLN.SEQNUM
AND FLTCARIDR    = QMSPLN.FLTCARIDR
AND

FLTNUM       = QMSPLN.FLTNUM
AND FLTSEQNUM    = QMSPLN.FLTSEQNUM
AND PLNTYP    = 'SR'
AND MILSTNCOD
='NFD'))

ELSE
        (SELECT (
          CASE
          WHEN (BKGFLT.FLTCARCOD IS NOT NULL

AND ISSPRTARL
='Y'
          AND BKGFLT.FLTBKGSTA   <> 'C')
          THEN 'EXPORT '

||MST.DSTCOD

WHEN (BKGFLT.UBRNUM   IS NOT NULL
          AND (NVL(ISSPRTARL,'N')='N'))

THEN 'Transfer to
'
            ||BKGFLT.FLTCARCOD
            ELSE '2'
        END) AS ONWFLTINFO

FROM
        (SELECT
ARLACTMST.ARLIDR,
          CASE
            WHEN ARLACTMST.OWNARLIND = 'Y'

THEN ARLACTMST.OWNARLIND

WHEN ARLACTMST.ISSPRTARL = 'Y'
            THEN ARLACTMST.ISSPRTARL

END ISSPRTARL
        FROM
SHRARLMST ARLACTMST
        WHERE ARLACTMST.CMPCOD = ?
        )
      WHERE
ARLIDR = BKGFLT.FLTCARIDR

)
    END)
    || ',' ) ) .EXTRACT ( '//text()' ), ',' ) ONWFLTINFO

FROM CAPBKGFLTDTL BKGFLT
  WHERE
MST.MSTDOCNUM = BKGFLT.MSTDOCNUM
  AND MST.DOCOWRIDR   =BKGFLT.DOCOWRIDR

AND MST.DUPNUM      =BKGFLT.DUPNUM

AND MST.SEQNUM      =BKGFLT.SEQNUM
  AND MST.CMPCOD      =BKGFLT.CMPCOD

and SEG.POU         = BKGFLT.FLTORG

  and BKGFLT.FLTBKGSTA <> 'C'
  AND ROWNUM = 1
  ))ONWFLTINFO,

FLTMST.FLTRMK,
    (SELECT RTRIM(XMLAGG(XMLELEMENT(A, DSTCOD
      ||',') ORDER BY RTGSERNUM).EXTRACT('//text()'),
',') DSTCOD
           FROM
OPRSHPRTG SHPRTG
           WHERE SHPRTG.CMPCOD = MST.CMPCOD

AND SHPRTG.DOCOWRIDR
= MST.DOCOWRIDR
           AND SHPRTG.MSTDOCNUM = MST.MSTDOCNUM
           AND
SHPRTG.DUPNUM
= MST.DUPNUM
           AND SHPRTG.SEQNUM = MST.SEQNUM
			)AS DSTCOD,
			ULD.ACTWGT,
			ULD.CONIDR
				  FROM OPRFLTSEG
SEG
JOIN OPRSEGULD ULD
ON
SEG.FLTCARIDR  = ULD.FLTCARIDR
AND SEG.FLTNUM    = ULD.FLTNUM
AND SEG.FLTSEQNUM
= ULD.FLTSEQNUM
				AND
SEG.SEGSERNUM = ULD.SEGSERNUM
AND SEG.CMPCOD    = ULD.CMPCOD
LEFT OUTER JOIN
OPRSEGULDSHP SHP
ON ULD.FLTCARIDR
= SHP.FLTCARIDR
AND ULD.FLTNUM    = SHP.FLTNUM
AND ULD.FLTSEQNUM
= SHP.FLTSEQNUM
AND ULD.SEGSERNUM =
SHP.SEGSERNUM
AND ULD.CMPCOD    = SHP.CMPCOD
AND ULD.ULDNUM    =
SHP.ULDNUM
AND SHP.MFTPCS    > 0
LEFT OUTER JOIN OPRULDTHRRTG RTG
ON ULD.FLTCARIDR 	= RTG.FLTCARIDR 
AND ULD.FLTNUM 		= RTG.FLTNUM 
AND ULD.FLTSEQNUM 	= RTG.FLTSEQNUM 
AND ULD.SEGSERNUM 	= RTG.SEGSERNUM 
AND ULD.CMPCOD		= RTG.CMPCOD 
AND ULD.ULDNUM 		= RTG.ULDNUM 
LEFT OUTER JOIN OPRSHPMST MST
ON SHP.DOCOWRIDR  = MST.DOCOWRIDR
AND
SHP.MSTDOCNUM = MST.MSTDOCNUM
AND SHP.DUPNUM    =
MST.DUPNUM
AND SHP.SEQNUM    = MST.SEQNUM
AND SHP.CMPCOD
= MST.CMPCOD
LEFT OUTER JOIN OPRSEGSHP SEGSHP
ON SHP.DOCOWRIDR
= SEGSHP.DOCOWRIDR
				AND SHP.MSTDOCNUM
= SEGSHP.MSTDOCNUM
AND SHP.DUPNUM    = SEGSHP.DUPNUM
AND SHP.SEQNUM
= SEGSHP.SEQNUM
AND SHP.CMPCOD
= SEGSHP.CMPCOD

				AND SHP.FLTCARIDR = SEGSHP.FLTCARIDR
AND SHP.FLTNUM
= SEGSHP.FLTNUM
AND SHP.FLTSEQNUM
= SEGSHP.FLTSEQNUM
				AND SHP.SEGSERNUM = SEGSHP.SEGSERNUM
LEFT OUTER
JOIN OPRSHPMSTMIS MIS
ON MST.DOCOWRIDR
= MIS.DOCOWRIDR
AND MST.MSTDOCNUM = MIS.MSTDOCNUM
AND MST.DUPNUM
= MIS.DUPNUM
AND MST.SEQNUM    =
MIS.SEQNUM
AND MST.CMPCOD    = MIS.CMPCOD
LEFT OUTER JOIN OPRSHPMSTCNT
CNT
ON MST.DOCOWRIDR =CNT.DOCOWRIDR
AND
MST.MSTDOCNUM=CNT.MSTDOCNUM
AND MST.DUPNUM   =CNT.DUPNUM
AND
MST.SEQNUM   =CNT.SEQNUM
AND MST.CMPCOD
=CNT.CMPCOD

LEFT OUTER JOIN FLTOPRMST FLTMST
ON SEG.CMPCOD    = FLTMST.CMPCOD
AND SEG.FLTCARIDR  = FLTMST.FLTCARIDR
AND
SEG.FLTNUM    = FLTMST.FLTNUM
AND SEG.FLTSEQNUM = FLTMST.FLTSEQNUM

LEFT OUTER JOIN
  (SELECT ? ISPRINT
FROM DUAL

  )
ON 1                =1
WHERE SEG.FLTCARIDR = ?
AND SEG.FLTNUM      = ?
AND SEG.FLTSEQNUM
= ?
AND SEG.CMPCOD      = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>54</QRY:Id>
		<QRY:Source Name="operations.manifest.findmanifestflightdetailsforsccprint" Type="NATIVE">
			<![CDATA[
				SELECT ULDCMPCOD,
			  ULDFLTCARIDR,
			  ULDFLTNUM ,
			  ULDFLTSEQNUM,
			  ULDSEGSERNUM,

BSEPLT,
			  BSEFLG,

			  ULDULDNUM ,
			  SHPNAM,
			  SHPADRONE,
			  SHPCTR,
			  SHPCTY,

SHPPSTCOD,
			  SHPSTT,


			  CNSNAM,
			  CNSADRONE,
			  CNSCTR,
			  CNSCTY,
			  CNSPSTCOD,

CNSSTT,
			  SHPCUSREF ,


			  SHPPCS ,
			  SHPWGT ,
			  SHPVOL ,
			  SHPFLTCARIDR,
			  SHPFLTNUM
,
			  GRSWGT ,
			  NETWGT
,

			  THRUNT ,
			  ULDCTR ,
			  TARWGT ,
			  SHPFLTSEQNUM,

SHPSEGSERNUM,
			  BARROWFLG,

			  SHPULDNUM
,
			  SHPDOCOWRIDR,
			  MFTRMK ,
			  SHPMSTDOCNUM,

SHPDUPNUM ,
			  SHPSEQNUM ,

			  SHPRMK ,

			  SHPCMPCOD ,
			  MSTSCCCOD ,
			  MSTSHPDES
,
			  MSTORGCOD ,
			  MSTDSTCOD ,

			  MSTSTDWGTCOD,

			  MSTSTDDISWGT,
			  MSTPRDNAM
,
			  MSTPRDPRT ,
			  SHPPFX ,
			  SEGCMPCOD
,
			  SEGFLTCARIDR,

			  SEGFLTNUM ,
			  SEGFLTSEQNUM,

SEGPOL ,
			  SEGPOU ,
			  SEGSEGSERNUM,

			  PLNPCS ,
			  PLNWGT
,
			  PLNVOL ,
			  STDPCS
,
			  STDWGT ,
			  GRSVOL ,
			  SEGSHPMFTPCS,

			  SEGSHPMFTWGT,

			  SEGSHPMFTVOL,

LODPRT ,
			  SHPBDPPCS ,
			  SHPBDPWGT ,
			  SEGSHPBDPPCS,

			  SEGSHPBDPWGT,

			  CONFLG
,
			  SCICOD,
			  OFLSTS ,
			  TALNUM,
			  ATD,
			  MFTVERS,
			  CUSINF,
			  ONWFLTINFO,
			  FLTRMK,
			  DSTCOD,
			  ACTWGT,
			  CONIDR			  
			FROM(
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>52</QRY:Id>
		<QRY:Source Name="operations.manifest.findmanifestflightdetailsforprint" Type="NATIVE">
			<![CDATA[
	SELECT EXPFLT.FLTCARIDR, EXPFLT.FLTNUM, EXPFLT.FLTSEQNUM, EXPFLT.LEGSERNUM,
	       EXPFLT.ARPCOD, EXPFLT.CMPCOD, EXPFLT.FINFLG, EXPFLT.FLTDAT,
	       EXPFLT.FLTCARCOD, ARLMST.ARLNAM,ARLMST.NATNTY
	  FROM OPRARPEXPFLT EXPFLT, SHRARLMST ARLMST
	 WHERE EXPFLT.CMPCOD = ARLMST.CMPCOD
	   AND EXPFLT.FLTCARIDR = ARLMST.ARLIDR
	   AND EXPFLT.FLTCARIDR = ?
	   AND EXPFLT.FLTNUM = ?
	   AND EXPFLT.FLTSEQNUM = ?
	   AND EXPFLT.CMPCOD = ?
   	   AND EXPFLT.ARPCOD = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>53</QRY:Id>
		<QRY:Source Name="operaions.flthandling.cto.findexportflightlistingdetails" Type="NATIVE">
			<![CDATA[
	SELECT LEG.CMPCOD, LEG.FLTCARIDR, LEG.FLTNUM, NVL(LEG.ATD,NVL(LEG.etd,LEG.std)) STD,
        (CASE

WHEN LEG.ATD IS NOT NULL
        THEN 'A'
        ELSE
        (CASE
          WHEN LEG.ETD IS NOT NULL

THEN 'E'
          ELSE 'S'
        END)
        END) STDIND, LEG.LEGSERNUM, LEG.FLTSEQNUM,
	       LEG.LEGORG
ARPCOD,

EXP.FINFLG, LEG.STD FLTDAT, MST.FLTOWN,
	       (CASE ARL.APHCODUSE WHEN 2
	THEN ARL.TWOAPHCOD
	ELSE ARL.THRAPHCOD
	END) FLTCARCOD, 
		   HIS.TXNCOD, LEG.LEGSTA, MST.FLTROU,



	       (SELECT SUM (SEGSHP.MFTPCS) || ',' || SUM (SEGSHP.BDPPCS)
			  FROM OPRSEGSHP SEGSHP
			 WHERE

SEGSHP.FLTCARIDR
= SEG.FLTCARIDR
			   AND SEGSHP.FLTNUM = SEG.FLTNUM
			   AND SEGSHP.FLTSEQNUM =
SEG.FLTSEQNUM


			   AND SEGSHP.CMPCOD = SEG.CMPCOD) AS TOTPCS
		  FROM OPRARPEXPFLT EXP,

OPREXPFLTHIS HIS,


		       OPRSEGSHP SEG,
		       OPRFLTSEG FLTSEG,
		       FLTOPRLEG LEG,

		       FLTOPRMST MST,
			   SHRARLMST ARL

		 WHERE LEG.FLTCARIDR
= EXP.FLTCARIDR(+)
		   AND LEG.FLTNUM = EXP.FLTNUM(+)

AND LEG.FLTSEQNUM =
EXP.FLTSEQNUM(+)

		   AND LEG.CMPCOD = EXP.CMPCOD(+)
		   AND LEG.LEGORG =
EXP.ARPCOD(+)
		   AND
LEG.LEGSERNUM = EXP.LEGSERNUM(+)

		   AND LEG.FLTCARIDR = FLTSEG.FLTCARIDR(+)

AND LEG.FLTNUM
= FLTSEG.FLTNUM(+)
		   AND LEG.FLTSEQNUM
= FLTSEG.FLTSEQNUM(+)
		   AND LEG.CMPCOD
= FLTSEG.CMPCOD(+)

		   AND FLTSEG.POL(+) = ?
		   AND FLTSEG.FLTCARIDR
= SEG.FLTCARIDR(+)

AND FLTSEG.FLTNUM = SEG.FLTNUM(+)

		   AND FLTSEG.FLTSEQNUM = SEG.FLTSEQNUM(+)

		   AND FLTSEG.SEGSERNUM
= SEG.SEGSERNUM(+)
		   AND FLTSEG.CMPCOD
= SEG.CMPCOD(+)
		   AND LEG.FLTCARIDR
= HIS.FLTCARIDR(+)

AND LEG.FLTNUM = HIS.FLTNUM(+)
		   AND
LEG.FLTSEQNUM = HIS.FLTSEQNUM(+)

		   AND HIS.ARPCOD(+)
= ?
		   AND LEG.CMPCOD = HIS.CMPCOD(+)

		   AND LEG.FLTCARIDR = MST.FLTCARIDR

		   AND LEG.FLTNUM
= MST.FLTNUM
		   AND LEG.FLTSEQNUM = MST.FLTSEQNUM

		   AND LEG.CMPCOD = MST.CMPCOD
		   AND ARL.CMPCOD  =MST.CMPCOD
		   AND ARL.ARLIDR  =MST.FLTCARIDR

		   AND LEG.CMPCOD = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>54</QRY:Id>
		<QRY:Source Name="operaions.flthandling.cto.findflightenquiryshipments" Type="NATIVE">
			<![CDATA[
	SELECT SEGSHP.DOCOWRIDR,
	  SEGSHP.MSTDOCNUM,
	  SEGSHP.DUPNUM,
	  SEGSHP.SEQNUM,
	  SEGSHP.FLTNUM,



	  SEGSHP.FLTSEQNUM,
	  SEGSHP.SEGSERNUM,
	  SEGSHP.FLTCARIDR,
	  SEGSHP.CMPCOD,
	  SEGSHP.MFTPCS,


	  SEGSHP.MFTWGT,

	  SEGSHP.MFTVOL,
	  MST.STDPCS,
	  MST.STDWGT,
	  MST.ORGCOD,
	  MST.DSTCOD,

SEGSHP.PLNPCS,

	  SEGSHP.PLNWGT,

	  MST.SHPPFX,
	  SEGSHP.BDPPCS,
	  SEGSHP.BDPWGT,
	  SEGSHP.OFLPCS,

SEGSHP.OFLWGT,





	  MIS.SCICOD
	FROM OPRSEGSHP
SEGSHP
	INNER JOIN OPRSHPMST MST
	ON
MST.MSTDOCNUM  = SEGSHP.MSTDOCNUM

	   AND MST.DOCOWRIDR = SEGSHP.DOCOWRIDR

	AND MST.DUPNUM
= SEGSHP.DUPNUM
	AND MST.SEQNUM    = SEGSHP.SEQNUM

	AND MST.CMPCOD    = SEGSHP.CMPCOD
	INNER JOIN OPRFLTSEG
FLTSEG
	ON  FLTSEG.CMPCOD    = SEGSHP.CMPCOD

	AND FLTSEG.FLTCARIDR = SEGSHP.FLTCARIDR
	AND FLTSEG.FLTNUM
= SEGSHP.FLTNUM
	AND FLTSEG.FLTSEQNUM =
SEGSHP.FLTSEQNUM
	AND FLTSEG.SEGSERNUM = SEGSHP.SEGSERNUM


LEFT JOIN OPRSHPMSTMIS
MIS
	ON MST.MSTDOCNUM
= MIS.MSTDOCNUM
	   AND MST.DOCOWRIDR = MIS.DOCOWRIDR

AND MST.DUPNUM    = MIS.DUPNUM

	AND MST.SEQNUM
= MIS.SEQNUM
	AND MST.CMPCOD    = MIS.CMPCOD
	WHERE
SEGSHP.FLTCARIDR           = ?

	AND SEGSHP.FLTSEQNUM
= ?
	AND SEGSHP.FLTNUM
= ?
	AND SEGSHP.CMPCOD            = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>55</QRY:Id>
		<QRY:Source Name="operaions.flthandling.cto.findflightenquiryulddetails" Type="NATIVE">
			<![CDATA[
	SELECT ULD.CMPCOD, ULD.FLTCARIDR, ULD.FLTNUM, ULD.FLTSEQNUM, ULD.SEGSERNUM,ULD.ULDSTA,
	       ULD.ULDNUM,


ULD.GRSWGT, ULD.NETWGT, ULD.ULDCTR, ULD.TARWGT, ULD.MFTFLG,ULD.RCVFLG,ULD.ACTWGT,
	       PLNULD.CMPCOD

PLNULDCMPCOD,
PLNULD.FLTCARIDR PLNULDFLTCARIDR,
	       PLNULD.FLTNUM PLNULDFLTNUM, PLNULD.FLTSEQNUM

PLNULDFLTSEQNUM,

	       PLNULD.SEGSERNUM PLNULDSEGSERNUM, PLNULD.ULDNUM PLNULDULDNUM,


	       SEGSHP.MFTPCS,SEGSHP.BDPPCS,FLTSEG.POL,FLTSEG.POU,
		   SEGSHP.DOCOWRIDR MFTDOCOWRIDR,SEGSHP.MSTDOCNUM

MFTMSTDOCNUM,SEGSHP.DUPNUM MFTDUPNUM,SEGSHP.SEQNUM MFTSEQNUM,
		   OFLDTL.CMPCOD OFLDTLCMPCOD,OFLDTL.FLTCARIDR

OFLDTLFLTCARIDR,
		   OFLDTL.FLTNUM OFLDTLFLTNUM, OFLDTL.FLTSEQNUM
OFLDTLFLTSEQNUM,
		   OFLDTL.SEGSERNUM

OFLDTLSEGSERNUM, OFLDTL.ULDNUM OFLDTLULDNUM,
		  OFLDTL.DOCOWRIDR,
OFLDTL.MSTDOCNUM, OFLDTL.DUPNUM,

OFLDTL.SEQNUM  ,
		   OFLDTL.OFLPCS, OFLDTL.OFLWGT, OFLDTL.OFLVOL, OFLDTL.OFLDAT,
OFLDTL.SHPPFX OFLDTLSHPPFX


		   ,ULD.INRSTWLSS,ULD.OUTSTWLSS
	  FROM OPRSEGULD ULD, OPRLODPLNULD PLNULD,
OPRSEGULDSHP SEGSHP,OPRFLTSEG

FLTSEG,OPROFLDTL OFLDTL

	 WHERE ULD.CMPCOD = FLTSEG.CMPCOD
	   AND ULD.FLTCARIDR
= FLTSEG.FLTCARIDR


	   AND ULD.FLTNUM = FLTSEG.FLTNUM
	   AND ULD.FLTSEQNUM = FLTSEG.FLTSEQNUM
	   AND
ULD.SEGSERNUM =
FLTSEG.SEGSERNUM

	   AND ULD.CMPCOD = PLNULD.CMPCOD(+)
	   AND ULD.FLTCARIDR = PLNULD.FLTCARIDR(+)


	   AND ULD.FLTNUM
= PLNULD.FLTNUM(+)
	   AND ULD.FLTSEQNUM = PLNULD.FLTSEQNUM(+)
	   AND ULD.SEGSERNUM
=
PLNULD.SEGSERNUM(+)

	   AND ULD.CMPCOD = SEGSHP.CMPCOD(+)
	   AND ULD.FLTCARIDR = SEGSHP.FLTCARIDR(+)


	   AND ULD.FLTNUM
= SEGSHP.FLTNUM(+)
	   AND ULD.FLTSEQNUM = SEGSHP.FLTSEQNUM(+)
	   AND ULD.SEGSERNUM
=
SEGSHP.SEGSERNUM(+)

	   AND ULD.ULDNUM = SEGSHP.ULDNUM(+)

	    AND FLTSEG.CMPCOD = OFLDTL.CMPCOD(+)


	   AND FLTSEG.FLTCARIDR
= OFLDTL.FLTCARIDR(+)
	   AND FLTSEG.FLTNUM = OFLDTL.FLTNUM(+)
	   AND FLTSEG.FLTSEQNUM

= OFLDTL.FLTSEQNUM(+)

	    AND FLTSEG.SEGSERNUM = OFLDTL.SEGSERNUM(+)
	   AND OFLDTL.OFLTYP(+)='F'


	   AND( ULD.BARROWFLG is
null Or  ULD.BARROWFLG='N')
	   AND ULD.FLTCARIDR = ?
	   AND ULD.FLTSEQNUM
= ?

	   AND ULD.FLTNUM
= ?
	   AND ULD.CMPCOD = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>56</QRY:Id>
		<QRY:Source Name="operaions.flthandling.cto.findflighttransactionhistory" Type="NATIVE">
			<![CDATA[
	SELECT HIS.TXNCOD, HIS.ARPCOD, HIS.STRTIM, HIS.ENDTIM
	  FROM OPREXPFLTHIS HIS
	 WHERE HIS.FLTNUM = ?
	   AND HIS.FLTCARIDR = ?
	   AND HIS.FLTSEQNUM = ?
	   AND HIS.ARPCOD = ?
	   AND HIS.LEGSERNUM = ?
	   AND HIS.CMPCOD = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>57</QRY:Id>
		<QRY:Source Name="operaions.flthandling.flightfactsprocedure" Type="NATIVE">
			<![CDATA[
	CALL FLT_FAC_POP_PKG.populateFlightFactsTable (
					?,
					?,
					?,
					?,
					?,
					?
				)
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>57</QRY:Id>
		<QRY:Source Name="operaions.flthandling.cto.exportflightdetails" Type="NATIVE">
			<![CDATA[
	SELECT EXPFLT.FINFLG, EXPFLT.RMK,EXPFLT.FLTOPRSTA,EXPFLT.RELFLG,EXPFLT.BDPSTA,
	EXPFLT.OPRREFCARCOD,EXPFLT.OPRREFFLTDATUTC,EXPFLT.OPRREFFLTNUM
		  FROM OPRARPEXPFLT EXPFLT
		 WHERE EXPFLT.FLTCARIDR = ?
		   AND EXPFLT.FLTNUM = ?
		   AND EXPFLT.FLTSEQNUM = ?
		   AND EXPFLT.LEGSERNUM = ?
		   AND EXPFLT.ARPCOD = ?
	   AND EXPFLT.CMPCOD = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>58</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findflightdetails" Type="NATIVE">
			<![CDATA[
		SELECT MST.CMPCOD,SEG.SEGDST,MST.FLTCARIDR,ARL.TWOAPHCOD,LEG.LEGSERNUM,
		MST.FLTNUM,MST.FLTDAT,MST.FLTSEQNUM,MST.FLTROU



		FROM OPRSEGSHP SHP ,FLTOPRSEG SEG ,FLTOPRMST MST, FLTOPRLEG LEG, SHRARLMST ARL
		WHERE
        ARL.CMPCOD


= MST.CMPCOD
        AND ARL.ARLIDR = MST.FLTCARIDR
		AND SHP.FLTCARIDR = SEG.FLTCARIDR
		AND SHP.CMPCOD


= SEG.CMPCOD
		AND SHP.FLTNUM = SEG.FLTNUM
		AND SHP.FLTSEQNUM = SEG.FLTSEQNUM
		AND SHP.SEGSERNUM
=

SEG.SEGSERNUM
		AND SHP.FLTCARIDR = LEG.FLTCARIDR
		AND SHP.CMPCOD = LEG.CMPCOD
		AND SHP.FLTNUM
= LEG.FLTNUM


		AND SHP.FLTSEQNUM = LEG.FLTSEQNUM
		AND SEG.SEGDST = LEG.LEGDST
		AND SHP.CMPCOD =
MST.CMPCOD
		AND
SHP.FLTNUM
= MST.FLTNUM
		AND SHP.FLTSEQNUM = MST.FLTSEQNUM
		AND SHP.FLTCARIDR =
MST.FLTCARIDR
		AND
SHP.CMPCOD
=  ?
		AND SEG.SEGDST = ?
		AND SHP.MSTDOCNUM = ?
		AND SHP.DOCOWRIDR
= ?
		AND SHP.SEQNUM
= ?
		AND SHP.DUPNUM = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>59</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findflightdetailsforawb" Type="NATIVE">
			<![CDATA[
		SELECT IMPFLT.CMPCOD, IMPFLT.ARPCOD, IMPFLT.FLTCARIDR, IMPFLT.FLTNUM,
		       IMPFLT.FLTDAT, IMPFLT.FLTSEQNUM,


IMPFLT.CLSFLG, IMPFLT.FLTCARCOD,
		       IMPFLT.LEGSERNUM,'FLTROU' FLTROU
		  FROM OPRSHPMST MST,
OPRSEGSHP

SEGSHP, OPRARPIMPFLT IMPFLT, OPRFLTSEG SEG
		 WHERE MST.MSTDOCNUM = SEGSHP.MSTDOCNUM

AND MST.DOCOWRIDR

= SEGSHP.DOCOWRIDR
		   AND MST.DUPNUM = SEGSHP.DUPNUM
		   AND MST.SEQNUM = SEGSHP.SEQNUM

AND
MST.CMPCOD
= SEGSHP.CMPCOD
		   AND IMPFLT.CMPCOD = SEG.CMPCOD
		   AND IMPFLT.ARPCOD = SEG.POU


AND IMPFLT.FLTCARIDR
= SEG.FLTCARIDR
		   AND IMPFLT.FLTNUM = SEG.FLTNUM
		   AND IMPFLT.FLTSEQNUM
=
SEG.FLTSEQNUM
		   AND
SEGSHP.CMPCOD = SEG.CMPCOD
		   AND SEGSHP.SEGSERNUM = SEG.SEGSERNUM

AND
SEGSHP.FLTCARIDR = SEG.FLTCARIDR

AND SEGSHP.FLTNUM = SEG.FLTNUM
		   AND SEGSHP.FLTSEQNUM
= SEG.FLTSEQNUM

		   AND IMPFLT.CLSFLG='Y'

AND MST.MSTDOCNUM = ?
		   AND MST.DOCOWRIDR =
?
		   AND MST.DUPNUM = ?

		   AND MST.SEQNUM = ?

AND MST.CMPCOD = ?
		   AND IMPFLT.ARPCOD = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>60</QRY:Id>
		<QRY:Source Name="operaions.flthandling.findtaskdetailsforinboundramp" Type="NATIVE">
			<![CDATA[
		SELECT OPRLEG.CMPCOD,OPRLEG.FLTCARIDR,OPRLEG.FLTNUM,OPRLEG.FLTSEQNUM,OPRLEG.LEGSERNUM,
			   OPRLEG.STA,



			   SEGULD.MFTFLG,SEGULD.RCVFLG,SEGULD.ULDNUM,
			   OPRMST.FLTROU,OPRMST.FLTDAT,

IMPFLT.FLTCARCOD


		FROM OPRFLTSEG FLTSEG,OPRSEGULD SEGULD,FLTOPRLEG OPRLEG,FLTOPRMST OPRMST,OPRARPIMPFLT
IMPFLT
		WHERE


			FLTSEG.CMPCOD = SEGULD.CMPCOD  AND
			FLTSEG.SEGSERNUM = SEGULD.SEGSERNUM AND

FLTSEG.FLTSEQNUM
= SEGULD.FLTSEQNUM
AND
			FLTSEG.FLTNUM = SEGULD.FLTNUM AND
			FLTSEG.FLTCARIDR =
SEGULD.FLTCARIDR AND

			FLTSEG.CMPCOD
= OPRLEG.CMPCOD  AND
			FLTSEG.FLTSEQNUM = OPRLEG.FLTSEQNUM
AND
			FLTSEG.FLTNUM = OPRLEG.FLTNUM
AND

FLTSEG.FLTCARIDR = OPRLEG.FLTCARIDR AND
			FLTSEG.CMPCOD
= OPRMST.CMPCOD  AND
			FLTSEG.FLTSEQNUM
= OPRMST.FLTSEQNUM
AND
			FLTSEG.FLTNUM = OPRMST.FLTNUM AND

FLTSEG.FLTCARIDR = OPRMST.FLTCARIDR AND

			FLTSEG.CMPCOD
= IMPFLT.CMPCOD  AND
			FLTSEG.FLTSEQNUM
= IMPFLT.FLTSEQNUM AND
			FLTSEG.FLTNUM = IMPFLT.FLTNUM
AND

FLTSEG.FLTCARIDR = IMPFLT.FLTCARIDR
AND
			OPRLEG.LEGSERNUM = IMPFLT.LEGSERNUM AND
			FLTSEG.POU
= OPRLEG.LEGDST
AND
			FLTSEG.POU = IMPFLT.ARPCOD
AND
		    (SEGULD.MFTFLG = 'Y' OR SEGULD.RCVFLG =
'Y') AND
			FLTSEG.CMPCOD = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>61</QRY:Id>
		<QRY:Source Name="operaions.flthandling.findtaskdetailsforbuildup" Type="NATIVE">
			<![CDATA[

 SELECT PLNMST.CMPCOD,
  PLNMST.FLTCARIDR   ,
  PLNMST.FLTNUM      ,
  PLNMST.FLTSEQNUM   ,
  FLTLEG.LEGSERNUM


,
  FLTLEG.STD         ,
  FLTMST.FLTROU      ,
  FLTMST.FLTDAT      ,
  FLTLEG.LEGORG   POL   ,

EXPFLT.FLTCARCOD


   FROM OPRLODPLNMST PLNMST,
  OPRARPEXPFLT EXPFLT      ,
  FLTOPRLEG FLTLEG
,
  FLTOPRMST FLTMST


  WHERE PLNMST.CMPCOD       = FLTMST.CMPCOD
AND PLNMST.FLTSEQNUM        = FLTMST.FLTSEQNUM
AND
PLNMST.FLTNUM

= FLTMST.FLTNUM
AND PLNMST.FLTCARIDR        = FLTMST.FLTCARIDR
AND FLTMST.CMPCOD
= FLTLEG.CMPCOD
AND

FLTMST.FLTNUM           =FLTLEG.FLTNUM
AND FLTMST.FLTSEQNUM        =FLTLEG.FLTSEQNUM
AND
FLTMST.FLTCARIDR

=FLTLEG.FLTCARIDR
AND FLTLEG.CMPCOD           = EXPFLT.CMPCOD(+)
AND FLTLEG.FLTSEQNUM
= EXPFLT.FLTSEQNUM(+)
AND

FLTLEG.FLTNUM           = EXPFLT.FLTNUM(+)
AND FLTLEG.FLTCARIDR        =
EXPFLT.FLTCARIDR(+)
AND FLTLEG.LEGSERNUM

= EXPFLT.LEGSERNUM(+)
AND FLTLEG.LEGORG           =
EXPFLT.ARPCOD(+)
AND NVL(EXPFLT.FINFLG,'N') <> 'F'
AND

PLNMST.CMPCOD           = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>62</QRY:Id>
		<QRY:Source Name="operaions.flthandling.findtaskdetailsforoutboundramp" Type="NATIVE">
			<![CDATA[
		SELECT OPRLEG.CMPCOD,OPRLEG.FLTCARIDR,OPRLEG.FLTNUM,OPRLEG.FLTSEQNUM,OPRLEG.LEGSERNUM,
			   OPRLEG.STD,



			   SEGULD.MFTFLG,SEGULD.RCVFLG,SEGULD.ULDNUM,
			   OPRMST.FLTROU,OPRMST.FLTDAT,

EXPFLT.FLTCARCOD


		FROM OPRFLTSEG FLTSEG,OPRSEGULD SEGULD,FLTOPRLEG OPRLEG,FLTOPRMST OPRMST,OPRARPEXPFLT
EXPFLT
		WHERE


			FLTSEG.CMPCOD = SEGULD.CMPCOD  AND
			FLTSEG.SEGSERNUM = SEGULD.SEGSERNUM AND

FLTSEG.FLTSEQNUM
= SEGULD.FLTSEQNUM
AND
			FLTSEG.FLTNUM = SEGULD.FLTNUM AND
			FLTSEG.FLTCARIDR =
SEGULD.FLTCARIDR AND

			FLTSEG.CMPCOD
= OPRLEG.CMPCOD  AND
			FLTSEG.FLTSEQNUM = OPRLEG.FLTSEQNUM
AND
			FLTSEG.FLTNUM = OPRLEG.FLTNUM
AND

FLTSEG.FLTCARIDR = OPRLEG.FLTCARIDR AND
			FLTSEG.CMPCOD
= OPRMST.CMPCOD  AND
			FLTSEG.FLTSEQNUM
= OPRMST.FLTSEQNUM
AND
			FLTSEG.FLTNUM = OPRMST.FLTNUM AND

FLTSEG.FLTCARIDR = OPRMST.FLTCARIDR AND

			FLTSEG.CMPCOD
= EXPFLT.CMPCOD  AND
			FLTSEG.FLTSEQNUM
= EXPFLT.FLTSEQNUM AND
			FLTSEG.FLTNUM = EXPFLT.FLTNUM
AND

			FLTSEG.FLTCARIDR = EXPFLT.FLTCARIDR
AND
			OPRLEG.LEGSERNUM = EXPFLT.LEGSERNUM AND
			FLTSEG.POL
= OPRLEG.LEGORG
AND
			FLTSEG.POL = EXPFLT.ARPCOD
AND
		    (SEGULD.MFTFLG = 'Y') AND
			FLTSEG.CMPCOD = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>63</QRY:Id>
		<QRY:Source Name="operaions.flthandling.findtaskdetailsforbreakdown" Type="NATIVE">
			<![CDATA[
			SELECT
			  OPRLEG.CMPCOD,OPRLEG.FLTCARIDR,OPRLEG.FLTNUM,OPRLEG.FLTSEQNUM,OPRLEG.LEGSERNUM,OPRLEG.STA,



			  SEGULD.ULDNUM,
			  OPRMST.FLTROU,OPRMST.FLTDAT,
			  FLTSEG.POU,
              IMPFLT.FLTCARCOD


			FROM

			  OPRFLTSEG FLTSEG, OPRSEGULD SEGULD, FLTOPRLEG OPRLEG,FLTOPRMST OPRMST, OPRARPIMPFLT
IMPFLT

			WHERE

			  FLTSEG.CMPCOD = SEGULD.CMPCOD  AND
			  FLTSEG.SEGSERNUM = SEGULD.SEGSERNUM
AND

			  FLTSEG.FLTSEQNUM
= SEGULD.FLTSEQNUM AND
			  FLTSEG.FLTNUM = SEGULD.FLTNUM AND
			  FLTSEG.FLTCARIDR

= SEGULD.FLTCARIDR
AND
			  FLTSEG.CMPCOD = OPRLEG.CMPCOD  AND
			  FLTSEG.FLTSEQNUM = OPRLEG.FLTSEQNUM

AND
			  FLTSEG.FLTNUM
= OPRLEG.FLTNUM AND
			  FLTSEG.FLTCARIDR = OPRLEG.FLTCARIDR AND
			  FLTSEG.CMPCOD

= OPRMST.CMPCOD
AND
			  FLTSEG.FLTSEQNUM = OPRMST.FLTSEQNUM AND
			  FLTSEG.FLTNUM = OPRMST.FLTNUM

AND
			  FLTSEG.FLTCARIDR
= OPRMST.FLTCARIDR AND
			  FLTSEG.CMPCOD = IMPFLT.CMPCOD  AND
			  FLTSEG.FLTSEQNUM

= IMPFLT.FLTSEQNUM
AND
			  FLTSEG.FLTNUM = IMPFLT.FLTNUM AND
			  FLTSEG.FLTCARIDR = IMPFLT.FLTCARIDR

AND
			  OPRLEG.LEGSERNUM
= IMPFLT.LEGSERNUM AND
			  FLTSEG.POU = OPRLEG.LEGDST AND
			  FLTSEG.POU

= IMPFLT.ARPCOD AND
			  (SEGULD.MFTFLG
= 'Y') AND
			  FLTSEG.CMPCOD = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>63</QRY:Id>
		<QRY:Source Name="operaions.flthandling.cto.ramp.findshipmentdetailsforramptransfer" Type="NATIVE">
			<![CDATA[
	SELECT ULD.CMPCOD ULDCMPCOD,
	       ULD.FLTCARIDR ULDFLTCARIDR,
	       ULD.FLTNUM ULDFLTNUM,

ULD.BUPFLG BUPFLG,
		  ULD.BKGTYP BKGTYP,
		  ULD.ALTIDR ALTIDR,
		  ULD.ULDBKGIDR BKGIDR,
	       ULD.CONIDR
CONTENTID,
	       ULD.FLTSEQNUM ULDFLTSEQNUM,
	       ULD.SEGSERNUM ULDSEGSERNUM,
  ULD.ULDNUM ULDULDNUM,

ULD.THRUNT ULDTRHUNT,
  ULD.ULDCTR ULDCTR,
  ULD.ACTWGT ULDACTWGT,
  SEG.POU IMPFLTARPCOD,
	       LEG.LEGSERNUM
IMPFLTLEGSERNUM,

	       LEG.STA IMPFLTFLTDAT,
	       IMPFLT.FLTOPRSTA,
SHP.MFTPCS SHPPCS,

SHP.MFTWGT SHPWGT,
  SHP.MFTVOL SHPVOL,
	       SHP.FLTCARIDR SHPFLTCARIDR,

	       SHP.FLTNUM
SHPFLTNUM,
	       SHP.FLTSEQNUM SHPFLTSEQNUM,

	       SHP.SEGSERNUM SHPSEGSERNUM,


SHP.ULDNUM SHPULDNUM,
	       SHP.DOCOWRIDR SHPDOCOWRIDR,

	       SHP.MSTDOCNUM SHPMSTDOCNUM,

SHP.DUPNUM SHPDUPNUM,
  SHP.SEQNUM SHPSEQNUM,
	       SHP.RMK SHPRMK,
SHP.CMPCOD SHPCMPCOD,
  MST.SCCCOD
MSTSCCCOD,
  MST.ORGCOD MSTORGCOD,
	       MST.DSTCOD MSTDSTCOD,

	       MST.STDWGTCOD MSTSTDWGTCOD,

MST.STDDISWGT MSTSTDDISWGT,
  MST.SHPPFX,
  MST.STDPCS,
  MST.OWRCOD MSTOWRCOD,
	       MST.STDWGT,
MST.GRSVOL,

MST.CONFLG,
		   MST.RDYCRGFLG,
	       SEG.CMPCOD SEGCMPCOD,
	       SEG.FLTCARIDR SEGFLTCARIDR,


	       SEG.FLTNUM
SEGFLTNUM,
  SEG.FLTSEQNUM SEGFLTSEQNUM,
  SEG.POL SEGPOL,
	       SEG.POU SEGPOU,
  SEG.SEGSERNUM SEGSEGSERNUM,

ARPSHP.RCVPCS,
  ARPSHP.RCVWGT,
  (
  CASE
    WHEN LEG.ATA IS NOT NULL
	                        THEN
LEG.ATA
    ELSE (
      CASE

	                              WHEN LEG.ETA IS NOT NULL
        THEN LEG.ETA


	                              ELSE LEG.STA
      END )
  END ) ARRTIM,
  BKGFLTDTL.FLTCARCOD,
  BKGFLTDTL.FLTNUM,

BKGFLTDTL.FLTDAT,
  BKGFLTDTL.fltorg,
  BKGFLTDTL.FLTDST,
  arlmst.ISSPRTARL,
  (SELECT
    CASE

WHEN APHCODUSE=2
      THEN TWOAPHCOD
      WHEN APHCODUSE=3
      THEN THRAPHCOD
    END OWNCARCOD

FROM shrarlactmst arl
  WHERE arl.cmpcod=SEG.CMPCOD
  AND arl.ARLIDR  =syspar.parval
  ) OWNCARCOD
FROM
OPRFLTSEG SEG
INNER JOIN FLTOPRLEG LEG
			       ON SEG.CMPCOD = LEG.CMPCOD

			     AND SEG.FLTCARIDR
= LEG.FLTCARIDR
AND SEG.POU       = LEG.LEGDST
			     AND SEG.FLTNUM = LEG.FLTNUM

			     AND
SEG.FLTSEQNUM = LEG.FLTSEQNUM
INNER JOIN OPRSEGULD ULD
			       ON SEG.FLTCARIDR = ULD.FLTCARIDR


			     AND SEG.FLTNUM = ULD.FLTNUM

AND SEG.FLTSEQNUM = ULD.FLTSEQNUM
			     AND SEG.SEGSERNUM
= ULD.SEGSERNUM
AND SEG.CMPCOD    = ULD.CMPCOD
	       INNER JOIN OPRSEGULDSHP SHP
			       ON ULD.CMPCOD
= SHP.CMPCOD
AND ULD.FLTCARIDR = SHP.FLTCARIDR
			     AND ULD.FLTNUM = SHP.FLTNUM
			     AND ULD.FLTSEQNUM
= SHP.FLTSEQNUM


AND ULD.SEGSERNUM = SHP.SEGSERNUM
			     AND ULD.ULDNUM = SHP.ULDNUM

INNER JOIN OPRSHPMST MST


			       ON SHP.DOCOWRIDR = MST.DOCOWRIDR
			     AND SHP.MSTDOCNUM
= MST.MSTDOCNUM
AND SHP.DUPNUM    = MST.DUPNUM

			     AND SHP.SEQNUM = MST.SEQNUM
			     AND
SHP.CMPCOD = MST.CMPCOD

LEFT OUTER JOIN OPRARPSHP ARPSHP

			       ON MST.CMPCOD
= ARPSHP.CMPCOD
AND MST.DOCOWRIDR = ARPSHP.DOCOWRIDR
AND MST.MSTDOCNUM = ARPSHP.MSTDOCNUM
			     AND
MST.DUPNUM = ARPSHP.DUPNUM

AND MST.SEQNUM = ARPSHP.SEQNUM

		     AND ARPSHP.ARPCOD =
SEG.POU
LEFT OUTER JOIN OPRARPIMPFLT IMPFLT
			       ON SEG.CMPCOD = IMPFLT.CMPCOD


AND SEG.FLTCARIDR = IMPFLT.FLTCARIDR

			     AND SEG.POU = IMPFLT.ARPCOD
			     AND SEG.FLTNUM
= IMPFLT.FLTNUM
AND SEG.FLTSEQNUM = IMPFLT.FLTSEQNUM
	       LEFT OUTER JOIN CAPBKGMST BKGMST
ON MST.CMPCOD
= BKGMST.CMPCOD

			     AND MST.MSTDOCNUM = BKGMST.MSTDOCNUM
			     AND MST.DOCOWRIDR = BKGMST.DOCOWRIDR
AND
MST.DUPNUM    = BKGMST.DUPNUM
			     AND MST.SEQNUM = BKGMST.SEQNUM
LEFT OUTER JOIN CAPBKGFLTDTL BKGFLTDTL


ON BKGMST.CMPCOD = BKGFLTDTL.CMPCOD
	     		AND BKGMST.UBRNUM = BKGFLTDTL.UBRNUM
AND seg.pou       =BKGFLTDTL.fltorg
LEFT
OUTER JOIN shrarlactmst arlmst
ON arlmst.CMPCOD  = BKGFLTDTL.CMPCOD
AND arlmst.ARLIDR = BKGFLTDTL.FLTCARIDR
INNER
JOIN shrsyspar syspar
ON syspar.cmpcod         =SEG.CMPCOD
AND syspar.parcod        ='logonattributes.ownairlineidentifier'

WHERE SEG.CMPCOD = ?
			 AND SEG.FLTCARIDR = ?
			 AND SEG.FLTNUM = ?
			 AND SEG.FLTSEQNUM = ?
AND SEG.POU
= ?
			 AND ULD.MFTFLG = 'Y'
	                 and SHP.MFTPCS-NVL(SHP.RCVPCS,0) > 0
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>63</QRY:Id>
		<QRY:Source Name="operaions.flthandling.cto.ramp.findramptransferdetails" Type="NATIVE">
			<![CDATA[
		SELECT RMPULD.CMPCOD RMPULDCMPCOD,
  RMPULD.ARPCOD RMPULDARPCOD,
  RMPULD.ULDNUM RMPULDULDNUM,
  RMPULD.INBFLTCARIDR
RMPULDINBFLTCARIDR,
  RMPULD.INBFLTNUM RMPULDINBFLTNUM,
  RMPULD.INBFLTSEQNUM RMPULDINBFLTSEQNUM,
  RMPULD.INBLEGSERNUM
RMPULDINBLEGSERNUM,
			RMPULD.INBCARCOD RMPULDINBCARCOD,
  RMPULD.INBFLTDAT RMPULDINBFLTDAT,
  RMPULD.THRULD
RMPTHRULD,
  RMPULD.INBPOL RMPULDINBPOL,
  RMPULD.OUTFLTCARIDR RMPULDOUTFLTCARIDR,
  RMPULD.OUTFLTNUM
RMPULDOUTFLTNUM,
  RMPULD.OUTFLTSEQNUM RMPULDOUTFLTSEQNUM,
  RMPULD.OUTLEGSERNUM RMPULDOUTLEGSERNUM,

RMPULD.OUTPOU RMPULDOUTPOU,
  RMPULD.RMK RMPRMK,
  RMPULD.OUTCARCOD RMPULDOUTCARCOD,
			RMPULD.OUTFLTDAT
RMPULDOUTFLTDAT,
  RMPSHP.CMPCOD RMPSHPCMPCOD,
  RMPSHP.ARPCOD RMPSHPARPCOD,
  RMPSHP.ULDNUM RMPSHPULDNUM,

RMPSHP.INBFLTCARIDR RMPSHPINBFLTCARIDR,
  RMPSHP.INBFLTNUM RMPSHPINBFLTNUM,
  RMPSHP.INBFLTSEQNUM RMPSHPINBFLTSEQNUM,

RMPSHP.INBLEGSERNUM RMPSHPINBLEGSERNUM,
  RMPSHP.SERNUM RMPSHPSERNUM,
  RMPSHP.DOCOWRIDR RMPSHPDOCOWRIDR,

RMPSHP.MSTDOCNUM RMPSHPMSTDOCNUM,
  RMPSHP.DUPNUM RMPSHPDUPNUM,
  RMPSHP.SEQNUM RMPSHPSEQNUM,
  RMPSHP.TRFPCS
RMPSHPTRFPCS,
  RMPSHP.TRFWGT RMPSHPTRFWGT,
  RMPSHP.OUTULDNUM RMPSHPOUTULDNUM,
  RMPSHP.ULDCTR RMPSHPOUTULDCTR,
  RMPSHP.OUTFLTCARIDR
RMPSHPOUTFLTCARIDR,
  RMPSHP.OUTFLTDAT RMPSHPOUTFLTDAT,
  RMPSHP.OUTFLTNUM RMPSHPOUTFLTNUM,
  RMPSHP.OUTFLTSEQNUM
RMPSHPOUTFLTSEQNUM,
  RMPSHP.OUTLEGSERNUM RMPSHPOUTLEGSERNUM,
		   	MST.SHPPFX,
  MST.STDPCS,
  MST.OWRCOD
MSTOWRCOD,
  MST.STDWGT,
  MST.SCCCOD MSTSCCCOD,
  MST.ORGCOD MSTORGCOD,
  MST.DSTCOD MSTDSTCOD,
  RMPSHP.OUTCARCOD
RMPSHPOUTCARCOD,
  BKGFLTDTL.FLTCARCOD,
  BKGFLTDTL.FLTNUM,
  BKGFLTDTL.FLTDAT,
  BKGFLTDTL.fltorg,

BKGFLTDTL.FLTDST,
  SEGULDSHP.MFTPCS MFTPCS,
  SEGULDSHP.MFTWGT MFTWGT,
  arlmst.ISSPRTARL,
  (SELECT

CASE
      WHEN APHCODUSE=2
      THEN TWOAPHCOD
      WHEN APHCODUSE=3
      THEN THRAPHCOD
    END
OWNCARCOD
  FROM shrarlactmst arl
  WHERE arl.cmpcod=RMPULD.CMPCOD
  AND arl.ARLIDR  =syspar.parval

) OWNCARCOD
		FROM OPRRMPTRFULD RMPULD
INNER JOIN OPRRMPTRFSHP RMPSHP
ON RMPULD.CMPCOD        = RMPSHP.CMPCOD

AND RMPULD.ARPCOD = RMPSHP.ARPCOD

			AND RMPULD.INBFLTCARIDR = RMPSHP.INBFLTCARIDR

			AND RMPULD.INBFLTNUM
= RMPSHP.INBFLTNUM
AND RMPULD.INBFLTSEQNUM = RMPSHP.INBFLTSEQNUM
AND RMPULD.ULDNUM       = RMPSHP.ULDNUM
INNER
JOIN OPRSHPMST MST
ON MST.cmpcod           = RMPSHP.cmpcod
			AND MST.docowridr = RMPSHP.docowridr

AND MST.mstdocnum = RMPSHP.mstdocnum
AND MST.dupnum          = RMPSHP.dupnum
			AND MST.seqnum = RMPSHP.seqnum
INNER
JOIN OPRFLTSEG SEG
ON RMPULD.INBFLTCARIDR  = SEG.FLTCARIDR
AND RMPULD.INBFLTNUM    = SEG.FLTNUM
AND RMPULD.INBFLTSEQNUM
= SEG.FLTSEQNUM
AND RMPULD.CMPCOD       = SEG.CMPCOD
AND RMPULD.ARPCOD       = SEG.POU
INNER JOIN OPRSEGULDSHP
SEGULDSHP
ON RMPULD.CMPCOD        = SEGULDSHP.CMPCOD
AND RMPULD.INBFLTCARIDR = SEGULDSHP.FLTCARIDR
AND
RMPULD.INBFLTNUM    = SEGULDSHP.FLTNUM
AND RMPULD.INBFLTSEQNUM = SEGULDSHP.FLTSEQNUM
AND RMPULD.uldnum
= SEGULDSHP.uldnum
AND RMPSHP.docowridr    =SEGULDSHP.docowridr
AND RMPSHP.mstdocnum    =SEGULDSHP.mstdocnum
AND
RMPSHP.dupnum       =SEGULDSHP.dupnum
AND RMPSHP.seqnum       =SEGULDSHP.seqnum
LEFT OUTER JOIN CAPBKGMST
BKGMST
ON MST.CMPCOD     = BKGMST.CMPCOD
AND MST.MSTDOCNUM = BKGMST.MSTDOCNUM
AND MST.DOCOWRIDR = BKGMST.DOCOWRIDR
AND
MST.DUPNUM    = BKGMST.DUPNUM
AND MST.SEQNUM    = BKGMST.SEQNUM
LEFT OUTER JOIN CAPBKGFLTDTL BKGFLTDTL
ON
BKGMST.CMPCOD  = BKGFLTDTL.CMPCOD
AND BKGMST.UBRNUM = BKGFLTDTL.UBRNUM
AND seg.pou       =BKGFLTDTL.fltorg
LEFT
OUTER JOIN shrarlactmst arlmst
ON arlmst.CMPCOD  = BKGFLTDTL.CMPCOD
AND arlmst.ARLIDR = BKGFLTDTL.FLTCARIDR
INNER
JOIN shrsyspar syspar
ON syspar.cmpcod        =RMPULD.CMPCOD
AND syspar.parcod       ='logonattributes.ownairlineidentifier'

WHERE   RMPULD.CMPCOD = ?
AND RMPULD.ARPCOD       = ?
			AND RMPULD.INBFLTCARIDR = ?

			AND RMPULD.INBFLTNUM
= ?
			AND RMPULD.INBFLTSEQNUM = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>64</QRY:Id>
		<QRY:Source Name="operations.flthandling.findoffloaddetailsforenquiry" Type="NATIVE">
			<![CDATA[

					SELECT OFL.OFLPCS,
						   OFL.OFLRSN,
						   OFL.OFLWGT,
						   OFL.ULDNUM,
						   FLT.FLTNUM,
						   FLT.FLTCARCOD,
						   FLT.FLTDAT,
						   FLT.ARPCOD
					 FROM OPROFLDTL OFL,
						  OPRARPEXPFLT FLT
					WHERE OFL.FLTNUM = FLT.FLTNUM
						  AND OFL.FLTCARIDR = FLT.FLTCARIDR
						  AND OFL.FLTSEQNUM = FLT.FLTSEQNUM
						  AND OFL.CMPCOD = FLT.CMPCod
						  AND OFL.DOCOWRIDR = ?
						  AND OFL.MSTDOCNUM = ?
						  AND OFL.DUPNUM = ?
						  AND OFL.SEQNUM = ?
						  AND OFL.CMPCOD = ?


			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>65</QRY:Id>
		<QRY:Source Name="operations.flthandling.findloadplandetailsforenquiry" Type="NATIVE">
			<![CDATA[

						SELECT SEG.PLNPCS, SEG.PLNWGT, FLT.FLTNUM, FLT.FLTCARCOD,
					FLT.FLTDAT, FLT.ARPCOD,FLTSEG.POU,


FLTSEG.POL, FLTSEG.FLTSEQNUM
					FROM OPRARPEXPFLT FLT, OPRSEGSHP SEG, OPRFLTSEG FLTSEG
						 WHERE


SEG.FLTNUM = FLT.FLTNUM
						   AND SEG.FLTCARIDR = FLT.FLTCARIDR
						   AND SEG.FLTSEQNUM = FLT.FLTSEQNUM



						   AND SEG.CMPCOD = FLT.CMPCOD
					AND SEG.CMPCOD = FLTSEG.CMPCOD
					AND SEG.FLTCARIDR = FLTSEG.FLTCARIDR



					AND SEG.FLTNUM = FLTSEG.FLTNUM
					AND SEG.FLTSEQNUM = FLTSEG.FLTSEQNUM
					AND SEG.SEGSERNUM

= FLTSEG.SEGSERNUM

						   AND SEG.PLNPCS>0
						   AND SEG.DOCOWRIDR = ?
						   AND SEG.MSTDOCNUM

= ?
						   AND SEG.DUPNUM
= ?
						   AND SEG.SEQNUM = ?
   						   AND SEG.CMPCOD = ?



			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>66</QRY:Id>
		<QRY:Source Name="operations.flthandling.findflightdetailsforenquiry" Type="NATIVE">
			<![CDATA[


			SELECT SHP.BDPPCS BDPPCS, SHP.BDPWGT BDPWGT, SHP.MFTWGT MFTWGT,
			       SHP.MFTPCS MFTPCS, SHP.RCVPCS


RCVPCS, SHP.RCVWGT RCVWGT,
			       LEG.FLTNUM FLTNUM, 
				    CASE 
					  WHEN ARL.APHCODUSE=2
					  THEN ARL.TWOAPHCOD
					  ELSE ARL.THRAPHCOD
					  END FLTCARCOD,
					  SEG.POL POL, SEG.POU 


POU,
			       SHP.ULDNUM ULDNUM, POULEG.STA, LEG.STD,MST.FLTDAT
			  FROM FLTOPRLEG LEG, OPRSEGULDSHP

SHP,
OPRFLTSEG SEG, FLTOPRMST MST, SHRARLMST ARL,FLTOPRLEG POULEG
			 WHERE LEG.FLTNUM = MST.FLTNUM
			   AND LEG.FLTCARIDR


= MST.FLTCARIDR
			   AND LEG.FLTSEQNUM = MST.FLTSEQNUM
			   AND LEG.CMPCOD = MST.CMPCOD
			   AND

LEG.FLTNUM
= SEG.FLTNUM
			   AND LEG.FLTCARIDR = SEG.FLTCARIDR
			   AND LEG.FLTSEQNUM = SEG.FLTSEQNUM


			   AND
LEG.CMPCOD = SEG.CMPCOD
AND POULEG.FLTNUM  = MST.FLTNUM
AND POULEG.FLTCARIDR = MST.FLTCARIDR
AND POULEG.FLTSEQNUM = MST.FLTSEQNUM
AND POULEG.CMPCOD    = MST.CMPCOD
			   AND SEG.FLTNUM = SHP.FLTNUM
			   AND SEG.FLTCARIDR = SHP.FLTCARIDR



AND SEG.FLTSEQNUM = SHP.FLTSEQNUM
			   AND SEG.SEGSERNUM = SHP.SEGSERNUM
			   AND SEG.CMPCOD = SHP.CMPCOD



			   AND LEG.LEGORG = SEG.POL
			   AND POULEG.LEGDST    = SEG.POU
			   AND ARL.CMPCOD = MST.CMPCOD
			   AND ARL.ARLIDR = MST.FLTCARIDR



			   AND SHP.DOCOWRIDR = ?
			   AND SHP.MSTDOCNUM = ?
			   AND SHP.DUPNUM = ?
			   AND SHP.SEQNUM

= ?

			   AND SHP.CMPCOD = ?



			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>63</QRY:Id>
		<QRY:Source Name="operaions.flthandling.finduldsfromarp" Type="NATIVE">
			<![CDATA[
			SELECT ULD.CMPCOD, ULD.ARPCOD, ULD.DOCOWRIDR, ULD.MSTDOCNUM, ULD.DUPNUM, ULD.SEQNUM, ULD.ULDNUM ULDULDNUM,



			       ULD.NUMPCS, ULD.WGT, ULD.VOL, ARPULD.GRSWGT ULDGRSWGT, ARPULD.NETWGT ULDNETWGT,
   ARPULD.ULDCTR,

ARPULD.ULDBKGIDR, ARPULD.ALTIDR,  ARPULD.BUPFLG,  ARPULD.BKGTYP, ARPULD.BRWFLG,
			      NVL(ULDTYPMST.TAREWGT,0)

ULDTARWGT,
ULDTYPMST.ULDTYPCOD, MST.ORGCOD, MST.DSTCOD, MST.STDPCS, MST.STDWGT,
			       MST.STDWGTCOD,
MST.GRSVOL,
MST.SHPDES,
MST.SCCCOD, MST.SHPPFX
			  FROM OPRULDSHP ULD, OPRARPULD ARPULD, OPRSHPMST
MST, SHRULDTYPMST
ULDTYPMST

			 WHERE ARPULD.ULDNUM = ULD.ULDNUM
			   AND ARPULD.CMPCOD = ULD.CMPCOD

AND ARPULD.ARPCOD
= ULD.ARPCOD

			   AND MST.CMPCOD = ULD.CMPCOD
			   AND MST.MSTDOCNUM = ULD.MSTDOCNUM

AND
MST.DOCOWRIDR = ULD.DOCOWRIDR

			   AND MST.DUPNUM = ULD.DUPNUM
			   AND MST.SEQNUM = ULD.SEQNUM


			   AND ARPULD.CMPCOD = ULDTYPMST.CMPCOD(+)

   			   AND SUBSTR (ARPULD.ULDNUM, 0, 3) =
ULDTYPMST.ULDTYPCOD(+)

			   AND EXISTS (
              			 SELECT ULDNUM


                 			FROM OPRULDSHP
SHP
                				WHERE ARPULD.ULDNUM = SHP.ULDNUM

AND ARPULD.ARPCOD
= SHP.ARPCOD

                  				AND ARPULD.CMPCOD = SHP.CMPCOD

						AND SHP.MSTDOCNUM = ?

			 			AND SHP.DUPNUM = ?

			 			AND SHP.SEQNUM = ?

AND SHP.CMPCOD = ?
						AND SHP.DOCOWRIDR = ?

						AND SHP.ARPCOD = ?)

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>64</QRY:Id>
		<QRY:Source Name="operaions.flthandling.ctm.findonwardbookings" Type="NATIVE">
			<![CDATA[
SELECT
		 MST.CMPCOD SHPCMPCOD,
		MST.STDWGTCOD STDWGTCOD,MST.STDWGT STDWGT,MST.GRSVOLUNT STDVOLUNT,MST.GRSVOL


STDVOL,
		MST.STDPCS STDPCS,MST.SHPPFX,MST.SHPDES SHPDCL,MST.SCCCOD SCCCOD,
		MST.OWRCOD,MST.ORGCOD

ORGCOD,MST.DSTCOD
DSTCOD,MST.PLTFLG,
		MST.STDDISWGT DISSTDWGT,MST.GRSDISVOL DISSTDVOL,
		MST.STDWGTCOD

, ARP.RCVPCS ACTWGT,
MST.GRSVOLUNT ,
		ARP.RCVVOL ACTVOL, ARP.RCVPCS  ACTPCS, ARP.RCVWGT ACTDISWGT,

ARP.RCVVOL ACTDISVOL,

		MST.MSTDOCNUM, MST.DUPNUM, MST.SEQNUM, MST.DOCOWRIDR,DTL.PLTUSEFLG
		FROM

OPRSEGSHP SEGSHP,CAPBKGFLTDTL
FLT, OPRSHPMST MST,OPRSHPDTL DTL,CAPBKGMST BKGMST,
		OPRARPSHP ARP



		WHERE
		MST.MSTDOCNUm=segshp.MSTDOCNUM
AND
		MST.DOCOWRIDR=segshp.DOCOWRIDR AND
		MST.DUPNUM= segshp.DUPNUM

AND
		MST.CMPCOD=segshp.CMPCOD AND

		MST.SEQNUM=segshp.SEQNUM AND
		MST.MSTDOCNUm=DTL.MSTDOCNUM AND


		MST.DOCOWRIDR=DTL.DOCOWRIDR AND
		MST.DUPNUM=
DTL.DUPNUM AND
		MST.CMPCOD=DTL.CMPCOD AND
		MST.SEQNUM=DTL.SEQNUM

AND

		MST.MSTDOCNUm=segshp.MSTDOCNUM
AND
		MST.DOCOWRIDR=segshp.DOCOWRIDR AND
		MST.DUPNUM= segshp.DUPNUM

AND
		MST.CMPCOD=segshp.CMPCOD AND

		MST.SEQNUM=segshp.SEQNUM AND

		MST.MSTDOCNUm=bkgmst.MSTDOCNUM

AND
		MST.DOCOWRIDR=bkgmst.DOCOWRIDR AND

		MST.DUPNUM= bkgmst.DUPNUM AND
		MST.CMPCOD=bkgmst.CMPCOD

AND
		MST.SEQNUM=bkgmst.SEQNUM AND

		MST.MSTDOCNUm=arp.MSTDOCNUM
AND
		MST.DOCOWRIDR=arp.DOCOWRIDR

AND
		MST.DUPNUM= arp.DUPNUM AND
		MST.CMPCOD=arp.CMPCOD AND
		MST.SEQNUM=arp.SEQNUM
AND
		arp.arpcod=flt.fltorg

and

		flt.ubrnum=bkgmst.ubrnum AND
		flt.cmpcod=bkgmst.cmpcod AND
		ARP.avlpcs>0
and

		flt.FLTORG=?

and
		flt.cmpcod= ? and
		segshp.cmpcod=?





			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>65</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.finddwsuldandbuildupdetails" Type="NATIVE">
			<![CDATA[
					SELECT DWSULD.CMPCOD,
			  DWSULD.ARPCOD,
			  DWSULD.FLTCARIDR,
			  DWSULD.FLTNUM,
			  DWSULD.FLTSEQNUM,

DWSULD.LEGSERNUM,
			  DWSULD.ULDNUM,
			  DWSULD.POU,
			  'U' AS BARROWFLG,
			  DWSULD.DSTCOD,

DWSULD.MFTWGT,
			  DWSULD.ULDCTR,
			  DWSULD.TARWGT,
			  CASE
			  WHEN (SEGULD.ULDNUM IS NULL AND
MTKULD.ULDNUM IS NOT NULL)
			  THEN MTKULD.BAGWGT
			  WHEN SEGULD.ULDNUM IS NOT NULL
			  THEN SEGULD.NETWGT

ELSE DWSULD.NETWGT
			  END NETWGT,
			  CASE
			  WHEN (SEGULD.ULDNUM IS NULL AND MTKULD.ULDNUM IS
NOT NULL)
			  THEN NVL(MTKULD.BAGWGT,0) + NVL(DWSULD.TARWGT,0)
			  WHEN SEGULD.ULDNUM IS NOT NULL

THEN NVL(SEGULD.NETWGT,0) + NVL(DWSULD.TARWGT,0)
			  ELSE DWSULD.GRSWGT
			  END GRSWGT,
			  DWSULD.ACTWGT,

			  CASE
					WHEN DWSULD.BLTUSR IS NOT NULL
					THEN DWSULD.BLTUSR
					WHEN ULDTAG.DLCCOD IS NOT NULL
					THEN ULDTAG.DLCCOD
					WHEN SEGULD.LSTUPDUSR IS NOT NULL
			   THEN SEGULD.LSTUPDUSR
			  END BLTUSR,
			  SEGULD.ACTWGT SEGULDACTWGT,
			  SEGULD.ULDBDPTIM BLTDAT,
			  DWSULD.BLKRMK,
			  DWSULD.RECUPD,

DWSULD.BASPLTFLG AS BSEFLG,
			  DWSULD.BASPLTULD AS BSEPLT,
			  DWSULD.ULDBKGIDR,
			  FLTSEG.SEGSERNUM,

DWSULD.ULDOCP,
			  ULDTAG.ULDTAGPTRFLG,
			  ULDTAG.ULDTAGPTRUSR,
			  ULDTAG.ULDTAGPTRDAT,
			  ULDTAG.TAGRMK,

SEGULD.ULDNUM AS MFTULD,
			  CASE
				WHEN SEGULD.BSEFLG = 'Y'
			    THEN 'S'
          WHEN ((SEGULD.ULDNUM       IS NOT NULL
          AND NVL(SEGULD.CONIDR,'C') <>'E'
          AND SEGULD.NETWGT           > 0)
    AND (MTKULD.ULDNUM   IS NOT NULL
AND MTKULD.BAGWGT > 0) )
          THEN 'CM'
			    WHEN DWSULD.NETWGT = 0
			    THEN 'X'
          WHEN (SEGULD.ULDNUM        IS NOT NULL
          AND NVL(SEGULD.CONIDR,'C') <>'E'
          AND SEGULD.NETWGT           > 0 )
				THEN 'C'
          WHEN (MTKULD.ULDNUM IS NOT NULL
		AND MTKULD.BAGWGT    > 0)
			    

THEN 'M'
				WHEN DWSULD.NETWGT = 0
				THEN 'X'
				ELSE 'C'
				END LODCTG,
			  (SELECT ULDWGTDTL.WGTTIM

FROM OPRULDWGTDTL ULDWGTDTL
			  WHERE DWSULD.CMPCOD  = ULDWGTDTL.CMPCOD
			  AND DWSULD.ARPCOD    =
ULDWGTDTL.ARPCOD
			  AND DWSULD.ULDNUM    = ULDWGTDTL.ULDNUM
			  AND DWSULD.FLTCARIDR = ULDWGTDTL.FLTCARIDR

AND DWSULD.FLTNUM    = ULDWGTDTL.FLTNUM
			  AND DWSULD.FLTSEQNUM = ULDWGTDTL.FLTSEQNUM
			  AND DWSULD.LEGSERNUM
= ULDWGTDTL.LEGSERNUM
			  AND ULDWGTDTL.SERNUM =
				(SELECT MAX(SERNUM)
				FROM OPRULDWGTDTL DTL

WHERE DTL.CMPCOD     = DWSULD.CMPCOD
				AND DTL.ARPCOD       = DWSULD.ARPCOD
				AND DTL.ULDNUM
= DWSULD.ULDNUM
				AND DTL.FLTCARIDR(+) = DWSULD.FLTCARIDR
				AND DTL.FLTNUM(+)    = DWSULD.FLTNUM

AND DTL.FLTSEQNUM(+) = DWSULD.FLTSEQNUM
				)
  )WGTTIM,
  (SELECT ULDWGTDTL.SCLNAM
  FROM OPRULDWGTDTL ULDWGTDTL
  WHERE DWSULD.CMPCOD  = ULDWGTDTL.CMPCOD
  AND DWSULD.ARPCOD    = ULDWGTDTL.ARPCOD
  AND DWSULD.ULDNUM    = ULDWGTDTL.ULDNUM
  AND DWSULD.FLTCARIDR = ULDWGTDTL.FLTCARIDR
  AND DWSULD.FLTNUM    = ULDWGTDTL.FLTNUM
  AND DWSULD.FLTSEQNUM = ULDWGTDTL.FLTSEQNUM
  AND DWSULD.LEGSERNUM = ULDWGTDTL.LEGSERNUM
  AND ULDWGTDTL.SERNUM =
    (SELECT MAX(SERNUM)
    FROM OPRULDWGTDTL DTL
    WHERE DTL.CMPCOD     = DWSULD.CMPCOD
    AND DTL.ARPCOD       = DWSULD.ARPCOD
    AND DTL.ULDNUM       = DWSULD.ULDNUM
    AND DTL.FLTCARIDR(+) = DWSULD.FLTCARIDR
    AND DTL.FLTNUM(+)    = DWSULD.FLTNUM
    AND DTL.FLTSEQNUM(+) = DWSULD.FLTSEQNUM
    )
  )SCLNAM,
   DWSULD.DCSTRAFLG
			FROM OPRDWSULD DWSULD
			LEFT OUTER JOIN
OPRFLTSEG FLTSEG
			ON DWSULD.CMPCOD     = FLTSEG.CMPCOD
			AND DWSULD.FLTCARIDR = FLTSEG.FLTCARIDR

AND DWSULD.FLTNUM = FLTSEG.FLTNUM
			AND DWSULD.FLTSEQNUM =FLTSEG.FLTSEQNUM
			AND DWSULD.ARPCOD    =
FLTSEG.POL
			AND DWSULD.POU       = FLTSEG.POU
			LEFT OUTER JOIN OPRSEGULD SEGULD
ON DWSULD.CMPCOD
= SEGULD.CMPCOD

			AND DWSULD.FLTCARIDR = SEGULD.FLTCARIDR
			AND DWSULD.FLTNUM = SEGULD.FLTNUM
AND
DWSULD.FLTSEQNUM = SEGULD.FLTSEQNUM
			AND DWSULD.ULDNUM    = SEGULD.ULDNUM
			LEFT OUTER JOIN OPRULDTAG
ULDTAG
			ON DWSULD.CMPCOD     = ULDTAG.CMPCOD
			AND DWSULD.FLTCARIDR = ULDTAG.FLTCARIDR
			AND DWSULD.FLTNUM
= ULDTAG.FLTNUM
			AND DWSULD.FLTSEQNUM = ULDTAG.FLTSEQNUM
			AND DWSULD.ULDNUM    = ULDTAG.ULDNUM
 LEFT
OUTER JOIN MALULDSEG MTKULD
 ON DWSULD.CMPCOD     = MTKULD.CMPCOD
 AND DWSULD.FLTCARIDR = MTKULD.FLTCARIDR

AND DWSULD.FLTNUM    = MTKULD.FLTNUM
 AND DWSULD.FLTSEQNUM = MTKULD.FLTSEQNUM
 AND DWSULD.ULDNUM    =
MTKULD.ULDNUM
			WHERE DWSULD.CMPCOD  = ?
			AND DWSULD.FLTCARIDR = ?
			AND DWSULD.FLTNUM = ?
			AND
DWSULD.FLTSEQNUM = ?
			AND DWSULD.ARPCOD    = ?
		UNION ALL
			SELECT SEGULD.CMPCOD,
			  EXPFLT.ARPCOD,

EXPFLT.FLTCARIDR,
EXPFLT.FLTNUM,
		       EXPFLT.FLTSEQNUM,
			  EXPFLT.LEGSERNUM,
			  SEGULD.ULDNUM,

FLTSEG.POU,
			  COALESCE(SEGULD.BARROWFLG, 'N') BARROWFLG ,
			  SEGULD.ULDDST,
			  0 AS MFTWGT,

SEGULD.ULDCTR,
			  SEGULD.TARWGT,
			  SEGULD.NETWGT,
			  SEGULD.GRSWGT,
			  SEGULD.ACTWGT,
			  CASE
				WHEN ULDTAG.DLCCOD IS NOT NULL
				THEN ULDTAG.DLCCOD
				WHEN SEGULD.LSTUPDUSR IS NOT NULL
				THEN NULL
  END AS BLTUSR,
			  SEGULD.ACTWGT SEGULDACTWGT,
			  NULL AS BLTDAT,
			  NULL AS BLKRMK,
			  NULL AS RECUPD,

SEGULD.BSEFLG,
			  SEGULD.BSEPLT,
			  SEGULD.ULDBKGIDR,
			  FLTSEG.SEGSERNUM,
			  SEGULD.ULDOCP,

ULDTAG.ULDTAGPTRFLG,
			  ULDTAG.ULDTAGPTRUSR,
			  ULDTAG.ULDTAGPTRDAT,
			  ULDTAG.TAGRMK,
  SEGULD.ULDNUM AS MFTULD,
			  CASE
     WHEN SEGULD.BSEFLG ='Y'
     THEN 'S'
     WHEN SEGULD.NETWGT =0
     THEN
'X'
     ELSE 'C'
				END LODCTG,
			  (SELECT ULDWGTDTL.WGTTIM
			  FROM OPRULDWGTDTL ULDWGTDTL

WHERE FLTSEG.CMPCOD  = ULDWGTDTL.CMPCOD
			  AND SEGULD.ULDNUM    = ULDWGTDTL.ULDNUM
			  AND FLTSEG.FLTCARIDR
= ULDWGTDTL.FLTCARIDR
			  AND FLTSEG.FLTNUM    = ULDWGTDTL.FLTNUM
			  AND FLTSEG.FLTSEQNUM = ULDWGTDTL.FLTSEQNUM

AND FLTSEG.POL       = ULDWGTDTL.ARPCOD
			  AND ULDWGTDTL.SERNUM =
				(SELECT MAX(SERNUM)
				FROM
OPRULDWGTDTL DTL
				WHERE DTL.CMPCOD     = FLTSEG.CMPCOD
				AND DTL.ARPCOD       = FLTSEG.POL
				AND
DTL.ULDNUM       = SEGULD.ULDNUM
				AND DTL.FLTCARIDR(+) = FLTSEG.FLTCARIDR
				AND DTL.FLTNUM(+)
= FLTSEG.FLTNUM
				AND DTL.FLTSEQNUM(+) = FLTSEG.FLTSEQNUM
				)
  )WGTTIM,
  (SELECT ULDWGTDTL.SCLNAM
  FROM OPRULDWGTDTL ULDWGTDTL
  WHERE FLTSEG.CMPCOD  = ULDWGTDTL.CMPCOD
  AND SEGULD.ULDNUM    = ULDWGTDTL.ULDNUM
  AND FLTSEG.FLTCARIDR = ULDWGTDTL.FLTCARIDR
  AND FLTSEG.FLTNUM    = ULDWGTDTL.FLTNUM
  AND FLTSEG.FLTSEQNUM = ULDWGTDTL.FLTSEQNUM
  AND FLTSEG.POL       = ULDWGTDTL.ARPCOD
  AND ULDWGTDTL.SERNUM =
    (SELECT MAX(SERNUM)
    FROM OPRULDWGTDTL DTL
    WHERE DTL.CMPCOD     = FLTSEG.CMPCOD
    AND DTL.ARPCOD       = FLTSEG.POL
    AND DTL.ULDNUM       = SEGULD.ULDNUM
    AND DTL.FLTCARIDR(+) = FLTSEG.FLTCARIDR
    AND DTL.FLTNUM(+)    = FLTSEG.FLTNUM
    AND DTL.FLTSEQNUM(+) = FLTSEG.FLTSEQNUM
    )
  )SCLNAM,
   NULL AS  DCSTRAFLG
			FROM OPRFLTSEG FLTSEG

INNER JOIN OPRSEGULD SEGULD
			ON FLTSEG.CMPCOD     = SEGULD.CMPCOD
			AND FLTSEG.FLTCARIDR = SEGULD.FLTCARIDR

AND FLTSEG.FLTNUM    = SEGULD.FLTNUM
			AND FLTSEG.FLTSEQNUM = SEGULD.FLTSEQNUM
			AND FLTSEG.SEGSERNUM
= SEGULD.SEGSERNUM
			INNER JOIN OPRARPEXPFLT EXPFLT
			ON FLTSEG.CMPCOD     = EXPFLT.CMPCOD

AND
FLTSEG.FLTCARIDR = EXPFLT.FLTCARIDR
			AND FLTSEG.FLTNUM    = EXPFLT.FLTNUM
			AND FLTSEG.FLTSEQNUM =
EXPFLT.FLTSEQNUM
			AND FLTSEG.POL       = EXPFLT.ARPCOD
			LEFT OUTER JOIN OPRULDTAG ULDTAG
			ON SEGULD.CMPCOD
= ULDTAG.CMPCOD
			AND SEGULD.FLTCARIDR = ULDTAG.FLTCARIDR
			AND SEGULD.FLTNUM    = ULDTAG.FLTNUM

AND SEGULD.FLTSEQNUM = ULDTAG.FLTSEQNUM
			AND SEGULD.SEGSERNUM = ULDTAG.SEGSERNUM
			AND SEGULD.ULDNUM
= ULDTAG.ULDNUM
			WHERE SEGULD.ULDNUM <> 'BULK'
			AND FLTSEG.CMPCOD    = ?
			AND FLTSEG.FLTCARIDR
= ?
			AND FLTSEG.FLTNUM    = ?
			AND FLTSEG.FLTSEQNUM = ?
			AND FLTSEG.POL       = ?
			AND NOT EXISTS

(SELECT 1
			  FROM OPRDWSULD DWSULD
			  WHERE SEGULD.CMPCOD  = DWSULD.CMPCOD

				AND SEGULD.FLTCARIDR
= DWSULD.FLTCARIDR
			  AND SEGULD.FLTNUM    = DWSULD.FLTNUM
			  AND SEGULD.FLTSEQNUM = DWSULD.FLTSEQNUM

AND FLTSEG.POL       = DWSULD.ARPCOD
			  AND SEGULD.ULDNUM    = DWSULD.ULDNUM
			  )

		UNION ALL

SELECT MTKULD.CMPCOD,
			  MTKFLT.ARPCOD,
			  MTKFLT.FLTCARIDR,
			  MTKFLT.FLTNUM,
			  MTKFLT.FLTSEQNUM,

MTKFLT.LEGSERNUM,
			  MTKULD.ULDNUM,
			  FLTSEG.POU,
			  'N'  AS BARROWFLG,
			  NULL AS ULDDST,

0    AS MFTWGT,
			  NULL AS ULDCTR,
   COALESCE(ULD.TARWGT,ULDTYP.TAREWGT,0),
			  MTKULD.BAGWGT,

(COALESCE(ULD.TARWGT,ULDTYP.TAREWGT,0)+ MTKULD.BAGWGT) AS GRSWGT,
			  0    AS ACTWGT,
			  CASE
				WHEN ULDTAG.DLCCOD IS NOT NULL
				THEN ULDTAG.DLCCOD
				ELSE NULL
  END  AS BLTUSR,

NULL AS SEGULDACTWGT,
			  NULL AS BLTDAT,
			  NULL AS BLKRMK,
			  NULL AS RECUPD,
			  NULL AS BSEFLG,

NULL AS BSEPLT,
			  NULL AS ULDBKGIDR,
			  FLTSEG.SEGSERNUM,
			  NULL AS ULDOCP,
			  ULDTAG.ULDTAGPTRFLG,

ULDTAG.ULDTAGPTRUSR,
			  ULDTAG.ULDTAGPTRDAT,
			  ULDTAG.TAGRMK,
			    NULL AS MFTULD,
   CASE

WHEN MTKULD.BAGWGT = 0
     THEN 'X'
     ELSE 'M'
   END LODCTG,
			  (SELECT ULDWGTDTL.WGTTIM

FROM OPRULDWGTDTL ULDWGTDTL
			  WHERE FLTSEG.CMPCOD  = ULDWGTDTL.CMPCOD
			  AND MTKULD.ULDNUM    =
ULDWGTDTL.ULDNUM
			  AND FLTSEG.FLTCARIDR = ULDWGTDTL.FLTCARIDR
			  AND FLTSEG.FLTNUM    = ULDWGTDTL.FLTNUM

AND FLTSEG.FLTSEQNUM = ULDWGTDTL.FLTSEQNUM
			  AND FLTSEG.POL       = ULDWGTDTL.ARPCOD
			  AND ULDWGTDTL.SERNUM
=
				(SELECT MAX(SERNUM)
				FROM OPRULDWGTDTL DTL
				WHERE DTL.CMPCOD     = FLTSEG.CMPCOD
				AND
DTL.ARPCOD       = FLTSEG.POL
				AND DTL.ULDNUM       = MTKULD.ULDNUM
				AND DTL.FLTCARIDR(+) = FLTSEG.FLTCARIDR

AND DTL.FLTNUM(+)    = FLTSEG.FLTNUM
				AND DTL.FLTSEQNUM(+) = FLTSEG.FLTSEQNUM
				)
  )WGTTIM,
   (SELECT ULDWGTDTL.SCLNAM
  FROM OPRULDWGTDTL ULDWGTDTL
  WHERE FLTSEG.CMPCOD  = ULDWGTDTL.CMPCOD
  AND MTKULD.ULDNUM    = ULDWGTDTL.ULDNUM
  AND FLTSEG.FLTCARIDR = ULDWGTDTL.FLTCARIDR
  AND FLTSEG.FLTNUM    = ULDWGTDTL.FLTNUM
  AND FLTSEG.FLTSEQNUM = ULDWGTDTL.FLTSEQNUM
  AND FLTSEG.POL       = ULDWGTDTL.ARPCOD
  AND ULDWGTDTL.SERNUM =
    (SELECT MAX(SERNUM)
    FROM OPRULDWGTDTL DTL
    WHERE DTL.CMPCOD     = FLTSEG.CMPCOD
    AND DTL.ARPCOD       = FLTSEG.POL
    AND DTL.ULDNUM       = MTKULD.ULDNUM
    AND DTL.FLTCARIDR(+) = FLTSEG.FLTCARIDR
    AND DTL.FLTNUM(+)    = FLTSEG.FLTNUM
    AND DTL.FLTSEQNUM(+) = FLTSEG.FLTSEQNUM
    )
  )SCLNAM,
   NULL AS  DCSTRAFLG
FROM MALFLTSEG FLTSEG
			INNER JOIN MALULDSEG MTKULD
			ON FLTSEG.FLTCARIDR  = MTKULD.FLTCARIDR

AND FLTSEG.FLTNUM = MTKULD.FLTNUM
			AND FLTSEG.FLTSEQNUM = MTKULD.FLTSEQNUM
			AND FLTSEG.SEGSERNUM
= MTKULD.SEGSERNUM
			INNER JOIN MALFLT MTKFLT
			ON FLTSEG.CMPCOD     = MTKFLT.CMPCOD
			AND FLTSEG.FLTCARIDR
= MTKFLT.FLTCARIDR
			AND FLTSEG.FLTNUM    = MTKFLT.FLTNUM

			AND FLTSEG.FLTSEQNUM = MTKFLT.FLTSEQNUM

AND FLTSEG.POL       = MTKFLT.ARPCOD
			LEFT OUTER JOIN OPRULDTAG ULDTAG
			ON FLTSEG.CMPCOD     = ULDTAG.CMPCOD

AND FLTSEG.FLTCARIDR = ULDTAG.FLTCARIDR
			AND FLTSEG.FLTNUM    = ULDTAG.FLTNUM
			AND FLTSEG.FLTSEQNUM
= ULDTAG.FLTSEQNUM
			AND FLTSEG.SEGSERNUM = ULDTAG.SEGSERNUM
			AND MTKULD.ULDNUM    = ULDTAG.ULDNUM

LEFT OUTER JOIN ULDMST ULD
 ON MTKULD.CMPCOD     = ULD.CMPCOD
 AND MTKULD.ULDNUM    = ULD.ULDNUM
 LEFT
OUTER JOIN SHRULDTYPMST ULDTYP
 ON MTKULD.CMPCOD     = ULDTYP.CMPCOD
 AND SUBSTR(MTKULD.ULDNUM,1,3)
= ULDTYP.ULDTYPCOD
			WHERE MTKULD.ULDNUM NOT LIKE 'BULK%'
			AND FLTSEG.CMPCOD    = ?
			AND FLTSEG.FLTCARIDR
= ?
			AND FLTSEG.FLTNUM    = ?
			AND FLTSEG.FLTSEQNUM = ?
			AND FLTSEG.POL       = ?
			AND NOT EXISTS

(SELECT 1
			  FROM OPRDWSULD DWSULD
			  WHERE MTKULD.CMPCOD  = DWSULD.CMPCOD
				AND MTKULD.FLTCARIDR
= DWSULD.FLTCARIDR
			  AND MTKULD.FLTNUM    = DWSULD.FLTNUM
			  AND MTKULD.FLTSEQNUM = DWSULD.FLTSEQNUM

AND FLTSEG.POL       = DWSULD.ARPCOD
			  AND MTKULD.ULDNUM    = DWSULD.ULDNUM
			  )


		ORDER BY BSEPLT DESC, SEGSERNUM ,ULDNUM
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>66</QRY:Id>
		<QRY:Source Name="operaions.flthandling.findawbdetailsforhht" Type="NATIVE">
			<![CDATA[
		SELECT ULD.CMPCOD,SEGSHP.MSTDOCNUM, SEGSHP.DOCOWRIDR,
		   ( CASE WHEN SEGSHP.MFTPCS > 0 THEN SEGSHP.MFTPCS


ELSE
		   (
		   ( CASE WHEN SEGSHP.BDPPCS > 0 THEN SEGSHP.BDPPCS ELSE
		   SEGSHP.RCVPCS END  )



		   ) END  ) PCS,
		   ( CASE WHEN SEGSHP.MFTWGT > 0 THEN SEGSHP.MFTWGT ELSE
		   (
		   ( CASE WHEN

SEGSHP.BDPWGT
> 0 THEN SEGSHP.BDPWGT ELSE
		   SEGSHP.RCVWGT END  )
		   ) END  ) WGT,
		   FLTSEG.POU,

FLTSEG.POL,SHPMST.SCCCOD,
SHPMST.ORGCOD, SHPMST.DSTCOD, SHPMST.SHPPFX
		  FROM OPRSEGULD ULD, OPRSEGULDSHP

SEGSHP, OPRFLTSEG FLTSEG,
OPRSHPMST SHPMST
		   WHERE ULD.CMPCOD = FLTSEG.CMPCOD
		   AND ULD.FLTCARIDR

= FLTSEG.FLTCARIDR

AND ULD.FLTNUM = FLTSEG.FLTNUM
		   AND ULD.FLTSEQNUM = FLTSEG.FLTSEQNUM


		   AND ULD.SEGSERNUM = FLTSEG.SEGSERNUM

		   AND ULD.CMPCOD = SEGSHP.CMPCOD
		   AND ULD.FLTCARIDR

= SEGSHP.FLTCARIDR
		   AND ULD.FLTNUM = SEGSHP.FLTNUM

		   AND ULD.FLTSEQNUM = SEGSHP.FLTSEQNUM


		   AND ULD.SEGSERNUM = SEGSHP.SEGSERNUM
		   AND ULD.ULDNUM =
SEGSHP.ULDNUM
		   AND SEGSHP.CMPCOD
= SHPMST.CMPCOD

		   AND SEGSHP.DOCOWRIDR = SHPMST.DOCOWRIDR

AND SEGSHP.MSTDOCNUM = SHPMST.MSTDOCNUM

AND SEGSHP.DUPNUM
= SHPMST.DUPNUM
		   AND SEGSHP.SEQNUM
= SHPMST.SEQNUM
		   AND ULD.FLTCARIDR = ?

AND ULD.FLTNUM
= ?
		   AND ULD.CMPCOD = ?
		   AND ULD.ULDNUM = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>67</QRY:Id>
		<QRY:Source Name="operaions.flthandling.finduldarrivaldetails" Type="NATIVE">
			<![CDATA[
	SELECT   ULD.CMPCOD ULDCMPCOD, ULD.FLTCARIDR ULDFLTCARIDR, ULD.CONIDR ULDCONIDR,
		 ULD.FLTNUM ULDFLTNUM,


ULD.FLTSEQNUM ULDFLTSEQNUM,ULD.RCVFLG ULDRCVFLG,
		 ULD.SEGSERNUM ULDSEGSERNUM, ULD.ULDOCP ULDULDOCP,



ULD.ULDDST ULDULDDST, ULD.ULDNUM ULDULDNUM, ULD.GRSWGT, ULD.NETWGT,
		 ULD.THRUNT, ULD.ULDCTR, ULD.TARWGT,
ULD.ACTWGT,

SHP.CUSREF SHPCUSREF,
		 SHP.MFTPCS SHPPCS, SHP.MFTWGT SHPWGT, SHP.MFTVOL SHPVOL,
		 SHP.FLTCARIDR
SHPFLTCARIDR,

SHP.FLTNUM SHPFLTNUM,
	       SHP.FLTSEQNUM SHPFLTSEQNUM, SHP.SEGSERNUM SHPSEGSERNUM,

SHP.ULDNUM

SHPULDNUM, SHP.DOCOWRIDR SHPDOCOWRIDR,
		 SHP.MSTDOCNUM SHPMSTDOCNUM, SHP.DUPNUM SHPDUPNUM,

SHP.SEQNUM

SHPSEQNUM, SHP.RMK SHPRMK, SHP.CMPCOD SHPCMPCOD,
		 SHP.LODPRT, MST.SCCCOD MSTSCCCOD, SHP.RCVPCS
SHPRCVPCS,


SHP.RCVWGT SHPRCVWGT, SHP.RCVVOL SHPRCVVOL, MST.SHPDES MSTSHPDES,
		 MST.ORGCOD MSTORGCOD,
MST.DSTCOD

MSTDSTCOD,
	       MST.STDWGTCOD MSTSTDWGTCOD, MST.STDDISWGT MSTSTDDISWGT, MST.CONFLG,

MST.DTACPTFLG,

MST.PRDNAM MSTPRDNAM, MST.PRDPRT MSTPRDPRT,
		 MST.SHPPFX, MST.STDPCS, MST.OWRCOD MSTOWRCOD,
MST.STDWGT,

MST.GRSVOL,MST.UBRNUM,
		 SEG.CMPCOD SEGCMPCOD, SEG.FLTCARIDR SEGFLTCARIDR,
		 SEG.FLTNUM
SEGFLTNUM,
SEG.FLTSEQNUM
SEGFLTSEQNUM, SEG.POL SEGPOL,
		 SEG.POU SEGPOU, SEG.SEGSERNUM SEGSEGSERNUM,
SEGSHP.PLNVOL,

SEGSHP.MFTPCS
SEGSHPMFTPCS, SEGSHP.MFTWGT SEGSHPMFTWGT,
		 SEGSHP.MFTVOL SEGSHPMFTVOL,
ARPSHP.DOCRCVFLG,ARPSHP.AVLPCS,

SEGSHP.RCVPCS
SEGSHPRCVPCS, SEGSHP.RCVWGT SEGSHPRCVWGT,
		 TRU.SERNUM
TRUSERNUM, TRU.SEGSERNUM TRUSEGSERNUM,

TRU.FLTSEQNUM
TRUFLTSEQNUM, TRU.FLTNUM TRUFLTNUM,
		 TRU.FLTCARIDR
TRUFLTCARIDR, TRU.CMPCOD TRUCMPCOD,

TRU.ULDNUM
TRUULDNUM, TRU.THRCARIDR TRUTHRCARIDR,
		 TRU.THRCARCOD
TRUTHRCARCOD, TRU.THRFLTNUM TRUTHRFLTNUM,


		 TRU.THRFLTDAT TRUTHRFLTDAT, TRU.THRDSTCOD TRUTHRDSTCOD,

ARPSHP.CUSCLRREQFLG,ARPSHP.SECCLRREQFLG,


ULD.LSTUPDTIM ULDLSTUPDTIM, ULD.LSTUPDUSR ULDLSTUPDUSR,

SEGSHP.LSTUPDTIM SEGSHPLSTUPDTIM, SEGSHP.LSTUPDUSR

SEGSHPLSTUPDUSR,
		 ARPSHP.LSTUPDTIM ARPSHPLSTUPDTIM,
ARPSHP.LSTUPDUSR ARPSHPLSTUPDUSR,
		 TRU.LSTUPDTIM

TRULSTUPDTIM, TRU.LSTUPDUSR TRULSTUPDUSR, MST.RDYCRGFLG, ARPSHP.PLTUSEFLG,SHPDTL.PLTUSEFLG AS SHPPLTUSEFLG, MST.PLTFLG
	  FROM
OPRSEGULD ULD,
	       OPRSEGULDSHP SHP,
	       OPRSHPMST

MST,
	       OPRFLTSEG SEG,
	       OPRSEGSHP
SEGSHP,
	       OPRARPSHP ARPSHP,
		   OPRULDTHRRTG TRU,OPRSHPDTL SHPDTL


	 WHERE ULD.FLTCARIDR = SHP.FLTCARIDR(+)

AND ULD.FLTNUM = SHP.FLTNUM(+)
	   AND ULD.FLTSEQNUM =
SHP.FLTSEQNUM(+)

	   AND ULD.SEGSERNUM =
SHP.SEGSERNUM(+)
	   AND ULD.CMPCOD = SHP.CMPCOD(+)

AND ULD.ULDNUM = SHP.ULDNUM(+)

	   AND
ULD.FLTCARIDR = TRU.FLTCARIDR(+)
	   AND ULD.FLTNUM = TRU.FLTNUM(+)

AND ULD.FLTSEQNUM = TRU.FLTSEQNUM(+)


	   AND ULD.SEGSERNUM = TRU.SEGSERNUM(+)
	   AND ULD.CMPCOD
= TRU.CMPCOD(+)
	   AND ULD.ULDNUM = TRU.ULDNUM(+)


	   AND ULD.FLTCARIDR = SEG.FLTCARIDR(+)

AND ULD.FLTNUM = SEG.FLTNUM(+)
	   AND ULD.FLTSEQNUM =
SEG.FLTSEQNUM(+)

	   AND ULD.SEGSERNUM =
SEG.SEGSERNUM(+)
	   AND ULD.CMPCOD = SEG.CMPCOD(+)

AND SHP.DOCOWRIDR = MST.DOCOWRIDR(+)


AND SHP.MSTDOCNUM = MST.MSTDOCNUM(+)
	   AND SHP.DUPNUM
= MST.DUPNUM(+)
	   AND SHP.SEQNUM = MST.SEQNUM(+)


	   AND SHP.CMPCOD = MST.CMPCOD(+)
	   AND SHP.DOCOWRIDR
= SEGSHP.DOCOWRIDR(+)
	   AND SHP.MSTDOCNUM
= SEGSHP.MSTDOCNUM(+)

	   AND SHP.DUPNUM = SEGSHP.DUPNUM(+)

AND SHP.SEQNUM = SEGSHP.SEQNUM(+)

AND SHP.CMPCOD = SEGSHP.CMPCOD(+)

	   AND SHP.FLTCARIDR =
SEGSHP.FLTCARIDR(+)
	   AND SHP.FLTNUM
= SEGSHP.FLTNUM(+)
	   AND SHP.FLTSEQNUM =
SEGSHP.FLTSEQNUM(+)

AND SHP.SEGSERNUM = SEGSHP.SEGSERNUM(+)

	   AND SEGSHP.DOCOWRIDR = ARPSHP.DOCOWRIDR(+)

AND
SEGSHP.MSTDOCNUM = ARPSHP.MSTDOCNUM(+)
	   AND SEGSHP.DUPNUM
= ARPSHP.DUPNUM(+)
	   AND SEGSHP.SEQNUM

= ARPSHP.SEQNUM(+)
	   AND SEGSHP.CMPCOD = ARPSHP.CMPCOD(+)
	   AND SEGSHP.DOCOWRIDR = SHPDTL.DOCOWRIDR(+)
AND SEGSHP.MSTDOCNUM = SHPDTL.MSTDOCNUM(+)
AND SEGSHP.DUPNUM    = SHPDTL.DUPNUM(+)
AND SEGSHP.SEQNUM    = SHPDTL.SEQNUM(+)
AND SEGSHP.CMPCOD    = SHPDTL.CMPCOD(+)

AND ULD.FLTCARIDR = ?
	   AND ULD.FLTNUM

= ?
	   AND ULD.FLTSEQNUM = ?
	   AND ULD.CMPCOD = ?

   	   AND SEG.POU = ?
   	   AND ARPSHP.ARPCOD(+) = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>68</QRY:Id>
		<QRY:Source Name="operations.flthandling.findmanifesteddtlsforhht" Type="NATIVE">
			<![CDATA[
		SELECT ( CASE WHEN ARLMST.APHCODUSE = 2 THEN ARLMST.TWOAPHCOD ELSE
		ARLMST.THRAPHCOD END) FLTCARCOD ,
        FLTSEG.FLTCARIDR ,FLTSEG.FLTNUM,FLTSEG.FLTSEQNUM ,FLTSEG.SEGSERNUM,
        FLTSEG.POU,EXPFLT.FLTDAT,EXPFLT.LEGSERNUM

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>178</QRY:Id>
		<QRY:Source Name="operations.shipment.findflightsforshipment" Type="NATIVE">
			<![CDATA[
		SELECT FLTOWN as FLTCARCOD, LEGSERNUM, LEG.FLTSEQNUM, LEG.FLTNUM, LEG.FLTCARIDR,
		       LEG.CMPCOD,


LEGORG, LEGDST, STA, STD,FLTMST.FLTDAT,
			  SEGSHP.MFTPCS, SEGSHP.MFTWGT, SEGSHP.RCVPCS, SEGSHP.RCVWGT



		  FROM FLTOPRMST FLTMST, FLTOPRLEG LEG, OPRSEGSHP SEGSHP
		 WHERE FLTMST.FLTNUM = LEG.FLTNUM


		   AND FLTMST.FLTCARIDR
= LEG.FLTCARIDR
		   AND FLTMST.CMPCOD = LEG.CMPCOD
		   AND FLTMST.FLTSEQNUM
=
LEG.FLTSEQNUM
		   AND
FLTMST.FLTNUM = SEGSHP.FLTNUM
		   AND FLTMST.FLTCARIDR = SEGSHP.FLTCARIDR


		   AND FLTMST.CMPCOD = SEGSHP.CMPCOD

		   AND FLTMST.FLTSEQNUM = SEGSHP.FLTSEQNUM
		   AND SEGSHP.CMPCOD

= ?
		   AND SEGSHP.DOCOWRIDR = ?

		   AND SEGSHP.MSTDOCNUM = ?
		   AND SEGSHP.DUPNUM = ?


		   AND SEGSHP.SEQNUM = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>179</QRY:Id>
		<QRY:Source Name="operaions.flthandling.finduldforopenflight" Type="NATIVE">
			<![CDATA[
			SELECT pln.uldnum AS uldnum
			  FROM oprlodplnuld pln, oprarpexpflt flt
			 WHERE pln.cmpcod = flt.cmpcod
			   AND pln.fltcaridr = flt.fltcaridr
			   AND pln.fltnum = flt.fltnum
			   AND pln.fltseqnum = flt.fltseqnum
   			AND coalesce(flt.finflg,'N') != 'Y'
   			AND pln.cmpcod=?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>180</QRY:Id>
		<QRY:Source Name="operaions.flthandling.finduldsinoperation" Type="NATIVE">
			<![CDATA[
		SELECT ULDNUM FROM OPRARPULD WHERE CMPCOD=? AND ULDNUM IN
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>180</QRY:Id>
		<QRY:Source Name="operations.flthandling.findFlightForULD" Type="NATIVE">
			<![CDATA[
			SELECT  ULD.CMPCOD ULDCMPCOD, ULD.ULDNUM ULDULDNUM,
				ULD.FLTCARIDR ULDFLTCARIDR, ULD.FLTNUM ULDFLTNUM,



				ULD.FLTSEQNUM ULDFLTSEQNUM, ULD.POL ULDPOL,
			        ULD.POU ULDPOU, ULD.CLSFLG ULDCLSFLG,



			        ULD.LEGSERNUM ULDLEGSERNUM,
					EXPFLT.FLTDAT EXPFLTFLTDAT, EXPFLT.FLTSEQNUM EXPFLTFLTSEQNUM,

EXPFLT.FINFLG,
					(CASE
ARLMST.APHCODUSE
				           WHEN 2
				              THEN ARLMST.TWOAPHCOD


				           ELSE ARLMST.THRAPHCOD

END) FLTCARCOD
			  FROM
			  	OPRULDDTL ULD

LEFT OUTER JOIN
OPRARPEXPFLT EXPFLT ON

ULD.CMPCOD = EXPFLT.CMPCOD
					AND  ULD.FLTCARIDR
= EXPFLT.FLTCARIDR

AND  ULD.FLTNUM = EXPFLT.FLTNUM

AND  ULD.FLTSEQNUM = EXPFLT.FLTSEQNUM

AND  ULD.LEGSERNUM =
EXPFLT.LEGSERNUM
					AND  ULD.POL = EXPFLT.ARPCOD

				LEFT OUTER JOIN SHRARLMST
ARLMST ON
						  ULD.CMPCOD
= ARLMST.CMPCOD
					 AND  ULD.FLTCARIDR
= ARLMST.ARLIDR
		 	WHERE

ULD.CMPCOD = ?
		 	    AND ULD.POL
= ?
			    AND ULD.ULDNUM = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>181</QRY:Id>
		<QRY:Source Name="operations.flthandling.findCTOULDDetailsFromSegment" Type="NATIVE">
			<![CDATA[
			SELECT
				EXPFLT.CMPCOD EXPFLTCMPCOD,EXPFLT.ARPCOD EXPFLTARPCOD,
				EXPFLT.FLTCARIDR EXPFLTFLTCARIDR,


EXPFLT.FLTNUM EXPFLTFLTNUM,
				EXPFLT.FLTSEQNUM EXPFLTFLTSEQNUM, EXPFLT.LEGSERNUM EXPFLTLEGSERNUM,



				EXPFLT.FINFLG EXPFLTFINFLG, EXPFLT.FLTDAT EXPFLTFLTDAT,
				EXPFLT.FLTCARCOD EXPFLTFLTCARCOD, EXPFLT.RELFLG


EXPFLTRELFLG,
				EXPFLT.RMK EXPFLTRMK, EXPFLT.FLTOPRSTA EXPFLTFLTOPRSTA,
				FLTSEG.POU FLTSEGPOU,

FLTSEG.SEGSERNUM
FLTSEGSEGSERNUM,
				ULD.ULDNUM ULDULDNUM,
				ULD.GRSWGT ULDGRSWGT, ULD.NETWGT ULDNETWGT,

ULD.THRUNT
ULDTHRUNT,
				ULD.ULDCTR ULDULDCTR, ULD.ULDSTA ULDULDSTA, ULD.TARWGT ULDTARWGT,
				ULD.ULDCTS

ULDULDCTS,
ULD.ULDPTY ULDULDPTY, ULD.MFTFLG ULDMFTFLG,
				ULD.RCVFLG ULDRCVFLG, ULD.BDPFLG ULDBDPFLG,


				SHP.DOCOWRIDR
SHPDOCOWRIDR, SHP.MSTDOCNUM SHPMSTDOCNUM,
				SHP.DUPNUM SHPDUPNUM, SHP.SEQNUM SHPSEQNUM,


				SHP.MFTPCS
SHPMFTPCS,SHPMST.PLTFLG,SHPDTL.PLTUSEFLG,
				SHP.MFTWGT SHPMFTWGT, SHP.MFTVOL SHPMFTVOL,

SHP.RMK SHPRMK,

				SHP.RCVPCS SHPRCVPCS, SHP.RCVWGT SHPRCVWGT, SHP.RCVVOL SHPRCVVOL,
				SHP.BDPPCS

SHPBDPPCS, SHP.BDPWGT
SHPBDPWGT, SHP.BDPVOL SHPBDPVOL,
				ULDACPDTL.CMDITMNAM ULDACPDTLCMDITMNAM,
ULDACPDTL.SCCCOD
ULDACPDTLSCCCOD,

				ULDACPDTL.SHPDES ULDACPDTLSHPDES, ULDACPDTL.SHPRMK ULDACPDTLSHPRMK,
ULDACPDTL.ULDCTR
ULDCTR,
				ACPDIM.DIMSERNUM
ACPDIMDIMSERNUM ,
				ACPDIM.PCSLEN ACPDIMPCSLEN, ACPDIM.PCSHGT
ACPDIMPCSHGT,

				ACPDIM.PCSWID ACPDIMPCSWID,
ACPDIM.PCSVOL ACPDIMPCSVOL,
				ACPDIM.NUMPCS ACPDIMNUMPCS,
ACPDIM.WGT ACPDIMWGT,

				ACPDIM.DISWGT ACPDIMDISWGT,
ACPDIM.WGTCOD ACPDIMWGTCOD,
				SHPMST.STDPCS
SHPMSTSTDPCS, SHPMST.STDWGT
SHPMSTSTDWGT,
				SHPMST.STDDISWGT
SHPMSTSTDDISWGT, SHPMST.STDWGTCOD SHPMSTSTDWGTCOD,

SHPMST.SHPPFX
SHPMSTSHPPFX, SHPMST.SCCCOD SHPMSTSCCCOD,

				SHPMST.SHPDES SHPMSTSHPDES, SHPMST.ORGCOD
SHPMSTORGCOD,

				SHPMST.DSTCOD SHPMSTDSTCOD, SHPMST.UBRNUM
SHPMSTUBRNUM,
				SHPMST.OWRCOD SHPMSTOWRCOD,
SHPMST.GRSVOL
SHPMSTGRSVOL,
				ULDACP.SERNUM ULDACPSERNUM,
ULDACP.WHSCOD ULDACPWHSCOD,
				ULDACP.LOCCOD
ULDACPLOCCOD,
ULDACP.GRSWGT ULDACPGRSWGT,
				ULDACP.GRSDISWGT
ULDACPGRSDISWGT, ULDACP.GRSWGTCOD ULDACPGRSWGTCOD,


				ULDACP.TARWGT ULDACPTARWGT, ULDACP.TARDISWGT ULDACPTARDISWGT,

				ULDACP.TARWGTCOD ULDACPTARWGTCOD,

ULDACP.RATTYP ULDACPRATTYP,
				SHPDTL.TOTACPPCS SHPDTLTOTACPPCS, SHPDTL.TOTACPWGT
SHPDTLTOTACPWGT,


				SHPDTL.TOTACPVOL SHPDTLTOTACPVOL
			FROM
				OPRARPEXPFLT EXPFLT
			INNER JOIN OPRFLTSEG
FLTSEG
ON

						EXPFLT.CMPCOD = FLTSEG.CMPCOD
				   AND  EXPFLT.ARPCOD = FLTSEG.POL
				   AND  EXPFLT.FLTCARIDR

=
FLTSEG.FLTCARIDR
				   AND  EXPFLT.FLTNUM = FLTSEG.FLTNUM
				   AND  EXPFLT.FLTSEQNUM = FLTSEG.FLTSEQNUM



				LEFT OUTER JOIN OPRSEGULD ULD  ON
					 	FLTSEG.CMPCOD = ULD.CMPCOD
				   	AND	FLTSEG.SEGSERNUM

= ULD.SEGSERNUM

					AND	FLTSEG.FLTCARIDR = ULD.FLTCARIDR
					AND	FLTSEG.FLTNUM = ULD.FLTNUM


					AND	FLTSEG.FLTSEQNUM =
ULD.FLTSEQNUM
				LEFT OUTER JOIN OPRSEGULDSHP SHP ON
					    	ULD.CMPCOD
=
SHP.CMPCOD
					   AND
ULD.SEGSERNUM = SHP.SEGSERNUM
					   AND	ULD.FLTCARIDR = SHP.FLTCARIDR


					   AND	ULD.FLTNUM = 	SHP.FLTNUM

AND	ULD.FLTSEQNUM = SHP.FLTSEQNUM
					   AND	ULD.ULDNUM
= 	SHP.ULDNUM

					LEFT OUTER JOIN OPRULDACPDTL
ULDACPDTL ON
					     SHP.CMPCOD = ULDACPDTL.CMPCOD

AND  SHP.MSTDOCNUM
= ULDACPDTL.MSTDOCNUM

					    AND  SHP.DOCOWRIDR = ULDACPDTL.DOCOWRIDR

AND  SHP.DUPNUM
= ULDACPDTL.DUPNUM
					    AND  SHP.SEQNUM
= ULDACPDTL.SEQNUM
					    AND  SHP.ULDNUM
= ULDACPDTL.ULDNUM

					 LEFT OUTER JOIN OPRSHPDIMACP ACPDIM
ON
					 		SHP.CMPCOD = ACPDIM.CMPCOD

AND	SHP.DOCOWRIDR
= ACPDIM.DOCOWRIDR
						AND	SHP.MSTDOCNUM
= ACPDIM.MSTDOCNUM
						AND	SHP.DUPNUM
= ACPDIM.DUPNUM

						AND	SHP.SEQNUM = ACPDIM.SEQNUM
					LEFT
OUTER JOIN OPRSHPMST SHPMST ON

SHP.CMPCOD = SHPMST.CMPCOD

						AND SHP.DOCOWRIDR = SHPMST.DOCOWRIDR

						AND SHP.MSTDOCNUM
= SHPMST.MSTDOCNUM
						AND SHP.DUPNUM
= SHPMST.DUPNUM
						AND SHP.SEQNUM = SHPMST.SEQNUM


					    LEFT OUTER JOIN OPRULDACP ULDACP
ON
					    		ULD.CMPCOD = ULDACP.CMPCOD
					    	AND 	ULD.ULDNUM
=
ULDACP.ULDNUM
					    	AND	ULD.FLTCARIDR
= ULDACP.FLTCARIDR
					    	AND	ULD.FLTNUM = ULDACP.FLTNUM


					    	AND 	ULD.FLTSEQNUM =
ULDACP.FLTSEQNUM
					    	AND 	ULD.SEGSERNUM = ULDACP.SEGSERNUM

LEFT OUTER
JOIN OPRSHPDTL
SHPDTL ON
							 	SHPMST.CMPCOD = SHPDTL.CMPCOD
							AND SHPMST.DOCOWRIDR
= SHPDTL.DOCOWRIDR


							AND SHPMST.MSTDOCNUM = SHPDTL.MSTDOCNUM
							AND SHPMST.DUPNUM =
SHPDTL.DUPNUM
							AND SHPMST.SEQNUM

= SHPDTL.SEQNUM
			WHERE
				EXPFLT.CMPCOD = ?
			AND	EXPFLT.ARPCOD
= ?
			AND	EXPFLT.FLTCARIDR = ?


			AND	EXPFLT.FLTNUM = ?
			AND	EXPFLT.FLTSEQNUM = ?
			AND
ULD.ULDNUM = ?
   			AND 	COALESCE(ULDACP.ARPCOD,

? ) = ?
			AND 	COALESCE(ACPDIM.ARPCOD, ? ) = ?

AND 	COALESCE(ULDACPDTL.ARPCOD, ? ) = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>181</QRY:Id>
		<QRY:Source Name="operations.flthandling.findconfirmedbooking" Type="NATIVE">
			<![CDATA[
		 SELECT SEG.SEGDST SEGPOU,
		 					   FLT.FLTCARIDR SHPFLTCARIDR,
		  FLT.CMPCOD SHPCMPCOD,
		  FLT.FLTNUM

SHPFLTNUM,
		 					   FLT.FLTSEQNUM SHPFLTSEQNUM,
		 					   FLT.SEGSERNUM SHPSEGSERNUM,



		 					   MST.DOCOWRIDR SHPDOCOWRIDR,
		 					   MST.MSTDOCNUM SHPMSTDOCNUM,
		  MST.DUPNUM
SHPDUPNUM,
		  MST.SEQNUM
SHPSEQNUM,
SHPMST.PLTFLG PLTFLG,
		  FLT.CFRPCS SHPPCS,
		  FLT.CFRWGT SHPWGT,
		 					   FLT.CFRVOL
SHPVOL,


		 					   SEG.FLTCARIDR FLTFLTCARIDR,
		 					   SEG.FLTNUM FLTFLTNUM,

SEG.FLTSEQNUM FLTFLTSEQNUM,


		 					   SEG.SEGSERNUM FLTSEGSERNUM,
		  SEG.CMPCOD FLTCMPCOD,

SEG.SEGORG FLTPOL,
		  SEG.SEGDST
FLTPOU,
		  MST.SHPPFX,
		  ARPSHP.AVLPCS,
		  SEGSHP.BDPPCS,

ARPSHP.AVLVOL,
		  SEGSHP.BDPVOL,

		  ARPSHP.AVLWGT,
		  ARPSHP.PLTUSEFLG ARPPLTUSEFLG,
		  SEGSHP.BDPWGT,
		  SHPMST.STDPCS,
		  SHPMST.STDWGT,

SHPMST.SHPDES,
		  SHPMST.SCCCOD,

		  SHPMST.ORGCOD,
		  SHPMST.DSTCOD,
		  SHPMST.STDWGTCOD,

SHPMST.GRSVOL,
		  SHPMST.GRSVOLUNT,

		  SHPMST.EFTAWBFLG,
		  (SELECT COUNT(SRVRCVSTA)
			FROM QMSSRVRCVCSE SRVCSE
			WHERE FLT.CMPCOD		  = SRVCSE.CMPCOD
			AND FLT.FLTORG		  = SRVCSE.ARPCOD
			AND FLT.DOCOWRIDR	  = SRVCSE.DOCOWRIDR
			AND FLT.MSTDOCNUM	  = SRVCSE.MSTDOCNUM
			AND FLT.DUPNUM		  = SRVCSE.DUPNUM
			AND FLT.SEQNUM		  = SRVCSE.SEQNUM
			AND FLT.FLTCARIDR     = SRVCSE.FLTCARIDR
			AND FLT.FLTNUM        = SRVCSE.FLTNUM
			AND FLT.FLTSEQNUM     = SRVCSE.FLTSEQNUM
			AND (SRVCSE.SYSACTTYP ='CP'
			OR SRVCSE.MANACTTYP   ='CP'
			OR SRVCSE.MANACTTYP   ='FP')
			AND SRVCSE.CSETYP     ='S'
			AND SRVCSE.SRVRCVSTA  ='A'
			AND SRVCSE.OPRTYP     ='E'
			)SRVRCVCNT
		FROM CAPBKGMST MST
			INNER JOIN CAPBKGFLTDTL
FLT
			ON MST.CMPCOD  = FLT.CMPCOD

			AND MST.UBRNUM = FLT.UBRNUM
			INNER JOIN FLTOPRSEG SEG

ON FLT.CMPCOD     = SEG.CMPCOD
		 		   AND
FLT.FLTCARIDR = SEG.FLTCARIDR
		 		   AND FLT.FLTNUM = SEG.FLTNUM

AND FLT.FLTSEQNUM = SEG.FLTSEQNUM

		 		   AND FLT.FLTORG = SEG.SEGORG
		 		   AND FLT.FLTDST
= SEG.SEGDST
			INNER JOIN OPRSHPMST SHPMST
			ON
FLT.CMPCOD     = SHPMST.CMPCOD
				 		   AND FLT.DOCOWRIDR
= SHPMST.DOCOWRIDR
				 		   AND FLT.MSTDOCNUM

= SHPMST.MSTDOCNUM
				 		   AND FLT.DUPNUM = SHPMST.DUPNUM

AND FLT.SEQNUM = SHPMST.SEQNUM

			LEFT OUTER JOIN OPRARPSHP ARPSHP
			ON FLT.CMPCOD     = ARPSHP.CMPCOD

AND FLT.DOCOWRIDR = ARPSHP.DOCOWRIDR

			AND FLT.MSTDOCNUM = ARPSHP.MSTDOCNUM
			AND FLT.DUPNUM
= ARPSHP.DUPNUM
			AND FLT.SEQNUM    = ARPSHP.SEQNUM

			AND ARPSHP.ARPCOD = ?
			LEFT OUTER JOIN
OPRSEGSHP SEGSHP
			ON FLT.CMPCOD     = SEGSHP.CMPCOD
			AND
FLT.FLTCARIDR = SEGSHP.FLTCARIDR
			AND
FLT.FLTNUM    = SEGSHP.FLTNUM
			AND FLT.FLTSEQNUM = SEGSHP.FLTSEQNUM

			AND FLT.SEGSERNUM = SEGSHP.SEGSERNUM

AND FLT.CMPCOD    = SEGSHP.CMPCOD
			AND FLT.DOCOWRIDR = SEGSHP.DOCOWRIDR

			AND FLT.MSTDOCNUM =
SEGSHP.MSTDOCNUM
			AND FLT.DUPNUM    = SEGSHP.DUPNUM
			AND FLT.SEQNUM    = SEGSHP.SEQNUM


		WHERE
(FLT.CFRPCS    > 0
		OR FLT.CFRWGT        > 0)
		AND ( FLT.FLTBKGSTA != 'R'
		AND FLT.FLTBKGSTA
!=
'X' )
		 		   AND MST.MSTDOCNUM IS NOT NULL
		 		   AND FLT.CMPCOD = ?
		 		   AND FLT.FLTCARIDR =
?

AND FLT.FLTSEQNUM = ?
		 		   AND FLT.FLTNUM = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>182</QRY:Id>
		<QRY:Source Name="operations.flthandling.findmanifestversionforprint" Type="NATIVE">
			<![CDATA[
		 SELECT ULD.CMPCOD ULDCMPCOD, ULD.FLTCARIDR ULDFLTCARIDR, ULD.FLTNUM ULDFLTNUM,
		        ULD.FLTSEQNUM


ULDFLTSEQNUM, ULD.LEGSERNUM ULDSEGSERNUM,
		        ULD.ULDNUM ULDULDNUM, SHP.CUSREF SHPCUSREF, SHP.MFTPCS


SHPPCS,
		        SHP.MFTWGT SHPWGT, SHP.MFTVOL SHPVOL, SHP.FLTCARIDR SHPFLTCARIDR,
		        SHP.FLTNUM


SHPFLTNUM, ULD.GRSWGT, ULD.NETWGT, ULD.THRUNT, ULD.ULDCTR,
		        SHP.FLTSEQNUM SHPFLTSEQNUM, SHP.FLTSEQNUM


SHPSEGSERNUM,
		        SHP.ULDNUM SHPULDNUM, SHP.DOCOWRIDR SHPDOCOWRIDR,
		        SHP.MSTDOCNUM SHPMSTDOCNUM,


SHP.DUPNUM SHPDUPNUM, SHP.SEQNUM SHPSEQNUM,
		        SHP.RMK SHPRMK, SHP.CMPCOD SHPCMPCOD, MST.SCCCOD


MSTSCCCOD,
		        MST.SHPDES MSTSHPDES, MST.ORGCOD MSTORGCOD, MST.DSTCOD MSTDSTCOD,
		        MST.STDWGTCOD


MSTSTDWGTCOD, MST.STDDISWGT MSTSTDDISWGT,
		        MST.PRDNAM MSTPRDNAM, MST.PRDPRT MSTPRDPRT, MST.SHPPFX,



SEG.CMPCOD SEGCMPCOD, SEG.FLTCARIDR SEGFLTCARIDR, SEG.FLTNUM SEGFLTNUM,
		        SEG.FLTSEQNUM SEGFLTSEQNUM,


SEG.POL SEGPOL, SEG.POU SEGPOU,
		        SEG.SEGSERNUM SEGSEGSERNUM, SEGSHP.PLNPCS, SEGSHP.PLNWGT,



SEGSHP.PLNVOL, MST.STDPCS, MST.STDWGT, MST.GRSVOL,
		        SEGSHP.MFTPCS SEGSHPMFTPCS,
SEGSHP.MFTWGT

SEGSHPMFTWGT,
		        SEGSHP.MFTVOL SEGSHPMFTVOL, SHP.LODPRT, EXPFLT.FINFLG,

SHP.MFTPCS
SHPBDPPCS,
SHP.MFTWGT SHPBDPWGT, SEGSHP.BDPPCS SEGSHPBDPPCS,
		        SEGSHP.BDPWGT SEGSHPBDPWGT,
MST.CONFLG


		   FROM OPRMFTULD ULD,
		        OPRMFTULDSHP SHP,
		        OPRSHPMST MST,

OPRFLTSEG SEG,


		        OPRSEGSHP SEGSHP,
		        OPRMFTVER VER,
		        OPRARPEXPFLT
EXPFLT
		  WHERE EXPFLT.FLTNUM
= VER.FLTNUM

		    AND EXPFLT.FLTSEQNUM = VER.FLTSEQNUM

AND EXPFLT.FLTCARIDR = VER.FLTCARIDR

		    AND EXPFLT.ARPCOD
= VER.ARPCOD
		    AND EXPFLT.CMPCOD
= VER.CMPCOD
		    AND EXPFLT.LEGSERNUM = VER.LEGSERNUM

		    AND
EXPFLT.FLTNUM = SEG.FLTNUM

AND EXPFLT.FLTSEQNUM = SEG.FLTSEQNUM
		    AND EXPFLT.FLTCARIDR
= SEG.FLTCARIDR

AND EXPFLT.ARPCOD
= SEG.POL
		    AND EXPFLT.CMPCOD = SEG.CMPCOD
		    AND SEGSHP.FLTCARIDR
= SEG.FLTCARIDR

AND
SEGSHP.CMPCOD = SEG.CMPCOD
		    AND SEGSHP.FLTNUM = SEG.FLTNUM
		    AND
SEGSHP.FLTSEQNUM = SEG.FLTSEQNUM


AND SEGSHP.SEGSERNUM = SEG.SEGSERNUM
		    AND MST.CMPCOD = SEGSHP.CMPCOD

AND MST.DOCOWRIDR =
SEGSHP.DOCOWRIDR

AND MST.MSTDOCNUM = SEGSHP.MSTDOCNUM
		    AND MST.DUPNUM
= SEGSHP.DUPNUM

AND MST.SEQNUM = SEGSHP.SEQNUM

		    AND ULD.FLTNUM = VER.FLTNUM
		    AND
ULD.FLTSEQNUM = VER.FLTSEQNUM

AND ULD.FLTCARIDR = VER.FLTCARIDR

		    AND ULD.ARPCOD = VER.ARPCOD

		    AND ULD.CMPCOD
= VER.CMPCOD
		    AND ULD.LEGSERNUM = VER.LEGSERNUM

		    AND ULD.MFTVER = VER.MFTVER


AND ULD.ULDNUM = SHP.ULDNUM
		    AND ULD.FLTSEQNUM = SHP.FLTSEQNUM

		    AND ULD.FLTNUM = SHP.FLTNUM


		    AND ULD.FLTCARIDR = SHP.FLTCARIDR
		    AND ULD.CMPCOD = SHP.CMPCOD

		    AND ULD.MFTVER
= SHP.MFTVER

		    AND ULD.ARPCOD = SHP.ARPCOD
		    AND ULD.LEGSERNUM = SHP.LEGSERNUM


AND MST.CMPCOD = SHP.CMPCOD

		    AND MST.DOCOWRIDR = SHP.DOCOWRIDR
		    AND MST.MSTDOCNUM =
SHP.MSTDOCNUM

		    AND MST.DUPNUM
= SHP.DUPNUM
		    AND MST.SEQNUM = SHP.SEQNUM
		    AND VER.FLTCARIDR
= ?
		    AND VER.FLTNUM
= ?

		    AND VER.FLTSEQNUM = ?
		    AND VER.CMPCOD = ?
		    AND VER.ARPCOD
= ?
   		    AND VER.MFTVER = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>183</QRY:Id>
		<QRY:Source Name="operations.flthandling.findmanifestdetailsforprovisional" Type="NATIVE">
			<![CDATA[
		SELECT ULD.CMPCOD ULDCMPCOD, ULD.FLTCARIDR ULDFLTCARIDR, ULD.FLTNUM ULDFLTNUM,
		       ULD.FLTSEQNUM


ULDFLTSEQNUM, ULD.SEGSERNUM ULDSEGSERNUM,
		       ULD.ULDNUM ULDULDNUM, SHP.CUSREF SHPCUSREF,



		       SHP.BDPPCS - SHP.MFTPCS SHPPCS, SHP.BDPWGT - SHP.MFTWGT SHPWGT,
		       SHP.BDPVOL - SHP.MFTVOL

SHPVOL,
SHP.FLTCARIDR SHPFLTCARIDR,
		       SHP.FLTNUM SHPFLTNUM, ULD.GRSWGT, ULD.NETWGT, ULD.THRUNT,

ULD.ULDCTR,

		       ULD.TARWGT, SHP.FLTSEQNUM SHPFLTSEQNUM, SHP.SEGSERNUM SHPSEGSERNUM,


		       SHP.ULDNUM SHPULDNUM, SHP.DOCOWRIDR
SHPDOCOWRIDR,
		       SHP.MSTDOCNUM SHPMSTDOCNUM, SHP.DUPNUM
SHPDUPNUM,
SHP.SEQNUM SHPSEQNUM,

SHP.RMK SHPRMK, SHP.CMPCOD SHPCMPCOD, MST.SCCCOD MSTSCCCOD,


MST.SHPDES MSTSHPDES, MST.ORGCOD
MSTORGCOD, MST.DSTCOD MSTDSTCOD,
		       MST.STDWGTCOD MSTSTDWGTCOD,

MST.STDDISWGT MSTSTDDISWGT,

MST.PRDNAM MSTPRDNAM, MST.PRDPRT MSTPRDPRT, MST.SHPPFX,


		       SEG.CMPCOD SEGCMPCOD, SEG.FLTCARIDR
SEGFLTCARIDR, SEG.FLTNUM SEGFLTNUM,
		       SEG.FLTSEQNUM
SEGFLTSEQNUM,
SEG.POL SEGPOL, SEG.POU SEGPOU,

SEG.SEGSERNUM SEGSEGSERNUM, SEGSHP.PLNPCS, SEGSHP.PLNWGT,


		       SEGSHP.PLNVOL, MST.STDPCS, MST.STDWGT,
MST.GRSVOL,
		       SEGSHP.MFTPCS SEGSHPMFTPCS, SEGSHP.MFTWGT

SEGSHPMFTWGT,
		       SEGSHP.MFTVOL SEGSHPMFTVOL,
SHP.LODPRT, EXPFLT.FINFLG,
		       SHP.BDPPCS SHPBDPPCS,

SHP.BDPWGT SHPBDPWGT, SEGSHP.BDPPCS SEGSHPBDPPCS,

		       SEGSHP.BDPWGT SEGSHPBDPWGT, MST.CONFLG


FROM OPRSEGULD ULD,
		       OPRSEGULDSHP SHP,
		       OPRSHPMST
MST,
		       OPRFLTSEG SEG,


OPRSEGSHP SEGSHP,
		       OPRARPEXPFLT EXPFLT
		 WHERE EXPFLT.FLTCARIDR
= ULD.FLTCARIDR(+)
		   AND

EXPFLT.FLTNUM = ULD.FLTNUM(+)
		   AND EXPFLT.FLTSEQNUM = ULD.FLTSEQNUM(+)

		   AND EXPFLT.ARPCOD

= SEG.POL
		   AND EXPFLT.CMPCOD = ULD.CMPCOD(+)
		   AND ULD.FLTCARIDR = SHP.FLTCARIDR(+)



		   AND ULD.FLTNUM = SHP.FLTNUM(+)
		   AND ULD.FLTSEQNUM = SHP.FLTSEQNUM(+)
		   AND ULD.SEGSERNUM
= SHP.SEGSERNUM(+)


		   AND ULD.CMPCOD = SHP.CMPCOD(+)
		   AND ULD.ULDNUM = SHP.ULDNUM(+)

AND ULD.FLTCARIDR = SEG.FLTCARIDR(+)


		   AND ULD.FLTNUM = SEG.FLTNUM(+)
		   AND ULD.FLTSEQNUM
= SEG.FLTSEQNUM(+)
		   AND ULD.SEGSERNUM
= SEG.SEGSERNUM(+)

		   AND ULD.CMPCOD = SEG.CMPCOD(+)

AND SHP.DOCOWRIDR = MST.DOCOWRIDR

AND SHP.MSTDOCNUM = MST.MSTDOCNUM

		   AND SHP.DUPNUM =
MST.DUPNUM
		   AND SHP.SEQNUM = MST.SEQNUM

		   AND SHP.CMPCOD = MST.CMPCOD
		   AND
SHP.DOCOWRIDR
= SEGSHP.DOCOWRIDR(+)
		   AND SHP.MSTDOCNUM = SEGSHP.MSTDOCNUM(+)

		   AND SHP.DUPNUM
= SEGSHP.DUPNUM(+)

AND SHP.SEQNUM = SEGSHP.SEQNUM(+)
		   AND SHP.CMPCOD = SEGSHP.CMPCOD(+)


AND SHP.FLTCARIDR = SEGSHP.FLTCARIDR(+)

AND SHP.FLTNUM = SEGSHP.FLTNUM(+)
		   AND SHP.FLTSEQNUM

= SEGSHP.FLTSEQNUM(+)
		   AND SHP.SEGSERNUM
= SEGSHP.SEGSERNUM(+)
		   AND SHP.BDPPCS - SHP.MFTPCS
>
0
		   AND EXPFLT.FLTCARIDR = ?
		   AND EXPFLT.FLTNUM
= ?
		   AND EXPFLT.FLTSEQNUM = ?
		   AND
EXPFLT.CMPCOD
= ?
		   AND EXPFLT.ARPCOD = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>184</QRY:Id>
		<QRY:Source Name="operations.flthandling.findnotocstatus" Type="NATIVE">
			<![CDATA[
	SELECT mst.cmpcod
	  FROM shrsccmst scc, oprshpmst mst, oprsegshp seg, oprfltseg fltseg
	 WHERE NOT


EXISTS (
	          SELECT 1
	            FROM oprntcdgr ntc
	           WHERE ntc.cmpcod =?



	             AND ntc.fltcaridr = ?
	             AND ntc.fltnum = ?
	             AND ntc.fltseqnum

= ?

	             AND ntc.legsernum = ?
			UNION
				SELECT 1
	            FROM OPRNTCSPLLOD

spl
	           WHERE spl.cmpcod
=?
	             AND spl.fltcaridr = ?
	             AND spl.fltnum

= ?
	             AND spl.fltseqnum
= ?
	             AND spl.legsernum = ?)
	   AND mst.cmpcod = seg.cmpcod


	   AND mst.docowridr = seg.docowridr

	   AND mst.mstdocnum = seg.mstdocnum
	   AND mst.dupnum
= seg.dupnum

	   AND mst.seqnum = seg.seqnum

	   AND mst.cmpcod = scc.cmpcod
	   AND mst.scccod
= scc.scccod

	   AND fltseg.fltcaridr = seg.fltcaridr

	   AND fltseg.cmpcod = seg.cmpcod

AND fltseg.fltnum =
seg.fltnum
	   AND fltseg.fltseqnum = seg.fltseqnum

	   AND fltseg.segsernum
= seg.segsernum

	   AND fltseg.cmpcod = ?
	   AND fltseg.fltcaridr = ?
	   AND fltseg.fltnum
=
?
	   AND fltseg.fltseqnum
= ?
	   AND fltseg.pol = ?
	   AND ( scc.dgrind = 'Y' OR scc.ntcind = 'Y' )
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>185</QRY:Id>
		<QRY:Source Name="operations.flthandling.findflightdetailsforhht" Type="NATIVE">
			<![CDATA[

	SELECT FLTSEG.FLTCARIDR, FLTSEG.FLTNUM, FLTSEG.FLTSEQNUM, FLTSEG.SEGSERNUM,
	       FLTSEG.CMPCOD,


FLTSEG.POL, FLTSEG.POU, SEGULD.ULDNUM, SEGULD.GRSWGT,
	       SEGULD.NETWGT, SEGULD.THRUNT, SEGULD.ULDCTR,


SEGULD.ULDSTA,
	       SEGULD.TARWGT, SEGULD.ULDCTS, SEGULD.ULDPTY, SEGULD.MFTFLG,
	       SEGULD.RCVFLG,


SEGULD.BDPFLG
	  FROM OPRFLTSEG FLTSEG, OPRSEGULD SEGULD
	 WHERE FLTSEG.CMPCOD = SEGULD.CMPCOD

AND

FLTSEG.FLTCARIDR = SEGULD.FLTCARIDR
	   AND FLTSEG.FLTNUM = SEGULD.FLTNUM
	   AND FLTSEG.FLTSEQNUM
=

SEGULD.FLTSEQNUM
	   AND FLTSEG.SEGSERNUM = SEGULD.SEGSERNUM
	   AND FLTSEG.CMPCOD = ?
	   AND SEGULD.ULDNUM
= ?


			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>185</QRY:Id>
		<QRY:Source Name="operations.flthandling.findBuildupDetailsForCarrier" Type="NATIVE">
			<![CDATA[
SELECT
				ULD.CMPCOD ULDCMPCOD, ULD.ULDCTR ULDCTR,
				ULD.INBFLTCARCOD, ULD.INBFLTCARIDR ULDFLTCARIDR,



				ULD.ULDBKGIDR,ULD.ALTIDR, ULD.BUPFLG,ULD.BKGTYP,

				ULD.ULDNUM ULDULDNUM, ULD.ULDOCP ULDULDOCP,


				ULD.POU SEGPOU, ULD.THRUNT THRUNT,
				ULD.ARPCOD SEGPOL,ULD.ULDDST
ULDULDDST,
				'-' AS ULDFLTNUM,


				'0' AS ULDFLTSEQNUM,
				'0' AS ULDSEGSERNUM,
				'-' AS SHPFLTNUM,

				SHP.ULDNUM SHPULDNUM,
SHP.CMPCOD
SHPCMPCOD,
				SHP.DOCOWRIDR SHPDOCOWRIDR, SHP.MSTDOCNUM SHPMSTDOCNUM,
SHP.DUPNUM SHPDUPNUM,

SHP.SEQNUM
SHPSEQNUM, SHP.NUMPCS SHPBDPPCS, SHP.WGT SHPBDPWGT, SHP.VOL SHPBDPVOL,

				MST.SCCCOD
MSTSCCCOD,
MST.STDPCS STDPCS, MST.STDWGT STDWGT,MST.STDWGTCOD,
				MST.SHPDES MSTSHPDES, MST.ORGCOD

MSTORGCOD,
MST.DSTCOD MSTDSTCOD,
				MST.PRDCOD MSTPRDCOD, MST.SHPPFX SHPPFX,MST.RDYCRGFLG,MST.PAYTYP MSTPAYTYP,
				RTG.THRCARIDR

RTGTHRCARIDR,
RTG.THRCARCOD RTGTHRCARCOD,
				RTG.THRDSTCOD RTGTHRDSTCOD, RTG.THRFLTNUM RTGTHRFLTNUM,


				RTG.THRFLTDAT
RTGTHRFLTDAT, RTG.CMPCOD RTGCMPCOD,
				RTG.ULDNUM RTGULDNUM,MST.EXEFLG,ULD.BRWFLG,SHP.ARPCOD,MST.CONFLG,ULD.RMK ULDRMK,
				MIS.SCICOD,MST.PLTFLG PLTFLG,
				  ARPSHP.PLTUSEFLG ARPPLTUSEFLG,
				  DTL.PLTUSEFLG PLTUSEFLG

			  FROM
			  	   OPRARPULD ULD
			  	INNER JOIN OPRULDSHP SHP ON
				   		ULD.CMPCOD = SHP.CMPCOD



					AND ULD.ARPCOD = SHP.ARPCOD
					AND ULD.ULDNUM = SHP.ULDNUM
				LEFT OUTER JOIN OPRSHPMST MST

ON

						 SHP.CMPCOD = MST.CMPCOD
					 AND SHP.DOCOWRIDR = MST.DOCOWRIDR
					 AND SHP.MSTDOCNUM

= MST.MSTDOCNUM

					 AND SHP.DUPNUM = MST.DUPNUM
					 AND SHP.SEQNUM = MST.SEQNUM
				LEFT
OUTER
JOIN OPRARPTHRRTG RTG ON

						 ULD.CMPCOD = RTG.CMPCOD
					 AND ULD.ARPCOD = RTG.ARPCOD


					 AND ULD.ULDNUM = RTG.ULDNUM
					 LEFT OUTER JOIN OPRSHPMSTMIS MIS
					ON MST.CMPCOD     = MIS.CMPCOD
					AND MST.DOCOWRIDR = MIS.DOCOWRIDR
					AND MST.MSTDOCNUM = MIS.MSTDOCNUM
					AND MST.DUPNUM    = MIS.DUPNUM
					AND MST.SEQNUM    = MIS.SEQNUM
					LEFT OUTER JOIN OPRARPSHP ARPSHP 
					ON SHP.CMPCOD     =ARPSHP.CMPCOD
					AND SHP.ARPCOD = ARPSHP.ARPCOD
					AND SHP.DOCOWRIDR =ARPSHP.DOCOWRIDR
					AND SHP.MSTDOCNUM =ARPSHP.MSTDOCNUM
					AND SHP.DUPNUM    =ARPSHP.DUPNUM
					AND SHP.SEQNUM    =ARPSHP.SEQNUM
					LEFT OUTER JOIN OPRSHPDTL DTL
					ON SHP.MSTDOCNUM = DTL.MSTDOCNUM
					AND SHP.DOCOWRIDR = DTL.DOCOWRIDR
					AND SHP.DUPNUM = DTL.DUPNUM
					AND SHP.SEQNUM = DTL.SEQNUM
					AND SHP.CMPCOD = DTL.CMPCOD
				WHERE

						ULD.CMPCOD = ?
					AND ULD.ARPCOD = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>185</QRY:Id>
		<QRY:Source Name="operations.flthandling.finduniddetails" Type="NATIVE">
			<![CDATA[
	SELECT UNIIDR, PKGGRP, PKGINS, PKGTYP, NUMPKG,
          NETQTY, DGR.SCCCOD
 	 FROM OPRSHPMST MST, OPRSHPDGR DGR
         WHERE MST.DOCOWRIDR = DGR.DOCOWRIDR
           AND MST.MSTDOCNUM = DGR.MSTDOCNUM
           AND MST.DUPNUM = DGR.DUPNUM
           AND MST.SEQNUM = DGR.SEQNUM
   	   AND MST.CAOFLG = 'Y'
	   AND MST.CMPCOD = ?
	   AND MST.DOCOWRIDR = ?
	   AND MST.MSTDOCNUM = ?
	   AND MST.DUPNUM = ?
	   AND MST.SEQNUM = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>185</QRY:Id>
		<QRY:Source Name="operations.flighthandling.findpassengerfltdtls" Type="NATIVE">
			<![CDATA[
	SELECT MST.DOCOWRIDR, MST.DUPNUM,MST.SEQNUM,MST.DOCNUM,BKG.UBRNUM
	FROM OPRSHPMST MST, CAPBKGMST BKG, CAPBKGFLTDTL FLT, FLTOPRMST FLTMST
	WHERE BKG.CMPCOD = MST.CMPCOD(+)
	 AND BKG.DOCOWRIDR =MST.DOCOWRIDR(+)
	 AND BKG.MSTDOCNUM =  MST.MSTDOCNUM(+)
	 AND BKG.SEQNUM = MST.SEQNUM(+)
	 AND BKG.DUPNUM = MST.DUPNUM(+)
	 AND BKG.UBRNUM = FLT.UBRNUM
	 AND BKG.CMPCOD = FLT.CMPCOD
	 AND FLTMST.FLTSEQNUM = FLT.FLTSEQNUM
	 AND FLTMST.FLTNUM = FLT.FLTNUM
	 AND FLTMST.FLTCARIDR = FLT.FLTCARIDR
	 AND FLTMST.CMPCOD = FLT.CMPCOD
	 AND FLTMST.FLTTYP = 'CO'
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>185</QRY:Id>
		<QRY:Source Name="operations.flighthandling.findshipmentdetailsinuld" Type="NATIVE">
			<![CDATA[
	SELECT    SHP.CUSREF SHPCUSREF, SHP.MFTPCS SHPPCS,
		       SHP.MFTWGT SHPWGT, SHP.MFTVOL SHPVOL, SHP.FLTCARIDR


SHPFLTCARIDR,SHP.RCVPCS,
		       SHP.FLTNUM SHPFLTNUM, SHP.FLTSEQNUM SHPFLTSEQNUM, SHP.SEGSERNUM SHPSEGSERNUM,



SHP.ULDNUM SHPULDNUM, SHP.DOCOWRIDR SHPDOCOWRIDR,
		       SHP.MSTDOCNUM SHPMSTDOCNUM, SHP.DUPNUM SHPDUPNUM,


SHP.SEQNUM SHPSEQNUM,
		       SHP.RMK SHPRMK, SHP.CMPCOD SHPCMPCOD,
			    MST.CMPCOD MSTCMPCOD,

MST.DOCOWRIDR MSTDOCOWRIDR,
				MST.MSTDOCNUM MSTDOCNUM,
				MST.DUPNUM MSTDUPNUM,
				MST.SEQNUM MSTSEQNUM,

MST.SCCCOD MSTSCCCOD,
		       MST.SHPDES
MSTSHPDES, MST.ORGCOD MSTORGCOD, MST.DSTCOD MSTDSTCOD,

MST.STDWGTCOD MSTSTDWGTCOD,
MST.STDDISWGT
MSTSTDDISWGT,
		       MST.PRDNAM MSTPRDNAM, MST.PRDPRT MSTPRDPRT,
MST.SHPPFX,

			   MST.CMPCOD MSTCMPCOD,
			   MST.DOCOWRIDR MSTDOCOWRIDR,
			   MST.DOCNUM
MSTDOCNUM,
			   MST.DUPNUM MSTDUPNUM,
			   MST.SEQNUM MSTSEQNUM,
		       SHP.BDPPCS SHPBDPPCS,
SHP.BDPWGT
SHPBDPWGT,
MST.RDYCRGFLG MSTRDYCRGFLG,
		       SHP.BDPVOL SHPBDPVOL,MST.PLTFLG PLTFLG
		  FROM OPRSEGULDSHP SHP,

		       OPRSHPMST MST


			   WHERE
		 SHP.DOCOWRIDR = MST.DOCOWRIDR(+)
	   AND SHP.MSTDOCNUM = MST.MSTDOCNUM(+)

	   AND
SHP.DUPNUM
= MST.DUPNUM(+)
		   AND SHP.SEQNUM = MST.SEQNUM(+)
		   AND SHP.CMPCOD = MST.CMPCOD(+)




		   AND SHP.ULDNUM
= ?
		   AND SHP.CMPCOD = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>186</QRY:Id>
		<QRY:Source Name="operations.flighthandling.findimportflightstatus" Type="NATIVE">
			<![CDATA[

			SELECT CLSFLG FROM OPRARPIMPFLT
			where CMPCOD = ?
			AND ARPCOD = ?
			AND FLTCARIDR = ?
			AND FLTNUM = ?
			AND FLTSEQNUM = ?
			AND LEGSERNUM = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>187</QRY:Id>
		<QRY:Source Name="operations.flthandling.findoperationsexternalmessageshistory" Type="NATIVE">
			<![CDATA[
			SELECT HIS.CMPCOD, HIS.STNCOD, HIS.MSGTYP, HIS.SEQNUM,
					HIS.MSG, HIS.MSGDAT, HIS.MSGIDFONE, HIS.MSGIDFTWO,
					HIS.MSGIDFTHR, HIS.MSGIDFFOR, HIS.MSGIDFFIV
			FROM OPREXTMSGHIS HIS
			WHERE HIS.CMPCOD = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>188</QRY:Id>
		<QRY:Source Name="operations.flthandling.findshipmentsinflight" Type="NATIVE">
			<![CDATA[
				SELECT MST.MSTDOCNUM,MST.DOCOWRIDR,MST.DUPNUM,MST.SEQNUM,
				MST.ORGCOD,MST.DSTCOD,MST.EXEFLG,MST.SHPPFX,MST.OWRCOD,SHP.BDPPCS,SHP.BDPWGT,SHP.BDPVOL,



				SHP.MFTPCS,SHP.MFTWGT,SHP.MFTVOL,SHP.LSTUPDTIM,MST.SCCCOD,MST.CMPCOD
				FROM OPRSHPMST MST,OPRSEGSHP


SHP,OPRFLTSEG SEG
				WHERE MST.CMPCOD = SHP.CMPCOD
				AND MST.MSTDOCNUM = SHP.MSTDOCNUM
				AND MST.DOCOWRIDR


= SHP.DOCOWRIDR
				AND MST.DUPNUM = SHP.DUPNUM
				AND MST.SEQNUM = SHP.SEQNUM
				AND SHP.FLTCARIDR=SEG.FLTCARIDR



				AND SHP.FLTNUM=SEG.FLTNUM
				AND SEG.FLTSEQNUM=SHP.FLTSEQNUM
				AND SEG.CMPCOD=SHP.CMPCOD


				AND SEG.SEGSERNUM=SHP.SEGSERNUM

				AND SHP.bdppcs>0
				AND SEG.CMPCOD = ?
				AND SEG.FLTCARIDR

= ?
				AND SEG.FLTNUM = ?
				AND SEG.FLTSEQNUM
=?
				AND SEG.POL=?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>189</QRY:Id>
		<QRY:Source Name="opearations.flthandling.isflightfinalizedformailandcargo" Type="NATIVE">
			<![CDATA[
				SELECT COUNT(1)
				FROM OPRARPEXPFLT OPRFLT, MTKASGFLT MTKFLT, FLTOPRLEG FLTLEG
				WHERE
				FLTLEG.CMPCOD


= OPRFLT.CMPCOD(+)
				AND FLTLEG.FLTCARIDR = OPRFLT.FLTCARIDR(+)
				AND FLTLEG.FLTNUM = OPRFLT.FLTNUM(+)



				AND FLTLEG.FLTSEQNUM = OPRFLT.FLTSEQNUM(+)
				AND FLTLEG.LEGSERNUM = OPRFLT.LEGSERNUM(+)
				AND

FLTLEG.LEGORG
= OPRFLT.ARPCOD(+)
				AND FLTLEG.CMPCOD = MTKFLT.CMPCOD(+)
				AND FLTLEG.FLTCARIDR
=
MTKFLT.FLTCARIDR(+)

				AND FLTLEG.FLTNUM = MTKFLT.FLTNUM(+)
				AND FLTLEG.FLTSEQNUM = MTKFLT.FLTSEQNUM(+)


				AND FLTLEG.LEGSERNUM
= MTKFLT.LEGSERNUM(+)
				AND FLTLEG.LEGORG = MTKFLT.ARPCOD(+)
				AND (OPRFLT.FLTNUM

IS NULL

				     	OR OPRFLT.FINFLG = 'R'
					OR OPRFLT.FINFLG = 'F'
					OR OPRFLT.FINFLG

IS NULL )
				AND (MTKFLT.FLTNUM
IS NULL OR MTKFLT.CLSFLG = 'C')
				AND FLTLEG.CMPCOD = ?
				AND
FLTLEG.FLTCARIDR
= ?
				AND FLTLEG.FLTNUM
= ?
				AND FLTLEG.FLTSEQNUM = ?
				AND FLTLEG.LEGSERNUM
= ?
				AND FLTLEG.LEGORG = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>190</QRY:Id>
		<QRY:Source Name="opearations.flthandling.findmanifestedshipmentdetails" Type="NATIVE">
			<![CDATA[


		  SELECT SHP.FLTCARIDR SHPFLTCARIDR, SHP.FLTNUM SHPFLTNUM,
		       SHP.FLTSEQNUM SHPFLTSEQNUM, SHP.SEGSERNUM


SHPSEGSERNUM,MST.OWRCOD,
		       CASE WHEN ULD.BARROWFLG = 'Y' AND ISPRINT = 'Y' THEN 'BULK' ELSE SHP.ULDNUM
END

SHPULDNUM, SHP.DOCOWRIDR SHPDOCOWRIDR,
		       CASE WHEN ULD.BARROWFLG = 'Y' AND ISPRINT = 'Y'
AND
NVL(EXPFLT.FINFLG,'
') NOT IN('F','R') THEN SHP.ULDNUM ELSE SHP.RMK END MFTRMK,
		       SHP.MSTDOCNUM

SHPMSTDOCNUM, SHP.DUPNUM
SHPDUPNUM, SHP.SEQNUM SHPSEQNUM,
		       SHP.CMPCOD SHPCMPCOD, MST.SCCCOD

MSTSCCCOD, MST.SHPDES MSTSHPDES,

MST.ORGCOD MSTORGCOD, MST.DSTCOD MSTDSTCOD, MST.STDWGTCOD

MSTSTDWGTCOD,
		       MST.STDDISWGT MSTSTDDISWGT,
MST.PRDNAM MSTPRDNAM, MST.PRDPRT MSTPRDPRT,


		       MST.SHPPFX, MST.STDPCS, MST.STDWGT, MST.GRSVOL,
MST.GRSVOLUNT, MST.CONFLG, MIS.SCICOD EURSTA,


			   MST.EXEFLG,
		       SHP.ADDSCC ADDSCCSCCCOD, ARLSHP.AVLPCS
ARLSHPAVLPCS,
		       ARLSHP.AVLWGT
ARLSHPAVLWGT,
ARPSHP.AVLPCS, ARPSHP.AVLWGT,
		       ARPSHP.ARPCOD,
ARPSHP.PLTUSEFLG ARPPLTUSEFLG,			   
		       

		       
		       ACC.JRNDAT,MST.PLTFLG PLTFLG,DTL.PLTUSEFLG PLTUSEFLG,MST.CONFLG,MST.CNSCOD,MST.SHPCOD,MST.AGTCOD,MST.DOMFLG,MIS.CRSREFONE, 
MIS.CRSREFTWO,
		       ULD.LSTUPDTIM ULDLSTUPDTIM,
ULD.LSTUPDUSR ULDLSTUPDUSR,
		       ARPSHP.LSTUPDTIM

ARPSHPLSTUPDTIM, ARPSHP.LSTUPDUSR ARPSHPLSTUPDUSR,COALESCE(ULD.BARROWFLG,
'N') BARROWFLG,FLTSEG.POL, FLTSEG.POU, SHP.MFTPCS, SHP.MFTWGT


		  FROM

OPRFLTSEG FLTSEG,
		       OPRSEGULDSHP SHP,
		       OPRSEGULD ULD,

		       OPRSHPMST MST,


OPRARPSHP ARPSHP,
		       OPRARPARLSHP ARLSHP,
		       OPRSHPMSTMIS MIS,
		       OPRARPEXPFLT EXPFLT,


		       OPRSHPMSTACC ACC,
		       OPRSHPDTL DTL, (SELECT ? ISPRINT FROM DUAL)

		 WHERE FLTSEG.FLTCARIDR

=
ULD.FLTCARIDR
		   AND FLTSEG.FLTNUM = ULD.FLTNUM
		   AND FLTSEG.FLTSEQNUM = ULD.FLTSEQNUM

AND

FLTSEG.SEGSERNUM = ULD.SEGSERNUM
		   AND FLTSEG.CMPCOD = ULD.CMPCOD
		   AND EXPFLT.FLTCARIDR
=  FLTSEG.FLTCARIDR


AND EXPFLT.FLTNUM =  FLTSEG.FLTNUM
		   AND EXPFLT.FLTSEQNUM = FLTSEG.FLTSEQNUM

AND EXPFLT.CMPCOD

= FLTSEG.CMPCOD
		   AND EXPFLT.ARPCOD = FLTSEG.POL
		   AND ULD.FLTCARIDR = SHP.FLTCARIDR

AND
ULD.FLTNUM
= SHP.FLTNUM
		   AND ULD.FLTSEQNUM = SHP.FLTSEQNUM
		   AND ULD.SEGSERNUM = SHP.SEGSERNUM


		   AND ULD.ULDNUM
= SHP.ULDNUM
		   AND ULD.CMPCOD = SHP.CMPCOD
		   AND MST.MSTDOCNUM = SHP.MSTDOCNUM


		   AND MST.DOCOWRIDR
= SHP.DOCOWRIDR
		   AND MST.DUPNUM = SHP.DUPNUM
		   AND MST.SEQNUM = SHP.SEQNUM


		   AND MST.CMPCOD
= SHP.CMPCOD
		   AND MST.MSTDOCNUM = ARPSHP.MSTDOCNUM
		   AND MST.DOCOWRIDR =
ARPSHP.DOCOWRIDR


AND MST.DUPNUM = ARPSHP.DUPNUM
		   AND MST.SEQNUM = ARPSHP.SEQNUM
		   AND MST.CMPCOD
= ARPSHP.CMPCOD


		   AND ARPSHP.MSTDOCNUM = ARLSHP.MSTDOCNUM(+)
		   AND ARPSHP.DOCOWRIDR
= ARLSHP.DOCOWRIDR(+)

		   AND ARPSHP.DUPNUM
= ARLSHP.DUPNUM(+)
		   AND ARPSHP.SEQNUM = ARLSHP.SEQNUM(+)

AND ARPSHP.CMPCOD
= ARLSHP.CMPCOD(+)

		   AND ARPSHP.ARPCOD = ARLSHP.ARPCOD(+)
		   AND ARPSHP.ARPCOD
= FLTSEG.POL


		   AND MST.MSTDOCNUM = MIS.MSTDOCNUM

		   AND MST.DOCOWRIDR = MIS.DOCOWRIDR

AND MST.DUPNUM =
MIS.DUPNUM
		   AND MST.SEQNUM = MIS.SEQNUM

		   AND MST.CMPCOD = MIS.CMPCOD


AND MST.MSTDOCNUM
= acc.MSTDOCNUM
		   AND MST.DOCOWRIDR = acc.DOCOWRIDR

		   AND MST.DUPNUM =
acc.DUPNUM
		   AND
MST.SEQNUM = acc.SEQNUM
		   AND MST.CMPCOD = acc.CMPCOD



		   AND MST.MSTDOCNUM
= dtl.MSTDOCNUM

		   AND MST.DOCOWRIDR = dtl.DOCOWRIDR
		   AND MST.DUPNUM = dtl.DUPNUM


AND MST.SEQNUM = dtl.SEQNUM

		   AND MST.CMPCOD = dtl.CMPCOD
		   AND FLTSEG.FLTCARIDR = ?

		   AND FLTSEG.FLTNUM =?
		   AND FLTSEG.FLTSEQNUM
= ?

AND FLTSEG.CMPCOD = ?
		   AND FLTSEG.POL =
?


			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>191</QRY:Id>
		<QRY:Source Name="opearations.flthandling.findtransactionhousesforflight" Type="NATIVE">
			<![CDATA[

		SELECT SHP.FLTCARIDR SHPFLTCARIDR, SHP.FLTNUM SHPFLTNUM,
		       SHP.FLTSEQNUM SHPFLTSEQNUM, SHP.SEGSERNUM


SHPSEGSERNUM,
		       SHP.ULDNUM SHPULDNUM, SHP.DOCOWRIDR SHPDOCOWRIDR,
		       SHP.MSTDOCNUM SHPMSTDOCNUM,


SHP.DUPNUM SHPDUPNUM, SHP.SEQNUM SHPSEQNUM,
		       SHP.CMPCOD SHPCMPCOD, MST.SHPPFX, MST.STDPCS,
MST.STDWGT,

MST.GRSVOL,
		       MST.SHPDES, HSE.CMPCOD HSECMPCOD, HSE.ARPCOD HSEARPCOD,
		       HSE.DOCOWRIDR

HSEDOCOWRIDR,
HSE.MSTDOCNUM HSEMSTDOCNUM,
		       HSE.DUPNUM HSEDUPNUM, HSE.SEQNUM HSESEQNUM, HSE.TXNCOD

HSETXNCOD,

		       HSE.TXNREFONE, HSE.TXNREFTWO, HSE.TXNREFTHR, HSE.TXNREFFOR,
		       HSE.TXNREFFIV,

HSE.TXNREFSIX, HSE.TXNREFNIN,
HSE.TXNREFSEV, HSE.DOCNUM HSEDOCNUM, HSE.PCS HSEPCS,
		       HSE.WGT

HSEWGT, HSE.SERNUM,mst.conflg

		  FROM OPRFLTSEG FLTSEG, OPRSEGULDSHP SHP, OPRSHPMST MST, OPRTXNHSE

HSE
		 WHERE FLTSEG.FLTNUM = SHP.FLTNUM

		   AND FLTSEG.FLTCARIDR = SHP.FLTCARIDR
		   AND FLTSEG.FLTSEQNUM

= SHP.FLTSEQNUM
		   AND FLTSEG.SEGSERNUM
= SHP.SEGSERNUM
		   AND FLTSEG.CMPCOD = SHP.CMPCOD

AND
MST.MSTDOCNUM = SHP.MSTDOCNUM
		   AND MST.DOCOWRIDR
= SHP.DOCOWRIDR
		   AND MST.DUPNUM = SHP.DUPNUM


AND MST.CMPCOD = SHP.CMPCOD
		   AND MST.MSTDOCNUM
= HSE.MSTDOCNUM
		   AND MST.DUPNUM = HSE.DUPNUM


AND MST.DOCOWRIDR = HSE.DOCOWRIDR
		   AND MST.SEQNUM
= HSE.SEQNUM
		   AND MST.CMPCOD = HSE.CMPCOD


		   AND SHP.FLTCARIDR = HSE.TXNREFTWO
		   AND SHP.FLTNUM
= HSE.TXNREFTHR
		   AND SHP.FLTSEQNUM =
HSE.TXNREFFIV

		   AND SHP.ULDNUM = HSE.TXNREFSIX
		   AND FLTSEG.POU
= HSE.TXNREFSEV
		   AND
FLTSEG.FLTCARIDR = ?

		   AND FLTSEG.FLTNUM = ?
		   AND FLTSEG.FLTSEQNUM =
?
		   AND FLTSEG.CMPCOD
= ?
		   AND FLTSEG.POL =
?
		   AND HSE.ARPCOD(+) = ?
		 

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>7</QRY:Id>
		<QRY:Source Name="opearations.flthandling.findmanifestdetailsforffm" Type="NATIVE">
			<![CDATA[
		SELECT SHPMST.DOCOWRIDR DOCOWRIDR,
  SHPMST.DUPNUM DUPNUM,
  SHPMST.SEQNUM SEQNUM,
  SHPMST.CMPCOD


MSTCMPCOD,
  SHPMST.MSTDOCNUM MSTDOCNUM,
  SHPMST.SCCCOD MSTSCCCOD,
  SHPMST.SHPDES MSTSHPDES,
  SHPMST.ORGCOD


MSTORGCOD,
  SHPMST.DSTCOD MSTDSTCOD,
  SHPMST.STDWGTCOD MSTSTDWGTCOD,
  SHPMST.STDDISWGT MSTSTDDISWGT,



SHPMST.PRDNAM MSTPRDNAM,
  SHPMST.PRDPRT MSTPRDPRT,
  SHPMST.SHPPFX,
  SHPMST.STDPCS,
  SHPMST.STDWGT,



SHPMST.GRSVOL,
  SHPMST.CONFLG,
  ULD.CMPCOD ULDCMPCOD,
  ULD.FLTCARIDR ULDFLTCARIDR,
  ULD.FLTNUM
ULDFLTNUM,
  ULD.BARROWFLG,

ULD.FLTSEQNUM ULDFLTSEQNUM,
  ULD.SEGSERNUM ULDSEGSERNUM,
ULD.ULDNUM ULDULDNUM,


ULD.ULDOCP ULDULDOCP,
  ULD.ULDDST ULDULDDST,
  ULD.GRSWGT,


  ULD.NETWGT,
  ULD.THRUNT,
  ULD.ULDCTR,

ULD.TARWGT,
  ULD.MFTFLG ULDMFTFLG,
  ULD.BSEPLT,
  ULD.BSEFLG,
  ULDSHP.CUSREF SHPCUSREF,


  ULDSHP.MFTPCS
SHPPCS,
  ULDSHP.MFTWGT SHPWGT,
  ULDSHP.MFTVOL SHPVOL,
  ULDSHP.FLTCARIDR SHPFLTCARIDR,


  ULDSHP.FLTNUM
SHPFLTNUM,
  ULDSHP.FLTSEQNUM SHPFLTSEQNUM,
  ULDSHP.SEGSERNUM SHPSEGSERNUM,
  CASE


    WHEN ULD.BARROWFLG
= 'Y'
    THEN 'BULK'
    ELSE ULDSHP.ULDNUM
  END SHPULDNUM,
  ULDSHP.DOCOWRIDR
SHPDOCOWRIDR,


ULDSHP.MSTDOCNUM SHPMSTDOCNUM,
  ULDSHP.DUPNUM SHPDUPNUM,
  ULDSHP.SEQNUM SHPSEQNUM,

ULDSHP.RMK SHPRMK,


  ULDSHP.CMPCOD SHPCMPCOD,
  ULDSHP.LODPRT,
  ULDSHP.BDPPCS SHPBDPPCS,
  ULDSHP.BDPWGT
SHPBDPWGT,

ULDSHP.BDPVOL
SHPBDPVOL,
  ULDSHP.ADDSCC ADDSCCSCCCOD,
   ULD.ULDBKGIDR ULDBKGIDR,
   ULD.ULDVOL
ULDVOL,

ULD.LWRDCKONE
LWRDCKONE,
   ULD.LWRDCKTWO LWRDCKTWO,
   ULD.UPRDCKONE,
   ULD.UPRDCKTWO,

   ULD.RMK
ULDRMK,
   ULD.ACTWGT
ACTWGT,
  SEG.CMPCOD SEGCMPCOD,
  SEG.FLTCARIDR SEGFLTCARIDR,
  SEG.FLTNUM
SEGFLTNUM,

SEG.FLTSEQNUM
SEGFLTSEQNUM,
  SEG.POL SEGPOL,
  SEG.POU SEGPOU,
  OPRLEG1.STA OPRSTA,

  OPRLEG1.STD
OPRSTD,
  OPRLEGSTA.STA
POUSTA,
  OPRLEGSTD.STD POUSTD,
  SEG.SEGSERNUM SEGSEGSERNUM,

  RTG.SERNUM
RTGSERNUM,
  RTG.SEGSERNUM
RTGSEGSERNUM,
  RTG.FLTSEQNUM RTGFLTSEQNUM,
  RTG.FLTNUM RTGFLTNUM,


RTG.FLTCARIDR RTGCARIDR,
  RTG.CMPCOD
RTGCMPCOD,
  CASE
    WHEN ULD.BARROWFLG = 'Y'
    THEN 'BULK'


           			ELSE RTG.ULDNUM
  END RTGULDNUM,

RTG.THRCARIDR RTGTHRCARIDR,
  RTG.THRCARCOD RTGTHRCARCOD,

RTG.THRFLTNUM
RTGTHRFLTNUM,
  RTG.THRFLTDAT
RTGTHRFLTDAT,
  RTG.THRDSTCOD RTGTHRDSTCOD,
  SEGSHP.PLNPCS,

SEGSHP.PLNWGT,

  SEGSHP.PLNVOL,
  SEGSHP.MFTPCS
SEGSHPMFTPCS,
  SEGSHP.MFTWGT SEGSHPMFTWGT,
  SEGSHP.MFTVOL
SEGSHPMFTVOL,

  SEGSHP.BDPPCS SEGSHPBDPPCS,

  SEGSHP.BDPWGT SEGSHPBDPWGT,
  SEGSHP.BDPVOL SEGSHPBDPVOL,

EXPFLT.FINFLG,

  ARLSHP.AVLPCS,
  ARLSHP.AVLWGT,

  SHPMIS.SCICOD EURSTA,
  SHPMIS.CRSREFONE,

SHPOCI.CNTCOD,
  SHPOCI.CUSINF,

  SHPOCI.CUSINFIDF,
  SHPOCI.INFIDF,

  BKGFLTDTL.FLTORG ONWFLTORG,

BKGFLTDTL.MSTDOCNUM BKGMSTDOCNUM,

  BKGFLTDTL.FLTCARIDR ONWFLTCARIDR,

  BKGFLTDTL.FLTCARCOD ONWFLTCARCOD,

BKGFLTDTL.FLTNUM ONWFLTNUM,

  BKGFLTDTL.FLTSEQNUM ONWFLTSEQNUM,

  BKGFLTDTL.NUMPCS BKDPCS,
  BKGFLTDTL.WGT
BKDWGT,
  BKGFLTDTL.FLTDST
ONWFLTDST,
  BKGFLTDTL.UBRNUM UBRNUM,

BKGFLTDTL.SERNUM BKGDTLSERNUM,

OPRLEG.STD ONWSTD,
  BKGFLTDTL.FLTDAT
BKGFLTDAT,
  SHPDIM.DIMSERNUM SHPDIMSERNUM,
  SHPDIM.WGTCOD
SHPDIMWGTCOD,

SHPDIM.WGT SHPDIMWGT,

  SHPDIM.MIPUNTCOD SHPDIMMIPUNTCOD,
  SHPDIM.PCSLEN SHPDIMPCSLEN,

SHPDIM.PCSWID
SHPDIMPCSWID,
  SHPDIM.PCSHGT
SHPDIMPCSHGT,
  SHPDIM.NUMPCS SHPDIMNUMPCS,
  OTHSRV.OTHSRVINF OTHSRVOTHSRVINF,

  FLT.STD FLTSTD
FROM
OPRARPEXPFLT EXPFLT
INNER JOIN OPRFLTSEG SEG
ON (EXPFLT.FLTCARIDR = SEG.FLTCARIDR
AND

EXPFLT.FLTNUM
= SEG.FLTNUM
AND EXPFLT.FLTSEQNUM = SEG.FLTSEQNUM
AND EXPFLT.CMPCOD    = SEG.CMPCOD
AND

EXPFLT.ARPCOD
= SEG.POL)
INNER  JOIN FLTOPRLEG OPRLEG1
ON (EXPFLT.FLTSEQNUM = OPRLEG1.FLTSEQNUM
AND

EXPFLT.FLTNUM
= OPRLEG1.FLTNUM
AND EXPFLT.FLTCARIDR = OPRLEG1.FLTCARIDR
AND EXPFLT.ARPCOD    = OPRLEG1.LEGORG
AND

EXPFLT.CMPCOD
= OPRLEG1.CMPCOD)
LEFT OUTER JOIN FLTOPRLEG OPRLEGSTA
ON (SEG.FLTSEQNUM = OPRLEGSTA.FLTSEQNUM
AND

SEG.FLTNUM
= OPRLEGSTA.FLTNUM
AND SEG.FLTCARIDR = OPRLEGSTA.FLTCARIDR
AND SEG.POU    = OPRLEGSTA.LEGDST
AND

SEG.CMPCOD
= OPRLEGSTA.CMPCOD)
LEFT OUTER JOIN FLTOPRLEG OPRLEGSTD
ON (OPRLEGSTA.FLTSEQNUM = OPRLEGSTD.FLTSEQNUM
AND


OPRLEGSTA.FLTNUM    = OPRLEGSTD.FLTNUM
AND OPRLEGSTA.FLTCARIDR = OPRLEGSTD.FLTCARIDR
AND OPRLEGSTA.LEGDST


= OPRLEGSTD.LEGORG
AND OPRLEGSTA.CMPCOD    = OPRLEGSTD.CMPCOD)
LEFT OUTER JOIN OPRSEGULD ULD
ON (SEG.FLTCARIDR


= ULD.FLTCARIDR
AND SEG.FLTNUM    = ULD.FLTNUM
AND SEG.FLTSEQNUM = ULD.FLTSEQNUM
AND SEG.CMPCOD
=

ULD.CMPCOD
AND SEG.SEGSERNUM = ULD.SEGSERNUM)
LEFT OUTER JOIN OPRSEGULDSHP ULDSHP
ON (ULD.FLTNUM

=
ULDSHP.FLTNUM
AND ULD.FLTCARIDR= ULDSHP.FLTCARIDR
AND ULD.FLTSEQNUM = ULDSHP.FLTSEQNUM
AND ULD.SEGSERNUM


= ULDSHP.SEGSERNUM
AND ULD.ULDNUM    = ULDSHP.ULDNUM
AND ULD.CMPCOD    = ULDSHP.CMPCOD)
LEFT OUTER
JOIN

OPRSEGSHP SEGSHP
ON (ULDSHP.DOCOWRIDR = SEGSHP.DOCOWRIDR
AND ULDSHP.MSTDOCNUM = SEGSHP.MSTDOCNUM
AND


ULDSHP.DUPNUM    = SEGSHP.DUPNUM
AND ULDSHP.SEQNUM    = SEGSHP.SEQNUM
AND ULDSHP.CMPCOD    = SEGSHP.CMPCOD
AND


ULDSHP.FLTCARIDR = SEGSHP.FLTCARIDR
AND ULDSHP.FLTNUM    = SEGSHP.FLTNUM
AND ULDSHP.FLTSEQNUM = SEGSHP.FLTSEQNUM
AND


ULDSHP.SEGSERNUM = SEGSHP.SEGSERNUM)
LEFT OUTER JOIN OPRULDTHRRTG RTG
ON ( ULD.FLTCARIDR = RTG.FLTCARIDR
AND


ULD.FLTNUM     = RTG.FLTNUM
AND ULD.FLTSEQNUM  = RTG.FLTSEQNUM
AND ULD.SEGSERNUM  = RTG.SEGSERNUM
AND


ULD.ULDNUM     = RTG.ULDNUM
AND ULD.CMPCOD     = RTG.CMPCOD)
LEFT OUTER JOIN OPRSHPMST SHPMST
ON (SEGSHP.DOCOWRIDR


= SHPMST.DOCOWRIDR
AND SEGSHP.MSTDOCNUM = SHPMST.MSTDOCNUM
AND SEGSHP.DUPNUM    = SHPMST.DUPNUM
AND

SEGSHP.SEQNUM
= SHPMST.SEQNUM
AND SEGSHP.CMPCOD    = SHPMST.CMPCOD)
LEFT OUTER JOIN OPRARPSHP ARPSHP
ON

(SHPMST.DOCOWRIDR
= ARPSHP.DOCOWRIDR
AND SHPMST.MSTDOCNUM = ARPSHP.MSTDOCNUM
AND SHPMST.DUPNUM    =

ARPSHP.DUPNUM
AND SHPMST.SEQNUM
= ARPSHP.SEQNUM
AND SHPMST.CMPCOD    = ARPSHP.CMPCOD
AND ARPSHP.ARPCOD

=?)
LEFT OUTER JOIN OPRSHPMSTMIS
SHPMIS
ON (SHPMST.DOCOWRIDR = SHPMIS.DOCOWRIDR
AND SHPMST.MSTDOCNUM

= SHPMIS.MSTDOCNUM
AND SHPMST.DUPNUM
= SHPMIS.DUPNUM
AND SHPMST.SEQNUM    = SHPMIS.SEQNUM
AND SHPMST.CMPCOD

= SHPMIS.CMPCOD)
LEFT OUTER
JOIN OPRSHPOCI SHPOCI
ON (SHPMST.DOCOWRIDR = SHPOCI.DOCOWRIDR
AND SHPMST.MSTDOCNUM

= SHPOCI.MSTDOCNUM
AND
SHPMST.DUPNUM    = SHPOCI.DUPNUM
AND SHPMST.SEQNUM    = SHPOCI.SEQNUM
AND SHPMST.CMPCOD

= SHPOCI.CMPCOD
AND
SHPOCI.seqnum    = 1)
LEFT OUTER JOIN OPRSHPDIMDTL SHPDIM
ON (SHPMST.DOCOWRIDR
=
SHPDIM.DOCOWRIDR
AND
SHPMST.MSTDOCNUM = SHPDIM.MSTDOCNUM
AND SHPMST.DUPNUM    = SHPDIM.DUPNUM
AND
SHPMST.SEQNUM
= SHPDIM.SEQNUM
AND
SHPMST.CMPCOD    = SHPDIM.CMPCOD)
LEFT OUTER JOIN OPRARPARLSHP
ARLSHP
ON (ARPSHP.DOCOWRIDR
= ARLSHP.DOCOWRIDR
AND
ARPSHP.MSTDOCNUM = ARLSHP.MSTDOCNUM
AND ARPSHP.DUPNUM
= ARLSHP.DUPNUM
AND
ARPSHP.SEQNUM    = ARLSHP.SEQNUM
AND
ARPSHP.CMPCOD    = ARLSHP.CMPCOD
AND ARPSHP.ARPCOD
= ARLSHP.ARPCOD
AND
ARLSHP.OWNCARIDR = ?)
LEFT
OUTER JOIN CAPBKGFLTDTL BKGFLTDTL
ON (SHPMST.MSTDOCNUM
=BKGFLTDTL.MSTDOCNUM
AND
SHPMST.DOCOWRIDR =BKGFLTDTL.DOCOWRIDR
AND
SHPMST.DUPNUM    =BKGFLTDTL.DUPNUM
AND
SHPMST.SEQNUM    =BKGFLTDTL.SEQNUM
AND
SHPMST.CMPCOD    =BKGFLTDTL.CMPCOD
AND BKGFLTDTL.FLTBKGSTA
<> 'X'
AND
SEG.POU          = BKGFLTDTL.FLTORG)
LEFT OUTER JOIN FLTOPRLEG
OPRLEG
ON (BKGFLTDTL.FLTSEQNUM
= OPRLEG.FLTSEQNUM
AND
BKGFLTDTL.FLTNUM    = OPRLEG.FLTNUM
AND BKGFLTDTL.FLTCARIDR
= OPRLEG.FLTCARIDR
AND
BKGFLTDTL.FLTORG
= OPRLEG.LEGORG
AND BKGFLTDTL.CMPCOD    = OPRLEG.CMPCOD)
LEFT
OUTER JOIN FLTOPRLEG
FLT
ON ( EXPFLT.CMPCOD = FLT.CMPCOD
AND EXPFLT.FLTNUM = FLT.FLTNUM
AND EXPFLT.FLTCARIDR
= FLT.FLTCARIDR
AND
EXPFLT.FLTSEQNUM = FLT.FLTSEQNUM
AND EXPFLT.ARPCOD = FLT.LEGORG
AND EXPFLT.LEGSERNUM
= FLT.LEGSERNUM
)
LEFT OUTER JOIN OPRSHPOTHSRV OTHSRV
ON (SHPMST.DOCOWRIDR
= OTHSRV.DOCOWRIDR
AND SHPMST.MSTDOCNUM
=
OTHSRV.MSTDOCNUM
AND SHPMST.DUPNUM    = OTHSRV.DUPNUM
AND SHPMST.SEQNUM
= OTHSRV.SEQNUM
AND SHPMST.CMPCOD

= OTHSRV.CMPCOD)
WHERE EXPFLT.FLTCARIDR  = ?
AND EXPFLT.FLTNUM
= ?
AND EXPFLT.FLTSEQNUM    =
?
AND
EXPFLT.CMPCOD       = ?
AND EXPFLT.ARPCOD       =?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>193</QRY:Id>
		<QRY:Source Name="operations.manifest.finduldinothercarrier" Type="NATIVE">
			<![CDATA[
		SELECT INBFLTCARIDR
		  FROM OPRARPULD
		 WHERE ULDNUM = ? AND ARPCOD = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>194</QRY:Id>
		<QRY:Source Name="operations.manifest.findManifestDetailsForMAWBLevel" Type="NATIVE">
			<![CDATA[
				SELECT SEGSHP.DOCOWRIDR, SEGSHP.MSTDOCNUM, SEGSHP.DUPNUM, SEGSHP.SEQNUM,
				       SEGSHP.MFTPCS,


SEGSHP.MFTWGT, SEGSHP.MFTVOL, SEGSHP.RCVPCS,
				       SEGSHP.RCVWGT, SEGSHP.RCVVOL, SEGSHP.SHPPFX

SEGSHPPFX,

				       SEGSHP.BDPPCS, SEGSHP.BDPWGT, SEGSHP.BDPVOL,
				       SHPMST.STDPCS,

SHPMST.STDWGT, SHPMST.SCCCOD PRISCCCOD,

				       SHPMST.SHPDES MSTSHPDES, SHPMST.ORGCOD

MSTSHPORG,
				       SHPMST.DSTCOD MSTSHPDST, SHPMST.CNSNAM,
SEG.POU,
				       HSE.DOCNUM HAWBNUM,

HSE.PCS HAWBPCS, HSE.WGT HAWBWGT,
				       RAT.CMDITMNAM COMDTYNAM,

					   ULDSHP.ADDSCC

ADDSCC
				  FROM OPRFLTSEG SEG,
				       OPRSEGSHP SEGSHP,
				       OPRSHPMST SHPMST,



				       OPRTXNHSE HSE,
				       OPRSHPRATDTL RAT,
				       OPRSEGULDSHP ULDSHP
				 WHERE SEG.CMPCOD

= SEGSHP.CMPCOD

				   AND SEG.FLTCARIDR = SEGSHP.FLTCARIDR
				   AND SEG.FLTNUM = SEGSHP.FLTNUM


				   AND SEG.FLTSEQNUM =
SEGSHP.FLTSEQNUM
				   AND SEG.SEGSERNUM = SEGSHP.SEGSERNUM
				   AND
SEGSHP.CMPCOD
= SHPMST.CMPCOD

AND SEGSHP.DOCOWRIDR = SHPMST.DOCOWRIDR
				   AND SEGSHP.MSTDOCNUM
= SHPMST.MSTDOCNUM

AND SEGSHP.DUPNUM
= SHPMST.DUPNUM
				   AND SEGSHP.SEQNUM = SHPMST.SEQNUM

AND SEGSHP.CMPCOD
= HSE.CMPCOD(+)

AND SEGSHP.MSTDOCNUM = HSE.MSTDOCNUM(+)
				   AND SEGSHP.DUPNUM
= HSE.DUPNUM(+)

				   AND SEGSHP.DOCOWRIDR
= HSE.DOCOWRIDR(+)
				   AND SEGSHP.FLTCARIDR =
HSE.TXNREFTWO(+)
				   AND SEGSHP.FLTNUM
= HSE.TXNREFTHR(+)

				   AND SEGSHP.FLTSEQNUM = HSE.TXNREFFIV(+)

AND SHPMST.CMPCOD =
RAT.CMPCOD (+)
				   AND SHPMST.DOCOWRIDR
= RAT.DOCOWRIDR(+)
				   AND SHPMST.MSTDOCNUM
= RAT.MSTDOCNUM(+)

				   AND SHPMST.DUPNUM = RAT.DUPNUM(+)

				   AND SHPMST.SEQNUM
= RAT.SEQNUM(+)
				   AND SHPMST.CMPCOD
= ULDSHP.CMPCOD (+)
				   AND SHPMST.DOCOWRIDR
= ULDSHP.DOCOWRIDR(+)

AND SHPMST.MSTDOCNUM =
ULDSHP.MSTDOCNUM(+)
				   AND SHPMST.DUPNUM = ULDSHP.DUPNUM(+)

AND SHPMST.SEQNUM
= ULDSHP.SEQNUM(+)

				   AND SEGSHP.MFTPCS > 0
				   AND SEG.CMPCOD = ?
				   AND
SEG.FLTCARIDR
= ?
				   AND SEG.FLTNUM =
?
				   AND SEG.FLTSEQNUM = ?
				   AND SEG.POL = ?

AND HSE.TXNCOD(+) = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>195</QRY:Id>
		<QRY:Source Name="operations.manifest.findManifestDetailsForImport" Type="NATIVE">
			<![CDATA[
				SELECT SEGSHP.DOCOWRIDR, SEGSHP.MSTDOCNUM, SEGSHP.DUPNUM, SEGSHP.SEQNUM,
				       SEGSHP.MFTPCS,


SEGSHP.MFTWGT, SEGSHP.MFTVOL, SEGSHP.RCVPCS,
				       SEGSHP.RCVWGT, SEGSHP.RCVVOL, SEGSHP.SHPPFX

SEGSHPPFX,
SEGSHP.BDPPCS,
				       SEGSHP.BDPWGT, SEGSHP.BDPVOL, SHPMST.STDPCS, SHPMST.STDWGT,


				       SHPMST.SCCCOD
PRISCCCOD, SHPMST.SHPDES MSTSHPDES,
				       SHPMST.ORGCOD MSTSHPORG, SHPMST.DSTCOD

MSTSHPDST, SHPMST.CNSNAM,

				       RAT.CMDITMNAM COMDTYNAM, ULDSHP.ADDSCC ADDSCCCOD, SEG.POL,

SEG.POU
				  FROM OPRFLTSEG SEG,

				       OPRSEGSHP SEGSHP,
				       OPRSHPMST SHPMST,


OPRTXNHSE HSE,
				       OPRSHPRATDTL RAT,

				       OPRSEGULDSHP ULDSHP
				 WHERE SEG.CMPCOD

= SEGSHP.CMPCOD
				   AND SEG.FLTCARIDR = SEGSHP.FLTCARIDR

				   AND SEG.FLTNUM = SEGSHP.FLTNUM


AND SEG.FLTSEQNUM = SEGSHP.FLTSEQNUM
				   AND SEG.SEGSERNUM =
SEGSHP.SEGSERNUM
				   AND SEGSHP.CMPCOD

= SHPMST.CMPCOD
				   AND SEGSHP.DOCOWRIDR = SHPMST.DOCOWRIDR

AND SEGSHP.MSTDOCNUM = SHPMST.MSTDOCNUM


AND SEGSHP.DUPNUM = SHPMST.DUPNUM
				   AND SEGSHP.SEQNUM
= SHPMST.SEQNUM
				   AND SEGSHP.CMPCOD

= HSE.CMPCOD(+)
				   AND SEGSHP.MSTDOCNUM = HSE.MSTDOCNUM(+)

AND SEGSHP.DUPNUM = HSE.DUPNUM(+)


AND SEGSHP.DOCOWRIDR = HSE.DOCOWRIDR(+)
				   AND SEGSHP.FLTCARIDR
= HSE.TXNREFTWO(+)
				   AND SEGSHP.FLTNUM

= HSE.TXNREFTHR(+)
				   AND SEGSHP.FLTSEQNUM = HSE.TXNREFFIV(+)

AND SHPMST.CMPCOD = RAT.CMPCOD(+)


AND SHPMST.DOCOWRIDR = RAT.DOCOWRIDR(+)
				   AND SHPMST.MSTDOCNUM
= RAT.MSTDOCNUM(+)
				   AND SHPMST.DUPNUM

= RAT.DUPNUM(+)
				   AND SHPMST.SEQNUM = RAT.SEQNUM(+)

AND SHPMST.CMPCOD = ULDSHP.CMPCOD(+)


AND SHPMST.DOCOWRIDR = ULDSHP.DOCOWRIDR(+)
				   AND SHPMST.MSTDOCNUM
= ULDSHP.MSTDOCNUM(+)


AND SHPMST.DUPNUM = ULDSHP.DUPNUM(+)
				   AND SHPMST.SEQNUM = ULDSHP.SEQNUM(+)

AND SEGSHP.MFTPCS

> 0
				   AND SEG.CMPCOD = ?
				   AND SEG.FLTCARIDR = ?
				   AND SEG.FLTNUM =
?
				   AND SEG.FLTSEQNUM

= ?
				   AND SEG.POU = ?
				   AND HSE.TXNCOD(+) = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>196</QRY:Id>
		<QRY:Source Name="operations.manifest.findManifestDetailsForCarrierCode" Type="NATIVE">
			<![CDATA[
				SELECT SEGSHP.DOCOWRIDR, SEGSHP.MSTDOCNUM, SEGSHP.DUPNUM, SEGSHP.SEQNUM,
		        	   SEG.POL, SEG.POU,



SEGSHP.MFTPCS, SEGSHP.MFTWGT, SEGSHP.MFTVOL, SEGSHP.RCVPCS,
				       SEGSHP.RCVWGT, SEGSHP.RCVVOL,


SEGSHP.SHPPFX SEGSHPPFX, SEGSHP.BDPPCS,
				       SEGSHP.BDPWGT, SEGSHP.BDPVOL, SHPMST.STDPCS, SHPMST.STDWGT,



SHPMST.SCCCOD PRISCCCOD, SHPMST.SHPDES MSTSHPDES,
				       SHPMST.ORGCOD MSTSHPORG, SHPMST.DSTCOD

MSTSHPDST,
SHPMST.CNSNAM,
				       RAT.CMDITMNAM COMDTYNAM, ULDSHP.ADDSCC ADDSCCCOD,
				       CAPFLT.FLTCARCOD


CAPFLTCARCOD, CAPFLT.FLTCARIDR CAPFLTCARIDR
				  FROM OPRFLTSEG SEG,
				       OPRSEGSHP SEGSHP,



OPRSHPMST SHPMST,
				       OPRTXNHSE HSE,
				       OPRSHPRATDTL RAT,
				       OPRSEGULDSHP ULDSHP,



					   CAPBKGFLTDTL CAPFLT
				 WHERE SEG.CMPCOD = SEGSHP.CMPCOD
				   AND SEG.FLTCARIDR
= SEGSHP.FLTCARIDR


				   AND SEG.FLTNUM = SEGSHP.FLTNUM
				   AND SEG.FLTSEQNUM = SEGSHP.FLTSEQNUM

AND SEG.SEGSERNUM
=
SEGSHP.SEGSERNUM
				   AND SEGSHP.CMPCOD = SHPMST.CMPCOD
				   AND SEGSHP.DOCOWRIDR
= SHPMST.DOCOWRIDR


AND SEGSHP.MSTDOCNUM = SHPMST.MSTDOCNUM
				   AND SEGSHP.DUPNUM = SHPMST.DUPNUM

AND SEGSHP.SEQNUM

= SHPMST.SEQNUM
				   AND SEGSHP.CMPCOD = HSE.CMPCOD(+)
				   AND SEGSHP.MSTDOCNUM
= HSE.MSTDOCNUM(+)


AND SEGSHP.DUPNUM = HSE.DUPNUM(+)
				   AND SEGSHP.DOCOWRIDR = HSE.DOCOWRIDR(+)

AND SEGSHP.FLTCARIDR

= HSE.TXNREFTWO(+)
				   AND SEGSHP.FLTNUM = HSE.TXNREFTHR(+)
				   AND SEGSHP.FLTSEQNUM
= HSE.TXNREFFIV(+)


AND SHPMST.CMPCOD = RAT.CMPCOD(+)
				   AND SHPMST.DOCOWRIDR = RAT.DOCOWRIDR(+)

AND SHPMST.MSTDOCNUM

= RAT.MSTDOCNUM(+)
				   AND SHPMST.DUPNUM = RAT.DUPNUM(+)
				   AND SHPMST.SEQNUM
= RAT.SEQNUM(+)


AND SHPMST.CMPCOD = ULDSHP.CMPCOD(+)
				   AND SHPMST.DOCOWRIDR = ULDSHP.DOCOWRIDR(+)

AND SHPMST.MSTDOCNUM

= ULDSHP.MSTDOCNUM(+)
				   AND SHPMST.DUPNUM = ULDSHP.DUPNUM(+)
				   AND SHPMST.SEQNUM
= ULDSHP.SEQNUM(+)


				   AND SEGSHP.CMPCOD = CAPFLT.CMPCOD
				   AND SEGSHP.DOCOWRIDR
= CAPFLT.DOCOWRIDR
				   AND SEGSHP.MSTDOCNUM

= CAPFLT.MSTDOCNUM
				   AND SEGSHP.DUPNUM = CAPFLT.DUPNUM

AND SEGSHP.SEQNUM = CAPFLT.SEQNUM


				   AND SEG.POU = CAPFLT.FLTORG
				   AND SEGSHP.MFTPCS
> 0
				   AND SEG.CMPCOD = ?
				   AND
SEG.FLTCARIDR
= ?
				   AND SEG.FLTNUM = ?
				   AND SEG.FLTSEQNUM
= ?
				   AND SEG.POU = ?

				   AND HSE.TXNCOD(+) = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>197</QRY:Id>
		<QRY:Source Name="operations.manifest.findManifestDetailsForULD" Type="NATIVE">
			<![CDATA[
				SELECT CASE WHEN ULD.BARROWFLG = 'Y' AND ISPRINT = 'Y' THEN 'BULK'
           						 ELSE ULD.ULDNUM



       				   END ULDNUM, ULD.GRSWGT ULDGRSWGT, ULD.NETWGT ULDNETWGT,
					   ULD.THRUNT, ULD.ULDCTR,


					   ULD.ULDSTA,
ULD.TARWGT ULDTARWGT, ULD.ULDCTS,
					   ULD.ULDPTY, ULD.ULDOCP, ULD.ULDDST, SEG.POU,


					   ULDSHP.RMK
ULDRMK,
					   ULDSHP.DOCOWRIDR, ULDSHP.MSTDOCNUM, ULDSHP.DUPNUM, ULDSHP.SEQNUM,


					   ULDSHP.MFTPCS,
ULDSHP.MFTWGT, ULDSHP.MFTVOL,
					   ULDSHP.BDPPCS, ULDSHP.BDPWGT, ULDSHP.BDPVOL,


					   SHPMST.STDPCS,
SHPMST.STDWGT, SHPMST.SHPPFX SHPPFX,
				       SHPMST.SCCCOD PRISCCCOD, SHPMST.SHPDES

MSTSHPDES,

SHPMST.ORGCOD MSTSHPORG, SHPMST.DSTCOD MSTSHPDST, SHPMST.CNSNAM,
				       RAT.CMDITMNAM

COMDTYNAM,
ULDSHP.ADDSCC ADDSCCCOD
				  FROM OPRFLTSEG SEG,
				  	   OPRSEGULD ULD,
				       OPRSEGULDSHP

ULDSHP,

OPRSHPMST SHPMST,
				       OPRTXNHSE HSE,
				       OPRSHPRATDTL RAT,


				       (SELECT ? ISPRINT

         			    FROM DUAL)
				 WHERE
				 	   SEG.CMPCOD
= ULD.CMPCOD

				   AND SEG.FLTCARIDR = ULD.FLTCARIDR

				   AND SEG.FLTNUM = ULD.FLTNUM

AND SEG.FLTSEQNUM
= ULD.FLTSEQNUM
				   AND SEG.SEGSERNUM = ULD.SEGSERNUM

				   AND ULD.CMPCOD
= ULDSHP.CMPCOD

AND ULD.FLTCARIDR = ULDSHP.FLTCARIDR
				   AND ULD.FLTNUM = ULDSHP.FLTNUM


				   AND ULD.FLTSEQNUM
= ULDSHP.FLTSEQNUM
				   AND ULD.SEGSERNUM = ULDSHP.SEGSERNUM
				   AND
ULD.ULDNUM
= ULDSHP.ULDNUM

				   AND ULDSHP.CMPCOD = SHPMST.CMPCOD
				   AND ULDSHP.DOCOWRIDR
= SHPMST.DOCOWRIDR

				   AND ULDSHP.MSTDOCNUM
= SHPMST.MSTDOCNUM
				   AND ULDSHP.DUPNUM =
SHPMST.DUPNUM
				   AND ULDSHP.SEQNUM
= SHPMST.SEQNUM

				   AND ULDSHP.CMPCOD = HSE.CMPCOD(+)

AND ULDSHP.MSTDOCNUM = HSE.MSTDOCNUM(+)

				   AND ULDSHP.DUPNUM
= HSE.DUPNUM(+)
				   AND
ULDSHP.DOCOWRIDR = HSE.DOCOWRIDR(+)
				   AND ULDSHP.FLTCARIDR
= HSE.TXNREFTWO(+)

				   AND
ULDSHP.FLTNUM = HSE.TXNREFTHR(+)
				   AND ULDSHP.FLTSEQNUM = HSE.TXNREFFIV(+)

				   AND
SHPMST.CMPCOD
= RAT.CMPCOD(+)
				   AND SHPMST.DOCOWRIDR = RAT.DOCOWRIDR(+)
				   AND SHPMST.MSTDOCNUM

= RAT.MSTDOCNUM(+)

AND SHPMST.DUPNUM = RAT.DUPNUM(+)
				   AND SHPMST.SEQNUM = RAT.SEQNUM(+)


AND SEG.CMPCOD =
?
				   AND SEG.FLTCARIDR = ?
				   AND SEG.FLTNUM = ?
				   AND SEG.FLTSEQNUM =

?
				   AND SEG.POL
= ?
				   AND HSE.TXNCOD(+) = ?
				   AND ULDSHP.MFTPCS    >0
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>198</QRY:Id>
		<QRY:Source Name="opearations.flthandling.findTruckerDetails" Type="NATIVE">
			<![CDATA[
		SELECT CMPCOD, TRKCOD, TRKNAM, ORGCOD, DSTCOD, VLDFRM, VLDTOO
		 FROM OPRTRKMST
		 WHERE CMPCOD = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>199</QRY:Id>
		<QRY:Source Name="opearations.flthandling.findTruckAssignmentDetails" Type="NATIVE">
			<![CDATA[
		SELECT trk.CMPCOD, trk.FLTCARIDR, trk.FLTNUM,
			   trk.FLTSEQNUM, trk.LEGSERNUM, trk.FLTCARCOD,



			   trk.FLTDAT, trk.SEGORG, trk.SEGDST,
			   trk.LSTUPDTIM, trk.LSTUPDUSR,
			   trkcfg.TRKCOD,
trkcfg.RMK,

trkcfg.FULULD,
			   trkcfg.HLFULD, trkcfg.LOSWGT, trkcfg.NML,
			   trkcfg.LOWFLR, trkcfg.HGHTCH,
trkcfg.BIGRFR,


			   trkcfg.SMLRFR, trkcfg.REGSPL, trkcfg.HLFAMTRND,
			   trkcfg.CHG,trkcfg.AMDCHG,trkcfg.CURCOD,


			   arpshp.DOCOWRIDR,
arpshp.MSTDOCNUM, arpshp.DUPNUM,
			   arpshp.SEQNUM, arpshp.SHPORG, arpshp.SHPDST,


			   arpshp.SHPPFX,
arpshp.PCS, arpshp.WGT
		FROM OPRTRKASG trk INNER JOIN  OPRTRKASGCFG trkcfg ON

trk.cmpcod
= trkcfg.cmpcod
AND
			 trk.fltcaridr = trkcfg.fltcaridr AND
			 trk.fltnum = trkcfg.fltnum
AND

			 trk.fltseqnum = trkcfg.fltseqnum
AND
			 trk.legsernum = trkcfg.legsernum
	 	LEFT OUTER
JOIN OPRTRKASGSHP
arpshp ON
		 	 trk.cmpcod =
arpshp.cmpcod AND
			 trk.fltcaridr = arpshp.fltcaridr
AND
			 trk.fltnum
= arpshp.fltnum AND
			 trk.fltseqnum
= arpshp.fltseqnum AND
			 trk.legsernum =
arpshp.legsernum AND

			 trkcfg.trkcod = arpshp.trkcod
		WHERE
trk.cmpcod = ? AND
			 trk.fltcaridr
= ? AND
			 trk.fltnum =
? AND
			 trk.fltseqnum = ? AND
			 trk.legsernum
= ?
		 ORDER BY trkcod ,docowridr,
mstdocnum
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>200</QRY:Id>
		<QRY:Source Name="opearations.flthandling.findBookedShipmentsInFlight" Type="NATIVE">
			<![CDATA[
		SELECT bkgflt.MSTDOCNUM ,bkgflt.DOCOWRIDR , bkgflt.DUPNUM ,
		 	bkgflt.SEQNUM , bkgflt.FLTCARIDR ,


bkgflt.FLTNUM ,
		 	bkgflt.FLTSEQNUM , bkgflt.CMPCOD , (bkgflt.NUMPCS - COALESCE(asgpcs,0) ) PCS,



		 	(bkgflt.WGT -  COALESCE(asgwgt,0)) WGT, shpmst.ORGCOD,
		 	shpmst.DSTCOD, shpmst.SHPPFX
			FROM

CAPBKGFLTDTL
bkgflt
	 		LEFT OUTER JOIN (SELECT asgshp.CMPCOD,asgshp.FLTSEQNUM,asgshp.FLTNUM,asgshp.FLTCARIDR,



			 	   				asgshp.SEQNUM,asgshp.DUPNUM,asgshp.MSTDOCNUM,asgshp.DOCOWRIDR,
								sum(asgshp.PCS)
as
asgpcs,sum(asgshp.WGT)
as asgwgt
		   				 	 FROM OPRTRKASGSHP asgshp, CAPBKGFLTDTL bkgflt

WHERE
asgshp.DOCOWRIDR =
bkgflt.DOCOWRIDR AND
							 		asgshp.MSTDOCNUM = bkgflt.MSTDOCNUM AND

asgshp.DUPNUM
= bkgflt.DUPNUM
AND
									asgshp.SEQNUM = bkgflt.SEQNUM AND
			 						asgshp.FLTCARIDR
= bkgflt.FLTCARIDR
AND

			 						asgshp.FLTNUM = bkgflt.FLTNUM AND
			 						asgshp.FLTSEQNUM
= bkgflt.FLTSEQNUM
AND
			 						asgshp.CMPCOD
= bkgflt.CMPCOD
									group by asgshp.MSTDOCNUM,asgshp.CMPCOD,asgshp.FLTSEQNUM,asgshp.FLTNUM,



									asgshp.FLTCARIDR,asgshp.SEQNUM,asgshp.DUPNUM,asgshp.MSTDOCNUM,asgshp.DOCOWRIDR) trkshp  ON


			 	bkgflt.DOCOWRIDR
= trkshp.DOCOWRIDR AND
			 	bkgflt.MSTDOCNUM = trkshp.MSTDOCNUM AND
			 	bkgflt.DUPNUM

= trkshp.DUPNUM
AND
			 	bkgflt.SEQNUM = trkshp.SEQNUM AND
			 	bkgflt.FLTCARIDR = trkshp.FLTCARIDR

AND
			 	bkgflt.FLTNUM
= trkshp.FLTNUM AND
			 	bkgflt.FLTSEQNUM = trkshp.FLTSEQNUM AND
			 	bkgflt.CMPCOD

= trkshp.CMPCOD

			LEFT OUTER JOIN OPRSHPMST shpmst ON
		 		bkgflt.DOCOWRIDR = shpmst.DOCOWRIDR
AND

			 	bkgflt.MSTDOCNUM
= shpmst.MSTDOCNUM AND
			 	bkgflt.DUPNUM = shpmst.DUPNUM AND
				bkgflt.SEQNUM
= shpmst.SEQNUM
AND

			 	bkgflt.CMPCOD = shpmst.CMPCOD
			WHERE bkgflt.CMPCOD = ? AND
		 		 bkgflt.FLTCARIDR
=
? AND
		  		bkgflt.FLTNUM
= ? AND
		  		bkgflt.FLTSEQNUM = ? AND
		  		(bkgflt.NUMPCS -   COALESCE(asgpcs,0)) > 0
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>201</QRY:Id>
		<QRY:Source Name="operations.flthandling.findOperationalULDAuditDetails" Type="NATIVE">
			<![CDATA[
				SELECT
					ACTCOD, UPDUSR, UPDTXNTIM,ADLINF, AUDRMK, STNCOD, ARPCOD
				FROM OPRULDAUD
				WHERE
				CMPCOD =? AND
				FLTCARIDR = ? AND
				ULDNUM = ? AND
				TRUNC(UPDTXNTIM) >= ?
		                AND TRUNC(UPDTXNTIM) <= ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>202</QRY:Id>
		<QRY:Source Name="operations.flthandling.findOperationalFlightDetails" Type="NATIVE">
			<![CDATA[
				SELECT
					ACTCOD, UPDUSR, UPDTXNTIM,ADLINF, AUDRMK, STNCOD
				FROM OPRFLTAUD
				WHERE
				CMPCOD =? AND
				ARPCOD = ? AND
				STNCOD =? AND
				FLTCARIDR = ? AND
				FLTSEQNUM = ? AND
				FLTNUM=? AND
				TRUNC(UPDTXNTIM) >= ?
				AND TRUNC(UPDTXNTIM) <= ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>203</QRY:Id>
		<QRY:Source Name="operations.flthandling.findFlightForULDForHHT" Type="NATIVE">
			<![CDATA[
					SELECT  ULD.CMPCOD ULDCMPCOD, ULD.ULDNUM ULDULDNUM,
						ULD.FLTCARIDR ULDFLTCARIDR, ULD.FLTNUM


ULDFLTNUM,
						ULD.FLTSEQNUM ULDFLTSEQNUM, ULD.POL ULDPOL,
						ULD.POU ULDPOU, ULD.CLSFLG ULDCLSFLG,



						ULD.LEGSERNUM ULDLEGSERNUM,
							EXPFLT.FLTDAT EXPFLTFLTDAT,
							EXPFLT.FLTSEQNUM EXPFLTFLTSEQNUM,



							FLTSEG.SEGSERNUM,
							(CASE ARLMST.APHCODUSE
							   WHEN 2
							      THEN ARLMST.TWOAPHCOD



							   ELSE ARLMST.THRAPHCOD
						     END) FLTCARCOD
					  FROM
						OPRULDDTL ULD
					  LEFT

OUTER JOIN
OPRARPEXPFLT EXPFLT ON
							     ULD.CMPCOD = EXPFLT.CMPCOD
							AND  ULD.FLTCARIDR
=
EXPFLT.FLTCARIDR

AND  ULD.FLTNUM = EXPFLT.FLTNUM
							AND  ULD.FLTSEQNUM = EXPFLT.FLTSEQNUM


							AND  ULD.LEGSERNUM
= EXPFLT.LEGSERNUM
							AND  ULD.POL = EXPFLT.ARPCOD
						LEFT OUTER JOIN
SHRARLMST
ARLMST ON

ULD.CMPCOD = ARLMST.CMPCOD
							AND  ULD.FLTCARIDR = ARLMST.ARLIDR

LEFT
OUTER JOIN OPRFLTSEG
FLTSEG ON
							     ULD.CMPCOD = FLTSEG.CMPCOD
							AND  ULD.FLTCARIDR
= FLTSEG.FLTCARIDR


AND  ULD.FLTNUM = FLTSEG.FLTNUM
							AND  ULD.FLTSEQNUM = FLTSEG.FLTSEQNUM

AND  ULD.POL = FLTSEG.POL



WHERE
						ULD.CMPCOD = ?
					    AND ULD.POL = ?

AND ULD.ULDNUM = ?
					    AND (ULD.CLSFLG

IS NULL OR ULD.CLSFLG <> 'Y')
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>222</QRY:Id>
		<QRY:Source Name="operations.flthandling.findImportFlightForULDForHHT" Type="NATIVE">
			<![CDATA[
					SELECT  ULD.CMPCOD ULDCMPCOD, ULD.ULDNUM ULDULDNUM,
						ULD.FLTCARIDR ULDFLTCARIDR, ULD.FLTNUM


ULDFLTNUM,
						ULD.FLTSEQNUM ULDFLTSEQNUM, ULD.POL ULDPOL,
						ULD.POU ULDPOU, ULD.CLSFLG ULDCLSFLG,



						ULD.LEGSERNUM ULDLEGSERNUM,
							IMPFLT.FLTDAT IMPFLTFLTDAT,
							IMPFLT.FLTOPRSTA
FLTOPRSTA,


							IMPFLT.FLTSEQNUM IMPFLTSEQNUM,
							(CASE ARLMST.APHCODUSE
							   WHEN
2
							      THEN
ARLMST.TWOAPHCOD

							   ELSE ARLMST.THRAPHCOD
						     END) FLTCARCOD

FROM

							OPRULDDTL ULD
					  	INNER JOIN OPRARPIMPFLT
IMPFLT ON
							     ULD.CMPCOD =
IMPFLT.CMPCOD

							AND  ULD.FLTCARIDR = IMPFLT.FLTCARIDR

							AND  ULD.FLTNUM = IMPFLT.FLTNUM

AND  ULD.FLTSEQNUM
= IMPFLT.FLTSEQNUM
							AND  ULD.LEGSERNUM
= IMPFLT.LEGSERNUM
							AND  ULD.POU
= IMPFLT.ARPCOD

						INNER JOIN SHRARLMST ARLMST ON

							     ULD.CMPCOD = ARLMST.CMPCOD

AND  ULD.FLTCARIDR
= ARLMST.ARLIDR
					 WHERE
							ULD.CMPCOD =
?
						    AND ULD.POU = ?

AND ULD.ULDNUM
= ?
						    AND (ULD.CLSFLG IS NULL OR ULD.CLSFLG <> 'Y')
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>223</QRY:Id>
		<QRY:Source Name="operations.flthandling.findtruckerlov" Type="NATIVE">
			<![CDATA[
				SELECT
					OPRTRK.CMPCOD, OPRTRK.TRKCOD, OPRTRK.TRKNAM
				FROM
					OPRTRKMST OPRTRK

				WHERE
					OPRTRK.CMPCOD=?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>223</QRY:Id>
		<QRY:Source Name="operations.flthandling.findBulkUnitMapping" Type="NATIVE">
			<![CDATA[
				SELECT	MPG.CMPCOD,MPG.UNTNUM,MPG.FLTCARIDR,MPG.FLTNUM,MPG.FLTSEQNUM,
				MPG.VEHFLG,MPG.LSTUPDTIM,MPG.LSTUPDUSR,EXPFLT.LEGSERNUM,MPG.POL,MPG.POU,EXPFLT.FLTDAT,



				(CASE ARLMST.APHCODUSE
				    WHEN 2
					 THEN ARLMST.TWOAPHCOD
					 ELSE ARLMST.THRAPHCOD


				END)
FLTCARCOD
				FROM OPRBLKUNTMPG MPG,OPRARPEXPFLT EXPFLT,SHRARLMST ARLMST
				WHERE

EXPFLT.CMPCOD

= MPG.CMPCOD
				      AND EXPFLT.FLTCARIDR = MPG.FLTCARIDR
				      AND EXPFLT.FLTNUM
= MPG.FLTNUM


				      AND EXPFLT.FLTSEQNUM = MPG.FLTSEQNUM
				      AND MPG.CMPCOD=ARLMST.CMPCOD

AND
MPG.FLTCARIDR=ARLMST.ARLIDR

			              AND MPG.CMPCOD =?

AND
MPG.UNTNUM = ?
			              AND EXPFLT.ARPCOD = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>223</QRY:Id>
		<QRY:Source Name="operations.flthandling.findBulkUnitMappingDetails" Type="NATIVE">
			<![CDATA[
				SELECT 	MPG.CMPCOD,MPG.UNTNUM,MPG.FLTCARIDR,MPG.FLTNUM,MPG.FLTSEQNUM,
						MPGDTL.DOCOWRIDR,MPGDTL.MSTDOCNUM,


MPGDTL.DUPNUM, MPGDTL.SEQNUM,MPGDTL.TRKNUM,MPG.POL,MPG.POU,
						(SELECT TRKPCS FROM OPRSHPTXNPCSGRP


SHPTRKNUM
						         WHERE    MPGDTL.TRKNUM=SHPTRKNUM.GRPIDR
							       AND  MPGDTL.DOCOWRIDR=SHPTRKNUM.DOCOWRIDR



AND  MPGDTL.MSTDOCNUM=SHPTRKNUM.MSTDOCNUM
			                       AND  MPGDTL.DUPNUM=SHPTRKNUM.DUPNUM



							       AND  MPGDTL.SEQNUM=SHPTRKNUM.SEQNUM		) TRKPCS,
						(SELECT TRKWGT FROM
OPRSHPTXNPCSGRP
SHPTRKNUM

						        WHERE    MPGDTL.TRKNUM=SHPTRKNUM.GRPIDR

AND  MPGDTL.DOCOWRIDR=SHPTRKNUM.DOCOWRIDR


							       AND  MPGDTL.MSTDOCNUM=SHPTRKNUM.MSTDOCNUM

AND  MPGDTL.DUPNUM=SHPTRKNUM.DUPNUM


							       AND  MPGDTL.SEQNUM=SHPTRKNUM.SEQNUM
) TRKWGT,
					    (SELECT STDWGT FROM OPRSHPMST
SHPMST

							     WHERE   MPGDTL.DOCOWRIDR=SHPMST.DOCOWRIDR

AND  MPGDTL.MSTDOCNUM=SHPMST.MSTDOCNUM


							     AND  MPGDTL.DUPNUM=SHPMST.DUPNUM

AND  MPGDTL.SEQNUM=SHPMST.SEQNUM		) STDWGT,

					   (SELECT
STDPCS FROM OPRSHPMST SHPMST

WHERE  MPGDTL.DOCOWRIDR=SHPMST.DOCOWRIDR
							   AND
MPGDTL.MSTDOCNUM=SHPMST.MSTDOCNUM


							   AND  MPGDTL.DUPNUM=SHPMST.DUPNUM
							   AND
MPGDTL.SEQNUM=SHPMST.SEQNUM		) STDPCS,

(CASE
ARLMST.APHCODUSE
					        WHEN 2

THEN ARLMST.TWOAPHCOD
					        ELSE ARLMST.THRAPHCOD


					        END) FLTCARCOD

					FROM OPRBLKUNTMPG MPG,OPRBLKUNTMPGDTL MPGDTL,SHRARLMST ARLMST

WHERE
MPG.CMPCOD=MPGDTL.CMPCOD
(+)
							       AND  MPG.UNTNUM=MPGDTL.UNTNUM (+)
							       AND
MPG.FLTCARIDR=MPGDTL.FLTCARIDR

(+)
							       AND  MPG.FLTNUM=MPGDTL.FLTNUM (+)
							       AND
MPG.FLTSEQNUM=MPGDTL.FLTSEQNUM

(+)
								   AND  MPG.CMPCOD=ARLMST.CMPCOD
							       AND  MPG.FLTCARIDR=ARLMST.ARLIDR



AND MPG.CMPCOD=?
							       AND MPG.UNTNUM=?
							       AND MPG.FLTCARIDR=?
							       AND

MPG.FLTNUM=?

AND MPG.FLTSEQNUM=?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>224</QRY:Id>
		<QRY:Source Name="operations.flthandling.findExportFlightForULDForHHT" Type="NATIVE">
			<![CDATA[
				SELECT  ULD.CMPCOD ULDCMPCOD, ULD.ULDNUM ULDULDNUM,
					ULD.FLTCARIDR ULDFLTCARIDR, ULD.FLTNUM ULDFLTNUM,



					ULD.FLTSEQNUM ULDFLTSEQNUM, ULD.POL ULDPOL,
				        ULD.POU ULDPOU, ULD.CLSFLG ULDCLSFLG,



				        ULD.LEGSERNUM ULDLEGSERNUM,
						EXPFLT.FLTDAT EXPFLTFLTDAT, EXPFLT.FLTSEQNUM EXPFLTFLTSEQNUM,



						(CASE ARLMST.APHCODUSE
					           WHEN 2
					              THEN ARLMST.TWOAPHCOD



ELSE ARLMST.THRAPHCOD
					     END) FLTCARCOD,SEGULD.THRUNT,EXPFLT.FLTOPRSTA,FLTSEG.SEGSERNUM,SEGULD.MFTFLG

ULDMFTFLG,SEGULD.ULDCTR,SEGULD.BSEFLG,
  SEGULD.BSEPLT

				  FROM
				  	OPRULDDTL ULD , OPRARPEXPFLT
EXPFLT , SHRARLMST ARLMST ,
OPRSEGULD SEGULD,

				    OPRFLTSEG FLTSEG
					WHERE

ULD.CMPCOD = EXPFLT.CMPCOD(+)

   						 AND  ULD.FLTCARIDR = EXPFLT.FLTCARIDR(+)


   						 AND  ULD.FLTNUM = EXPFLT.FLTNUM(+)

   						 AND  ULD.FLTSEQNUM = EXPFLT.FLTSEQNUM(+)

AND
ULD.LEGSERNUM = EXPFLT.LEGSERNUM(+)

							 AND  ULD.POL = EXPFLT.ARPCOD(+)


AND  ULD.CMPCOD
= ARLMST.CMPCOD(+)
   						 AND  ULD.FLTCARIDR
= ARLMST.ARLIDR(+)

							 AND  ULD.CMPCOD
= FLTSEG.CMPCOD(+)

							 AND  ULD.FLTCARIDR =
FLTSEG.FLTCARIDR(+)
							 AND  ULD.FLTNUM
= FLTSEG.FLTNUM(+)
							 AND  ULD.FLTSEQNUM
= FLTSEG.FLTSEQNUM(+)

AND  ULD.POL = FLTSEG.POL(+)

AND  ULD.POU = FLTSEG.POU(+)



AND  SEGULD.CMPCOD(+) = ULD.CMPCOD

AND  SEGULD.FLTCARIDR(+) = ULD.FLTCARIDR

							AND
SEGULD.FLTNUM (+)= ULD.FLTNUM
							AND
SEGULD.FLTSEQNUM(+) = ULD.FLTSEQNUM



   						 AND  SEGULD.ULDNUM(+) = ULD.ULDNUM

AND ULD.CMPCOD = ?
			 	    AND ULD.POL = ?

				    AND ULD.ULDNUM
= ?
			 	    AND (ULD.CLSFLG
IS NULL OR ULD.CLSFLG <> 'Y')
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>207</QRY:Id>
		<QRY:Source Name="opearations.flthandling.findCargoHandlingReportsData" Type="NATIVE">
			<![CDATA[
					SELECT MST.MSTDOCNUM, MST.DUPNUM, MST.SEQNUM, MST.DOCOWRIDR, MST.SHPPFX,
					       MST.ORGCOD,


MST.DSTCOD, MST.CNSNAM, MST.STDPCS, MST.STDWGT,
					       ARPSHP.ARPCOD, ARLSHP.OWNCARCOD, ARLSHP.OWNCARIDR,



ARLSHP.AVLPCS ARLSHPAVLPCS, ARLSHP.AVLWGT ARLSHPAVLWGT,
					       ARPSHP.AVLPCS ARPSHPAVLPCS, ARPSHP.AVLWGT


ARPSHPAVLWGT,ULDSHP.NUMPCS,ULDSHP.WGT,ULDSHP.ULDNUM,ULD.POU,
						   ULD.ULDDST,mst.SCCCOD,FLTDTL.FLTDAT,ULD.ULDCTR,MST.SHPDES



FROM OPRSHPMST MST, OPRARPSHP ARPSHP, OPRARPARLSHP ARLSHP,OPRULDSHP ULDSHP,OPRARPULD ULD,CAPBKGFLTDTL


FLTDTL
					 WHERE MST.MSTDOCNUM = ARPSHP.MSTDOCNUM
					   AND MST.DOCOWRIDR = ARPSHP.DOCOWRIDR



AND MST.DUPNUM = ARPSHP.DUPNUM
					   AND MST.SEQNUM = ARPSHP.SEQNUM
					   AND MST.CMPCOD = ARPSHP.CMPCOD



AND ARPSHP.MSTDOCNUM = ULDSHP.MSTDOCNUM(+)
					   AND ARPSHP.DOCOWRIDR = ULDSHP.DOCOWRIDR(+)



AND ARPSHP.DUPNUM = ULDSHP.DUPNUM(+)
					   AND ARPSHP.SEQNUM = ULDSHP.SEQNUM(+)
					   AND ARPSHP.ARPCOD


= ULDSHP.ARPCOD(+)
					   AND ARPSHP.CMPCOD = ULDSHP.CMPCOD(+)

					   AND ULDSHP.ARPCOD = ULD.ARPCOD(+)



AND ULDSHP.ULDNUM = ULD.ULDNUM(+)
					   AND ULDSHP.CMPCOD = ULD.CMPCOD(+)
					   AND ARPSHP.MSTDOCNUM


= ARLSHP.MSTDOCNUM
					   AND ARPSHP.DOCOWRIDR = ARLSHP.DOCOWRIDR
					   AND ARPSHP.DUPNUM = ARLSHP.DUPNUM



AND ARPSHP.SEQNUM = ARLSHP.SEQNUM
					   AND ARPSHP.ARPCOD = ARLSHP.ARPCOD
					   AND ARPSHP.CMPCOD


= ARLSHP.CMPCOD
					   AND ARPSHP.MSTDOCNUM = FLTDTL.MSTDOCNUM
					   AND ARPSHP.DOCOWRIDR = FLTDTL.DOCOWRIDR



AND ARPSHP.DUPNUM = FLTDTL.DUPNUM
					   AND ARPSHP.SEQNUM = FLTDTL.SEQNUM
					   AND ARPSHP.CMPCOD


= FLTDTL.CMPCOD
					   AND ARPSHP.ARPCOD = FLTDTL.FLTORG
						AND MST.DSTCOD <> ARPSHP.ARPCOD



					   AND ARLSHP.AVLPCS > 0
					   AND ARLSHP.DOCOWRIDR = ?
					   AND ARPSHP.ARPCOD = ?


   					   AND ARPSHP.CMPCOD = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>208</QRY:Id>
		<QRY:Source Name="opearations.flthandling.findCargoHandlingExportReportsData" Type="NATIVE">
			<![CDATA[
			SELECT MST.MSTDOCNUM, MST.DUPNUM, MST.SEQNUM, MST.DOCOWRIDR, MST.SHPPFX,
			       MST.ORGCOD, MST.DSTCOD,


MST.CNSNAM, MST.STDPCS, MST.STDWGT, SEG.FLTNUM,
			       SEG.FLTSEQNUM, SEG.BDPPCS, SEG.BDPWGT, EXPFLT.ARPCOD,


EXPFLT.FLTDAT,
			       EXPFLT.FLTCARCOD, EXPFLT.FLTNUM, FLTSEG.POL ARPCOD, FLTSEG.POU,

ULDSHP.ULDNUM,

ULDSHP.BDPPCS NUMPCS, ULDSHP.BDPWGT WGT, MST.SCCCOD,
				   MST.SHPDES, ULD.ULDCTR

FROM OPRSHPMST

MST,
			       OPRSEGSHP SEG,
			       OPRARPEXPFLT EXPFLT,
			       OPRFLTSEG FLTSEG,

OPRSEGULD

ULD,
			       OPRSEGULDSHP ULDSHP
			 WHERE MST.MSTDOCNUM = SEG.MSTDOCNUM
			   AND MST.DOCOWRIDR
=

SEG.DOCOWRIDR
			   AND MST.DUPNUM = SEG.DUPNUM
			   AND MST.SEQNUM = SEG.SEQNUM
			   AND MST.CMPCOD


= SEG.CMPCOD
			   AND SEG.FLTNUM = FLTSEG.FLTNUM
			   AND SEG.FLTSEQNUM = FLTSEG.FLTSEQNUM

AND

SEG.FLTCARIDR = FLTSEG.FLTCARIDR
			   AND SEG.SEGSERNUM = FLTSEG.SEGSERNUM
			   AND EXPFLT.CMPCOD

=
FLTSEG.CMPCOD
			   AND EXPFLT.FLTNUM = FLTSEG.FLTNUM
			   AND EXPFLT.FLTSEQNUM = FLTSEG.FLTSEQNUM



AND EXPFLT.FLTCARIDR = FLTSEG.FLTCARIDR
			   AND EXPFLT.ARPCOD = FLTSEG.POL
			   AND EXPFLT.CMPCOD


= FLTSEG.CMPCOD
			   AND SEG.MSTDOCNUM = ULDSHP.MSTDOCNUM
			   AND SEG.DOCOWRIDR = ULDSHP.DOCOWRIDR



			   AND SEG.DUPNUM = ULDSHP.DUPNUM
			   AND SEG.SEQNUM = ULDSHP.SEQNUM
			   AND SEG.CMPCOD = ULDSHP.CMPCOD



			   AND SEG.FLTNUM = ULDSHP.FLTNUM
			   AND SEG.FLTSEQNUM = ULDSHP.FLTSEQNUM
			   AND SEG.FLTCARIDR

= ULDSHP.FLTCARIDR

			   AND SEG.SEGSERNUM = ULDSHP.SEGSERNUM

			    AND SEG.CMPCOD = ULD.CMPCOD


			   AND SEG.FLTNUM = ULD.FLTNUM

			   AND SEG.FLTSEQNUM = ULD.FLTSEQNUM
			   AND SEG.FLTCARIDR
=
ULD.FLTCARIDR
			   AND SEG.SEGSERNUM = ULD.SEGSERNUM

			   AND ULDSHP.ULDNUM = ULD.ULDNUM


			   AND EXPFLT.CMPCOD = FLTSEG.CMPCOD
			   AND EXPFLT.FINFLG <> 'F'

			   AND EXPFLT.FLTCARIDR
=
?
			   AND EXPFLT.ARPCOD = ?
   			   AND EXPFLT.CMPCOD = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>209</QRY:Id>
		<QRY:Source Name="opearations.flthandling.findCargoHandlingImportReportsData" Type="NATIVE">
			<![CDATA[
			SELECT MST.MSTDOCNUM, MST.DUPNUM, MST.SEQNUM, MST.DOCOWRIDR, MST.SHPPFX,
			       MST.ORGCOD, MST.DSTCOD,


MST.CNSNAM, MST.STDPCS, MST.STDWGT,
			       ARPSHP.ARPCOD, ARLSHP.OWNCARCOD, ARLSHP.OWNCARIDR,



ARLSHP.AVLPCS ARLSHPAVLPCS, ARLSHP.AVLWGT ARLSHPAVLWGT,
			       ARPSHP.AVLPCS ARPSHPAVLPCS, ARPSHP.AVLWGT


ARPSHPAVLWGT,
			       ULD.ULDNUM,ULD.POU,ULDSHP.NUMPCS,ULDSHP.WGT,MST.SCCCOD,
			       FLTDTL.FLTDAT,ULD.ULDCTR,MST.SHPDES



FROM OPRSHPMST MST, OPRARPSHP ARPSHP, OPRARPARLSHP ARLSHP,CAPBKGFLTDTL FLTDTL,OPRARPULD ULD,OPRULDSHP


ULDSHP
			 WHERE MST.MSTDOCNUM = ARPSHP.MSTDOCNUM
			   AND MST.DOCOWRIDR = ARPSHP.DOCOWRIDR

AND

MST.DUPNUM = ARPSHP.DUPNUM
			   AND MST.SEQNUM = ARPSHP.SEQNUM
			   AND MST.CMPCOD = ARPSHP.CMPCOD



AND ARPSHP.MSTDOCNUM = ARLSHP.MSTDOCNUM
			   AND ARPSHP.DOCOWRIDR = ARLSHP.DOCOWRIDR
			   AND ARPSHP.DUPNUM


= ARLSHP.DUPNUM
			   AND ARPSHP.SEQNUM = ARLSHP.SEQNUM
			   AND ARPSHP.CMPCOD = ARLSHP.CMPCOD



AND ARPSHP.ARPCOD = ARLSHP.ARPCOD

			   AND ARPSHP.MSTDOCNUM = ULDSHP.MSTDOCNUM(+)
			   AND ARPSHP.DOCOWRIDR


= ULDSHP.DOCOWRIDR(+)
			   AND ARPSHP.DUPNUM = ULDSHP.DUPNUM(+)
			   AND ARPSHP.SEQNUM = ULDSHP.SEQNUM(+)



AND ARPSHP.CMPCOD = ULDSHP.CMPCOD(+)
			   AND ARPSHP.ARPCOD = ULDSHP.ARPCOD(+)

			   AND ULDSHP.ULDNUM


= ULD.ULDNUM(+)
			   AND ULDSHP.CMPCOD = ULD.CMPCOD(+)
			   AND ULDSHP.ARPCOD = ULD.ARPCOD(+)




AND ARPSHP.MSTDOCNUM = FLTDTL.MSTDOCNUM
			   AND ARPSHP.DOCOWRIDR = FLTDTL.DOCOWRIDR
			   AND ARPSHP.DUPNUM


= FLTDTL.DUPNUM
			   AND ARPSHP.SEQNUM = FLTDTL.SEQNUM
			   AND ARPSHP.CMPCOD = FLTDTL.CMPCOD



			   AND ARPSHP.ARPCOD = FLTDTL.FLTORG
			   AND (   (MST.DSTCOD = ARPSHP.ARPCOD AND ARPSHP.AVLPCS

> 0)

			        OR (    ARLSHP.AVLPCS > 0
			            AND ARLSHP.OWNCARIDR <> ?


			            AND MST.DSTCOD <> ARPSHP.ARPCOD

			           )
			  OR (   FLTDTL.FLTCARIDR<>?)


			       )
			   AND ARPSHP.ARPCOD = ?
   			   AND ARPSHP.CMPCOD = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>225</QRY:Id>
		<QRY:Source Name="operations.flthandling.findShipmentsForUldForHHT" Type="NATIVE">
			<![CDATA[

		 SELECT SHP.FLTCARIDR SHPFLTCARIDR, SHP.FLTNUM SHPFLTNUM,
				       SHP.FLTSEQNUM SHPFLTSEQNUM, SHP.SEGSERNUM


SHPSEGSERNUM,
				       SHP.ULDNUM SHPULDNUM, SHP.DOCOWRIDR SHPDOCOWRIDR,
				       SHP.MSTDOCNUM

SHPMSTDOCNUM,
SHP.DUPNUM SHPDUPNUM, SHP.SEQNUM SHPSEQNUM,
				       SHP.CMPCOD SHPCMPCOD, MST.SCCCOD

MSTSCCCOD, MST.SHPDES
MSTSHPDES,
				       MST.ORGCOD MSTORGCOD, MST.DSTCOD MSTDSTCOD, MST.STDWGTCOD

MSTSTDWGTCOD,

MST.STDDISWGT MSTSTDDISWGT, MST.PRDNAM MSTPRDNAM, MST.PRDPRT MSTPRDPRT,


				       MST.SHPPFX, MST.STDPCS,
MST.STDWGT, MST.GRSVOL, MST.CONFLG, MIS.SCICOD EURSTA,
					   MST.EXEFLG,
ARLSHP.AVLPCS
ARLSHPAVLPCS,

				       ARLSHP.AVLWGT ARLSHPAVLWGT, ARPSHP.AVLPCS, ARPSHP.AVLWGT,


				       ARPSHP.ARPCOD,ACC.JRNDAT,MST.PLTFLG,DTL.PLTUSEFLG,

				       SHPTRKNUMHIS.CMPCOD
TRKCMPCOD,
SHPTRKNUMHIS.DOCOWRIDR TRKDOCOWRIDR,
				       SHPTRKNUMHIS.MSTDOCNUM
TRKMSTDOCNUM, SHPTRKNUMHIS.DUPNUM

TRKDUPNUM,
					   SHPTRKNUMHIS.SEQNUM TRKSEQNUM,SHPTRKNUMHIS.GRPIDR PCSIDR, 
SHPTRKNUMHIS.TRKPCS,

SHPTRKNUMHIS.TRKWGT,
SHPTRKNUMHIS.TXNCOD, SHPTRKNUMHIS.TXNREFONE TRKTXNREFONE,

					   SHPTRKNUMHIS.TXNREFTWO
TRKTXNREFTWO,
SHPTRKNUMHIS.TXNREFTHR TRKTXNREFTHR,
					   SHPTRKNUMHIS.TXNREFFOR
TRKTXNREFFOR,SHPTRKNUMHIS.TXNREFFIV

TRKTXNREFFIV,
					   SHPTRKNUMHIS.TXNREFSIX TRKTXNREFSIX,SHPTRKNUMHIS.TXNREFSEV
TRKTXNREFSEV,


				       SHPTRKNUMHIS.TXNREFEGT, SHPTRKNUMHIS.TXNREFNIN, SHPTRKNUMHIS.TXNREFTEN,


SHPTRKNUMHIS.TXNCOD
TXNCOD
				  FROM OPRFLTSEG FLTSEG,
				       OPRSEGULDSHP SHP,
				       OPRSHPMST

MST,

				       OPRARPSHP ARPSHP,
				       OPRARPARLSHP ARLSHP,
				       OPRSHPMSTMIS
MIS,


				       OPRSHPTXNPCSGRPHIS SHPTRKNUMHIS,
				       OPRSHPMSTACC ACC,

OPRSHPDTL DTL
				 WHERE FLTSEG.FLTCARIDR

= SHP.FLTCARIDR
				   AND FLTSEG.FLTNUM = SHP.FLTNUM

AND FLTSEG.FLTSEQNUM = SHP.FLTSEQNUM


AND FLTSEG.SEGSERNUM = SHP.SEGSERNUM
				   AND FLTSEG.CMPCOD
= SHP.CMPCOD
				   AND MST.MSTDOCNUM
=
SHP.MSTDOCNUM
				   AND MST.DOCOWRIDR = SHP.DOCOWRIDR

AND MST.DUPNUM = SHP.DUPNUM
				   AND

MST.SEQNUM = SHP.SEQNUM
				   AND MST.CMPCOD = SHP.CMPCOD

AND MST.MSTDOCNUM = ARPSHP.MSTDOCNUM


AND MST.DOCOWRIDR = ARPSHP.DOCOWRIDR
				   AND MST.DUPNUM
= ARPSHP.DUPNUM
				   AND MST.SEQNUM = ARPSHP.SEQNUM


AND MST.CMPCOD = ARPSHP.CMPCOD

AND ARPSHP.MSTDOCNUM = ARLSHP.MSTDOCNUM
				   AND ARPSHP.DOCOWRIDR

= ARLSHP.DOCOWRIDR
				   AND ARPSHP.DUPNUM
= ARLSHP.DUPNUM
				   AND ARPSHP.SEQNUM = ARLSHP.SEQNUM


AND ARPSHP.CMPCOD = ARLSHP.CMPCOD

AND ARPSHP.ARPCOD = ARLSHP.ARPCOD
				   AND ARPSHP.ARPCOD
=
FLTSEG.POL
				   AND MST.MSTDOCNUM =
MIS.MSTDOCNUM
				   AND MST.DOCOWRIDR = MIS.DOCOWRIDR

				   AND
MST.DUPNUM = MIS.DUPNUM

AND MST.SEQNUM = MIS.SEQNUM
				   AND MST.CMPCOD = MIS.CMPCOD


				   AND MST.MSTDOCNUM = ACC.MSTDOCNUM

AND MST.DOCOWRIDR = ACC.DOCOWRIDR
				   AND MST.DUPNUM
= ACC.DUPNUM

				   AND MST.SEQNUM =
ACC.SEQNUM
				   AND MST.CMPCOD = ACC.CMPCOD
				   AND
MST.MSTDOCNUM = DTL.MSTDOCNUM


AND MST.DOCOWRIDR = DTL.DOCOWRIDR
				   AND MST.DUPNUM
= DTL.DUPNUM
				   AND MST.SEQNUM = DTL.SEQNUM


				   AND MST.CMPCOD = DTL.CMPCOD
				   AND
SHP.MSTDOCNUM = SHPTRKNUMHIS.MSTDOCNUM(+)
				   AND
SHP.DOCOWRIDR
= SHPTRKNUMHIS.DOCOWRIDR(+)

				   AND SHP.DUPNUM = SHPTRKNUMHIS.DUPNUM(+)

AND SHP.SEQNUM = SHPTRKNUMHIS.SEQNUM(+)


				   AND SHP.CMPCOD = SHPTRKNUMHIS.CMPCOD(+)

AND SHP.FLTNUM = SHPTRKNUMHIS.TXNREFTHR(+)
				   AND

SHP.FLTSEQNUM = SHPTRKNUMHIS.TXNREFSIX(+)

AND SHP.FLTCARIDR = SHPTRKNUMHIS.TXNREFTWO(+)


				   AND SHP.SEGSERNUM = SHPTRKNUMHIS.TXNREFFIV(+)

AND SHP.ULDNUM = SHPTRKNUMHIS.TXNREFSEV(+)


				   AND SHPTRKNUMHIS.TXNCOD(+) = 'BDP'


AND FLTSEG.FLTCARIDR = ?
				   AND FLTSEG.FLTNUM
= ?

				   AND FLTSEG.FLTSEQNUM = ?

AND FLTSEG.CMPCOD = ?
				   AND FLTSEG.POL = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>226</QRY:Id>
		<QRY:Source Name="operations.flthandling.findManifestedRevenueForCRM" Type="NATIVE">
			<![CDATA[
		SELECT SUM(DTL.NETCHG) REVENUE

		FROM
		    OPRARPEXPFLT FLT,
			OPRFLTSEG SEG,
			OPRSEGSHP SHP,



			OPRSHPRATDTL DTL

		WHERE

			  FLT.CMPCOD=SEG.CMPCOD
			AND	 FLT.FLTSEQNUM=SEG.FLTSEQNUM
			AND

FLT.FLTCARIDR=SEG.FLTCARIDR

			AND	 FLT.FLTNUM=SEG.FLTNUM


		    AND  SEG.CMPCOD=SHP.CMPCOD

AND
SEG.SEGSERNUM=SHP.SEGSERNUM

		    AND	 SEG.FLTSEQNUM=SHP.FLTSEQNUM
			AND	 SEG.FLTCARIDR=SHP.FLTCARIDR


			AND	 SEG.FLTNUM=SHP.FLTNUM


			AND SHP.CMPCOD=DTL.CMPCOD
			AND	SHP.DUPNUM=DTL.DUPNUM
			AND
SHP.DOCOWRIDR=DTL.DOCOWRIDR

			AND	SHP.MSTDOCNUM=DTL.MSTDOCNUM



			AND FLT.CMPCOD=?
			AND FLT.FLTCARCOD=?

AND FLT.FLTNUM=?

			AND FLT.FLTDAT BETWEEN ? AND ?
			AND
SEG.POL=?
			AND SEG.POU=?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>227</QRY:Id>
		<QRY:Source Name="operations.flthandling.findbulkunitsforflight" Type="NATIVE">
			<![CDATA[
			SELECT	MPG.CMPCOD,MPG.UNTNUM,MPG.FLTCARIDR,MPG.FLTNUM,MPG.FLTSEQNUM,
				MPG.VEHFLG,MPG.LSTUPDTIM,MPG.LSTUPDUSR,MPG.POL,MPG.POU
			FROM OPRBLKUNTMPG MPG
			       AND MPG.CMPCOD=?
			       AND MPG.FLTCARIDR=?
			       AND MPG.FLTNUM=?
			       AND MPG.FLTSEQNUM=?
			       AND MPG.POL=?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>228</QRY:Id>
		<QRY:Source Name="operations.manifest.findmanifestedawbs" Type="NATIVE">
			<![CDATA[
		SELECT  SHP.DOCOWRIDR,SHP.MSTDOCNUM,SHP.DUPNUM,SHP.SEQNUM,MST.SHPPFX,MST.SCCCOD
		FROM OPRSEGSHP  SHP JOIN OPRSHPMST MST ON
		SHP.CMPCOD=MST.CMPCOD
		AND SHP.DOCOWRIDR=MST.DOCOWRIDR
		AND SHP.MSTDOCNUM=MST.MSTDOCNUM
		AND SHP.DUPNUM=MST.DUPNUM
		AND SHP.SEQNUM=MST.SEQNUM
		WHERE SHP.CMPCOD=?
		  AND SHP.FLTCARIDR=?
		  AND SHP.FLTNUM=?
		  AND SHP.FLTSEQNUM=?



			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>229</QRY:Id>
		<QRY:Source Name="operations.manifest.findovermanifestedshipments" Type="NATIVE">
			<![CDATA[


			SELECT DISTINCT MST.MSTDOCNUM,MST.SHPPFX,
			        FLT.CFRWGT BKDWGT, FLT.CFRPCS BKDPCS, ARPSHP.BDPPCS,



			       ARPSHP.BDPWGT
			  FROM CAPBKGMST MST,
			       CAPBKGFLTDTL FLT,
			       OPRFLTSEG OPRSEG,



			       OPRSEGSHP SEGSHP,
			       OPRARPSHP ARPSHP
			 WHERE MST.CMPCOD = FLT.CMPCOD
			   AND
MST.UBRNUM
=
FLT.UBRNUM
			   AND FLT.CMPCOD = OPRSEG.CMPCOD
			   AND FLT.FLTCARIDR = OPRSEG.FLTCARIDR

AND

FLT.FLTNUM = OPRSEG.FLTNUM
			   AND FLT.FLTSEQNUM = OPRSEG.FLTSEQNUM
			   AND FLT.SEGSERNUM =
OPRSEG.SEGSERNUM


			   AND FLT.FLTORG = OPRSEG.POL
			   AND FLT.FLTDST = OPRSEG.POU
			   AND
OPRSEG.CMPCOD = SEGSHP.CMPCOD


			   AND OPRSEG.FLTCARIDR = SEGSHP.FLTCARIDR
			   AND OPRSEG.FLTNUM
= SEGSHP.FLTNUM
			   AND OPRSEG.FLTSEQNUM

= SEGSHP.FLTSEQNUM
			   AND OPRSEG.SEGSERNUM = SEGSHP.SEGSERNUM

AND SEGSHP.CMPCOD = FLT.CMPCOD


			   AND SEGSHP.MSTDOCNUM = FLT.MSTDOCNUM
			   AND SEGSHP.DOCOWRIDR
= FLT.DOCOWRIDR
			   AND SEGSHP.SEQNUM

= FLT.SEQNUM
			   AND SEGSHP.DUPNUM = FLT.DUPNUM
			   AND
SEGSHP.CMPCOD = ARPSHP.CMPCOD
			   AND
SEGSHP.MSTDOCNUM
= ARPSHP.MSTDOCNUM
			   AND SEGSHP.DOCOWRIDR
= ARPSHP.DOCOWRIDR
			   AND SEGSHP.SEQNUM
= ARPSHP.SEQNUM

			   AND SEGSHP.DUPNUM = ARPSHP.DUPNUM


AND FLT.FLTBKGSTA = 'C'
			   AND
FLT.CFRPCS>0
			   AND ARPSHP.BDPPCS
> FLT.CFRPCS
			   AND FLT.CMPCOD
= ?
			   AND ARPSHP.ARPCOD(+)
= ?
			   AND FLT.FLTSEQNUM = ?

			   AND FLT.FLTNUM = ?

AND FLT.FLTCARIDR = ?



			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>230</QRY:Id>
		<QRY:Source Name="operations.manifest.findULDManifestDetailsReport" Type="NATIVE">
			<![CDATA[

			SELECT ULDNUM,CONIDR FROM OPRSEGULD
			WHERE
			CMPCOD=?
			AND FLTCARIDR=?
			AND FLTNUM=?
			AND FLTSEQNUM=?
			AND ULDNUM NOT IN ('BULK')

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>231</QRY:Id>
		<QRY:Source Name="operaions.flthandling.findPendingShipmentsForBreakdown" Type="NATIVE">
			<![CDATA[

			SELECT 	  SHPMST.DOCOWRIDR, SHPMST.MSTDOCNUM,SHPMST.SHPPFX,
				      SHPMST.OWRCOD, SHPMST.DSTCOD,SHPMST.SCCCOD,



					  ULDSHP.RCVPCS, ULDSHP.RCVWGT, ULDSHP.RCVVOL,ULDSHP.MFTPCS, ULDSHP.MFTWGT
			FROM 	  OPRFLTSEG

FLTSEG,

				      OPRSEGULDSHP ULDSHP,
				      OPRSHPMST SHPMST
			WHERE 	  SHPMST.DOCOWRIDR

= ULDSHP.DOCOWRIDR(+)

				  AND SHPMST.MSTDOCNUM = ULDSHP.MSTDOCNUM(+)
				  AND SHPMST.DUPNUM

= ULDSHP.DUPNUM(+)
				  AND SHPMST.CMPCOD
= ULDSHP.CMPCOD(+)
				  AND ULDSHP.FLTCARIDR = FLTSEG.FLTCARIDR


AND ULDSHP.FLTNUM = FLTSEG.FLTNUM

AND ULDSHP.FLTSEQNUM = FLTSEG.FLTSEQNUM
				  AND ULDSHP.SEGSERNUM

= FLTSEG.SEGSERNUM
				  AND ULDSHP.CMPCOD
= FLTSEG.CMPCOD
				  AND (ULDSHP.MFTPCS-ULDSHP.RCVPCS)
>
0
				  AND ULDSHP.ULDNUM = ?
				  AND ULDSHP.FLTCARIDR
= ?
				  AND ULDSHP.FLTNUM = ?
				  AND
ULDSHP.FLTSEQNUM
= ?
				  AND ULDSHP.CMPCOD = ?
				  AND FLTSEG.POU = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<!-- Added by Soumya Manuel -->
	<QRY:Definition>
		<QRY:Id>231</QRY:Id>
		<QRY:Source Name="operations.flthandling.findExportFlightForBulk" Type="NATIVE">
			<![CDATA[
					SELECT  ULD.CMPCOD ULDCMPCOD, ULD.ULDNUM ULDULDNUM,
						ULD.FLTCARIDR ULDFLTCARIDR, ULD.FLTNUM


ULDFLTNUM,
						ULD.FLTSEQNUM ULDFLTSEQNUM, ULD.POL ULDPOL,
					        ULD.POU ULDPOU, ULD.CLSFLG


ULDCLSFLG,
					        ULD.LEGSERNUM ULDLEGSERNUM,
							EXPFLT.FLTDAT EXPFLTFLTDAT, EXPFLT.FLTSEQNUM


EXPFLTFLTSEQNUM,
							(CASE ARLMST.APHCODUSE
						           WHEN 2
						              THEN ARLMST.TWOAPHCOD



						           ELSE ARLMST.THRAPHCOD
						     END) FLTCARCOD,MPG.UNTNUM,MPG.VEHFLG
					  FROM


					  	OPRULDDTL ULD
, OPRARPEXPFLT EXPFLT , SHRARLMST ARLMST ,
						OPRBLKUNTMPG MPG
						WHERE


						 	      ULD.CMPCOD
= EXPFLT.CMPCOD(+)
	   						 AND  ULD.FLTCARIDR = EXPFLT.FLTCARIDR(+)

AND  ULD.FLTNUM
= EXPFLT.FLTNUM(+)

AND  ULD.FLTSEQNUM = EXPFLT.FLTSEQNUM(+)
	   						 AND
ULD.LEGSERNUM
= EXPFLT.LEGSERNUM(+)

AND  ULD.POL = EXPFLT.ARPCOD

	   						 AND  ULD.CMPCOD
= ARLMST.CMPCOD(+)

	   						 AND  ULD.FLTCARIDR
= ARLMST.ARLIDR(+)

	   						 AND  ULD.CMPCOD
= MPG.CMPCOD(+)
	   					     AND
ULD.ULDNUM = MPG.UNTNUM(+)

	   						 AND  ULD.FLTCARIDR
= MPG.FLTCARIDR(+)
	   						 AND
ULD.FLTNUM = MPG.FLTNUM(+)
	   						 AND  ULD.FLTSEQNUM
= MPG.FLTSEQNUM(+)

AND  ULD.POL
= MPG.POL(+)


				 		AND ULD.CMPCOD = ?
				 	    AND ULD.POL
= ?
					    AND ULD.ULDNUM
= ?

				 	    AND (ULD.CLSFLG IS NULL OR ULD.CLSFLG <> 'Y')
			]]>
		</QRY:Source>
	</QRY:Definition>
	<!-- Added by Soumya Manuel -->
	<QRY:Definition>
		<QRY:Id>232</QRY:Id>
		<QRY:Source Name="operations.flthandling.checkbulkunitexists" Type="NATIVE">
			<![CDATA[
					 SELECT 'Y' AS BULKFLAG  FROM OPRBLKUNTMPG MPG
					    WHERE MPG.CMPCOD=?
					      AND MPG.UNTNUM=?
					      AND MPG.POL=?
      					      AND MPG.VEHFLG='N'
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>233</QRY:Id>
		<QRY:Source Name="operations.flthandling.findbreakdowndetailsforsendingpkg" Type="NATIVE">
			<![CDATA[

					 SELECT  SHPMST.CMPCOD,SHPMST.DOCOWRIDR, SHPMST.MSTDOCNUM,
						 SHPMST.SEQNUM,SHPMST.DUPNUM,SHPMST.SHPPFX,



						 SHPMST.SCCCOD, SHPMST.SHPDES,
						 DMG.DMGCOD DMGDMGCOD,
							 BDNDTL.ULDNUM,BDNDTL.CMPCOD,BDNDTL.FLTCARIDR,BDNDTL.FLTSEQNUM,



							 BDNDTL.FLTNUM,BDNDTL.RCVPCS,BDNDTL.RCVWGT,
						 BDNDTL.WHSCOD,BDNDTL.LOCCOD,ULDSHP.MFTWGT,ULDSHP.MFTPCS



					    FROM OPRSHPBDNDTL BDNDTL LEFT OUTER JOIN OPRDMGDTL DMG ON
							 BDNDTL.CMPCOD = DMG.CMPCOD



					   AND	 BDNDTL.MSTDOCNUM = DMG.MSTDOCNUM
					   AND	 BDNDTL.DOCOWRIDR = DMG.DOCOWRIDR


					   AND   BDNDTL.SEQNUM
= DMG.SEQNUM
					   AND   BDNDTL.DUPNUM = DMG.DUPNUM
					   AND   BDNDTL.FLTCARIDR

= DMG.FLTCARIDR

AND   BDNDTL.FLTNUM = DMG.FLTNUM
					   AND   BDNDTL.FLTSEQNUM = DMG.FLTSEQNUM


							 INNER JOIN OPRSHPMST
SHPMST ON
						 BDNDTL.CMPCOD = SHPMST.CMPCOD
					   AND	 BDNDTL.MSTDOCNUM
=
SHPMST.MSTDOCNUM

AND	 BDNDTL.DOCOWRIDR = SHPMST.DOCOWRIDR
					   AND   BDNDTL.SEQNUM = SHPMST.SEQNUM


AND   BDNDTL.DUPNUM
= SHPMST.DUPNUM
							 INNER JOIN OPRSEGULDSHP ULDSHP ON
							 BDNDTL.CMPCOD

= ULDSHP.CMPCOD

					   AND	 BDNDTL.MSTDOCNUM = ULDSHP.MSTDOCNUM
					   AND	 BDNDTL.DOCOWRIDR

= ULDSHP.DOCOWRIDR
					   AND
BDNDTL.SEQNUM = ULDSHP.SEQNUM
					   AND   BDNDTL.DUPNUM = ULDSHP.DUPNUM


					   AND 	 BDNDTL.ULDNUM
= ULDSHP.ULDNUM
					   WHERE   BDNDTL.CMPCOD = ?
					   AND   BDNDTL.FLTCARIDR

= ?
					   AND   BDNDTL.FLTNUM
= ?
					   AND   BDNDTL.FLTSEQNUM = ?
					   AND   BDNDTL.ULDNUM
=
?
					   AND   BDNDTL.WHSCOD = ?



			]]>
		</QRY:Source>
	</QRY:Definition>
	<!-- Added by Ajith Paul -->
	<QRY:Definition>
		<QRY:Id>234</QRY:Id>
		<QRY:Source Name="operations.flthandling.findbreakdowndetailsforsendinghpk" Type="NATIVE">
			<![CDATA[

				 SELECT   SHPMST.CMPCOD, SHPMST.DOCOWRIDR,
					  SHPMST.MSTDOCNUM, SHPMST.SEQNUM,
					  SHPMST.DUPNUM,


SHPMST.DOCNUM,
					  SHPMST.SCCCOD, SHPMST.SHPDES,
					  SHPMST.SHPPFX, DMG.DMGCOD, IMPFLT.FLTDAT,



					  IMPFLT.FLTCARCOD, BDNHIS.STRTIM,
					  BDNHIS.ENDTIM, BDNHIS.ARPCOD,
					  BDNHIS.BDNUSR,
BDNHIS.SERNUM,


					  BDNDTL.ULDNUM, BDNDTL.FLTCARIDR,
					  BDNDTL.FLTSEQNUM, BDNDTL.FLTNUM,

BDNDTL.RCVPCS,
BDNDTL.RCVWGT,

					  BDNDTL.WHSCOD, BDNDTL.LOCCOD

				 FROM OPRSHPBDNDTL BDNDTL
INNER JOIN
OPRSHPMST SHPMST ON

					  BDNDTL.CMPCOD
= SHPMST.CMPCOD
				      AND BDNDTL.MSTDOCNUM
= SHPMST.MSTDOCNUM

				      AND BDNDTL.DOCOWRIDR = SHPMST.DOCOWRIDR

AND BDNDTL.SEQNUM
= SHPMST.SEQNUM
				      AND BDNDTL.DUPNUM
= SHPMST.DUPNUM

				LEFT OUTER JOIN OPRDMGDTL
DMG ON

BDNDTL.CMPCOD = DMG.CMPCOD
				      AND
BDNDTL.MSTDOCNUM = DMG.MSTDOCNUM
				      AND
BDNDTL.DOCOWRIDR
= DMG.DOCOWRIDR
				      AND BDNDTL.SEQNUM
= DMG.SEQNUM
				      AND BDNDTL.DUPNUM
= DMG.DUPNUM

AND BDNDTL.FLTCARIDR = DMG.FLTCARIDR

				      AND BDNDTL.FLTNUM = DMG.FLTNUM


AND BDNDTL.FLTSEQNUM = DMG.FLTSEQNUM
				INNER JOIN
OPRARPIMPFLT IMPFLT ON
					  BDNDTL.CMPCOD = IMPFLT.CMPCOD


				      AND BDNDTL.FLTCARIDR
= IMPFLT.FLTCARIDR
				      AND BDNDTL.FLTSEQNUM = IMPFLT.FLTSEQNUM

AND
BDNDTL.FLTNUM = IMPFLT.FLTNUM

				INNER JOIN OPRULDBDNHIS BDNHIS ON
					  BDNDTL.CMPCOD =
BDNHIS.CMPCOD

				      AND BDNDTL.FLTCARIDR
= BDNHIS.FLTCARIDR
				      AND BDNDTL.FLTSEQNUM
= BDNHIS.FLTSEQNUM
				      AND
BDNDTL.FLTNUM = BDNHIS.FLTNUM


				WHERE 		 BDNDTL.CMPCOD = ?

AND   BDNDTL.FLTCARIDR = ?

					   AND   BDNDTL.FLTNUM =
?
					   AND   BDNDTL.FLTSEQNUM = ?


			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>235</QRY:Id>
		<QRY:Source Name="operaions.flthandling.findXrayLogDtls" Type="NATIVE">
			<![CDATA[

				SELECT
					CMPCOD, FLTNUM, FLTCARIDR, FLTCARCOD, FLTSEQNUM, LEGSERNUM, FLTDAT,
					DUPNUM, SEQNUM, DOCOWRIDR, MSTDOCNUM,ARPCOD,
					SHPPFX, XRYRMK, XRYSTA, XRYSTRDAT, XRYENDDAT, LSTUPDTIM, LSTUPDUSR,USRCOD
				FROM
					OPRXRYSHP XRY
				WHERE
					XRY.CMPCOD = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>236</QRY:Id>
		<QRY:Source Name="operations.flthandling.findexportflightsforshipment" Type="NATIVE">
			<![CDATA[
		SELECT EXPFLT.FLTNUM FLTNUM, EXPFLT.FLTCARCOD FLTOWN, EXPFLT.FLTDAT EXPFLTDAT, EXPFLT.LEGSERNUM,EXPFLT.FLTCARIDR,EXPFLT.FLTSEQNUM,SEG.POL,SEG.POU



					  FROM OPRARPEXPFLT EXPFLT, OPRSEGSHP SHP, OPRFLTSEG SEG
					 WHERE EXPFLT.FLTNUM = SEG.FLTNUM



					   AND EXPFLT.FLTCARIDR = SEG.FLTCARIDR
					   AND EXPFLT.FLTSEQNUM = SEG.FLTSEQNUM
					   AND

EXPFLT.CMPCOD
= SEG.CMPCOD
					   AND EXPFLT.ARPCOD = SEG.POL
					   AND SEG.FLTNUM = SHP.FLTNUM


AND SEG.FLTCARIDR
= SHP.FLTCARIDR
					   AND SEG.FLTSEQNUM = SHP.FLTSEQNUM
					   AND SEG.SEGSERNUM

= SHP.SEGSERNUM

AND SEG.CMPCOD = SHP.CMPCOD
					   AND SHP.CMPCOD = ?
					   AND SHP.DOCOWRIDR

= ?
					   AND SHP.MSTDOCNUM
= ?
					   AND SHP.DUPNUM = ?
					   AND SHP.SEQNUM = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>236</QRY:Id>
		<QRY:Source Name="operaions.flthandling.findXrayLogDtlsForReport" Type="NATIVE">
			<![CDATA[

					SELECT
						XRY.CMPCOD CMPCOD, XRY.FLTNUM FLTNUM, XRY.FLTCARIDR FLTCARIDR,
						XRY.FLTDAT FLTDAT, XRY.MSTDOCNUM MSTDOCNUM,XRY.SHPPFX SHPPFX, XRYRMK, XRYSTA, XRYSTRDAT, XRYENDDAT,
						XRY.LSTUPDTIM LSTUPDTIM, XRY.LSTUPDUSR LSTUPDUSR,MST.AGTNAM AGTNAM,MST.STDPCS STDPCS
					FROM
						OPRXRYSHP XRY,OPRSHPMST MST
					WHERE
						XRY.CMPCOD = MST.CMPCOD AND
						XRY.MSTDOCNUM = MST.MSTDOCNUM
						AND XRY.CMPCOD = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>237</QRY:Id>
		<QRY:Source Name="operations.flthandling.findOprULDAuditDetails" Type="NATIVE">
			<![CDATA[
				SELECT
					CASE
					WHEN OPR.ACTCOD = 'BDPCRT'
						 THEN 'BUILD-UP'
						 ELSE 'BREAK-DOWN'



					END STA , OPR.ULDNUM ,FLT.TALNUM ,OPR.UPDTXNTIM,OPR.ADLINF, OPR.AUDRMK,OPR.STNCOD,OPR.FLTNUM,OPR.ARPCOD,OPR.FLTCARIDR,MST.FLTDAT



				FROM OPRULDAUD OPR ,FLTOPRLEG FLT,FLTOPRMST MST
				WHERE	FLT.CMPCOD = OPR.CMPCOD
					AND FLT.FLTCARIDR


= OPR.FLTCARIDR
					AND FLT.FLTSEQNUM = OPR.FLTSEQNUM
					AND FLT.FLTNUM = OPR.FLTNUM
					AND FLT.FLTCARIDR


= MST.FLTCARIDR
					AND FLT.FLTSEQNUM = MST.FLTSEQNUM
					AND FLT.CMPCOD = MST.CMPCOD
					AND FLT.FLTNUM


= MST.FLTNUM
					AND (FLT.LEGORG = OPR.ARPCOD AND OPR.ACTCOD = 'BDPCRT' OR FLT.LEGDST = OPR.ARPCOD

AND
OPR.ACTCOD = 'BDNCRT')
					AND OPR.CMPCOD = ?
					AND OPR.ULDNUM = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>238</QRY:Id>
		<QRY:Source Name="operations.flthandling.findDetailsforUldAcc" Type="NATIVE">
			<![CDATA[
				SELECT  ULDACP.CMPCOD , ULDACP.ULDNUM ,
					ULDACP.FLTCARIDR , ULDACP.FLTNUM ,
					ULDACP.FLTSEQNUM


ULDACCFLTSEQNUM, ULDACP.POU,
					ULDACP.ARPCOD,EXPFLT.FLTDAT , EXPFLT.FLTSEQNUM,
					(CASE ARLMST.APHCODUSE



					  WHEN 2
					  THEN ARLMST.TWOAPHCOD
					  ELSE ARLMST.THRAPHCOD
					  END) FLTCARCOD


				  FROM

					OPRULDACP ULDACP
				  LEFT OUTER JOIN OPRARPEXPFLT EXPFLT ON
					     ULDACP.CMPCOD

= EXPFLT.CMPCOD

					AND  ULDACP.FLTCARIDR = EXPFLT.FLTCARIDR
					AND  ULDACP.FLTNUM = EXPFLT.FLTNUM


					AND  ULDACP.FLTSEQNUM
= EXPFLT.FLTSEQNUM
				  LEFT OUTER JOIN SHRARLMST ARLMST ON
						  ULDACP.CMPCOD

= ARLMST.CMPCOD

					 AND  ULDACP.FLTCARIDR = ARLMST.ARLIDR
				WHERE
					ULDACP.CMPCOD = ?


				    AND ULDACP.ARPCOD = ?

				    AND ULDACP.ULDNUM = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>239</QRY:Id>
		<QRY:Source Name="operations.flthandling.findUldForFlightSegment" Type="NATIVE">
			<![CDATA[
		SELECT  ULD.ULDNUM,
			ULD.ULDCTR,
			ULD.ACTWGT,
			ULD.ULDDST,
			SEG.POL,
			SEG.POU,
			SEG.SEGSERNUM,
			ULD.LOCCOD
		FROM OPRFLTSEG SEG, OPRSEGULD ULD
		WHERE SEG.CMPCOD = ULD.CMPCOD
		AND SEG.FLTCARIDR = ULD.FLTCARIDR
		AND SEG.FLTNUM = ULD.FLTNUM
		AND SEG.FLTSEQNUM = ULD.FLTSEQNUM
		AND SEG.SEGSERNUM = ULD.SEGSERNUM
		AND SEG.CMPCOD = ?
		AND SEG.FLTCARIDR = ?
		AND SEG.FLTNUM = ?
		AND SEG.FLTSEQNUM = ?
     		AND SEG.POL = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>240</QRY:Id>
		<QRY:Source Name="operations.flthandling.outbound.ctm" Type="NATIVE">
			<![CDATA[
								 SELECT MST.STDWGTCOD STDWGTCOD,MST.STDWGT STDWGT,MST.GRSVOLUNT STDVOLUNT,
									  MST.GRSVOL


STDVOL,MST.STDPCS STDPCS, MST.SHPPFX ,
									  MST.SHPDES SHPDCL,MST.SCCCOD SCCCOD,MST.ORGCOD ORGCOD


,
							          MST.DOCNUM ,MST.MSTDOCNUM ,MST.DSTCOD DSTCOD ,MST.PLTFLG ,
									  MST.STDDISWGT


DISSTDWGT,MST.GRSDISVOL DISSTDVOL,MST.CONFLG  ,
									  MST.EXEFLG,MST.DUPNUM , MST.DOCOWRIDR ,
MST.CMPCOD,MST.SEQNUM

,
							          ARPSHP.AVLPCS ,ARPSHP.AVLWGT,ARPSHP.AVLVOL,AGTGRP.GRPNAM
AGTGRP,MST.AGTCOD


									   FROM OPRARPIMPFLT IMPFLT
									INNER JOIN OPRFLTSEG FLTSEG

ON FLTSEG.CMPCOD
= IMPFLT.CMPCOD

									AND FLTSEG.FLTNUM     = IMPFLT.FLTNUM
									AND
FLTSEG.FLTSEQNUM
= IMPFLT.FLTSEQNUM
									AND
FLTSEG.FLTCARIDR  = IMPFLT.FLTCARIDR
									AND
FLTSEG.POU
= IMPFLT.ARPCOD
									INNER JOIN
OPRSEGULDSHP ULDSHP
										 ON FLTSEG.CMPCOD
= ULDSHP.CMPCOD

AND FLTSEG.FLTNUM     = ULDSHP.FLTNUM

AND FLTSEG.FLTSEQNUM  = ULDSHP.FLTSEQNUM

AND
FLTSEG.FLTCARIDR  = ULDSHP.FLTCARIDR
									AND
FLTSEG.SEGSERNUM  = ULDSHP.SEGSERNUM

INNER
JOIN OPRSHPMST MST
										 ON MST.CMPCOD = ULDSHP.CMPCOD

AND MST.MSTDOCNUM  = ULDSHP.MSTDOCNUM


AND MST.DOCOWRIDR  = ULDSHP.DOCOWRIDR
									AND MST.SEQNUM
= ULDSHP.SEQNUM
									AND MST.DUPNUM

= ULDSHP.DUPNUM
									AND MST.DSTCOD    != IMPFLT.ARPCOD

INNER JOIN OPRARPSHP ARPSHP


ON MST.CMPCOD = ARPSHP.CMPCOD
									AND MST.MSTDOCNUM  = ARPSHP.MSTDOCNUM

AND MST.DOCOWRIDR

= ARPSHP.DOCOWRIDR
									AND MST.SEQNUM     = ARPSHP.SEQNUM
									AND MST.DUPNUM
= ARPSHP.DUPNUM


AND ARPSHP.SEQNUM  = 1
									AND FLTSEG.POU     = ARPSHP.ARPCOD

LEFT OUTER JOIN WHSOPRSHPLOC

SHPLOC
										 ON MST.CMPCOD = SHPLOC.CMPCOD
									AND MST.MSTDOCNUM
= SHPLOC.MSTDOCNUM


AND MST.DOCOWRIDR  = SHPLOC.DOCOWRIDR
									AND MST.SEQNUM     = SHPLOC.SEQNUM

AND MST.DUPNUM

= SHPLOC.DUPNUM
									AND FLTSEG.POU     = SHPLOC.ARPCOD
										LEFT OUTER JOIN
WHSSHPTRKNUMDTL

WHSDTL
																			 ON SHPLOC.ARPCOD     = WHSDTL.ARPCOD
																		AND
SHPLOC.WHSCOD

= WHSDTL.WHSCOD
																		AND SHPLOC.STUCOD     = WHSDTL.STUCOD
									AND
SHPLOC.LOCCOD

= WHSDTL.LOCCOD
									LEFT OUTER JOIN SHRGENMSTGRPDTL AGTGRP
									ON MST.CMPCOD
= AGTGRP.CMPCOD


									AND MST.AGTCOD = AGTGRP.GRPENT
									AND AGTGRP.GRPCATCOD = 'GEN'

WHERE IMPFLT.CMPCOD

= ?
									AND IMPFLT.FLTNUM     = ?
									AND IMPFLT.FLTCARIDR  = ?

AND IMPFLT.FLTSEQNUM

= ?
									AND IMPFLT.LEGSERNUM  = ?
									AND IMPFLT.ARPCOD     = ?



							        AND ARPSHP.TFROUTPCS = 0
									AND ARPSHP.AVLPCS > 0
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>241</QRY:Id>
		<QRY:Source Name="operations.flthandling.findShipmentsToPort" Type="NATIVE">
			<![CDATA[
				SELECT SEGORGSTN.CNTCOD||FLTSEG.SEGORG SEGORG, FLTSEG.SEGDST, SEGDSTSTN.CNTCOD SEGDSTCNT, LEG.LEGORG,


LEG.LEGDST, NVL(LEG.ETA,LEG.STA) STA,
					SEGSHP.FLTCARIDR, SEGSHP.CMPCOD, LTRIM(SEGSHP.FLTNUM,0)
FLTNUM,

SEGSHP.FLTSEQNUM, SEGSHP.DOCOWRIDR,
					SEGSHP.SHPPFX, SEGSHP.MSTDOCNUM, SEGSHP.MFTPCS, SEGSHP.MFTWGT,


SEGSHP.MFTVOL,SEGSHP.RCVPCS,SEGSHP.RCVWGT,SEGSHP.RCVVOL,ARL.APHCODUSE,
					ARL.TWOAPHCOD, ARL.THRAPHCOD,


SHPMST.CNSNAM, SHPMST.SHPNAM, SHPMST.DTACPTFLG, SHPMST.DSTCOD,AWBORGSTN.CNTCOD||SHPMST.ORGCOD ORGCOD,



					SHPMST.STDPCS,SHPMST.STDWGT,SHPMST.STDWGTCOD,SHPMST.CNSADRONE, SHPMST.CURCOD,SHPMST.SHPDES,


					SHPMST.CONFLG,shpmst.PAYTYP,SHPMST.SHPADRONE,SHPMST.SHPDES,

					SHPCNT.CNSADRTWO,SHPCNT.CNSCTY,SHPCNT.CNSTELNUM,SHPCNT.CNSCTR,SHPCNT.CNSPSTCOD,


					SHPCNT.SHPADRTWO,SHPCNT.SHPCTY,SHPCNT.SHPTELNUM,SHPCNT.SHPCTR,SHPCNT.SHPPSTCOD,ACC.DVLCUS
DVLCUS,


					AWBDSTSTN.CNTCOD AWBDSTCNT,SHPMST.DUPNUM,SHPMST.SEQNUM,SHPMST.AGTCOD,SHPMST.CNSCOD, SHPMST.SHPCOD,



RTG.DSTCOD RTGCOD, RTG.FLTCARCOD RTGCARCOD, RTG.FLTCARIDR RTGCARIDR, RTGSTN.CNTCOD RTGCNTCOD,RTG.RTGSERNUM


RTGSERNUM
				FROM OPRSEGSHP SEGSHP, FLTOPRSEG FLTSEG, FLTOPRLEG LEG, SHRARLMST ARL, OPRSHPMST SHPMST,OPRSHPMSTCNT


SHPCNT,
					SHRSTNMST AWBDSTSTN,SHRSTNMST AWBORGSTN, SHRSTNMST SEGDSTSTN, SHRSTNMST SEGORGSTN, SHRCUSMST


SHPDET, SHRCUSMST CNSDET,OPRSHPMSTACC ACC,
					OPRSHPRTG RTG, SHRSTNMST RTGSTN
				WHERE SHPMST.CMPCOD=SEGSHP.CMPCOD



				AND SHPMST.CMPCOD=SEGSHP.CMPCOD
				AND SHPMST.DOCOWRIDR=SEGSHP.DOCOWRIDR
				AND SHPMST.MSTDOCNUM=SEGSHP.MSTDOCNUM



				AND SHPMST.DUPNUM=SEGSHP.DUPNUM
				AND SHPMST.SEQNUM=SEGSHP.SEQNUM
				AND SHPMST.DSTCOD=AWBDSTSTN.STNCOD



				AND SHPMST.CMPCOD=AWBDSTSTN.CMPCOD
				AND SHPMST.ORGCOD=AWBORGSTN.STNCOD
				AND SHPMST.CMPCOD=AWBORGSTN.CMPCOD



				AND SEGSHP.CMPCOD=FLTSEG.CMPCOD
				AND SEGSHP.FLTNUM=FLTSEG.FLTNUM
				AND SEGSHP.FLTCARIDR=FLTSEG.FLTCARIDR



				AND SEGSHP.FLTSEQNUM=FLTSEG.FLTSEQNUM
				AND SEGSHP.SEGSERNUM=FLTSEG.SEGSERNUM
				AND FLTSEG.CMPCOD=LEG.CMPCOD



				AND FLTSEG.FLTNUM=LEG.FLTNUM
				AND FLTSEG.FLTCARIDR=LEG.FLTCARIDR
				AND FLTSEG.FLTSEQNUM=LEG.FLTSEQNUM



				AND FLTSEG.SEGDST=LEG.LEGDST
				AND FLTSEG.SEGSTA<>'D'
				AND FLTSEG.SEGDST=SEGDSTSTN.STNCOD


				AND
FLTSEG.CMPCOD=SEGDSTSTN.CMPCOD
				AND FLTSEG.SEGORG=SEGORGSTN.STNCOD
				AND FLTSEG.CMPCOD=SEGORGSTN.CMPCOD



				AND ARL.ARLIDR=FLTSEG.FLTCARIDR
				AND ARL.CMPCOD=FLTSEG.CMPCOD
				AND SHPMST.DTACPTFLG='Y'


				AND
SHPMST.CMPCOD = SHPCNT.CMPCOD
	            AND SHPMST.DOCOWRIDR = SHPCNT.DOCOWRIDR


	            AND SHPMST.MSTDOCNUM
= SHPCNT.MSTDOCNUM
	            AND SHPMST.DUPNUM = SHPCNT.DUPNUM


	            AND SHPMST.SEQNUM = SHPCNT.SEQNUM

	            AND SHPMST.CNSCOD=CNSDET.CMPCOD(+)


	            AND SHPMST.CMPCOD=CNSDET.CUSCOD(+)
	            AND SHPMST.SHPCOD=SHPDET.CMPCOD(+)



	            AND SHPMST.CMPCOD=SHPDET.CUSCOD(+)
	            AND SHPMST.CMPCOD = ACC.CMPCOD(+)

AND SHPMST.DOCOWRIDR

= ACC.DOCOWRIDR(+)
	            AND SHPMST.MSTDOCNUM = ACC.MSTDOCNUM(+)

AND SHPMST.DUPNUM

= ACC.DUPNUM(+)
	            AND SHPMST.SEQNUM = ACC.SEQNUM(+)
	            AND SHPMST.CMPCOD
= RTG.CMPCOD(+)


	            AND SHPMST.DOCOWRIDR = RTG.DOCOWRIDR(+)
	            AND
SHPMST.MSTDOCNUM = RTG.MSTDOCNUM(+)


	            AND SHPMST.DUPNUM = RTG.DUPNUM(+)

AND SHPMST.SEQNUM = RTG.SEQNUM(+)

	            AND RTGSTN.CMPCOD(+)=RTG.CMPCOD


	            AND RTGSTN.STNCOD(+)=RTG.DSTCOD
				AND LEG.LEGDST
IN(
				      SELECT DISTINCT ARPCOD
FROM CSTARPTXNMAP
WHERE CMPCOD=?)
				AND LEG.CMPCOD=?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>242</QRY:Id>
		<QRY:Source Name="operations.flthandling.findShipmentsForOutturn" Type="NATIVE">
			<![CDATA[
				SELECT  LEG.LEGDST, NVL(LEG.ETA,LEG.STA) STA, SEGSHP.FLTCARIDR, SEGSHP.CMPCOD, LTRIM(SEGSHP.FLTNUM,0)


FLTNUM, SEGSHP.FLTSEQNUM,
					SEGSHP.DOCOWRIDR,SEGSHP.SHPPFX, SEGSHP.MSTDOCNUM, SEGSHP.MFTPCS, SEGSHP.MFTWGT,


SEGSHP.MFTVOL,
					SEGSHP.RCVPCS,SEGSHP.RCVWGT,SEGSHP.RCVVOL,ARL.APHCODUSE,ARL.TWOAPHCOD, SHPMST.ORGCOD,


SHPMST.DSTCOD,
					SHPMST.STDPCS,SHPMST.STDWGT, SHPMST.STDWGTCOD,SHPMST.SHPDES, SHPMST.SHPDES,SHPMST.DUPNUM,SHPMST.SEQNUM



					FROM OPRSEGSHP SEGSHP,
						 FLTOPRSEG FLTSEG,
						 FLTOPRLEG LEG,
						 SHRARLMST ARL,


						 OPRSHPMST
SHPMST,
						 SHRSTNMST SEGDSTSTN,
						 SHRSTNMST AWBORGSTN,
						 OPRDMGDTL DMG


						WHERE SHPMST.CMPCOD=SEGSHP.CMPCOD

						AND SHPMST.DOCOWRIDR=SEGSHP.DOCOWRIDR
						AND
SHPMST.MSTDOCNUM=SEGSHP.MSTDOCNUM

						AND SHPMST.DUPNUM=SEGSHP.DUPNUM

						AND SHPMST.SEQNUM=SEGSHP.SEQNUM

AND SHPMST.ORGCOD=AWBORGSTN.STNCOD

						AND SHPMST.CMPCOD=AWBORGSTN.CMPCOD

						AND SEGSHP.CMPCOD=FLTSEG.CMPCOD

AND SEGSHP.FLTNUM=FLTSEG.FLTNUM

						AND SEGSHP.FLTCARIDR=FLTSEG.FLTCARIDR

						AND SEGSHP.FLTSEQNUM=FLTSEG.FLTSEQNUM

AND SEGSHP.SEGSERNUM=FLTSEG.SEGSERNUM

						AND FLTSEG.CMPCOD=LEG.CMPCOD

						AND FLTSEG.FLTNUM=LEG.FLTNUM

AND FLTSEG.FLTCARIDR=LEG.FLTCARIDR

						AND FLTSEG.FLTSEQNUM=LEG.FLTSEQNUM

						AND FLTSEG.SEGDST=LEG.LEGDST

AND FLTSEG.SEGSTA<>'D'

						AND FLTSEG.SEGDST=SEGDSTSTN.STNCOD

						AND FLTSEG.CMPCOD=SEGDSTSTN.CMPCOD

AND ARL.ARLIDR=FLTSEG.FLTCARIDR

						AND ARL.CMPCOD=FLTSEG.CMPCOD

						AND SEGSHP.DOCOWRIDR=DMG.DOCOWRIDR(+)

AND SEGSHP.MSTDOCNUM=DMG.MSTDOCNUM(+)

						AND SEGSHP.DUPNUM=DMG.DUPNUM(+)

						AND SEGSHP.SEQNUM=DMG.SEQNUM(+)

AND SEGSHP.FLTNUM=DMG.FLTNUM(+)

						AND SEGSHP.FLTCARIDR=DMG.FLTCARIDR(+)

						AND SEGSHP.FLTSEQNUM=DMG.FLTSEQNUM(+)

AND LEG.LEGDST
IN
						(
						 SELECT DISTINCT ARPCOD FROM
CSTARPTXNMAP WHERE CMPCOD= ?
						)

AND LEG.CMPCOD= ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>243</QRY:Id>
		<QRY:Source Name="operations.flthandling.finddwsbulks" Type="NATIVE">
			<![CDATA[

						SELECT DWSBLK.CMPCOD BLKCMPCOD,
      						 DWSBLK.ARPCOD ARPCOD,
						  DWSBLK.FLTCARIDR BLKFLTCARIDR,

DWSBLK.FLTNUM BLKFLTNUM,
							   DWSBLK.FLTSEQNUM BLKFLTSEQNUM,
							   DWSBLK.LEGSERNUM,
DWSBLK.CNTIDR,

DWSBLK.CNTSERNUM,
						  DWSBLK.POU BLKPOU,
							   DWSBLK.ACTWGT,
DWSBLK.MALTYP,
						  DWSBLK.BLTUSR,

DWSBLK.BLTDAT,
						  DWSBLK.BLKRMK,
						  DWSBLK.RECUPD,
							   DWSBLK.GRSWGT DWSGRSWGT,

DWSBLK.NETWGT DWSNETWGT,
  DWSBLK.DCSTRAFLG,
						  ULDTAG.ULDTAGPTRFLG,
						  ULDTAG.ULDTAGPTRUSR,
						  ULDTAG.ULDTAGPTRDAT,

ULDTAG.TAGRMK,
						  FLTSEG.SEGSERNUM,
						  (SELECT ULDWGTDTL.WGTTIM
						  FROM OPRULDWGTDTL ULDWGTDTL

WHERE DWSBLK.CMPCOD = ULDWGTDTL.CMPCOD
						  AND DWSBLK.ARPCOD   = ULDWGTDTL.ARPCOD
						  AND DWSBLK.CNTIDR
=
							CASE
							  WHEN ULDWGTDTL.ULDNUM = 'BULK'
							  THEN 'BULK'
								||'/'
								||FLTSEG.SEGDST

ELSE ULDWGTDTL.ULDNUM
							END
						  AND DWSBLK.FLTCARIDR = ULDWGTDTL.FLTCARIDR
						  AND DWSBLK.FLTNUM
= ULDWGTDTL.FLTNUM
						  AND DWSBLK.FLTSEQNUM = ULDWGTDTL.FLTSEQNUM
						  AND DWSBLK.LEGSERNUM =
ULDWGTDTL.LEGSERNUM
						  AND ULDWGTDTL.SERNUM =
							(SELECT MAX(SERNUM)
							FROM OPRULDWGTDTL
DTL
							WHERE DTL.CMPCOD = DWSBLK.CMPCOD
							AND DTL.ARPCOD   = DWSBLK.ARPCOD
							AND DTL.ULDNUM
=
							  CASE
								WHEN DWSBLK.CNTIDR LIKE 'BULK%'
								THEN 'BULK'
								ELSE DWSBLK.CNTIDR

END
							AND DTL.FLTCARIDR(+) = DWSBLK.FLTCARIDR
							AND DTL.FLTNUM(+)    = DWSBLK.FLTNUM

AND DTL.FLTSEQNUM(+) = DWSBLK.FLTSEQNUM
							AND DTL.LEGSERNUM(+) = DWSBLK.LEGSERNUM
							)

) WGTTIM,
  (SELECT ULDWGTDTL.SCLNAM
  FROM OPRULDWGTDTL ULDWGTDTL
  WHERE DWSBLK.CMPCOD = ULDWGTDTL.CMPCOD
  AND DWSBLK.ARPCOD   = ULDWGTDTL.ARPCOD
  AND DWSBLK.CNTIDR   =
    CASE
      WHEN ULDWGTDTL.ULDNUM = 'BULK'
      THEN 'BULK'
        ||'/'
        ||FLTSEG.SEGDST
      ELSE ULDWGTDTL.ULDNUM
    END
  AND DWSBLK.FLTCARIDR = ULDWGTDTL.FLTCARIDR
  AND DWSBLK.FLTNUM    = ULDWGTDTL.FLTNUM
  AND DWSBLK.FLTSEQNUM = ULDWGTDTL.FLTSEQNUM
  AND DWSBLK.LEGSERNUM = ULDWGTDTL.LEGSERNUM
  AND ULDWGTDTL.SERNUM =
    (SELECT MAX(SERNUM)
    FROM OPRULDWGTDTL DTL
    WHERE DTL.CMPCOD = DWSBLK.CMPCOD
    AND DTL.ARPCOD   = DWSBLK.ARPCOD
    AND DTL.ULDNUM   =
      CASE
							WHEN DWSBLK.CNTIDR LIKE 'BULK%' 
        THEN 'BULK'
        ELSE DWSBLK.CNTIDR
      END
    AND DTL.FLTCARIDR(+) = DWSBLK.FLTCARIDR
    AND DTL.FLTNUM(+)    = DWSBLK.FLTNUM
    AND DTL.FLTSEQNUM(+) = DWSBLK.FLTSEQNUM
    AND DTL.LEGSERNUM(+) = DWSBLK.LEGSERNUM
    )
  ) SCLNAM,
  CASE
							WHEN DWSBLK.CNTIDR NOT LIKE 'BULK%'
    THEN 'C'
    WHEN DWSBLK.CNTIDR LIKE 'BULK%'
    AND SEGULD.ULDNUM='BULK'
    AND MTKULD.ULDNUM LIKE 'BULK%'
    THEN 'CM'
							WHEN ((DWSBLK.CNTIDR LIKE 'BULK%'
		AND SEGULD.ULDNUM ='BULK')
		OR (DWSBLK.CNTIDR = SEGULD.ULDNUM))
    THEN 'C'
		WHEN DWSBLK.CNTIDR LIKE 'BULK%'
		AND MTKULD.ULDNUM LIKE 'BULK%'
    THEN 'M'
							ELSE ''
							END LODCTG
						FROM OPRDWSBLK
DWSBLK
						JOIN FLTOPRSEG FLTSEG
						ON FLTSEG.CMPCOD     = DWSBLK.CMPCOD
						   AND FLTSEG.FLTCARIDR
= DWSBLK.FLTCARIDR
						   AND FLTSEG.FLTNUM = DWSBLK.FLTNUM
						   AND FLTSEG.FLTSEQNUM = DWSBLK.FLTSEQNUM

AND FLTSEG.SEGORG = DWSBLK.ARPCOD
						AND FLTSEG.SEGDST    = DWSBLK.POU
						LEFT OUTER JOIN MALULDSEG
MTKULD ON
						FLTSEG.CMPCOD  = MTKULD.CMPCOD
						AND FLTSEG.FLTCARIDR = MTKULD.FLTCARIDR
						AND
FLTSEG.FLTNUM    = MTKULD.FLTNUM
						AND FLTSEG.FLTSEQNUM = MTKULD.FLTSEQNUM
						AND FLTSEG.SEGSERNUM
= MTKULD.SEGSERNUM
						AND MTKULD.ULDNUM LIKE 'BULK%'
						LEFT OUTER JOIN OPRSEGULD SEGULD ON

FLTSEG.CMPCOD  = SEGULD.CMPCOD
						AND FLTSEG.FLTCARIDR = SEGULD.FLTCARIDR
						AND FLTSEG.FLTNUM
= SEGULD.FLTNUM
						AND FLTSEG.FLTSEQNUM = SEGULD.FLTSEQNUM
						AND FLTSEG.SEGSERNUM = SEGULD.SEGSERNUM

AND SEGULD.ULDNUM = 'BULK'
						LEFT OUTER JOIN OPRULDTAG ULDTAG
						ON DWSBLK.CMPCOD     = ULDTAG.CMPCOD

AND DWSBLK.FLTCARIDR = ULDTAG.FLTCARIDR
						AND DWSBLK.FLTNUM    = ULDTAG.FLTNUM
						AND DWSBLK.FLTSEQNUM
= ULDTAG.FLTSEQNUM
						AND FLTSEG.SEGSERNUM = ULDTAG.SEGSERNUM
						AND DWSBLK.CNTIDR    =

CASE
							WHEN ULDTAG.ULDNUM = 'BULK'
							THEN 'BULK'
							  ||'/'
							  ||FLTSEG.SEGDST

ELSE ULDTAG.ULDNUM
						  END
						WHERE FLTSEG.CMPCOD  = ?
						   AND FLTSEG.FLTCARIDR = ?

AND FLTSEG.FLTNUM    = ?
						AND FLTSEG.FLTSEQNUM = ?
						   AND FLTSEG.SEGORG = ?
ORDER BY SEGSERNUM

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>244</QRY:Id>
		<QRY:Source Name="operations.flthandling.arrival.findShipmentsForSegment" Type="NATIVE">
			<![CDATA[
					SELECT DISTINCT SEGSHP.FLTCARIDR, SEGSHP.CMPCOD, SEGSHP.FLTNUM,MST.SHPSTA,
					      SEGSHP.FLTSEQNUM,


SEGSHP.SEGSERNUM,MST.ORGCOD,
					      MST.DSTCOD,MST.STDPCS,MST.STDWGT,IMPFLT.FLTDAT,IMPFLT.FLTCARCOD,



SEGSHP.DOCOWRIDR, SEGSHP.MSTDOCNUM, SEGSHP.DUPNUM,MST.SHPPFX,
					      SEGSHP.SEQNUM, SEGSHP.MFTPCS,


SEGSHP.MFTWGT,MST.OWRCOD,
					      SEGSHP.MFTVOL, SEGSHP.RCVPCS, SEGSHP.RCVWGT, SEGSHP.RCVVOL,MST.CONFLG,



					      HSE.DOCNUM,LEG.LEGORG SEGORG, LEG.LEGDST SEGDST,MST.SHPDES,MST.STDDISWGT,MST.STDWGTCOD,


					      LEG.STA,MST.SHPNAM,MST.SHPADRONE,MST.CNSNAM,MST.CNSADRONE,ACC.DVLCUS,


CNT.CNSCTR,CNT.CNSCTY,CNT.CNSMALIDR,CNT.CNSPSTCOD,

					      CNT.CNSSTT,CNT.CNSTELNUM,CNT.SHPCTR,CNT.SHPCTY,


					      CNT.SHPMALIDR,CNT.SHPPSTCOD,CNT.SHPSTT,CNT.SHPTELNUM

					      FROM OPRSEGSHP
SEGSHP,OPRSHPMST MST,OPRFLTSEG
FLTSEG,OPRARPIMPFLT IMPFLT,
						   OPRSHPHSE HSE,FLTOPRSEG
SEG,FLTOPRLEG
LEG,OPRSHPMSTACC ACC,

						   OPRSHPMSTCNT CNT
					      WHERE
					      SEGSHP.CMPCOD=MST.CMPCOD(+)

AND
					      SEGSHP.DOCOWRIDR=MST.DOCOWRIDR(+)
AND
					      SEGSHP.MSTDOCNUM=MST.MSTDOCNUM(+) AND


SEGSHP.DUPNUM=MST.DUPNUM(+) AND

SEGSHP.SEQNUM=MST.SEQNUM(+) AND

					      SEGSHP.FLTCARIDR=FLTSEG.FLTCARIDR(+)

AND
					      SEGSHP.FLTNUM=FLTSEG.FLTNUM(+)
AND
					      SEGSHP.FLTSEQNUM=FLTSEG.FLTSEQNUM(+) AND


SEGSHP.SEGSERNUM=FLTSEG.SEGSERNUM(+)
AND
					      SEGSHP.CMPCOD=FLTSEG.CMPCOD(+) AND


FLTSEG.FLTCARIDR=IMPFLT.FLTCARIDR(+)
AND

FLTSEG.FLTNUM=IMPFLT.FLTNUM(+) AND
					      FLTSEG.FLTSEQNUM=IMPFLT.FLTSEQNUM(+)
AND

FLTSEG.CMPCOD=IMPFLT.CMPCOD(+)
AND
					      FLTSEG.POU=IMPFLT.ARPCOD(+) AND


SEGSHP.CMPCOD
= HSE.CMPCOD(+) AND

					      SEGSHP.DOCOWRIDR = HSE.DOCOWRIDR(+) AND

SEGSHP.MSTDOCNUM
= HSE.MSTDOCNUM(+) AND

					      SEGSHP.DUPNUM = HSE.DUPNUM(+) AND


SEGSHP.CMPCOD
= SEG.CMPCOD AND
					      SEGSHP.FLTCARIDR
= SEG.FLTCARIDR AND
					      SEGSHP.FLTNUM
= SEG.FLTNUM
AND
					      SEGSHP.FLTSEQNUM = SEG.FLTSEQNUM
AND
					      SEGSHP.SEGSERNUM = SEG.SEGSERNUM
AND


					      SEG.CMPCOD = LEG.CMPCOD AND

					      SEG.FLTCARIDR =LEG.FLTCARIDR
AND
					      SEG.FLTNUM
= LEG.FLTNUM AND
					      SEG.FLTSEQNUM =LEG.FLTSEQNUM
AND
					      SEG.SEGDST
=  LEG.LEGDST AND


					      MST.CMPCOD = ACC.CMPCOD AND
					      MST.DOCOWRIDR
= ACC.DOCOWRIDR
AND
					      MST.MSTDOCNUM =
ACC.MSTDOCNUM AND
					      MST.SEQNUM = ACC.SEQNUM AND


MST.DUPNUM = ACC.DUPNUM
AND

					      MST.CMPCOD = CNT.CMPCOD(+) AND
					      MST.DOCOWRIDR = CNT.DOCOWRIDR(+)

AND

					      MST.MSTDOCNUM = CNT.MSTDOCNUM(+) AND
					      MST.DUPNUM = CNT.DUPNUM(+)
AND

MST.SEQNUM
= CNT.SEQNUM(+) AND

					      SEGSHP.FLTNUM=? AND
					      SEGSHP.FLTSEQNUM
=? AND


					      SEGSHP.FLTCARIDR =? AND
					      SEGSHP.CMPCOD=?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>245</QRY:Id>
		<QRY:Source Name="operaions.flthandling.findmanifestdetailsforsegments" Type="NATIVE">
			<![CDATA[

				SELECT SEGULD.SELFLG,SEGULD.BDPFLG,SEGULD.ULDNUM,FLTSEG.POL,FLTSEG.POU
					FROM OPRSEGULD SEGULD,OPRFLTSEG FLTSEG
					WHERE seguld.fltcaridr = FLTSEG.FLTCARIDR
						AND seguld.fltnum = fltseg.fltnum
						AND seguld.fltseqnum = fltseg.fltseqnum
						AND SEGULD.cmpcod = fltseg.cmpcod
						AND seguld.SEGSERNUM = fltseg.SEGSERNUM
					AND SEGULD.CMPCOD=?
					AND  SEGULD.FLTNUM=?
					AND SEGULD.FLTSEQNUM =?
					AND SEGULD.FLTCARIDR =?
					AND ( SEGULD.BDPFLG = 'Y' OR SEGULD.MFTFLG = 'Y' )

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>245</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findshipmentsforconsolidatedsorting" Type="NATIVE">
			<![CDATA[

			     SELECT SHPMST.SHPPFX,
					  SELSHP.MSTDOCNUM   ,
					  SELSHP.DOCOWRIDR   ,
					  SELSHP.DUPNUM


,
					  SELSHP.SEQNUM      ,
					  SELSHP.FLTNUM      ,
					  SELSHP.FLTCARIDR   ,
					  SELSHP.FLTSEQNUM


,
					  SELSHP.SEGSERNUM   ,
					  SHPMST.PARSEQNUM   ,
					  FLTMST.FLTDAT      ,
					  FLTLEG.ATA


,
					  FLTLEG.STA		 ,
					  SELSHP.SRCIND      ,
					  SELSHP.SELPCS      ,
					  SELSHP.FWDCOD


,
					  (SELECT DISTINCT PARSELSHP.CNSSRTTIM
					     FROM OPRSEGSELSHP PARSELSHP
					    WHERE
SHPMST.CMPCOD

= PARSELSHP.CMPCOD
					  AND SHPMST.DOCOWRIDR    = PARSELSHP.DOCOWRIDR
					  AND
SHPMST.MSTDOCNUM

= PARSELSHP.MSTDOCNUM
					  AND SHPMST.PARSEQNUM    = PARSELSHP.SEQNUM

AND SHPMST.DUPNUM

= PARSELSHP.DUPNUM
					  AND PARSELSHP.CMPCOD    = SELSHP.CMPCOD
					  AND
PARSELSHP.FLTCARIDR = SELSHP.FLTCARIDR


					  AND PARSELSHP.FLTSEQNUM = SELSHP.FLTSEQNUM

AND PARSELSHP.FLTNUM    = SELSHP.FLTNUM

					  ) CNSSRTTIM,


					  (SELECT DISTINCT
PARSELSHP.BRKDWNSRTTIM
					     FROM OPRSEGSELSHP PARSELSHP

					    WHERE SHPMST.CMPCOD

= PARSELSHP.CMPCOD
					  AND SHPMST.DOCOWRIDR    = PARSELSHP.DOCOWRIDR

					  AND SHPMST.MSTDOCNUM

= PARSELSHP.MSTDOCNUM
					  AND SHPMST.PARSEQNUM    = PARSELSHP.SEQNUM

					  AND SHPMST.DUPNUM

= PARSELSHP.DUPNUM
					  AND PARSELSHP.CMPCOD    = SELSHP.CMPCOD
					  AND
PARSELSHP.FLTCARIDR =
SELSHP.FLTCARIDR

					  AND PARSELSHP.FLTSEQNUM = SELSHP.FLTSEQNUM

					  AND PARSELSHP.FLTNUM
= SELSHP.FLTNUM
					  ) BRKDWNSRTTIM


					   FROM OPRFLTSEG FLTSEG,

					  FLTOPRLEG
FLTLEG      ,
					  FLTOPRMST FLTMST      ,
					  OPRSEGSELSHP
SELSHP   ,
					  OPRSHPMST
SHPMST
,
					  OPRSEGSHP SEGSHP
					  WHERE FLTMST.CMPCOD = FLTLEG.CMPCOD

					AND FLTMST.FLTCARIDR

= FLTLEG.FLTCARIDR
					AND FLTMST.FLTNUM     = FLTLEG.FLTNUM
					AND FLTMST.FLTSEQNUM
= FLTLEG.FLTSEQNUM



					AND FLTLEG.CMPCOD     = FLTSEG.CMPCOD
					AND FLTLEG.FLTCARIDR  = FLTSEG.FLTCARIDR


AND FLTLEG.FLTNUM
= FLTSEG.FLTNUM
					AND FLTLEG.FLTSEQNUM  = FLTSEG.FLTSEQNUM
					AND FLTLEG.LEGDST

= FLTSEG.POU


					AND FLTSEG.CMPCOD     = SELSHP.CMPCOD
					AND FLTSEG.FLTCARIDR  = SELSHP.FLTCARIDR


					AND FLTSEG.FLTNUM
= SELSHP.FLTNUM
					AND FLTSEG.FLTSEQNUM  = SELSHP.FLTSEQNUM
					AND FLTSEG.SEGSERNUM

= SELSHP.SEGSERNUM


					AND SELSHP.CMPCOD     = SHPMST.CMPCOD
					AND SELSHP.DOCOWRIDR  = SHPMST.DOCOWRIDR


					AND SELSHP.MSTDOCNUM
= SHPMST.MSTDOCNUM
					AND SELSHP.SEQNUM     = SHPMST.SEQNUM
					AND SELSHP.DUPNUM

= SHPMST.DUPNUM


					AND SEGSHP.CMPCOD = SELSHP.CMPCOD
					AND SEGSHP.FLTCARIDR = SELSHP.FLTCARIDR


					AND SEGSHP.FLTNUM
= SELSHP.FLTNUM
					AND SEGSHP.FLTSEQNUM = SELSHP.FLTSEQNUM
					AND SEGSHP.SEGSERNUM

= SELSHP.SEGSERNUM

AND SEGSHP.DOCOWRIDR = SELSHP.DOCOWRIDR
					AND SEGSHP.MSTDOCNUM = SELSHP.MSTDOCNUM


AND SEGSHP.SEQNUM
= SELSHP.SEQNUM
					AND SEGSHP.DUPNUM = SELSHP.DUPNUM

					AND SELSHP.SEQNUM

> 1
					AND SEGSHP.RCVPCS
= SELSHP.SELPCS
					AND SELSHP.SELPCS     > 0

					AND SELSHP.CMPCOD

= ?
					AND (SELSHP.CNSCOL
<> ? OR SELSHP.CNSCOL IS NULL)
					AND FLTSEG.POU        = ?
					AND

SELSHP.FWDCOD    IS NOT NULL

					ORDER BY FLTCARIDR,
					  FLTNUM          ,
					  FLTSEQNUM

,
					  SEGSERNUM       ,

					  FWDCOD          ,
					  DOCOWRIDR       ,
					  MSTDOCNUM
,

					  DUPNUM          ,
					  SEQNUM
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>246</QRY:Id>
		<QRY:Source Name="operations.flthandling.findbondtransportationforbin01" Type="OBJECT">
			<![CDATA[
		SELECT
	      operationalSegmentSelectBondTransport
		FROM
	     OperationalSegmentSelectBondTransport AS operationalSegmentSelectBondTransport
		WHERE
	     operationalSegmentSelectBondTransport.bondTransportNumber = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>247</QRY:Id>
		<QRY:Source Name="operations.flthandling.findbondtransporationDetails" Type="OBJECT">
			<![CDATA[
  		SELECT bondTransport from
  		OperationalSegmentSelectBondTransport as bondTransport
  		WHERE
  		bondTransport.operationalSegmentSelectBondTransportPK.companyCode= ?  AND
  		bondTransport.operationalSegmentSelectBondTransportPK.airportCode =  ? AND
    		bondTransport.flightNumber = ? AND
    		bondTransport.flightCarrierIdentifier = ? AND
    		bondTransport.flightSequenceNumber = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>248</QRY:Id>
		<QRY:Source Name="operations.flthandling.findawbbondtransporationDetails" Type="OBJECT">
			<![CDATA[
  		SELECT bondTransport from
  		OperationalSegmentSelectBondTransport as bondTransport
  		WHERE
  		bondTransport.operationalSegmentSelectBondTransportPK.companyCode= ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>249</QRY:Id>
		<QRY:Source Name="operations.flthandling.findawbforwarderbondtransporationDetails" Type="OBJECT">
			<![CDATA[
  		SELECT bondTransport from
			OperationalSegmentSelectBondTransport as bondTransport,
			OperationalSegmentSelectShipment


as selectShipment
			WHERE
			bondTransport.operationalSegmentSelectBondTransportPK.companyCode = selectShipment.operationalShipmentForSegmentPK.companyCode


AND
			bondTransport.operationalSegmentSelectBondTransportPK.masterDocumentNumber = selectShipment.operationalShipmentForSegmentPK.masterDocumentNumber


AND
			bondTransport.operationalSegmentSelectBondTransportPK.duplicateNumber = selectShipment.operationalShipmentForSegmentPK.duplicateNumber


AND
			bondTransport.operationalSegmentSelectBondTransportPK.ownerId = selectShipment.operationalShipmentForSegmentPK.ownerId


AND
			bondTransport.operationalSegmentSelectBondTransportPK.sequenceNumber = selectShipment.operationalShipmentForSegmentPK.sequenceNumber


AND
			bondTransport.operationalSegmentSelectBondTransportPK.companyCode= ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>250</QRY:Id>
		<QRY:Source Name="operations.flthandling.findSegmentSelectShipmentDetails" Type="OBJECT">
			<![CDATA[
		SELECT
			segmentSelectShipment
		FROM
			OperationalSegmentSelectShipment as segmentSelectShipment
		WHERE
			segmentSelectShipment.operationalShipmentForSegmentPK.companyCode= ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>251</QRY:Id>
		<QRY:Source Name="operations.flthandling.findawbuldDetailsforcustomsmessage" Type="OBJECT">
			<![CDATA[
  		SELECT uldDetails from
  		OperationalSegmentSelectUld as uldDetails ,
  		OperationalFlightSegment


as flightSegment
  		WHERE
  		uldDetails.operationalUldForSegmentPK.companyCode = flightSegment.operationalFlightSegmentPK.companyCode


AND
  		uldDetails.operationalUldForSegmentPK.carrierId = flightSegment.operationalFlightSegmentPK.carrierId


AND
  		uldDetails.operationalUldForSegmentPK.flightNumber = flightSegment.operationalFlightSegmentPK.flightNumber


AND
  		uldDetails.operationalUldForSegmentPK.flightSequenceNumber = flightSegment.operationalFlightSegmentPK.flightSequenceNumber


AND
  		uldDetails.operationalUldForSegmentPK.segmentSerialNumber = flightSegment.operationalFlightSegmentPK.segmentSerialNumber


AND

  		uldDetails.operationalUldForSegmentPK.companyCode= ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>252</QRY:Id>
		<QRY:Source Name="operations.flthandling.findnotocfordgrdetails" Type="OBJECT">
			<![CDATA[
  		SELECT notocForDgr from
  		NotocForDGR as notocForDgr
  		WHERE
  		notocForDgr.notocForDgrPK.companyCode=


?  AND
  		notocForDgr.notocForDgrPK.flightNumber =  ? AND
    	notocForDgr.notocForDgrPK.flightSequenceNumber


= ? AND
    	notocForDgr.notocForDgrPK.carrierId = ? AND
    	notocForDgr.notocForDgrPK.legSerialNumber


= ? AND
		notocForDgr.notocForDgrPK.ownerId = ? AND
		notocForDgr.notocForDgrPK.masterDocumentNumber


= ? AND
		notocForDgr.notocForDgrPK.duplicateNumber = ? AND
		  notocForDgr.notocForDgrPK.sequenceNumber


= ? AND
		  notocForDgr.uldNumber = ? AND
		  notocForDgr.unid = ?  AND
		  notocForDgr.scc = ? AND



		  notocForDgr.dangerousSerialNumber = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>253</QRY:Id>
		<QRY:Source Name="operations.flthandling.findbondtransporationdetailsforashipment" Type="OBJECT">
			<![CDATA[
		  		SELECT bondTransport from
		  		OperationalSegmentSelectBondTransport as bondTransport
		  		WHERE



bondTransport.operationalSegmentSelectBondTransportPK.companyCode= ?  AND
		  		bondTransport.operationalSegmentSelectBondTransportPK.airportCode


=  ? AND
				bondTransport.operationalSegmentSelectBondTransportPK.ownerId= ?  AND
		  		bondTransport.operationalSegmentSelectBondTransportPK.masterDocumentNumber


=  ? AND
				bondTransport.operationalSegmentSelectBondTransportPK.sequenceNumber= ?  AND
		  		bondTransport.operationalSegmentSelectBondTransportPK.duplicateNumber


=  ? AND
		    		bondTransport.flightNumber = ? AND
		    		bondTransport.flightCarrierIdentifier =

?
AND
		    		bondTransport.flightSequenceNumber = ? AND
					bondTransport.naccsFlightCarrierCode
=
?
AND
		    		bondTransport.naccsFlightNumber = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>254</QRY:Id>
		<QRY:Source Name="operations.flthandling.findbondtransporationdetailsforselect" Type="OBJECT">
			<![CDATA[
			  		SELECT bondTransport from
			  		OperationalSegmentSelectBondTransport as bondTransport



			  		WHERE
			  		bondTransport.operationalSegmentSelectBondTransportPK.companyCode= ?  AND


			  		bondTransport.operationalSegmentSelectBondTransportPK.airportCode
=  ? AND
					bondTransport.operationalSegmentSelectBondTransportPK.ownerId=

?  AND
			  		bondTransport.operationalSegmentSelectBondTransportPK.masterDocumentNumber
=  ? AND


bondTransport.operationalSegmentSelectBondTransportPK.sequenceNumber= ?  AND
			  		bondTransport.operationalSegmentSelectBondTransportPK.duplicateNumber


=  ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>255</QRY:Id>
		<QRY:Source Name="operations.flthandling.findsegselshipmentfortsc" Type="OBJECT">
			<![CDATA[

	  			 SELECT selectShipment from
				OperationalSegmentSelectShipment as selectShipment,
				Flight


as flight,
				FlightLeg as flightLeg

				WHERE

				flight.flightPk.companyCode = selectShipment.operationalShipmentForSegmentPK.companyCode


AND
				flight.flightPk.flightCarrierIdentifier = selectShipment.operationalShipmentForSegmentPK.carrierId


AND
				flight.flightPk.flightNumber = selectShipment.operationalShipmentForSegmentPK.flightNumber
AND


flight.flightPk.flightSequenceNumber = selectShipment.operationalShipmentForSegmentPK.flightSequenceNumber


AND

				flightLeg.flightLegPk.companyCode = flight.flightPk.companyCode AND
				flightLeg.flightLegPk.flightCarrierIdentifier


= flight.flightPk.flightCarrierIdentifier AND
				flightLeg.flightLegPk.flightNumber = flight.flightPk.flightNumber


AND
				flightLeg.flightLegPk.flightSequenceNumber = flight.flightPk.flightSequenceNumber AND
				flightLeg.actualTimeArrival


is not null AND

				selectShipment.operationalShipmentForSegmentPK.companyCode= ?  AND
				selectShipment.operationalShipmentForSegmentPK.ownerId=


?  AND
				selectShipment.operationalShipmentForSegmentPK.masterDocumentNumber =  ? AND
				selectShipment.operationalShipmentForSegmentPK.sequenceNumber=


?  AND
			selectShipment.operationalShipmentForSegmentPK.duplicateNumber =  ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>256</QRY:Id>
		<QRY:Source Name="operations.flthandling.findtransitstoragedetails" Type="OBJECT">
			<![CDATA[
				SELECT transitStorage from
				TransitStorage as transitStorage
				WHERE
				transitStorage.transitStoragePK.companyCode= ?  AND
				transitStorage.transitStoragePK.carrierId= ?  AND
				transitStorage.transitStoragePK.flightNumber =  ? AND
				transitStorage.transitStoragePK.flightSequenceNumber= ?  AND
				transitStorage.transitStoragePK.segmentSerialNumber =  ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>257</QRY:Id>
		<QRY:Source Name="operations.flthandling.findsegselshipmentforsorting" Type="OBJECT">
			<![CDATA[
				SELECT selectShipment from
					OperationalSegmentSelectShipment as selectShipment,
					Shipment


as shipment
					WHERE
					selectShipment.operationalShipmentForSegmentPK.companyCode= shipment.shipmentMasterPk.companyCode


AND
					selectShipment.operationalShipmentForSegmentPK.ownerId= shipment.shipmentMasterPk.ownerId

AND

selectShipment.operationalShipmentForSegmentPK.masterDocumentNumber =  shipment.shipmentMasterPk.masterDocumentNumber


AND
					selectShipment.operationalShipmentForSegmentPK.sequenceNumber= shipment.parentSequenceNumber


AND
					selectShipment.operationalShipmentForSegmentPK.duplicateNumber =  shipment.shipmentMasterPk.duplicateNumber


AND

					shipment.shipmentMasterPk.companyCode= ?  AND
					shipment.shipmentMasterPk.ownerId= ?
AND


					shipment.shipmentMasterPk.masterDocumentNumber =  ? AND
					shipment.shipmentMasterPk.sequenceNumber=


?  AND
				shipment.shipmentMasterPk.duplicateNumber =  ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>258</QRY:Id>
		<QRY:Source Name="operations.flthandling.findsegselshipmentfordlv" Type="OBJECT">
			<![CDATA[
			SELECT
				segmentSelectShipment
			FROM
				OperationalSegmentSelectShipment as segmentSelectShipment
			WHERE
				segmentSelectShipment.operationalShipmentForSegmentPK.companyCode= ? AND
				segmentSelectShipment.operationalShipmentForSegmentPK.masterDocumentNumber= ? AND
				segmentSelectShipment.operationalShipmentForSegmentPK.ownerId =  ? AND
				segmentSelectShipment.operationalShipmentForSegmentPK.duplicateNumber= ? AND
					segmentSelectShipment.operationalShipmentForSegmentPK.sequenceNumber = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>259</QRY:Id>
		<QRY:Source Name="operations.flthandling.findsegselshipmentforimportmanifest" Type="OBJECT">
			<![CDATA[
	  		SELECT selectShipment from
				OperationalShipmentForSegment as segmentShipment,
				OperationalSegmentSelectShipment


as selectShipment
				WHERE
				segmentShipment.operationalShipmentForSegmentPK.companyCode = selectShipment.operationalShipmentForSegmentPK.companyCode


AND
				segmentShipment.operationalShipmentForSegmentPK.masterDocumentNumber = selectShipment.operationalShipmentForSegmentPK.masterDocumentNumber


AND
				segmentShipment.operationalShipmentForSegmentPK.duplicateNumber = selectShipment.operationalShipmentForSegmentPK.duplicateNumber


AND
				segmentShipment.operationalShipmentForSegmentPK.ownerId = selectShipment.operationalShipmentForSegmentPK.ownerId


AND
				segmentShipment.operationalShipmentForSegmentPK.sequenceNumber = selectShipment.operationalShipmentForSegmentPK.sequenceNumber


AND
				segmentShipment.operationalShipmentForSegmentPK.carrierId = selectShipment.operationalShipmentForSegmentPK.carrierId


AND
				segmentShipment.operationalShipmentForSegmentPK.flightNumber = selectShipment.operationalShipmentForSegmentPK.flightNumber


AND
				segmentShipment.operationalShipmentForSegmentPK.flightSequenceNumber = selectShipment.operationalShipmentForSegmentPK.flightSequenceNumber


AND
				segmentShipment.operationalShipmentForSegmentPK.segmentSerialNumber = selectShipment.operationalShipmentForSegmentPK.segmentSerialNumber


AND
				selectShipment.operationalShipmentForSegmentPK.companyCode= ? AND
				selectShipment.operationalShipmentForSegmentPK.ownerId=


? AND
				selectShipment.operationalShipmentForSegmentPK.masterDocumentNumber= ? AND
				selectShipment.operationalShipmentForSegmentPK.duplicateNumber=


? AND
				selectShipment.operationalShipmentForSegmentPK.sequenceNumber= ? AND
				selectShipment.operationalShipmentForSegmentPK.carrierId=


? AND
				selectShipment.operationalShipmentForSegmentPK.flightNumber= ? AND
				selectShipment.operationalShipmentForSegmentPK.flightSequenceNumber=


?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>260</QRY:Id>
		<QRY:Source Name="operations.flthandling.findsegshipmentforbreakdown" Type="OBJECT">
			<![CDATA[
	  		SELECT segmentShipment from
				OperationalShipmentForSegment as segmentShipment
				WHERE
				segmentShipment.operationalShipmentForSegmentPK.companyCode=


? AND
				segmentShipment.operationalShipmentForSegmentPK.ownerId= ? AND
				segmentShipment.operationalShipmentForSegmentPK.masterDocumentNumber=


? AND
				segmentShipment.operationalShipmentForSegmentPK.duplicateNumber= ? AND
				segmentShipment.operationalShipmentForSegmentPK.sequenceNumber=


? AND
				segmentShipment.operationalShipmentForSegmentPK.carrierId= ? AND
				segmentShipment.operationalShipmentForSegmentPK.flightNumber=


? AND
				segmentShipment.operationalShipmentForSegmentPK.flightSequenceNumber= ?
				ORDER BY segmentShipment.operationalShipmentForSegmentPK.segmentSerialNumber

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>261</QRY:Id>
		<QRY:Source Name="operaions.flthandling.jto.findawbprogressdetails" Type="NATIVE">
			<![CDATA[
	      SELECT SHPMST.MSTDOCNUM,
	        SHPMST.SEQNUM         ,
	        SHPMST.DUPNUM         ,



	        SHPMST.DOCOWRIDR      ,
	        SHPMST.SHPPFX         ,
	        SHPMST.CONFLG         ,


	       SUM((CASE

	        WHEN SEGSHP.SELPREFLG IS NOT NULL
	        THEN SELSHP.SELPCS

ELSE
SEGSHP.MFTPCS
	       END))
OVER (PARTITION BY SEGSHP.CMPCOD, SEGSHP.DOCOWRIDR, SEGSHP.MSTDOCNUM,
SEGSHP.DUPNUM,SEGSHP.SEQNUM,
SEGSHP.FLTCARIDR,
SEGSHP.FLTNUM, SEGSHP.FLTSEQNUM) AWBMFTPCS,

SUM((CASE
	        WHEN SEGSHP.SELPREFLG
IS NOT NULL

THEN SELSHP.SELWGT
	        ELSE SEGSHP.MFTWGT

END)) OVER (PARTITION BY
SEGSHP.CMPCOD, SEGSHP.DOCOWRIDR,
SEGSHP.MSTDOCNUM, SEGSHP.DUPNUM,SEGSHP.SEQNUM,
SEGSHP.FLTCARIDR, SEGSHP.FLTNUM,
SEGSHP.FLTSEQNUM) AWBMFTWGT,

SUM(SELSHP.SELWGT) OVER (PARTITION
BY SEGSHP.CMPCOD, SEGSHP.DOCOWRIDR,
SEGSHP.MSTDOCNUM, SEGSHP.DUPNUM,SEGSHP.SEQNUM,
SEGSHP.FLTCARIDR,
SEGSHP.FLTNUM, SEGSHP.FLTSEQNUM) SELWGT,

	        SUM(SEGSHP.RCVPCS) OVER (PARTITION
BY SEGSHP.CMPCOD,
SEGSHP.DOCOWRIDR, SEGSHP.MSTDOCNUM, SEGSHP.DUPNUM,SEGSHP.SEQNUM,
SEGSHP.FLTCARIDR,
SEGSHP.FLTNUM, SEGSHP.FLTSEQNUM)
RCVPCS,
	        ULDSHP.ULDNUM         ,

	        SELSHP.UGTCOD
,
	        RMPULD.RCVTIM
,
	        RMPULD.BDNENDTIM      ,
	        IMPFLT.ARPCOD


	         FROM
OPRARPIMPFLT IMPFLT,
	        OPRFLTSEG FLTSEG         ,
	        OPRSEGSELSHP
SELSHP      ,


	        ( SELECT SEGSHP.* ,
			  (SELECT 'Y'
			     FROM DUAL
			    WHERE
EXISTS
			    (SELECT
MSTDOCNUM

			       FROM OPRSEGSELSHP SELTST
			      WHERE SELTST.CMPCOD
= SEGSHP.CMPCOD

AND SELTST.DOCOWRIDR
= SEGSHP.DOCOWRIDR
			    AND SELTST.MSTDOCNUM    = SEGSHP.MSTDOCNUM


			    AND SELTST.DUPNUM       =
SEGSHP.DUPNUM
			    AND SELTST.SEQNUM       = SEGSHP.SEQNUM

AND SELTST.FLTCARIDR
= SEGSHP.FLTCARIDR

AND SELTST.FLTNUM       = SEGSHP.FLTNUM
			    AND
SELTST.FLTSEQNUM = SEGSHP.FLTSEQNUM

			    )

) SELPREFLG	FROM
					 OPRSEGSHP SEGSHP )
SEGSHP,
	        OPRSHPMST SHPMST         ,

	        OPRSEGULDSHP
ULDSHP      ,
	        WHSRMPULD
RMPULD
	        WHERE SHPMST.CMPCOD = SEGSHP.CMPCOD

	      AND SHPMST.SEQNUM
= SEGSHP.SEQNUM

AND SHPMST.DUPNUM     = SEGSHP.DUPNUM
	      AND SHPMST.MSTDOCNUM
= SEGSHP.MSTDOCNUM

AND SHPMST.DOCOWRIDR
= SEGSHP.DOCOWRIDR
	      AND SEGSHP.FLTCARIDR  = SELSHP.FLTCARIDR(+)

AND
SEGSHP.CMPCOD
= SELSHP.CMPCOD(+)
	      AND SEGSHP.FLTNUM     = SELSHP.FLTNUM(+)
	      AND
SEGSHP.FLTSEQNUM
= SELSHP.FLTSEQNUM(+)

AND SEGSHP.SEGSERNUM  = SELSHP.SEGSERNUM(+)
	      AND
SEGSHP.SEQNUM
= SELSHP.SEQNUM(+)

AND SEGSHP.DUPNUM     = SELSHP.DUPNUM(+)
	      AND SEGSHP.MSTDOCNUM
= SELSHP.MSTDOCNUM(+)

AND
SEGSHP.DOCOWRIDR  = SELSHP.DOCOWRIDR(+)
	      AND SEGSHP.FLTCARIDR
= ULDSHP.FLTCARIDR(+)

AND
SEGSHP.CMPCOD     = ULDSHP.CMPCOD(+)
	      AND SEGSHP.FLTNUM     =
ULDSHP.FLTNUM(+)
	      AND SEGSHP.FLTSEQNUM

= ULDSHP.FLTSEQNUM(+)
	      AND SEGSHP.SEGSERNUM  = ULDSHP.SEGSERNUM(+)

	      AND SEGSHP.SEQNUM

= ULDSHP.SEQNUM(+)
	      AND SEGSHP.DUPNUM     = ULDSHP.DUPNUM(+)
	      AND
SEGSHP.MSTDOCNUM  = ULDSHP.MSTDOCNUM(+)


	      AND SEGSHP.DOCOWRIDR  = ULDSHP.DOCOWRIDR(+)

	      AND ULDSHP.ULDNUM     = RMPULD.ULDNUM(+)

AND
ULDSHP.CMPCOD     = RMPULD.CMPCOD(+)
	      AND
ULDSHP.FLTCARIDR  = RMPULD.FLTCARIDR(+)

AND ULDSHP.FLTNUM
= RMPULD.FLTNUM(+)
	      AND ULDSHP.FLTSEQNUM
= RMPULD.FLTSEQNUM(+)

AND SEGSHP.CMPCOD     =
FLTSEG.CMPCOD
	      AND SEGSHP.FLTCARIDR  = FLTSEG.FLTCARIDR


AND SEGSHP.FLTNUM     = FLTSEG.FLTNUM

AND SEGSHP.FLTSEQNUM  = FLTSEG.FLTSEQNUM
	      AND SEGSHP.SEGSERNUM

= FLTSEG.SEGSERNUM
	      AND FLTSEG.CMPCOD
= IMPFLT.CMPCOD
	      AND FLTSEG.FLTCARIDR  = IMPFLT.FLTCARIDR


AND FLTSEG.FLTNUM     = IMPFLT.FLTNUM

AND FLTSEG.FLTSEQNUM  = IMPFLT.FLTSEQNUM
	      AND FLTSEG.POU

= IMPFLT.ARPCOD
	      AND SHPMST.SEQNUM
= 1 AND
				  FLTSEG.FLTCARIDR = ?  AND
				  FLTSEG.FLTNUM

=? AND
				  FLTSEG.CMPCOD = ? AND

				  IMPFLT.ARPCOD = ? AND
				  FLTSEG.FLTSEQNUM = ? AND


				  RMPULD.ARPCOD(+) = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>262</QRY:Id>
		<QRY:Source Name="operations.flthandling.jto.findHAWBProgressDetails" Type="NATIVE">
			<![CDATA[

		                SELECT
						  SHPMST.DOCNUM,
						  SHPMST.MSTDOCNUM,
						  SELSHP.UGTCOD,



	            (CASE
	            WHEN SELSHP.SELPCS > 0
	            THEN SELSHP.SELPCS


	            ELSE SEGSHP.MFTPCS

	           END) AWBMFTPCS,
	           (CASE

WHEN SELSHP.SELWGT
> 0
	            THEN SELSHP.SELWGT

	            ELSE SEGSHP.MFTWGT

END) AWBMFTWGT,

SEGSHP.RCVPCS,
						  SEGSHP.RCVWGT
						FROM

						 OPRARPIMPFLT
IMPFLT,
						 OPRFLTSEG
FLTSEG,
						 OPRSEGSELSHP SELSHP,
						 OPRSEGSHP SEGSHP,


OPRSHPMST SHPMST
						WHERE

	            SHPMST.CMPCOD = SEGSHP.CMPCOD AND

SHPMST.SEQNUM
= SEGSHP.SEQNUM AND
	            SHPMST.DUPNUM
= SEGSHP.DUPNUM AND
	            SHPMST.MSTDOCNUM
= SEGSHP.MSTDOCNUM
AND
	            SHPMST.DOCOWRIDR
= SEGSHP.DOCOWRIDR AND
	            SEGSHP.FLTCARIDR
= SELSHP.FLTCARIDR(+)
AND
	            SEGSHP.CMPCOD
= SELSHP.CMPCOD(+) AND
	            SEGSHP.FLTNUM
= SELSHP.FLTNUM(+) AND

	            SEGSHP.FLTSEQNUM
= SELSHP.FLTSEQNUM(+) AND

SEGSHP.SEGSERNUM = SELSHP.SEGSERNUM(+) AND


	            SEGSHP.SEQNUM = SELSHP.SEQNUM(+)
AND
	            SEGSHP.DUPNUM = SELSHP.DUPNUM(+) AND
	            SEGSHP.MSTDOCNUM

= SELSHP.MSTDOCNUM(+)
AND
	            SEGSHP.DOCOWRIDR = SELSHP.DOCOWRIDR(+) AND
	            SEGSHP.CMPCOD

= FLTSEG.CMPCOD
AND
	            SEGSHP.FLTCARIDR = FLTSEG.FLTCARIDR AND
	            SEGSHP.FLTNUM
=
FLTSEG.FLTNUM
AND
	            SEGSHP.FLTSEQNUM = FLTSEG.FLTSEQNUM AND
	            SEGSHP.SEGSERNUM

= FLTSEG.SEGSERNUM
AND
						  FLTSEG.CMPCOD = IMPFLT.CMPCOD AND
						  FLTSEG.FLTCARIDR = IMPFLT.FLTCARIDR

AND

FLTSEG.FLTNUM = IMPFLT.FLTNUM AND
						  FLTSEG.FLTSEQNUM = IMPFLT.FLTSEQNUM AND



FLTSEG.POU = IMPFLT.ARPCOD AND
						  FLTSEG.CMPCOD = SHPMST.CMPCOD AND
						  FLTSEG.FLTCARIDR
=
?
AND
						  FLTSEG.FLTNUM = ? AND
						  FLTSEG.FLTSEQNUM = ? AND
						  IMPFLT.ARPCOD = ? AND



						  SHPMST.CMPCOD = ? AND
						  SHPMST.PARSEQNUM = ? AND
						  SHPMST.DUPNUM = ? AND


						  SHPMST.MSTDOCNUM
= ? AND
	            		  SHPMST.DOCOWRIDR = ?
	            		  ORDER BY DOCNUM
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>321</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findhawbforGroupDetails" Type="NATIVE">
			<![CDATA[
  	             SELECT MST.CMPCOD,
					  MST.MSTDOCNUM,
					  MST.DOCOWRIDR,
					  MST.SEQNUM,



					  MST.DUPNUM,
					  MST.STDPCS STDPCS,
					  MST.STDWGT STDWGT,
					  MST.DOCNUM,
					  NVL(PCS,


0) LDPPCS,
					  NVL(WGT,   0) LDPWGT
					FROM OPRSHPMST MST LEFT
					OUTER JOIN OPRTXNHSE HSE ON




					 MST.CMPCOD = HSE.CMPCOD
					 AND MST.MSTDOCNUM = HSE.MSTDOCNUM
					 AND MST.DOCOWRIDR = HSE.DOCOWRIDR



					 AND MST.DUPNUM = HSE.DUPNUM
					 AND MST.SEQNUM = HSE.SEQNUM
					 AND HSE.ARPCOD = ?

AND
HSE.TXNREFTWO
= ?
					 AND HSE.TXNREFTHR = ?
					 AND HSE.TXNREFFIV = ?
					 AND HSE.TXNREFSIX
=
?
					 AND HSE.TXNCOD
= 'LDP'

					WHERE MST.CMPCOD = ?
					 AND MST.MSTDOCNUM = ?
					 AND MST.DOCOWRIDR

= ?
					 AND
MST.DUPNUM = ?
					 AND MST.PARSEQNUM = 1


			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>273</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findgrossweight" Type="NATIVE">
			<![CDATA[

                SELECT
		  NVL(SUM(
		    CASE
		      WHEN COALESCE(ULD.ULDPOS, '') ='B'



		      THEN (DWSULD.ACTWGT - DWSULD.TARWGT)
		      ELSE DWSULD.ACTWGT
		    END ),0) GRANDTOTAL


		FROM

		  FLTOPRLEG FLTLEG
		INNER JOIN OPRFLTSEG FLT
		ON
		  FLTLEG.FLTNUM      = FLT.FLTNUM


		AND FLTLEG.FLTCARIDR
= FLT.FLTCARIDR
		AND FLTLEG.FLTSEQNUM = FLT.FLTSEQNUM
		AND FLTLEG.CMPCOD
=
FLT.CMPCOD
		AND FLTLEG.LEGORG
= FLT.POL
		INNER JOIN OPRDWSULD DWSULD
		ON
		  DWSULD.FLTNUM

= FLT.FLTNUM
		AND DWSULD.FLTCARIDR
= FLT.FLTCARIDR
		AND DWSULD.CMPCOD    = FLT.CMPCOD
		AND DWSULD.FLTSEQNUM

= FLT.FLTSEQNUM
		AND DWSULD.ARPCOD
= FLT.POL
				AND DWSULD.POU       =FLT.POU
		AND DWSULD.LEGSERNUM

= FLTLEG.LEGSERNUM
		LEFT OUTER JOIN
OPRSEGULD ULD
		ON
		  FLT.FLTNUM      = ULD.FLTNUM
		AND FLT.FLTCARIDR

= ULD.FLTCARIDR
		AND FLT.FLTSEQNUM
= ULD.FLTSEQNUM
		AND FLT.CMPCOD    = ULD.CMPCOD
		AND FLT.SEGSERNUM

= ULD.SEGSERNUM
		AND DWSULD.ULDNUM
= ULD.ULDNUM
		AND DWSULD.CMPCOD = ULD.CMPCOD
		LEFT OUTER JOIN

MALULDSEG MTKULD
		ON
		  FLT.FLTNUM
= MTKULD.FLTNUM
		AND FLT.FLTCARIDR = MTKULD.FLTCARIDR

AND
FLT.FLTSEQNUM = MTKULD.FLTSEQNUM
		AND FLT.CMPCOD
= MTKULD.CMPCOD
		AND FLT.SEGSERNUM = MTKULD.SEGSERNUM


		AND DWSULD.ULDNUM = MTKULD.ULDNUM
		AND DWSULD.CMPCOD
= MTKULD.CMPCOD
		WHERE
		  FLT.CMPCOD
=
?
		AND FLT.FLTNUM    = ?
		AND FLT.FLTCARIDR = ?
		AND
FLT.FLTSEQNUM = ?
		AND FLT.POL       = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>308</QRY:Id>
		<QRY:Source Name="operations.flthandling.checkifuldsdelivered" Type="NATIVE">
			<![CDATA[

              SELECT
  				CASE
			 WHEN PMCOUNT > MCOUNT OR PLCOUNT > LCOUNT OR PCCOUNT > CCOUNT OR


PBCOUNT > BCOUNT THEN
					'FALSE'
					ELSE
					  'TRUE'
					END RSTSTR
					FROM
			   (SELECT
NVL(SUM(NVL(MANPOS,

0)),    0) PMCOUNT,
			      NVL(SUM(NVL(LWRPOS,    0)),    0) PLCOUNT,

NVL(SUM(NVL(CNTPOS,

0)),    0) PCCOUNT,
			      NVL(SUM(NVL(BLKPOS,    0)),    0) PBCOUNT

FROM OPRLODPLNPOSDTL DTL,


			      OPRLODPLNPOL POL
					WHERE DTL.CMPCOD = POL.CMPCOD

AND DTL.FLTNUM     = POL.FLTNUM

						  AND
DTL.FLTSEQNUM  = POL.FLTSEQNUM
						  AND DTL.FLTCARIDR
= POL.FLTCARIDR
						  AND POL.CMPCOD

= ?
						  AND POL.FLTNUM     = ?
						  AND POL.FLTCARIDR
= ?
						  AND POL.FLTSEQNUM  = ?


			    AND POL.POL = ?)
			 LODPLN,
			     (SELECT
nvl(SUM(
				   CASE  WHEN NVL(SEGULD.ULDPOS, '')  ='M'
			     THEN
case when dwsuld.uldposcnt >1 then dwsuld.uldposcnt else 1 end


END),0) MCOUNT,
				   nvl(SUM(

CASE  WHEN NVL(SEGULD.ULDPOS, '')

='L'
			    THEN case when dwsuld.uldposcnt
>1 then dwsuld.uldposcnt else 1 end
			     END),0) LCOUNT,


nvl(SUM(
			     CASE  WHEN NVL(SEGULD.ULDPOS,
'')  ='C'
			     THEN

case when dwsuld.uldposcnt >1 then dwsuld.uldposcnt
else 1 end
			     END),0) CCOUNT,
				   nvl(SUM(


CASE  WHEN NVL(SEGULD.ULDPOS,'')  ='B'
			    THEN case when dwsuld.uldposcnt

>1 then dwsuld.uldposcnt else 1 end

END),0) BCOUNT
			  FROM FLTOPRSEG

FLTSEG,
					    OPRSEGULD SEGULD      ,
					    MALULDSEG MTKULD,




FLTOPRLEG EXPFLT   ,
					    OPRDWSULD DWSULD
					    WHERE FLTSEG.CMPCOD
= DWSULD.CMPCOD
					  AND

FLTSEG.FLTCARIDR  = DWSULD.FLTCARIDR
					  AND FLTSEG.FLTNUM     = DWSULD.FLTNUM

AND FLTSEG.FLTSEQNUM

= DWSULD.FLTSEQNUM
					  AND FLTSEG.SEGORG  = DWSULD.ARPCOD
					  AND FLTSEG.SEGSTA
<> 'D'



AND FLTSEG.CMPCOD     = EXPFLT.CMPCOD
					  AND FLTSEG.FLTCARIDR  = EXPFLT.FLTCARIDR

AND FLTSEG.FLTNUM

= EXPFLT.FLTNUM
					  AND FLTSEG.FLTSEQNUM  = EXPFLT.FLTSEQNUM
					  AND FLTSEG.SEGORG
= EXPFLT.LEGORG


AND EXPFLT.LEGORG     = DWSULD.ARPCOD
					  AND EXPFLT.LEGSERNUM  =
DWSULD.LEGSERNUM
					  AND SEGULD.CMPCOD(+)

= DWSULD.CMPCOD
					  AND SEGULD.FLTCARIDR(+)  =
DWSULD.FLTCARIDR
					  AND SEGULD.FLTNUM(+)     =

DWSULD.FLTNUM
					  AND SEGULD.FLTSEQNUM(+)  =
DWSULD.FLTSEQNUM
					  AND SEGULD.ULDNUM(+)     = DWSULD.ULDNUM



AND DWSULD.FLTCARIDR = MTKULD.FLTCARIDR(+)

AND DWSULD.FLTSEQNUM = MTKULD.FLTSEQNUM(+)

					  AND
DWSULD.FLTNUM = MTKULD.FLTNUM(+)

AND DWSULD.CMPCOD = MTKULD.CMPCOD(+)
					  AND DWSULD.ULDNUM

= MTKULD.ULDNUM(+)


					  AND FLTSEG.SEGDST        = DWSULD.POU
						  AND EXPFLT.CMPCOD

= ?

AND EXPFLT.FLTCARIDR  = ?
						  AND EXPFLT.FLTNUM     = ?
						  AND EXPFLT.FLTSEQNUM

= ?

AND EXPFLT.LEGORG     = ?


			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>337</QRY:Id>
		<QRY:Source Name="operations.flthandling.checkifuldsdelivered_forPosition" Type="NATIVE">
			<![CDATA[

					 THEN
						'FALSE'
						ELSE
						  'TRUE'
						END RSTSTR
						FROM
						 (  SELECT



NVL(SUM(NVL( MANPOS,0) ),0) PMCOUNT, nvl(SUM( NVL( LWRPOS,0) ),0) PLCOUNT , nvl(SUM(NVL( CNTPOS,0)
),0)

PCCOUNT, nvl(SUM(NVL( BLKPOS,0) ),0) PBCOUNT
					 FROM
						  OPRLODPLNPOSDTL DTL,OPRLODPLNPOL
POL


					WHERE DTL.CMPCOD = POL.CMPCOD
						  AND DTL.FLTNUM     = POL.FLTNUM
						  AND DTL.FLTSEQNUM

= POL.FLTSEQNUM

						  AND DTL.FLTCARIDR  = POL.FLTCARIDR
						  AND POL.CMPCOD     = ?


						  AND POL.FLTNUM     = ?

						  AND POL.FLTCARIDR  = ?
						  AND POL.FLTSEQNUM  =
?

						  AND POL.POL        = ?
				  ) LODPLN,

						( SELECT nvl(SUM(

CASE  WHEN NVL(SEGULD.ULDPOS,'')
='M'
							THEN case when dwsuld.uldposcnt
>1 then dwsuld.uldposcnt
else 1 end
							END),0) MCOUNT,

nvl(SUM(

CASE  WHEN NVL(SEGULD.ULDPOS,'')  ='L'

THEN case when
dwsuld.uldposcnt >1 then dwsuld.uldposcnt
else 1 end
							END),0) LCOUNT,

nvl(SUM(

CASE  WHEN NVL(SEGULD.ULDPOS, '')  ='C'
							THEN
case when dwsuld.uldposcnt
>1 then dwsuld.uldposcnt else 1 end

END),0) CCOUNT,
							      nvl(SUM(


CASE  WHEN NVL(SEGULD.ULDPOS, '')  ='B'
						       THEN case when
dwsuld.uldposcnt
>1 then dwsuld.uldposcnt else 1 end

END),0) BCOUNT
					 					 		FROM
FLTOPRSEG FLTSEG,

OPRSEGULD SEGULD      ,


MALULDSEG MTKULD,
					                  
					                   FLTOPRLEG EXPFLT

,
					                   OPRDWSULD DWSULD

WHERE  FLTSEG.CMPCOD = DWSULD.CMPCOD

AND
FLTSEG.FLTCARIDR  = DWSULD.FLTCARIDR
					   AND FLTSEG.FLTNUM
= DWSULD.FLTNUM
					   AND
FLTSEG.FLTSEQNUM
= DWSULD.FLTSEQNUM
					   AND FLTSEG.SEGORG  = DWSULD.ARPCOD

AND FLTSEG.SEGSTA
<> 'D'


AND FLTSEG.CMPCOD     = EXPFLT.CMPCOD
					   AND FLTSEG.FLTCARIDR
= EXPFLT.FLTCARIDR

AND FLTSEG.FLTNUM
= EXPFLT.FLTNUM
					   AND FLTSEG.FLTSEQNUM  = EXPFLT.FLTSEQNUM

AND
FLTSEG.SEGORG        =
EXPFLT.LEGORG

					   AND EXPFLT.LEGORG     = DWSULD.ARPCOD
					   AND EXPFLT.LEGSERNUM

= DWSULD.LEGSERNUM


					   AND SEGULD.CMPCOD(+)     = DWSULD.CMPCOD
					   AND SEGULD.FLTCARIDR(+)

= DWSULD.FLTCARIDR

					   AND SEGULD.FLTNUM(+)     = DWSULD.FLTNUM
					   AND SEGULD.FLTSEQNUM(+)

= DWSULD.FLTSEQNUM

					   AND SEGULD.ULDNUM(+)     = DWSULD.ULDNUM

					     AND DWSULD.FLTCARIDR
=
MTKULD.FLTCARIDR(+)

					   AND DWSULD.FLTSEQNUM = MTKULD.FLTSEQNUM(+)
					   AND DWSULD.FLTNUM
= MTKULD.FLTNUM(+)

AND
DWSULD.CMPCOD = MTKULD.CMPCOD(+)
					   AND DWSULD.ULDNUM = MTKULD.ULDNUM(+)





  						AND FLTSEG.SEGDST        = DWSULD.POU
						  AND EXPFLT.CMPCOD
= ?


AND EXPFLT.FLTCARIDR  = ?
						  AND EXPFLT.FLTNUM     = ?
						  AND EXPFLT.FLTSEQNUM
= ?


						  AND EXPFLT.LEGORG     = ?
								  AND DWSULD.DLVSTA  IN ('DS','DL')

AND CASE WHEN
NVL(SEGULD.ULDPOS,
NVL(DSNCON.POSTYP, MTKULD.POSTYP)) IN ('M','L') THEN 'M' ELSE NVL(SEGULD.ULDPOS,

NVL(DSNCON.POSTYP, MTKULD.POSTYP))
END = CASE WHEN ? IN ('M','L') THEN 'M' ELSE ? END
				  ) SEGULD

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>272</QRY:Id>
		<QRY:Source Name="operations.flthandling.jto.finddeliverysheetdetails" Type="NATIVE">
			<![CDATA[

				SELECT DLVLST.CMPCOD,
				  DLVLST.ARPCOD,
				  DLVLST.DLVIDR,
				  DLVLST.LSTFLG,
				  DLVLST.DLVCMPSTA,



				  DLVLST.FLTCARIDR,
				  DLVLST.FLTNUM,
				  DLVLST.FLTSEQNUM,
				  DLVLST.ARPCOD,
				  DLVLST.CMPCOD,



				  DLVLST.CNTTYP,
				  NVL(ULD.ULDPOS, '') ULDPOS,
				  DWSULD.ULDCTR,



				  DWSULD.DLVSTA,
				  FLT.SEGSERNUM,
				  DWSULD.ULDNUM,
				  DWSULD.GRSWGT,
				  DWSULD.ULDVOL,



				  SUM(ULDSHP.BDPPCS) TOTPCS,
				  FLT.SEGDST POU,
				  WHS.CURLOCCOD,
				  DWSULD.CONIDR,


				  DWSULD.ACTWGT,

				  DWSULD.TARWGT,
				  NVL(ULD.RMK, DWSULD.BLKRMK) BLKRMK
				FROM FLTOPRLEG

EXP
				INNER JOIN FLTOPRSEG
FLT ON
				EXP.FLTNUM = FLT.FLTNUM
								 AND EXP.FLTCARIDR = FLT.FLTCARIDR


								 AND EXP.FLTSEQNUM
= FLT.FLTSEQNUM
								 AND EXP.CMPCOD = FLT.CMPCOD
				 AND EXP.LEGORG
= FLT.SEGORG

				 AND FLT.SEGSTA
<> 'D'

				 INNER JOIN OPRDWSULD DWSULD ON
				 FLT.FLTNUM =
DWSULD.FLTNUM

				 				 AND FLT.FLTCARIDR
= DWSULD.FLTCARIDR
				 				 AND FLT.FLTSEQNUM
= DWSULD.FLTSEQNUM
				 				 AND EXP.LEGSERNUM
= DWSULD.LEGSERNUM

AND FLT.SEGDST = DWSULD.POU

AND FLT.CMPCOD = DWSULD.CMPCOD

				 AND FLT.SEGORG = DWSULD.ARPCOD


				 INNER JOIN OPRULDDLVLST
DLVLST ON

				EXP.FLTNUM = DLVLST.FLTNUM

								 AND EXP.FLTCARIDR = DLVLST.FLTCARIDR


								 AND EXP.FLTSEQNUM = DLVLST.FLTSEQNUM

								 AND EXP.CMPCOD = DLVLST.CMPCOD

AND EXP.LEGORG = DLVLST.ARPCOD

				 AND DWSULD.FLTCARIDR =
DLVLST.FLTCARIDR
				  AND DWSULD.FLTSEQNUM
= DLVLST.FLTSEQNUM
				  AND DWSULD.FLTNUM
= DLVLST.FLTNUM

				  AND DWSULD.CMPCOD = DLVLST.CMPCOD

AND DWSULD.DLVIDR = DLVLST.DLVIDR

				  AND DWSULD.ARPCOD
= DLVLST.ARPCOD

				  LEFT OUTER JOIN
OPRSEGULD ULD ON

				 DWSULD.FLTCARIDR = ULD.FLTCARIDR


				 				 AND DWSULD.FLTSEQNUM =
ULD.FLTSEQNUM
				 				 AND DWSULD.FLTNUM = ULD.FLTNUM
				 				 AND
DWSULD.CMPCOD
= ULD.CMPCOD

AND DWSULD.ULDNUM = ULD.ULDNUM
				 AND FLT.SEGSERNUM = ULD.SEGSERNUM


				 LEFT OUTER
JOIN WHSSTUMST
WHS ON

				DWSULD.ULDNUM  = WHS.STUCOD
				 AND  DWSULD.CMPCOD = WHS.CMPCOD


				 LEFT
OUTER
JOIN OPRSEGULDSHP ULDSHP ON
				 ULD.FLTNUM = ULDSHP.FLTNUM
				 						AND ULD.FLTCARIDR
= ULDSHP.FLTCARIDR


AND ULD.FLTSEQNUM = ULDSHP.FLTSEQNUM
				 						AND ULD.SEGSERNUM = ULDSHP.SEGSERNUM

AND
ULD.CMPCOD
= ULDSHP.CMPCOD
						AND ULD.ULDNUM = ULDSHP.ULDNUM

				LEFT OUTER JOIN MALULDSEG MTKULD

ON

				DWSULD.FLTCARIDR
= MTKULD.FLTCARIDR
								 AND DWSULD.FLTSEQNUM = MTKULD.FLTSEQNUM


								 AND DWSULD.FLTNUM = MTKULD.FLTNUM

AND DWSULD.CMPCOD = MTKULD.CMPCOD
				 AND DWSULD.ULDNUM

= MTKULD.ULDNUM

				WHERE  DLVLST.CMPCOD = ?
						AND DLVLST.ARPCOD = ?

				        AND FLT.FLTNUM = ?


                        AND FLT.FLTCARIDR = ?
                        AND FLT.FLTSEQNUM = ?


			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>271</QRY:Id>
		<QRY:Source Name="operations.flthandling.jto.findulddeliverysheets" Type="NATIVE">
			<![CDATA[

                SELECT DLVIDR FROM OPRULDDLVLST DLVLST
    				WHERE DLVLST.CMPCOD = ?
					AND DLVLST.ARPCOD = ?
					AND DLVLST.FLTCARIDR = ?
					AND DLVLST.FLTNUM = ?
					AND DLVLST.FLTSEQNUM = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>342</QRY:Id>
		<QRY:Source Name="operations.flthandling.jto.finduldbuildupcompleteddetails" Type="NATIVE">
			<![CDATA[
			SELECT ULD.FLTNUM,
			  ULD.FLTCARIDR,
			  ULD.FLTSEQNUM,
			  ULD.SEGSERNUM,
			  ULD.ULDNUM,



			  DWSULD.DLVIDR,
			  FLT.POU,
			  FLT.CMPCOD,
			  ULD.GRSWGT,
			  WHS.CURLOCCOD,
			  ULD.BDPCMPSTA,



			  DWSULD.WGHCMPSTA,
			  DWSULD.DLVSTA,
			  ULD.ULDPOS,
			  SUM(ULDSHP.BDPPCS) TOTPCS,
			  ULD.CONIDR,



			  ULD.ULDVOL,
			  DLVLST.CNTTYP,
			  DWSULD.ACTWGT,
			  DWSULD.TARWGT,
			  NVL(ULD.RMK,   DWSULD.BLKRMK)


RMK
			FROM OPRARPEXPFLT EXP,
			  OPRFLTSEG FLT,
			  OPRSEGULD ULD,
			  OPRULDDLVLST DLVLST,



			  OPRSEGULDSHP ULDSHP,
			  WHSSTUMST WHS,
			  OPRDWSULD DWSULD
			WHERE EXP.FLTNUM = FLT.FLTNUM


			 AND
EXP.FLTCARIDR = FLT.FLTCARIDR
			 AND EXP.FLTSEQNUM = FLT.FLTSEQNUM
			 AND EXP.CMPCOD = FLT.CMPCOD



			 AND EXP.ARPCOD = FLT.POL
			 AND FLT.FLTNUM = ULD.FLTNUM
			 AND FLT.FLTCARIDR = ULD.FLTCARIDR


			 AND
FLT.FLTSEQNUM = ULD.FLTSEQNUM
			 AND FLT.SEGSERNUM = ULD.SEGSERNUM
			 AND FLT.CMPCOD = ULD.CMPCOD



			 AND EXP.FLTNUM = DLVLST.FLTNUM(+)
			 AND EXP.FLTCARIDR = DLVLST.FLTCARIDR(+)
			 AND EXP.FLTSEQNUM

=
DLVLST.FLTSEQNUM(+)
			 AND EXP.CMPCOD = DLVLST.CMPCOD(+)
			 AND EXP.ARPCOD = DLVLST.ARPCOD(+)


			 AND
WHS.STUCOD(+) = ULD.ULDNUM
			 AND WHS.CMPCOD(+) = ULD.CMPCOD
			 AND ULD.FLTNUM = ULDSHP.FLTNUM(+)



			 AND ULD.FLTCARIDR = ULDSHP.FLTCARIDR(+)
			 AND ULD.FLTSEQNUM = ULDSHP.FLTSEQNUM(+)
			 AND ULD.SEGSERNUM


= ULDSHP.SEGSERNUM(+)
			 AND ULD.CMPCOD = ULDSHP.CMPCOD(+)
			 AND ULD.ULDNUM = ULDSHP.ULDNUM(+)



			 AND ULD.FLTCARIDR = DWSULD.FLTCARIDR(+)
			 AND ULD.FLTSEQNUM = DWSULD.FLTSEQNUM(+)
			 AND
ULD.FLTNUM

= DWSULD.FLTNUM(+)
			 AND ULD.CMPCOD = DWSULD.CMPCOD(+)
			 AND ULD.ULDNUM = DWSULD.ULDNUM(+)

AND

EXP.FLTNUM = ?
			 AND EXP.FLTCARIDR = ?
			 AND EXP.FLTSEQNUM = ?
			 AND EXP.ARPCOD = ?
 			 AND EXP.CMPCOD = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>266</QRY:Id>
		<QRY:Source Name="operations.flthandling.jto.findulddeliverydetails" Type="NATIVE">
			<![CDATA[

               SELECT DWSULD.FLTNUM                                     ,
  DWSULD.FLTCARIDR


,
  DWSULD.FLTSEQNUM                                        ,
  NVL(ULD.RMK, DWSULD.BLKRMK) RMK


,
  FLT.SEGSERNUM                                           ,
  DWSULD.ULDNUM


,
  DWSULD.DLVIDR                                           ,
  FLT.SEGDST POU


,
  FLT.CMPCOD                                              ,
  DWSULD.GRSWGT


,
  WHS.CURLOCCOD                                           ,
  ULD.BDPCMPSTA


,
  DWSULD.WGHCMPSTA                                        ,
  DWSULD.DLVSTA


,
  NVL(ULD.ULDPOS, '')ULDPOS,
  SUM(ULDSHP.BDPPCS) TOTPCS


,
  NVL(DWSULD.CONIDR,ULD.CONIDR) CONIDR                    ,
  DWSULD.ULDVOL


,
  DLVLST.CNTTYP                                           ,
  DWSULD.ACTWGT


,
  DWSULD.TARWGT
   FROM FLTOPRLEG EXP
   INNER JOIN 	 FLTOPRSEG FLT ON
   EXP.FLTNUM           =
FLT.FLTNUM


	AND EXP.FLTCARIDR            = FLT.FLTCARIDR
	AND EXP.FLTSEQNUM            = FLT.FLTSEQNUM

AND EXP.CMPCOD

= FLT.CMPCOD
AND EXP.LEGORG               = FLT.SEGORG
AND FLT.SEGSTA
<> 'D'

INNER JOIN OPRDWSULD DWSULD

ON
FLT.FLTNUM               = DWSULD.FLTNUM
AND FLT.FLTCARIDR
= DWSULD.FLTCARIDR
AND FLT.FLTSEQNUM

= DWSULD.FLTSEQNUM
AND EXP.LEGSERNUM            = DWSULD.LEGSERNUM
AND
FLT.SEGDST               = DWSULD.POU
AND

FLT.CMPCOD               = DWSULD.CMPCOD
AND FLT.SEGORG
= DWSULD.ARPCOD

LEFT OUTER JOIN

OPRSEGULD ULD ON
FLT.SEGSERNUM            = ULD.SEGSERNUM
AND DWSULD.FLTCARIDR
= ULD.FLTCARIDR
AND

DWSULD.FLTSEQNUM         = ULD.FLTSEQNUM
AND DWSULD.FLTNUM            = ULD.FLTNUM
AND
DWSULD.CMPCOD

= ULD.CMPCOD
AND DWSULD.ULDNUM            = ULD.ULDNUM

LEFT OUTER JOIN OPRULDDLVLST
DLVLST ON

DWSULD.FLTNUM

= DLVLST.FLTNUM
AND DWSULD.FLTCARIDR         = DLVLST.FLTCARIDR
AND
DWSULD.FLTSEQNUM         = DLVLST.FLTSEQNUM
AND

DWSULD.CMPCOD            = DLVLST.CMPCOD
AND DWSULD.ARPCOD
= DLVLST.ARPCOD
AND DWSULD.DLVIDR

= DLVLST.DLVIDR

LEFT OUTER JOIN   OPRSEGULDSHP ULDSHP
ON
ULD.FLTNUM               = ULDSHP.FLTNUM
AND

ULD.FLTCARIDR            = ULDSHP.FLTCARIDR
AND ULD.FLTSEQNUM
= ULDSHP.FLTSEQNUM
AND ULD.SEGSERNUM

= ULDSHP.SEGSERNUM
AND ULD.CMPCOD               = ULDSHP.CMPCOD
AND
ULD.ULDNUM               = ULDSHP.ULDNUM

LEFT

OUTER JOIN   WHSSTUMST WHS      ON
DWSULD.ULDNUM = WHS.STUCOD
AND
DWSULD.CMPCOD   = WHS.CMPCOD


LEFT

OUTER JOIN    MALULDSEG MTKULD ON

  DWSULD.FLTCARIDR         =
MTKULD.FLTCARIDR
AND DWSULD.FLTSEQNUM

= MTKULD.FLTSEQNUM
AND DWSULD.FLTNUM            = MTKULD.FLTNUM
AND
DWSULD.CMPCOD            = MTKULD.CMPCOD
AND

DWSULD.ULDNUM            = MTKULD.ULDNUM


WHERE
   EXP.FLTNUM

= ?
	AND EXP.FLTCARIDR            = ?
	AND EXP.FLTSEQNUM
= ?
	AND DWSULD.ARPCOD

= ?
	AND EXP.CMPCOD               = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>306</QRY:Id>
		<QRY:Source Name="operations.flthandling.jto.findulddeliverydetailsforht" Type="NATIVE">
			<![CDATA[

	              SELECT
					  DWSULD.FLTNUM,
		      		        DWSULD.FLTCARIDR   ,



		      		        DWSULD.FLTSEQNUM   ,
		      		        0 SEGSERNUM        ,
		      		        DWSULD.ULDNUM

,

		      		        DWSULD.DLVIDR      ,
		      		        DWSULD.CMPCOD      ,


		      		        DWSULD.GRSWGT      ,

		      		        NULL BDPCMPSTA     ,

DWSULD.WGHCMPSTA
,
		      		        DWSULD.DLVSTA      ,

		      		        NULL
ULDPOS        ,

		      		        NULL CONIDR        ,
		      		        0 ULDVOL
,

		      		        DLVLST.CNTTYP
,
		      		        DWSULD.LEGSERNUM

FROM
					  OPRDWSULD DWSULD


		      		      INNER JOIN OPRULDDLVLST
DLVLST
					ON
					  DWSULD.FLTNUM      = DLVLST.FLTNUM
		      		      AND

DWSULD.FLTCARIDR  = DLVLST.FLTCARIDR

AND DWSULD.FLTSEQNUM  = DLVLST.FLTSEQNUM


		      		      AND DWSULD.CMPCOD     = DLVLST.CMPCOD

AND DLVLST.DLVIDR     = DWSULD.DLVIDR

					INNER
JOIN FLTOPRLEG ULDDTL
					ON
					  ULDDTL.CMPCOD
= DWSULD.CMPCOD
					AND ULDDTL.FLTNUM
= DWSULD.FLTNUM

					AND ULDDTL.FLTCARIDR = DWSULD.FLTCARIDR

AND ULDDTL.FLTSEQNUM = DWSULD.FLTSEQNUM

					AND ULDDTL.LEGSERNUM
= DWSULD.LEGSERNUM

WHERE
		      		              DLVLST.ARPCOD
= ?
		          		AND DWSULD.CMPCOD = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<!-- ADDED BY &lt;sathya&gt; FOR TIACT 487 STARTS-->
	<QRY:Definition>
		<QRY:Id>292</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findgeneralmanifestconfig" Type="NATIVE">
			<![CDATA[
		  			SELECT	CMPCOD,ARLIDR,SEQNUM,MFTKND,POU,LCLTRA,REVNON,SHPCSG,WGTDEC,NTCSCC,MFTSCC,APOCONFLG,CTYCONFLG,FCTSCC,FINSCC
		  					FROM OPRGENMFTCFG
		  					WHERE CMPCOD = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<!-- ADDED BY &lt;sathya&gt; FOR TIACT 487 ENDS -->
	<QRY:Definition>
		<QRY:Id>372</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findgeneralmanifestedshipmentdetails" Type="NATIVE">
			<![CDATA[
				 SELECT LODPLNPOL.POL                   ,
                  LODPLNBKGSUM.DOCOWRIDR


,
                  LODPLNBKGSUM.MSTDOCNUM                ,
                  GENMFTSHP.MFTPCS PLNPCS


,
                  GENMFTSHP.MFTWGT PLNWGT               ,
                  LODPLNBKGSUM.SHPRMK


,
                  LODPLNBKGSUM.SEGORG                   ,
                  LODPLNBKGSUM.SEGDST


,
                  SHPMST.ORGCOD                         ,
                  SHPMST.DSTCOD


,
                  SHPMST.SLCPCS                         ,
                  SHPMST.SHPDES


,
                  SHPMST.SCCCOD                         ,
                  SHPMST.DUPNUM


,
                  SHPMST.SEQNUM                         ,
                  SHPMST.SHPPFX


,
                  LODPLNPOL.FLTCARIDR                   ,
                  LODPLNPOL.CMPCOD


,
                  LODPLNPOL.FLTNUM                      ,
                  LODPLNPOL.FLTSEQNUM


,
                  LODPLNPOL.SERNUM                      ,
                  GENMFTSHP.MFTVER


,
                  SHPMST.CNSNAM                         ,
                  SHPMST.SHPNAM


,
                  SHPMST.CNSADRONE                      ,
                  SHPMST.SHPADRONE


,
                  SHPMST.STDPCS                         ,
                  SHPMST.STDWGT


,
                  LODPLNBKGSUM.ONTFLTCARCOD ONTFLTCARCOD,
                  LODPLNBKGSUM.ONTFLTNUM


ONTFLTNUM      ,
                  LODPLNBKGSUM.ONTFLTDAT ONTFLTDAT      ,
                  LODPLNBKGSUM.ONTPOU


ONTPOU            ,
                  SHPMSTACC.SRVCRGCLS                   ,
                  SHPCNT.CNSPSTCOD


,
                  SHPCNT.CNSCTY                         ,
                  SHPCNT.CNSCTR


,
                  SHPCNT.CNSSTT                         ,
                  SHPCNT.CNSACCNUM


,
                  SHPCNT.SHPPSTCOD                      ,
                  SHPCNT.SHPCTR


,
                  SHPCNT.SHPCTY                         ,
                  SHPCNT.SHPSTT


,
                  SHPCNT.SHPACCNUM,
                  EXPFLT.LSTUPDUSR,
                    EXPFLT.LSTUPDTIM



FROM OPRLODPLNPOL LODPLNPOL,
                  OPRSHPMST SHPMST            ,
                  OPRGENMFTSHP


GENMFTSHP      ,
                  OPRLODPLNBKGSUM LODPLNBKGSUM,
                  OPRSHPMSTACC SHPMSTACC


,
                  OPRSHPMSTCNT SHPCNT,
                  OPRARPEXPFLT EXPFLT
                  WHERE


LODPLNPOL.CMPCOD   = LODPLNBKGSUM.CMPCOD
                AND LODPLNPOL.FLTCARIDR    = LODPLNBKGSUM.FLTCARIDR



AND LODPLNPOL.FLTNUM       = LODPLNBKGSUM.FLTNUM
                AND LODPLNPOL.FLTSEQNUM    = LODPLNBKGSUM.FLTSEQNUM



AND LODPLNPOL.CMPCOD       = LODPLNBKGSUM.CMPCOD
                AND LODPLNPOL.POL          = LODPLNBKGSUM.SEGORG



AND LODPLNBKGSUM.CMPCOD    = SHPMST.CMPCOD
                AND LODPLNBKGSUM.DOCOWRIDR = SHPMST.DOCOWRIDR



AND LODPLNBKGSUM.DUPNUM    = SHPMST.DUPNUM
                AND LODPLNBKGSUM.MSTDOCNUM = SHPMST.MSTDOCNUM



AND LODPLNBKGSUM.SEQNUM    = SHPMST.SEQNUM
                AND LODPLNBKGSUM.FLTCARIDR = GENMFTSHP.FLTCARIDR



AND LODPLNBKGSUM.FLTNUM    = GENMFTSHP.FLTNUM
                AND LODPLNBKGSUM.FLTSEQNUM = GENMFTSHP.FLTSEQNUM



AND LODPLNBKGSUM.SEGORG    = GENMFTSHP.ARPCOD
                AND LODPLNBKGSUM.CMPCOD    = GENMFTSHP.CMPCOD



AND LODPLNBKGSUM.DOCOWRIDR = GENMFTSHP.DOCOWRIDR
                AND LODPLNBKGSUM.DUPNUM    = GENMFTSHP.DUPNUM



AND LODPLNBKGSUM.MSTDOCNUM = GENMFTSHP.MSTDOCNUM
                AND LODPLNBKGSUM.SEQNUM    = GENMFTSHP.SEQNUM



AND GENMFTSHP.FLTCARIDR    = EXPFLT.FLTCARIDR(+)
                AND GENMFTSHP.FLTNUM       = EXPFLT.FLTNUM(+)



AND GENMFTSHP.FLTSEQNUM    = EXPFLT.FLTSEQNUM(+)
                AND GENMFTSHP.ARPCOD       = EXPFLT.ARPCOD(+)



AND GENMFTSHP.CMPCOD       = EXPFLT.CMPCOD (+)
                AND GENMFTSHP.LEGSERNUM    = EXPFLT.LEGSERNUM(+)



AND SHPMSTACC.CMPCOD       =SHPMST.CMPCOD
                AND SHPMSTACC.DOCOWRIDR    =SHPMST.DOCOWRIDR



AND SHPMSTACC.MSTDOCNUM    =SHPMST.MSTDOCNUM
                AND SHPMSTACC.DUPNUM       =SHPMST.DUPNUM



AND SHPMSTACC.SEQNUM       =SHPMST.SEQNUM
                AND SHPMST.CMPCOD          = SHPCNT.CMPCOD



AND SHPMST.DOCOWRIDR       = SHPCNT.DOCOWRIDR
                AND SHPMST.MSTDOCNUM       = SHPCNT.MSTDOCNUM



AND SHPMST.DUPNUM          = SHPCNT.DUPNUM
                AND SHPMST.SEQNUM          = SHPCNT.SEQNUM



AND SHPMST.EXEFLG          = 'Y'
                AND LODPLNPOL.CMPCOD       = ?
                AND

LODPLNPOL.FLTCARIDR
= ?
                AND LODPLNPOL.FLTNUM       = ?
                AND LODPLNPOL.FLTSEQNUM

= ?

                AND LODPLNPOL.POL          = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>373</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findgeneralmanifestedlygshipmentdetails" Type="NATIVE">
			<![CDATA[
				SELECT LODPLNPOL.POL                   ,
                  LODPLNBKGSUM.DOCOWRIDR


,
                  LODPLNBKGSUM.MSTDOCNUM                ,
                  GENMFTSHP.MFTPCS PLNPCS


,
                  GENMFTSHP.MFTWGT PLNWGT               ,
                  LODPLNBKGSUM.SHPRMK


,
                  LODPLNBKGSUM.SEGORG                   ,
                  LODPLNBKGSUM.SEGDST


,
                  SHPMST.ORGCOD                         ,
                  SHPMST.DSTCOD


,
                  SHPMST.SLCPCS                         ,
                  SHPMST.SHPDES


,
                  SHPMST.SCCCOD                         ,
                  SHPMST.DUPNUM


,
                  SHPMST.SEQNUM                         ,
                  SHPMST.SHPPFX


,
                  LODPLNPOL.FLTCARIDR                   ,
                  LODPLNPOL.CMPCOD


,
                  LODPLNPOL.FLTNUM                      ,
                  LODPLNPOL.FLTSEQNUM


,
                  LODPLNPOL.SERNUM                      ,
                  GENMFTSHP.MFTVER


,
                  SHPMST.CNSNAM                         ,
                  SHPMST.SHPNAM


,
                  SHPMST.CNSADRONE                      ,
                  SHPMST.SHPADRONE


,
                  SHPMST.STDPCS                         ,
                  SHPMST.STDWGT


,
                  LODPLNBKGSUM.ONTFLTCARCOD ONTFLTCARCOD,
                  LODPLNBKGSUM.ONTFLTNUM


ONTFLTNUM      ,
                  LODPLNBKGSUM.ONTFLTDAT ONTFLTDAT      ,
                  LODPLNBKGSUM.ONTPOU


ONTPOU            ,
                  SHPMSTACC.SRVCRGCLS                   ,
                  SHPCNT.CNSPSTCOD


,
                  SHPCNT.CNSCTY                         ,
                  SHPCNT.CNSCTR


,
                  SHPCNT.CNSSTT                         ,
                  SHPCNT.CNSACCNUM


,
                  SHPCNT.SHPPSTCOD                      ,
                  SHPCNT.SHPCTR


,
                  SHPCNT.SHPCTY                         ,
                  SHPCNT.SHPSTT


,
                  SHPCNT.SHPACCNUM,
                  EXPFLT.LSTUPDUSR,
                    EXPFLT.LSTUPDTIM



FROM OPRLODPLNPOL LODPLNPOL,
                  OPRSHPMST SHPMST            ,
                  OPRGENMFTSHP


GENMFTSHP      ,
                  OPRSHPMSTACC SHPMSTACC      ,
                  OPRSHPMSTCNT SHPCNT


,
                  OPRLODPLNLYGSHP LODPLNBKGSUM,
                  OPRARPEXPFLT EXPFLT



                  WHERE LODPLNPOL.CMPCOD   = LODPLNBKGSUM.CMPCOD
                AND LODPLNPOL.FLTCARIDR

= LODPLNBKGSUM.FLTCARIDR

                AND LODPLNPOL.FLTNUM       = LODPLNBKGSUM.FLTNUM


AND LODPLNPOL.FLTSEQNUM    = LODPLNBKGSUM.FLTSEQNUM

                AND LODPLNPOL.CMPCOD

= LODPLNBKGSUM.CMPCOD
                AND LODPLNPOL.POL          = LODPLNBKGSUM.SEGORG



                AND LODPLNBKGSUM.CMPCOD    = SHPMST.CMPCOD
                AND LODPLNBKGSUM.DOCOWRIDR

= SHPMST.DOCOWRIDR

                AND LODPLNBKGSUM.DUPNUM    = SHPMST.DUPNUM


AND LODPLNBKGSUM.MSTDOCNUM = SHPMST.MSTDOCNUM

                AND LODPLNBKGSUM.SEQNUM

= SHPMST.SEQNUM
                AND LODPLNBKGSUM.FLTCARIDR = GENMFTSHP.FLTCARIDR



AND LODPLNBKGSUM.FLTNUM    = GENMFTSHP.FLTNUM
                AND LODPLNBKGSUM.FLTSEQNUM = GENMFTSHP.FLTSEQNUM



                AND LODPLNBKGSUM.SEGORG    = GENMFTSHP.ARPCOD
                AND LODPLNBKGSUM.CMPCOD

= GENMFTSHP.CMPCOD

                AND LODPLNBKGSUM.DOCOWRIDR = GENMFTSHP.DOCOWRIDR


AND LODPLNBKGSUM.DUPNUM    = GENMFTSHP.DUPNUM

                AND LODPLNBKGSUM.MSTDOCNUM

= GENMFTSHP.MSTDOCNUM
                AND LODPLNBKGSUM.SEQNUM    = GENMFTSHP.SEQNUM



AND GENMFTSHP.FLTCARIDR    = EXPFLT.FLTCARIDR(+)
                AND GENMFTSHP.FLTNUM
= EXPFLT.FLTNUM(+)


                AND GENMFTSHP.FLTSEQNUM    = EXPFLT.FLTSEQNUM(+)

AND GENMFTSHP.ARPCOD
= EXPFLT.ARPCOD(+)

                AND GENMFTSHP.CMPCOD
= EXPFLT.CMPCOD (+)

AND GENMFTSHP.LEGSERNUM    = EXPFLT.LEGSERNUM(+)


                AND SHPMSTACC.CMPCOD
=SHPMST.CMPCOD
                AND SHPMSTACC.DOCOWRIDR
=SHPMST.DOCOWRIDR


AND SHPMSTACC.MSTDOCNUM    =SHPMST.MSTDOCNUM

AND SHPMSTACC.DUPNUM       =SHPMST.DUPNUM


                AND SHPMSTACC.SEQNUM
=SHPMST.SEQNUM
                AND SHPMST.CMPCOD
= SHPCNT.CMPCOD


AND SHPMST.DOCOWRIDR       = SHPCNT.DOCOWRIDR

AND SHPMST.MSTDOCNUM       = SHPCNT.MSTDOCNUM


                AND SHPMST.DUPNUM
= SHPCNT.DUPNUM
                AND SHPMST.SEQNUM
= SHPCNT.SEQNUM


AND SHPMST.EXEFLG          = 'Y'
                AND
LODPLNPOL.CMPCOD       = ?
                AND LODPLNPOL.FLTCARIDR

= ?
                AND LODPLNPOL.FLTNUM
= ?
                AND LODPLNPOL.FLTSEQNUM    = ?



AND LODPLNPOL.POL          = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>265</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findgeneralmanifestshipmentdetails" Type="NATIVE">
			<![CDATA[
		  SELECT LODPLNPOL.POL                                             ,
          LODPLNSHP.POSSERNUM


,
          LODPLNSHP.DOCOWNIDR     DOCOWRIDR                                        ,
          LODPLNSHP.MSTDOCNUM


,
          LODPLNSHP.PLNPCS                                                ,
          LODPLNSHP.PLNWGT


,
          LODPLNSHP.SHPRMK                                                ,
          LODPLNSHP.SEGORG


,
          LODPLNSHP.SEGDST                                                ,
          LODPLNSHP.POSNUM


,
          SHPMST.ORGCOD                                                   ,
          SHPMST.DSTCOD


,
          SHPMST.SLCPCS                                                   ,
          SHPMST.SHPDES


,
          SHPMST.SCCCOD                                                   ,
          SHPMST.DUPNUM


,
          SHPMST.SEQNUM                                                   ,
          SHPMST.SHPPFX


,
          LODPLNPOL.FLTCARIDR                                             ,
          LODPLNPOL.CMPCOD


,
          LODPLNPOL.FLTNUM                                                ,
          LODPLNPOL.FLTSEQNUM


,
          GENMFTSHP.MFTVER                                                ,
          SHPMST.CNSNAM


,
          SHPMST.SHPNAM                                                   ,
          SHPMST.CNSADRONE


,
          SHPMST.SHPADRONE                                                ,
          SHPMST.STDPCS


,
          SHPMST.STDWGT                                                   ,
          NVL( LODPLNBKGSUM.ONTFLTCARCOD,LYGSHP.ONTFLTCARCOD)


ONTFLTCARCOD,
          NVL( LODPLNBKGSUM.ONTFLTNUM,LYGSHP. ONTFLTNUM) ONTFLTNUM        ,


          NVL(
LODPLNBKGSUM.ONTFLTDAT,LYGSHP. ONTFLTDAT) ONTFLTDAT        ,
          NVL( LODPLNBKGSUM.ONTPOU

, LYGSHP.
ONTPOU) ONTPOU               ,
          SHPMSTACC.SRVCRGCLS


,
          SHPCNT.CNSPSTCOD                                                ,
          SHPCNT.CNSCTY


,
          SHPCNT.CNSCTR                                                   ,
          SHPCNT.CNSSTT


,
          SHPCNT.CNSACCNUM                                                ,
          SHPCNT.SHPPSTCOD


,
          SHPCNT.SHPCTR                                                   ,
          SHPCNT.SHPCTY


,
          SHPCNT.SHPSTT                                                   ,
          SHPCNT.SHPACCNUM,



EXPFLT.LSTUPDUSR,
            EXPFLT.LSTUPDTIM

           FROM OPRLODPLNPOL LODPLNPOL,
          OPRLODPLNSHP


LODPLNSHP      ,
          OPRSHPMST SHPMST            ,
          OPRGENMFTSHP GENMFTSHP      ,



OPRLODPLNBKGSUM LODPLNBKGSUM,
          OPRSHPMSTACC SHPMSTACC      ,
          OPRSHPMSTCNT SHPCNT


,
          OPRLODPLNLYGSHP LYGSHP,
          OPRARPEXPFLT EXPFLT,
          FLTOPRLEG FLTLEG




          WHERE LODPLNPOL.CMPCOD = LODPLNSHP.CMPCOD
        AND LODPLNPOL.FLTCARIDR  = LODPLNSHP.FLTCARIDR



        AND LODPLNPOL.FLTNUM     = LODPLNSHP.FLTNUM
        AND LODPLNPOL.FLTSEQNUM  = LODPLNSHP.FLTSEQNUM



        AND LODPLNPOL.CMPCOD     = LODPLNSHP.CMPCOD
        AND LODPLNPOL.POL        = LODPLNSHP.SEGORG




        AND FLTLEG.CMPCOD       = LODPLNPOL.CMPCOD
        AND FLTLEG.FLTNUM       = LODPLNPOL.FLTNUM



        AND FLTLEG.FLTCARIDR    = LODPLNPOL.FLTCARIDR
        AND FLTLEG.FLTSEQNUM    = LODPLNPOL.FLTSEQNUM



        AND FLTLEG.LEGORG       = LODPLNPOL.POL

        AND FLTLEG.CMPCOD       = EXPFLT.CMPCOD(+)


        AND
FLTLEG.FLTNUM       = EXPFLT.FLTNUM(+)
        AND FLTLEG.FLTCARIDR    = EXPFLT.FLTCARIDR(+)



        AND FLTLEG.FLTSEQNUM    =EXPFLT.FLTSEQNUM(+)
        AND FLTLEG.LEGSERNUM    = EXPFLT.LEGSERNUM

(+)


        AND LODPLNSHP.CMPCOD     = SHPMST.CMPCOD
        AND LODPLNSHP.DOCOWNIDR  = SHPMST.DOCOWRIDR



        AND LODPLNSHP.DUPNUM     = SHPMST.DUPNUM
        AND LODPLNSHP.MSTDOCNUM  = SHPMST.MSTDOCNUM



        AND LODPLNSHP.SEQNUM     = SHPMST.SEQNUM

        AND LODPLNSHP.FLTCARIDR  = GENMFTSHP.FLTCARIDR(+)



        AND LODPLNSHP.FLTNUM     = GENMFTSHP.FLTNUM(+)
        AND LODPLNSHP.FLTSEQNUM  = GENMFTSHP.FLTSEQNUM(+)



        AND LODPLNSHP.SEGORG     = GENMFTSHP.ARPCOD (+)
        AND LODPLNSHP.CMPCOD     = GENMFTSHP.CMPCOD(+)



        AND LODPLNSHP.DOCOWNIDR  = GENMFTSHP.DOCOWRIDR(+)
        AND LODPLNSHP.DUPNUM     = GENMFTSHP.DUPNUM(+)



        AND LODPLNSHP.MSTDOCNUM  = GENMFTSHP.MSTDOCNUM(+)
        AND LODPLNSHP.SEQNUM     = GENMFTSHP.SEQNUM(+)




        AND LODPLNSHP.CMPCOD     = LODPLNBKGSUM.CMPCOD(+)
        AND LODPLNSHP.FLTSEQNUM  = LODPLNBKGSUM.FLTSEQNUM(+)



        AND LODPLNSHP.FLTCARIDR  = LODPLNBKGSUM.FLTCARIDR(+)
        AND LODPLNSHP.FLTNUM     = LODPLNBKGSUM.FLTNUM(+)



        AND LODPLNSHP.DUPNUM     = LODPLNBKGSUM.DUPNUM(+)
        AND LODPLNSHP.SEQNUM     = LODPLNBKGSUM.SEQNUM(+)



        AND LODPLNSHP.DOCOWNIDR  = LODPLNBKGSUM.DOCOWRIDR(+)
        AND LODPLNSHP.MSTDOCNUM  = LODPLNBKGSUM.MSTDOCNUM(+)



        AND LODPLNSHP.SEGSERNUM  = LODPLNBKGSUM.SEGSERNUM(+)

        AND LODPLNSHP.CMPCOD     = LYGSHP.CMPCOD(+)



        AND LODPLNSHP.FLTSEQNUM  = LYGSHP.FLTSEQNUM(+)
        AND LODPLNSHP.FLTCARIDR  = LYGSHP.FLTCARIDR(+)



        AND LODPLNSHP.FLTNUM     =LYGSHP.FLTNUM(+)
        AND LODPLNSHP.DUPNUM     =LYGSHP.DUPNUM(+)



        AND LODPLNSHP.SEQNUM     =LYGSHP.SEQNUM(+)
        AND LODPLNSHP.DOCOWNIDR  =LYGSHP.DOCOWRIDR(+)



        AND LODPLNSHP.MSTDOCNUM  =LYGSHP.MSTDOCNUM(+)

        AND SHPMSTACC.CMPCOD     =SHPMST.CMPCOD



        AND SHPMSTACC.DOCOWRIDR  =SHPMST.DOCOWRIDR
        AND SHPMSTACC.MSTDOCNUM  =SHPMST.MSTDOCNUM



        AND SHPMSTACC.DUPNUM     =SHPMST.DUPNUM
        AND SHPMSTACC.SEQNUM     =SHPMST.SEQNUM



        AND
SHPMST.CMPCOD        = SHPCNT.CMPCOD
        AND SHPMST.DOCOWRIDR     = SHPCNT.DOCOWRIDR


        AND
SHPMST.MSTDOCNUM     = SHPCNT.MSTDOCNUM
        AND SHPMST.DUPNUM        = SHPCNT.DUPNUM


        AND
SHPMST.SEQNUM        = SHPCNT.SEQNUM



        AND SHPMST.EXEFLG        = 'Y'

AND
LODPLNPOL.CMPCOD
= ?
        AND LODPLNPOL.FLTCARIDR  = ?
        AND LODPLNPOL.FLTNUM
= ?

        AND LODPLNPOL.FLTSEQNUM
= ?
        AND LODPLNPOL.POL        = ?
        AND EXPFLT.ARPCOD(+)
= ?





			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>321</QRY:Id>
		<QRY:Source Name="operations.flthandling.jto.findhawbdetailsforSkidSplitMerge" Type="NATIVE">
			<![CDATA[
	              SELECT MST.CMPCOD ,MST.MSTDOCNUM ,MST.DOCOWRIDR ,MST.SEQNUM ,MST.DUPNUM ,MST.STDPCS STDPCS,



				MST.STDWGT STDWGT,MST.DOCNUM ,HSE.PCS SKDPCS ,HSE.WGT SKDWGT ,TXN.TXNCOD ,TXN.SERNUM,
			     (select


sum(pcs) from oprtxnhse txnnew where MST.CMPCOD = txnnew.CMPCOD
					and mst.mstdocnum = txnnew.mstdocnum



					AND MST.DOCOWRIDR   = txnnew.DOCOWRIDR
					AND MST.DUPNUM      = txnnew.DUPNUM
					AND MST.SEQNUM


= txnnew.SEQNUM
					      and txnnew.TXNCOD='ACP'    )acppcs
				 FROM OPRSHPMST MST LEFT OUTER JOIN


OPRTXNHSESMY HSE
			 ON	( MST.CMPCOD = HSE.CMPCOD
				AND MST.MSTDOCNUM   = HSE.MSTDOCNUM
				AND MST.DOCOWRIDR


= HSE.DOCOWRIDR
				AND MST.DUPNUM      = HSE.DUPNUM
				AND MST.SEQNUM      = HSE.SEQNUM
				AND HSE.TXNREFFOR


= ?)
					left OUTER JOIN oprtxnhse txn
						on MST.CMPCOD = TXN.CMPCOD
					and mst.mstdocnum = txn.mstdocnum



					AND MST.DOCOWRIDR   = TXN.DOCOWRIDR
					AND MST.DUPNUM      = TXN.DUPNUM
					AND MST.SEQNUM

=
TXN.SEQNUM
					and txn.TXNREFFOR=?



					 WHERE MST.CMPCOD  =?

						AND MST.MSTDOCNUM   = ?



						AND MST.DOCOWRIDR   = ?
						AND MST.DUPNUM      = ?
				AND MST.PARSEQNUM   = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>338</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findselectdetailsforareasuggestion" Type="NATIVE">
			<![CDATA[
				 SELECT
				    CASE
				        WHEN ARPSHP.CUSCLRNUM IS NULL
				        THEN 'N'
				        ELSE


'Y'
				    END NCSCLRFLG,
				    ARASHP.ARACOD,
				    ARASHP.MFTPCS MFTPCS,
				    ARASHP.RCVPCS


RCVPCS,
				    MSTMIS.FWDCOD CUSCOD,
				    CASE WHEN EXISTS (SELECT 1 FROM OPRSHPBLKFLT BLK



WHERE BLK.CMPCOD = ARPSHP.CMPCOD
				    AND BLK.DOCOWRIDR = ARPSHP.DOCOWRIDR
				    AND BLK.MSTDOCNUM


= ARPSHP.MSTDOCNUM
				    AND BLK.DUPNUM = ARPSHP.DUPNUM
				    AND BLK.SEQNUM = ARPSHP.SEQNUM



AND BLK.BLKSTA = 'B' ) THEN 'Y' ELSE 'N' END BLKSTA
				   FROM
				    OPRARPSHP ARPSHP,
				    OPRARPARASHP


ARASHP,
				    OPRSHPMSTMIS MSTMIS
				  WHERE
				    ARPSHP.CMPCOD    = ARASHP.CMPCOD(+)
				AND

ARPSHP.DOCOWRIDR
= ARASHP.DOCOWRIDR(+)
				AND ARPSHP.MSTDOCNUM = ARASHP.MSTDOCNUM(+)
				AND ARPSHP.DUPNUM

= ARASHP.DUPNUM(+)

AND ARPSHP.SEQNUM    = ARASHP.SEQNUM(+)
				AND ARPSHP.ARPCOD    = ARASHP.ARPCOD(+)


AND ARPSHP.CMPCOD
= MSTMIS.CMPCOD
				AND ARPSHP.DOCOWRIDR = MSTMIS.DOCOWRIDR
				AND ARPSHP.MSTDOCNUM

= MSTMIS.MSTDOCNUM

AND ARPSHP.DUPNUM    = MSTMIS.DUPNUM
				AND ARPSHP.SEQNUM    = MSTMIS.SEQNUM


				AND ARPSHP.CMPCOD
= ?
				AND ARPSHP.DOCOWRIDR = ?
				AND ARPSHP.MSTDOCNUM = ?
				AND ARPSHP.DUPNUM

= ?
				AND ARPSHP.SEQNUM
= ?
				AND ARPSHP.ARPCOD    = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>365</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findselectdetailsforareasuggestionwithflt" Type="NATIVE">
			<![CDATA[
				  SELECT
					  CASE
					    WHEN ARPSHP.CUSCLRNUM IS NULL
					    THEN 'N'
					    ELSE 'Y'



					  END NCSCLRFLG       ,
					  ARASHP.ARACOD       ,
					  ARASHP.MFTPCS MFTPCS,
					  ARASHP.RCVPCS


RCVPCS,
					  MSTMIS.FWDCOD CUSCOD,
					  FLTDTL.MFTPCS TOTMFTPCS,
					  FLTDTL.RCVPCS TOTRCVPCS,



					  (SELECT FLGFLG
						  FROM OPRARPIMPFLT
						  WHERE CMPCOD  = ?
						  AND FLTCARIDR = ?



						  AND FLTNUM    = ?
						  AND FLTSEQNUM = ?
						  AND ARPCOD = ?
					  )SELENDFLG,


					  FLTDTL.CARCHKENDFLG,

				    CASE WHEN EXISTS (SELECT 1 FROM OPRSHPBLKFLT BLK

WHERE
BLK.CMPCOD = ARPSHP.CMPCOD
				    AND
BLK.DOCOWRIDR = ARPSHP.DOCOWRIDR
				    AND BLK.MSTDOCNUM
=
ARPSHP.MSTDOCNUM
				    AND BLK.DUPNUM
= ARPSHP.DUPNUM
				    AND BLK.SEQNUM = ARPSHP.SEQNUM


				    AND BLK.BLKSTA = 'B' ) THEN 'Y' ELSE 'N'
END BLKSTA
					   FROM OPRARPSHP ARPSHP,
					  OPRARPARASHP

ARASHP   ,
					  OPRSHPMSTMIS MSTMIS
,
					  (SELECT SEGSHP.CMPCOD ,
					    SEGSHP.MSTDOCNUM

,
					    SEGSHP.DOCOWRIDR    ,

					    SEGSHP.DUPNUM       ,
					    SEGSHP.SEQNUM

,
					    CASE
					      WHEN SEGSEL.SELPCS>0

					      THEN SEGSEL.SELPCS


					      ELSE SEGSHP.MFTPCS
					    END MFTPCS             ,
					    SEGSHP.RCVPCS
,

IMPFLT.FLGFLG
SELENDFLG,
					    IMPFLT.CARCHKENDFLG    ,
					    IMPFLT.FLTCARIDR
,

IMPFLT.FLTNUM
,
					    IMPFLT.FLTSEQNUM       ,
					    IMPFLT.LEGSERNUM
,

IMPFLT.ARPCOD

FROM OPRARPIMPFLT IMPFLT,
					    OPRFLTSEG FLTSEG         ,


OPRSEGSHP SEGSHP
,
					    OPRSEGSELSHP SEGSEL
					    WHERE IMPFLT.CMPCOD = FLTSEG.CMPCOD


					  AND IMPFLT.FLTCARIDR
= FLTSEG.FLTCARIDR
					  AND IMPFLT.FLTNUM     = FLTSEG.FLTNUM

AND IMPFLT.FLTSEQNUM
= FLTSEG.FLTSEQNUM

AND IMPFLT.ARPCOD     = FLTSEG.POU
					  AND FLTSEG.CMPCOD
= SEGSHP.CMPCOD

AND FLTSEG.FLTCARIDR
= SEGSHP.FLTCARIDR
					  AND FLTSEG.FLTNUM     = SEGSHP.FLTNUM

AND FLTSEG.FLTSEQNUM
= SEGSHP.FLTSEQNUM

					  AND FLTSEG.SEGSERNUM  = SEGSHP.SEGSERNUM

AND SEGSHP.CMPCOD     = SEGSEL.CMPCOD(+)


					  AND SEGSHP.FLTCARIDR  = SEGSEL.FLTCARIDR(+)

AND SEGSHP.FLTNUM     = SEGSEL.FLTNUM(+)
					  AND

SEGSHP.FLTSEQNUM  = SEGSEL.FLTSEQNUM(+)

AND SEGSHP.SEGSERNUM  = SEGSEL.SEGSERNUM(+)
					  AND

SEGSHP.DOCOWRIDR  = SEGSEL.DOCOWRIDR(+)

AND SEGSHP.MSTDOCNUM  = SEGSEL.MSTDOCNUM(+)
					  AND

SEGSHP.DUPNUM     = SEGSEL.DUPNUM (+)

AND SEGSHP.SEQNUM     = SEGSEL.SEQNUM(+)
					  )FLTDTL


					  WHERE ARPSHP.CMPCOD   = ARASHP.CMPCOD(+)

AND ARPSHP.DOCOWRIDR    = ARASHP.DOCOWRIDR(+)

					AND
ARPSHP.MSTDOCNUM    = ARASHP.MSTDOCNUM(+)

AND ARPSHP.DUPNUM       = ARASHP.DUPNUM(+)
					AND
ARPSHP.SEQNUM
= ARASHP.SEQNUM(+)
					AND
ARPSHP.ARPCOD       = ARASHP.ARPCOD(+)
					AND ARPSHP.CMPCOD
= MSTMIS.CMPCOD

AND ARPSHP.DOCOWRIDR
= MSTMIS.DOCOWRIDR
					AND ARPSHP.MSTDOCNUM    = MSTMIS.MSTDOCNUM

					AND ARPSHP.DUPNUM

= MSTMIS.DUPNUM
					AND ARPSHP.SEQNUM       = MSTMIS.SEQNUM
					AND ARPSHP.CMPCOD
= FLTDTL.CMPCOD(+)


					AND ARPSHP.DOCOWRIDR    = FLTDTL.DOCOWRIDR(+)
					AND ARPSHP.MSTDOCNUM
= FLTDTL.MSTDOCNUM(+)


					AND ARPSHP.DUPNUM       = FLTDTL.DUPNUM(+)
					AND ARPSHP.SEQNUM
= FLTDTL.SEQNUM(+)

AND ARPSHP.ARPCOD
= FLTDTL.ARPCOD(+)
					AND FLTDTL.CMPCOD(+)    = ?

					AND FLTDTL.DOCOWRIDR(+)
= ?
					AND FLTDTL.MSTDOCNUM(+)
= ?
					AND FLTDTL.DUPNUM(+)    = ?
					AND
FLTDTL.SEQNUM (+)
= ?
					AND FLTDTL.ARPCOD(+)    =
?
					AND FLTDTL.FLTCARIDR(+) = ?
					AND FLTDTL.FLTNUM(+)
=
?
					AND FLTDTL.FLTSEQNUM(+) = ?

					AND ARPSHP.CMPCOD       = ?
					AND ARPSHP.DOCOWRIDR

= ?
					AND ARPSHP.MSTDOCNUM    = ?
					AND
ARPSHP.DUPNUM       = ?
					AND ARPSHP.SEQNUM
=
?
					AND ARPSHP.ARPCOD       = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>379</QRY:Id>
		<QRY:Source Name="operations.flthandling.generateSkidId" Type="OBJECT">
			<![CDATA[
			CALL PKG_OPR_SHP.opr_shp_generate_skid_id (
	  ?,
	  ?
	)
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>322</QRY:Id>
		<QRY:Source Name="operations.flthandling.jto.isDeletableCargoCheckConsol" Type="NATIVE">
			<![CDATA[
  	                SELECT
					            MST.CMPCOD,
					            MST.DOCOWRIDR,



					            MST.MSTDOCNUM,
					            MST.DUPNUM,
			            MST.SEQNUM,


					            MST.SHPPFX,

			            IMP.FLTCARIDR,
			            IMP.FLTCARCOD,


			            IMP.FLTNUM,
			            IMP.FLTSEQNUM,

			            IMP.LEGSERNUM,


			            IMP.ARPCOD,
			            IMP.CARCHKENDFLG,
			            COUNT(SKD.SKDIDR)
CNT

FROM

					            OPRSHPMST MST,
			            OPRSHPMST HSE,


OPRSKDDTL SKD,

			            OPRARPIMPFLT IMP
					          WHERE
			            MST.CMPCOD
= SKD.CMPCOD


			        AND MST.DOCOWRIDR = SKD.DOCOWRIDR
			        AND MST.MSTDOCNUM
= SKD.MSTDOCNUM
			        AND MST.DUPNUM

= SKD.DUPNUM
			        AND MST.SEQNUM    = SKD.SEQNUM

AND IMP.CMPCOD    = SKD.CMPCOD


			        AND IMP.FLTCARIDR = SKD.FLTCARIDR
			        AND
IMP.FLTNUM    = SKD.FLTNUM
			        AND
IMP.FLTSEQNUM
= SKD.FLTSEQNUM
			        AND IMP.ARPCOD
= SKD.ARPCOD
			        AND MST.CMPCOD
= HSE.CMPCOD

			        AND MST.DOCOWRIDR = HSE.DOCOWRIDR

AND MST.MSTDOCNUM =
HSE.MSTDOCNUM
			        AND MST.DUPNUM
= HSE.DUPNUM
			        AND MST.SEQNUM
= HSE.PARSEQNUM

			        AND SKD.ARPCOD    = ?

			        AND SKD.CMPCOD
= ?
			        AND SKD.DOCOWRIDR = ?

			        AND SKD.MSTDOCNUM = ?
			        AND
SKD.DUPNUM
= ?
			        AND SKD.SEQNUM    = ?

					       GROUP BY
					            MST.CMPCOD,


					            MST.DOCOWRIDR,

					            MST.MSTDOCNUM,
					            MST.DUPNUM,

MST.SEQNUM,


			            MST.SHPPFX,
			            IMP.FLTCARIDR,

IMP.FLTCARCOD,
			            IMP.FLTNUM,


			            IMP.FLTSEQNUM,

IMP.LEGSERNUM,
			            IMP.ARPCOD,

			            IMP.CARCHKENDFLG


HAVING COUNT(SKD.SKDIDR)>0
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>245</QRY:Id>
		<QRY:Source Name="operations.flthandling.jto.findalluldsinflight" Type="NATIVE">
			<![CDATA[

	  	SELECT
			  OPRULD.ULDNUM
			FROM
			  OPRSEGULD OPRULD
			WHERE
			  OPRULD.CMPCOD     = ?
			AND OPRULD.FLTCARIDR= ?
			AND OPRULD.FLTNUM   = ?
			AND OPRULD.FLTSEQNUM= ?

			UNION ALL

			SELECT
			  MTKULD.ULDNUM
			FROM
			  MALULDSEG MTKULD
			WHERE
			  MTKULD.CMPCOD     = ?
			AND MTKULD.FLTCARIDR= ?
			AND MTKULD.FLTNUM   = ?
			AND MTKULD.FLTSEQNUM= ?



			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>39</QRY:Id>
		<QRY:Source Name="operations.flthandling.jto.finddwsmasterdetails" Type="NATIVE">
			<![CDATA[

	SELECT FLTLEG.CMPCOD ,
		FLTLEG.LEGORG  AS ARPCOD ,
		FLTLEG.FLTCARIDR   ,
		FLTLEG.FLTNUM      ,



		FLTLEG.FLTSEQNUM   ,
		FLTLEG.LEGSERNUM   ,
		MST.PRTDAT      ,
		MST.ESTBLKWGT   ,
		MST.ESTULDWGT


,
		MST.LSTUPDUSR   ,
		MST.LSTUPDTIM   ,
		MST.DWSRMK      ,
		EXPFLT.FLTOPRSTA,
		MST.ESTBLKVOL

,

		EXPFLT.FINFLG

		FROM FLTOPRLEG FLTLEG,
		OPRDWSMST MST          ,
		OPRARPEXPFLT EXPFLT

		WHERE

FLTLEG.CMPCOD=
EXPFLT.CMPCOD(+)
	 AND FLTLEG.FLTCARIDR  =EXPFLT.FLTCARIDR(+)
	 AND FLTLEG.FLTNUM

=EXPFLT.FLTNUM(+)

	 AND FLTLEG.FLTSEQNUM  =EXPFLT.FLTSEQNUM(+)
	 AND FLTLEG.LEGSERNUM  = EXPFLT.LEGSERNUM(+)



	 AND EXPFLT.CMPCOD
=MST.CMPCOD(+)
	 AND EXPFLT.ARPCOD     =MST.ARPCOD(+)
	 AND EXPFLT.FLTCARIDR

=MST.FLTCARIDR(+)
	 AND
EXPFLT.FLTNUM     =MST.FLTNUM(+)
	 AND EXPFLT.FLTSEQNUM  =MST.FLTSEQNUM(+)


	 AND EXPFLT.LEGSERNUM  =MST.LEGSERNUM(+)


	 AND FLTLEG.LEGSERNUM  = ?
	 AND FLTLEG.CMPCOD     =
?

	AND FLTLEG.LEGORG      = ?
	AND FLTLEG.FLTCARIDR
= ?
	 AND FLTLEG.FLTSEQNUM  = ?
	AND FLTLEG.FLTNUM     = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>268</QRY:Id>
		<QRY:Source Name="operations.flthandling.findAwbUldDetails.ImportUldListing" Type="NATIVE">
			<![CDATA[
	     SELECT SEGULD.FLTNUM,
	      SEGULD.FLTSEQNUM,
	      SEGULD.FLTCARIDR,
	      SEGULD.SEGSERNUM,



	      SEGULD.ULDNUM,
	      SEGULD.RMK,
	      SEGULD.CMPCOD,
	      IMPFLT.NACCARCOD,
	      IMPFLT.NACFLTNUM,



	      SELULD.BDNCMPFLG,
	      SEGULD.RCVFLG,
	      SELULD.INTFLG,
	      SELULD.ULDSTA,
	      SELULD.SELRMK,



		  SELULD.TACMID,
		  ULDRTG.RTGFLTNUM,
		      ULDRTG.RTGFLTDAT,
		      ULDRTG.RTGCARCOD  ,


		   DENSE_RANK()
OVER ( ORDER BY SEGULD.CMPCOD,SEGULD.SEGSERNUM,SEGULD.ULDNUM ) RANK
	  FROM OPRSEGULD
SEGULD,

		OPRSEGULDRTG
ULDRTG,
	      OPRSEGSELULD SELULD,
	      OPRFLTSEG FLTSEG,
	      OPRARPIMPFLT
IMPFLT

	      WHERE
SEGULD.FLTNUM = ULDRTG.FLTNUM(+)
		 AND SEGULD.FLTCARIDR = ULDRTG.FLTCARIDR(+)

AND SEGULD.FLTSEQNUM

= ULDRTG.FLTSEQNUM(+)
		 AND SEGULD.SEGSERNUM = ULDRTG.SEGSERNUM(+)
		 AND SEGULD.ULDNUM
= ULDRTG.ULDNUM(+)


		 AND SEGULD.CMPCOD = ULDRTG.CMPCOD(+)
		 AND SEGULD.FLTNUM = SELULD.FLTNUM(+)

AND SEGULD.FLTCARIDR

= SELULD.FLTCARIDR(+)
	     AND SEGULD.FLTSEQNUM = SELULD.FLTSEQNUM(+)
	     AND
SEGULD.SEGSERNUM =
SELULD.SEGSERNUM(+)

AND SEGULD.ULDNUM = SELULD.ULDNUM(+)
	     AND SEGULD.CMPCOD
= SELULD.CMPCOD(+)

	     AND SEGULD.FLTNUM
= FLTSEG.FLTNUM
	     AND SEGULD.FLTCARIDR = FLTSEG.FLTCARIDR

AND SEGULD.FLTSEQNUM
= FLTSEG.FLTSEQNUM

AND SEGULD.SEGSERNUM = FLTSEG.SEGSERNUM
	     AND SEGULD.CMPCOD
= FLTSEG.CMPCOD

	     AND FLTSEG.POU
= IMPFLT.ARPCOD
	     AND SEGULD.FLTNUM = IMPFLT.FLTNUM

AND SEGULD.FLTCARIDR =
IMPFLT.FLTCARIDR

	     AND SEGULD.FLTSEQNUM = IMPFLT.FLTSEQNUM
		 AND
ULDRTG.SERNUM(+) = 1

	     AND IMPFLT.FLTCARIDR = ?

	     AND IMPFLT.FLTNUM = ?
	     AND
IMPFLT.FLTSEQNUM = ?
	     AND IMPFLT.ARPCOD = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>319</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findmawbdetailsforULDBuildup" Type="NATIVE">
			<![CDATA[
		 	SELECT MST.CMPCOD        ,
			 /*
			  This query fetches all the loadplan rows of the AWB.



			  It should be possible to buildup the AWB to a different group,
			  provided the new group has

the same
POU as the original
			  group of the AWB.
			  */
			  MST.MSTDOCNUM           ,
			  MST.DOCOWRIDR


,
			  MST.SEQNUM              ,
			  MST.DUPNUM              ,
			  MST.CONFLG              ,


			  ARPSHP.MSTAWBCHKFLG
,
			  MAX( MST.STDPCS ) STDPCS,
			  MAX( MST.STDWGT ) STDWGT,
			  SUM(PLN.PLNPCS

) PLNPCS ,
			  SEGDST
,
			  SEGDST POU ,
			  MST.DOCNUM              ,
			  MST.SCCCOD

MSTSCCCOD    ,
			  /*
			  This query
needs to fetch the planned pcs of the AWB as well.
			  So if

the AWB has multiple groups, all the groups
are fetched,
			  but then only the planned pieces of the

group which is
			  being builtup have to be
fetched.
			  This is why the CASE condition is used.


			  */
			  SUM(
			  CASE
			    WHEN PLN.POSNUM
IN ( ? )
			    THEN PLN.RELPCS
			    ELSE 0

END
) LDPPCS,
			    /*
			    The BDPPCs will repeat
for al the rows.
			    Since only one of the
rows
are requed.
			    This pieces itself is the sum of
all the ulds
			  */
			  MAX(ULDSHP2.BDPPCS)
MFTPCS

			   FROM OPRSHPMST MST
			LEFT OUTER JOIN OPRLODPLNSHP
PLN
			     ON ( MST.CMPCOD =
PLN.CMPCOD
			AND MST.MSTDOCNUM
= PLN.MSTDOCNUM
			AND MST.DOCOWRIDR
= PLN.DOCOWNIDR
			AND MST.DUPNUM
= PLN.DUPNUM
			AND
MST.SEQNUM       = PLN.SEQNUM
			AND PLN.FLTCARIDR
= ?
			AND PLN.FLTNUM
= ?
			AND PLN.FLTSEQNUM
= ?
			AND PLN.SEGORG       = ? )
			INNER JOIN
OPRARPSHP ARPSHP

ON ( MST.CMPCOD = ARPSHP.CMPCOD

			AND MST.MSTDOCNUM    = ARPSHP.MSTDOCNUM

			AND MST.DOCOWRIDR
= ARPSHP.DOCOWRIDR
			AND MST.DUPNUM
= ARPSHP.DUPNUM
			AND MST.SEQNUM
= ARPSHP.SEQNUM

AND ARPSHP.ARPCOD    = ? )
			LEFT OUTER
JOIN
			/*
			This is for summing up the
pieces of the ulds
of the
			specified group
			*/
			(SELECT
SUM(ULDSHP.BDPPCS) BDPPCS,ULDSHP.CMPCOD,

			ULDSHP.MSTDOCNUM,

ULDSHP.SEQNUM,
			ULDSHP.DOCOWRIDR,

			ULDSHP.DUPNUM,
			ULDSHP.FLTNUM,
			ULDSHP.FLTSEQNUM,


ULDSHP.FLTCARIDR,
			ULDSHP.SEGSERNUM

			 FROM OPRSEGULDSHP ULDSHP
			INNER JOIN OPRSEGULD SEGULD


			     ON ULDSHP.CMPCOD       = SEGULD.CMPCOD

			AND ULDSHP.FLTNUM           = SEGULD.FLTNUM

AND ULDSHP.FLTSEQNUM
= SEGULD.FLTSEQNUM
			AND
ULDSHP.FLTCARIDR        = SEGULD.FLTCARIDR

AND ULDSHP.SEGSERNUM        =
SEGULD.SEGSERNUM
			AND
ULDSHP.ULDNUM           =SEGULD.ULDNUM
			AND
NVL(SEGULD.GRPIDR,?) = ?
			GROUP
BY ULDSHP.CMPCOD,

			ULDSHP.MSTDOCNUM,
			ULDSHP.SEQNUM,
			ULDSHP.DOCOWRIDR,

ULDSHP.DUPNUM,
			ULDSHP.FLTNUM,

			ULDSHP.FLTSEQNUM,

			ULDSHP.FLTCARIDR,
			ULDSHP.SEGSERNUM

) ULDSHP2

			     ON PLN.CMPCOD = ULDSHP2.CMPCOD

			AND
PLN.MSTDOCNUM  = ULDSHP2.MSTDOCNUM
			AND
PLN.SEQNUM     = ULDSHP2.SEQNUM
			AND PLN.DOCOWNIDR  =
ULDSHP2.DOCOWRIDR

			AND PLN.DUPNUM
= ULDSHP2.DUPNUM
			AND PLN.FLTNUM     = ULDSHP2.FLTNUM
			AND
PLN.FLTSEQNUM  = ULDSHP2.FLTSEQNUM


			AND PLN.FLTCARIDR  = ULDSHP2.FLTCARIDR
			AND PLN.SEGSERNUM  =
ULDSHP2.SEGSERNUM

			  WHERE MST.CMPCOD

= ?
			AND MST.MSTDOCNUM           = ?
			AND MST.DOCOWRIDR
= ?
			AND MST.DUPNUM

= ?
			AND MST.SEQNUM              = ?
			GROUP BY MST.CMPCOD  ,

			  MST.MSTDOCNUM      ,


			  MST.DOCOWRIDR      ,
			  MST.SEQNUM         ,
			  MST.DUPNUM         ,

			  MST.DOCNUM

,
			  MST.CONFLG         ,
			  ARPSHP.MSTAWBCHKFLG,
			  SEGDST             ,
			  MST.SCCCOD




			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>347</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findallhawbdetailsforULDBuildup" Type="NATIVE">
			<![CDATA[
				 SELECT CMPCOD     ,
							  MSTDOCNUM        ,
							  DOCOWRIDR        ,
							  SEQNUM


,
							  DUPNUM           ,
							  SCCCOD           ,
							  DOCNUM           ,
							  MSTSCCCOD


MSTSCCCOD ,
							  STDPCS           ,
							  STDWGT           ,
							  SUM(
							  CASE



								WHEN TXNCOD='MFT'
								AND INDEX1 =1
								THEN PCS
								ELSE 0
							  END
)MFTPCS
,

							  SUM(
							  CASE
								WHEN TXNCOD='REL'
								AND INDEX1 =1

THEN
PCS
								ELSE 0

							  END )LDPPCS
							   FROM
							  (SELECT MST.CMPCOD
,

								MST.MSTDOCNUM        ,
								MST.DOCOWRIDR
,
								MST.SEQNUM
,
								MST.DUPNUM
,
								MST.SCCCOD MSTSCCCOD ,

STDPCS               ,

STDWGT               ,

								MST.DOCNUM           ,
								HSE.TXNCOD
,

HSE.PCS              ,
												ROW_NUMBER()
OVER ( PARTITION BY HSE.CMPCOD, HSE.MSTDOCNUM
, HSE.DOCOWRIDR
, HSE.SEQNUM , HSE.DUPNUM ,HSE.TXNCOD
,MST.SCCCOD, HSE.TXNREFONE,HSE.TXNREFTWO,HSE.TXNREFTHR,HSE.TXNREFFOR

ORDER BY MST.DOCNUM ) INDEX1

								 FROM OPRSHPMST MST
							  LEFT OUTER JOIN OPRTXNHSE
HSE

ON( MST.CMPCOD   = HSE.CMPCOD

							  AND MST.MSTDOCNUM     = HSE.MSTDOCNUM

AND MST.DOCOWRIDR
= HSE.DOCOWRIDR
							  AND MST.DUPNUM
= HSE.DUPNUM
							  AND MST.SEQNUM
= HSE.SEQNUM

AND HSE.ARPCOD        = ?

							  AND HSE.TXNREFTWO     = ?

AND HSE.TXNREFTHR     = ?

AND HSE.TXNREFFIV     = ?

							  AND ( ( HSE.TXNREFSIX
= ?
							  AND HSE.TXNCOD        = 'REL')

											  OR (HSE.TXNCOD
= 'MFT'

AND EXISTS (SELECT 1 FROM
												OPRSEGULD SEGULD



WHERE HSE.CMPCOD = SEGULD.CMPCOD
											  AND HSE.TXNREFTWO  = SEGULD.FLTCARIDR
											  AND


HSE.TXNREFTHR  = SEGULD.FLTNUM
											  AND HSE.TXNREFFIV  = SEGULD.FLTSEQNUM
											  AND
HSE.TXNREFSIX

= SEGULD.ULDNUM
											  AND HSE.TXNCOD     = 'MFT'
											  AND SEGULD.GRPIDR
= ?))))


								WHERE MST.CMPCOD = ?
							  AND MST.MSTDOCNUM  = ?
							  AND MST.DOCOWRIDR
= ?

							  AND MST.DUPNUM
= ?
							  AND MST.PARSEQNUM  =1
							  )
							GROUP
BY CMPCOD,
							  MSTDOCNUM
,

DOCOWRIDR    ,
							  SEQNUM       ,
							  DUPNUM
,
							  DOCNUM       ,

							  SCCCOD
,
							  STDWGT       ,
							  STDPCS
,
							  MSTSCCCOD
			ORDER BY DOCNUM

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>305</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findhawbdetailsforULDBuildup" Type="NATIVE">
			<![CDATA[
	                 SELECT CMPCOD      ,
			 			 					  MSTDOCNUM         ,
			 			 					  DOCOWRIDR


,
			 			 					  SEQNUM            ,
			 			 					  DUPNUM            ,
			 			 					  SCCCOD


,
			 			 					  DOCNUM            ,
			 			 					  MSTSCCCOD MSTSCCCOD  ,
			 			 					  MAX(STDPCS)


STDPCS,
			 			 					  MAX(STDWGT) STDWGT,
			 			 			 					  /*
			 											    This is the summ


of available
			 											    HAWB pieces,since The SMY table will caontain
			   												only


live information*/
			 			 					  SUM(
			 			 					  CASE
			 			 						WHEN (HSESMYTXNCOD IN ('ACP','SMU')



			 			 						AND INDEX1          =1)
			 			 						THEN HSESMYPCS
			 			 						ELSE 0


			 			 					  END )ACPPCS,

			 											  /*
			 											  This is the lp info.
stored in TXNHSE
only*/
			 			 					  SUM(
			 			 					  CASE

			 			 						WHEN (HSETXNCOD
= 'REL'

			 			 						AND INDEX2      =1)
			 			 						THEN HSEPCS
			 			 						ELSE

0
			 			 					  END )LDPPCS,

			 			 			 					  /*
			 											    The already
buildup pieces are
taken in MFT.
			 											    Already buildup
pieces are taken for a particular


			 											    group, so MFT pieces of all
the ULDs buildup
			 											    with this group
are taken

			   											*/

			 			 					  SUM(
			 			 					  CASE

WHEN (HSETXNCOD = 'MFT'
			 			 						AND INDEX2
=1)

			 			 						THEN HSEPCS

ELSE 0
			 			 					  END )MFTPCS
			 			 					   FROM

(SELECT
MST.CMPCOD


,
			 			 						MST.MSTDOCNUM


,
			 			 						MST.DOCOWRIDR


,
			 			 						MST.SEQNUM


,
			 			 						MST.DUPNUM


,
			 			 						MST.DOCNUM


,
			 			 						MST.SCCCOD MSTSCCCOD


,
			 			 						HSESMY.TXNCOD HSESMYTXNCOD


,
			 			 						HSE.TXNCOD HSETXNCOD


,
			 			 						STDPCS


,
			 			 						STDWGT


,
			 			 						HSESMY.PCS HSESMYPCS


,
			 			 						HSE.PCS HSEPCS


,
			 			 			 						ROW_NUMBER() OVER ( PARTITION BY MST.CMPCOD, MST.MSTDOCNUM , MST.DOCOWRIDR , MST.SEQNUM


, MST.DUPNUM , MST.DOCNUM , SCC.SCCCOD , MST.SCCCOD,HSESMY.TXNCOD,HSESMY.TXNREFONE,HSESMY.TXNREFTWO,HSESMY.TXNREFTHR,HSESMY.TXNREFFOR


ORDER BY MST.DOCNUM ) INDEX1,
			 			 			 						ROW_NUMBER() OVER ( PARTITION BY MST.CMPCOD, MST.MSTDOCNUM


, MST.DOCOWRIDR , MST.SEQNUM , MST.DUPNUM , MST.DOCNUM , SCC.SCCCOD , MST.SCCCOD,HSE.TXNCOD, HSE.TXNREFONE,HSE.TXNREFTWO,HSE.TXNREFTHR,HSE.TXNREFFOR


ORDER BY MST.DOCNUM ) INDEX2
			 			 						 FROM OPRSHPMST MST
			 			 					  LEFT OUTER JOIN OPRTXNHSE


HSE
			 			 						   ON( MST.CMPCOD   = HSE.CMPCOD
			 			 					  AND MST.MSTDOCNUM     = HSE.MSTDOCNUM



AND MST.DOCOWRIDR     = HSE.DOCOWRIDR
			 			 					  AND MST.DUPNUM        = HSE.DUPNUM



AND MST.SEQNUM        = HSE.SEQNUM
			 			 					  AND HSE.ARPCOD        = ?
			 			 					  AND HSE.TXNREFTWO


= ?
			 			 					  AND HSE.TXNREFTHR     = ?
			 			 					  AND HSE.TXNREFFIV     = ?



			 			 					  AND ( ( HSE.TXNREFSIX = ?
			 			 					  AND HSE.TXNCOD        = 'REL')


			 			 			 					  OR

			 			 			 					  /* MFT is taken only from ULDs

buildup to
the same group*/
			 												 (HSE.TXNCOD
= 'MFT' AND EXISTS

(SELECT 1 FROM
OPRSEGULD SEGULD
			 												       WHERE HSE.CMPCOD
= SEGULD.CMPCOD

AND HSE.TXNREFTWO
= SEGULD.FLTCARIDR
			 												AND HSE.TXNREFTHR
= SEGULD.FLTNUM

AND HSE.TXNREFFIV
= SEGULD.FLTSEQNUM
			 												AND HSE.TXNREFSIX
= SEGULD.ULDNUM

AND HSE.TXNCOD
= 'MFT'
			 												AND SEGULD.GRPIDR    =?))
))
			 			 					  INNER JOIN
OPRTXNHSESMY HSESMY

			 			 						   ON ( MST.CMPCOD        = HSESMY.CMPCOD


			 			 					  AND MST.MSTDOCNUM           = HSESMY.MSTDOCNUM

			 			 					  AND MST.DOCOWRIDR
= HSESMY.DOCOWRIDR

			 			 					  AND MST.DUPNUM
= HSESMY.DUPNUM

AND MST.SEQNUM              = HSESMY.SEQNUM


			 			 					  AND HSESMY.ARPCOD
= ?
			 			 					  AND HSESMY.TXNCOD          IN ('ACP','SMU')


			 			 					  AND NVL(HSESMY.TXNREFFOR,?)
=?)
			 			 						WHERE MST.CMPCOD    = ?

			 			 					  AND MST.MSTDOCNUM
= ?

AND MST.DOCOWRIDR     = ?
			 			 					  AND MST.DUPNUM
= ?

AND MST.PARSEQNUM
=1
			 			 					  )
			 			 					GROUP BY CMPCOD,

MSTDOCNUM    ,

DOCOWRIDR
,
			 			 					  SEQNUM       ,
			 			 					  DUPNUM
,
			 			 					  DOCNUM
,

SCCCOD   ,
			 			 					  MSTSCCCOD
			 					  order by docnum

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>270</QRY:Id>
		<QRY:Source Name="operations.flthandling.findmastercheckdetails" Type="NATIVE">
			<![CDATA[
		 SELECT  DENSE_RANK() OVER ( ORDER BY FLTSEG.CMPCOD,
			      SEGSHP.MSTDOCNUM,
			      SEGSHP.DOCOWRIDR,



			      SEGSHP.DUPNUM,
			      SEGSHP.SEQNUM,
			      SEGSHP.SEGSERNUM ,
			      SEGSHP.DOCOWRIDR)

RANK,

		     SEGSHP.DOCOWRIDR,
		     SEGSHP.SEGSERNUM,
		     FLTSEG.FLTNUM,
		   FLTSEG.FLTCARIDR,


		     FLTSEG.FLTSEQNUM,

		     FLTSEG.CMPCOD,
		     SEGSHP.MSTDOCNUM,
		     SEGSHP.DOCOWRIDR,


		     SEGSHP.DUPNUM,
		     SEGSHP.SEQNUM,

		     SEGSHP.RCVPCS,
		     SELSHP.SELPCS,

SEGSHP.MFTPCS,

		     SELSHP.PKGSTA,
		     SELSHP.URGRMK
RMK,
		     SELSHP.UGTCOD,

SHPMST.CONFLG,
		     IMPFLT.FLTDAT,

		     FLTSEG.POL FLTSEGPOL,

		     FLTSEG.POU FLTSEGPOU

FROM OPRSEGSHP SEGSHP,
		     OPRFLTSEG
FLTSEG,
		     OPRSHPMST SHPMST,

		     OPRSEGSELSHP
SELSHP,
		     OPRARPIMPFLT IMPFLT
		 WHERE
SEGSHP.FLTCARIDR = FLTSEG.FLTCARIDR
		    AND
SEGSHP.FLTNUM
= FLTSEG.FLTNUM
		    AND SEGSHP.FLTSEQNUM
= FLTSEG.FLTSEQNUM
		    AND SEGSHP.SEGSERNUM
= FLTSEG.SEGSERNUM

AND SEGSHP.CMPCOD = FLTSEG.CMPCOD

AND SEGSHP.DOCOWRIDR = SHPMST.DOCOWRIDR

AND SEGSHP.MSTDOCNUM
= SHPMST.MSTDOCNUM
		    AND SEGSHP.DUPNUM
= SHPMST.DUPNUM
		    AND SEGSHP.SEQNUM
= SHPMST.SEQNUM

AND SEGSHP.CMPCOD = SHPMST.CMPCOD

AND SEGSHP.FLTCARIDR = SELSHP.FLTCARIDR

AND SEGSHP.FLTNUM
= SELSHP.FLTNUM
		    AND SEGSHP.FLTSEQNUM
= SELSHP.FLTSEQNUM
		    AND SEGSHP.SEGSERNUM
= SELSHP.SEGSERNUM

AND SEGSHP.CMPCOD = SELSHP.CMPCOD

AND SEGSHP.DOCOWRIDR = SELSHP.DOCOWRIDR

AND SEGSHP.MSTDOCNUM
= SELSHP.MSTDOCNUM
		    AND SEGSHP.DUPNUM
= SELSHP.DUPNUM
		    AND SEGSHP.SEQNUM
= SELSHP.SEQNUM

AND SEGSHP.FLTNUM = IMPFLT.FLTNUM

		    AND SEGSHP.FLTSEQNUM = IMPFLT.FLTSEQNUM

		    AND
SEGSHP.CMPCOD = IMPFLT.CMPCOD
		    AND SEGSHP.FLTCARIDR
= IMPFLT.FLTCARIDR
		    AND FLTSEG.POU
=
IMPFLT.ARPCOD
	       AND SHPMST.SEQNUM = 1
		  AND IMPFLT.CMPCOD
= ?
		  AND IMPFLT.FLTCARIDR = ?


		  AND IMPFLT.FLTNUM = ?
		  AND IMPFLT.FLTSEQNUM = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>271</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findhhthousemanifestdetails" Type="NATIVE">
			<![CDATA[

      SELECT    DENSE_RANK() OVER ( ORDER BY SHPMST.MSTDOCNUM,



                                             SHPMST.DOCOWRIDR,


SHPMST.DUPNUM,



SHPMST.SEQNUM,
                                             SHPMST.CMPCOD,



                                             SEGSHP.SEGSERNUM
) RANK,
                 SHPMST.MSTDOCNUM,

                 SHPMST.DOCNUM,


                 SHPMST.DUPNUM,
                 SHPMST.SEQNUM,

                 SHPMST.CMPCOD,

SHPMST.CONFLG,

                 SEGSHP.RCVPCS,

                 SEGSHP.FLTNUM,

SEGSHP.FLTSEQNUM,
                 SEGSHP.FLTCARIDR,


                 SEGSHP.SEGSERNUM,

SELSHP.SELRMK,
                 SHPMST.DOCOWRIDR,

                 FLTSEG.POL
FLTSEGPOL,

FLTSEG.POU FLTSEGPOU,

                 (CASE

                        WHEN
SELSHP.SELPCS
> 0 THEN
                               SELSHP.SELPCS
                          ELSE
SEGSHP.MFTPCS

END) MFTPCS


    FROM OPRSEGSHP SEGSHP,
       OPRFLTSEG FLTSEG,
       OPRSHPMST
SHPMST,
       OPRSEGSELSHP

SELSHP,
       OPRARPIMPFLT IMPFLT

     WHERE SEGSHP.FLTCARIDR = FLTSEG.FLTCARIDR


AND SEGSHP.FLTNUM
= FLTSEG.FLTNUM
         AND SEGSHP.FLTSEQNUM = FLTSEG.FLTSEQNUM
         AND SEGSHP.SEGSERNUM

= FLTSEG.SEGSERNUM

AND SEGSHP.CMPCOD = FLTSEG.CMPCOD

         AND SEGSHP.DOCOWRIDR = SHPMST.DOCOWRIDR


AND SEGSHP.MSTDOCNUM
= SHPMST.MSTDOCNUM
         AND SEGSHP.DUPNUM = SHPMST.DUPNUM
         AND SEGSHP.SEQNUM

= SHPMST.SEQNUM

AND SEGSHP.CMPCOD = SHPMST.CMPCOD

         AND SEGSHP.FLTCARIDR = SELSHP.FLTCARIDR


AND SEGSHP.FLTNUM
= SELSHP.FLTNUM
         AND SEGSHP.FLTSEQNUM = SELSHP.FLTSEQNUM
         AND SEGSHP.SEGSERNUM

= SELSHP.SEGSERNUM

AND SEGSHP.CMPCOD = SELSHP.CMPCOD
         AND SEGSHP.DOCOWRIDR = SELSHP.DOCOWRIDR


         AND SEGSHP.MSTDOCNUM
= SELSHP.MSTDOCNUM
         AND SEGSHP.DUPNUM = SELSHP.DUPNUM

AND SEGSHP.SEQNUM
= SELSHP.SEQNUM


AND SEGSHP.FLTNUM = IMPFLT.FLTNUM
         AND SEGSHP.FLTSEQNUM
= IMPFLT.FLTSEQNUM

         AND SEGSHP.CMPCOD
= IMPFLT.CMPCOD

         AND FLTSEG.POU = IMPFLT.ARPCOD


AND SHPMST.PARSEQNUM
= ?

AND SHPMST.MSTDOCNUM = ?
         AND SHPMST.DUPNUM = ?

AND SHPMST.DOCOWRIDR =
?
         AND
IMPFLT.CMPCOD = ?
         AND IMPFLT.FLTCARIDR = ?

AND IMPFLT.FLTNUM = ?

         AND IMPFLT.FLTSEQNUM
= ?
         AND IMPFTL.ARPCOD = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>272</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findimportflightsnotclosed" Type="NATIVE">
			<![CDATA[
          SELECT DENSE_RANK ( ) OVER ( ORDER BY MST.FLTCARIDR, ARL.TWOAPHCOD, MST.FLTNUM, MST.FLTDAT,


MST.FLTSEQNUM ) RANK,
  		     MST.FLTCARIDR, ARL.TWOAPHCOD FLTCARCOD,
  		          MST.FLTNUM, LEG.STA


FLTDAT, MST.FLTSEQNUM,
  		          LEG.LEGSERNUM, LEG.ATA, IMP.DOMFLG,
  		          IMP.TRNFLG,
MST.FLTDST,

MST.FLTTYP,
  		          MST.FLTROU, MST.LSTUPDTIM, MST.LSTUPDUSR
  		     FROM FLTOPRLEG
LEG


  		     LEFT OUTER JOIN OPRARPIMPFLT IMP
  		     ON ( LEG.FLTCARIDR=IMP.FLTCARIDR

AND
LEG.FLTSEQNUM=IMP.FLTSEQNUM

  		          AND LEG.LEGSERNUM=IMP.LEGSERNUM


  		          AND LEG.FLTNUM=IMP.FLTNUM
  		          AND LEG.CMPCOD=IMP.CMPCOD
)
  		     JOIN FLTOPRMST
MST

  		     ON ( LEG.FLTCARIDR=MST.FLTCARIDR
  		          AND LEG.FLTSEQNUM=MST.FLTSEQNUM



  		          AND LEG.CMPCOD=MST.CMPCOD
  		          AND LEG.FLTNUM=MST.FLTNUM )

JOIN SHRARLMST ARL


  		     ON ( ARL.CMPCOD=MST.CMPCOD
  		          AND arl.arlidr=mst.fltcaridr
)
  		          AND NVL
( IMP.CARCHKENDFLG
, 'N' )<>'Y'
  		          AND ( NVL ( IMP.BRKDWNFLG, 'N'
)<>'Y'
  		          OR
MST.FLTDST<>LEG.LEGDST
)
  		          AND LEG.ATA IS NOT NULL

AND MST.FLTDAT BETWEEN SYSDATE-7
AND SYSDATE+7

  	             	AND LEG.LEGDST = ?

AND LEG.CMPCOD = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>318</QRY:Id>
		<QRY:Source Name="operations.flthandling.jto.finduniddetailsforshipment" Type="NATIVE">
			<![CDATA[
  		SELECT DGR.DOCOWRIDR,DGR.MSTDOCNUM,DGR.DUPNUM,DGR.SEQNUM,DGR.DGRSEQNUM,DGR.SCCCOD,DGR.CMPCOD,DGR.UNIIDR,DGR.NETQTY,



			DGR.OVRPCKSERNUM,DGR.ALLPCKSERNUM,DGR.PKGTYP,DGR.NUMPKG,DGR.NOOFOVRPACKS,DGR.NOOFALLPACKS,
			DGR.PKGGRP,DGR.PKGINS,


UNDDTL.SHPCLS, DGR.PARSEQNUM,DGR.NETQTYUNT
		FROM OPRSHPDGR DGR, SHRDGRUNDMST UNDMST,SHRDGRUNDGDDDTL


UNDDTL
		WHERE DGR.CMPCOD = UNDMST.CMPCOD AND
			DGR.UNIIDR = UNDMST.UNDNUM AND
			UNDMST.CMPCOD =
UNDDTL.CMPCOD

AND
			UNDMST.UNDNUM = UNDDTL.UNDNUM AND
			UNDDTL.UNDSERNUM = DGR.UNDSERNUM AND

		DGR.CMPCOD
= ? AND


		DGR.MSTDOCNUM = ? AND
		DGR.DUPNUM = ? AND
		DGR.DOCOWRIDR = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>366</QRY:Id>
		<QRY:Source Name="operations.flthandling.jto.findspecialloadinuld" Type="NATIVE">
			<![CDATA[
	        	SELECT FLTCARIDR,
					FLTNUM,
					FLTSEQNUM,
					LEGSERNUM,
					CMPCOD,
					DOCOWRIDR,
					MSTDOCNUM,
					DUPNUM,
					SEQNUM,
					ULDNUM,
					NUMPKG,
					NETQTY,
					SUPINF,
					RMK, LSTUPDTIM,LSTUPDUSR
					FROM OPRNTCSPLLOD SPLLOD
					WHERE SPLLOD.CMPCOD = ?
					AND SPLLOD.ULDNUM = ?
					AND SPLLOD.FLTCARIDR = ?
					AND SPLLOD.FLTNUM = ?
					AND SPLLOD.FLTSEQNUM = ?
					AND SPLLOD.LEGSERNUM = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>323</QRY:Id>
		<QRY:Source Name="operations.flthandling.jto.finddangerousgoods" Type="NATIVE">
			<![CDATA[
  		 SELECT NTC.SERNUM,
			  NTC.CMPCOD      ,
			  NTC.MSTDOCNUM   ,NTC.BDPPCS,
			  NTC.SEQNUM


,
			  NTC.DOCOWRIDR   ,
			  NTC.DUPNUM      ,
			  NTC.UNIIDR      ,
			  NTC.SCCCOD      ,

NTC.ULDNUM

,
			  NTC.FLTNUM      ,
			  NTC.FLTCARIDR   ,
			  NTC.FLTSEQNUM   ,
			  NTC.LEGSERNUM
,
			  NTC.DGRRMK

,
			  NTC.SCCCOD      ,
			  NTC.DGRSERNUM   ,
			  SHP.ERGCOD      ,

SHP.RMC         ,
			  NTC.PKGGRP

,
			  NTC.PKGINS      ,
			  NTC.NUMPKG      ,
			  NTC.NETQTY
,
			  SHP.ALLPCKSERNUM,
			  SHP.OVRPCKSERNUM,


			  SHP.NOOFOVRPACKS,
			  SHP.NOOFALLPACKS

FROM OPRNTCDGR NTC,
			  OPRSHPDGR SHP
			  WHERE
NTC.CMPCOD
= SHP.CMPCOD
			AND NTC.MSTDOCNUM  = SHP.MSTDOCNUM

AND NTC.DUPNUM     = SHP.DUPNUM

			AND (ntc.seqnum
= shp.seqnum
			OR ntc.seqnum = shp.PARSEQNUM
)
			AND NTC.DOCOWRIDR  = SHP.DOCOWRIDR

			AND NTC.UNIIDR
= SHP.UNIIDR
			AND NTC.SCCCOD
= SHP.SCCCOD
					AND NTC.CMPCOD = ?
					  AND
NTC.ULDNUM = ?

					  AND NTC.FLTCARIDR = ?

AND NTC.FLTNUM = ?
					  AND NTC.FLTSEQNUM
= ?
					  AND NTC.LEGSERNUM = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>12</QRY:Id>
		<QRY:Source Name="operations.flthandling.jto.findloadplanulds" Type="NATIVE">
			<![CDATA[

		SELECT ULDSHP.ULDNUM,
			  LODSHP.POSNUM AS SHPPOSNUM,
			  ARPULD.ARPCOD AS	POL,
			  LODSHP.SEGDST


POU,
			  NULL AS ULDRMK,
			  ARPULD.ULDCTR AS ULDCNT,
			  ARPULD.HDLCOD,
			  ARPULD.INTFLG,



			  ARPULD.GRSWGT ULDGRSWGT,
			  ARPULD.NETWGT ULDNETWGT,
			  LODSHP.RELPCS

			FROM OPRLODPLNSHP

LODSHP


			INNER JOIN OPRLODPLNPOL LODPOL ON

			 LODSHP.CMPCOD = LODPOL.CMPCOD
			 AND LODSHP.FLTCARIDR

= LODPOL.FLTCARIDR

			 AND LODSHP.FLTNUM = LODPOL.FLTNUM
			 AND LODSHP.FLTSEQNUM = LODPOL.FLTSEQNUM



			INNER JOIN OPRULDSHP
ULDSHP ON

			 LODSHP.CMPCOD = ULDSHP.CMPCOD
			 AND LODSHP.MSTDOCNUM = ULDSHP.MSTDOCNUM


			 AND LODSHP.DOCOWNIDR
= ULDSHP.DOCOWRIDR
			 AND LODSHP.DUPNUM = ULDSHP.DUPNUM
			 AND LODSHP.SEQNUM

= ULDSHP.SEQNUM

			INNER
JOIN OPRARPULD ARPULD ON

			 ARPULD.CMPCOD = ULDSHP.CMPCOD
			 AND ARPULD.ULDNUM

= ULDSHP.ULDNUM


			WHERE LODSHP.CMPCOD = ?
			 AND LODSHP.FLTCARIDR = ?
			 AND LODSHP.FLTSEQNUM

= ?
			 AND LODSHP.FLTNUM
= ?
			 AND LODSHP.POSNUM = ?
			AND ULDSHP.ARPCOD = ?
			 AND LODSHP.RELPCS

> 0

			ORDER BY POL,

			  POU,
			  ULDNUM

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>251</QRY:Id>
		<QRY:Source Name="operaions.flthandling.findautoarrivalflightdetails" Type="NATIVE">
			<![CDATA[
	 SELECT FLTNUM,CMPCOD,FLTCARIDR,CARCOD
	 		FROM OPRFLTAUTARV
	 		WHERE CMPCOD = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>239</QRY:Id>
		<QRY:Source Name="operations.flthandling.findnextflightdetailsforffmo" Type="NATIVE">
			<![CDATA[
		SELECT   MSTDOCNUM, DUPNUM, SEQNUM, DOCOWRIDR,
			 CMPCOD, FLTNUM, FLTSEQNUM, FLTCARIDR,
			 FLTORG,


FLTDST, FLTCARCOD,
			 CASE
				 WHEN FLTDAT IS NULL
					 THEN SYSDATE
				 ELSE FLTDAT
			 END FLTDAT,



			 CFRPCS, CFRWGT, SEGSERNUM
		    FROM CAPBKGFLTDTL DTL
		   WHERE EXISTS (
				 SELECT 1

FROM
CAPBKGFLTDTL
FLT
				  WHERE DTL.UBRNUM = FLT.UBRNUM
				    AND DTL.CMPCOD = FLT.CMPCOD

AND
FLT.FLTDST =
DTL.FLTORG
				    AND FLT.FLTNUM = ?
				    AND FLT.FLTCARIDR = ?
				    AND FLT.FLTSEQNUM

= ?

				    AND FLT.CMPCOD = ?)
		     AND DTL.CMPCOD = ?
		     AND MSTDOCNUM IS NOT NULL


		ORDER BY DOCOWRIDR,

			 MSTDOCNUM,
			 DUPNUM,
			 SEQNUM,
			FLTBKGSTA DESC
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>360</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findfsutfdctmshipmentdetails" Type="NATIVE">
			<![CDATA[
			   SELECT shpmst.mstdocnum,
			     shpmst.shppfx,
			     shpmst.orgcod,
			     shpmst.dstcod,



			     shpmst.cmpcod,
			     shpmst.seqnum,
			     shpmst.dupnum,
			     shpmst.docowridr,


			     shpmst.stdpcs,

			     shpmst.stdwgt,
			     shpmst.stdwgtcod,
			     mftctmshp.tfrpcs,


			     mftctmshp.tfrwgt,

			     mftctmshp.ctmrefnum
			   FROM

			    oprshpmst shpmst,

oprmftctmshp
mftctmshp,
			     oprmftctm
ctmshp

			   WHERE

			    shpmst.cmpcod = mftctmshp.cmpcod

AND
shpmst.mstdocnum = mftctmshp.mstdocnum

			    AND shpmst.docowridr = mftctmshp.docowridr


			    AND shpmst.seqnum = mftctmshp.seqnum
			    AND shpmst.dupnum
= mftctmshp.dupnum

			    AND
mftctmshp.ctmsernum
= ctmshp.ctmsernum
			    AND mftctmshp.ctmrefnum
= ctmshp.ctmrefnum

			    AND
mftctmshp.trfendflg
= 'Y'
			    AND mftctmshp.ctmrefnum = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>264</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findmasterdetailsofhouse" Type="NATIVE">
			<![CDATA[

	  SELECT   FLTSEG.CMPCOD, FLTSEG.FLTNUM,
		   FLTSEG.FLTCARIDR, FLTSEG.FLTSEQNUM,
		   SEGSHP.DOCOWRIDR,


SEGSHP.MSTDOCNUM,
		   SEGSHP.DUPNUM, SEGSHP.SEQNUM,
       SHPMST.SHPPFX, SEGSHP.SEGSERNUM,


       SELSHP.SELPCS
AWBMFTPCS, SELSHP.SELWGT,
       SELSHP.MSTCNSFLG,SELSHP.JNTCNSFLG,
       SELSHP.PRDCOD,SELSHP.COMCATCOD



	      FROM OPRFLTSEG FLTSEG,
		   OPRSEGSHP SEGSHP,
		   OPRSEGSELSHP SELSHP,
		   OPRSHPMST SHPMST


		   WHERE
FLTSEG.CMPCOD = SEGSHP.CMPCOD
		   AND FLTSEG.FLTNUM = SEGSHP.FLTNUM
		   AND FLTSEG.FLTSEQNUM

= SEGSHP.FLTSEQNUM

AND FLTSEG.FLTCARIDR = SEGSHP.FLTCARIDR
		   AND FLTSEG.SEGSERNUM = SEGSHP.SEGSERNUM


AND SEGSHP.CMPCOD
= SELSHP.CMPCOD(+)
		   AND SEGSHP.FLTNUM = SELSHP.FLTNUM(+)
		   AND SEGSHP.FLTSEQNUM

= SELSHP.FLTSEQNUM(+)

AND SEGSHP.FLTCARIDR = SELSHP.FLTCARIDR(+)
		   AND SEGSHP.SEGSERNUM = SELSHP.SEGSERNUM(+)


		   AND SEGSHP.DOCOWRIDR
= SELSHP.DOCOWRIDR(+)
		   AND SEGSHP.MSTDOCNUM = SELSHP.MSTDOCNUM(+)

AND
SEGSHP.DUPNUM = SELSHP.DUPNUM(+)

AND SEGSHP.SEQNUM = SELSHP.SEQNUM(+)
		   AND SEGSHP.CMPCOD
=
SHPMST.CMPCOD
		   AND SEGSHP.DOCOWRIDR
= SHPMST.DOCOWRIDR
		   AND SEGSHP.MSTDOCNUM = SHPMST.MSTDOCNUM


AND SEGSHP.DUPNUM = SHPMST.DUPNUM

AND SEGSHP.SEQNUM = SHPMST.SEQNUM
		   AND FLTSEG.CMPCOD = ?


AND FLTSEG.FLTSEQNUM = ?
		   AND FLTSEG.FLTCARIDR
= ?
		   AND FLTSEG.FLTNUM = ?
		   AND FLTSEG.POU

= ?
		   AND SHPMST.SEQNUM = ?



			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>263</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findhousedetails" Type="NATIVE">
			<![CDATA[


	SELECT   MST.STDPCS GRSPCS, MST.ORGCOD,
		 MST.DSTCOD, MST.STDDISWGT GRSWGT,
     MST.STDWGTCOD STDWGTCOD,


MST.DOCNUM DOCNUM,
		         MST.SEQNUM, MST.DUPNUM, MST.MSTDOCNUM,MST.SHPPFX,
		 MST.SHPDES, MST.SRCIND,MST.DOCOWRIDR,MST.CMPCOD,



		         INS.MSTDOCNUM HNDINSVAL, INS.SHPURG,
		 (MST.STDPCS - SUM (  ARP.RCVPCS)
		 ) AWBMFTPCS


	    FROM OPRSHPMST
MST,
		 OPRARPSHP ARP,
		 OPRSHPHNDINS INS
	   WHERE MST.MSTDOCNUM = ARP.MSTDOCNUM(+)


	     AND MST.DUPNUM
= ARP.DUPNUM(+)
	     AND MST.SEQNUM = ARP.SEQNUM(+)
	     AND MST.DOCOWRIDR =
ARP.DOCOWRIDR(+)


	     AND MST.MSTDOCNUM = INS.MSTDOCNUM(+)
	     AND MST.DUPNUM = INS.DUPNUM(+)

AND MST.SEQNUM
= INS.SEQNUM(+)

	     AND MST.DOCOWRIDR = INS.DOCOWRIDR(+)
	     AND MST.MSTDOCNUM
= ?
	     AND
MST.DUPNUM = ?
	     AND MST.DOCOWRIDR
= ?
	     AND MST.PARSEQNUM = ?
	     AND ARP.ARPCOD(+)
= ?

	GROUP BY MST.STDPCS,
		 MST.ORGCOD,
		 MST.DSTCOD,

		 MST.STDDISWGT,
		 MST.STDWGTCOD,

MST.DOCNUM,

		 MST.SEQNUM,
		 MST.DUPNUM,
		         MST.SHPPFX,

		 MST.MSTDOCNUM,
		 MST.SHPDES,

MST.SRCIND,

		 INS.MSTDOCNUM,
		 ARP.RCVPCS,
		 MST.DOCOWRIDR,
		 MST.CMPCOD,

		 INS.SHPURG

ORDER BY MST.DOCNUM


			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>238</QRY:Id>
		<QRY:Source Name="operations.flthandling.findfreightforfinalisationmsgs" Type="NATIVE">
			<![CDATA[
		       SELECT ULD.CMPCOD ULDCMPCOD, ULD.FLTCARIDR ULDFLTCARIDR, ULD.FLTNUM ULDFLTNUM,
		       ULD.FLTSEQNUM


ULDFLTSEQNUM, ULD.SEGSERNUM ULDSEGSERNUM, ULD.CONIDR ULDCONIDR,
		       ULD.ULDNUM ULDULDNUM, ULD.ULDDST


ULDULDDST,
		       SHP.MFTPCS SHPPCS, SHP.MFTWGT SHPWGT,
		       SHP.MFTVOL SHPVOL, SHP.FLTCARIDR

SHPFLTCARIDR,
SHP.FLTNUM SHPFLTNUM,
		       ULD.GRSWGT, ULD.NETWGT, ULD.THRUNT, ULD.ULDCTR, ULD.TARWGT,


		       SHP.FLTSEQNUM
SHPFLTSEQNUM, SHP.SEGSERNUM SHPSEGSERNUM,
		       SHP.ULDNUM SHPULDNUM, SHP.DOCOWRIDR

SHPDOCOWRIDR,

SHP.MSTDOCNUM SHPMSTDOCNUM, SHP.DUPNUM SHPDUPNUM, SHP.SEQNUM SHPSEQNUM,


		       SHP.RMK SHPRMK, SHP.CMPCOD
SHPCMPCOD,SEG.CMPCOD SEGCMPCOD,
		       SEG.FLTCARIDR SEGFLTCARIDR,
SEG.FLTNUM
SEGFLTNUM,
		       SEG.FLTSEQNUM
SEGFLTSEQNUM, SEG.POL SEGPOL, SEG.POU SEGPOU,

SEG.SEGSERNUM
SEGSEGSERNUM, MST.SHPPFX , MST.CPTDAT
,MST.AGTCOD,
		       MST.ORGCOD MSTORGCOD , MST.DSTCOD
MSTDSTCOD
, MST.SHPDES MSTSHPDES ,
		       MST.STDPCS,
MST.STDWGT, MST.GRSVOL, MST.STDWGTCOD,MST.CONFLG,
MST.AGTCOD,

		       SEGSHP.MFTPCS SEGSHPMFTPCS, SEGSHP.MFTWGT
SEGSHPMFTWGT,
		       SEGSHP.MFTVOL
SEGSHPMFTVOL, ULD.RMK
ULDRMK,
		       EXPFLT.FINFLG, EXPFLT.FLTCARCOD,
EXPFLT.FLTDAT,
		       SHP.BDPPCS
SHPBDPPCS, SHP.BDPWGT
SHPBDPWGT,
		       SHP.BDPVOL SHPBDPVOL, SEGSHP.BDPPCS
SEGSHPBDPPCS,

SEGSHP.BDPWGT SEGSHPBDPWGT,
SEGSHP.BDPVOL SEGSHPBDPVOL,
		       ULD.MFTFLG ULDMFTFLG,
ULD.ACTWGT ACTWGT,SHPMIS.BKGCRNDAT
BKGDAT,SHPACC.SRVCRGCLS

		  FROM OPRSEGULD ULD,
		       OPRSEGULDSHP
SHP,
		       OPRSEGSHP SEGSHP,

OPRFLTSEG  SEG,

		       OPRARPEXPFLT EXPFLT,
		       OPRSHPMST
MST,
		       OPRSHPMSTMIS
SHPMIS,
			   OPRSHPMSTACC SHPACC

		WHERE EXPFLT.FLTCARIDR = SEG.FLTCARIDR

		   AND EXPFLT.FLTNUM
= SEG.FLTNUM
		   AND EXPFLT.FLTSEQNUM
= SEG.FLTSEQNUM
		   AND EXPFLT.CMPCOD = SEG.CMPCOD


AND EXPFLT.ARPCOD = SEG.POL
		   AND SEG.FLTCARIDR
= ULD.FLTCARIDR(+)
		   AND SEG.FLTNUM = ULD.FLTNUM(+)


		   AND SEG.FLTSEQNUM = ULD.FLTSEQNUM(+)

		   AND SEG.CMPCOD = ULD.CMPCOD(+)
		   AND SEG.SEGSERNUM
= ULD.SEGSERNUM(+)

		   AND ULD.FLTCARIDR
= SHP.FLTCARIDR(+)
		   AND ULD.FLTNUM = SHP.FLTNUM(+)

AND ULD.FLTSEQNUM = SHP.FLTSEQNUM(+)


		   AND ULD.SEGSERNUM = SHP.SEGSERNUM(+)
		   AND ULD.CMPCOD
= SHP.CMPCOD(+)
		   AND ULD.ULDNUM =
SHP.ULDNUM(+)

		   AND SHP.DOCOWRIDR = SEGSHP.DOCOWRIDR(+)

AND SHP.MSTDOCNUM = SEGSHP.MSTDOCNUM(+)

AND SHP.DUPNUM
= SEGSHP.DUPNUM(+)
		   AND SHP.SEQNUM
= SEGSHP.SEQNUM(+)
		   AND SHP.CMPCOD = SEGSHP.CMPCOD(+)


AND SHP.FLTCARIDR = SEGSHP.FLTCARIDR(+)

AND SHP.FLTNUM = SEGSHP.FLTNUM(+)
		   AND SHP.FLTSEQNUM

= SEGSHP.FLTSEQNUM(+)
		   AND SHP.SEGSERNUM
= SEGSHP.SEGSERNUM(+)
		   AND SHP.DOCOWRIDR = MST.DOCOWRIDR(+)


AND SHP.MSTDOCNUM = MST.MSTDOCNUM(+)

AND SHP.DUPNUM = MST.DUPNUM(+)
		   AND SHP.SEQNUM = MST.SEQNUM(+)


		   AND SHP.CMPCOD =
MST.CMPCOD	(+)
		   AND MST.DOCOWRIDR = SHPMIS.DOCOWRIDR(+)
		   AND MST.MSTDOCNUM
=
SHPMIS.MSTDOCNUM(+)

AND MST.DUPNUM = SHPMIS.DUPNUM(+)
		   AND MST.SEQNUM = SHPMIS.SEQNUM(+)


		   AND MST.CMPCOD =
SHPMIS.CMPCOD(+)
		   AND MST.DOCOWRIDR = SHPACC.DOCOWRIDR(+)
		   AND MST.MSTDOCNUM

= SHPACC.MSTDOCNUM(+)

AND MST.DUPNUM = SHPACC.DUPNUM(+)
		   AND MST.SEQNUM = SHPACC.SEQNUM(+)


		   AND MST.CMPCOD =
SHPACC.CMPCOD(+)
		   AND EXPFLT.FLTCARIDR = ?
		   AND EXPFLT.FLTNUM = ?

		   AND EXPFLT.FLTSEQNUM

= ?
		   AND EXPFLT.CMPCOD = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>242</QRY:Id>
		<QRY:Source Name="operations.flthandling.printtransfershipments" Type="NATIVE">
			<![CDATA[
		SELECT
		       BKGMST.UBRNUM, FLTDTL.FLTNUM,
		       FLTDTL.CFRPCS, FLTDTL.CFRWGT,FLTDTL.CFRVOL,



		       FLTDTL.FLTCARIDR, FLTDTL.FLTORG,
		       FLTDTL.FLTDST, FLTDTL.FLTDAT,
		       SHP.MFTPCS

SHPPCS, SHP.MFTWGT
SHPWGT,
		       SHP.MFTVOL SHPVOL,
		       SHP.FLTCARIDR SHPFLTCARIDR,


		       SHP.FLTNUM SHPFLTNUM,
SHP.RCVPCS SHPRCVPCS,
		       SHP.RCVWGT SHPRCVWGT,
		       SHP.FLTSEQNUM
SHPFLTSEQNUM,

		       SHP.CUSREF
SHPCUSREF,
		       SHP.SEGSERNUM SHPSEGSERNUM,

SHP.ULDNUM SHPULDNUM,
		       SHP.DOCOWRIDR

SHPDOCOWRIDR,
		       SHP.MSTDOCNUM SHPMSTDOCNUM,

SHP.DUPNUM SHPDUPNUM, SHP.SEQNUM SHPSEQNUM,


SHP.RMK SHPRMK, SHP.CMPCOD SHPCMPCOD,

MST.CNSNAM MSTCNSNAM, MST.STDWGT,
		       MST.STDPCS,

MST.GRSVOL,
		       MST.SCCCOD MSTSCCCOD, MST.SHPDES
MSTSHPDES,
		       MST.ORGCOD MSTORGCOD, MST.DSTCOD

MSTDSTCOD,
		       MST.STDWGTCOD MSTSTDWGTCOD,

MST.STDDISWGT MSTSTDDISWGT,
		       MST.PRDNAM

MSTPRDNAM, MST.PRDPRT MSTPRDPRT,
		       MST.SHPPFX,
SEG.CMPCOD SEGCMPCOD,
		       SEG.FLTCARIDR SEGFLTCARIDR,


		       SEG.FLTNUM SEGFLTNUM,

SEG.FLTSEQNUM SEGFLTSEQNUM, SEG.POL SEGPOL,
		       SEG.POU
SEGPOU, SEG.SEGSERNUM
SEGSEGSERNUM,

SEGSHP.DOCOWRIDR SEGSHPDOCOWRIDR,
		       SEGSHP.MSTDOCNUM
SEGSHPMSTDOCNUM,

SEGSHP.DUPNUM
SEGSHPDUPNUM,
		       SEGSHP.SEQNUM SEGSHPSEQNUM,

SEGSHP.FLTNUM SEGSHPFLTNUM,

SEGSHP.FLTSEQNUM
SEGSHPFLTSEQNUM,
		       SEGSHP.SEGSERNUM SEGSHPSEGSERNUM,

		       FLTDTL.FLTCARIDR
SEGSHPFLTCARIDR,

SEGSHP.CMPCOD SEGSHPCMPCOD,
		       SEGSHP.MFTPCS SEGSHPMFTPCS,

		       SEGSHP.MFTWGT
SEGSHPMFTWGT,

SEGSHP.MFTVOL SEGSHPMFTVOL,
		       SEGSHP.RCVPCS SEGSHPRCVPCS,

		       SEGSHP.RCVWGT
SEGSHPRCVWGT,

SEGSHP.RCVVOL SEGSHPRCVVOL,
		       SEGSHP.PLNPCS SEGSHPPLNPCS,

		       SEGSHP.PLNWGT
SEGSHPPLNWGT,

SEGSHP.PLNVOL SEGSHPPLNVOL,
		       SEGSHP.ARVRMK SEGSHPARVRMK,

		       SHPDTL.PLTUSEFLG,

MST.PLTFLG,
		       SEGSHP.LSTUPDTIM SHPUPDTIM,
		       ULD.LSTUPDTIM ULDUPDTIM,


RTG.LSTUPDTIM
RTGUPDTIM
		  FROM OPRSEGSHP SEGSHP,
		       OPRSEGULD ULD,
		       OPRSEGULDSHP SHP,


		       OPRSHPMST
MST,
		       OPRFLTSEG SEG,
		       OPRULDTHRRTG RTG,
		       OPRSHPDTL SHPDTL,


		       CAPBKGMST
BKGMST,
		       CAPBKGFLTDTL FLTDTL

		 WHERE  SEGSHP.FLTCARIDR = SEG.FLTCARIDR(+)

AND
SEGSHP.FLTNUM
= SEG.FLTNUM(+)
			AND SEGSHP.FLTSEQNUM = SEG.FLTSEQNUM(+)
			AND SEGSHP.SEGSERNUM
= SEG.SEGSERNUM(+)


AND SEGSHP.CMPCOD = SEG.CMPCOD(+)
			AND SEGSHP.DOCOWRIDR = MST.DOCOWRIDR

AND SEGSHP.MSTDOCNUM =
MST.MSTDOCNUM

AND SEGSHP.DUPNUM = MST.DUPNUM
			AND SEGSHP.SEQNUM = MST.SEQNUM

AND SEGSHP.CMPCOD
= MST.CMPCOD

AND SEGSHP.DOCOWRIDR = SHP.DOCOWRIDR(+)
			AND SEGSHP.MSTDOCNUM =
SHP.MSTDOCNUM(+)

			AND SEGSHP.DUPNUM
= SHP.DUPNUM(+)
			AND SEGSHP.SEQNUM = SHP.SEQNUM(+)
			AND
SEGSHP.FLTCARIDR = SHP.FLTCARIDR(+)

			AND
SEGSHP.FLTNUM = SHP.FLTNUM(+)
			AND SEGSHP.FLTSEQNUM
= SHP.FLTSEQNUM(+)
			AND SEGSHP.SEGSERNUM
= SHP.SEGSERNUM(+)

AND SEGSHP.DOCOWRIDR = SHPDTL.DOCOWRIDR(+)

AND SEGSHP.MSTDOCNUM = SHPDTL.MSTDOCNUM(+)

			AND SEGSHP.DUPNUM
= SHPDTL.DUPNUM(+)
			AND SEGSHP.SEQNUM
= SHPDTL.SEQNUM(+)
			AND SEGSHP.CMPCOD =
SHPDTL.CMPCOD(+)

AND SHP.FLTCARIDR = ULD.FLTCARIDR(+)

AND SHP.FLTNUM = ULD.FLTNUM(+)
			AND SHP.FLTSEQNUM
= ULD.FLTSEQNUM(+)

AND SHP.SEGSERNUM = ULD.SEGSERNUM(+)

AND SHP.ULDNUM = ULD.ULDNUM(+)
			AND
ULD.FLTCARIDR = RTG.FLTCARIDR(+)

AND ULD.FLTNUM = RTG.FLTNUM(+)

AND ULD.FLTSEQNUM = RTG.FLTSEQNUM(+)

AND ULD.SEGSERNUM = RTG.SEGSERNUM(+)

			AND ULD.CMPCOD =
RTG.CMPCOD(+)
			AND ULD.ULDNUM = RTG.ULDNUM(+)

			AND MST.DOCOWRIDR = BKGMST.DOCOWRIDR(+)


AND MST.MSTDOCNUM = BKGMST.MSTDOCNUM(+)
			AND MST.DUPNUM
= BKGMST.DUPNUM(+)
			AND MST.SEQNUM = BKGMST.SEQNUM(+)


			AND MST.CMPCOD = BKGMST.CMPCOD(+)
			AND
BKGMST.UBRNUM = FLTDTL.UBRNUM(+)
			AND BKGMST.CMPCOD =
FLTDTL.CMPCOD(+)

			AND SEGSHP.FLTCARIDR
= ?
			AND SEGSHP.FLTNUM = ?
			AND SEGSHP.FLTSEQNUM =
?
			AND SEGSHP.CMPCOD =
?
			AND SEG.POU = ?

			AND (   NVL (   FLTDTL.FLTORG, ?) = ?
			OR MST.DSTCOD = ? )

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>244</QRY:Id>
		<QRY:Source Name="operaions.flthandling.finduldarrivalreportdetails" Type="NATIVE">
			<![CDATA[
		SELECT  ULD.CMPCOD ULDCMPCOD,ULD.ACTWGT, ULD.FLTCARIDR ULDFLTCARIDR, ULD.CONIDR ULDCONIDR,
			ULD.FLTNUM


ULDFLTNUM, ULD.FLTSEQNUM ULDFLTSEQNUM,
			ULD.SEGSERNUM ULDSEGSERNUM, ULD.ULDOCP ULDULDOCP,
			ULD.ULDDST


ULDULDDST, ULD.ULDNUM ULDULDNUM, ULD.GRSWGT, ULD.NETWGT,
			ULD.THRUNT, ULD.ULDCTR, ULD.TARWGT, SHP.CUSREF


SHPCUSREF,
			SHP.MFTPCS SHPPCS, SHP.MFTWGT SHPWGT, SHP.MFTVOL SHPVOL,
			SHP.FLTCARIDR SHPFLTCARIDR,


SHP.FLTNUM SHPFLTNUM,
			SHP.FLTSEQNUM SHPFLTSEQNUM, SHP.SEGSERNUM SHPSEGSERNUM,
			SHP.ULDNUM SHPULDNUM,


SHP.DOCOWRIDR SHPDOCOWRIDR,
			SHP.MSTDOCNUM SHPMSTDOCNUM, SHP.DUPNUM SHPDUPNUM,
			SHP.SEQNUM SHPSEQNUM,


SHP.RMK SHPRMK, SHP.CMPCOD SHPCMPCOD,
			SHP.LODPRT, MST.SCCCOD MSTSCCCOD, SHP.RCVPCS SHPRCVPCS,


			SHP.RCVWGT
SHPRCVWGT, SHP.RCVVOL SHPRCVVOL, MST.SHPDES MSTSHPDES,
			MST.ORGCOD MSTORGCOD, MST.DSTCOD

MSTDSTCOD,
MST.AGTCOD, AGTCOD,
			MST.STDWGTCOD MSTSTDWGTCOD, MST.STDDISWGT MSTSTDDISWGT, MST.CONFLG,


			MST.DTACPTFLG,
MST.PRDNAM MSTPRDNAM, MST.PRDPRT MSTPRDPRT,
			MST.SHPPFX, MST.STDPCS, MST.OWRCOD
MSTOWRCOD,
MST.STDWGT,
MST.GRSVOL,
			SEG.CMPCOD SEGCMPCOD, SEG.FLTCARIDR SEGFLTCARIDR,
			SEG.FLTNUM
SEGFLTNUM,
SEG.FLTSEQNUM
SEGFLTSEQNUM, SEG.POL SEGPOL,
			SEG.POU SEGPOU, SEG.SEGSERNUM SEGSEGSERNUM,
SEGSHP.PLNVOL,

SEGSHP.MFTPCS
SEGSHPMFTPCS, SEGSHP.MFTWGT SEGSHPMFTWGT,
			SEGSHP.MFTVOL SEGSHPMFTVOL,
ARPSHP.DOCRCVFLG,

SEGSHP.RCVPCS
SEGSHPRCVPCS, SEGSHP.RCVWGT SEGSHPRCVWGT,
			TRU.SERNUM TRUSERNUM,
TRU.SEGSERNUM TRUSEGSERNUM,

TRU.FLTSEQNUM
TRUFLTSEQNUM, TRU.FLTNUM TRUFLTNUM,
			TRU.FLTCARIDR TRUFLTCARIDR,
TRU.CMPCOD TRUCMPCOD,

TRU.ULDNUM
TRUULDNUM, TRU.THRCARIDR TRUTHRCARIDR,
			TRU.THRCARCOD TRUTHRCARCOD,
TRU.THRFLTNUM TRUTHRFLTNUM,


TRU.THRFLTDAT TRUTHRFLTDAT, TRU.THRDSTCOD TRUTHRDSTCOD,
			ARPSHP.CUSCLRREQFLG,ARPSHP.SECCLRREQFLG,ARPSHP.EXPFLG


ARPSHPEXPFLG,
			ULD.LSTUPDTIM ULDLSTUPDTIM, ULD.LSTUPDUSR ULDLSTUPDUSR,
			SEGSHP.LSTUPDTIM SEGSHPLSTUPDTIM,


SEGSHP.LSTUPDUSR SEGSHPLSTUPDUSR,
			ARPSHP.LSTUPDTIM ARPSHPLSTUPDTIM, ARPSHP.LSTUPDUSR ARPSHPLSTUPDUSR,



			TRU.LSTUPDTIM TRULSTUPDTIM, TRU.LSTUPDUSR TRULSTUPDUSR,
			MIS.FRMCOD,MIS.AGTUNQIDR,MST.SLCPCS,
			(SELECT RTRIM ( XMLAGG ( XMLELEMENT ( A, (
    CASE
      WHEN MST.DSTCOD=SEG.POU
      THEN
        (SELECT TO_CHAR(QMSPLN.MILSTNTIM,'dd-MON-YYYY/HH24:MI')
        FROM QMSSHPMILSTNPLN QMSPLN
        WHERE MST.CMPCOD     = QMSPLN.CMPCOD
        AND MST.DOCOWRIDR    = QMSPLN.DOCOWRIDR
        AND MST.MSTDOCNUM    = QMSPLN.MSTDOCNUM
        AND MST.DUPNUM       = QMSPLN.DUPNUM
        AND MST.SEQNUM       = QMSPLN.SEQNUM
        AND SEG.FLTCARIDR    = QMSPLN.FLTCARIDR
        AND SEG.FLTNUM       = QMSPLN.FLTNUM
        AND SEG.FLTSEQNUM    = QMSPLN.FLTSEQNUM
        AND QMSPLN.PLNTYP    = 'TR'
        AND QMSPLN.MILSTNCOD ='NFD'
        AND QMSPLN.VERNUM    =
          (SELECT MAX(VERNUM)
          FROM QMSSHPMILSTNPLN
          WHERE CMPCOD  = QMSPLN.CMPCOD
          AND DOCOWRIDR = QMSPLN.DOCOWRIDR
          AND MSTDOCNUM = QMSPLN.MSTDOCNUM
          AND DUPNUM    = QMSPLN.DUPNUM
          AND SEQNUM    = QMSPLN.SEQNUM
          AND FLTCARIDR = QMSPLN.FLTCARIDR
          AND FLTNUM    = QMSPLN.FLTNUM
          AND FLTSEQNUM = QMSPLN.FLTSEQNUM
          AND PLNTYP    = 'TR'
          AND MILSTNCOD ='NFD'
		  and SEG.POL          = BKGFLT.FLTORG
          )
        )
      ELSE
        (SELECT RTRIM(XMLAGG(XMLELEMENT(A, (
          CASE
            WHEN (BKGFLT.FLTCARCOD IS NOT NULL
            AND BKGFLT.FLTBKGSTA    ='C'
            AND (ISSPRTARL          ='Y'
            OR ARPPAR.PARVAL        = 'Y'))
            THEN BKGFLT.FLTCARCOD
              ||BKGFLT.FLTNUM
              ||' '
              ||TO_CHAR(BKGFLT.FLTDAT,'dd-MON-YYYY')
            WHEN (BKGFLT.FLTCARCOD IS NOT NULL
            AND BKGFLT.FLTBKGSTA   <> 'C'
            AND (ISSPRTARL          ='Y'
            OR ARPPAR.PARVAL        = 'Y'))
            THEN 'EXPORT '
              ||MST.DSTCOD
            WHEN (BKGFLT.UBRNUM        IS NOT NULL
            AND (NVL(ISSPRTARL,'N')     ='N')
            AND (NVL(ARPPAR.PARVAL,'N') ='N'))
            THEN 'Transfer to '
              ||BKGFLT.FLTCARCOD
            ELSE ''
          END)
          || ',' ) ) .EXTRACT ( '//text()' ), ',' )
        FROM
          (SELECT ARLACTMST.ARLIDR,
            CASE
              WHEN ARLACTMST.OWNARLIND = 'Y'
              THEN ARLACTMST.OWNARLIND
              WHEN ARLACTMST.ISSPRTARL = 'Y'
              THEN ARLACTMST.ISSPRTARL
            END ISSPRTARL
          FROM SHRARLMST ARLACTMST
          WHERE ARLACTMST.CMPCOD = ?
          )
        WHERE ARLIDR = BKGFLT.FLTCARIDR
		and SEG.POL          <> BKGFLT.FLTORG
        )
    END )
    || ',' ) ORDER BY BKGFLT.FLTBKGSTA ) .EXTRACT ( '//text()' ), ',' )
  FROM CAPBKGFLTDTL BKGFLT,
    SHRARLARPPAR ARPPAR
  WHERE MST.MSTDOCNUM  = BKGFLT.MSTDOCNUM
  AND MST.DOCOWRIDR    =BKGFLT.DOCOWRIDR
  AND MST.DUPNUM       =BKGFLT.DUPNUM
  AND MST.SEQNUM       =BKGFLT.SEQNUM
  AND MST.CMPCOD       =BKGFLT.CMPCOD
  AND BKGFLT.CMPCOD    = ARPPAR.CMPCOD(+)
  AND BKGFLT.FLTCARIDR = ARPPAR.ARLIDR(+)
  AND ARPPAR.PARCOD(+) = 'operations.flthandling.handlecarrier'
  AND ARPPAR.ARPCOD(+) = BKGFLT.FLTORG
  ) ONWFLTINFO


		  FROM
OPRSEGULD ULD,
			OPRSEGULDSHP SHP,
			OPRSHPMST MST,
			OPRFLTSEG SEG,
			OPRSEGSHP SEGSHP,


			OPRARPSHP
ARPSHP,
			OPRULDTHRRTG TRU,
			OPRSHPMSTMIS MIS

		 WHERE  ULD.FLTCARIDR = SHP.FLTCARIDR(+)


			AND ULD.FLTNUM
= SHP.FLTNUM(+)
			AND ULD.FLTSEQNUM = SHP.FLTSEQNUM(+)
			AND ULD.SEGSERNUM = SHP.SEGSERNUM(+)


			AND
ULD.CMPCOD = SHP.CMPCOD(+)
			AND ULD.ULDNUM = SHP.ULDNUM(+)
			AND ULD.FLTCARIDR = TRU.FLTCARIDR(+)



AND ULD.FLTNUM = TRU.FLTNUM(+)
			AND ULD.FLTSEQNUM = TRU.FLTSEQNUM(+)
			AND ULD.SEGSERNUM = TRU.SEGSERNUM(+)



AND ULD.CMPCOD = TRU.CMPCOD(+)
			AND ULD.ULDNUM = TRU.ULDNUM(+)
			AND ULD.FLTCARIDR = SEG.FLTCARIDR(+)



AND ULD.FLTNUM = SEG.FLTNUM(+)
			AND ULD.FLTSEQNUM = SEG.FLTSEQNUM(+)
			AND ULD.SEGSERNUM = SEG.SEGSERNUM(+)



AND ULD.CMPCOD = SEG.CMPCOD(+)
			AND SHP.DOCOWRIDR = MST.DOCOWRIDR(+)
			AND SHP.MSTDOCNUM = MST.MSTDOCNUM(+)



AND SHP.DUPNUM = MST.DUPNUM(+)
			AND SHP.SEQNUM = MST.SEQNUM(+)
			AND SHP.CMPCOD = MST.CMPCOD(+)



AND SHP.DOCOWRIDR = SEGSHP.DOCOWRIDR(+)
			AND SHP.MSTDOCNUM = SEGSHP.MSTDOCNUM(+)
			AND SHP.DUPNUM


= SEGSHP.DUPNUM(+)
			AND SHP.SEQNUM = SEGSHP.SEQNUM(+)
			AND SHP.CMPCOD = SEGSHP.CMPCOD(+)
			AND

SHP.FLTCARIDR
= SEGSHP.FLTCARIDR(+)
			AND SHP.FLTNUM = SEGSHP.FLTNUM(+)
			AND SHP.FLTSEQNUM = SEGSHP.FLTSEQNUM(+)



AND SHP.SEGSERNUM = SEGSHP.SEGSERNUM(+)
			AND SEGSHP.DOCOWRIDR = ARPSHP.DOCOWRIDR(+)
			AND SEGSHP.MSTDOCNUM


= ARPSHP.MSTDOCNUM(+)
			AND SEGSHP.DUPNUM = ARPSHP.DUPNUM(+)
			AND SEGSHP.SEQNUM = ARPSHP.SEQNUM(+)



			AND SEGSHP.CMPCOD = ARPSHP.CMPCOD(+)
			AND MST.CMPCOD = MIS.CMPCOD(+)
			AND MST.DOCOWRIDR =
MIS.DOCOWRIDR(+)


			AND MST.MSTDOCNUM = MIS.MSTDOCNUM(+)
			AND MST.DUPNUM = MIS.DUPNUM(+)
			AND
MST.SEQNUM = MIS.SEQNUM(+)


			AND ULD.FLTCARIDR = ?
			AND ULD.FLTNUM = ?
			AND ULD.FLTSEQNUM =
?
			AND ULD.CMPCOD = ?
			AND
SEG.POU
= ?
			AND ARPSHP.ARPCOD(+) = ?
			AND (NVL(SEGSHP.MFTPCS, 0) > 0)


			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>248</QRY:Id>
		<QRY:Source Name="operations.flthandling.arrival.findshipmentsegmentfordiscrepancy" Type="NATIVE">
			<![CDATA[

						SELECT SEGSHP.FLTCARIDR, SEGSHP.CMPCOD, SEGSHP.FLTNUM,
						SEGSHP.FLTSEQNUM,  SEGSHP.SEGSERNUM,MST.ORGCOD,MST.CONFLG,



						MST.DSTCOD,MST.STDPCS,IMPFLT.FLTDAT,IMPFLT.FLTCARCOD,MST.STDWGT,
						SEGSHP.DOCOWRIDR, SEGSHP.MSTDOCNUM,


SEGSHP.DUPNUM,
						SEGSHP.SEQNUM, SEGSHP.MFTPCS, SEGSHP.MFTWGT, MST.SHPPFX,MST.OWRCOD,
						SEGSHP.MFTVOL,


SEGSHP.RCVPCS, SEGSHP.RCVWGT, SEGSHP.RCVVOL, MST.SCCCOD, MST.AGTCOD,
							FLTSEG.POL,FLTSEG.POU,SEGULD.BDNCPLFLG


,SEGULD.ULDNUM,MST.DTACPTFLG
							FROM OPRSEGULDSHP SEGSHP,OPRSHPMST MST,OPRFLTSEG FLTSEG,OPRARPIMPFLT


IMPFLT,OPRSEGULD SEGULD
						WHERE
						SEGSHP.CMPCOD=MST.CMPCOD(+) AND
						SEGSHP.DOCOWRIDR=MST.DOCOWRIDR(+)


AND
						SEGSHP.MSTDOCNUM=MST.MSTDOCNUM(+) AND
						SEGSHP.DUPNUM=MST.DUPNUM(+) AND
						SEGSHP.SEQNUM=MST.SEQNUM(+)


AND

						SEGSHP.FLTCARIDR=FLTSEG.FLTCARIDR(+) AND
						SEGSHP.FLTNUM=FLTSEG.FLTNUM(+) AND

SEGSHP.FLTSEQNUM=FLTSEG.FLTSEQNUM(+)

AND
						SEGSHP.SEGSERNUM=FLTSEG.SEGSERNUM(+) AND
						SEGSHP.CMPCOD=FLTSEG.CMPCOD(+)
AND


							SEGSHP.FLTCARIDR=SEGULD.FLTCARIDR
AND
							SEGSHP.FLTNUM=SEGULD.FLTNUM AND
							SEGSHP.FLTSEQNUM=SEGULD.FLTSEQNUM

AND
							SEGSHP.SEGSERNUM=SEGULD.SEGSERNUM
AND
							SEGSHP.CMPCOD=SEGULD.CMPCOD AND
							SEGSHP.ULDNUM=SEGULD.ULDNUM

AND

						FLTSEG.FLTCARIDR=IMPFLT.FLTCARIDR(+)
AND
						FLTSEG.FLTNUM=IMPFLT.FLTNUM(+) AND


						FLTSEG.FLTSEQNUM=IMPFLT.FLTSEQNUM(+) AND
						FLTSEG.CMPCOD=IMPFLT.CMPCOD(+)
AND
						FLTSEG.POU=IMPFLT.ARPCOD(+)

AND
						SEGSHP.FLTNUM=? AND
						SEGSHP.FLTSEQNUM =? AND

SEGSHP.FLTCARIDR =? AND
						SEGSHP.CMPCOD=?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>243</QRY:Id>
		<QRY:Source Name="operations.manifest.findarrivalreportdetails" Type="NATIVE">
			<![CDATA[

	SELECT   ULD.CMPCOD ULDCMPCOD,
			ULD.FLTCARIDR ULDFLTCARIDR,
			ULD.FLTNUM ULDFLTNUM,
			ULD.FLTSEQNUM


ULDFLTSEQNUM,
			ULD.SEGSERNUM ULDSEGSERNUM,
			ULD.GRSWGT ULDGRSWGT,
			ULD.NETWGT ULDNETWGT, ULD.THRUNT,



			ULD.CONIDR CONIDR, ULD.ULDNUM ULDULDNUM,
			SHP.CUSREF SHPCUSREF, SHP.MFTPCS SHPPCS,
			SHP.MFTWGT

SHPWGT,
SHP.MFTVOL SHPVOL,
			SHP.FLTCARIDR SHPFLTCARIDR,
			SHP.FLTNUM SHPFLTNUM,SHP.ADDSCC,
			SHP.RCVPCS

SHPRCVPCS,

			SHP.RCVWGT SHPRCVWGT,
			SHP.FLTSEQNUM SHPFLTSEQNUM,
			SHP.CUSREF SHPCUSREF,
			SHP.SEGSERNUM

SHPSEGSERNUM,

			SHP.ULDNUM SHPULDNUM,
			SHP.DOCOWRIDR SHPDOCOWRIDR,
			SHP.MSTDOCNUM SHPMSTDOCNUM,


			SHP.DUPNUM SHPDUPNUM,

			SHP.SEQNUM SHPSEQNUM, SHP.RMK SEGSHPARVRMK,
			SHP.CMPCOD SHPCMPCOD,
			MST.CNSNAM

MSTCNSNAM, MST.STDWGT,

			MST.STDPCS, MST.GRSVOL,
			MST.SCCCOD MSTSCCCOD,
			MST.SHPDES MSTSHPDES,


			MST.ORGCOD MSTORGCOD,

			MST.DSTCOD MSTDSTCOD,
			MST.STDWGTCOD MSTSTDWGTCOD,
			MST.STDDISWGT
MSTSTDDISWGT,

			MST.PRDNAM MSTPRDNAM,

			MST.PRDPRT MSTPRDPRT, MST.SHPPFX,
			SEG.CMPCOD SEGCMPCOD,

SEG.FLTCARIDR
SEGFLTCARIDR,
			SEG.FLTNUM
SEGFLTNUM,
			SEG.FLTSEQNUM SEGFLTSEQNUM,
			SEG.POL SEGPOL,
SEG.POU SEGPOU,

SEG.SEGSERNUM SEGSEGSERNUM,

RTG.SERNUM RTGSERNUM,
			RTG.SEGSERNUM RTGSEGSERNUM,

RTG.FLTSEQNUM
RTGFLTSEQNUM,
			RTG.FLTNUM RTGFLTNUM,

RTG.FLTCARIDR RTGCARIDR,
			RTG.CMPCOD RTGCMPCOD,

RTG.ULDNUM
RTGULDNUM,
			RTG.THRCARIDR RTGTHRCARIDR,

RTG.THRCARCOD RTGTHRCARCOD,
			RTG.THRFLTNUM
RTGTHRFLTNUM,

			RTG.THRFLTDAT RTGTHRFLTDAT,
			RTG.THRDSTCOD
RTGTHRDSTCOD, MST.STDPCS,
			MST.STDWGT,
MST.GRSVOL,

			SEGSHP.DOCOWRIDR SEGSHPDOCOWRIDR,
			SEGSHP.MSTDOCNUM
SEGSHPMSTDOCNUM,
			SEGSHP.DUPNUM
SEGSHPDUPNUM,

			SEGSHP.SEQNUM SEGSHPSEQNUM,
			SEGSHP.FLTNUM SEGSHPFLTNUM,

SEGSHP.FLTSEQNUM
SEGSHPFLTSEQNUM,
			SEGSHP.SEGSERNUM
SEGSHPSEGSERNUM,
			SEGSHP.FLTCARIDR SEGSHPFLTCARIDR,

SEGSHP.CMPCOD
SEGSHPCMPCOD,
			SEGSHP.MFTPCS
SEGSHPMFTPCS,
			SEGSHP.MFTWGT SEGSHPMFTWGT,
			SEGSHP.MFTVOL
SEGSHPMFTVOL,

SEGSHP.RCVPCS SEGSHPRCVPCS,

SEGSHP.RCVWGT SEGSHPRCVWGT,
			SEGSHP.RCVVOL SEGSHPRCVVOL,

SEGSHP.PLNPCS
SEGSHPPLNPCS,
			SEGSHP.PLNWGT
SEGSHPPLNWGT,
			SEGSHP.PLNVOL SEGSHPPLNVOL,
			SEGSHP.SLCPCS,

			ARPSHP.CUSCLRREQFLG,
ARPSHP.CUSCLRSTA,
			ARPSHP.SECCLRREQFLG, ARPSHP.SECCLRSTA,


			ARPSHP.EXPFLG ARPSHPEXPFLG,
			SHPDTL.PLTUSEFLG,
MST.PLTFLG,
			DMGDIS.DMGPCS DMGPCS,
			SEGSHP.LSTUPDTIM

SHPUPDTIM,
			ULD.LSTUPDTIM ULDUPDTIM,
			RTG.LSTUPDTIM
RTGUPDTIM,
			ARPSHP.LSTUPDTIM ARPUPDTIM


	    FROM OPRSEGSHP SEGSHP,
			OPRSEGULD ULD,
			OPRSEGULDSHP
SHP,
			OPRSHPMST MST,
			OPRFLTSEG SEG,


			OPRULDTHRRTG RTG,
			OPRARPSHP ARPSHP,
			OPRSHPDTL SHPDTL,

			OPRDMGDIS DMGDIS
	   WHERE SEGSHP.FLTCARIDR

= SEG.FLTCARIDR(+)
			AND SEGSHP.FLTNUM = SEG.FLTNUM(+)

			AND SEGSHP.FLTSEQNUM = SEG.FLTSEQNUM(+)


AND SEGSHP.SEGSERNUM = SEG.SEGSERNUM(+)
			AND SEGSHP.CMPCOD
= SEG.CMPCOD(+)
			AND SEGSHP.DOCOWRIDR

= MST.DOCOWRIDR
			AND SEGSHP.MSTDOCNUM = MST.MSTDOCNUM
			AND
SEGSHP.DUPNUM = MST.DUPNUM
			AND SEGSHP.SEQNUM

= MST.SEQNUM
			AND SEGSHP.CMPCOD = MST.CMPCOD
			AND
SEGSHP.DOCOWRIDR = SHP.DOCOWRIDR(+)
			AND SEGSHP.MSTDOCNUM

= SHP.MSTDOCNUM(+)
			AND SEGSHP.DUPNUM
= SHP.DUPNUM(+)
			AND SEGSHP.SEQNUM = SHP.SEQNUM(+)
			AND
SEGSHP.FLTCARIDR
= SHP.FLTCARIDR(+)
			AND
SEGSHP.FLTNUM = SHP.FLTNUM(+)
			AND SEGSHP.FLTSEQNUM =
SHP.FLTSEQNUM(+)

AND SEGSHP.SEGSERNUM = SHP.SEGSERNUM(+)

			AND SEGSHP.DOCOWRIDR = ARPSHP.DOCOWRIDR(+)

AND SEGSHP.MSTDOCNUM
= ARPSHP.MSTDOCNUM(+)
			AND SEGSHP.DUPNUM
= ARPSHP.DUPNUM(+)
			AND SEGSHP.SEQNUM
= ARPSHP.SEQNUM(+)

AND SEGSHP.CMPCOD = ARPSHP.CMPCOD(+)

			AND SEGSHP.DOCOWRIDR = SHPDTL.DOCOWRIDR(+)

AND SEGSHP.MSTDOCNUM
= SHPDTL.MSTDOCNUM(+)
			AND SEGSHP.DUPNUM
= SHPDTL.DUPNUM(+)
			AND SEGSHP.SEQNUM
= SHPDTL.SEQNUM(+)

AND SEGSHP.CMPCOD = SHPDTL.CMPCOD(+)

			AND SHP.FLTCARIDR = ULD.FLTCARIDR(+)

AND SHP.FLTNUM = ULD.FLTNUM(+)

AND SHP.FLTSEQNUM = ULD.FLTSEQNUM(+)

			AND SHP.SEGSERNUM = ULD.SEGSERNUM(+)

AND SHP.ULDNUM = ULD.ULDNUM(+)

AND ULD.FLTCARIDR = RTG.FLTCARIDR(+)

			AND ULD.FLTNUM = RTG.FLTNUM(+)

AND ULD.FLTSEQNUM = RTG.FLTSEQNUM(+)

AND ULD.SEGSERNUM = RTG.SEGSERNUM(+)

			AND ULD.CMPCOD =
RTG.CMPCOD(+)
			AND ULD.ULDNUM = RTG.ULDNUM(+)

			AND SEGSHP.CMPCOD = DMGDIS.CMPCOD(+)

			AND
SEGSHP.DOCOWRIDR = DMGDIS.DOCOWRIDR(+)
			AND SEGSHP.MSTDOCNUM
= DMGDIS.MSTDOCNUM(+)
			AND SEGSHP.DUPNUM

= DMGDIS.DUPNUM(+)
			AND SEGSHP.SEQNUM = DMGDIS.SEQNUM(+)

			AND SEGSHP.FLTCARIDR = DMGDIS.FLTCARIDR(+)


			AND SEGSHP.FLTNUM = DMGDIS.FLTNUM(+)
			AND SEGSHP.FLTSEQNUM
= DMGDIS.FLTSEQNUM(+)
			AND SEGSHP.FLTCARIDR

= ?
			AND SEGSHP.FLTNUM = ?
			AND SEGSHP.FLTSEQNUM =
?
			AND SEGSHP.CMPCOD = ?
			AND SEG.POU =
?

			AND SEGSHP.MFTPCS > 0
	ORDER BY 	MST.DSTCOD,
			TO_NUMBER(REVERSE(SHP.MSTDOCNUM)),

			SEGSHP.CMPCOD,


			SEGSHP.FLTNUM,
			SEGSHP.FLTCARIDR,
			SEGSHP.MSTDOCNUM,
			SEGSHP.DOCOWRIDR,
			SEGSHP.DUPNUM,



			SEGSHP.SEQNUM,
			ULD.ULDNUM,
			ARPSHP.LSTUPDTIM DESC


			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>283</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findHAWBDetailsForHouseManifest" Type="NATIVE">
			<![CDATA[
            SELECT  FLTSEG.FLTCARIDR FLTCARIDR,
              FLTSEG.FLTNUM FLTNUM,
              FLTSEG.FLTSEQNUM


FLTSEQNUM,
						  FLTSEG.POL,FLTSEG.POU,
              SHPMST.DOCOWRIDR DOCOWRIDR,
              SHPMST.MSTDOCNUM


MSTDOCNUM,
              SHPMST.DUPNUM DUPNUM,
              SHPMST.SEQNUM SEQNUM,
              SHPMST.DOCNUM


DOCNUM,
              SHPMST.STDPCS STDPCS,
              SHPMST.STDWGT STDWGT,
              SHPMST.SHPPFX


SHPPFX,
              SHPMST.CMPCOD CMPCOD,
						  SHPMST.SHPCOD,SHPMST.SHPNAM,
						  SHPMST.SHPADRONE,



						  SHPMST.CNSCOD, SHPMST.CNSNAM,
						  SHPMST.CNSADRONE,SHPMST.CONFLG,
						  SHPMST.SCCCOD,SHPMST.ORGCOD,



						  SHPMST.DSTCOD,SHPMST.SRCIND MSTSRCIND,
						  SHPMST.SHPDES,SHPMST.HDLINF, SHPMST.LSTUPDTIM

SHPLSTUPDTIM,

              IMPFLT.CARCHKENDFLG CARCHKENDFLG,
              IMPFLT.LEGSERNUM

LEGSERNUM,
						  SELSHP.SRCIND,SELSHP.MSTDOCNUM
SELMSTDOCNUM,
						  SELSHP.SELPCS, SELSHP.SELWGT,SELSHP.BUCFLG,


						  SELSHP.INTFLG,SELSHP.FWDCOD,

						  SELSHP.PERCOD,SELSHP.SELRMK,
						  SELSHP.SPLCOD,SELSHP.TRPMOD,


						  SELSHP.TRPTYP,SELSHP.ULDDIS,

						  SELSHP.UGTCOD,SELSHP.COMDES,
						  SELSHP.NCSFLTCARCOD,


						  SELSHP.NCSFLTNUM, SELSHP.NCSFLTDAT,

						  SELSHP.NXTCARCOD,SELSHP.NXTFLTNUM,

SELSHP.NXTFLTDAT,

						  SELSHP.LSTUPDTIM SELSHPLSTUPDTIM,

						  SELSHP.LSTUPDUSR
SELSHPLSTUPDUSR,
						  SEGULDSHP.ULDNUM,

						  MSTCNT.SHPADRTWO,
						  MSTCNT.SHPCTY,

MSTCNT.SHPSTT,
						  MSTCNT.SHPCTR, MSTCNT.SHPTELNUM,

						  MSTCNT.SHPMALIDR, MSTCNT.SHPPSTCOD,


						  MSTCNT.CNSADRTWO, MSTCNT.CNSCTY,
						  MSTCNT.CNSSTT,
MSTCNT.CNSCTR,
						  MSTCNT.CNSTELNUM,
MSTCNT.CNSMALIDR,

						  MSTCNT.CNSPSTCOD, MSTCNT.CNSPRTNFNFLG,

						  MSTCNT.SHPREFNUM,
MSTCNT.SHPACCNUM,
						  MSTCNT.CNSACCNUM,

						  ARPSHP.ARPCOD ARPSHPARPCOD,


ARPSHP.LSTUPDUSR ARPSHPLSTUPDUSR,
						  ARPSHP.LSTUPDTIM ARPSHPLSTUPDTIM,SELSHP.DOCRCVFLG,



						  ARASHP.ARACOD, ARASHP.MFTPCS ARASHPMFTPCS,
						  ARASHP.MFTWGT ARASHPMFTWGT,
						  ARASHP.LSTUPDTIM


ARASHPLSTUPDTIM,
						  ARASHP.LSTUPDUSR ARASHPLSTUPDUSR,
						  ARPMST.CNTCOD,
						  FLTHIS.STRTIM,



              (CASE
                WHEN SELSHP.SELPCS > 0
                THEN SELSHP.SELPCS


                ELSE
SEGSHP.MFTPCS
              END) AWBMFTPCS,
              (CASE

WHEN SELSHP.SELWGT
>
0
                THEN SELSHP.SELWGT
                ELSE SEGSHP.MFTWGT

END) AWBMFTWGT,


              SEGSHP.RCVPCS,
              SEGSHP.RCVWGT,

MSTMIS.INSDTL INSDTL,

              MSTMIS.FWDCOD
MISFWDCOD,
              (SELECT 1
FROM DUAL
               WHERE EXISTS (

               SELECT 1 FROM
OPRSHPBLK SHPBLK

WHERE SHPMST.CMPCOD = SHPBLK.CMPCOD
               AND
SHPMST.SEQNUM
= SHPBLK.SEQNUM

AND SHPMST.DUPNUM = SHPBLK.DUPNUM

                     AND SHPMST.MSTDOCNUM
=
SHPBLK.MSTDOCNUM
                     AND SHPMST.DOCOWRIDR = SHPBLK.DOCOWRIDR



AND SHPMST.DOCNUM = SHPBLK.DOCNUM
                     AND SHPBLK.ARPCOD = ?


AND
SHPBLK.BLKSTA = 'B')) HOLDEXISTS
            FROM
              OPRSEGSHP SEGSHP,


              OPRSHPMST
SHPMST,
              OPRFLTSEG FLTSEG,
              OPRARPIMPFLT IMPFLT,

OPRSEGSELSHP

SELSHP,
						   OPRSHPMSTMIS MSTMIS,
						   OPRSEGULDSHP SEGULDSHP,
						   OPRSHPMSTCNT
MSTCNT,


						   OPRARPSHP ARPSHP,
						   OPRARPARASHP ARASHP,
						   SHRARPMST ARPMST,

OPRIMPFLTHIS
FLTHIS,

						    (SELECT CMPCOD, MSTDOCNUM, DOCOWRIDR, DUPNUM,
			  	   SEQNUM,
DOCRCVFLG,
COUNT(1) FROM OPRSEGSELSHP
WHERE DOCRCVFLG= 'Y'
			  	   GROUP BY CMPCOD, MSTDOCNUM, DOCOWRIDR,
DUPNUM,

			  	   SEQNUM, DOCRCVFLG)
AWBRCV
            WHERE
              SHPMST.CMPCOD=SEGSHP.CMPCOD(+)


              AND SHPMST.DOCOWRIDR=SEGSHP.DOCOWRIDR(+)

              AND SHPMST.MSTDOCNUM=SEGSHP.MSTDOCNUM(+)


              AND SHPMST.DUPNUM=SEGSHP.DUPNUM(+)

              AND SHPMST.SEQNUM=SEGSHP.SEQNUM(+)



              AND SEGSHP.FLTCARIDR=FLTSEG.FLTCARIDR(+)

              AND SEGSHP.FLTNUM=FLTSEG.FLTNUM(+)


              AND SEGSHP.FLTSEQNUM=FLTSEG.FLTSEQNUM(+)

              AND SEGSHP.SEGSERNUM=FLTSEG.SEGSERNUM(+)


              AND SEGSHP.CMPCOD=FLTSEG.CMPCOD(+)


              AND FLTSEG.FLTCARIDR=IMPFLT.FLTCARIDR(+)


              AND FLTSEG.FLTNUM=IMPFLT.FLTNUM(+)

              AND FLTSEG.FLTSEQNUM=IMPFLT.FLTSEQNUM(+)


              AND FLTSEG.CMPCOD=IMPFLT.CMPCOD(+)

              AND FLTSEG.POU=IMPFLT.ARPCOD(+)



              AND SEGSHP.CMPCOD = SELSHP.CMPCOD(+)
              AND
SEGSHP.FLTCARIDR = SELSHP.FLTCARIDR(+)


              AND SEGSHP.FLTNUM = SELSHP.FLTNUM(+)

AND SEGSHP.FLTSEQNUM = SELSHP.FLTSEQNUM(+)


              AND SEGSHP.SEGSERNUM = SELSHP.SEGSERNUM(+)

AND SEGSHP.DOCOWRIDR = SELSHP.DOCOWRIDR(+)


              AND SEGSHP.MSTDOCNUM = SELSHP.MSTDOCNUM(+)

AND SEGSHP.DUPNUM = SELSHP.DUPNUM(+)


              AND SEGSHP.SEQNUM = SELSHP.SEQNUM(+)


              AND SHPMST.CMPCOD=MSTMIS.CMPCOD(+)


              AND SHPMST.DOCOWRIDR=MSTMIS.DOCOWRIDR(+)

              AND SHPMST.MSTDOCNUM=MSTMIS.MSTDOCNUM(+)


              AND SHPMST.DUPNUM=MSTMIS.DUPNUM(+)

              AND SHPMST.SEQNUM=MSTMIS.SEQNUM(+)




						  AND SEGSHP.CMPCOD = SEGULDSHP.CMPCOD(+)
						  AND SEGSHP.FLTNUM
= SEGULDSHP.FLTNUM(+)

AND
SEGSHP.FLTSEQNUM = SEGULDSHP.FLTSEQNUM(+)
						  AND SEGSHP.FLTCARIDR
= SEGULDSHP.FLTCARIDR(+)


						  AND SEGSHP.SEGSERNUM = SEGULDSHP.SEGSERNUM(+)
						  AND SEGSHP.DOCOWRIDR
= SEGULDSHP.DOCOWRIDR(+)


						  AND SEGSHP.MSTDOCNUM = SEGULDSHP.MSTDOCNUM(+)
						  AND SEGSHP.DUPNUM
= SEGULDSHP.DUPNUM(+)


						  AND SEGSHP.SEQNUM = SEGULDSHP.SEQNUM(+)

						  AND SHPMST.CMPCOD = MSTCNT.CMPCOD(+)



						  AND SHPMST.DOCOWRIDR = MSTCNT.DOCOWRIDR(+)
						  AND SHPMST.MSTDOCNUM = MSTCNT.MSTDOCNUM(+)



						  AND SHPMST.DUPNUM = MSTCNT.DUPNUM(+)
						  AND SHPMST.SEQNUM = MSTCNT.SEQNUM(+)


AND
SHPMST.CMPCOD
= ARPSHP.CMPCOD(+)
						  AND SHPMST.DOCOWRIDR = ARPSHP.DOCOWRIDR(+)
						  AND
SHPMST.MSTDOCNUM
=
ARPSHP.MSTDOCNUM(+)
						  AND SHPMST.DUPNUM = ARPSHP.DUPNUM(+)
						  AND SHPMST.SEQNUM
= ARPSHP.SEQNUM(+)



AND ARPSHP.CMPCOD = ARASHP.CMPCOD(+)
						  AND ARPSHP.DOCOWRIDR = ARASHP.DOCOWRIDR(+)

AND
ARPSHP.MSTDOCNUM
= ARASHP.MSTDOCNUM(+)
						  AND ARPSHP.DUPNUM = ARASHP.DUPNUM(+)
						  AND
ARPSHP.SEQNUM
= ARASHP.SEQNUM(+)

AND ARPSHP.ARPCOD = ARASHP.ARPCOD(+)

						  AND SHPMST.CMPCOD
= ARPMST.CMPCOD(+)

AND SHPMST.DSTCOD
= ARPMST.ARPCOD(+)

						  AND IMPFLT.FLTNUM = FLTHIS.FLTNUM(+)

AND IMPFLT.FLTSEQNUM
= FLTHIS.FLTSEQNUM(+)

AND IMPFLT.FLTCARIDR = FLTHIS.FLTCARIDR(+)

AND IMPFLT.LEGSERNUM
= FLTHIS.LEGSERNUM(+)

						  AND IMPFLT.ARPCOD = FLTHIS.ARPCOD(+)

AND IMPFLT.CMPCOD
= FLTHIS.CMPCOD(+)
						  AND SHPMST.CMPCOD=AWBRCV.CMPCOD(+)


AND SHPMST.DOCOWRIDR=AWBRCV.DOCOWRIDR(+)

              AND SHPMST.MSTDOCNUM=AWBRCV.MSTDOCNUM(+)


              AND SHPMST.DUPNUM=AWBRCV.DUPNUM(+)

              AND SHPMST.SEQNUM=AWBRCV.SEQNUM(+)

AND FLTHIS.TXNCOD
(+) = 'MSTSEL'

              AND SHPMST.CMPCOD
= ?
              AND SHPMST.DOCOWRIDR
= ?

AND SHPMST.MSTDOCNUM    = ?

AND SHPMST.DUPNUM       = ?

AND SHPMST.PARSEQNUM
= ?
              AND FLTSEG.POU(+)
= ?
              AND IMPFLT.CMPCOD(+)
= ?
						  AND ARASHP.ARPCOD
(+)   = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>253</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.finduldselectdetails" Type="NATIVE">
			<![CDATA[

  		 SELECT SHP.*,
  		  ULDORGARP.UKNARPCODNCSFLG
  		   FROM
  		  (SELECT IMPFLT.CMPCOD


,
  		    IMPFLT.ARPCOD IMPFLTARPCOD      ,
  		    IMPFLT.FLTCARIDR                ,
  		    IMPFLT.FLTNUM


,
  		    IMPFLT.FLTDAT                   ,
  		    IMPFLT.FLTSEQNUM                ,
  		    IMPFLT.CLSFLG


,
  		    IMPFLT.MFTSRC                   ,
  		    IMPFLT.LSTUPDTIM IMPFLTLSTUPDTIM,
  		    IMPFLT.LSTUPDUSR


IMPFLTLSTUPDUSR,
  		    SEGULD.LSTUPDUSR SEGULDLSTUPDUSR,
  		    SEGULD.LSTUPDTIM SEGULDLSTUPDTIM,



  		    SEGULD.ULDNUM ULDNUM            ,
  		    SEGULD.THRUNT                   ,
  		    SEGULD.MFTFLG


,
  		    SEGULD.RCVFLG                   ,
  		    SEGULD.BDPFLG                   ,
  		    SEGULD.RMK


SEGULDRMK            ,
  		    SHPMST.MSTDOCNUM                ,
  		    SHPMST.ORGCOD


,
  		    SHPMST.DSTCOD                   ,
  		    ARPMST.CNTCOD                   ,
  		    SELULD.ACTTMP


,
  		    SELULD.CSDFLG                   ,
  		    SELULD.CSHFLG                   ,
  		    SELULD.HLEFLG


,
  		    SELULD.HNDCOD                   ,
  		    SELULD.INTFLG                   ,
  		    SELULD.NOOCVRFLG


,
  		    SELULD.PCHFLG                   ,
  		    SELULD.PLCCVRFLG                ,
  		    SELULD.PLCDWSFLG


,
  		    SELULD.PLCUPSFLG                ,
  		    SELULD.PLTNETFLG                ,
  		    SELULD.REQTMP


,
  		    SELULD.SELRMK                   ,
  		    SELULD.ULDSYM                   ,
  		    SELULD.STPFLG


,
  		    SELULD.STPNUM                   ,
  		    SELULD.TRNFLG                   ,
  		    SELULD.TRPTYP


,
  		    SELULD.ULDDIS                   ,
  		    SELULD.ULDNAT                   ,
  		    SELULD.ULDTYP


,
  		    SELULD.WHSCOD                   ,
  		    SELULD.WODSPTFLG                ,
  		    SELULD.WODSPTNUM


,
  			SELULD.NCSINVORG				,
  		    SELULD.ORGCOD ULDORG            ,
  		    SELULD.DSTCOD ULDDST


,
  		    FLTSEG.POL                      ,
  		    FLTSEG.POU						,
  			SELULD.NCSFLTCARCOD


,
              SELULD.NCSFLTDAT                ,
              SELULD.NCSFLTNUM                ,



              SELULD.ACHSTA,
              SELULD.PKGSTA,
              SELULD.BINSTA,


              SELULD.BINFLG,

              SELULD.BILSTA,
              SELULD.BNDTRPNUM,


              SELULD.LSTUPDTIM SELULDLSTUPDTIM,

              'ULD/AWB/' ||

( SELECT COUNT(*)
shpdes
  			   FROM oprseguldshp
  			     WHERE uldnum
= seguld.uldnum
  				 and
fltnum=impflt.fltnum

  				 and fltseqnum=impflt.fltseqnum ) SHPDES

  		     FROM OPRARPIMPFLT
IMPFLT,
  		    OPRFLTSEG
FLTSEG         ,
  		    OPRSEGULD SEGULD         ,

  		    OPRSEGSELULD
SELULD      ,

  		    OPRSEGULDSHP ULDSHP      ,
  		    OPRSHPMST SHPMST         ,


  		    SHRARPMST ARPMST

  		    WHERE FLTSEG.CMPCOD = IMPFLT.CMPCOD
  		  AND FLTSEG.FLTNUM
= IMPFLT.FLTNUM

  		  AND FLTSEG.FLTSEQNUM
= IMPFLT.FLTSEQNUM
  		  AND FLTSEG.FLTCARIDR  =
IMPFLT.FLTCARIDR
  		  AND FLTSEG.POU
= IMPFLT.ARPCOD

AND FLTSEG.CMPCOD     = SEGULD.CMPCOD

AND FLTSEG.FLTNUM     = SEGULD.FLTNUM

AND FLTSEG.FLTSEQNUM
= SEGULD.FLTSEQNUM
  		  AND FLTSEG.FLTCARIDR
= SEGULD.FLTCARIDR
  		  AND FLTSEG.SEGSERNUM
= SEGULD.SEGSERNUM

AND SEGULD.CMPCOD     = SELULD.CMPCOD(+)

AND SEGULD.FLTNUM     = SELULD.FLTNUM(+)

AND SEGULD.FLTSEQNUM
= SELULD.FLTSEQNUM(+)
  		  AND
SEGULD.FLTCARIDR  = SELULD.FLTCARIDR(+)
  		  AND
SEGULD.SEGSERNUM
= SELULD.SEGSERNUM(+)
  		  AND
SEGULD.ULDNUM     = SELULD.ULDNUM(+)
  		  AND SEGULD.CMPCOD
= ULDSHP.CMPCOD(+)

  		  AND
SEGULD.FLTNUM     = ULDSHP.FLTNUM(+)
  		  AND SEGULD.FLTSEQNUM  = ULDSHP.FLTSEQNUM(+)

AND
SEGULD.FLTCARIDR
= ULDSHP.FLTCARIDR(+)
  		  AND SEGULD.SEGSERNUM  = ULDSHP.SEGSERNUM(+)
  		  AND
SEGULD.ULDNUM

= ULDSHP.ULDNUM(+)
  		  AND ULDSHP.CMPCOD     = SHPMST.CMPCOD(+)
  		  AND ULDSHP.DOCOWRIDR
= SHPMST.DOCOWRIDR(+)


  		  AND ULDSHP.MSTDOCNUM  = SHPMST.MSTDOCNUM(+)
  		  AND ULDSHP.DUPNUM     =
SHPMST.DUPNUM(+)

AND
ULDSHP.SEQNUM     = SHPMST.SEQNUM(+)
  		  AND SHPMST.CMPCOD     = ARPMST.CMPCOD(+)

AND SHPMST.DSTCOD

= ARPMST.ARPCOD(+)
  		  AND IMPFLT.CMPCOD     = ?
  		  AND IMPFLT.FLTSEQNUM
= ?
  		  AND IMPFLT.FLTCARIDR

= ?
  		  AND IMPFLT.FLTNUM     = ?
  		  AND IMPFLT.ARPCOD     = ?

  		  ) SHP,
  		  SHRARPMST

ULDORGARP
  		  WHERE SHP.CMPCOD = ULDORGARP.CMPCOD (+)
  		AND SHP.ULDORG
= ULDORGARP.ARPCOD (+)


			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>288</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.finduldselectdetailsforreceiveuld" Type="NATIVE">
			<![CDATA[
			SELECT  IMPFLT.CMPCOD, IMPFLT.ARPCOD IMPFLTARPCOD,
				   IMPFLT.FLTCARIDR, IMPFLT.FLTNUM,



				   IMPFLT.FLTDAT, IMPFLT.FLTSEQNUM,
				   IMPFLT.CLSFLG, IMPFLT.MFTSRC,
				   IMPFLT.LSTUPDTIM

IMPFLTLSTUPDTIM,

				   IMPFLT.LSTUPDUSR IMPFLTLSTUPDUSR,
				   SEGULD.LSTUPDUSR SEGULDLSTUPDUSR,


				   SEGULD.LSTUPDTIM SEGULDLSTUPDTIM,

				   SEGULD.ULDNUM ULDNUM,SEGULD.THRUNT,SEGULD.SEGSERNUM,RMPULD.SERNUM,


				   SEGULD.MFTFLG,SEGULD.RCVFLG,SEGULD.BDPFLG,

				   SEGULD.RMK SEGULDRMK, SHPMST.MSTDOCNUM,


				   SHPMST.ORGCOD,SHPMST.DSTCOD, ARPMST.CNTCOD,
				   SELULD.ACTTMP,
SELULD.CSDFLG,
				   SELULD.CSHFLG,

SELULD.HLEFLG,
				   SELULD.HNDCOD, SELULD.INTFLG,
				   SELULD.NOOCVRFLG,
SELULD.PCHFLG,

SELULD.PLCCVRFLG,
SELULD.PLCDWSFLG,
				   SELULD.PLCUPSFLG, SELULD.PLTNETFLG,

				   SELULD.REQTMP,
SELULD.SELRMK,

				   SELULD.STPFLG, SELULD.STPNUM,
				   SELULD.TRNFLG, SELULD.TRPTYP,


				   SELULD.ULDDIS, SELULD.ULDNAT,

				   SELULD.WHSCOD, SELULD.WODSPTFLG,
				   SELULD.WODSPTNUM,SELULD.ORGCOD

ULDORG,
				   SELULD.DSTCOD
ULDDST,FLTSEG.POL,FLTSEG.POU,
				   RMPULD.BDNSTRTIM,RMPULD.BDNENDTIM,


				   RMPULD.LEDINNLOC,RMPULD.LEDINNTIM,

				   RMPULD.RCVTIM,SELULD.ULDTYP,IMPFLT.LEGSERNUM

FROM
OPRARPIMPFLT IMPFLT,
				   OPRFLTSEG FLTSEG,

				   OPRSEGULD SEGULD,
				   OPRSEGSELULD
SELULD,

OPRSEGULDSHP ULDSHP,
				   OPRSHPMST SHPMST,

				   SHRARPMST ARPMST,

WHSRMPULD RMPULD

WHERE FLTSEG.CMPCOD = IMPFLT.CMPCOD
				 AND FLTSEG.FLTNUM
= IMPFLT.FLTNUM

AND FLTSEG.FLTSEQNUM
= IMPFLT.FLTSEQNUM
				 AND FLTSEG.FLTCARIDR = IMPFLT.FLTCARIDR

AND FLTSEG.POU
= IMPFLT.ARPCOD

AND FLTSEG.CMPCOD = SEGULD.CMPCOD
				 AND FLTSEG.FLTNUM = SEGULD.FLTNUM

AND
FLTSEG.FLTSEQNUM =
SEGULD.FLTSEQNUM
				 AND FLTSEG.FLTCARIDR = SEGULD.FLTCARIDR
				 AND FLTSEG.SEGSERNUM

= SEGULD.SEGSERNUM

AND SEGULD.CMPCOD = SELULD.CMPCOD(+)
				 AND SEGULD.FLTNUM = SELULD.FLTNUM(+)


AND SEGULD.FLTSEQNUM
= SELULD.FLTSEQNUM(+)
				 AND SEGULD.FLTCARIDR = SELULD.FLTCARIDR(+)
				 AND

SEGULD.SEGSERNUM = SELULD.SEGSERNUM(+)

AND SEGULD.ULDNUM = SELULD.ULDNUM(+)
				 AND SEGULD.CMPCOD

= ULDSHP.CMPCOD(+)
				 AND SEGULD.FLTNUM
= ULDSHP.FLTNUM(+)
				 AND SEGULD.FLTSEQNUM = ULDSHP.FLTSEQNUM(+)


AND SEGULD.FLTCARIDR = ULDSHP.FLTCARIDR(+)

AND SEGULD.SEGSERNUM = ULDSHP.SEGSERNUM(+)
				 AND

SEGULD.ULDNUM = ULDSHP.ULDNUM(+)
				 AND ULDSHP.CMPCOD
= SHPMST.CMPCOD(+)
				 AND ULDSHP.DOCOWRIDR

= SHPMST.DOCOWRIDR(+)
				 AND ULDSHP.MSTDOCNUM = SHPMST.MSTDOCNUM(+)

AND ULDSHP.DUPNUM = SHPMST.DUPNUM(+)


				 AND ULDSHP.SEQNUM = SHPMST.SEQNUM(+)
				 AND SHPMST.CMPCOD
= ARPMST.CMPCOD(+)
				 AND SHPMST.DSTCOD

= ARPMST.ARPCOD(+)

				  AND SEGULD.ULDNUM = RMPULD.ULDNUM(+)

AND SEGULD.CMPCOD = RMPULD.CMPCOD(+)


AND SEGULD.FLTNUM = RMPULD.FLTNUM(+)
				 AND SEGULD.FLTSEQNUM
= RMPULD.FLTSEQNUM(+)
				 AND SEGULD.FLTCARIDR

= RMPULD.FLTCARIDR(+)


				 AND IMPFLT.CMPCOD = ?

AND IMPFLT.FLTSEQNUM = ?
				 AND IMPFLT.FLTCARIDR

= ?
				 AND IMPFLT.FLTNUM = ?
				 AND IMPFLT.ARPCOD = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>269</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.finduldlistdetails" Type="NATIVE">
			<![CDATA[

		    SELECT
		      SEGULD.ULDNUM ULDNUM,
		      SEGULD.FLTCARIDR FLTCARIDR,
		      SEGULD.FLTNUM


FLTNUM,
		      SEGULD.CMPCOD,
		      SELULD.CSDFLG,
		      SELULD.CSHFLG,
		      SELULD.HLEFLG,



		      SELULD.HNDCOD,
		      SELULD.INTFLG,
		      SELULD.NOOCVRFLG,
		      SELULD.PCHFLG,


		      SELULD.PLCCVRFLG,

		      SELULD.PLCDWSFLG,
		      SELULD.PLCUPSFLG,
		      SELULD.PLTNETFLG,


		      SELULD.ACTTMP,

		      SELULD.REQTMP,
		      SELULD.SELRMK,
		      SELULD.STPFLG,


		      SELULD.STPNUM,
		      SELULD.TRNFLG,

		      SELULD.TRPTYP,
		      SELULD.ULDDIS,


		      SELULD.ULDNAT,
		      SELULD.WODSPTFLG,
		      SELULD.WODSPTNUM,

		      RMPULD.RCVTIM


		    FROM
		      OPRARPIMPFLT IMPFLT,
		      OPRSEGULD SEGULD,
		      OPRSEGSELULD
SELULD,

WHSRMPULD
RMPULD,
		      OPRFLTSEG FLTSEG
		    WHERE
			 SEGULD.FLTNUM = SELULD.FLTNUM(+)


AND
SEGULD.FLTSEQNUM = SELULD.FLTSEQNUM(+)
		     AND SEGULD.FLTCARIDR = SELULD.FLTCARIDR(+)

AND
SEGULD.CMPCOD
= SELULD.CMPCOD(+)
		     AND SEGULD.ULDNUM = SELULD.ULDNUM (+)
		     AND SEGULD.SEGSERNUM

= SELULD.SEGSERNUM
(+)
		     AND SEGULD.CMPCOD = FLTSEG.CMPCOD
		     AND SEGULD.FLTNUM = FLTSEG.FLTNUM


AND SEGULD.FLTSEQNUM
= FLTSEG.FLTSEQNUM
		     AND SEGULD.FLTCARIDR = FLTSEG.FLTCARIDR
		     AND SEGULD.SEGSERNUM

= FLTSEG.SEGSERNUM

AND FLTSEG.CMPCOD = IMPFLT.CMPCOD
		     AND FLTSEG.FLTNUM = IMPFLT.FLTNUM


AND FLTSEG.FLTSEQNUM
= IMPFLT.FLTSEQNUM
		     AND FLTSEG.FLTCARIDR = IMPFLT.FLTCARIDR
		     AND FLTSEG.POU

= IMPFLT.ARPCOD

		     AND RMPULD.CMPCOD(+) = SEGULD.CMPCOD
		     AND RMPULD.FLTNUM(+) = SEGULD.FLTNUM


		     AND RMPULD.FLTCARIDR(+)
= SEGULD.FLTCARIDR
		     AND RMPULD.FLTSEQNUM(+) = SEGULD.FLTSEQNUM

AND
RMPULD.ULDNUM(+) = SEGULD.ULDNUM

		     AND IMPFLT.CMPCOD = ?
		     AND IMPFLT.FLTSEQNUM
= ?

AND IMPFLT.FLTCARIDR = ?
		     AND IMPFLT.FLTNUM
= ?
		     AND IMPFLT.ARPCOD = ?

AND IMPFLT.LEGSERNUM
= ?
		     AND RMPULD.ARPCOD(+) = ?

		     AND RMPULD.LEGSERNUM(+) = ?







			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>237</QRY:Id>
		<QRY:Source Name="operations.flthandling.manifest.findMaintainBuildupDetails" Type="NATIVE">
			<![CDATA[

						SELECT ULD.FLTNUM,ULD.FLTSEQNUM,ULD.ULDNUM,ULD.ULDHGT, ULD.ULDVOL,
								ULD.BDPCMPSTA, DWSULD.WGHCMPSTA,


DWSULD.DLVSTA, ULD.ULDOCP, ULD.RMK,
								BDP.SELONE,BDP.SELTWO,BDP.SELTHR,BDP.SELFOR,
								BDP.OVRFNT,BDP.OVRLFT,BDP.OVRRGT,BDP.OVRAFT,BDP.OVRDIRFLG,



								ACC.ACCCOD,ACC.ARLIDR,ACC.QTY

							FROM OPRSEGULD ULD
							INNER JOIN
							OPRSEGULDBDPDTL

BDP
ON
							ULD.CMPCOD = BDP.CMPCOD
							AND		ULD.FLTCARIDR=BDP.FLTCARIDR
							AND		ULD.FLTNUM=BDP.FLTNUM



							AND		ULD.FLTSEQNUM=BDP.FLTSEQNUM
							AND		ULD.ULDNUM=BDP.ULDNUM
							 LEFT OUTER JOIN OPRSEGULDBDPACC


ACC ON
							 BDP.CMPCOD=ACC.CMPCOD
							AND	BDP.FLTCARIDR=ACC.FLTCARIDR
							AND	BDP.FLTNUM=ACC.FLTNUM



							AND	BDP.FLTSEQNUM=ACC.FLTSEQNUM
							AND	BDP.ULDNUM=ACC.ULDNUM
							 LEFT
							OUTER JOIN

OPRFLTSEG
FLTSEG
							ON ULD.CMPCOD = FLTSEG.CMPCOD
							 AND ULD.FLTCARIDR = FLTSEG.FLTCARIDR


							 AND
ULD.FLTNUM = FLTSEG.FLTNUM
							 AND ULD.FLTSEQNUM = FLTSEG.FLTSEQNUM
							  LEFT

OUTER
JOIN
OPRDWSULD DWSULD
							ON ULD.CMPCOD = DWSULD.cmpcod
							 AND ULD.FLTCARIDR = DWSULD.FLTCARIDR



							 AND ULD.FLTNUM = DWSULD.FLTNUM
							 AND ULD.FLTSEQNUM = DWSULD.FLTSEQNUM
							 AND ULD.ULDNUM

=
DWSULD.ULDNUM
	 						AND FLTSEG.POU = DWSULD.POU
							WHERE
									ULD.FLTNUM = ?
							AND

ULD.FLTCARIDR
= ?
							AND		ULD.CMPCOD = ?
							AND		ULD.ULDNUM = ?
							AND		ULD.FLTSEQNUM = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>245</QRY:Id>
		<QRY:Source Name="operaions.flthandling.findalluldsinflight" Type="NATIVE">
			<![CDATA[

				SELECT SEGULD.CMPCOD, SEGULD.FLTCARIDR, SEGULD.FLTNUM, SEGULD.FLTSEQNUM, SEGULD.SEGSERNUM ,
					   SEGULD.ULDNUM, SEGULD.ULDSTA, SEGULD.BDPFLG, SEGULD.MFTFLG, SEGULD.RCVFLG,SEGULD.BDNCPLFLG
				FROM OPRSEGULD SEGULD
				WHERE
					SEGULD.CMPCOD = ?
					AND SEGULD.FLTCARIDR = ?
					AND SEGULD.FLTNUM = ?
		  			AND SEGULD.FLTSEQNUM = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>285</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.retrievetsaflightdetails" Type="NATIVE">
			<![CDATA[
  			SELECT	CMPCOD,FLTCARIDR,FLTNUM,SEQNUM,FLTFRQ,STRDAT,ENDDAT,RMK
  					FROM OPRTSAFLT
  					WHERE CMPCOD = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>286</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.flightfinalreport.findRawMaterialDetails" Type="NATIVE">
			<![CDATA[
				SELECT SEGACC.ACCCOD, SUM(SEGACC.QTY) QTY
				FROM OPRSEGULDBDPACC SEGACC,
					OPRARPEXPFLT FLT,


OPRFLTSEG FLTSEG
				WHERE SEGACC.CMPCOD = FLTSEG.CMPCOD
					AND SEGACC.FLTCARIDR = FLTSEG.FLTCARIDR



					AND SEGACC.FLTNUM = FLTSEG.FLTNUM
					AND SEGACC.FLTSEQNUM = FLTSEG.FLTSEQNUM
					AND SEGACC.SEGSERNUM


= FLTSEG.SEGSERNUM
					AND FLTSEG.CMPCOD = FLT.CMPCOD
					AND FLTSEG.FLTCARIDR = FLT.FLTCARIDR



AND FLTSEG.FLTNUM = FLT.FLTNUM
					AND FLTSEG.FLTSEQNUM = FLT.FLTSEQNUM
					AND FLTSEG.POL =
FLT.ARPCOD


AND FLT.CMPCOD = ?
					AND FLT.FLTCARIDR = ?
					AND FLT.FLTNUM = ?
					AND FLT.FLTSEQNUM
= ?


					AND FLT.LEGSERNUM = ?
					AND FLT.ARPCOD = ?
					AND SEGACC.ARLIDR = ?
				GROUP BY SEGACC.ACCCOD
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>333</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findcargohandlingchargesdetails" Type="NATIVE">
			<![CDATA[
			SELECT	PAYADV.SRVTYP,
			        CHDRAT.CHDCOD CHDCOD,
					SRVCHD.CHDNAM CHDNAM,
					CHDRAT.UNTCOD


UNTCOD,
					SUM(CHDRAT.QTY) QTY,
					MAX(CHDRAT.RAT) RAT,
					CHDRAT.RATTYP RATTYP,
					CHDRAT.SERNUM


SERNUM,
					SUM(CHDRAT.AMT) CHDAMT,
					SUM(SRVCHD.GSTAMT) GSTAMT,
					SUM(CHDRAT.AMT) CHDNETAMT




			FROM	CSHPAYADV PAYADV,
					CSHPAYADVSRV ADVSRV,
					CSHSRVCHD SRVCHD,
					CSHSRVCHDRAT CHDRAT




			WHERE	PAYADV.CMPCOD = ADVSRV.CMPCOD
					AND PAYADV.STNCOD = ADVSRV.STNCOD
					AND PAYADV.PAYADVNUM


= ADVSRV.PAYADVNUM

					AND SRVCHD.CMPCOD = CHDRAT.CMPCOD
					AND SRVCHD.STNCOD = CHDRAT.STNCOD



AND SRVCHD.PAYADVNUM = CHDRAT.PAYADVNUM
					AND SRVCHD.SRVCOD = CHDRAT.SRVCOD
					AND SRVCHD.CHDCOD


= CHDRAT.CHDCOD

					AND ADVSRV.CMPCOD = SRVCHD.CMPCOD
					AND ADVSRV.STNCOD = SRVCHD.STNCOD


					AND
ADVSRV.PAYADVNUM = SRVCHD.PAYADVNUM
					AND ADVSRV.SRVCOD = SRVCHD.SRVCOD
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>300</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.printarrivaldailyreport" Type="NATIVE">
			<![CDATA[
			SELECT OPR.INTWGT,
			  OPR.INTULDCNT,
			  OPR.INTAWBCNT,
			  OPR.FLTNUM,
			  OPR.CARIDR,



			  FLT.FLTSEQNUM,
			  OPR.LSEPCS,
			  OPR.LSEWGT,
			  OPR.LSECNT,
			  CASE
			    WHEN FLT.FLTTYP

IN
('C','CO')
			    THEN 'C'
			    ELSE 'T'
			  END NEWFLTTYP,
			  OPR.CGOCAT,
			  OPR.CGOTYP,



			  FLT.FLTTYP,
			  FLT.FLTDAT,
			  FNLSUM.ACRTYP
				FROM OPRFLTFNLSHPDTA OPR,
					FLTOPRMST FLT,OPRFLTFNLSUM


FNLSUM,
					SHRARLMST ARL
						WHERE FNLSUM.CMPCOD=OPR.CMPCOD

							 AND FNLSUM.ARPCOD=OPR.ARPCOD



							 AND FNLSUM.CARIDR=OPR.CARIDR
							 AND FNLSUM.FLTNUM=OPR.FLTNUM
							 AND FNLSUM.FLTSEQNUM=OPR.FLTSEQNUM



							 AND FNLSUM.LEGSERNUM=OPR.LEGSERNUM

							 AND FLT.CMPCOD = OPR.CMPCOD
							 AND FLT.FLTNUM

= OPR.FLTNUM

							 AND FLT.FLTSEQNUM = OPR.FLTSEQNUM
							 AND FLT.FLTCARIDR = OPR.CARIDR


							 AND FLT.BLGARL IS NOT
NULL
							 AND OPR.CMPCOD = ?
							 AND OPR.ARPCOD = ?
							 AND
FNLSUM.FLTDIR=?

							 AND FNLSUM.SALDAT
BETWEEN ? AND ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>301</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.printarrivalservicedetails" Type="NATIVE">
			<![CDATA[
				SELECT	CHDRAT.CHDCOD CHDCOD,
						TRFMST.CHDDES CHDDES,
						CHDRAT.UNTCOD UNTCOD,
						SUM(CHDRAT.QTY)


QTY,
						MAX(CHDRAT.RAT) RAT,
						SUM(CHDRAT.AMT) AMT,
						 CHDRAT.RATTYP RATTYP


				FROM	CSHPAYADV


PAYADV,
						CSHPAYADVSRV ADVSRV,
						CSHSRVCHD SRVCHD,
						CSHSRVCHDRAT CHDRAT,
						SHRARLMST


ARLMST,
						TRFCHDMST TRFMST

				WHERE	PAYADV.CMPCOD = ADVSRV.CMPCOD
						AND PAYADV.STNCOD = ADVSRV.STNCOD



						AND PAYADV.PAYADVNUM = ADVSRV.PAYADVNUM

						AND SRVCHD.CMPCOD = CHDRAT.CMPCOD
						AND SRVCHD.STNCOD


= CHDRAT.STNCOD
						AND SRVCHD.PAYADVNUM = CHDRAT.PAYADVNUM
						AND SRVCHD.SRVCOD = CHDRAT.SRVCOD

AND

SRVCHD.CHDCOD = CHDRAT.CHDCOD

						AND ADVSRV.CMPCOD = SRVCHD.CMPCOD
						AND ADVSRV.STNCOD =
SRVCHD.STNCOD


						AND ADVSRV.PAYADVNUM = SRVCHD.PAYADVNUM
						AND ADVSRV.SRVCOD = SRVCHD.SRVCOD

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>302</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.printarrivalrawmaterialsdetails" Type="NATIVE">
			<![CDATA[
				SELECT	ACSMST.ACSNAM ACSNAM,
						CHDRAT.UNTCOD UNTCOD,
						SUM(CHDRAT.QTY) QTY,
						MAX(CHDRAT.RAT)


RAT,
						SUM(CHDRAT.AMT) AMT,
						 CHDRAT.RATTYP RATTYP

				FROM	CSHPAYADV PAYADV,
						CSHPAYADVSRV


ADVSRV,
						CSHSRVCHD SRVCHD,
						CSHSRVCHDRAT CHDRAT,
						SHRARLMST ARLMST,
						SHRACSMST
ACSMST



				WHERE	PAYADV.CMPCOD = ADVSRV.CMPCOD
						AND PAYADV.STNCOD = ADVSRV.STNCOD
						AND
PAYADV.PAYADVNUM

= ADVSRV.PAYADVNUM

						AND SRVCHD.CMPCOD = CHDRAT.CMPCOD
						AND SRVCHD.STNCOD
= CHDRAT.STNCOD


AND SRVCHD.PAYADVNUM = CHDRAT.PAYADVNUM
						AND SRVCHD.SRVCOD = CHDRAT.SRVCOD

AND SRVCHD.CHDCOD

= CHDRAT.CHDCOD

						AND ADVSRV.CMPCOD = SRVCHD.CMPCOD
						AND ADVSRV.STNCOD
= SRVCHD.STNCOD


						AND ADVSRV.PAYADVNUM = SRVCHD.PAYADVNUM
						AND ADVSRV.SRVCOD = SRVCHD.SRVCOD
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>281</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findETDSReportDetails" Type="NATIVE">
			<![CDATA[
               SELECT	SEGSHP.MSTDOCNUM MSTDOCNUM,
						SEGSHP.SHPPFX SHPPFX,
						ARPSHP.ETDINSPCS


QTY

			    FROM	OPRARPEXPFLT EXPFLT,
						OPRSEGSHP SEGSHP,
						OPRARPSHP ARPSHP,
						OPRFLTSEG


FLTSEG

			    WHERE	EXPFLT.CMPCOD = ?
						AND EXPFLT.ARPCOD = ?
						AND EXPFLT.FLTNUM = ?



						AND EXPFLT.FLTCARIDR = ?
						AND EXPFLT.FLTSEQNUM = ?
						AND EXPFLT.LEGSERNUM = ?

AND
ARPSHP.ARPCOD
= ?

						AND FLTSEG.POL = EXPFLT.ARPCOD
						AND FLTSEG.FLTNUM = EXPFLT.FLTNUM


AND FLTSEG.FLTCARIDR
= EXPFLT.FLTCARIDR
						AND FLTSEG.FLTSEQNUM = EXPFLT.FLTSEQNUM
						AND FLTSEG.CMPCOD

= EXPFLT.CMPCOD


AND SEGSHP.FLTNUM = FLTSEG.FLTNUM
						AND SEGSHP.FLTCARIDR = FLTSEG.FLTCARIDR


AND SEGSHP.FLTSEQNUM
= FLTSEG.FLTSEQNUM
						AND SEGSHP.SEGSERNUM = FLTSEG.SEGSERNUM
						AND SEGSHP.CMPCOD

= FLTSEG.CMPCOD


AND ARPSHP.MSTDOCNUM = SEGSHP.MSTDOCNUM
						AND ARPSHP.DOCOWRIDR = SEGSHP.DOCOWRIDR


						AND ARPSHP.DUPNUM
= SEGSHP.DUPNUM
						AND ARPSHP.SEQNUM = SEGSHP.SEQNUM
						AND ARPSHP.CMPCOD
=
SEGSHP.CMPCOD

						AND ARPSHP.ETDINSPCS > 0

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>237</QRY:Id>
		<QRY:Source Name="operations.flthandling.findbuiltupdetailsforshipment" Type="NATIVE">
			<![CDATA[
				SELECT   ULD.FLTCARIDR, ULD.FLTNUM, ULD.FLTSEQNUM, ULD.SEGSERNUM, ULD.CMPCOD,
						 ULD.ULDNUM,


ULD.DOCOWRIDR, ULD.MSTDOCNUM, ULD.DUPNUM, ULD.SEQNUM,
					     ULD.BDPPCS, ULD.BDPWGT, ULD.BDPVOL,

ULD.MFTPCS,
ULD.MFTWGT,  ULD.MFTVOL, SHP.ARPCOD
				FROM 	OPRSEGULDSHP ULD , OPRARPSHP SHP
				WHERE

ULD.CMPCOD
= SHP.CMPCOD
						AND ULD.MSTDOCNUM = SHP.MSTDOCNUM
						AND ULD.DOCOWRIDR = SHP.DOCOWRIDR


						AND
ULD.DUPNUM = SHP.DUPNUM
						AND ULD.SEQNUM = SHP.SEQNUM
						AND ULD.MFTPCS = 0

AND SHP.CMPCOD

= ?
						AND SHP.MSTDOCNUM = ?
						AND SHP.DOCOWRIDR = ?
						AND SHP.DUPNUM = ?

AND SHP.SEQNUM

= ?
						AND SHP.ARPCOD =  ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>233</QRY:Id>
		<QRY:Source Name="operations.flthandling.finduldsformanifestedshipments" Type="NATIVE">
			<![CDATA[
					SELECT   ULD.ADDSCC ,ULD.BDPPCS ULDBDPPCS, ULD.BDPWGT ULDBDPWGT, ULD.BDPVOL ULDBDPVOL,
							 ULD.MFTPCS


ULDMFTPCS, ULD.MFTWGT ULDMFTWGT, ULD.MFTVOL ULDMFTVOL,
						ULD.ULDNUM, SEG.FLTSEQNUM,MST.MSTDOCNUM,


MST.DOCOWRIDR, MST.DUPNUM,
						 MST.SEQNUM, MST.ORGCOD, MST.DSTCOD,
						 MST.EXEFLG, MST.SHPPFX,


SHP.BDPPCS,
						 SHP.BDPWGT, SHP.BDPVOL, SHP.MFTPCS,
						 SHP.MFTWGT, SHP.MFTVOL, HSE.PCS HSEPCS,



						 HSE.WGT HSEWGT, MST.CONFLG CONFLG,
						 MST.CNSCOD CNSCOD, MST.CNSNAM CNSNAM,
						 MST.SHPCOD

SHPCOD,
MST.SHPNAM SHPNAM,
						 MST.SCCCOD SCCCOD, HSE.DOCNUM,HSE.SEQNUM HSESEQNUM,
						 MIS.AGTUNQIDR,

HSE.TXNREFTHR,
HSE.TXNREFFIV,
						 HSE.TXNREFFOR, HSE.TXNREFTWO,
						 HSE.TXNREFONE
					    FROM

OPRSHPMST MST,

						 OPRSEGSHP SHP,
						 OPRFLTSEG SEG,
						 OPRTXNHSE HSE,
						 OPRSHPMSTMIS

MIS,
						 OPRSEGULDSHP
ULD
					   WHERE SHP.FLTCARIDR = SEG.FLTCARIDR
					     AND SHP.FLTNUM =

SEG.FLTNUM
					     AND SHP.FLTSEQNUM
= SEG.FLTSEQNUM
					     AND SHP.CMPCOD = SEG.CMPCOD


					     AND SHP.SEGSERNUM = SEG.SEGSERNUM

AND MST.CMPCOD = SHP.CMPCOD
					     AND MST.MSTDOCNUM

= SHP.MSTDOCNUM
					     AND MST.DOCOWRIDR =
SHP.DOCOWRIDR
					     AND MST.DUPNUM = SHP.DUPNUM


					     AND MST.CMPCOD = HSE.CMPCOD(+)

					     AND MST.DOCOWRIDR = HSE.DOCOWRIDR(+)

AND
MST.MSTDOCNUM = HSE.MSTDOCNUM(+)
					     AND MST.DUPNUM
= HSE.DUPNUM(+)
					     AND MST.SEQNUM
=
HSE.SEQNUM(+)
					     AND MST.CMPCOD = MIS.CMPCOD

					     AND MST.DOCOWRIDR = MIS.DOCOWRIDR


AND MST.MSTDOCNUM = MIS.MSTDOCNUM
					     AND MST.DUPNUM
= MIS.DUPNUM
					     AND MST.SEQNUM =
MIS.SEQNUM

					     AND SHP.FLTCARIDR = ULD.FLTCARIDR

					     AND SHP.FLTNUM
= ULD.FLTNUM
					     AND SHP.FLTSEQNUM
= ULD.FLTSEQNUM
					     AND SHP.CMPCOD = ULD.CMPCOD


					     AND SHP.SEGSERNUM = ULD.SEGSERNUM

					     AND SHP.MSTDOCNUM = ULD.MSTDOCNUM

AND SHP.DOCOWRIDR
= ULD.DOCOWRIDR
					     AND SHP.DUPNUM
= ULD.DUPNUM
					     AND SHP.SEQNUM =
ULD.SEQNUM

					     AND SHP.BDPPCS > 0

					     AND SEG.CMPCOD = ?

AND SEG.FLTCARIDR = ?
					     AND SEG.FLTNUM
= ?
					     AND SEG.FLTSEQNUM
= ?
					     AND SEG.POL
= ?
					     AND HSE.TXNCOD(+) = 'MFT'

						AND HSE.TXNREFTWO(+) =?

						AND HSE.TXNREFTHR(+)
= ?
						AND HSE.TXNREFFIV(+) = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>319</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findManifestedShipmentsInUld" Type="NATIVE">
			<![CDATA[
 						SELECT shpmst.cmpcod,
					  shpmst.mstdocnum,
					  shpmst.docowridr,
					  shpmst.dupnum,



					  shpmst.shppfx,
					  shpmst.seqnum,
					  fltseg.fltnum,
					  fltseg.fltseqnum,
					  fltseg.fltcaridr,



					  fltseg.pol,
					  fltseg.pou,
					  fltmst.extncsfltcaridr,
					  fltmst.extncsfltnum,


					  fltmst.extncsfltdat,

					  fltmst.extncscarcod,
					  shpmst.stdpcs,
					  shpmst.stdwgt,


					  segshp.mftpcs,
					  segshp.mftwgt,

					  segshp.bdppcs,
					  segshp.bdpwgt,

segshp.segsernum,

					  arpshp.bdppcs totbdppcs,

					  /*ldrdtl.itnflg,*/
					  arpshp.bdpwgt
totbdpwgt,
					  SUM(ldrshp.ldrpcs)
ldrpcs,
					  SUM(ldrshp.ldrwgt)
ldrwgt,
					  /*ldrdtl.src,*/

(
					CASE
					WHEN  shpmst.CONFLG
='N' THEN SUM(ldrshp.ncspcs)

					ELSE max(ldrshp.ncspcs)

END) ncspcs,
					  (
					CASE

					WHEN  SHPMST.CONFLG ='N' THEN SUM(ldrshp.ncswgt)


ELSE max(ldrshp.ncswgt)
					END) ncswgt,

					  segselshp.flisndsta flista
					FROM oprshpmst
shpmst

					INNER JOIN oprsegshp segshp ON shpmst.mstdocnum
= segshp.mstdocnum
					 AND shpmst.docowridr
= segshp.docowridr

					 AND shpmst.dupnum = segshp.dupnum

					 AND shpmst.seqnum = segshp.seqnum

AND shpmst.cmpcod = segshp.cmpcod

					INNER JOIN oprfltseg
fltseg ON segshp.fltnum = fltseg.fltnum

AND segshp.fltseqnum = fltseg.fltseqnum

					 AND
segshp.fltcaridr = fltseg.fltcaridr
					 AND
segshp.segsernum = fltseg.segsernum
					 AND segshp.cmpcod

= fltseg.cmpcod
					LEFT OUTER JOIN oprldrshp
ldrshp ON shpmst.mstdocnum = ldrshp.mstdocnum
					 AND

shpmst.docowridr = ldrshp.docowridr
					 AND
shpmst.dupnum = ldrshp.dupnum
					 AND shpmst.seqnum
=
ldrshp.seqnum
					 AND shpmst.cmpcod = ldrshp.cmpcod


LEFT OUTER JOIN oprldrdtl ldrdtl ON ldrdtl.ldrnum

= ldrshp.ldrnum
					 AND ldrdtl.cmpcod = ldrshp.cmpcod

INNER JOIN oprarpexpflt expflt ON fltseg.fltnum

= expflt.fltnum
					 AND fltseg.fltseqnum = expflt.fltseqnum

AND fltseg.fltcaridr = expflt.fltcaridr


					 AND fltseg.pol = expflt.arpcod
					 AND fltseg.cmpcod
= expflt.cmpcod

					INNER JOIN fltoprmst
fltmst
ON segshp.fltnum = fltmst.fltnum
					 AND segshp.fltseqnum
= fltmst.fltseqnum
					 AND segshp.fltcaridr

= fltmst.fltcaridr
					 AND segshp.cmpcod = fltmst.cmpcod


INNER JOIN oprarpshp arpshp ON segshp.mstdocnum

= arpshp.mstdocnum
					 AND segshp.dupnum = arpshp.dupnum

AND segshp.docowridr = arpshp.docowridr


					 AND segshp.seqnum = arpshp.seqnum
					 AND segshp.cmpcod
= arpshp.cmpcod
					 AND fltseg.pol
= arpshp.arpcod


					 LEFT
					OUTER JOIN oprsegselshp
segselshp ON segshp.cmpcod = segselshp.cmpcod

					 AND segshp.fltnum
= segselshp.fltnum

AND segshp.mstdocnum = segselshp.mstdocnum
					 AND segshp.docowridr
= segselshp.docowridr


AND segshp.fltcaridr = segselshp.fltcaridr
					 AND segshp.fltseqnum
= segselshp.fltseqnum
					 AND

segshp.segsernum = segselshp.segsernum
					 AND segshp.seqnum = segselshp.seqnum

					 AND segshp.dupnum

= segselshp.dupnum

					WHERE fltmst.extncsfltnum = ?
					AND fltseg.fltseqnum =
?
					AND fltseg.fltcaridr

= ?
					AND fltseg.cmpcod = ?
					AND(segselshp.flisndsta NOT IN('Y',
'S') OR segselshp.flisndsta

IS NULL)

					GROUP BY shpmst.cmpcod,
					  shpmst.mstdocnum,
					  shpmst.docowridr,


shpmst.dupnum,

					  shpmst.seqnum,
					  fltseg.fltnum,
					  fltseg.fltseqnum,
					  fltseg.fltcaridr,


					  fltseg.pou,

					  shpmst.stdpcs,
					  shpmst.shppfx,
					  shpmst.stdwgt,

segshp.mftpcs,

					  segshp.mftwgt,

					  segshp.bdppcs,
					  segshp.bdpwgt,

fltmst.extncsfltcaridr,

					  fltmst.extncsfltnum,

					  fltmst.extncsfltdat,

fltmst.extncscarcod,
					  fltseg.pol,

					  arpshp.bdppcs,
					  arpshp.bdpwgt,


segshp.segsernum,
					  segselshp.flisndsta,

					   /*ldrdtl.itnflg,
					  ldrdtl.src,*/SHPMST.CONFLG

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>335</QRY:Id>
		<QRY:Source Name="operations.flthandling.manifest.findhousedetailsforloadplanreflist" Type="NATIVE">
			<![CDATA[
	  		 SELECT MST.CMPCOD,
			  MST.MSTDOCNUM,
			  MST.DOCOWRIDR,
			  MST.SEQNUM,
			  MST.DUPNUM,



			  MAX(MST.STDPCS) STDPCS,
			  MAX(MST.STDWGT) STDWGT,
			  SUM(
				CASE HSE.TXNCOD
				WHEN 'ACP'

THEN
PCS
				WHEN 'SMU' THEN PCS
				ELSE 0
				END) ACPPCS,
				SUM(
				CASE HSE.TXNCOD
				WHEN
'ACP'
THEN
WGT
				WHEN 'SMU' THEN WGT
				ELSE 0
				END) ACPWGT,
				SUM(
				CASE HSE.TXNCOD

WHEN 'REL'
THEN
PCS
				ELSE 0
				END) LDPPCS,
				SUM(
				CASE HSE.TXNCOD
				WHEN 'REL' THEN WGT

ELSE 0

				END)
LDPWGT,
				MST.DOCNUM

			FROM OPRSHPMST MST LEFT
			OUTER JOIN OPRTXNHSE HSE
ON

			(MST.CMPCOD
= HSE.CMPCOD

			 AND MST.MSTDOCNUM = HSE.MSTDOCNUM
			 AND MST.DOCOWRIDR = HSE.DOCOWRIDR

AND
MST.DUPNUM = HSE.DUPNUM

			 AND MST.SEQNUM = HSE.SEQNUM
			 AND HSE.ARPCOD = ?)

			 AND((HSE.TXNREFTWO

= ?
			 AND HSE.TXNREFTHR
= ?
			 AND HSE.TXNREFFIV = ?
			 AND HSE.TXNREFSIX = ?

			 AND HSE.TXNCOD

= 'REL') OR(HSE.TXNCOD IN('ACP',
'SMU')))
			WHERE MST.CMPCOD = ?
			 AND MST.MSTDOCNUM = ?
			 AND

MST.DOCOWRIDR = ?
			 AND MST.DUPNUM
= ?
			 AND MST.PARSEQNUM = 1
			GROUP BY MST.CMPCOD,   MST.MSTDOCNUM,

MST.DOCOWRIDR,   MST.SEQNUM,
MST.DUPNUM,   MST.DOCNUM


			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>339</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findhousesinuldfortempoffload" Type="NATIVE">
			<![CDATA[

		SELECT MST.CMPCOD,
		  MST.MSTDOCNUM,
		  MST.DOCOWRIDR,
		  MST.SEQNUM,
		  MST.DUPNUM,
		  MAX(MST.STDPCS)


STDPCS,
		  MAX(MST.STDWGT) STDWGT,
		  MST.DOCNUM,
		  HSE.ARPCOD,
		  SUM(
		CASE
		WHEN HSE.TXNCOD


= 'MFT' THEN PCS
		ELSE 0
		END) MFTPCS,
		  SUM(
		CASE
		WHEN HSE.TXNCOD = 'MFT' THEN WGT
		ELSE
0


		END) MFTWGT,
		  SUM(
		CASE
		WHEN HSE.TXNCOD = 'LDP' THEN PCS
		ELSE 0
		END) LDPPCS,
		  SUM(


		CASE

		WHEN HSE.TXNCOD = 'LDP' THEN WGT
		ELSE 0
		END) LDPWGT,
		SUM(
		CASE
		WHEN HSE.TXNCOD
=
'LDP' THEN
SERNUM
		ELSE 0
		END) SERNUM,
		  SUM(
		CASE
		WHEN HSE.TXNCOD IN('ACP',   'BDP') THEN

PCS
		ELSE 0

		END) ACPPCS,
		  SUM(
		CASE
		WHEN HSE.TXNCOD IN('ACP',   'BDP') THEN WGT
		ELSE
0

		END) ACPWGT
		FROM
OPRSHPMST MST
		INNER JOIN OPRSEGULDSHP ULDSHP ON MST.CMPCOD = ULDSHP.CMPCOD

AND
MST.MSTDOCNUM = ULDSHP.MSTDOCNUM

		 AND MST.DOCOWRIDR = ULDSHP.DOCOWRIDR
		INNER JOIN OPRTXNHSE
HSE
ON(MST.CMPCOD = HSE.CMPCOD
		 AND MST.MSTDOCNUM
= HSE.MSTDOCNUM
		 AND MST.DOCOWRIDR = HSE.DOCOWRIDR


AND MST.DUPNUM = HSE.DUPNUM
		 AND MST.SEQNUM
= HSE.SEQNUM
		 AND HSE.ARPCOD = ?)
		 AND((HSE.TXNREFTWO

= ULDSHP.FLTCARIDR
		 AND HSE.TXNREFTHR = ULDSHP.FLTNUM

		 AND HSE.TXNREFFIV = ULDSHP.FLTSEQNUM


		 AND HSE.TXNREFSIX = ?
		 AND HSE.TXNCOD = 'LDP') OR(HSE.TXNREFTWO
= ULDSHP.FLTCARIDR
		 AND HSE.TXNREFTHR

= ULDSHP.FLTNUM
		 AND HSE.TXNREFFIV = ULDSHP.FLTSEQNUM
		 AND
HSE.TXNREFSIX = ULDSHP.ULDNUM
		 AND

HSE.TXNCOD = 'MFT') OR(HSE.TXNCOD IN('ACP',   'BDP')
		 AND(HSE.CMPCOD,
HSE.ARPCOD,   HSE.TXNREFSIX)

IN
		  (SELECT CMPCOD,    SEGORG,    ULDNUM
		   FROM OPRLODPLNULD LODULD

		   WHERE LODULD.CMPCOD

= ULDSHP.CMPCOD
		   AND LODULD.FLTCARIDR = ULDSHP.FLTCARIDR
		   AND LODULD.FLTNUM
= ULDSHP.FLTNUM


		   AND LODULD.FLTSEQNUM = ULDSHP.FLTSEQNUM
		   AND LODULD.SEGSERNUM = ULDSHP.SEGSERNUM


AND LODULD.ULDNUM
= ULDSHP.ULDNUM)))
		WHERE MST.PARSEQNUM = 1
		 AND ULDSHP.CMPCOD = ?
		 AND ULDSHP.FLTCARIDR

= ?

		 AND ULDSHP.FLTNUM = ?
		 AND ULDSHP.FLTSEQNUM = ?
		 AND ULDSHP.ULDNUM = ?

		GROUP BY MST.CMPCOD,



		  MST.MSTDOCNUM,
		  MST.DOCOWRIDR,
		  MST.SEQNUM,
		  MST.DUPNUM,
		  MST.DOCNUM,
		  HSE.ARPCOD




	  ORDER BY MST.CMPCOD,
			  MST.MSTDOCNUM,
			  MST.DOCOWRIDR,
			  MST.SEQNUM,
			  MST.DUPNUM,
			  MST.DOCNUM

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>354</QRY:Id>
		<QRY:Source Name="operaions.flthandling.cto.findbuiltupshipmentsinflight" Type="NATIVE">
			<![CDATA[
					    SELECT
					    SHPMST.CMPCOD,
					    SHPMST.DUPNUM,
					    SHPMST.SEQNUM,
					    SHPMST.ORGCOD,



					    SHPMST.DSTCOD,
					    SHPMST.STDPCS,
					    SHPMST.STDWGT,
					    SHPMST.DOCOWRIDR,


					    SHPMST.MSTDOCNUM,

					    SHPMST.SHPPFX,
					    SEGSHP.FLTNUM,
					    SEGSHP.MFTPCS,


					    SEGSHP.MFTWGT,
					    SEGSHP.FLTCARIDR,

					    SEGSHP.FLTSEQNUM,
					    SEGSHP.SEGSERNUM,


					    TXNHSE.DOCNUM,
					    TXNHSE.PCS HSEPCS,

						TXNHSE.DOCOWRIDR TXNDOCOWRIDR,

TXNHSE.SEQNUM
TXNSEQNUM,
						TXNHSE.SERNUM TXNSERNUM,
						TXNHSE.DUPNUM
TXNDUPNUM,
					    TXNHSE.WGT
HSEWGT,

					    SELSHP.FWBSNDSTA,
					    SELSHP.CLA01STA,

					    SELSHP.FLISNDSTA,

TXNHSE.FHLSNDSTA,

					    EXPFLT.FFMSNDSTA,
					    EXPFLT.CLESNDSTA,


EXPFLT.SPLSNDSTA,
					    EXPFLT.ULTSNDSTA,

					    EXPFLT.CBASNDSTA,
					    TXNHSE.TXNCOD,


					    FLTSEG.POL,
					    FLTSEG.POU,
						FLTMST.EXTNCSCARCOD,

						FLTMST.EXTNCSFLTCARIDR,

FLTMST.EXTNCSFLTNUM,

						FLTMST.EXTNCSFLTDAT

						FROM

						OPRFLTSEG FLTSEG,

OPRSEGSHP SEGSHP,
					    OPRARPEXPFLT
EXPFLT,
					    OPRSHPMST SHPMST,

					    OPRTXNHSE
TXNHSE,
					    OPRSEGSELSHP SELSHP,
						FLTOPRMST
FLTMST

						WHERE  FLTSEG.FLTNUM =
SEGSHP.FLTNUM

AND FLTSEG.FLTCARIDR = SEGSHP.FLTCARIDR

					    AND FLTSEG.FLTSEQNUM
= SEGSHP.FLTSEQNUM

AND FLTSEG.CMPCOD = SEGSHP.CMPCOD
					    AND FLTSEG.SEGSERNUM
= SEGSHP.SEGSERNUM



AND EXPFLT.FLTNUM
= FLTSEG.FLTNUM
					    AND EXPFLT.FLTCARIDR = FLTSEG.FLTCARIDR

AND EXPFLT.FLTSEQNUM
= FLTSEG.FLTSEQNUM

AND EXPFLT.CMPCOD = FLTSEG.CMPCOD
					    AND EXPFLT.ARPCOD
= FLTSEG.POL


						AND EXPFLT.FLTNUM
= FLTMST.FLTNUM
						AND EXPFLT.FLTCARIDR = FLTMST.FLTCARIDR

						AND EXPFLT.CMPCOD
= FLTMST.CMPCOD

AND EXPFLT.FLTSEQNUM = FLTMST.FLTSEQNUM

					    AND SHPMST.MSTDOCNUM
= SEGSHP.MSTDOCNUM


AND SHPMST.DOCOWRIDR = SEGSHP.DOCOWRIDR
					    AND SHPMST.DUPNUM = SEGSHP.DUPNUM

AND SHPMST.CMPCOD

= SEGSHP.CMPCOD
					    AND SHPMST.SEQNUM = SEGSHP.SEQNUM

					    AND SEGSHP.MSTDOCNUM
= TXNHSE.MSTDOCNUM(+)


					    AND SEGSHP.DOCOWRIDR = TXNHSE.DOCOWRIDR(+)
					    AND SEGSHP.DUPNUM
= TXNHSE.DUPNUM(+)

AND
SEGSHP.CMPCOD = TXNHSE.CMPCOD(+)
					    AND SEGSHP.FLTCARIDR = TXNHSE.TXNREFTWO(+)



					    AND SEGSHP.FLTNUM = TXNHSE.TXNREFTHR(+)


					    AND SEGSHP.FLTNUM = SELSHP.FLTNUM(+)

AND

SEGSHP.FLTCARIDR = SELSHP.FLTCARIDR(+)
					    AND SEGSHP.FLTSEQNUM = SELSHP.FLTSEQNUM(+)


					    AND
SEGSHP.SEGSERNUM = SELSHP.SEGSERNUM(+)

					    AND SEGSHP.MSTDOCNUM = SELSHP.MSTDOCNUM(+)



AND SEGSHP.DOCOWRIDR = SELSHP.DOCOWRIDR(+)
					    AND SEGSHP.DUPNUM = SELSHP.DUPNUM(+)
					    AND


SEGSHP.CMPCOD = SELSHP.CMPCOD(+)
					    AND SEGSHP.SEQNUM = SELSHP.SEQNUM(+)

					    AND TXNHSE.TXNCOD(+)


= 'MFT'
					    AND TXNHSE.ARPCOD(+) = ?
					    AND FLTSEG.FLTNUM = ?
					    AND FLTSEG.FLTCARIDR


= ?
					    AND FLTSEG.FLTSEQNUM = ?
					    AND FLTSEG.CMPCOD = ?
					    AND FLTSEG.POL = ?



	                                    ORDER BY REVERSE(SHPMST.MSTDOCNUM)
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>287</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.flightfinalreport.findServiceDetails" Type="NATIVE">
			<![CDATA[
						SELECT 'DG' SVCTYPIDR, COUNT(SEGSHP.MSTDOCNUM) AWBCNT
						FROM OPRARPEXPFLT FLT, OPRFLTSEG FLTSEG,


OPRSEGSHP SEGSHP, OPRSHPMST SHPMST,
							SHRSCCMST SCCMST
						WHERE SEGSHP.MSTDOCNUM = SHPMST.MSTDOCNUM



							AND SHPMST.SCCCOD = SCCMST.SCCCOD
							AND SCCMST.DGRIND = 'Y'

							AND SEGSHP.CMPCOD =

FLTSEG.CMPCOD

							AND SEGSHP.FLTCARIDR = FLTSEG.FLTCARIDR
							AND SEGSHP.FLTNUM = FLTSEG.FLTNUM


AND SEGSHP.FLTSEQNUM
= FLTSEG.FLTSEQNUM
							AND SEGSHP.SEGSERNUM = FLTSEG.SEGSERNUM

							AND
FLTSEG.CMPCOD
= FLT.CMPCOD

AND FLTSEG.FLTCARIDR = FLT.FLTCARIDR
							AND FLTSEG.FLTNUM = FLT.FLTNUM


AND FLTSEG.FLTSEQNUM
= FLT.FLTSEQNUM
							AND FLTSEG.POL = FLT.ARPCOD

							AND FLT.CMPCOD = ?


AND FLT.FLTCARIDR
= ?
							AND FLT.FLTNUM = ?
							AND FLT.FLTSEQNUM = ?
							AND FLT.LEGSERNUM

= ?
							AND FLT.ARPCOD = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>381</QRY:Id>
		<QRY:Source Name="operaions.flthandling.findmanifestdetailsforlegs" Type="NATIVE">
			<![CDATA[

					 SELECT COUNT(MTKMST.CONNUM) MTKULD,
						  COUNT(SEGULD.ULDNUM) CGOULD      ,
						  SUM(SEGSHP.MFTPCS)


MFTPCS        ,
						  SUM(SEGSHP.BDPPCS) BDPPCS        ,
						  SUM(SEGSHP.PLNPCS) PLNPCS

,

						  SUM(SEGSHP.RCVPCS) RCVPCS        ,
						  (
						  CASE
						    WHEN SUM(SEGSHP.MFTPCS)

> 0

						    OR SUM(SEGSHP.BDPPCS)   > 0
						    OR SUM(SEGSHP.PLNPCS)   > 0


						    OR SUM(SEGSHP.RCVPCS)   >
0
						    OR COUNT(MTKMST.CONNUM) > 0
						    OR COUNT(SEGULD.ULDNUM)

> 0
						    THEN 'Y'

						    ELSE 'N'
						  END) MFTSTA      ,
						  FLTSEG.SEGORG

POL,
						  FLTSEG.SEGDST POU
						   FROM
FLTOPRSEG FLTSEG
						INNER JOIN FLTOPRLEG FLTLEG


						     ON FLTSEG.FLTCARIDR = FLTLEG.FLTCARIDR

						AND FLTSEG.FLTNUM        = FLTLEG.FLTNUM

AND
FLTSEG.FLTSEQNUM     = FLTLEG.FLTSEQNUM
						AND
FLTSEG.CMPCOD        = FLTLEG.CMPCOD
						AND
FLTSEG.SEGORG
= FLTLEG.LEGORG
						AND FLTSEG.SEGSTA
<> 'D'
						LEFT OUTER JOIN OPRSEGSHP
SEGSHP

						     ON FLTSEG.FLTCARIDR = SEGSHP.FLTCARIDR

						AND FLTSEG.FLTNUM
= SEGSHP.FLTNUM
						AND
FLTSEG.FLTSEQNUM     = SEGSHP.FLTSEQNUM
						AND
FLTSEG.CMPCOD        =
SEGSHP.CMPCOD
						AND FLTSEG.SEGSERNUM
= SEGSHP.SEGSERNUM
						LEFT OUTER
JOIN MALFLTCON MTKMST

ON FLTSEG.FLTCARIDR = MTKMST.FLTCARIDR

						AND FLTSEG.FLTNUM
= MTKMST.FLTNUM
						AND
FLTSEG.FLTSEQNUM     = MTKMST.FLTSEQNUM
						AND
FLTSEG.CMPCOD        = MTKMST.CMPCOD


AND FLTSEG.SEGSERNUM     = MTKMST.SEGSERNUM
						LEFT
OUTER JOIN OPRSEGULD SEGULD
						     ON FLTSEG.FLTCARIDR

= SEGULD.FLTCARIDR
						AND FLTSEG.FLTNUM
= SEGULD.FLTNUM
						AND FLTSEG.FLTSEQNUM     =
SEGULD.FLTSEQNUM

AND FLTSEG.CMPCOD        = SEGULD.CMPCOD

						AND FLTSEG.SEGSERNUM
= SEGULD.SEGSERNUM
						  WHERE
FLTLEG.CMPCOD    = ?
						AND FLTLEG.FLTNUM
= ?
						AND
FLTLEG.FLTSEQNUM     = ?
						AND
FLTLEG.FLTCARIDR     = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>290</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findUldsforPiecesWeightDifferenece" Type="NATIVE">
			<![CDATA[
					SELECT cmpcod,stdwgt,
                      SHPPFX,mstdocnum,
                      docowridr,



                      dupnum,
                      seqnum,
                      hawb,


                      uldonepcs,

                      uldonewgt,

uldtwopcs,

                      uldtwowgt,
                      uldthrpcs,


                      uldthrwgt,

                      uldforpcs,

uldforwgt,
                       uldoneoldwgt,


                      uldtwooldwgt,

uldthroldwgt,
                      uldforoldwgt
,

                      BDPWGT


FROM

                      (SELECT uldshp.cmpcod,mst.stdwgt,


                         uldshp.mstdocnum,MST.SHPPFX,


uldshp.docowridr,
                         uldshp.dupnum,



                         uldshp.seqnum,
                         NULL hawb,max(ARPSHP.BDPWGT) BDPWGT,


SUM(


                  CASE
                       WHEN uldnum = ? THEN uldshp.bdppcs


                        ELSE 0

                       END) uldonepcs,

SUM(

                  CASE
                       WHEN uldnum = ? THEN
uldshp.bdpwgt

ELSE 0

                       END) uldonewgt,
              SUM(


                  CASE
                       WHEN
uldnum = ? THEN uldshp.bdppcs

ELSE 0


                       END) uldtwopcs,

SUM(
                  CASE
                       WHEN uldnum =? THEN

uldshp.bdpwgt

ELSE 0
                       END) uldtwowgt,
              SUM(



CASE
                       WHEN uldnum = ? THEN uldshp.bdppcs


ELSE 0

                       END) uldthrpcs,
              SUM(


                  CASE
                       WHEN uldnum = ? THEN
uldshp.bdpwgt

ELSE 0

                       END) uldthrwgt,
              SUM(


                  CASE
                       WHEN
uldnum = ? THEN uldshp.bdppcs

ELSE 0


                       END) uldforpcs,

SUM(
                  CASE
                       WHEN uldnum = ? THEN

uldshp.bdpwgt

ELSE 0
                       END) uldforwgt,


                    SUM(

CASE
                          WHEN uldnum = ?



THEN uldshp.oldbdpwgt
                          ELSE 0


END) uldoneoldwgt,

                        SUM(
                        CASE


                          WHEN uldnum = ?

                          THEN
uldshp.oldbdpwgt

                          ELSE 0

END) uldtwooldwgt,

                        SUM(


CASE
                          WHEN uldnum = ?

                          THEN

uldshp.oldbdpwgt
                          ELSE 0
                        END) uldthroldwgt,



                        SUM(
                        CASE
                          WHEN uldnum = ?



                          THEN uldshp.oldbdpwgt
                          ELSE 0


                        END) uldforoldwgt


                       FROM oprseguldshp
uldshp,

                         oprfltseg fltseg,

oprarpexpflt
flt,
                         oprshpmst mst,OPRARPSHP
ARPSHP
                       WHERE
uldshp.cmpcod
= fltseg.cmpcod
                       AND uldshp.fltnum
= fltseg.fltnum

AND uldshp.fltcaridr
= fltseg.fltcaridr

                       AND uldshp.fltseqnum
= fltseg.fltseqnum

                       AND uldshp.segsernum
= fltseg.segsernum

AND flt.fltnum = fltseg.fltnum



AND flt.fltcaridr = fltseg.fltcaridr
                       AND flt.fltseqnum = fltseg.fltseqnum



                       AND flt.cmpcod = fltseg.cmpcod
                       AND flt.arpcod = fltseg.pol




                                 and   ULDSHP.CMPCOD   =MST.CMPCOD
                            and

ULDSHP.MSTDOCNUM=MST.MSTDOCNUM

                            and    ULDSHP.DOCOWRIDR=MST.DOCOWRIDR


                            and    ULDSHP.DUPNUM   =MST.DUPNUM


and    ULDSHP.SEQNUM
=    MST.SEQNUM

                            and     ULDSHP.CMPCOD   =ARPSHP.CMPCOD



                            and    ULDSHP.MSTDOCNUM = ARPSHP.MSTDOCNUM

and
ULDSHP.DOCOWRIDR=ARPSHP.DOCOWRIDR

                            and
ULDSHP.DUPNUM
=ARPSHP.DUPNUM
                            and    ULDSHP.SEQNUM   =ARPSHP.SEQNUM



                            AND flt.arpcod =ARPSHP.ARPCOD

                       AND flt.cmpcod =?


                       AND flt.legsernum
= ?
                       AND flt.fltnum = ?

AND flt.fltcaridr
= ?

                       AND flt.fltseqnum = ?

AND flt.arpcod
= ?
                       AND uldshp.uldnum
IN(?,?,?,?)
                       GROUP
BY uldshp.cmpcod,

                         uldshp.mstdocnum,


                         uldshp.docowridr,

                         uldshp.dupnum,

uldshp.seqnum,


                         stdwgt,

MST.SHPPFX
                         )
                    ORDER BY cmpcod,



mstdocnum,
                      dupnum,
                      docowridr,


seqnum,

                      hawb

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>289</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findUldsforAdjustWeightDifference" Type="NATIVE">
			<![CDATA[
					SELECT
					  ULDSHP.ULDNUM,
					  SEGULD.NETWGT,
					  ((DWSULD.ACTWGT - DWSULD.TARWGT) - SEGULD.NETWGT)


WGTDIF,
					  EXPFLT.FINFLG
						FROM
						  (SELECT DISTINCT ULDSHP.ULDNUM,
						     ULDSHP.FLTNUM,



						     ULDSHP.FLTCARIDR,
						     ULDSHP.FLTSEQNUM,
						     ULDSHP.CMPCOD,
						     CASE


						   WHEN
ULDSHP.ULDNUM = ? THEN
						    1
						   ELSE
						    2
						   END PRI,

ULDSHP.SEGSERNUM


FROM OPRSEGULDSHP ULDSHP
						   WHERE(ULDSHP.CMPCOD,    ULDSHP.MSTDOCNUM,
ULDSHP.DOCOWRIDR,
ULDSHP.SEQNUM,
ULDSHP.DUPNUM,    ULDSHP.FLTNUM,    ULDSHP.FLTCARIDR,    ULDSHP.FLTSEQNUM,
ULDSHP.SEGSERNUM)
IN

						    (SELECT ULDSHP.CMPCOD,
						       ULDSHP.MSTDOCNUM,

ULDSHP.DOCOWRIDR,

						       ULDSHP.SEQNUM,

						       ULDSHP.DUPNUM,

ULDSHP.FLTNUM,
						       ULDSHP.FLTCARIDR,

						       ULDSHP.FLTSEQNUM,


						       ULDSHP.SEGSERNUM
						     FROM OPRSEGULDSHP ULDSHP,

						       OPRFLTSEG
FLTSEG
						     WHERE
ULDSHP.CMPCOD = FLTSEG.CMPCOD
						     AND ULDSHP.FLTNUM = FLTSEG.FLTNUM


						     AND ULDSHP.FLTCARIDR
= FLTSEG.FLTCARIDR
						     AND ULDSHP.FLTSEQNUM = FLTSEG.FLTSEQNUM


						     AND ULDSHP.SEGSERNUM
= FLTSEG.SEGSERNUM
						     AND ULDSHP.ULDNUM = ?
						     AND
FLTSEG.CMPCOD
= ?
						     AND FLTSEG.FLTNUM
= ?
						     AND FLTSEG.FLTCARIDR = ?
						     AND
FLTSEG.FLTSEQNUM
= ?
						     AND FLTSEG.POL
= ? )
						  )
						ULDSHP,
						  OPRDWSULD DWSULD,

OPRSEGULD
SEGULD,
						  OPRARPEXPFLT
EXPFLT,
						  FLTOPRLEG FLTLEG
						WHERE EXPFLT.CMPCOD =
FLTLEG.CMPCOD

						 AND EXPFLT.FLTCARIDR
= FLTLEG.FLTCARIDR
						 AND EXPFLT.FLTSEQNUM = FLTLEG.FLTSEQNUM

AND EXPFLT.FLTNUM
= FLTLEG.FLTNUM

						 AND EXPFLT.LEGSERNUM = FLTLEG.LEGSERNUM
						 AND
EXPFLT.ARPCOD = FLTLEG.LEGORG

						 AND ULDSHP.CMPCOD
= EXPFLT.CMPCOD
						 AND ULDSHP.FLTCARIDR
= EXPFLT.FLTCARIDR
						 AND ULDSHP.FLTSEQNUM
= EXPFLT.FLTSEQNUM

						 AND ULDSHP.FLTNUM =
EXPFLT.FLTNUM
						 AND ULDSHP.ULDNUM = SEGULD.ULDNUM

						 AND ULDSHP.CMPCOD =
SEGULD.CMPCOD

AND ULDSHP.FLTNUM = SEGULD.FLTNUM
						 AND ULDSHP.FLTCARIDR
= SEGULD.FLTCARIDR

AND ULDSHP.FLTSEQNUM
= SEGULD.FLTSEQNUM
						 AND ULDSHP.SEGSERNUM = SEGULD.SEGSERNUM

						 AND ULDSHP.ULDNUM
=
DWSULD.ULDNUM(+)
						 AND ULDSHP.CMPCOD = DWSULD.CMPCOD(+)
						 AND ULDSHP.FLTNUM
= DWSULD.FLTNUM(+)


						 AND ULDSHP.FLTCARIDR = DWSULD.FLTCARIDR(+)
						 AND ULDSHP.FLTSEQNUM
= DWSULD.FLTSEQNUM(+)

AND
EXPFLT.ARPCOD = ?
						 AND DWSULD.LEGSERNUM(+) = ?
						 AND DWSULD.ARPCOD(+)
= ?
						ORDER BY PRI



			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>253</QRY:Id>
		<QRY:Source Name="operations.flthandling.arrival.findshipmentsegmentformessage" Type="NATIVE">
			<![CDATA[
			SELECT   ULDSEGSHP.ADDSCC ADDSCC,
			         ULDSEGSHP.FLTCARIDR, ULDSEGSHP.CMPCOD,
			         ULDSEGSHP.FLTNUM,


ULDSEGSHP.FLTSEQNUM,
			         ULDSEGSHP.SEGSERNUM, MST.ORGCOD,
			         MST.CONFLG, MST.DSTCOD,


MST.STDPCS,
			         IMPFLT.FLTDAT, IMPFLT.FLTCARCOD,
			         MST.STDWGT, ULDSEGSHP.DOCOWRIDR,



			         ULDSEGSHP.MSTDOCNUM, ULDSEGSHP.DUPNUM,
			         ULDSEGSHP.SEQNUM, MST.AGTCOD, FLTSEG.POL,



			         FLTSEG.POU, MST.SCCCOD, MST.OWRCOD,
			         MST.SHPPFX, SUM (  ULDSEGSHP.MFTPCS



			                         ) MFTPCS,
			         SUM (   ULDSEGSHP.MFTWGT) MFTWGT,
			         SUM

(   ULDSEGSHP.MFTVOL) MFTVOL,

			         SUM (   ULDSEGSHP.BDPWGT) BDPWGT,


			         SUM (   ULDSEGSHP.BDPVOL) BDPVOL,
			         SUM (   ULDSEGSHP.BDPPCS)
BDPPCS,

SUM (
ULDSEGSHP.RCVPCS) RCVPCS,
			         SUM (   ULDSEGSHP.RCVWGT) RCVWGT,


SUM
(   ULDSEGSHP.RCVVOL) RCVVOL,
					(SELECT COUNT ( MSTDOCNUM)
					    	FROM OPRSHPMST SHP



					   	WHERE SHP.CMPCOD =  ULDSEGSHP.CMPCOD
					     AND SHP.DOCOWRIDR = ULDSEGSHP.DOCOWRIDR

AND

SHP.MSTDOCNUM = ULDSEGSHP.MSTDOCNUM
					     AND SHP.DUPNUM = ULDSEGSHP.DUPNUM) HSEROWCNT

FROM

OPRSHPMST MST,
			         OPRFLTSEG FLTSEG,
			         OPRARPIMPFLT IMPFLT,
			         OPRSEGULDSHP


ULDSEGSHP
			   WHERE ULDSEGSHP.CMPCOD = MST.CMPCOD(+)
			     AND ULDSEGSHP.DOCOWRIDR = MST.DOCOWRIDR(+)



			     AND ULDSEGSHP.MSTDOCNUM = MST.MSTDOCNUM(+)
			     AND ULDSEGSHP.DUPNUM = MST.DUPNUM(+)


			     AND ULDSEGSHP.SEQNUM
= MST.SEQNUM(+)
			     AND ULDSEGSHP.FLTCARIDR = FLTSEG.FLTCARIDR(+)

AND
ULDSEGSHP.FLTNUM =
FLTSEG.FLTNUM(+)
			     AND ULDSEGSHP.FLTSEQNUM = FLTSEG.FLTSEQNUM(+)

AND
ULDSEGSHP.SEGSERNUM
= FLTSEG.SEGSERNUM(+)
			     AND ULDSEGSHP.CMPCOD = FLTSEG.CMPCOD(+)

AND
FLTSEG.FLTCARIDR =
IMPFLT.FLTCARIDR(+)
			     AND FLTSEG.FLTNUM = IMPFLT.FLTNUM(+)
			     AND
FLTSEG.FLTSEQNUM
= IMPFLT.FLTSEQNUM(+)

			     AND FLTSEG.CMPCOD = IMPFLT.CMPCOD(+) AND


ULDSEGSHP.FLTNUM=?
AND
				ULDSEGSHP.FLTSEQNUM =? AND

				ULDSEGSHP.FLTCARIDR =? AND
				ULDSEGSHP.CMPCOD=?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>307</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findDWSFlightDeliveryDetails" Type="NATIVE">
			<![CDATA[

					SELECT FLT.FLTCARIDR,
					  FLT.FLTNUM,
					  FLT.FLTSEQNUM,
					  FLT.SEGORG POL,
					  FLT.CMPCOD,



					  NVL(ULD.ULDPOS, '')ULDPOS,
					  NVL(ULD.ULDCTR,DWSULD.ULDCTR) ULDCTR,
					  DWSULD.DLVSTA,



					  ULD.SEGSERNUM,
					  DWSULD.ULDNUM,
					  DWSULD.GRSWGT,
					  (CASE
  WHEN ULD.ULDVOL >
0

  THEN
ULD.ULDVOL
  ELSE DWSULD.ULDVOL
  END)ULDVOL ,
					  SUM(ULDSHP.BDPPCS) TOTPCS,

FLT.SEGDST
POU,

					  WHS.CURLOCCOD,
					  NVL(DWSULD.CONIDR,ULD.CONIDR) CONIDR,
					  DWSULD.ACTWGT,


					  DWSULD.TARWGT,

					 (
				    CASE
				      WHEN NVL(MTKULD.CMPCOD,'')<> ' '

THEN
DWSULD.BLKRMK
				      ELSE
ULD.RMK
		           		 END)  BLKRMK
					FROM FLTOPRLEG EXP,

FLTOPRSEG
FLT,
					   OPRSEGULD
ULD,
					   OPRSEGULDSHP ULDSHP,
					   WHSSTUMST WHS,
					  OPRDWSULD
DWSULD,

					  MALULDSEG MTKULD

WHERE EXP.FLTNUM = FLT.FLTNUM
					 AND EXP.FLTCARIDR =
FLT.FLTCARIDR
					 AND
EXP.FLTSEQNUM = FLT.FLTSEQNUM

AND EXP.CMPCOD = FLT.CMPCOD
					 AND EXP.LEGORG
= FLT.SEGORG

AND FLT.SEGSTA <> 'D'
					 AND FLT.FLTNUM
= DWSULD.FLTNUM
					 AND FLT.FLTCARIDR
= DWSULD.FLTCARIDR

AND FLT.FLTSEQNUM = DWSULD.FLTSEQNUM

AND EXP.LEGSERNUM = DWSULD.LEGSERNUM

AND FLT.SEGDST
= DWSULD.POU
					 AND FLT.CMPCOD = DWSULD.CMPCOD

AND FLT.SEGORG = DWSULD.ARPCOD

AND WHS.STUCOD(+)
= DWSULD.ULDNUM
					 AND WHS.CMPCOD(+) = DWSULD.CMPCOD

AND ULD.FLTNUM = ULDSHP.FLTNUM(+)


AND ULD.FLTCARIDR = ULDSHP.FLTCARIDR(+)
							AND ULD.FLTSEQNUM
= ULDSHP.FLTSEQNUM(+)
							AND ULD.SEGSERNUM

= ULDSHP.SEGSERNUM(+)
							AND ULD.CMPCOD = ULDSHP.CMPCOD(+)

							AND ULD.ULDNUM = ULDSHP.ULDNUM(+)


							AND FLT.SEGSERNUM = NVL(ULD.SEGSERNUM,MTKULD.SEGSERNUM)

					 AND DWSULD.FLTCARIDR = ULD.FLTCARIDR(+)


					 AND DWSULD.FLTSEQNUM = ULD.FLTSEQNUM(+)
					 AND DWSULD.FLTNUM
= ULD.FLTNUM(+)
					 AND DWSULD.CMPCOD

= ULD.CMPCOD(+)
					 AND DWSULD.ULDNUM = ULD.ULDNUM(+)


					 AND DWSULD.FLTCARIDR = MTKULD.FLTCARIDR(+)


AND DWSULD.FLTSEQNUM = MTKULD.FLTSEQNUM(+)
					 AND
DWSULD.FLTNUM = MTKULD.FLTNUM(+)
					 AND DWSULD.CMPCOD

= MTKULD.CMPCOD(+)
 					 AND DWSULD.ULDNUM
= MTKULD.ULDNUM(+)
				   	 AND EXP.CMPCOD = ?
					 AND

DWSULD.ARPCOD = ?
					 AND EXP.FLTNUM = ?

					 AND EXP.FLTCARIDR = ?
					 AND EXP.FLTSEQNUM = ?


			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>378</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findDWSFlightDeliveryDetailsmail" Type="NATIVE">
			<![CDATA[
		  		 SELECT FLT.FLTCARIDR                 ,
				  FLT.FLTNUM                          ,
				  FLT.FLTSEQNUM


,
				  FLT.SEGORG POL                      ,
				  FLT.CMPCOD                          ,
				  NVL(ULD.ULDPOS,


DSNCON.POSTYP)ULDPOS,
				  NVL(ULD.ULDCTR,DWSULD.ULDCTR) ULDCTR,
				  DWSULD.DLVSTA


,
				  ULD.SEGSERNUM                       ,
				  DWSULD.ULDNUM                       ,
				  DWSULD.GRSWGT


,
				  (
				  CASE
				    WHEN ULD.ULDVOL > 0
				    THEN ULD.ULDVOL
				    ELSE DWSULD.ULDVOL



END)ULDVOL                          ,
				  SUM(ULDSHP.BDPPCS) TOTPCS           ,
				  FLT.SEGDST
POU

,
				  WHS.CURLOCCOD                       ,
				  NVL(ULD.CONIDR,DWSULD.CONIDR)
CONIDR,
				  DWSULD.ACTWGT

,
				  DWSULD.TARWGT                       ,

NVL(ULD.RMK, DWSULD.BLKRMK) BLKRMK
				   FROM FLTOPRLEG

EXP,
				  FLTOPRSEG FLT      ,
				  OPRSEGULD
ULD      ,
				  OPRSEGULDSHP ULDSHP,
				  WHSSTUMST

WHS      ,
				  OPRDWSULD DWSULD   ,
				  MALULDSEGDTL
DSNCON
				  WHERE EXP.FLTNUM   = FLT.FLTNUM


				AND EXP.FLTCARIDR    = FLT.FLTCARIDR
				AND EXP.FLTSEQNUM
= FLT.FLTSEQNUM
				AND EXP.CMPCOD

= FLT.CMPCOD
				AND EXP.LEGORG       = FLT.SEGORG
				AND
FLT.FLTNUM       = DWSULD.FLTNUM
				AND
FLT.FLTCARIDR
= DWSULD.FLTCARIDR
				AND FLT.FLTSEQNUM
= DWSULD.FLTSEQNUM
				AND EXP.LEGSERNUM
= DWSULD.LEGSERNUM

AND FLT.SEGDST       = DWSULD.POU

AND FLT.CMPCOD       = DWSULD.CMPCOD

				AND FLT.SEGORG       =
DWSULD.ARPCOD
				AND WHS.STUCOD(+)
= DWSULD.ULDNUM
				AND WHS.CMPCOD(+)
= DWSULD.CMPCOD
				AND
ULD.FLTNUM       = ULDSHP.FLTNUM(+)

AND ULD.FLTCARIDR    = ULDSHP.FLTCARIDR(+)

				AND ULD.FLTSEQNUM
= ULDSHP.FLTSEQNUM(+)
				AND
ULD.SEGSERNUM    = ULDSHP.SEGSERNUM(+)
				AND ULD.CMPCOD
= ULDSHP.CMPCOD(+)

				AND ULD.ULDNUM
= ULDSHP.ULDNUM(+)
				AND FLT.SEGSERNUM    = nvl(ULD.SEGSERNUM,DSNCON.segsernum)


				AND DWSULD.FLTCARIDR
= ULD.FLTCARIDR(+)
				AND DWSULD.FLTSEQNUM = ULD.FLTSEQNUM(+)
				AND DWSULD.FLTNUM

= ULD.FLTNUM(+)

AND DWSULD.CMPCOD    = ULD.CMPCOD(+)
				AND DWSULD.ULDNUM    = ULD.ULDNUM(+)


AND DWSULD.FLTCARIDR
= DSNCON.FLTCARIDR
				AND DWSULD.FLTSEQNUM = DSNCON.FLTSEQNUM
				AND DWSULD.FLTNUM

= DSNCON.FLTNUM

AND DWSULD.CMPCOD    = DSNCON.CMPCOD
				AND DWSULD.ULDNUM    = DSNCON.CONNUM


				AND EXP.CMPCOD
= ?
				AND DWSULD.ARPCOD    =?
				AND EXP.FLTNUM       = ?
				AND EXP.FLTCARIDR

= ?
				AND EXP.FLTSEQNUM
= ?
				AND FLT.SEGSTA <> 'D'

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>257</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findflightfinaldetails" Type="NATIVE">
			<![CDATA[
			   SELECT SUM(
			    CASE
			      WHEN RN=1
			      THEN 1
			      ELSE 0
			    END) AWBCNT ,



			    SUM(
			    CASE
			      WHEN RN=1
			      THEN MFTPCS
			      ELSE 0
			    END) MFTPCS,


			    SUM(

			    CASE
			      WHEN RN=1
			      THEN MFTWGT
			      ELSE 0
			    END)
MFTWGT,

			    POU        ,

			    SEGSERNUM  ,
			    FLTFINRMK  ,
			    SRVCRGCLS
SRVCRGCLS
			     FROM

			    (SELECT GENMFT.MFTPCS
MFTPCS ,
			      GENMFT.MFTWGT MFTWGT
,
			      FLTSEG.SEGDST POU
,
			      FLTFINRMK
,
			      SRVCRGCLS
,
			      SEGSHP.SEGSERNUM
SEGSERNUM ,
			      ROW_NUMBER() OVER
(PARTITION BY GENMFT.FLTNUM, GENMFT.FLTSEQNUM,
GENMFT.FLTCARIDR,
GENMFT.ARPCOD, GENMFT.CMPCOD, GENMFT.LEGSERNUM,
GENMFT.MSTDOCNUM, GENMFT.DOCOWRIDR,
GENMFT.DUPNUM, GENMFT.SEQNUM,FLTSEG.SEGSERNUM
ORDER BY GENMFT.MSTDOCNUM)
RN
			       FROM

(SELECT FLTNUM,
			        FLTSEQNUM   ,

			        FLTCARIDR   ,

ARPCOD
,
			        CMPCOD      ,
			        LEGSERNUM   ,

			        MSTDOCNUM   ,
			        DOCOWRIDR

,
			        DUPNUM      ,
			        SEQNUM      ,

			        MFTPCS      ,

MFTWGT      ,

MFTVER      ,
			        MAX(MFTVER) OVER(PARTITION
BY FLTNUM, FLTSEQNUM,
FLTCARIDR, ARPCOD, CMPCOD,
LEGSERNUM, MSTDOCNUM, DOCOWRIDR, DUPNUM, SEQNUM) MAXVER


FROM OPRGENMFTSHP
			      ) GENMFT

INNER JOIN FLTOPRSEG FLTSEG
			         ON GENMFT.FLTNUM

= FLTSEG.FLTNUM
			    AND GENMFT.FLTCARIDR
= FLTSEG.FLTCARIDR
			    AND GENMFT.FLTSEQNUM  = FLTSEG.FLTSEQNUM


			    INNER JOIN OPRSHPMST MSTACC

ON GENMFT.CMPCOD = MSTACC.CMPCOD
			    AND GENMFT.DOCOWRIDR

= MSTACC.DOCOWRIDR
			    AND GENMFT.MSTDOCNUM
= MSTACC.MSTDOCNUM
			    AND GENMFT.DUPNUM     = MSTACC.DUPNUM


			    AND GENMFT.SEQNUM     = MSTACC.SEQNUM

			    INNER JOIN OPRLODPLNBKGSUM SEGSHP

ON
GENMFT.CMPCOD = SEGSHP.CMPCOD
			    AND GENMFT.DOCOWRIDR
= SEGSHP.DOCOWRIDR
			    AND GENMFT.MSTDOCNUM

= SEGSHP.MSTDOCNUM
			    AND GENMFT.DUPNUM     = SEGSHP.DUPNUM

			    AND GENMFT.SEQNUM

= SEGSHP.SEQNUM
			    AND GENMFT.FLTNUM     = SEGSHP.FLTNUM
			    AND GENMFT.FLTCARIDR
= SEGSHP.FLTCARIDR


			    AND GENMFT.FLTSEQNUM  = SEGSHP.FLTSEQNUM
			    AND FLTSEG.SEGSERNUM  =SEGSHP.SEGSERNUM



			    AND FLTSEG.SEGSTA    !='D'
			    LEFT OUTER JOIN OPRFLTSEG
			         ON SEGSHP.FLTNUM
= OPRFLTSEG.FLTNUM


			    AND SEGSHP.FLTCARIDR  = OPRFLTSEG.FLTCARIDR
			    AND SEGSHP.FLTSEQNUM
= OPRFLTSEG.FLTSEQNUM


			    AND SEGSHP.SEGSERNUM  = OPRFLTSEG.SEGSERNUM
			    LEFT OUTER JOIN
OPRSHPMSTACC
			         ON
GENMFT.CMPCOD
= OPRSHPMSTACC.CMPCOD
			    AND GENMFT.DOCOWRIDR  = OPRSHPMSTACC.DOCOWRIDR

AND
GENMFT.MSTDOCNUM
= OPRSHPMSTACC.MSTDOCNUM
			    AND GENMFT.DUPNUM     = OPRSHPMSTACC.DUPNUM


			    AND GENMFT.SEQNUM
= OPRSHPMSTACC.SEQNUM
			      WHERE GENMFT.FLTNUM = ?
			    AND GENMFT.FLTCARIDR

= ?
			    AND GENMFT.FLTSEQNUM
= ?
			    AND GENMFT.MAXVER     = GENMFT.MFTVER
			    AND FLTSEG.SEGORG

= ?
			    )
			  GROUP
BY POU,
			    SEGSERNUM ,
			    FLTFINRMK ,
			    SRVCRGCLS

			  UNION
ALL


			   SELECT SUM(

CASE
			      WHEN RN=1
			      THEN 1
			      ELSE 0

END) AWBCNT ,

			    SUM(
			    CASE

WHEN RN=1
			      THEN MFTPCS
			      ELSE
0
			    END) MFTPCS,

			    SUM(
			    CASE
			      WHEN
RN=1
			      THEN MFTWGT

ELSE 0
			    END) MFTWGT,

			    POU        ,
			    SEGSERNUM  ,

FLTFINRMK  ,

SRVCRGCLS SRVCRGCLS
			     FROM

			    (SELECT GENMFT.MFTPCS MFTPCS ,
			      GENMFT.MFTWGT

MFTWGT       ,
			      FLTSEG.SEGDST POU
,
			      FLTFINRMK                  ,

SRVCRGCLS
,
			      LYGSHP.SEGSERNUM
SEGSERNUM ,
			      ROW_NUMBER() OVER (PARTITION
BY GENMFT.FLTNUM, GENMFT.FLTSEQNUM,
GENMFT.FLTCARIDR,
GENMFT.ARPCOD, GENMFT.CMPCOD, GENMFT.LEGSERNUM,
GENMFT.MSTDOCNUM, GENMFT.DOCOWRIDR,
GENMFT.DUPNUM, GENMFT.SEQNUM,FLTSEG.SEGSERNUM
ORDER BY GENMFT.MSTDOCNUM)
RN
			       FROM
			      (SELECT
FLTNUM,
			        FLTSEQNUM   ,

			        FLTCARIDR
,
			        ARPCOD      ,
			        CMPCOD
,
			        LEGSERNUM   ,


MSTDOCNUM   ,
			        DOCOWRIDR   ,
			        DUPNUM      ,

SEQNUM      ,


			        MFTPCS      ,
			        MFTWGT      ,
			        MFTVER      ,
			        MAX(MFTVER)
OVER(PARTITION

BY FLTNUM, FLTSEQNUM, FLTCARIDR, ARPCOD, CMPCOD, LEGSERNUM, MSTDOCNUM, DOCOWRIDR, DUPNUM,
SEQNUM) MAXVER


			         FROM OPRGENMFTSHP
			      ) GENMFT
			    INNER JOIN FLTOPRSEG FLTSEG

ON GENMFT.FLTNUM

= FLTSEG.FLTNUM
			    AND GENMFT.FLTCARIDR  = FLTSEG.FLTCARIDR
			    AND GENMFT.FLTSEQNUM
= FLTSEG.FLTSEQNUM


			    INNER JOIN OPRSHPMST MSTACC
			         ON GENMFT.CMPCOD = MSTACC.CMPCOD

AND GENMFT.DOCOWRIDR

= MSTACC.DOCOWRIDR
			    AND GENMFT.MSTDOCNUM  = MSTACC.MSTDOCNUM
			    AND GENMFT.DUPNUM
= MSTACC.DUPNUM


			    AND GENMFT.SEQNUM     = MSTACC.SEQNUM
			    INNER JOIN OPRLODPLNLYGSHP LYGSHP



			         ON GENMFT.CMPCOD = LYGSHP.CMPCOD
			    AND GENMFT.DOCOWRIDR  = LYGSHP.DOCOWRIDR

AND GENMFT.MSTDOCNUM

= LYGSHP.MSTDOCNUM
			    AND GENMFT.DUPNUM     = LYGSHP.DUPNUM
			    AND GENMFT.SEQNUM
= LYGSHP.SEQNUM


AND GENMFT.FLTNUM     = LYGSHP.FLTNUM
			    AND GENMFT.FLTCARIDR  = LYGSHP.FLTCARIDR

AND GENMFT.FLTSEQNUM

= LYGSHP.FLTSEQNUM
			    AND FLTSEG.SEGSERNUM  =LYGSHP.SEGSERNUM
			    AND
FLTSEG.SEGSTA    !='D'


			    LEFT OUTER JOIN OPRFLTSEG
			         ON LYGSHP.FLTNUM = OPRFLTSEG.FLTNUM

AND LYGSHP.FLTCARIDR

= OPRFLTSEG.FLTCARIDR
			    AND LYGSHP.FLTSEQNUM  = OPRFLTSEG.FLTSEQNUM

AND LYGSHP.SEGSERNUM

= OPRFLTSEG.SEGSERNUM
			    LEFT OUTER JOIN OPRSHPMSTACC
			         ON GENMFT.CMPCOD
= OPRSHPMSTACC.CMPCOD


AND GENMFT.DOCOWRIDR  = OPRSHPMSTACC.DOCOWRIDR
			    AND GENMFT.MSTDOCNUM
= OPRSHPMSTACC.MSTDOCNUM


AND GENMFT.DUPNUM     = OPRSHPMSTACC.DUPNUM
			    AND GENMFT.SEQNUM
= OPRSHPMSTACC.SEQNUM


WHERE GENMFT.FLTNUM = ?
			    AND GENMFT.FLTCARIDR  = ?
			    AND
GENMFT.FLTSEQNUM  = ?
			    AND

GENMFT.MAXVER     = GENMFT.MFTVER
			    AND FLTSEG.SEGORG     = ?

)
			  GROUP BY POU,


			    SEGSERNUM ,
			    FLTFINRMK ,
			    SRVCRGCLS

			  UNION ALL


SELECT 0 AWBCNT
,

			    0 MFTPCS             ,
			    0 MFTWGT             ,
			    FLTSEG.SEGDST
AS POU ,

			    FLTSEG.SEGSERNUM
,
			    '' AS FLTFINRMK      ,
			    '' AS SRVCRGCLS

FROM FLTOPRSEG FLTSEG

			    WHERE FLTSEG.FLTNUM
= ?
			  AND FLTSEG.FLTCARIDR  = ?
			  AND
FLTSEG.SEGORG     = ?
			  AND FLTSEG.FLTSEQNUM
=?

			  AND FLTSEG.SEGSTA    !='D' MINUS

(SELECT 0 AWBCNT
,

0 MFTPCS
,
			      0 MFTWGT

,
			      NVL(LYGSHP.SEGDST,LODPLNSHP.SEGDST)
SEGDST          ,
			      NVL(LYGSHP.SEGSERNUM,LODPLNSHP.SEGSERNUM)

SEGSERNUM ,
			      '' AS FLTFINRMK
,
			      '' AS SRVCRGCLS


			       FROM OPRGENMFTSHP GENMFT
			    LEFT OUTER
JOIN OPRLODPLNBKGSUM LODPLNSHP
			         ON GENMFT.FLTNUM

= LODPLNSHP.FLTNUM
			    AND GENMFT.FLTCARIDR
= LODPLNSHP.FLTCARIDR
			    AND GENMFT.FLTSEQNUM  =

LODPLNSHP.FLTSEQNUM
			    AND GENMFT.DOCOWRIDR
= LODPLNSHP.DOCOWRIDR
			    AND GENMFT.MSTDOCNUM
=
LODPLNSHP.MSTDOCNUM
			    AND GENMFT.DUPNUM
= LODPLNSHP.DUPNUM
			    AND GENMFT.SEQNUM     =
LODPLNSHP.SEQNUM

			    LEFT OUTER JOIN OPRLODPLNLYGSHP
LYGSHP
			         ON GENMFT.FLTNUM
= LYGSHP.FLTNUM

AND GENMFT.FLTCARIDR
= LYGSHP.FLTCARIDR
			    AND GENMFT.FLTSEQNUM

= LYGSHP.FLTSEQNUM
			    AND GENMFT.DOCOWRIDR
= LYGSHP.DOCOWRIDR
			    AND GENMFT.MSTDOCNUM

= LYGSHP.MSTDOCNUM
			    AND GENMFT.DUPNUM
= LYGSHP.DUPNUM
			    AND GENMFT.SEQNUM

= LYGSHP.SEQNUM
			      WHERE GENMFT.FLTNUM
= ?
			    AND GENMFT.FLTCARIDR

= ?
			    AND NVL(LODPLNSHP.SEGORG ,LYGSHP.SEGORG)
= ?
			    AND GENMFT.FLTSEQNUM

=?
			    )
			ORDER BY POU
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>258</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findflightsccfinaldetails" Type="NATIVE">
			<![CDATA[
		 SELECT
	   COUNT ( 1) AWBCNT,
	   SUM ( MFTPCS) MFTPCS,
	   SUM ( MFTWGT) MFTWGT,
	   LODPLN.SEGDST,



	   SHPSCC.SCCCOD
	 FROM
	   OPRGENMFTSHP GENMFT,
	   OPRSHPSCC SHPSCC,
	   OPRLODPLNBKGSUM LODPLN


	 WHERE

	   SHPSCC.CMPCOD      = GENMFT.CMPCOD
	 AND SHPSCC.DOCOWRIDR = GENMFT.DOCOWRIDR
	 AND
SHPSCC.DUPNUM
=
GENMFT.DUPNUM
	 AND SHPSCC.MSTDOCNUM = GENMFT.MSTDOCNUM
	 AND SHPSCC.SEQNUM    =
GENMFT.SEQNUM
	 AND

GENMFT.FLTNUM    = LODPLN.FLTNUM
	 AND GENMFT.FLTCARIDR = LODPLN.FLTCARIDR
	 AND
GENMFT.FLTSEQNUM =
LODPLN.FLTSEQNUM

AND GENMFT.CMPCOD    = LODPLN.CMPCOD
	 AND GENMFT.DOCOWRIDR =
LODPLN.DOCOWRIDR

	 AND GENMFT.DUPNUM
= LODPLN.DUPNUM
	 AND GENMFT.MSTDOCNUM = LODPLN.MSTDOCNUM

AND GENMFT.SEQNUM
= LODPLN.SEQNUM
	 AND
GENMFT.FLTNUM    =  ?
	 AND GENMFT.FLTCARIDR = ?
	 AND LODPLN.SEGORG
= ?

AND GENMFT.FLTSEQNUM =
?
	 GROUP BY
	   LODPLN.SEGDST,
	   SHPSCC.SCCCOD

	 UNION ALL

	 SELECT


	   COUNT ( 1) AWBCNT,
	   SUM
( MFTPCS) MFTPCS,
	   SUM ( MFTWGT) MFTWGT,
	   LODPLN.SEGDST,
	   SHPMST.SCCCOD


	 FROM
	   OPRGENMFTSHP
GENMFT,
	   OPRSHPMST SHPMST,
	   OPRLODPLNBKGSUM LODPLN
	 WHERE
	   SHPMST.CMPCOD

= GENMFT.CMPCOD

AND SHPMST.DOCOWRIDR = GENMFT.DOCOWRIDR
	 AND SHPMST.DUPNUM    = GENMFT.DUPNUM

AND
SHPMST.MSTDOCNUM
= GENMFT.MSTDOCNUM
	 AND SHPMST.SEQNUM    = GENMFT.SEQNUM
	 AND GENMFT.FLTNUM
=
LODPLN.FLTNUM
	 AND
GENMFT.FLTCARIDR = LODPLN.FLTCARIDR
	 AND GENMFT.FLTSEQNUM = LODPLN.FLTSEQNUM


	 AND GENMFT.CMPCOD
= LODPLN.CMPCOD
	 AND GENMFT.DOCOWRIDR = LODPLN.DOCOWRIDR
	 AND GENMFT.DUPNUM

= LODPLN.DUPNUM
	 AND
GENMFT.MSTDOCNUM = LODPLN.MSTDOCNUM
	 AND GENMFT.SEQNUM    = LODPLN.SEQNUM

AND
GENMFT.FLTNUM    = ?

AND GENMFT.FLTCARIDR = ?
	 AND LODPLN.SEGORG    = ?
	 AND GENMFT.FLTSEQNUM
=
?
	 AND SHPMST.SCCCOD
IS NOT NULL
	 GROUP BY
	   LODPLN.SEGDST,
	   SHPMST.SCCCOD

	 UNION ALL



SELECT
	   COUNT ( 1) AWBCNT,

SUM ( MFTPCS) MFTPCS,
	   SUM ( MFTWGT) MFTWGT,
	   LYGSHP.SEGDST,


SHPSCC.SCCCOD
	 FROM
	   OPRGENMFTSHP
GENMFT,
	   OPRSHPSCC SHPSCC,
	   OPRLODPLNLYGSHP LYGSHP
	 WHERE


SHPSCC.CMPCOD      = GENMFT.CMPCOD

AND SHPSCC.DOCOWRIDR = GENMFT.DOCOWRIDR
	 AND SHPSCC.DUPNUM

= GENMFT.DUPNUM
	 AND SHPSCC.MSTDOCNUM
= GENMFT.MSTDOCNUM
	 AND SHPSCC.SEQNUM    = GENMFT.SEQNUM

AND
GENMFT.FLTNUM    = LYGSHP.FLTNUM
	 AND
GENMFT.FLTCARIDR = LYGSHP.FLTCARIDR
	 AND GENMFT.FLTSEQNUM
=
LYGSHP.FLTSEQNUM
	 AND GENMFT.CMPCOD
= LYGSHP.CMPCOD
	 AND GENMFT.DOCOWRIDR = LYGSHP.DOCOWRIDR


	 AND GENMFT.DUPNUM    = LYGSHP.DUPNUM
	 AND
GENMFT.MSTDOCNUM = LYGSHP.MSTDOCNUM
	 AND GENMFT.SEQNUM

= LYGSHP.SEQNUM
	 AND GENMFT.FLTNUM    = ?

AND GENMFT.FLTCARIDR = ?
	 AND LYGSHP.SEGORG    = ?

AND
GENMFT.FLTSEQNUM = ?
	 GROUP BY
	   LYGSHP.SEGDST,

SHPSCC.SCCCOD

	 UNION ALL

	 SELECT

COUNT
( 1) AWBCNT,
	   SUM ( MFTPCS) MFTPCS,
	   SUM ( MFTWGT)
MFTWGT,
	   LYGSHP.SEGDST,
	   SHPMST.SCCCOD


	 FROM
	   OPRGENMFTSHP GENMFT,
	   OPRSHPMST SHPMST,

OPRLODPLNLYGSHP LYGSHP
	 WHERE
	   SHPMST.CMPCOD

= GENMFT.CMPCOD
	 AND SHPMST.DOCOWRIDR = GENMFT.DOCOWRIDR

AND SHPMST.DUPNUM    = GENMFT.DUPNUM

AND
SHPMST.MSTDOCNUM = GENMFT.MSTDOCNUM
	 AND SHPMST.SEQNUM
= GENMFT.SEQNUM
	 AND GENMFT.FLTNUM
=
LYGSHP.FLTNUM
	 AND GENMFT.FLTCARIDR = LYGSHP.FLTCARIDR
	 AND
GENMFT.FLTSEQNUM = LYGSHP.FLTSEQNUM


	 AND GENMFT.CMPCOD    = LYGSHP.CMPCOD
	 AND GENMFT.DOCOWRIDR = LYGSHP.DOCOWRIDR

AND GENMFT.DUPNUM

= LYGSHP.DUPNUM
	 AND GENMFT.MSTDOCNUM = LYGSHP.MSTDOCNUM
	 AND GENMFT.SEQNUM
= LYGSHP.SEQNUM

AND
GENMFT.FLTNUM    = ?
	 AND GENMFT.FLTCARIDR = ?
	 AND LYGSHP.SEGORG    = ?
	 AND
GENMFT.FLTSEQNUM
=
?
	 AND SHPMST.SCCCOD   IS NOT NULL
	 GROUP BY
	   LYGSHP.SEGDST,
	   SHPMST.SCCCOD
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>293</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findImportPriorityDetailsForFlightFinalSummary" Type="NATIVE">
			<![CDATA[

			SELECT	SHPMST.MSTDOCNUM MSTDOCNUM,
				SHPMST.SCCCOD SCCCOD,
				SEGSHP.MFTWGT MFTWGT,
				SEGSHP.SHPPFX


SHPPFX

			FROM	OPRARPIMPFLT IMPFLT,
				OPRFLTSEG IMPFLTSEG,
				OPRSEGSHP SEGSHP,
				OPRSHPMST SHPMST,



				SHRSCCMST SHRSCC

			WHERE	IMPFLTSEG.POU = IMPFLT.ARPCOD
				AND IMPFLTSEG.FLTNUM = IMPFLT.FLTNUM



				AND IMPFLTSEG.FLTCARIDR = IMPFLT.FLTCARIDR
				AND IMPFLTSEG.FLTSEQNUM = IMPFLT.FLTSEQNUM
				AND

IMPFLTSEG.CMPCOD
= IMPFLT.CMPCOD
				AND SEGSHP.FLTNUM = IMPFLTSEG.FLTNUM
				AND SEGSHP.FLTCARIDR
=
IMPFLTSEG.FLTCARIDR

AND SEGSHP.FLTSEQNUM = IMPFLTSEG.FLTSEQNUM
				AND SEGSHP.SEGSERNUM = IMPFLTSEG.SEGSERNUM


AND SEGSHP.CMPCOD
= IMPFLTSEG.CMPCOD

				AND IMPFLT.FLTNUM = ?
				AND IMPFLT.FLTCARIDR = ?
				AND

IMPFLT.FLTSEQNUM =
?
				AND IMPFLT.CMPCOD = ?
				AND IMPFLT.LEGSERNUM = ?
				AND IMPFLT.ARPCOD =

?

				AND SHPMST.MSTDOCNUM
= SEGSHP.MSTDOCNUM
			        AND SHPMST.CMPCOD = SEGSHP.CMPCOD


AND SHPMST.SEQNUM = SEGSHP.SEQNUM

AND SHPMST.DUPNUM = SEGSHP.DUPNUM
			        AND SHPMST.DOCOWRIDR

= SEGSHP.DOCOWRIDR
					AND SHPMST.PARSEQNUM
= 0
				AND SHPMST.SCCCOD = SHRSCC.SCCCOD
			        AND

SHPMST.CMPCOD = SHRSCC.CMPCOD
			        AND
SHRSCC.URGENT IS NOT NULL



















			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>276</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findULDForFinalFlightSummary" Type="NATIVE">
			<![CDATA[

					SELECT
						  sum (
						  CASE
				    						WHEN (seluld.uldtyp = 'U' AND seluld.hndcod   ='KIU')



							THEN 1
							ELSE 0
						  END) sumHPLkiu,
 						  sum (
						  CASE
											WHEN (seluld.uldtyp


= 'U'  AND seluld.hndcod   ='THRU')
							THEN 1
							ELSE 0
						  END) sumHPLtru,
  						  sum


(
						  CASE
											WHEN (seluld.uldtyp = 'U'  AND nvl(seluld.hndcod,'#') not in ('KIU','THRU')


and nvl(seluld.intflg,'N')  !='Y'  )
							THEN 1
							ELSE 0
										  END) sumHPLbld, /*--****


Need to check whether nature check is needed or not  *****---*/
						  sum (
						  CASE



WHEN (seluld.uldtyp = 'U'  AND nvl(seluld.hndcod,'#') not in ('KIU','THRU')  and seluld.intflg  ='Y'


)
							THEN 1
							ELSE 0
						  END) sumHPLintact, /*--**** END OF Q7 *****---*/
						  sum
(


						  CASE
										    WHEN (seluld.uldtyp = 'M'  AND seluld.hndcod   ='KIU')

THEN 1


						    ELSE 0
						  END) sumMPLkiu,
						  sum (
							CASE
											  WHEN
(seluld.uldtyp
= 'M'  AND
seluld.hndcod   ='THRU')
							  THEN 1
							  ELSE 0
							END) sumMPLtru,

sum
(

CASE
											  WHEN (seluld.uldtyp = 'M'  AND nvl(seluld.hndcod,'#') not in ('KIU','THRU')

and nvl(seluld.intflg,'N')
!='Y'  )
							  THEN 1
							  ELSE 0
							END) sumMPLbld,


						  sum (
							CASE

WHEN (seluld.uldtyp = 'M'  AND nvl(seluld.hndcod,'#') not in
('KIU','THRU')
and seluld.intflg   ='Y'
)
							  THEN 1
							  ELSE 0
						  END) sumMPLintact
,/*--**** END
OF Q6 *****---*/
						  sum
(
							CASE
											  WHEN (seluld.uldtyp = 'L'  AND
seluld.hndcod
='KIU' )
							  THEN 1

							  ELSE 0
							END) sumLPLkiu,
							sum
(
							CASE

											  WHEN (seluld.uldtyp = 'L'  AND seluld.hndcod
='THRU' )

THEN 1
							  ELSE 0
							END)
sumLPLtru,
							 sum (
							CASE

WHEN (seluld.uldtyp
= 'L'  AND nvl(seluld.hndcod,'#')
not in ('KIU','THRU') and nvl(seluld.intflg,'N')
!='Y')

THEN 1
							  ELSE 0
							END)
sumLPLbld,
							 sum (
							CASE

											  WHEN
(seluld.uldtyp = 'L'  AND nvl(seluld.hndcod,'#')
not in ('KIU','THRU') and seluld.intflg  ='Y' )


							  THEN 1
							  ELSE 0
						  END)
sumLPLintact, /*--**** END OF L *****---*/
						  sum
(
							CASE

											  WHEN
(seluld.uldtyp = 'C'  AND seluld.hndcod   ='KIU' )

THEN 1
							  ELSE 0
							END) sumLDCkiu,


							sum (
							CASE
											  WHEN
(seluld.uldtyp = 'C'  AND seluld.hndcod   ='THRU' )

							  THEN
1
							  ELSE 0

END) sumLDCtru,
							 sum (
							CASE
											  WHEN (seluld.uldtyp
=
'C'  AND nvl(seluld.hndcod,'#')
not in ('KIU','THRU') and nvl(seluld.intflg,'N') !='Y' )

							  THEN
1
							  ELSE 0

END) sumLDCbld,
						  sum (
							CASE
											  WHEN (seluld.uldtyp
=
'C'  AND nvl(seluld.hndcod,'#')
not in ('KIU','THRU') and seluld.intflg  ='Y' )
							  THEN 1


							  ELSE 0
						  END)
sumLDCintact /*--**** END OF C *****---*/

				  FROM oprsegseluld seluld,


					   oprfltseg
seg,
								       oprarpimpflt flt  ,
		  						   SHRULDTYPMST ULDTYPMST


				  WHERE flt.fltnum

= ?
                  AND   flt.fltcaridr = ?
				  AND   flt.fltseqnum = ?
				  AND
flt.cmpcod
=
?
				  AND   flt.legsernum = ?
				  AND   flt.arpcod = ?

				  AND seluld.fltnum = seg.fltnum



				  AND seluld.fltcaridr = seg.fltcaridr
				  AND seluld.fltseqnum = seg.fltseqnum
				  AND seluld.segsernum


= seg.segsernum
				  AND seluld.cmpcod = seg.cmpcod

				  AND seg.fltnum = flt.fltnum
				  AND seg.pou


= flt.arpcod
                  AND seg.fltcaridr = flt.fltcaridr
				  AND seg.fltseqnum = flt.fltseqnum



				  AND seg.cmpcod = flt.cmpcod
								  AND seluld.CMPCOD               = ULDTYPMST.CMPCOD


								  AND
SUBSTR(seluld.ULDNUM, 0, 3) = ULDTYPMST.ULDTYPCOD


			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>277</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findCargoDataForFinalFlightSummary" Type="NATIVE">
			<![CDATA[

			SELECT SUM(
				  CASE
				    WHEN(shpmst.dstcod = impflt.arpcod
				    AND ULDSHP.CMPCOD IS NOT


NULL
				    AND ULDSHP.RCVPCS  >0)
				    THEN 1
				    ELSE 0
				  END) cntawbintloc,
				  SUM(



				  CASE
				    WHEN(shpmst.dstcod = impflt.arpcod
				    AND ULDSHP.CMPCOD IS NOT NULL)


				    THEN ULDSHP.RCVPCS

				    ELSE 0
				  END) sumpcsintloc,
				  SUM(
				  CASE

WHEN(shpmst.dstcod
= impflt.arpcod

				    AND ULDSHP.CMPCOD IS NOT NULL)
				    THEN ULDSHP.RCVWGT

ELSE
0
				  END) sumwgtintloc,

				  /*- *****  END OF intact LOCAL ***** --*/
				  SUM(

CASE

				    WHEN(shpmst.dstcod  != impflt.arpcod

				    AND ULDSHP.CMPCOD   IS NOT
NULL
				    AND ULDSHP.RCVPCS
>0
				    AND impflt.fltcarcod = NVL(selshp.nxtcarcod,
impflt.fltcarcod))

THEN 1
				    ELSE
0
				  END) cntawbinttrnsit,
				  SUM(
				  CASE

				    WHEN(shpmst.dstcod
!= impflt.arpcod

				    AND ULDSHP.CMPCOD   IS NOT NULL
				    AND impflt.fltcarcod
= NVL(selshp.nxtcarcod,
impflt.fltcarcod))

				    THEN ULDSHP.RCVPCS
				    ELSE 0
				  END) sumpcsinttrnsit,


				  SUM(
				  CASE
				    WHEN(shpmst.dstcod
!= impflt.arpcod
				    AND ULDSHP.CMPCOD   IS NOT
NULL

				    AND impflt.fltcarcod = NVL(selshp.nxtcarcod,
impflt.fltcarcod))
				    THEN ULDSHP.RCVWGT

ELSE
0
				  END) sumwgtinttrnsit,
				  /*- *****
END OF intact transit ***** --*/
				  SUM(

CASE

				    WHEN(shpmst.dstcod   != impflt.arpcod

				    AND ULDSHP.CMPCOD    IS
NOT NULL
				    AND ULDSHP.RCVPCS
>0
				    AND impflt.fltcarcod != selshp.nxtcarcod)


				    THEN 1
				    ELSE 0
				  END) cntawbinttrnfer,

				  SUM(
				  CASE
				    WHEN(shpmst.dstcod

!= impflt.arpcod
				    AND ULDSHP.CMPCOD    IS NOT NULL

				    AND impflt.fltcarcod != selshp.nxtcarcod)


				    THEN ULDSHP.RCVPCS
				    ELSE 0
				  END) sumpcsinttrnfer,

				  SUM(
				  CASE

WHEN(shpmst.dstcod
!= impflt.arpcod
				    AND ULDSHP.CMPCOD    IS NOT NULL

				    AND
impflt.fltcarcod != selshp.nxtcarcod)

				    THEN ULDSHP.RCVWGT
				    ELSE 0
				  END) sumwgtinttrnfer,


				  /*- *****  END OF intact transfer
***** --*/
				  (SUM (
				  CASE
				    WHEN(shpmst.dstcod
= impflt.arpcod
)
				    THEN (

				      CASE
					WHEN((segshp.rcvpcs - NVL(ULDSHP.RCVPCS,
0) - NVL(ULDSHP.KIUPCS,
0) - NVL(ULDSHP.THRPCS, 0))
> 0)
					THEN 1
					ELSE 0
				      END)

ELSE 0
				  END) )cntawblosloc,

				  (SUM
(
				  CASE
				    WHEN(shpmst.dstcod = impflt.arpcod
)
				    THEN (segshp.rcvpcs - NVL(ULDSHP.RCVPCS,

0) - NVL(ULDSHP.KIUPCS, 0) - NVL(ULDSHP.THRPCS,
0) )
				    ELSE 0
				  END) )sumpcslosloc,

				  (SUM
(
				  CASE
				    WHEN(shpmst.dstcod


= impflt.arpcod
				    AND (segshp.rcvpcs - NVL(ULDSHP.RCVPCS, 0) - NVL(ULDSHP.KIUPCS, 0) - NVL(ULDSHP.THRPCS,


0)) > 0)
				    THEN (
				      CASE
					WHEN selshp.ncswgt > 0
					THEN selshp.ncswgt
					WHEN


selshp.selwgt > 0
					THEN selshp.selwgt
					ELSE segshp.rcvwgt
				      END - NVL(ULDSHP.RCVWGT,


0) - NVL(ULDSHP.KIUWGT, 0) - NVL(ULDSHP.THRWGT, 0))
				    ELSE 0
				  END) )sumwgtlosloc,

/*-

*****  END OF loose LOCAL ***** --*/
				  (SUM (
				  CASE
				    WHEN(shpmst.dstcod  != impflt.arpcod



				    AND impflt.fltcarcod = NVL(selshp.nxtcarcod, impflt.fltcarcod))
				    THEN (
				      CASE


					WHEN((segshp.rcvpcs
- NVL(ULDSHP.RCVPCS, 0) - NVL(ULDSHP.KIUPCS, 0) - NVL(ULDSHP.THRPCS, 0)) >
0)

					THEN 1
					ELSE 0

				      END)
				    ELSE 0
				  END) )cntawblostrnsit,

(SUM (

				  CASE
				    WHEN(shpmst.dstcod
!= impflt.arpcod
				    AND impflt.fltcarcod =
NVL(selshp.nxtcarcod,
impflt.fltcarcod))
				    THEN
(segshp.rcvpcs - NVL(ULDSHP.RCVPCS, 0) - NVL(ULDSHP.KIUPCS,
0) - NVL(ULDSHP.THRPCS,
0))
				    ELSE
0
				  END) )sumpcslostrnsit,
				  (SUM (
				  CASE

WHEN(shpmst.dstcod

!= impflt.arpcod

AND impflt.fltcarcod

= NVL(selshp.nxtcarcod,
impflt.fltcarcod)
				    AND (segshp.rcvpcs - NVL(ULDSHP.RCVPCS, 0) - NVL(ULDSHP.KIUPCS,

0) - NVL(ULDSHP.THRPCS,
0)) > 0)
				    THEN (
				      CASE
					WHEN selshp.ncswgt > 0
					THEN

selshp.ncswgt
					WHEN
selshp.selwgt > 0
					THEN selshp.selwgt
					ELSE segshp.rcvwgt

				      END
- NVL(ULDSHP.RCVWGT,
0) - NVL(ULDSHP.KIUWGT, 0) - NVL(ULDSHP.THRWGT, 0))
				    ELSE 0
				  END)
)sumwgtlostrnsit,


				  /*- *****  END OF loose transit ***** --*/
				  (SUM (
				  CASE

				    WHEN(shpmst.dstcod
!= impflt.arpcod

				    AND impflt.fltcarcod != selshp.nxtcarcod)

				    THEN (

CASE
					WHEN((segshp.rcvpcs - NVL(ULDSHP.RCVPCS,
0) - NVL(ULDSHP.KIUPCS, 0) - NVL(ULDSHP.THRPCS,
0))
> 0)
					THEN 1
					ELSE 0
				      END)

				    ELSE 0
				  END) )cntawblostrnfer,


				  (SUM (
				  CASE
				    WHEN(shpmst.dstcod   != impflt.arpcod

AND impflt.fltcarcod
!= selshp.nxtcarcod)

				    THEN (segshp.rcvpcs - NVL(ULDSHP.RCVPCS, 0) - NVL(ULDSHP.KIUPCS,

0) - NVL(ULDSHP.THRPCS, 0))

				    ELSE 0
				  END) )sumpcslostrnfer,
				  (SUM (

CASE

WHEN(shpmst.dstcod
!= impflt.arpcod
				    AND impflt.fltcarcod

!= selshp.nxtcarcod
				    AND
(segshp.rcvpcs - NVL(ULDSHP.RCVPCS, 0) - NVL(ULDSHP.KIUPCS, 0) - NVL(ULDSHP.THRPCS,

0)) > 0)

				    THEN (
				      CASE
					WHEN selshp.ncswgt > 0
					THEN selshp.ncswgt

WHEN
selshp.selwgt >
0
					THEN selshp.selwgt
					ELSE segshp.rcvwgt
				      END - NVL(ULDSHP.RCVWGT,

0) - NVL(ULDSHP.KIUWGT,
0) - NVL(ULDSHP.THRWGT, 0))
				    ELSE 0
				  END) )sumwgtlostrnfer,


				  /*- *****  END OF
loose transfer ***** --*/
				  SUM(
				  CASE
				    WHEN(ULDSHP.CMPCOD
IS NOT NULL


				    AND ULDSHP.KIUPCS   >0)
				    THEN 1
				    ELSE 0
				  END)
cntawbintkiu,
				  SUM(
				  CASE


				    WHEN(ULDSHP.CMPCOD IS NOT NULL)
				    THEN ULDSHP.KIUPCS

ELSE 0
				  END) sumpcsintkiu,


				  SUM(
				  CASE
				    WHEN(ULDSHP.CMPCOD IS NOT NULL)

THEN ULDSHP.KIUWGT
				    ELSE
0

				  END) sumwgtintkiu,
				  /*- *****  END OF KIU *****
--*/
				  SUM(
				  CASE

				    WHEN(ULDSHP.CMPCOD
IS NOT NULL
				    AND ULDSHP.THRPCS
>0)
				    THEN 1
				    ELSE 0
				  END)
cntawbintthr,

				  SUM(
				  CASE
				    WHEN(ULDSHP.CMPCOD
IS NOT NULL)
				    THEN ULDSHP.THRPCS

				    ELSE 0

				  END) sumpcsintthr,

SUM(
				  CASE
				    WHEN(ULDSHP.CMPCOD IS NOT NULL)

				    THEN ULDSHP.THRWGT


ELSE 0
				  END) sumwgtintthr
				  /*- *****  END OF THRU *****
--*/
				   FROM oprsegselshp selshp,


				  oprarpimpflt impflt      ,
				  oprsegshp segshp
,
				  oprshpmst shpmst         ,

(SELECT
SUM(
				    CASE
				      WHEN SELULD.HNDCOD = 'KIU'

				      THEN 0

WHEN SELULD.HNDCOD
= 'THRU'
				      THEN 0
				      ELSE SEGULD.RCVPCS
				    END)
RCVPCS,

SUM(
				    CASE

				      WHEN SELULD.HNDCOD = 'KIU'
				      THEN 0


WHEN SELULD.HNDCOD = 'THRU'
				      THEN 0

				      ELSE SEGULD.RCVWGT
				    END) RCVWGT,


				    SUM(
				    CASE
				      WHEN SELULD.HNDCOD = 'KIU'

				      THEN SEGULD.RCVPCS


				      WHEN SELULD.HNDCOD = 'THRU'
				      THEN 0
				      ELSE 0
				    END)
KIUPCS,

SUM(

				    CASE
				      WHEN SELULD.HNDCOD = 'KIU'
				      THEN SEGULD.RCVWGT


				      WHEN SELULD.HNDCOD
= 'THRU'
				      THEN 0
				      ELSE 0
				    END) KIUWGT,

SUM(

				    CASE

				      WHEN SELULD.HNDCOD = 'KIU'
				      THEN 0

WHEN SELULD.HNDCOD = 'THRU'


				      THEN SEGULD.RCVPCS
				      ELSE 0

END) THRPCS,
				    SUM(
				    CASE
				      WHEN SELULD.HNDCOD

= 'KIU'
				      THEN 0

WHEN SELULD.HNDCOD = 'THRU'
				      THEN SEGULD.RCVWGT


				      ELSE 0
				    END) THRWGT
,
				    SEGULD.CMPCOD   ,
				    SEGULD.MSTDOCNUM,

				    SEGULD.DOCOWRIDR,


SEGULD.DUPNUM   ,
				    SEGULD.SEQNUM   ,
				    SEGULD.FLTNUM
,
				    SEGULD.FLTCARIDR,


				    SEGULD.FLTSEQNUM,
				    SEGULD.SEGSERNUM
				     FROM
OPRSEGULDSHP SEGULD,
				    OPRSEGSELULD
SELULD

				    WHERE SEGULD.CMPCOD     = SELULD.CMPCOD

				  AND SEGULD.FLTCARIDR
= SELULD.FLTCARIDR
				  AND
SEGULD.FLTNUM         = SELULD.FLTNUM
				  AND
SEGULD.FLTSEQNUM
= SELULD.FLTSEQNUM
				  AND SEGULD.SEGSERNUM
= SELULD.SEGSERNUM
				  AND
SEGULD.ULDNUM
= SELULD.ULDNUM
				  AND SEGULD.ULDNUM        <>
'BULK'
				  AND NVL(SEGULD.RCVPCS,
0) > 0
				 GROUP
BY SEGULD.CMPCOD,
				    SEGULD.MSTDOCNUM   ,

				    SEGULD.DOCOWRIDR
,
				    SEGULD.DUPNUM
,
				    SEGULD.SEQNUM      ,
				    SEGULD.FLTNUM
,
				    SEGULD.FLTCARIDR
,
				    SEGULD.FLTSEQNUM
,
				    SEGULD.SEGSERNUM
				  )ULDSHP

				  WHERE selshp.fltnum
= impflt.fltnum
				AND selshp.fltcaridr
= impflt.fltcaridr
				AND selshp.fltseqnum
= impflt.fltseqnum

				AND selshp.cmpcod     = impflt.cmpcod

AND selshp.mstdocnum  = segshp.mstdocnum

				AND selshp.docowridr
= segshp.docowridr
				AND selshp.dupnum
= segshp.dupnum
				AND selshp.seqnum
= segshp.seqnum

				AND selshp.fltnum     = segshp.fltnum

AND selshp.fltcaridr  = segshp.fltcaridr

				AND selshp.fltseqnum
= segshp.fltseqnum
				AND selshp.segsernum
= segshp.segsernum
				AND selshp.cmpcod
= segshp.cmpcod

				AND selshp.mstdocnum  = ULDSHP.mstdocnum(+)

AND selshp.docowridr  = ULDSHP.docowridr(+)


				AND selshp.dupnum     = ULDSHP.dupnum(+)

AND selshp.seqnum     = ULDSHP.seqnum(+)
				AND selshp.fltnum

= ULDSHP.fltnum(+)
				AND selshp.fltcaridr
= ULDSHP.fltcaridr(+)
				AND selshp.fltseqnum  = ULDSHP.fltseqnum(+)


				AND selshp.segsernum
= ULDSHP.segsernum(+)
				AND selshp.cmpcod     = shpmst.cmpcod
				AND segshp.mstdocnum

= shpmst.mstdocnum

AND segshp.docowridr  = shpmst.docowridr
				AND segshp.dupnum     = shpmst.dupnum


				AND segshp.seqnum
= shpmst.seqnum
				AND segshp.cmpcod     = shpmst.cmpcod
				AND shpmst.parseqnum

= 0
				AND impflt.fltnum
= ?
				AND impflt.fltcaridr  = ?
				AND impflt.fltseqnum  = ?
				AND

impflt.cmpcod     = ?
				AND
impflt.legsernum  = ?
				AND impflt.arpcod     = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>278</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findMailDataForFinalFlightSummary" Type="NATIVE">
			<![CDATA[
					SELECT
						SUM (CASE WHEN (CONMST.DSTCOD = IMPFLT.ARPCOD AND NVL(CONMST.POAFLG, '#') ='Y')



							 THEN 1
							 ELSE 0
						END) LOCINTULDCNT, /* local intact uld count*/
						SUM (CASE
WHEN
(CONMST.DSTCOD
= IMPFLT.ARPCOD AND NVL(CONMST.POAFLG, '#') !='Y')
							 THEN 1
							 ELSE
0

						END) LOCLOSULDCNT,
/* local loose uld count*/
						SUM (CASE WHEN (CONMST.DSTCOD = IMPFLT.ARPCOD
AND
NVL(CONMST.POAFLG,
'#') ='Y')
							 THEN ULDSEG.BAGCNT
							 ELSE 0
						END) LOCINTPCS, /*
local
intact pcs*/

SUM (CASE WHEN (CONMST.DSTCOD = IMPFLT.ARPCOD AND NVL(CONMST.POAFLG, '#')
!='Y')

							 THEN ULDSEG.BAGCNT

ELSE 0
						END) LOCLOSPCS,  /* local loose pcs
*/
						SUM (CASE WHEN
(CONMST.DSTCOD = IMPFLT.ARPCOD
AND NVL(CONMST.POAFLG, '#') ='Y')
							 THEN
ULDSEG.BAGWGT

							 ELSE 0
						END) LOCINTWGT,  /*
local intact weight*/
						SUM (CASE
WHEN (CONMST.DSTCOD = IMPFLT.ARPCOD
AND NVL(CONMST.POAFLG, '#')
!='Y')
							 THEN ULDSEG.BAGWGT

ELSE 0
						END) LOCLOSWGT,
/* local loose weight*/

0 TRNINTULDCNT ,
						0 TRNLOSULDCNT,

0 TRNINTPCS,
						0 TRNLOSPCS,

						0 TRNINTWGT,

0 TRNLOSWGT,
						0 TRFINTULDCNT,

0 TRFLOSULDCNT,
						0 TRFINTPCS,

						0 TRFLOSPCS,

0 TRFINTWGT,
						0 TRFLOSWGT



FROM  MALULDSEG ULDSEG,
					      MALFLTCON
CONMST,

					      OPRARPIMPFLT IMPFLT


WHERE
					      CONMST.FLTNUM=IMPFLT.FLTNUM

					      AND CONMST.FLTCARIDR=IMPFLT.FLTCARIDR


					      AND CONMST.FLTSEQNUM=IMPFLT.FLTSEQNUM

					      AND CONMST.LEGSERNUM = IMPFLT.LEGSERNUM

AND
CONMST.CMPCOD=IMPFLT.CMPCOD

					      AND CONMST.FLTNUM=ULDSEG.FLTNUM

					      AND
CONMST.FLTCARIDR=ULDSEG.FLTCARIDR

					      AND CONMST.FLTSEQNUM=ULDSEG.FLTSEQNUM


					      AND CONMST.SEGSERNUM = ULDSEG.SEGSERNUM
					      AND
CONMST.CMPCOD=ULDSEG.CMPCOD

AND CONMST.CONNUM=ULDSEG.ULDNUM


					      AND IMPFLT.FLTNUM = ?

AND IMPFLT.FLTCARIDR
= ?
					      AND IMPFLT.FLTSEQNUM = ?

					      AND IMPFLT.CMPCOD = ?

AND
IMPFLT.LEGSERNUM = ?
				      	      AND IMPFLT.ARPCOD = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>279</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findULDForFinalFlightSummaryExport" Type="NATIVE">
			<![CDATA[

					SELECT
									  sum (
									  CASE
										WHEN (seguld.ULDCTR = 'Q7' and seguld.ULDPOS


= 'M'  AND seguld.hndcod   ='KIU' )
										THEN 1
										ELSE 0
									  END) sumHPLkiu,



									  sum (
									  CASE
										WHEN (seguld.ULDCTR = 'Q7' and seguld.ULDPOS = 'M'  AND
seguld.hndcod

='THRU')
										THEN 1
										ELSE 0
									  END) sumHPLtru,
									  sum
(
									  CASE


WHEN (seguld.ULDCTR = 'Q7' and seguld.ULDPOS = 'M' AND nvl(seguld.THRUNT,
'N') !='Y' and nvl(seguld.HNDCOD,

'#') not in ('KIU','THRU'))
										THEN 1
										ELSE 0

END) sumHPLbld,

									  sum
(
									  CASE
										WHEN (seguld.ULDCTR = 'Q7' and
seguld.ULDPOS = 'M' AND seguld.THRUNT
='Y'
and nvl(seguld.HNDCOD, '#') not in ('KIU','THRU'))

THEN 1
										ELSE 0

									  END)
sumHPLintact,
									  sum (
									  CASE

WHEN (nvl(seguld.ULDCTR, '#') != 'Q7'
and
seguld.ULDPOS = 'M'  AND seguld.hndcod   ='KIU')

THEN 1
									        ELSE 0


END) sumMPLkiu,
									  sum (
									  CASE

WHEN (nvl(seguld.ULDCTR, '#') != 'Q7'

and seguld.ULDPOS = 'M'  AND seguld.hndcod   ='THRU')

THEN 1
									  ELSE 0


END) sumMPLtru,
									  sum (
										CASE

WHEN (nvl(seguld.ULDCTR, '#') != 'Q7' and

seguld.ULDPOS = 'M' AND nvl(seguld.THRUNT, 'N') !='Y' and
nvl(seguld.HNDCOD, '#') not in ('KIU','THRU'))


THEN 1
										  ELSE 0
										END)
sumMPLbld,
									  sum (
										CASE
										  WHEN

(nvl(seguld.ULDCTR, '#') != 'Q7' and seguld.ULDPOS
= 'M' AND seguld.THRUNT ='Y' and nvl(seguld.HNDCOD,

'#') not in ('KIU','THRU'))
										  THEN 1

ELSE 0
									  END) sumMPLintact ,/*--****

END OF Q6 *****---*/
									  sum (
										CASE

WHEN (seguld.ULDPOS = 'L'  AND seguld.hndcod

='KIU' )
										  THEN 1
										  ELSE 0

END) sumLPLkiu,
									  sum (

										CASE

										 WHEN (seguld.ULDPOS
= 'L'  AND seguld.hndcod   ='THRU' )
										  THEN
1
										  ELSE 0

										END)
sumLPLtru,
									  sum (
										CASE

										  WHEN (seguld.ULDPOS = 'L' AND nvl(seguld.THRUNT,

'N') !='Y' and nvl(seguld.HNDCOD, '#') not in ('KIU','THRU'))

										  THEN 1

ELSE 0

END) sumLPLbld,
									  sum (
										CASE
										 WHEN
(seguld.ULDPOS = 'L'
AND seguld.THRUNT
='Y' and nvl(seguld.HNDCOD, '#') not in ('KIU','THRU'))

										  THEN
1
										  ELSE 0

END) sumLPLintact, /*--**** END OF L *****---*/
									  sum
(

CASE
										   WHEN (seguld.ULDPOS
= 'C'  AND seguld.hndcod   ='KIU' )
										  THEN
1

ELSE 0
										END) sumLDCkiu,

									  sum (
										CASE


WHEN (seguld.ULDPOS = 'C'  AND seguld.hndcod   ='THRU' )

										  THEN 1


										  ELSE 0
										END) sumLDCtru,
									  sum (
										CASE
										  WHEN
(seguld.ULDPOS
= 'C'
AND nvl(seguld.THRUNT, 'N') !='Y' and nvl(seguld.HNDCOD, '#') not in ('KIU','THRU'))



										  THEN 1
										  ELSE 0
										END) sumLDCbld,
									  sum (

CASE
										   WHEN

(seguld.ULDPOS = 'C' AND seguld.THRUNT ='Y' and nvl(seguld.HNDCOD, '#') not
in ('KIU','THRU'))


										  THEN 1
										  ELSE 0
					 	 END) sumLDCintact /*--****
END OF C *****---*/



			  FROM OPRSEGULD
seguld,
					OPRFLTSEG seg,
			       OPRARPEXPFLT flt


WHERE flt.fltnum = ?

					AND   flt.fltcaridr
= ?
					AND   flt.fltseqnum = ?
					AND   flt.cmpcod
= ?
					AND   flt.legsernum
= ?
					AND   flt.arpcod
= ?

					AND seguld.fltnum = seg.fltnum

AND seguld.fltcaridr = seg.fltcaridr

					AND seguld.fltseqnum
= seg.fltseqnum
					AND seguld.segsernum
= seg.segsernum
					AND seguld.cmpcod
= seg.cmpcod

					AND
seg.fltnum = flt.fltnum
					AND seg.pol
= flt.arpcod
					AND seg.fltcaridr
= flt.fltcaridr
					AND
seg.fltseqnum = flt.fltseqnum
					AND
seg.cmpcod = flt.cmpcod

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>280</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findCargoDataForFinalFlightSummaryExport" Type="NATIVE">
			<![CDATA[

					SELECT
			/*- *****  START OF LOOSE LOCAL ***** --*/
  						SUM (
							CASE
							  WHEN (SHPMST.ORGCOD


= EXPFLT.ARPCOD AND NVL(LDRDTL.ULDCNT,0) = 0 AND SEGSHP.BDPPCS > 0)
							  THEN 1
							  ELSE 0



							END) CNTAWBLOSLOC,
							SUM (CASE
							  WHEN (SHPMST.ORGCOD = EXPFLT.ARPCOD AND NVL(LDRDTL.ULDCNT,0)


= 0)
							  THEN SEGSHP.BDPPCS
							  ELSE 0
							END) SUMPCSLOSLOC,
							SUM (CASE



							  WHEN (SHPMST.ORGCOD = EXPFLT.ARPCOD AND NVL(LDRDTL.ULDCNT,0) = 0)
							  THEN SEGSHP.BDPWGT



							  ELSE 0
							END) SUMWGTLOSLOC,
			  /*- *****  START OF LOOSE TRANSIT ***** --*/


							  SUM (

CASE
							  WHEN (SHPMST.ORGCOD != EXPFLT.ARPCOD AND IMPFLTSEG.FLTCARIDR =
SEGSHP.FLTCARIDR
AND NVL(LDRDTL.ULDCNT,0)
= 0 AND SEGSHP.BDPPCS > 0)
							  THEN 1
							  ELSE
0
							END) CNTAWBLOSTRNSIT,

							SUM (CASE

WHEN (SHPMST.ORGCOD != EXPFLT.ARPCOD
AND IMPFLTSEG.FLTCARIDR =  SEGSHP.FLTCARIDR
AND NVL(LDRDTL.ULDCNT,0)
= 0)
							  THEN SEGSHP.BDPPCS

ELSE 0
							END) SUMPCSLOSTRNSIT,

							SUM (CASE

WHEN (SHPMST.ORGCOD != EXPFLT.ARPCOD
AND IMPFLTSEG.FLTCARIDR =  SEGSHP.FLTCARIDR
AND NVL(LDRDTL.ULDCNT,0)
= 0)
							  THEN SEGSHP.BDPWGT

ELSE 0
							END) SUMWGTLOSTRNSIT,


				/*- *****  START OF
LOOSE TRANSFER ***** --*/

SUM (
							CASE
							  WHEN (SHPMST.ORGCOD
!= EXPFLT.ARPCOD  AND
(IMPFLTSEG.FLTCARIDR IS NULL OR
IMPFLTSEG.FLTCARIDR != SEGSHP.FLTCARIDR ) AND
NVL(LDRDTL.ULDCNT,0) =
0 AND SEGSHP.BDPPCS > 0)

THEN 1
							  ELSE 0
							END) CNTAWBLOSTRNFER,

							SUM (CASE

WHEN (SHPMST.ORGCOD
!= EXPFLT.ARPCOD  AND (IMPFLTSEG.FLTCARIDR IS NULL OR IMPFLTSEG.FLTCARIDR
!= SEGSHP.FLTCARIDR
) AND
NVL(LDRDTL.ULDCNT,0) = 0)
							  THEN SEGSHP.BDPPCS
							  ELSE 0

							END) SUMPCSLOSTRNFER,


SUM (CASE
							  WHEN (SHPMST.ORGCOD != EXPFLT.ARPCOD  AND (IMPFLTSEG.FLTCARIDR
IS NULL OR IMPFLTSEG.FLTCARIDR

!= SEGSHP.FLTCARIDR ) AND NVL(LDRDTL.ULDCNT,0) = 0)
							  THEN SEGSHP.BDPWGT

							  ELSE
0

						  END) SUMWGTLOSTRNFER ,
						  /*- *****  START OF  INTACT LOCAL ***** --*/


  						SUM (
							CASE

							  WHEN (SHPMST.ORGCOD = EXPFLT.ARPCOD AND NVL(LDRDTL.ULDCNT,0)
> 0
AND SEGSHP.BDPPCS > 0)
							  THEN
1
							  ELSE 0
							END) CNTAWBINTLOC,
							SUM (CASE


							  WHEN (SHPMST.ORGCOD = EXPFLT.ARPCOD
AND NVL(LDRDTL.ULDCNT,0) > 0)
							  THEN SEGSHP.BDPPCS


							  ELSE 0
							END) SUMPCSINTLOC,

							SUM (CASE
							  WHEN (SHPMST.ORGCOD = EXPFLT.ARPCOD

AND NVL(LDRDTL.ULDCNT,0) > 0)
							  THEN SEGSHP.BDPWGT

							  ELSE 0
							END) SUMWGTINTLOC,


						SUM (CASE
							  WHEN (SHPMST.ORGCOD = EXPFLT.ARPCOD AND NVL(LDRDTL.ULDCNT,0)
> 0)

THEN LDRDTL.ULDCNT

							  ELSE 0
							END) SUMNUMINTULDLOC,
			  /*- *****  START OF
INTACT
TRANSIT ***** --*/
							  SUM
(
							CASE
							  WHEN (SHPMST.ORGCOD != EXPFLT.ARPCOD AND
IMPFLTSEG.FLTCARIDR
=  SEGSHP.FLTCARIDR
AND NVL(LDRDTL.ULDCNT,0) > 0 AND SEGSHP.BDPPCS > 0)

							  THEN 1

ELSE 0

							END) CNTAWBINTTRNSIT,
							SUM (CASE
							  WHEN (SHPMST.ORGCOD !=
EXPFLT.ARPCOD
AND IMPFLTSEG.FLTCARIDR
=  SEGSHP.FLTCARIDR AND NVL(LDRDTL.ULDCNT,0) > 0)
							  THEN
SEGSHP.BDPPCS

ELSE 0

							END) SUMPCSINTTRNSIT,
							SUM (CASE
							  WHEN (SHPMST.ORGCOD
!= EXPFLT.ARPCOD
AND IMPFLTSEG.FLTCARIDR
=  SEGSHP.FLTCARIDR AND NVL(LDRDTL.ULDCNT,0) > 0)

							  THEN SEGSHP.BDPWGT

ELSE
0
							END) SUMWGTINTTRNSIT,
							SUM (CASE
							  WHEN (SHPMST.ORGCOD
!= EXPFLT.ARPCOD
AND IMPFLTSEG.FLTCARIDR
=  SEGSHP.FLTCARIDR AND NVL(LDRDTL.ULDCNT,0) > 0)
							  THEN
LDRDTL.ULDCNT

ELSE 0

							END) SUMNUMINTULDTRNSIT,
				/*- *****  START OF INTACT TRANSFER
***** --*/

SUM (
							CASE

WHEN (SHPMST.ORGCOD != EXPFLT.ARPCOD  AND (IMPFLTSEG.FLTCARIDR
IS NULL OR
IMPFLTSEG.FLTCARIDR != SEGSHP.FLTCARIDR
) AND NVL(LDRDTL.ULDCNT,0) > 0 AND SEGSHP.BDPPCS >
0)

THEN 1
							  ELSE 0
							END) CNTAWBINTTRNFER,

							SUM (CASE
							  WHEN (SHPMST.ORGCOD

!= EXPFLT.ARPCOD  AND (IMPFLTSEG.FLTCARIDR IS NULL OR IMPFLTSEG.FLTCARIDR
!= SEGSHP.FLTCARIDR ) AND
NVL(LDRDTL.ULDCNT,0)
> 0)
							  THEN SEGSHP.BDPPCS
							  ELSE 0

							END) SUMPCSINTTRNFER,

SUM (CASE

WHEN (SHPMST.ORGCOD != EXPFLT.ARPCOD  AND (IMPFLTSEG.FLTCARIDR
IS NULL OR IMPFLTSEG.FLTCARIDR
!= SEGSHP.FLTCARIDR
) AND NVL(LDRDTL.ULDCNT,0) > 0)
							  THEN SEGSHP.BDPWGT

							  ELSE
0
						  END) SUMWGTINTTRNFER,

SUM (CASE
							  WHEN (SHPMST.ORGCOD != EXPFLT.ARPCOD
AND
(IMPFLTSEG.FLTCARIDR IS NULL OR IMPFLTSEG.FLTCARIDR
!= SEGSHP.FLTCARIDR ) AND NVL(LDRDTL.ULDCNT,0)
>
0)
							  THEN LDRDTL.ULDCNT
							  ELSE 0

							END) SUMNUMINTULDTRNFER

			FROM OPRSEGSHP

SEGSHP, OPRARPEXPFLT EXPFLT , OPRFLTSEG EXPFLTSEG, OPRSHPMST
SHPMST,

                  (SELECT DOCOWRIDR,

MSTDOCNUM, LDR.CMPCOD, SEQNUM, DUPNUM, COUNT(ULDNUM) ULDCNT

                  FROM

OPRLDRDTL LDR, OPRLDRSHP LDRSHP WHERE LDR.LDRNUM = LDRSHP.LDRNUM AND LDR.ULDNUM IS NOT NULL



                  GROUP BY DOCOWRIDR, MSTDOCNUM, LDR.CMPCOD, SEQNUM, DUPNUM) LDRDTL
,


                  (select IMPFLT.FLTCARIDR,IMPSEGSHP.MSTDOCNUM
,IMPSEGSHP.CMPCOD,

IMPSEGSHP.DOCOWRIDR
,IMPSEGSHP.DUPNUM,IMPSEGSHP.SEQNUM, IMPFLT.POU


from OPRSEGSHP
IMPSEGSHP ,OPRFLTSEG IMPFLT where
                   IMPSEGSHP.FLTCARIDR = IMPFLT.FLTCARIDR



                  AND IMPSEGSHP.FLTSEQNUM = IMPFLT.FLTSEQNUM
                  AND IMPSEGSHP.SEGSERNUM

= IMPFLT.SEGSERNUM

                  AND IMPSEGSHP.FLTNUM = IMPFLT.FLTNUM


                  AND IMPSEGSHP.CMPCOD = IMPFLT.CMPCOD

                   ) IMPFLTSEG



                  WHERE SEGSHP.FLTNUM = EXPFLTSEG.FLTNUM
                  AND SEGSHP.FLTCARIDR
= EXPFLTSEG.FLTCARIDR


                  AND SEGSHP.FLTSEQNUM = EXPFLTSEG.FLTSEQNUM

                  AND
SEGSHP.SEGSERNUM
= EXPFLTSEG.SEGSERNUM
                  AND SEGSHP.CMPCOD = EXPFLTSEG.CMPCOD




                  AND EXPFLTSEG.POL = EXPFLT.ARPCOD
                  AND EXPFLTSEG.FLTNUM
= EXPFLT.FLTNUM


                  AND EXPFLTSEG.FLTCARIDR = EXPFLT.FLTCARIDR

AND EXPFLTSEG.FLTSEQNUM
= EXPFLT.FLTSEQNUM

                  AND EXPFLTSEG.CMPCOD
= EXPFLT.CMPCOD


                  AND expflt.fltnum = ?
                  AND expflt.fltcaridr

= ?
                  AND expflt.fltseqnum
= ?
                  AND expflt.cmpcod = ?


                  AND expflt.legsernum
= ?
                  AND expflt.arpcod = ?


AND SEGSHP.MSTDOCNUM
= LDRDTL.MSTDOCNUM
(+)
                  AND SEGSHP.DOCOWRIDR = LDRDTL.DOCOWRIDR(+)



                  AND SEGSHP.DUPNUM = LDRDTL.DUPNUM(+)
                  AND SEGSHP.SEQNUM
= LDRDTL.SEQNUM(+)


                  AND SEGSHP.CMPCOD = LDRDTL.CMPCOD(+)


AND SEGSHP.MSTDOCNUM = IMPFLTSEG.MSTDOCNUM
(+)

                  AND SEGSHP.DOCOWRIDR
= IMPFLTSEG.DOCOWRIDR(+)

                  AND SEGSHP.DUPNUM = IMPFLTSEG.DUPNUM(+)


                  AND SEGSHP.SEQNUM = IMPFLTSEG.SEQNUM
(+)
                  AND SEGSHP.CMPCOD = IMPFLTSEG.CMPCOD(+)


                  AND
IMPFLTSEG.POU(+) = ?

                  AND SEGSHP.MSTDOCNUM = SHPMST.MSTDOCNUM



                  AND SEGSHP.DOCOWRIDR = SHPMST.DOCOWRIDR
                  AND SEGSHP.DUPNUM
= SHPMST.DUPNUM


                  AND SEGSHP.SEQNUM = SHPMST.SEQNUM

AND SEGSHP.CMPCOD = SHPMST.CMPCOD

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>314</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findExportPriorityDetailsForFlightFinalSummary" Type="NATIVE">
			<![CDATA[

			SELECT	SHPMST.MSTDOCNUM MSTDOCNUM,
					SHPMST.SCCCOD SCCCOD,
					SEGSHP.MFTWGT MFTWGT,
					SEGSHP.SHPPFX


SHPPFX

			FROM	OPRARPEXPFLT EXPFLT,
					OPRFLTSEG IMPFLTSEG,
					OPRSEGSHP SEGSHP,
					OPRSHPMST


SHPMST,
					SHRSCCMST SHRSCC

			WHERE	IMPFLTSEG.POL = EXPFLT.ARPCOD
					AND IMPFLTSEG.FLTNUM = EXPFLT.FLTNUM



					AND IMPFLTSEG.FLTCARIDR = EXPFLT.FLTCARIDR
					AND IMPFLTSEG.FLTSEQNUM = EXPFLT.FLTSEQNUM


					AND IMPFLTSEG.CMPCOD
= EXPFLT.CMPCOD
					AND SEGSHP.FLTNUM = IMPFLTSEG.FLTNUM
					AND SEGSHP.FLTCARIDR

= IMPFLTSEG.FLTCARIDR

AND SEGSHP.FLTSEQNUM = IMPFLTSEG.FLTSEQNUM
					AND SEGSHP.SEGSERNUM = IMPFLTSEG.SEGSERNUM


					AND SEGSHP.CMPCOD
= IMPFLTSEG.CMPCOD

					AND EXPFLT.FLTNUM = ?
					AND EXPFLT.FLTCARIDR = ?


					AND EXPFLT.FLTSEQNUM
= ?
					AND EXPFLT.CMPCOD = ?
					AND EXPFLT.LEGSERNUM = ?
					AND EXPFLT.ARPCOD

= ?

				AND SHPMST.MSTDOCNUM
= SEGSHP.MSTDOCNUM
				AND SHPMST.CMPCOD = SEGSHP.CMPCOD
				AND SHPMST.SEQNUM

= SEGSHP.SEQNUM
				AND
SHPMST.DUPNUM = SEGSHP.DUPNUM
				AND SHPMST.DOCOWRIDR = SEGSHP.DOCOWRIDR



				AND SHPMST.SCCCOD = SHRSCC.SCCCOD

				AND SHPMST.CMPCOD = SHRSCC.CMPCOD
				AND SHRSCC.URGENT
IS NOT NULL







			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>343</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findMailDataForFinalFlightSummaryExport" Type="NATIVE">
			<![CDATA[
  		SELECT
  			SUM (CASE WHEN (CONMST.ASGPRT = ASGFLT.ARPCOD AND NVL(CONMST.POAFLG, 'N') ='Y')



  				 THEN 1
  				 ELSE 0
  			END) LOCINTULDCNT, /* local intact uld count*/
  			SUM (CASE WHEN

(CONMST.ASGPRT
= ASGFLT.ARPCOD AND NVL(CONMST.POAFLG, 'N') !='Y')
  				 THEN 1
  				 ELSE 0

END)
LOCLOSULDCNT,
/* local loose uld count*/
  			SUM (CASE WHEN (CONMST.ASGPRT = ASGFLT.ARPCOD AND
NVL(CONMST.POAFLG,

'N') ='Y')
  				 THEN ULDSEG.BAGCNT
  				 ELSE 0
  			END) LOCINTPCS, /* local
intact pcs*/
  			SUM

(CASE WHEN (CONMST.ASGPRT = ASGFLT.ARPCOD AND NVL(CONMST.POAFLG, 'N') !='Y')

THEN ULDSEG.BAGCNT


ELSE 0
  			END) LOCLOSPCS,  /* local loose pcs */
  			SUM (CASE WHEN (CONMST.ASGPRT
= ASGFLT.ARPCOD

AND NVL(CONMST.POAFLG, 'N') ='Y')
  				 THEN ULDSEG.BAGWGT
  				 ELSE 0
  			END)
LOCINTWGT,  /* local

intact weight*/
  			SUM (CASE WHEN (CONMST.ASGPRT = ASGFLT.ARPCOD AND NVL(CONMST.POAFLG,
'N') !='Y')


THEN ULDSEG.BAGWGT
  				 ELSE 0
  			END) LOCLOSWGT,  /* local loose weight*/

0 TRNINTULDCNT ,


0 TRNLOSULDCNT,
  			0 TRNINTPCS,
  			0 TRNLOSPCS,
  			0 TRNINTWGT,
  			0
TRNLOSWGT,
  			0 TRFINTULDCNT,


0 TRFLOSULDCNT,
  			0 TRFINTPCS,
  			0 TRFLOSPCS,

0 TRFINTWGT,
  			0 TRFLOSWGT

  		FROM	 MALULDSEG ULDSEG,
  MALFLTCON CONMST,
  MALFLT ASGFLT

  		WHERE
  			 CONMST.FLTNUM=ASGFLT.FLTNUM


  			 AND CONMST.FLTCARIDR=ASGFLT.FLTCARIDR

AND CONMST.FLTSEQNUM=ASGFLT.FLTSEQNUM
  			 AND CONMST.LEGSERNUM

= ASGFLT.LEGSERNUM
  			 AND CONMST.CMPCOD=ASGFLT.CMPCOD


AND CONMST.FLTNUM=ULDSEG.FLTNUM


  			 AND CONMST.FLTCARIDR=ULDSEG.FLTCARIDR
  			 AND CONMST.FLTSEQNUM=ULDSEG.FLTSEQNUM

AND CONMST.SEGSERNUM

=ULDSEG.SEGSERNUM
  			 AND CONMST.CMPCOD=ULDSEG.CMPCOD
  			 AND CONMST.CONNUM=ULDSEG.ULDNUM




  			 AND ASGFLT.FLTNUM = ?
  			 AND ASGFLT.FLTCARIDR = ?
  			 AND ASGFLT.FLTSEQNUM = ?
  			 AND
ASGFLT.CMPCOD

= ?
  			 AND ASGFLT.LEGSERNUM = ?
  			 AND ASGFLT.ARPCOD = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>250</QRY:Id>
		<QRY:Source Name="operations.flthandling.findemptyuldsnotReceived" Type="NATIVE">
			<![CDATA[
		  SELECT  ULD.ULDNUM ULDUM,
			SEG.POL POL,
			SEG.POU POU ,
			ULD.FLTNUM,
			ULD.FLTSEQNUM,
			ULD.FLTCARIDR,
			ULD.SEGSERNUM,
			ULD.CMPCOD

		FROM	OPRSEGULD ULD,
			OPRFLTSEG SEG
			WHERE
			ULD.FLTCARIDR = SEG.FLTCARIDR AND
			ULD.FLTNUM=SEG.FLTNUM AND
			ULD.FLTSEQNUM=SEG.FLTSEQNUM AND
			ULD.SEGSERNUM=SEG.SEGSERNUM AND
			ULD.CMPCOD = SEG.CMPCOD AND
			SEG.FLTCARIDR = ? AND
			SEG.FLTNUM = ? AND
			SEG.SEGSERNUM = ? AND
			SEG.CMPCOD = ? AND
			SEG.FLTSEQNUM = ? AND
			ULD.CONIDR <> 'C' AND
			ULD.ULDNUM <> 'BULK' AND
			NVL(ULD.RCVFLG,'N') <> ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>297</QRY:Id>
		<QRY:Source Name="operations.flthandling.findulddetailsforach" Type="NATIVE">
			<![CDATA[

				SELECT impflt.cmpcod,
			  impflt.arpcod impfltarpcod,
			  impflt.fltcaridr,
			  impflt.fltnum,



			  NULL fltoprsta,
			  impflt.fltdat,
			  impflt.fltseqnum,
			  impflt.clsflg,
			  impflt.mftsrc,



			  impflt.lstupdtim impfltlstupdtim,
			  impflt.lstupdusr impfltlstupdusr,
			  fltseg.pol,


			  fltseg.pou,

			  NULL segsernum,
			  NULL docowridr,
			  seguld.uldnum mstdocnum,seluld.uldsym,


			  NULL dupnum,

			  NULL seqnum,
			  NULL shppfx,
			  NULL segmftpcs,
			  NULL segmftwgt,


			  NULL segmftvol,
			  NULL
rcvpcs,
			  NULL rcvwgt,
			  NULL rcvvol,
			  NULL arvrmk,
			  seguld.lstupdtim

segshplstupdtim,

			  seguld.lstupdusr segshplstupdusr,
			  uldshp.mstdocnum selmstdocnum,


			  NULL selpcs,
			  NULL selwgt,

			  NULL percod,
			  NULL ugtcod,
			  NULL splcod,

NULL
fwdcod,
			  NULL trpmod,
			  NULL bucflg,

			  seluld.intflg,
			  NULL nxtcarcod,

NULL
nxtfltnum,
			  NULL nxtfltdat,
			  NULL oltcod,

			  seluld.NCSFLTCARCOD ncsfltcarcod,

seluld.NCSFLTNUM
ncsfltnum,
			  seluld.NCSFLTDAT ncsfltdat,

			  seluld.trptyp,
			  seluld.ulddis,

seluld.selrmk,

			  NULL uldpcs,
			  NULL uldwgt,
			  NULL
blkpcs,
			  NULL blkwgt,
			  NULL
comdes,
			  NULL srcind,

			  NULL selshplstupdtim,
			  NULL selshplstupdusr,


			  seguld.uldnum
uldnum,
			  shpmst.docnum,

			  /*  seguld.thrunt,*/
			shpmst.scccod,
			  coalesce(seluld.ORGCOD,fltseg.pol)

orgcod,
			  coalesce(seluld.DSTCOD,fltseg.pou)
dstcod,
			  shpmst.stdpcs,
			  shpmst.conflg,


			  shpmst.stdwgt,
			  shpmst.shpcod,
			  shpmst.shpnam,

			  shpmst.shpadrone,
			  shpmst.cnscod,


			  shpmst.cnsnam,
			  shpmst.cnsadrone,
			  shpmst.parseqnum,

			  NULL shpadrtwo,
			  NULL
shpcty,

			  NULL shpstt,
			  NULL shpctr,
			  NULL shptelnum,

			  NULL shpmalidr,

NULL shppstcod,
			  NULL
cnsadrtwo,
			  NULL cnscty,
			  NULL cnsstt,
			  NULL
cnsctr,
			  NULL
cnstelnum,
			  NULL cnsmalidr,

			  NULL cnspstcod,
			  NULL cnsprtnfnflg,

			  NULL shprefnum,

NULL shpaccnum,
			  NULL cnsaccnum,

			  NULL arpshparpcod,
			  NULL arpshplstupdusr,


NULL arpshplstupdtim,
			  NULL aracod,
			  NULL
arashpmftpcs,
			  NULL arashpmftwgt,
			  NULL arashplstupdtim,


			  NULL arashplstupdusr,
			  arpmst.cntcod,

			  NULL strtim,
			  NULL docrcvflg,
			  SHPMST.STDWGTCOD

WGTCOD,NULL MANWGTCOD,'ULD/AWB/' ||
			  (SELECT
COUNT(*) shpdes
			   FROM oprseguldshp
			   WHERE

uldnum = seguld.uldnum
							and fltnum=impflt.fltnum

							and fltseqnum=impflt.fltseqnum)

SHPDES,
			  NULL ADMUPDFLG,NVL(SELULD.ACHSTA,'N') ACHSTA,null ADMSTA,

			  NULL CHKDGT, NULL
SRVCRGCLS,SELULD.NCSINVORG,UNKARPMST.UKNARPCODNCSFLG

			/*--SEGULD.MFTFLG,SEGULD.RCVFLG,SEGULD.BDPFLG,


			--SEGULD.RMK SEGULDRMK

			--SELULD.ACTTMP, SELULD.CSDFLG,

			--SELULD.CSHFLG, SELULD.HLEFLG,

--SELULD.HNDCOD,

			--SELULD.NOOCVRFLG, SELULD.PCHFLG,
			--SELULD.PLCCVRFLG,
SELULD.PLCDWSFLG,

--SELULD.PLCUPSFLG, SELULD.PLTNETFLG,

			--SELULD.REQTMP,
			--SELULD.STPFLG,
SELULD.STPNUM,

--SELULD.TRNFLG,
			--SELULD.ULDNAT,
			--SELULD.WHSCOD,
SELULD.WODSPTFLG,
			--SELULD.WODSPTNUM,SELULD.ORGCOD

ULDORG,
			--SELULD.DSTCOD ULDDST,*/
			FROM oprarpimpflt
impflt,
			  oprfltseg fltseg,
			  oprseguld

seguld,
			  oprsegseluld seluld,
			  oprseguldshp uldshp,

			  oprshpmst shpmst,
			  shrarpmst

arpmst,
			  SHRARPMST UNKARPMST
			WHERE fltseg.cmpcod = impflt.cmpcod

			 AND fltseg.fltnum =

impflt.fltnum
			 AND fltseg.fltseqnum = impflt.fltseqnum
			 AND fltseg.fltcaridr
= impflt.fltcaridr


			 AND fltseg.pou = impflt.arpcod
			 AND fltseg.cmpcod = seguld.cmpcod
			 AND fltseg.fltnum
= seguld.fltnum


			 AND fltseg.fltseqnum = seguld.fltseqnum
			 AND fltseg.fltcaridr = seguld.fltcaridr

			 AND
fltseg.segsernum
= seguld.segsernum
			 AND seguld.cmpcod = seluld.cmpcod
			 AND seguld.fltnum =
seluld.fltnum

AND
seguld.fltseqnum = seluld.fltseqnum
			 AND seguld.fltcaridr = seluld.fltcaridr

			 AND seguld.segsernum

= seluld.segsernum
			 AND seguld.uldnum = seluld.uldnum
			 AND seguld.cmpcod =
uldshp.cmpcod(+)


			 AND seguld.fltnum = uldshp.fltnum(+)
			 AND seguld.fltseqnum = uldshp.fltseqnum(+)

			 AND
seguld.fltcaridr
= uldshp.fltcaridr(+)
			 AND seguld.segsernum = uldshp.segsernum(+)
			 AND seguld.uldnum

= uldshp.uldnum(+)

			 AND uldshp.cmpcod = shpmst.cmpcod(+)
			 AND uldshp.docowridr = shpmst.docowridr(+)


			 AND uldshp.mstdocnum
= shpmst.mstdocnum(+)
			 AND uldshp.dupnum = shpmst.dupnum(+)
			 AND uldshp.seqnum

= shpmst.seqnum(+)

			 AND shpmst.cmpcod = arpmst.cmpcod(+)
			 AND shpmst.dstcod = arpmst.arpcod(+)


			 AND shpmst.CMPCOD
= UNKARPMST.CMPCOD(+)
			 AND shpmst.ORGCOD = UNKARPMST.ARPCOD(+)
			 AND impflt.cmpcod

= ?
			 AND
impflt.fltseqnum = ?
			 AND impflt.fltcaridr = ?
			 AND impflt.fltnum = ?
			 AND impflt.arpcod

=
?
			 AND seguld.uldnum <> 'BULK'
			 AND (seluld.ulddis='K'
			 AND seluld.trptyp IN ('T','H'))

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>350</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findctoflightdetailsforawb">
			<![CDATA[
						SELECT IMPFLT.CMPCOD, IMPFLT.ARPCOD, IMPFLT.FLTCARIDR, IMPFLT.FLTNUM,
						IMPFLT.FLTDAT, IMPFLT.FLTSEQNUM,


IMPFLT.CLSFLG, IMPFLT.FLTCARCOD,
						IMPFLT.LEGSERNUM,'FLTROU' FLTROU, SEGSHP.RCVPCS , SEGSELSHP.FWDCOD



						FROM OPRSHPMST MST, OPRSEGSHP SEGSHP, OPRARPIMPFLT IMPFLT, OPRFLTSEG SEG ,OPRSEGSELSHP SEGSELSHP



						WHERE MST.MSTDOCNUM = SEGSHP.MSTDOCNUM
							   AND MST.DOCOWRIDR = SEGSHP.DOCOWRIDR


							   AND MST.DUPNUM
= SEGSHP.DUPNUM
							   AND MST.SEQNUM = SEGSHP.SEQNUM
							   AND MST.CMPCOD
= SEGSHP.CMPCOD


AND IMPFLT.CMPCOD = SEG.CMPCOD
							   AND IMPFLT.ARPCOD = SEG.POU

AND IMPFLT.FLTCARIDR
=
SEG.FLTCARIDR
							   AND IMPFLT.FLTNUM = SEG.FLTNUM
							   AND IMPFLT.FLTSEQNUM
= SEG.FLTSEQNUM


AND SEGSHP.CMPCOD = SEG.CMPCOD
							   AND SEGSHP.SEGSERNUM = SEG.SEGSERNUM

AND SEGSHP.FLTCARIDR

= SEG.FLTCARIDR
							   AND SEGSHP.FLTNUM = SEG.FLTNUM
							   AND SEGSHP.FLTSEQNUM
= SEG.FLTSEQNUM


							   AND SEGSELSHP.MSTDOCNUM(+) = SEGSHP.MSTDOCNUM

AND SEGSELSHP.DOCOWRIDR(+) = SEGSHP.DOCOWRIDR


							   AND SEGSELSHP.DUPNUM(+) = SEGSHP.DUPNUM

AND SEGSELSHP.SEQNUM(+) =SEGSHP.SEQNUM

							   AND
SEGSELSHP.CMPCOD(+) = SEGSHP.CMPCOD

AND IMPFLT.CLSFLG='Y'
							   AND MST.MSTDOCNUM
= ?

AND MST.DOCOWRIDR = ?
							   AND
MST.DUPNUM = ?
							   AND MST.SEQNUM = ?

							   AND MST.CMPCOD
= ?
							   AND IMPFLT.ARPCOD = ?


			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>355</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.checkAWBmanifestedcargohandling" Type="NATIVE">
			<![CDATA[
               SELECT
               		SEGSHP.MSTDOCNUM, SEGSHP.DOCOWRIDR, SEGSHP.DUPNUM, SEGSHP.SEQNUM,


SEGSHP.SEGSERNUM,
               		IMPFLT.CMPCOD, ARPSHP.AVLPCS, ARPSHP.RCVPCS, IMPFLT.FLGFLG

		FROM


OPRARPIMPFLT IMPFLT,
			OPRSEGSHP SEGSHP,
			OPRFLTSEG FLTSEG,
			OPRARPSHP ARPSHP

		WHERE	IMPFLT.CMPCOD


= ?
			AND IMPFLT.ARPCOD = ?
			AND IMPFLT.FLTNUM = ?
			AND IMPFLT.FLTCARIDR = ?
			AND IMPFLT.FLTSEQNUM


= ?
			AND IMPFLT.LEGSERNUM = ?

			AND SEGSHP.MSTDOCNUM = ?
			AND SEGSHP.DOCOWRIDR = ?
			AND SEGSHP.DUPNUM


= ?
			AND SEGSHP.SEQNUM = ?

			AND ARPSHP.ARPCOD(+) = ?

			AND FLTSEG.POU = IMPFLT.ARPCOD
			AND

FLTSEG.FLTNUM
= IMPFLT.FLTNUM
			AND FLTSEG.FLTCARIDR = IMPFLT.FLTCARIDR
			AND FLTSEG.FLTSEQNUM =
IMPFLT.FLTSEQNUM


AND FLTSEG.CMPCOD = IMPFLT.CMPCOD

			AND SEGSHP.FLTNUM = FLTSEG.FLTNUM
			AND
SEGSHP.FLTCARIDR = FLTSEG.FLTCARIDR


AND SEGSHP.FLTSEQNUM = FLTSEG.FLTSEQNUM
			AND SEGSHP.SEGSERNUM
= FLTSEG.SEGSERNUM
			AND SEGSHP.CMPCOD

= FLTSEG.CMPCOD

			AND ARPSHP.MSTDOCNUM(+) = SEGSHP.MSTDOCNUM

AND ARPSHP.DOCOWRIDR(+) = SEGSHP.DOCOWRIDR


			AND ARPSHP.DUPNUM(+) = SEGSHP.DUPNUM
			AND ARPSHP.SEQNUM(+)
= SEGSHP.SEQNUM
			AND ARPSHP.CMPCOD(+)
= SEGSHP.CMPCOD


			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>356</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.checkareadetailsalreadyexists" Type="NATIVE">
			<![CDATA[
               SELECT 1 SEGARP FROM (
	       SELECT 1
	       FROM 	OPRSEGSELSHP SEGSELSHP, OPRSEGSHP


SEGSHP, OPRFLTSEG SEG, OPRARPIMPFLT IMP
	       WHERE    IMP.CMPCOD = SEG.CMPCOD
	           	AND IMP.FLTCARIDR


= SEG.FLTCARIDR
	           	AND IMP.FLTNUM       = SEG.FLTNUM
	           	AND IMP.FLTSEQNUM    =
SEG.FLTSEQNUM


	           	AND IMP.ARPCOD       = SEG.POU

	           	AND SEG.CMPCOD
= SEGSHP.CMPCOD

	           	AND SEG.FLTCARIDR
= SEGSHP.FLTCARIDR
	           	AND
SEG.FLTNUM       = SEGSHP.FLTNUM

	           	AND SEG.FLTSEQNUM
= SEGSHP.FLTSEQNUM


AND SEGSHP.CMPCOD   = SEGSELSHP.CMPCOD

	           	AND SEGSHP.FLTCARIDR
= SEGSELSHP.FLTCARIDR

AND SEGSHP.FLTNUM    = SEGSELSHP.FLTNUM

	           	AND SEGSHP.FLTSEQNUM
= SEGSELSHP.FLTSEQNUM

AND SEGSHP.SEGSERNUM = SEGSELSHP.SEGSERNUM

	           	AND SEGSHP.DOCOWRIDR
= SEGSELSHP.DOCOWRIDR

AND SEGSHP.MSTDOCNUM = SEGSELSHP.MSTDOCNUM

	           	AND SEGSHP.DUPNUM
= SEGSELSHP.DUPNUM

AND SEGSHP.SEQNUM    = SEGSELSHP.SEQNUM


	           	AND SEGSELSHP.CMPCOD
= ?

AND SEGSELSHP.FLTCARIDR = ?
	                AND SEGSELSHP.FLTNUM
= ?


AND SEGSELSHP.FLTSEQNUM = ?
	                AND SEGSELSHP.DOCOWRIDR
= ?
	                AND SEGSELSHP.MSTDOCNUM

= ?
	                AND SEGSELSHP.DUPNUM = ?

	                AND SEGSELSHP.SEQNUM
= ?

	                AND SEG.POU = ?
	                AND SEGSELSHP.UGTCOD
IS NOT
NULL
	       UNION ALL
	       SELECT 1
FROM OPRARPARASHP WHERE
	                OPRARPARASHP.CMPCOD

= ?
	                AND OPRARPARASHP.MSTDOCNUM
= ?
	                AND OPRARPARASHP.DOCOWRIDR = ?


	                AND OPRARPARASHP.DUPNUM = ?

	                AND OPRARPARASHP.SEQNUM
= ?

	                AND ROWNUM =1
	         )
               WHERE ROWNUM =1

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>334</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findldrdetailsforbil01uld" Type="NATIVE">
			<![CDATA[
			  SELECT ULDSHP.CMPCOD             ,
			    ULDSHP.ULDNUM                   ,
          		SEGULD.ARPCOD,



			    NULL SHPPFX                     ,
			    NULL DOCOWRIDR                  ,
			    NULL MSTDOCNUM


,
			    NULL DUPNUM                     ,
			    NULL SEQNUM                     ,
			    SEGULD.FLTCARIDR


,
			    SEGULD.FLTNUM                   ,
			    SEGULD.FLTSEQNUM                ,
			    SEGULD.SEGSERNUM


,
			    NULL DMGCOD						,
			    SEGULD.FLTDAT                   ,
          		NULL MFTPCS


,
			    NULL MFTWGT                     ,
			    SEGULD.NCSFLTCARCOD             ,
			    SEGULD.NCSFLTNUM


,
			    SEGULD.NCSFLTDAT                ,
                SEGULD.LDRNUM                   ,


			    SEGULD.BNDTRPNUM

			    FROM
			    ( SELECT DISTINCT ULD.ULDNUM,
                  ULD.CMPCOD

,
			      ULD.FLTCARIDR
,
			      ULD.FLTNUM                ,
			      ULD.FLTSEQNUM

,
			      ULD.SEGSERNUM
,
			      ULD.BNDTRPNUM             ,
            	  ULD.LDRNUM

,
            	  ULD.BILSTA
,
			      SEG.POU                   ,
			      ULD.ULDDIS

,
			      IMP.ARPCOD
,
			      ULD.NCSFLTCARCOD          ,
			      ULD.NCSFLTDAT

,
			      ULD.NCSFLTNUM
,
			      IMP.FLTDAT
			       FROM OPRSEGSELULD ULD,


			      OPRFLTSEG SEG         ,
			      OPRARPIMPFLT
IMP      ,
			      SHRSYSPAR DAT         ,

OPRSEGULD
SEGULD
			      WHERE IMP.CMPCOD   = SEG.CMPCOD

			    AND IMP.FLTCARIDR    = SEG.FLTCARIDR


			    AND IMP.FLTNUM       = SEG.FLTNUM
			    AND IMP.FLTSEQNUM
= SEG.FLTSEQNUM
			    AND IMP.ARPCOD

= SEG.POU
			    AND SEG.CMPCOD       = ULD.CMPCOD

AND SEG.FLTCARIDR    = ULD.FLTCARIDR


AND SEG.FLTNUM       = ULD.FLTNUM
			    AND SEG.FLTSEQNUM
= ULD.FLTSEQNUM
			    AND SEG.SEGSERNUM

= ULD.SEGSERNUM
			    AND SEGULD.CMPCOD    = ULD.CMPCOD

			    AND SEGULD.FLTCARIDR = ULD.FLTCARIDR


			    AND SEGULD.FLTNUM    = ULD.FLTNUM
			    AND SEGULD.FLTSEQNUM
= ULD.FLTSEQNUM
			    AND SEGULD.SEGSERNUM

= ULD.SEGSERNUM
			    AND SEGULD.ULDNUM    = ULD.ULDNUM

			    AND SEGULD.RCVFLG    = 'Y'


			    AND IMP.CLSFLG       = 'N'
			    AND IMP.ARPCOD       = ?
			    AND
IMP.CMPCOD       = DAT.CMPCOD


			    AND DAT.PARCOD       = ?
			    AND ( SELECT MAX(ATA) FROM FLTOPRLEG
WHERE


                              CMPCOD = IMP.CMPCOD
                              AND FLTCARIDR =
IMP.FLTCARIDR


                              AND FLTNUM =IMP. FLTNUM
                              AND
FLTSEQNUM =
IMP. FLTSEQNUM

                              AND LEGDST = IMP. ARPCOD
) BETWEEN( SYSDATE
- DAT.PARVAL ) AND SYSDATE
			    AND ULD.TRPTYP = 'T'

			    AND ULD.ULDDIS
= 'K'
			    AND ULD.LDRNUM
IS NOT NULL
			    AND NVL(ULD.BILSTA,'N') NOT IN ('Y','S')


) SEGULD,
			    OPRSEGULDSHP ULDSHP

			    WHERE ULDSHP.FLTNUM = SEGULD.FLTNUM
			  AND ULDSHP.FLTSEQNUM

= SEGULD.FLTSEQNUM
			  AND ULDSHP.FLTCARIDR
= SEGULD.FLTCARIDR
			  AND ULDSHP.CMPCOD     = SEGULD.CMPCOD


			  AND ULDSHP.ULDNUM     = SEGULD.ULDNUM

AND ULDSHP.SEGSERNUM  = SEGULD.SEGSERNUM
			 	 GROUP
BY ULDSHP.CMPCOD,

			    ULDSHP.ULDNUM      ,

SEGULD.ARPCOD,
			    SEGULD.FLTCARIDR
,
			    SEGULD.FLTNUM
,
			    SEGULD.FLTSEQNUM   ,

			    SEGULD.SEGSERNUM   ,

SEGULD.FLTDAT      ,

			    SEGULD.NCSFLTCARCOD,
			    SEGULD.NCSFLTNUM
,
			    SEGULD.NCSFLTDAT
,
			    SEGULD.BNDTRPNUM
,
          		SEGULD.LDRNUM      ,
			    SEGULD.BILSTA
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>369</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findshipmentLocationDetails" Type="NATIVE">
			<![CDATA[
	        	SELECT SHPLOC.CMPCOD, SHPLOC.DOCOWRIDR, SHPLOC.MSTDOCNUM, SHPLOC.DUPNUM, SHPLOC.SEQNUM, SHPLOC.FLTNUM,



					   SHPLOC.FLTCARIDR, SHPLOC.FLTSEQNUM, SHPLOC.LEGSERNUM, SHPLOC.LOCCOD, SHPLOC.PCS, SHPLOC.STRDAT,



				       SHPLOC.ENDDAT,  SHPLOC.SERNUM, SHPLOC.DLVRTNFLG, SELSHP.CNSSRTTIM, SHPMST.DOCNUM
				  FROM

OPRSEGSHPLOC
SHPLOC, OPRSEGSELSHP SELSHP, OPRSHPMST SHPMST
				  WHERE SHPLOC.CMPCOD =  SELSHP.CMPCOD


					AND SHPLOC.DOCOWRIDR
= SELSHP.DOCOWRIDR
					AND SHPLOC.MSTDOCNUM = SELSHP.MSTDOCNUM
					AND
SHPLOC.DUPNUM
= SELSHP.DUPNUM

					AND SHPLOC.SEQNUM = SELSHP.SEQNUM
					AND SHPLOC.FLTNUM =
SELSHP.FLTNUM

					AND SHPLOC.FLTCARIDR =
SELSHP.FLTCARIDR
					AND SHPLOC.FLTSEQNUM = SELSHP.FLTSEQNUM

AND SHPLOC.CMPCOD
= SHPMST.CMPCOD

					AND SHPLOC.DOCOWRIDR = SHPMST.DOCOWRIDR
					AND SHPLOC.MSTDOCNUM
= SHPMST.MSTDOCNUM

					AND SHPLOC.DUPNUM
= SHPMST.DUPNUM
					AND SHPLOC.SEQNUM = SHPMST.SEQNUM

AND SHPLOC.CMPCOD = ?

					AND SHPLOC.FLTNUM
= ?
					AND SHPLOC.FLTCARIDR = ?
					AND SHPLOC.FLTSEQNUM
= ?
					AND SHPLOC.LEGSERNUM
= ?
					AND
SHPLOC.MSTDOCNUM = ?
					AND SHPLOC.DOCOWRIDR = ?

AND SHPLOC.DUPNUM = ?
					AND SHPLOC.SEQNUM = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>361</QRY:Id>
		<QRY:Source Name="operations.flthandling.hashipmentforsegment" Type="NATIVE">
			<![CDATA[
					    SELECT 'Y' AS HASSHP
   						FROM DUAL
						  WHERE EXISTS
						  (SELECT SHP.MSTDOCNUM



							 FROM OPRSEGSHP SHP,
							OPRFLTSEG SEG      ,
							OPRARPIMPFLT FLT
							WHERE SEG.FLTNUM=FLT.FLTNUM



						  AND SEG.FLTCARIDR =FLT.FLTCARIDR
						  AND SEG.FLTSEQNUM =FLT.FLTSEQNUM
						  AND SEG.CMPCOD

=FLT.CMPCOD

						  AND SEG.FLTNUM    =SHP.FLTNUM
						  AND SEG.FLTCARIDR =SHP.FLTCARIDR


						  AND SEG.FLTSEQNUM =SHP.FLTSEQNUM

						  AND SEG.SEGSERNUM =SHP.SEGSERNUM
						  AND
SEG.CMPCOD
=SHP.CMPCOD
						  AND SEG.CMPCOD    =?

						  AND SEG.POL       =?

AND SEG.POU
=?
						  AND SEG.FLTNUM    =?
						  AND SEG.FLTCARIDR
=?
						  AND SEG.FLTSEQNUM =?
						  )
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>250</QRY:Id>
		<QRY:Source Name="operations.flthandling.findflightBookingsForAWB" Type="NATIVE">
			<![CDATA[
	 SELECT DTL.FLTCARIDR, DTL.FLTNUM, DTL.FLTSEQNUM,
	        DTL.FLTCARCOD, DTL.FLTDAT, DTL.FLTORG,



	        DTL.FLTDST, FLTMST.FLTTYP, LEG.ATA,
	        LEG.STA
	   FROM CAPBKGFLTDTL DTL,
	        CAPBKGMST

BKGMST,

	        FLTOPRMST FLTMST,
	        FLTOPRLEG LEG
	  WHERE FLTMST.FLTSEQNUM = DTL.FLTSEQNUM


	    AND FLTMST.FLTNUM
= DTL.FLTNUM
	    AND FLTMST.FLTCARIDR = DTL.FLTCARIDR
	    AND FLTMST.CMPCOD
= DTL.CMPCOD

	    AND BKGMST.DOCOWRIDR
= DTL.DOCOWRIDR
	    AND BKGMST.DUPNUM = DTL.DUPNUM

AND BKGMST.SEQNUM = DTL.SEQNUM

	    AND BKGMST.MSTDOCNUM
= DTL.MSTDOCNUM
	    AND LEG.FLTCARIDR
= FLTMST.FLTCARIDR
	    AND LEG.FLTNUM =
FLTMST.FLTNUM
	    AND
LEG.CMPCOD = FLTMST.CMPCOD
	    AND
LEG.FLTSEQNUM = FLTMST.FLTSEQNUM
	    AND
BKGMST.SEQNUM = ?

	    AND BKGMST.DOCOWRIDR = ?

AND BKGMST.MSTDOCNUM = ?
   AND BKGMST.DUPNUM = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>255</QRY:Id>
		<QRY:Source Name="operations.flthandling.findmasterdetailsforhouseselect" Type="NATIVE">
			<![CDATA[

					 SELECT SHPMIS.JNTCONFLG       ,
						  SHPMIS.GNDCHDFLG             ,
						  IMPFLT.CMPCOD


,
						  IMPFLT.FLTNUM                ,
						  IMPFLT.FLTCARIDR             ,
						  IMPFLT.FLTSEQNUM


,
						  SEGSHP.DOCOWRIDR             ,
						  SEGSHP.MSTDOCNUM             ,
						  SEGSHP.DUPNUM


,
						  SEGSHP.SEQNUM                ,
						  SEGSHP.SHPPFX                ,
						  SEGSHP.SEGSERNUM


,
						   SELSHP.MSTDOCNUM SELMSTDOCNUM,
						  SELSHP.SELPCS                ,
						  SELSHP.SELWGT


,
						  SELSHP.FWDCOD                ,
						  SEGSHP.MFTPCS                ,
						   SEGSHP.MFTWGT,



               SHPMST.CONFLG MSTCONFLG,
						  (SELECT SUM (SEGSELSHP.SELPCS )
							  FROM OPRSEGSELSHP

SEGSELSHP

							 WHERE SEGSELSHP.CMPCOD = SHPMST.CMPCOD
						  AND SEGSELSHP.DOCOWRIDR  =

SHPMST.DOCOWRIDR
						  AND
SEGSELSHP.MSTDOCNUM  = SHPMST.MSTDOCNUM
							   AND SEGSELSHP.DUPNUM

= SHPMST.DUPNUM
							   AND
SEGSELSHP.FLTNUM     = SEGSHP.FLTNUM
   AND SEGSELSHP.FLTCARIDR     =

SEGSHP.FLTCARIDR
						  AND SEGSELSHP.FLTSEQNUM
= SEGSHP.FLTSEQNUM
						  AND SEGSELSHP.SEQNUM

IN
						    (SELECT SEQNUM
						       FROM OPRSHPMST

WHERE MSTDOCNUM   = SHPMST.MSTDOCNUM


AND DOCOWRIDR       = SHPMST.DOCOWRIDR
						    AND DUPNUM
= SHPMST.DUPNUM START


WITH PARSEQNUM      = SHPMST.SEQNUM CONNECT BY PRIOR MSTDOCNUM = MSTDOCNUM

AND PRIOR DOCOWRIDR

= DOCOWRIDR
						    AND PRIOR DUPNUM    = DUPNUM
						    AND PRIOR SEQNUM
= PARSEQNUM


						    AND PRIOR CMPCOD    = CMPCOD
						    AND LEVEL           = 1
						    )


)TOTHAWBSELPCS,

						  (SELECT SUM (SEGSELSHP.SELWGT )
							  FROM OPRSEGSELSHP SEGSELSHP


							 WHERE SEGSELSHP.CMPCOD
= SHPMST.CMPCOD
						  AND SEGSELSHP.DOCOWRIDR  = SHPMST.DOCOWRIDR

AND
SEGSELSHP.MSTDOCNUM
= SHPMST.MSTDOCNUM
							   AND SEGSELSHP.DUPNUM = SHPMST.DUPNUM

AND
SEGSELSHP.FLTNUM
= SEGSHP.FLTNUM
   AND SEGSELSHP.FLTCARIDR     = SEGSHP.FLTCARIDR

AND SEGSELSHP.FLTSEQNUM
=
SEGSHP.FLTSEQNUM
						  AND SEGSELSHP.SEQNUM    IN
						    (SELECT SEQNUM

FROM OPRSHPMST


WHERE MSTDOCNUM   = SHPMST.MSTDOCNUM
						    AND DOCOWRIDR       = SHPMST.DOCOWRIDR

AND
DUPNUM
= SHPMST.DUPNUM START
						    WITH PARSEQNUM      = SHPMST.SEQNUM CONNECT BY
PRIOR
MSTDOCNUM = MSTDOCNUM

AND PRIOR DOCOWRIDR = DOCOWRIDR
						    AND PRIOR DUPNUM
= DUPNUM

AND PRIOR SEQNUM
= PARSEQNUM
						    AND PRIOR CMPCOD    = CMPCOD

AND LEVEL
= 1
						    )

						  )TOTHAWBSELWGT,
						  FLTSEG.POL    ,

FLTSEG.POU
					  FROM
OPRARPIMPFLT IMPFLT,

						   OPRFLTSEG FLTSEG,
						   OPRSEGSHP
SEGSHP,
						   OPRSEGSELSHP
SELSHP,
						   OPRSHPMST SHPMST,

						   OPRSHPMSTMIS SHPMIS

WHERE FLTSEG.CMPCOD =
IMPFLT.CMPCOD
					   AND FLTSEG.FLTNUM = IMPFLT.FLTNUM

					   AND FLTSEG.FLTSEQNUM
= IMPFLT.FLTSEQNUM

AND FLTSEG.FLTCARIDR = IMPFLT.FLTCARIDR
					   AND FLTSEG.POU
= IMPFLT.ARPCOD

AND FLTSEG.CMPCOD
= SEGSHP.CMPCOD
					   AND FLTSEG.FLTNUM = SEGSHP.FLTNUM

AND FLTSEG.FLTSEQNUM
= SEGSHP.FLTSEQNUM

AND FLTSEG.FLTCARIDR = SEGSHP.FLTCARIDR
					   AND FLTSEG.SEGSERNUM
= SEGSHP.SEGSERNUM

AND
SEGSHP.CMPCOD = SELSHP.CMPCOD(+)
					   AND SEGSHP.FLTNUM = SELSHP.FLTNUM(+)

AND SEGSHP.FLTSEQNUM

= SELSHP.FLTSEQNUM(+)
					   AND SEGSHP.FLTCARIDR = SELSHP.FLTCARIDR(+)

AND SEGSHP.SEGSERNUM

= SELSHP.SEGSERNUM(+)
					   AND SEGSHP.DOCOWRIDR = SELSHP.DOCOWRIDR(+)

AND SEGSHP.MSTDOCNUM

= SELSHP.MSTDOCNUM(+)
					   AND SEGSHP.DUPNUM = SELSHP.DUPNUM(+)
					   AND SEGSHP.SEQNUM
= SELSHP.SEQNUM(+)


AND SEGSHP.CMPCOD = SHPMST.CMPCOD
					   AND SEGSHP.DOCOWRIDR = SHPMST.DOCOWRIDR

AND SEGSHP.MSTDOCNUM

= SHPMST.MSTDOCNUM
					   AND SEGSHP.DUPNUM = SHPMST.DUPNUM
					   AND SEGSHP.SEQNUM
= SHPMST.SEQNUM


					    AND SHPMIS.CMPCOD = SHPMST.CMPCOD
					   AND SHPMIS.DOCOWRIDR = SHPMST.DOCOWRIDR


AND
SHPMIS.MSTDOCNUM = SHPMST.MSTDOCNUM
					   AND SHPMIS.DUPNUM= SHPMST.DUPNUM
					   AND SHPMIS.SEQNUM


= SHPMST.SEQNUM
					   AND IMPFLT.CMPCOD = ?
					   AND IMPFLT.FLTSEQNUM = ?
					   AND IMPFLT.FLTCARIDR


= ?
					   AND IMPFLT.FLTNUM = ?
					   AND FLTSEG.POU = ?


			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>254</QRY:Id>
		<QRY:Source Name="operations.flthandling.findawbdetailsformasterselect" Type="NATIVE">
			<![CDATA[

			 SELECT IMPFLT.CMPCOD                ,
			   IMPFLT.ARPCOD IMPFLTARPCOD         ,
			   IMPFLT.FLTCARIDR


,
			   IMPFLT.FLTNUM                      ,
			   IMPFLT.FLTOPRSTA                   ,
			   IMPFLT.FLTDAT


,
			   IMPFLT.FLTSEQNUM                   ,
			   IMPFLT.CLSFLG                      ,
			   IMPFLT.MFTSRC


,
			   IMPFLT.LSTUPDTIM IMPFLTLSTUPDTIM   ,
			   IMPFLT.LSTUPDUSR IMPFLTLSTUPDUSR   ,
			   IMPFLT.CARCHKENDFLG


,
			   AWBFLTSEG.POL                      ,
			   AWBFLTSEG.POU                      ,
			   AWBFLTSEG.SEGSERNUM


,
			   AWBFLTSEG.DOCOWRIDR                ,
			   AWBFLTSEG.MSTDOCNUM                ,
			   AWBFLTSEG.DUPNUM


,
			   AWBFLTSEG.SEQNUM                   ,
			   AWBFLTSEG.SHPPFX                   ,
			   AWBFLTSEG.MFTPCS


SEGMFTPCS         ,
			   AWBFLTSEG.MFTWGT SEGMFTWGT         ,
			   AWBFLTSEG.MFTVOL SEGMFTVOL


,
			   AWBFLTSEG.RCVPCS                   ,
			   AWBFLTSEG.RCVWGT                   ,
			   AWBFLTSEG.RCVVOL


,
			   AWBFLTSEG.ARVRMK                   ,
			   AWBFLTSEG.LSTUPDTIM SEGSHPLSTUPDTIM,
			   AWBFLTSEG.LSTUPDUSR


SEGSHPLSTUPDUSR,
			   SELSHP.PERCOD                      ,
			   SELSHP.UGTCOD


,
			   SELSHP.SPLCOD                      ,
			   SELSHP.FWDCOD                      ,
			   SELSHP.TRPMOD


,
			   SELSHP.BUCFLG                      ,
			   SELSHP.INTFLG                      ,
			   SELSHP.NXTCARCOD


,
			   SELSHP.NXTFLTNUM                   ,
			   SELSHP.NXTFLTDAT                   ,
			   SELSHP.NCSINVORG


,
			   SELSHP.LSEWGT                      ,
			   SELSHP.NCSWGT                      ,
			   SELSHP.OLTCOD


,
			   SELSHP.TRPTYP                      ,
			   SELSHP.ULDDIS                      ,
			   CASE



			     WHEN SELSHP.SELRMK IS NULL
			     THEN MIS.INSDTL
			     ELSE SELSHP.SELRMK
			   END SELRMK


,
			   SELSHP.ULDPCS                    ,
			   SELSHP.ULDWGT                    ,
			   SELSHP.BLKPCS


,
			   SELSHP.BLKWGT                    ,
			   SELSHP.COMDES                    ,
			   SELSHP.SRCIND


,
			   SELSHP.LSTUPDTIM SELSHPLSTUPDTIM ,
			   SELSHP.LSTUPDUSR SELSHPLSTUPDUSR ,
			   SELSHP.UDAFLG


,
			   SELSHP.LSEPCS                    ,
			   SELSHP.SELWGTCOD                 ,
			   SEGULDSHP.ULDNUM


,
			   SEGULDSHP.MFTPCS ULDMFTPCS       ,
			   SHPMST.DOCNUM                    ,
			   SHPMST.SCCCOD


,
			   SHPMST.ORGCOD                    ,
			   SHPMST.DSTCOD                    ,
			   SHPMST.STDPCS


,
			   SHPMST.CONFLG                    ,
			   SHPMST.STDWGT                    ,
			   SHPMST.SHPCOD


,
			   SHPMST.SHPNAM                    ,
			   SHPMST.SHPADRONE                 ,
			   SHPMST.CNSCOD


,
			   SHPMST.CNSNAM                    ,
			   SHPMST.CNSADRONE                 ,
			   SHPMST.STDWGTCOD


,
			   SHPMST.STDDISWGT                 ,
			   SHPMST.PARSEQNUM                 ,
			   SHPMST.SHPDES


,
			   MSTCNT.SHPADRTWO                 ,
			   MSTCNT.SHPCTY                    ,
			   MSTCNT.SHPSTT


,
			   MSTCNT.SHPCTR                    ,
			   MSTCNT.SHPTELNUM                 ,
			   MSTCNT.SHPMALIDR


,
			   MSTCNT.SHPPSTCOD                 ,
			   MSTCNT.CNSADRTWO                 ,
			   MSTCNT.CNSCTY


,
			   MSTCNT.CNSSTT                    ,
			   MSTCNT.CNSCTR                    ,
			   MSTCNT.CNSTELNUM


,
			   MSTCNT.CNSMALIDR                 ,
			   MSTCNT.CNSPSTCOD                 ,
			   MSTCNT.CNSPRTNFNFLG


,
			   MSTCNT.SHPREFNUM                 ,
			   MSTCNT.SHPACCNUM                 ,
			   MSTCNT.CNSACCNUM


,
			   MSTACC.SRVCRGCLS                 ,
			   ARPSHP.ARPCOD ARPSHPARPCOD       ,
			   ARPSHP.LSTUPDUSR


ARPSHPLSTUPDUSR ,
			   ARPSHP.LSTUPDTIM ARPSHPLSTUPDTIM ,
			   ARASHP.ARACOD                    ,



			   ARASHP.MFTPCS ARASHPMFTPCS       ,
			   ARASHP.MFTWGT ARASHPMFTWGT       ,
			   ARASHP.LSTUPDTIM

ARASHPLSTUPDTIM
,
			   ARASHP.LSTUPDUSR ARASHPLSTUPDUSR ,
			   ARPMST.CNTCOD                    ,


			   FLTHIS.STRTIM
,
			   SELSHP.DOCRCVFLG                 ,
			   SHPORG.UKNARPCODNCSFLG

,
			   SHPMST.LSTUPDTIM
SHPMSTLSTUPDTIM ,
			   (
			   CASE
			     WHEN SELSHP.SELDISWGT > 0 OR
AWBFLTSEG.SELPREFLG
IS NOT
NULL
			     THEN SELSHP.SELDISWGT
			     ELSE AWBFLTSEG.MFTWGT
			   END
) SELDISWGT,

			   (

			   CASE
			     WHEN SELSHP.SELPCS > 0 OR AWBFLTSEG.SELPREFLG IS
NOT NULL
			     THEN SELSHP.SELPCS


			     ELSE AWBFLTSEG.MFTPCS
			   END ) SELPCS,

(
			   CASE
			     WHEN SELSHP.SELWGT > 0
OR AWBFLTSEG.SELPREFLG
IS NOT NULL
			     THEN SELSHP.SELWGT

ELSE AWBFLTSEG.MFTWGT
			   END
) SELWGT
,
			   SELSHP.MSTDOCNUM SELMSTDOCNUM,

CASE
			     WHEN (SHPMST.SHPTYP
IS NOT NULL
			     AND
SHPMST.SHPTYP    = 'N')
			     THEN 'N'

ELSE ''
			   END CHKDGT,

			   AWBRCV.DOCRCVFLG AWBRCVFLG,

			   AWBFLTSEG.SELPREFLG

FROM OPRARPIMPFLT IMPFLT,
			   (SELECT
FLTSEG.POU       ,
			     FLTSEG.POL
,

SEGSHP.*				,
					  (SELECT 'Y'

					     FROM DUAL
					    WHERE EXISTS
					    (SELECT

MSTDOCNUM
					       FROM OPRSEGSELSHP SELTST

					      WHERE SELTST.CMPCOD   = SEGSHP.CMPCOD


AND SELTST.DOCOWRIDR    = SEGSHP.DOCOWRIDR
					    AND
SELTST.MSTDOCNUM    = SEGSHP.MSTDOCNUM


AND SELTST.DUPNUM       = SEGSHP.DUPNUM
					    AND
SELTST.SEQNUM       = SEGSHP.SEQNUM
					    AND

SELTST.FLTCARIDR    = SEGSHP.FLTCARIDR
					    AND
SELTST.FLTNUM       = SEGSHP.FLTNUM
					    AND

SELTST.FLTSEQNUM = SEGSHP.FLTSEQNUM
					    )

					  ) SELPREFLG
			      FROM OPRFLTSEG FLTSEG,


			     OPRSEGSHP SEGSHP
			     WHERE FLTSEG.CMPCOD
= SEGSHP.CMPCOD
			   AND FLTSEG.FLTNUM     =
SEGSHP.FLTNUM

			   AND FLTSEG.FLTSEQNUM  = SEGSHP.FLTSEQNUM

			   AND FLTSEG.FLTCARIDR
= SEGSHP.FLTCARIDR
			   AND FLTSEG.SEGSERNUM
= SEGSHP.SEGSERNUM
			   ) AWBFLTSEG
,

OPRSEGULDSHP SEGULDSHP,
			   OPRSEGSELSHP SELSHP
,
			   OPRSHPMST SHPMST      ,
			   OPRSHPMSTCNT

MSTCNT   ,
			   OPRSHPMSTACC MSTACC   ,
			   OPRARPSHP
ARPSHP      ,
			   OPRARPARASHP ARASHP
,

			   SHRARPMST ARPMST      ,
			   SHRARPMST SHPORG
,
			   OPRIMPFLTHIS FLTHIS   ,

OPRSHPMSTMIS
MIS      ,
			   (SELECT CMPCOD        ,
			     MSTDOCNUM
,
			     DOCOWRIDR
,

			     DUPNUM              ,
			     SEQNUM              ,
			     DOCRCVFLG
,

COUNT(1)

			      FROM OPRSEGSELSHP
			     WHERE DOCRCVFLG= 'Y'
			  GROUP BY CMPCOD,


			     MSTDOCNUM   ,

			     DOCOWRIDR   ,
			     DUPNUM      ,
			     SEQNUM      ,

DOCRCVFLG

			   ) AWBRCV

			   WHERE AWBFLTSEG.CMPCOD = IMPFLT.CMPCOD
			 AND AWBFLTSEG.FLTNUM
= IMPFLT.FLTNUM

			 AND AWBFLTSEG.FLTSEQNUM
= IMPFLT.FLTSEQNUM
			 AND AWBFLTSEG.FLTCARIDR  =
IMPFLT.FLTCARIDR
			 AND AWBFLTSEG.POU
= IMPFLT.ARPCOD

			 AND AWBFLTSEG.CMPCOD     = SELSHP.CMPCOD(+)

AND AWBFLTSEG.FLTNUM     = SELSHP.FLTNUM(+)


			 AND AWBFLTSEG.FLTSEQNUM  = SELSHP.FLTSEQNUM(+)

AND AWBFLTSEG.FLTCARIDR  = SELSHP.FLTCARIDR(+)


			 AND AWBFLTSEG.SEGSERNUM  = SELSHP.SEGSERNUM(+)

AND AWBFLTSEG.DOCOWRIDR  = SELSHP.DOCOWRIDR(+)


			 AND AWBFLTSEG.MSTDOCNUM  = SELSHP.MSTDOCNUM(+)

AND AWBFLTSEG.DUPNUM     = SELSHP.DUPNUM(+)

			 AND
AWBFLTSEG.SEQNUM     = SELSHP.SEQNUM(+)

AND AWBFLTSEG.CMPCOD     = SEGULDSHP.CMPCOD(+)
			 AND
AWBFLTSEG.FLTNUM
= SEGULDSHP.FLTNUM(+)

AND AWBFLTSEG.FLTSEQNUM  = SEGULDSHP.FLTSEQNUM(+)

			 AND AWBFLTSEG.FLTCARIDR
= SEGULDSHP.FLTCARIDR(+)

AND AWBFLTSEG.SEGSERNUM  = SEGULDSHP.SEGSERNUM(+)

			 AND AWBFLTSEG.DOCOWRIDR
= SEGULDSHP.DOCOWRIDR(+)

AND AWBFLTSEG.MSTDOCNUM  = SEGULDSHP.MSTDOCNUM(+)

			 AND AWBFLTSEG.DUPNUM
= SEGULDSHP.DUPNUM(+)

AND AWBFLTSEG.SEQNUM     = SEGULDSHP.SEQNUM(+)

			 AND AWBFLTSEG.CMPCOD
= SHPMST.CMPCOD

AND AWBFLTSEG.DOCOWRIDR  = SHPMST.DOCOWRIDR
			 AND AWBFLTSEG.MSTDOCNUM
= SHPMST.MSTDOCNUM


AND AWBFLTSEG.DUPNUM     = SHPMST.DUPNUM
			 AND AWBFLTSEG.SEQNUM     = SHPMST.SEQNUM

			 AND SHPMST.CMPCOD

= MSTCNT.CMPCOD(+)
			 AND SHPMST.DOCOWRIDR     = MSTCNT.DOCOWRIDR(+)
			 AND
SHPMST.MSTDOCNUM
=
MSTCNT.MSTDOCNUM(+)
			 AND SHPMST.DUPNUM        = MSTCNT.DUPNUM(+)
			 AND SHPMST.SEQNUM
=
MSTCNT.SEQNUM(+)

			 AND SHPMST.CMPCOD        = MSTACC.CMPCOD(+)
			 AND SHPMST.DOCOWRIDR
=
MSTACC.DOCOWRIDR(+)
			 AND
SHPMST.MSTDOCNUM     = MSTACC.MSTDOCNUM(+)
			 AND SHPMST.DUPNUM

= MSTACC.DUPNUM(+)
			 AND SHPMST.SEQNUM
= MSTACC.SEQNUM(+)
			 AND SHPMST.CMPCOD        = ARPSHP.CMPCOD(+)


			 AND SHPMST.DOCOWRIDR     = ARPSHP.DOCOWRIDR(+)

AND SHPMST.MSTDOCNUM     = ARPSHP.MSTDOCNUM(+)


			 AND SHPMST.DUPNUM        = ARPSHP.DUPNUM(+)
			 AND
SHPMST.SEQNUM        = ARPSHP.SEQNUM(+)

AND
ARPSHP.CMPCOD        = ARASHP.CMPCOD(+)
			 AND ARPSHP.DOCOWRIDR
= ARASHP.DOCOWRIDR(+)

AND ARPSHP.MSTDOCNUM
= ARASHP.MSTDOCNUM(+)
			 AND ARPSHP.DUPNUM
= ARASHP.DUPNUM(+)

AND ARPSHP.SEQNUM        =
ARASHP.SEQNUM(+)
			 AND ARPSHP.ARPCOD        = ARASHP.ARPCOD(+)

AND
SHPMST.CMPCOD        = ARPMST.CMPCOD(+)

			 AND SHPMST.DSTCOD        = ARPMST.ARPCOD(+)
			 AND
SHPMST.CMPCOD
= SHPORG.CMPCOD(+)
			 AND
SHPMST.ORGCOD        = SHPORG.ARPCOD(+)
			 AND IMPFLT.FLTNUM
= FLTHIS.FLTNUM(+)

			 AND
IMPFLT.FLTSEQNUM     = FLTHIS.FLTSEQNUM(+)
			 AND IMPFLT.FLTCARIDR
= FLTHIS.FLTCARIDR(+)


AND IMPFLT.LEGSERNUM     = FLTHIS.LEGSERNUM(+)
			 AND IMPFLT.ARPCOD
= FLTHIS.ARPCOD(+)
			 AND

IMPFLT.CMPCOD        = FLTHIS.CMPCOD(+)
			 AND SHPMST.CMPCOD        = AWBRCV.CMPCOD(+)

AND SHPMST.DOCOWRIDR

= AWBRCV.DOCOWRIDR(+)
			 AND SHPMST.MSTDOCNUM     = AWBRCV.MSTDOCNUM(+)

AND SHPMST.DUPNUM

= AWBRCV.DUPNUM(+)
			 AND SHPMST.SEQNUM        = AWBRCV.SEQNUM(+)
			 AND
SHPMST.CMPCOD        = MIS.CMPCOD(+)


			 AND SHPMST.DOCOWRIDR     = MIS.DOCOWRIDR(+)
			 AND SHPMST.MSTDOCNUM
= MIS.MSTDOCNUM(+)

			 AND SHPMST.DUPNUM
= MIS.DUPNUM(+)
			 AND SHPMST.SEQNUM        =
MIS.SEQNUM(+)
			AND FLTHIS.TXNCOD
(+)    = 'MSTSEL'

			AND IMPFLT.CMPCOD        = ?
			AND IMPFLT.FLTSEQNUM
= ?
			AND IMPFLT.FLTCARIDR
= ?
			AND IMPFLT.FLTNUM
= ?
			AND ARASHP.ARPCOD (+)    = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>371</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findSelectAreaDetailsForFlight" Type="NATIVE">
			<![CDATA[
		        	SELECT
					  SELSHP.CMPCOD,
					  SELSHP.FLTNUM,
					  SELSHP.FLTCARIDR,
					  SELSHP.FLTSEQNUM,



					  ARASHP.MSTDOCNUM,
					  ARASHP.DUPNUM,
					  ARASHP.SEQNUM,
					  ARASHP.DOCOWRIDR,


					  ARASHP.ARACOD,

					  ARASHP.MFTPCS,
					  ARASHP.MFTWGT,
					  NVL(SELSHP.BRKDWNSRTTIM,FLTLEG.ATA)SRTDAT,


					  FLTLEG.LEGSERNUM

					FROM
					  OPRSEGSELSHP SELSHP,
					  OPRARPARASHP ARASHP,

FLTOPRLEG
FLTLEG
					WHERE

					  SELSHP.MSTDOCNUM   = ARASHP.MSTDOCNUM
					AND SELSHP.DOCOWRIDR
= ARASHP.DOCOWRIDR

					AND SELSHP.DUPNUM
= ARASHP.DUPNUM
					AND SELSHP.SEQNUM    = ARASHP.SEQNUM

AND SELSHP.CMPCOD
= ARASHP.CMPCOD

					AND FLTLEG.CMPCOD    = SELSHP.CMPCOD
					AND FLTLEG.FLTNUM
= SELSHP.FLTNUM

					AND FLTLEG.FLTCARIDR
=SELSHP.FLTCARIDR
					AND FLTLEG.FLTSEQNUM =SELSHP.FLTSEQNUM

AND FLTLEG.LEGDST
= ARASHP.ARPCOD

					AND SELSHP.CMPCOD    = ?
					AND SELSHP.FLTNUM    =
?
					AND SELSHP.FLTSEQNUM
= ?
					AND SELSHP.FLTCARIDR
= ?
					AND ARASHP.ARPCOD    = ?
					AND
ARASHP.MFTPCS    > 0
					ORDER
BY
					  ARASHP.CMPCOD,

					  ARASHP.MSTDOCNUM,
					  ARASHP.DOCOWRIDR,

ARASHP.DUPNUM,

					  ARASHP.SEQNUM

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>370</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findshipmentLocationDetailsForFlight" Type="NATIVE">
			<![CDATA[
	        	SELECT
				  SHPLOC.CMPCOD,
				  SHPLOC.MSTDOCNUM,
				  SHPLOC.DOCOWRIDR,
				  SHPLOC.DUPNUM,



				  SHPLOC.SEQNUM,
				  SHPLOC.FLTNUM,
				  SHPLOC.FLTCARIDR,
				  SHPLOC.FLTSEQNUM,
				  SHPLOC.LEGSERNUM,



				  SHPLOC.SERNUM,
				  SHPLOC.STRDAT,
				  SHPLOC.ENDDAT,
				  SHPLOC.LOCCOD,
				  SHPLOC.PCS,



				  SHPLOC.DLVRTNFLG
				FROM
				  OPRSEGSHPLOC SHPLOC
				WHERE
				  SHPLOC.CMPCOD      = ?


				AND SHPLOC.FLTNUM
= ?
				AND SHPLOC.FLTCARIDR = ?
				AND SHPLOC.FLTSEQNUM = ?
				ORDER BY


				  SHPLOC.CMPCOD,

				  SHPLOC.MSTDOCNUM,
				  SHPLOC.DOCOWRIDR,
				  SHPLOC.DUPNUM,

SHPLOC.SEQNUM,

				  SHPLOC.SERNUM
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>275</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.breakdown.findcheckedshipmentbreakdowndetails" Type="NATIVE">
			<![CDATA[

            SELECT SEGSHP.SHPPFX,
	     SHPMST.DOCNUM      ,
	     SHPMST.STDPCS      ,
	     SEGSHP.MSTDOCNUM


,
	     SEGSHP.CMPCOD      ,
	     SEGSHP.DOCOWRIDR   ,
	     SEGSHP.DUPNUM      ,
	     SEGSHP.SEQNUM


,
	     SEGSHP.SEGSERNUM   ,
	     SEGSHP.RCVPCS      ,
	     SEGSHP. RCVWGT     ,
	     (
	     CASE



	       WHEN SELSHP.SELPCS>0
	       THEN SELSHP.SELPCS
	       ELSE SEGSHP.MFTPCS
	     END)MFTPCS,


	     (

	     CASE
	       WHEN SELSHP.SELWGT>0
	       THEN SELSHP.SELWGT
	       ELSE SEGSHP.MFTWGT


	     END)MFTWGT
,
	     SELSHP.SELPCS          ,
	     SELSHP.SELWGT          ,

SHPMST.SHPDES
,

	     SHPMST.DSTCOD          ,
	     SELSHP.AGTCOD          ,

SELSHP.SELRMK RMK      ,

	     ARASHP.MFTPCS
ARASELPCS,
	     ARASHP.RCVPCS ARARCVPCS,

SELSHP.FWDCOD          ,
	     SELSHP.UGTCOD

,
	     SHPMST.CONFLG          ,
	     SELSHP.COMDES
,
	     SELSHP.NCSWGT          ,


	     'HND'  ARPCOD          ,
	     TMPSKD.*
	      FROM
OPRSHPMST SHPMST               ,
	     OPRSEGSHP

SEGSHP                     ,
	     OPRSEGSELSHP SELSHP
,


	  	                           OPRARPARASHP ARASHP,
	     ( SELECT
SKDDTL.PCS SKDPCS       ,

	     			  SKDDTL.WGT SKDWGT
,
	     			  SKDDTL.ARACOD
SKDARACOD       ,
	     			  SKDDTL.MSTDOCNUM
TMPMSTDOCNUM ,
	     			  SKDDTL.DUPNUM
TMPDUPNUM
,
	     			  SKDDTL.SEQNUM TMPSEQNUM       ,

	     			  SKDDTL.CMPCOD TMPCMPCOD
,

SKDDTL.DOCOWRIDR TMPDOCOWRIDR ,
	     			  SKDDTL.SKDIDR
TMPSKDIDR       ,
	     			  SKDDTL.FLTNUM

TMPFLTNUM       ,
	     			  SKDDTL.FLTSEQNUM TMPFLTSEQNUM
,
	     			  SKDDTL.FLTCARIDR TMPFLTCARIDR

,
	     			  SKDDTL.ARACOD TMPARACOD       ,
	     			  DMG.DMGCOD
TMPDMGCOD          ,

DMG.DMGPCS
TMPDMGPCS          ,
	     			  DMG.DMGLVL TMPDMGLVL
,
	     			  DMG.DMGDES TMPJPNDMGDES


	     			   FROM OPRSKDDTL SKDDTL ,
	     			  (SELECT
CMPCOD         ,
	     			    ARPCOD
,

	     			    SKDIDR
,
	     			    DMGLVL               ,

DMGPCS               ,


	     			    DMGCOD               ,
	     			    DMGDES

FROM
	     			    (SELECT CMPCOD,


	     			      ARPCOD      ,
	     			      SKDIDR
,
	     			      DMGLVL      ,

	     			      DMGPCS      ,


DMGCOD      ,
	     			      DMGDES      ,

	     			      MAX(DMGDES) OVER(PARTITION
BY CMPCOD, ARPCOD
, SKDIDR , DMGLVL , DMGPCS , DMGCOD) MAXDMGDES

	     			       FROM

(SELECT CMPCOD,

ARPCOD      ,
	     			        SKDIDR      ,


DMGLVL      ,
	     			        DMGPCS
,
	     			        DMGCOD      ,
	     			        RTRIM(LTRIM(

JPYDES, ',' ),',') DMGDES

	     			         FROM
	     			        (SELECT DMG.CMPCOD,


	     			          DMG.ARPCOD      ,
	     			          DMG.SKDIDR
,
	     			          DMG.DMGLVL
,

	     			          DMG.DMGPCS      ,
	     			          DMG.DMGCOD
,

SHR.JPNDMGCODDTL,

	     			          ROW_NUMBER( ) OVER( PARTITION BY DMG.CMPCOD,

DMG.ARPCOD, DMG.SKDIDR, DMG.DMGLVL,DMG.DMGPCS, DMG.DMGCOD
ORDER BY DMG.SKDIDR ) SLNO


	     			           FROM OPRSKDDMG DMG,

	     			          SHRDMGCODMST SHR

WHERE DMG.CMPCOD
= SHR.CMPCOD(+)

	     			        AND INSTR(DMG.DMGCOD,
SHR.DMGCOD(+))>0
	     			        )MODEL PARTITION
BY( CMPCOD, ARPCOD, SKDIDR,
DMGLVL, DMGPCS, DMGCOD
) DIMENSION BY( SLNO ) MEASURES(JPNDMGCODDTL, CAST(
'' AS VARCHAR2( 1000 ) )AS
JPYDES ) RULES SEQUENTIAL
ORDER ( JPYDES[SLNO]
	     			     ORDER BY SLNO
= JPYDES[CV( ) - 1]


||','
	     			        || JPNDMGCODDTL[CV( )] )
	     			      )

	     			    )


	     			    WHERE DMGDES = MAXDMGDES
	     			  OR DMGDES     IS NULL
	     			  ) DMG


WHERE
SKDDTL.SKDIDR = DMG.SKDIDR(+)
	     			AND SKDDTL.ARPCOD     = DMG.ARPCOD(+)
	     			AND SKDDTL.CMPCOD


= DMG.CMPCOD(+)
	     			AND SKDDTL.CMPCOD     = ?
	     			AND SKDDTL.FLTNUM     = ?
	     			AND
SKDDTL.FLTSEQNUM

= ?
	     			AND SKDDTL.FLTCARIDR  = ?
	     )TMPSKD

WHERE SHPMST.MSTDOCNUM

= SEGSHP.MSTDOCNUM
	  	       	                  AND SHPMST.DOCOWRIDR = SEGSHP.DOCOWRIDR



AND SHPMST.DUPNUM = SEGSHP.DUPNUM
	  	       	                  AND SHPMST.SEQNUM = SEGSHP.SEQNUM



AND SHPMST.CMPCOD = SEGSHP.CMPCOD
	  	       	                  AND SEGSHP.CMPCOD = SELSHP.CMPCOD(+)



AND SEGSHP.MSTDOCNUM = SELSHP.MSTDOCNUM(+)
	  	       	                  AND SEGSHP.DOCOWRIDR = SELSHP.DOCOWRIDR(+)



AND SEGSHP.DUPNUM = SELSHP.DUPNUM(+)
	  	       	                  AND SEGSHP.SEQNUM = SELSHP.SEQNUM(+)



AND SEGSHP.FLTNUM = SELSHP.FLTNUM(+)
	  	       	                  AND SEGSHP.FLTSEQNUM = SELSHP.FLTSEQNUM(+)



AND SEGSHP.FLTCARIDR = SELSHP.FLTCARIDR(+)
	  	       	                  AND SEGSHP.SEGSERNUM = SELSHP.SEGSERNUM(+)



	  	       	                  AND SEGSHP.CMPCOD = TMPSKD.TMPCMPCOD(+)

AND SEGSHP.FLTCARIDR  = TMPSKD.TMPFLTCARIDR(+)

	   AND SEGSHP.FLTNUM
= TMPSKD.TMPFLTNUM(+)

AND SEGSHP.FLTSEQNUM  = TMPSKD.TMPFLTSEQNUM(+)



AND SEGSHP.DOCOWRIDR = TMPSKD.TMPDOCOWRIDR(+)
	   AND SEGSHP.MSTDOCNUM
= TMPSKD.TMPMSTDOCNUM(+)


	  	       	                  AND SEGSHP.DUPNUM
= TMPSKD.TMPDUPNUM(+)

AND SEGSHP.SEQNUM = TMPSKD.TMPSEQNUM(+)


	   AND TMPSKD.TMPCMPCOD        = ARASHP.CMPCOD(+)

AND TMPSKD.TMPMSTDOCNUM     = ARASHP.MSTDOCNUM(+)


	   AND TMPSKD.TMPDOCOWRIDR     = ARASHP.DOCOWRIDR(+)

AND TMPSKD.TMPDUPNUM        = ARASHP.DUPNUM(+)


	   AND TMPSKD.TMPSEQNUM        = ARASHP.SEQNUM(+)

AND TMPSKD.SKDARACOD        = ARASHP.ARACOD(+)



AND SEGSHP.RCVPCS > 0
	  	       	                  AND SEGSHP.CMPCOD
= ?


	  	       	                  AND SEGSHP.FLTNUM = ?


AND SEGSHP.FLTSEQNUM = ?
                AND SEGSHP.FLTCARIDR = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>304</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.housepcsmismatch" Type="NATIVE">
			<![CDATA[

                 SELECT SHPMST.CMPCOD,
  			  SHPMST.MSTDOCNUM   ,
  			  SHPMST.SHPPFX      ,



  			  SHPMST.DOCOWRIDR   ,
  			  SUM(
  			  CASE
  			    WHEN PARSEQNUM =0
  			    THEN SHPMST.STDPCS



  			    ELSE 0
  			  END) MSTSTDPCS,
  			  SUM(
  			  CASE
  			    WHEN PARSEQNUM >0

THEN
SHPMST.STDPCS

  			    ELSE 0
  			  END) HSESTDPCS,
  			  MAX ( SHPMST.CONFLG ) CNSFLG


  			   FROM OPRSHPMST SHPMST

  			  WHERE EXISTS
  			  (SELECT 1
  			     FROM OPRARPIMPFLT
IMPFLT,

  			    OPRFLTSEG FLTSEG         ,

  			    OPRSEGSHP SEGSHP
  			    WHERE
FLTSEG.CMPCOD = IMPFLT.CMPCOD

  			  AND FLTSEG.FLTNUM     = IMPFLT.FLTNUM

  			  AND
FLTSEG.FLTSEQNUM  = IMPFLT.FLTSEQNUM

  			  AND FLTSEG.FLTCARIDR  = IMPFLT.FLTCARIDR
  			  AND
FLTSEG.POU
= IMPFLT.ARPCOD
  			  AND FLTSEG.CMPCOD
= SEGSHP.CMPCOD
  			  AND FLTSEG.FLTNUM
= SEGSHP.FLTNUM

AND FLTSEG.FLTSEQNUM  = SEGSHP.FLTSEQNUM

AND FLTSEG.FLTCARIDR  = SEGSHP.FLTCARIDR

AND FLTSEG.SEGSERNUM
= SEGSHP.SEGSERNUM
  			  AND
SEGSHP.CMPCOD     = SHPMST.CMPCOD
  			  AND SEGSHP.DOCOWRIDR
= SHPMST.DOCOWRIDR

AND SEGSHP.MSTDOCNUM
= SHPMST.MSTDOCNUM
  			  AND SEGSHP.DUPNUM     = SHPMST.DUPNUM

AND SEGSHP.SEQNUM
= SHPMST.SEQNUM

AND IMPFLT.CMPCOD     = ?
  			  AND IMPFLT.FLTSEQNUM
= ?
  			  AND IMPFLT.FLTCARIDR
= ?
  			  AND
IMPFLT.FLTNUM     = ?
  			  AND FLTSEG.POU
= ?
  			  )
  			GROUP BY SHPMST.CMPCOD,


  			  SHPMST.MSTDOCNUM    ,
  			  SHPMST.DUPNUM
,
  			  SHPMST.DOCOWRIDR    ,
  			  SHPMST.SHPPFX

,
  			  SHPMST.DOCOWRIDR
  		HAVING MAX
( SHPMST.CONFLG )='Y'

			]]>
		</QRY:Source>
	</QRY:Definition>
	<!--Added by Chippy for CR ICRD-1810 STARTS-->
	<QRY:Definition>
		<QRY:Id>305</QRY:Id>
		<QRY:Source Name="operations.flthandling.findawbarrivalreportdetails" Type="NATIVE">
			<![CDATA[
		   SELECT mst.orgcod       ,
		  mst.dstcod             ,
		  mst.shppfx             ,
		  mst.mstdocnum


,
		  cntmst.cntcod orgcntcod,
		  mst.stdpcs             ,
		  mst.stdwgt             ,
		  seg.rcvpcs


,
		  seg.rcvwgt             ,
		  mst.cnsnam             ,
		  impflt.fltcarcod       ,
		  impflt.fltnum


,
		  impflt.fltdat,fltseg.pol,fltseg.pou
		   FROM oprshpmst mst
		INNER JOIN oprarpshp arp

ON

mst.cmpcod = arp.cmpcod
		AND mst.docowridr  = arp.docowridr
		AND mst.mstdocnum  = arp.mstdocnum


		AND
mst.dupnum     = arp.dupnum
		AND mst.seqnum     = arp.seqnum
		AND mst.orgcod    <> arp.arpcod


		INNER
JOIN oprsegshp seg
					 ON mst.cmpcod = seg.cmpcod
		AND mst.docowridr  = seg.docowridr

AND
mst.mstdocnum
= seg.mstdocnum
		AND mst.dupnum     = seg.dupnum
		AND mst.seqnum     = seg.seqnum


		INNER JOIN oprfltseg
fltseg
					 ON seg.cmpcod = fltseg.cmpcod
		AND seg.fltcaridr  = fltseg.fltcaridr


		AND seg.fltnum
= fltseg.fltnum
		AND seg.fltseqnum  = fltseg.fltseqnum
		AND seg.segsernum  =
fltseg.segsernum

		AND
fltseg.pou     = arp.arpcod
		INNER JOIN oprarpimpflt impflt
					 ON fltseg.cmpcod
= impflt.cmpcod


		AND fltseg.fltcaridr       = impflt.fltcaridr
		AND fltseg.fltnum          = impflt.fltnum

AND fltseg.fltseqnum

= impflt.fltseqnum
		AND fltseg.pou             = impflt.arpcod
		INNER
JOIN shrarpmst arpmst

					 ON
mst.cmpcod = arpmst.cmpcod
		AND mst.orgcod     = arpmst.arpcod

INNER JOIN shrcntmst cntmst

					 ON
arpmst.cmpcod = cntmst.cmpcod
		AND arpmst.cntcod     =
cntmst.cntcod
		AND SEG.RCVPCS > 0
		AND
mst.cmpcod
=?
		AND arp.arpcod        = ?
		AND mst.seqnum
= 1
		AND impflt.fltdat BETWEEN ? AND ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<!--Added by Chippy for CR ICRD-1810 ENDS-->
	<!-- ICRD-2050 A-4789 22 June 2011 Changes starts here -->
	<QRY:Definition>
		<QRY:Id>309</QRY:Id>
		<QRY:Source Name="operations.flthandling.notfinalisedfligtdetails" Type="NATIVE">
			<![CDATA[
          SELECT flt.FLTCARCOD,flt.fltnum,flt.fltdat,seg.pol,seg.pou,shr.flddes,COUNT(shp.docowridr)



		  FROM oprsegshp shp,
  			   oprfltseg seg,
  			   oprarpexpflt flt, shronetim shr
		  WHERE flt.cmpcod


= seg.cmpcod
 			AND flt.fltnum = seg.fltnum
 			AND flt.fltcaridr = seg.fltcaridr
 			AND flt.fltseqnum


= seg.fltseqnum
 			AND flt.arpcod = seg.pol
 			AND shp.cmpcod = seg.cmpcod
 			AND shp.fltnum = seg.fltnum



 			AND shp.fltcaridr = seg.fltcaridr
 			AND shp.fltseqnum = seg.fltseqnum
 			AND shp.segsernum =

seg.segsernum

 			AND flt.fltoprsta = shr.fldval
			AND flt.cmpcod = shr.cmpcod
			AND shr.fldtyp

= 'operations.flthandling.exportflightstatus'

			AND fltdat between ? and ?
			AND finflg <> 'Y'


 			AND (fltoprsta = 'M' OR fltoprsta = 'P')
 			AND
flt.arpcod=?
 			AND shp.seqnum=1

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>284</QRY:Id>
		<QRY:Source Name="operations.flthandling.jto.changehawbdetails" Type="NATIVE">
			<![CDATA[
       CALL PKG_OPR_SHP_CHG_HAWB.spr_chk_docnum_oprshpmst (
              ?,
              ?,
              ?,
              ?,
              ?,
              ?,
              ?,
              ?
            )
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>285</QRY:Id>
		<QRY:Source Name="operations.flthandling.jto.findbreakdowndetails" Type="NATIVE">
			<![CDATA[

  			SELECT   FLTSEG.FLTCARIDR, FLTSEG.FLTNUM,FLTSEG.FLTSEQNUM, FLTSEG.CMPCOD,FLTSEG.POL POL, FLTSEG.SEGSERNUM,



FLTSEG.POU ARPCOD, SEGSHP.RCVPCS RCVPCS,SEGSHP.RCVWGT RCVWGT,SEGSHP.LSTUPDTIM SEGSHPUPDTIM,ARPSHP.LSTUPDTIM


ARPLSTUPDTIM,
  								 (CASE
  									WHEN SELSHP.SELPCS > 0 OR SEGSHP.SELPREFLG IS NOT NULL



  				 					THEN SELSHP.SELPCS
  									ELSE SEGSHP.MFTPCS
  								 END) AWBMFTPCS,

(CASE


  									WHEN SELSHP.SELWGT > 0 OR SEGSHP.SELPREFLG IS NOT NULL

THEN SELSHP.SELWGT

  									ELSE
SEGSHP.MFTWGT
  								 END) AWBMFTWGT,
  								 SELSHP.SELRMK,

SHPMST.SHPPFX SHPPFX,SHPMST.DOCOWRIDR

DOCOWRIDR,SHPMST.MSTDOCNUM MSTDOCNUM,SHPMST.DUPNUM DUPNUM,

SHPMST.SEQNUM SEQNUM,SHPMST.STDPCS

STDPCS,SHPMST.STDWGT STDWGT,SHPMST.CONFLG CONFLG,SHPMST.ORGCOD ORGCOD,

SHPMST.DSTCOD DSTCOD,SHPMST.SHPDES

SHPDES,SHPMST.SCCCOD SCCCOD,SHPMST.DOCNUM DOCNUM,SHPMST.OWRCOD OWRCOD,

ULDSHP.ULDNUM ULDNUM,SELSHP.UGTCOD

UGTCOD,SEGULD.THRUNT THRUNT,ULDSHP.MFTPCS ULDSHPMFTPCS,

ULDSHP.MFTWGT ULDSHPMFTWGT,ULDSHP.RCVPCS

ULDSHPRCVPCS,ULDSHP.RCVWGT ULDSHPRCVWGT,TMPSKD.STUCOD STUCOD,

TMPSKD.BDNDTLSCCCOD,TMPSKD.BDNDTLRCVPCS,TMPSKD.BDNDTLRCVWGT,TMPSKD.BDNDTLSERNUM,TMPSKD.BDNDTLLOCCOD,



  								 TMPSKD.BDNDTLWHSCOD,TMPSKD.SKDIDR SKDIDR,TMPSKD.SKDDTLARPCOD,TMPSKD.SKDDTLCMPCOD,TMPSKD.SKDDTLFLTCARIDR,



  								 TMPSKD.SKDDTLFLTNUM,TMPSKD.SKDDTLFLTSEQNUM,TMPSKD.SKDDTLDOCNUM,TMPSKD.DMGCOD,TMPSKD.DMGLVL,TMPSKD.DMGPCS,



  								 TMPSKD.ARACODFROM,TMPSKD.SHPLOCLOCCOD,TMPSKD.SKDDTLDOCOWRIDR,TMPSKD.SKDDTLMSTDOCNUM,TMPSKD.SKDDTLDUPNUM,



  								 TMPSKD.SKDDTLSEQNUM, TMPSKD.DMGSERNUM,TMPSKD.DMGRMK,
  								 TMPSKD.NCSFLTNUM,TMPSKD.NCSFLTDAT,TMPSKD.NCSFLTCARCOD,TMPSKD.SERNUM,TMPSKD.TXNCOD,


SHPMIS.BDNSRTFLG,TMPSKD.DMGDISSEQNUM
  						FROM OPRFLTSEG FLTSEG,
  						( SELECT SEGSHP.* ,



(SELECT 'Y'
  								     FROM DUAL
  								    WHERE EXISTS
  								    (SELECT MSTDOCNUM



FROM OPRSEGSELSHP SELTST
  								      WHERE SELTST.CMPCOD   = SEGSHP.CMPCOD
  								    AND SELTST.DOCOWRIDR


= SEGSHP.DOCOWRIDR
  								    AND SELTST.MSTDOCNUM    = SEGSHP.MSTDOCNUM
  								    AND SELTST.DUPNUM


= SEGSHP.DUPNUM
  								    AND SELTST.SEQNUM       = SEGSHP.SEQNUM
  								    AND SELTST.FLTCARIDR


= SEGSHP.FLTCARIDR
  								    AND SELTST.FLTNUM       = SEGSHP.FLTNUM
  								    AND SELTST.FLTSEQNUM


= SEGSHP.FLTSEQNUM
  								    )
  							  ) SELPREFLG	FROM
  								 OPRSEGSHP SEGSHP ) SEGSHP,



OPRSEGSELSHP SELSHP,
  								 OPRSHPMST SHPMST,
  								 OPRSEGULDSHP ULDSHP,
  								 OPRSEGULD


SEGULD,
  								 (SELECT
  								    SKDDTL.SKDIDR STUCOD,
  								    BDNDTL.SCCCOD BDNDTLSCCCOD,



  								    SKDDTL.PCS BDNDTLRCVPCS,
  								    SKDDTL.WGT BDNDTLRCVWGT,
  								    BDNDTL.SERNUM

BDNDTLSERNUM,

  								    BDNDTL.LOCCOD BDNDTLLOCCOD,
  								    SHPLOC.WHSCOD BDNDTLWHSCOD,


  								    SKDDTL.SKDIDR SKDIDR,

  								    SKDDTL.ARPCOD SKDDTLARPCOD,

SKDDTL.CMPCOD
SKDDTLCMPCOD,
  								    SKDDTL.FLTCARIDR
SKDDTLFLTCARIDR,
  								    SKDDTL.FLTNUM
SKDDTLFLTNUM,

  								    SKDDTL.FLTSEQNUM SKDDTLFLTSEQNUM,


SKDDTL.DOCNUM SKDDTLDOCNUM,

  								    SKDDMG.DMGCOD DMGCOD,
  								    SKDDMG.DMGLVL
DMGLVL,

  								    SKDDMG.DMGPCS
DMGPCS,
  								    SKDDTL.ARACOD ARACODFROM,

SHPLOC.LOCCOD SHPLOCLOCCOD,


  								    SKDDTL.DOCOWRIDR SKDDTLDOCOWRIDR,

SKDDTL.MSTDOCNUM SKDDTLMSTDOCNUM,

  								    SKDDTL.DUPNUM
SKDDTLDUPNUM,

SKDDTL.SEQNUM SKDDTLSEQNUM,
  								    SKDDMG.SERNUM DMGSERNUM,


  								    SKDDMG.DMGRMK
DMGRMK,
  								    SKDDTL.NCSFLTNUM NCSFLTNUM,SKDDTL.NCSFLTDAT NCSFLTDAT,



SKDDTL.NCSFLTCARCOD NCSFLTCARCOD,SKDDTL.SERNUM SERNUM,
  								    SKDDTL.TXNCOD TXNCOD,DMGDIS.DISSEQNUM


DMGDISSEQNUM
  								   FROM
  								    OPRSHPBDNDTL BDNDTL,
  								    OPRSKDDTL SKDDTL,



  								    OPRSKDDMG SKDDMG,
  								    WHSSTUMST STUMST,
  								    WHSOPRSHPLOC SHPLOC,


  								    OPRDMGDIS
DMGDIS
  								  WHERE
  								    SKDDTL.CMPCOD    = BDNDTL.CMPCOD(+)

AND SKDDTL.FLTCARIDR

= BDNDTL.FLTCARIDR(+)
  								AND SKDDTL.FLTNUM    = BDNDTL.FLTNUM(+)

AND SKDDTL.FLTSEQNUM

= BDNDTL.FLTSEQNUM(+)
  								AND SKDDTL.DOCOWRIDR = BDNDTL.DOCOWRIDR(+)

AND SKDDTL.MSTDOCNUM

= BDNDTL.MSTDOCNUM(+)
  								AND SKDDTL.DUPNUM    = BDNDTL.DUPNUM(+)

AND SKDDTL.SEQNUM

= BDNDTL.SEQNUM(+)
  								AND SKDDTL.SKDIDR    = BDNDTL.STUCOD(+)

AND SKDDTL.ARPCOD
=
BDNDTL.ARPCOD(+)
  								AND SKDDTL.CMPCOD    = BDNDTL.CMPCOD(+)

AND SKDDTL.CMPCOD
= SHPLOC.CMPCOD

  								AND SKDDTL.ARPCOD    = SHPLOC.ARPCOD

AND SKDDTL.SKDIDR
= SHPLOC.STUCOD
  								AND SKDDTL.DOCOWRIDR
= SHPLOC.DOCOWRIDR
  								AND
SKDDTL.MSTDOCNUM = SHPLOC.MSTDOCNUM

  								AND SKDDTL.DUPNUM    =
SHPLOC.DUPNUM

AND SKDDTL.SEQNUM    = SHPLOC.SEQNUM
  								AND SKDDTL.CMPCOD
= SKDDMG.CMPCOD(+)


AND SKDDTL.ARPCOD    = SKDDMG.ARPCOD(+)
  								AND SKDDTL.SKDIDR
= SKDDMG.SKDIDR(+)

AND
SKDDTL.CMPCOD    = STUMST.CMPCOD
  								AND SKDDTL.ARPCOD    = STUMST.ARPCOD


AND SKDDTL.SKDIDR
= STUMST.STUCOD
  								AND SKDDMG.CMPCOD    = DMGDIS.CMPCOD(+)
  								AND

SKDDMG.ARPCOD    = DMGDIS.ARPCOD(+)

  								AND SKDDMG.SKDIDR    = DMGDIS.SKDIDR(+)


    								AND SKDDMG.SERNUM    = DMGDIS.SKDDMGSERNUM(+)

  								AND (SKDDTL.TMPFLG
= 'N' or SKDDTL.TMPFLG
is null)
  									AND SKDDTL.ARPCOD = ?
  									AND
SKDDTL.FLTCARIDR =
?
  									AND SKDDTL.FLTNUM
= ?
  									AND SKDDTL.FLTSEQNUM = ?

  										 )TMPSKD,

OPRSHPMSTMIS
SHPMIS,
  							   OPRARPSHP ARPSHP

  						   WHERE SEGSHP.CMPCOD
= FLTSEG.CMPCOD

AND SEGSHP.FLTCARIDR
= FLTSEG.FLTCARIDR
  							 AND SEGSHP.FLTNUM = FLTSEG.FLTNUM

AND SEGSHP.FLTSEQNUM
= FLTSEG.FLTSEQNUM

AND SEGSHP.SEGSERNUM = FLTSEG.SEGSERNUM
  							 AND
SEGSHP.CMPCOD =
SHPMST.CMPCOD
  							 AND SEGSHP.DOCOWRIDR
= SHPMST.DOCOWRIDR
  							 AND SEGSHP.MSTDOCNUM
= SHPMST.MSTDOCNUM

AND SEGSHP.DUPNUM = SHPMST.DUPNUM

  							 AND SEGSHP.SEQNUM = SHPMST.SEQNUM


AND SEGSHP.CMPCOD = SHPMIS.CMPCOD
  							 AND
SEGSHP.DOCOWRIDR = SHPMIS.DOCOWRIDR
  							 AND SEGSHP.MSTDOCNUM

= SHPMIS.MSTDOCNUM
  							 AND
SEGSHP.DUPNUM = SHPMIS.DUPNUM
  							 AND SEGSHP.SEQNUM = SHPMIS.SEQNUM


  							 AND SEGSHP.CMPCOD
= SELSHP.CMPCOD(+)
  							 AND SEGSHP.FLTCARIDR = SELSHP.FLTCARIDR(+)

AND
SEGSHP.FLTNUM
= SELSHP.FLTNUM(+)
  							 AND SEGSHP.FLTSEQNUM = SELSHP.FLTSEQNUM(+)

AND SEGSHP.SEGSERNUM

= SELSHP.SEGSERNUM(+)
  							 AND SEGSHP.DOCOWRIDR = SELSHP.DOCOWRIDR(+)

AND SEGSHP.MSTDOCNUM

= SELSHP.MSTDOCNUM(+)
  							 AND SEGSHP.DUPNUM = SELSHP.DUPNUM(+)

AND SEGSHP.SEQNUM = SELSHP.SEQNUM(+)


AND SEGSHP.CMPCOD = ULDSHP.CMPCOD(+)
  							 AND SEGSHP.FLTCARIDR
= ULDSHP.FLTCARIDR(+)

  							 AND
SEGSHP.FLTNUM = ULDSHP.FLTNUM(+)
  							 AND SEGSHP.FLTSEQNUM
= ULDSHP.FLTSEQNUM(+)

  							 AND SEGSHP.SEGSERNUM
= ULDSHP.SEGSERNUM(+)
  							 AND
SEGSHP.DOCOWRIDR = ULDSHP.DOCOWRIDR(+)

  							 AND SEGSHP.MSTDOCNUM
= ULDSHP.MSTDOCNUM(+)

AND SEGSHP.DUPNUM = ULDSHP.DUPNUM(+)

  							 AND SEGSHP.SEQNUM = ULDSHP.SEQNUM(+)


  							 AND ULDSHP.CMPCOD = SEGULD.CMPCOD(+)

  							 AND ULDSHP.FLTCARIDR = SEGULD.FLTCARIDR(+)

AND
ULDSHP.FLTNUM = SEGULD.FLTNUM(+)

  							 AND ULDSHP.FLTSEQNUM = SEGULD.FLTSEQNUM(+)

AND ULDSHP.SEGSERNUM
= SEGULD.SEGSERNUM(+)

  							 AND ULDSHP.ULDNUM = SEGULD.ULDNUM(+)


AND SEGSHP.CMPCOD = TMPSKD.SKDDTLCMPCOD(+)


  							 AND SEGSHP.FLTCARIDR = TMPSKD.SKDDTLFLTCARIDR(+)

AND SEGSHP.FLTNUM = TMPSKD.SKDDTLFLTNUM(+)


  							 AND SEGSHP.FLTSEQNUM = TMPSKD.SKDDTLFLTSEQNUM(+)

AND SEGSHP.DOCOWRIDR = TMPSKD.SKDDTLDOCOWRIDR(+)


  							 AND SEGSHP.MSTDOCNUM = TMPSKD.SKDDTLMSTDOCNUM(+)

AND SEGSHP.DUPNUM = TMPSKD.SKDDTLDUPNUM(+)


  							 AND SEGSHP.SEQNUM = TMPSKD.SKDDTLSEQNUM(+)


AND SEGSHP.CMPCOD = ARPSHP.CMPCOD(+)


  							 AND SEGSHP.DOCOWRIDR = ARPSHP.DOCOWRIDR(+)

AND SEGSHP.MSTDOCNUM = ARPSHP.MSTDOCNUM(+)


  							 AND SEGSHP.DUPNUM = ARPSHP.DUPNUM(+)

AND SEGSHP.SEQNUM = ARPSHP.SEQNUM(+)

  							 AND FLTSEG.CMPCOD
= ?
  							 AND FLTSEG.FLTCARIDR
= ?
  							 AND FLTSEG.FLTNUM = ?
  							 AND
FLTSEG.FLTSEQNUM
= ?
  			         AND FLTSEG.POU
= ?
  			         			 AND ARPSHP.ARPCOD = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>380</QRY:Id>
		<QRY:Source Name="operations.flthandling.jto.finduldenquiryvoforcheckout" Type="NATIVE">
			<![CDATA[
		  		SELECT SHPLOC.CMPCOD,
					  SHPLOC.ARPCOD,
					  SHPLOC.WHSCOD,
					  SHPLOC.DOCOWRIDR,



					  SHPLOC.MSTDOCNUM,
					  SHPLOC.SEQNUM,
					  SHPLOC.SHPPFX,
					  SHPLOC.DUPNUM,
					  SHPLOC.DOCNUM,



					  SHPLOC.DOCTYP,
					  SHPLOC.SHPTYP,
					  SHPLOC.STGSTRTIM,
					  SHPLOC.LOCCOD,
					  SHPLOC.STUCOD,



					  SHPLOC.SHPCINTIM,
					  SHPLOC.TXNPCS,
					  STUMST.STUTYPNAM,
					  LOCMST.ZONCOD,


					  LOCMST.LOCTYPNAM,

					  LOCMST.STGSTCCOD,
					  OPRMST.ORGCOD,
					  OPRMST.DSTCOD,


					  OPRMST.SCCCOD,
					  OPRMST.STDPCS,

					  OPRMST.STDWGT,
					  OPRMST.SHPDES,

SHPLOC.LOCPCS,

					  SHPLOC.LOCWGT,
					  PCSDTL.PCSIDR,

					  PCSDTL.PCSDES ,

SHPLOC.LSTUPDUSR,
					  SHPLOC.LSTUPDTIM

					FROM OPRSEGULDSHP SEGULD
					INNER
JOIN WHSOPRSHPLOC
SHPLOC
					ON SEGULD.CMPCOD     = SHPLOC.CMPCOD

					AND SEGULD.DOCOWRIDR = SHPLOC.DOCOWRIDR


					AND SEGULD.MSTDOCNUM = SHPLOC.MSTDOCNUM
					AND SEGULD.SEQNUM
= SHPLOC.SEQNUM
					AND SEGULD.DUPNUM

= SHPLOC.DUPNUM
					AND SEGULD.ULDNUM    = SHPLOC.STUCOD

					INNER JOIN WHSLOCMST LOCMST

ON SHPLOC.CMPCOD
= LOCMST.CMPCOD
					AND SHPLOC.ARPCOD = LOCMST.ARPCOD

					AND SHPLOC.WHSCOD
= LOCMST.WHSCOD
					AND
SHPLOC.LOCCOD = LOCMST.LOCCOD
					INNER JOIN WHSSTUMST STUMST

					ON
SHPLOC.CMPCOD  = STUMST.CMPCOD

					AND SHPLOC.ARPCOD = STUMST.ARPCOD
					AND SHPLOC.STUCOD
=
STUMST.STUCOD
					INNER JOIN OPRSHPMST OPRMST

					ON SHPLOC.CMPCOD     = OPRMST.CMPCOD


AND SHPLOC.DOCOWRIDR = OPRMST.DOCOWRIDR
					AND SHPLOC.MSTDOCNUM
= OPRMST.MSTDOCNUM
					AND SHPLOC.SEQNUM

= OPRMST.SEQNUM
					AND SHPLOC.DUPNUM    = OPRMST.DUPNUM

					LEFT OUTER JOIN WHSPCSDTL PCSDTL


					ON SHPLOC.CMPCOD     = PCSDTL.CMPCOD
					AND SHPLOC.ARPCOD
= PCSDTL.ARPCOD
					AND SHPLOC.WHSCOD

= PCSDTL.WHSCOD
					AND SHPLOC.LOCCOD    = PCSDTL.LOCCOD

					AND SHPLOC.STUCOD    = PCSDTL.STUCOD


					AND SHPLOC.DOCOWRIDR = PCSDTL.DOCOWRIDR
					AND SHPLOC.MSTDOCNUM
= PCSDTL.MSTDOCNUM
					AND
SHPLOC.DUPNUM
= PCSDTL.DUPNUM
					AND SHPLOC.SEQNUM    = PCSDTL.SEQNUM

					WHERE SEGULD.CMPCOD
= ?
					AND
SEGULD.DOCOWRIDR = ?
					AND SEGULD.MSTDOCNUM = ?
					AND SEGULD.DUPNUM
= ?

AND SEGULD.SEQNUM
= ?
					AND SEGULD.FLTCARIDR = ?
					AND SEGULD.FLTNUM    = ?
					AND
SEGULD.FLTSEQNUM
= ?
					AND
SHPLOC.ARPCOD    = ?
					ORDER BY SHPLOC.DOCOWRIDR,SHPLOC.MSTDOCNUM,SHPLOC.SEQNUM,SHPLOC.DUPNUM,SHPLOC.WHSCOD,SHPLOC.STUCOD,SHPLOC.LOCCOD
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>285</QRY:Id>
		<QRY:Source Name="operations.flthandling.findOperationalFlightStatus" Type="NATIVE">
			<![CDATA[
			  SELECT   
				EXP.FLTCARCOD,
				EXP.FLTCARIDR,
				EXP.FLTNUM,
				EXP.FLTSEQNUM,
				EXP.FLTDAT,
				EXP.ARPCOD ,
				EXP.FLTOPRSTA,
				EXP.RELFLG,
				EXP.FINFLG,
				EXP.LEGSERNUM,
				EXP.CMPCOD,
			    FLTLEG.LEGORG,
			    FLTLEG.LEGDST,
				FLTLEG.ATD,
				(SELECT arlidr FROM SHRARLMST_VW WHERE TWOAPHCOD = FLTLEG.OPRFLTCARCOD and cmpcod= fltleg.cmpcod )OPRFLTCARID
			  FROM OPRARPEXPFLT EXP
			  INNER JOIN FLTOPRLEG FLTLEG
			  ON EXP.CMPCOD = FLTLEG.CMPCOD
			  AND EXP.FLTNUM = FLTLEG.FLTNUM
			  AND EXP.FLTCARIDR = FLTLEG.FLTCARIDR
			  AND EXP.FLTSEQNUM = FLTLEG.FLTSEQNUM
			  AND EXP.LEGSERNUM = FLTLEG.LEGSERNUM
			  WHERE
			  EXP.CMPCOD = ?
			  AND (EXP.FLTCARIDR, EXP.FLTNUM, EXP.FLTSEQNUM, EXP.ARPCOD)
			 IN (
			]]>
		</QRY:Source>
	</QRY:Definition>
	<!-- ICRD-2050 A-4789 22 June 2011 Changes ends here -->
	<!-- A-4815 Changes starts here -->
	<QRY:Definition>
		<QRY:Id>286</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.cargotonnage.flightwise_summary" Type="NATIVE">
			<![CDATA[
							SELECT FLTNUM,
	FLTDAT,
	AGTCOD,
	AGTNAM,
	SUM(MFTWGT) MFTWGT,
	SUM(CHGWGT) CHGWGT
	FROM
	(SELECT


ARLMST.TWOAPHCOD
	||'-'
	|| SEGSHP.FLTNUM FLTNUM,
	FLTMST.FLTDAT FLTDAT,
	MST.SHPPFX
	|| '-'
	|| MST.MSTDOCNUM


AWBNUM,
	MST.ORGCOD ORGCOD,
	MST.DSTCOD DSTCOD,
	MST.AGTCOD AGTCOD,
	REPLACE (MST.AGTNAM,',',' ')AGTNAM


,
	MST.PRDNAM PRDNAM,
	MST.SCCCOD SCCCOD,
	SEGSHP.MFTWGT MFTWGT,
	(SEGSHP.MFTWGT/ MST.STDWGT)*
	(SELECT


SUM(COALESCE(RATDTL.CHGWGT,0 ))
	FROM OPRSHPRATDTL RATDTL
	WHERE MST.DOCOWRIDR = RATDTL.DOCOWRIDR

AND

MST.MSTDOCNUM   = RATDTL.MSTDOCNUM
	AND MST.DUPNUM      = RATDTL.DUPNUM
	AND MST.SEQNUM      =
RATDTL.SEQNUM


AND MST.CMPCOD      = RATDTL.CMPCOD
	) CHGWGT
	FROM OPRSEGSHP SEGSHP,
	OPRSHPMST MST
,
	FLTOPRMST FLTMST,


SHRARLMST ARLMST
	WHERE MST.DOCOWRIDR    = SEGSHP.DOCOWRIDR
	AND MST.MSTDOCNUM
= SEGSHP.MSTDOCNUM


AND MST.DUPNUM       = SEGSHP.DUPNUM
	AND MST.SEQNUM       = SEGSHP.SEQNUM
	AND
MST.CMPCOD       = SEGSHP.CMPCOD


AND SEGSHP.FLTCARIDR = FLTMST.FLTCARIDR
	AND SEGSHP.FLTNUM    = FLTMST.FLTNUM

AND SEGSHP.FLTSEQNUM
=
FLTMST.FLTSEQNUM
	AND SEGSHP.CMPCOD    = FLTMST.CMPCOD
	AND ARLMST.CMPCOD
= SEGSHP.CMPCOD
	AND
ARLMST.ARLIDR
= SEGSHP.FLTCARIDR
	AND MST.SEQNUM       = 1
	AND SEGSHP.MFTPCS
>0
	AND MST.CMPCOD     = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<!-- A-4815 Changes ends here -->
	<!--Added By A-4443 for cargo not flown report starts-->
	<QRY:Definition>
		<QRY:Id>303</QRY:Id>
		<QRY:Source Name="operations.flthandling.findCargoNotFlownDetails" Type="NATIVE">
			<![CDATA[
		SELECT * FROM (	SELECT BKGMST.UBRNUM,
			  BKGFLT.FLTCARCOD,
			  BKGFLT.FLTNUM,
			  BKGFLT.FLTDST,



			  BKGFLT.FLTDAT,
			  BKGMST.SHPPFX,
			  BKGMST.MSTDOCNUM,
			  NVL(BKGMST.PRDNAM,   SHPMST.PRDNAM)

PRDNAM,

			  SHPLOC.LOCPCS AVLPCS,
			  SHPLOC.LOCWGT AVLWGT,
			  SHPMST.SEQNUM,
			  SHPMST.DOCNUM,


			  SHPLOC.LOCCOD,

			  EXPFLT.FINFLG,
			  SHPMST.STDPCS,
			  SHPMST.STDWGT,

			  SHPMST.DSTCOD


				FROM CAPBKGMST BKGMST

				INNER JOIN CAPBKGFLTDTL BKGFLT ON BKGMST.UBRNUM = BKGFLT.UBRNUM

AND
BKGMST.CMPCOD = BKGFLT.CMPCOD

				INNER JOIN OPRARPSHP ARPSHP ON BKGMST.DOCOWRIDR = ARPSHP.DOCOWRIDR


				 AND BKGMST.MSTDOCNUM = ARPSHP.MSTDOCNUM

				 AND BKGMST.DUPNUM = ARPSHP.DUPNUM
				 AND BKGMST.SEQNUM

= ARPSHP.SEQNUM
				 AND BKGFLT.CMPCOD = ARPSHP.CMPCOD

				INNER JOIN OPRSHPMST SHPMST ON BKGMST.DOCOWRIDR

= SHPMST.DOCOWRIDR
				 AND BKGMST.MSTDOCNUM = SHPMST.MSTDOCNUM

				 AND BKGMST.DUPNUM = SHPMST.DUPNUM


				 AND BKGMST.SEQNUM = SHPMST.SEQNUM
				 AND BKGMST.CMPCOD = SHPMST.CMPCOD

				 AND BKGMST.UBRNUM

= SHPMST.UBRNUM
				INNER JOIN WHSLOCMST LOCMST ON ARPSHP.ARPCOD = LOCMST.ARPCOD

				 AND ARPSHP.CMPCOD

= LOCMST.CMPCOD
				INNER JOIN WHSOPRSHPLOC SHPLOC ON SHPLOC.MSTDOCNUM = ARPSHP.MSTDOCNUM



				 AND SHPLOC.DOCOWRIDR = ARPSHP.DOCOWRIDR
				 AND SHPLOC.DUPNUM = ARPSHP.DUPNUM
				 AND SHPLOC.SEQNUM


= ARPSHP.SEQNUM
				 AND SHPLOC.LOCCOD = LOCMST.LOCCOD
				 AND SHPLOC.WHSCOD = LOCMST.WHSCOD

AND

SHPLOC.ARPCOD = ARPSHP.ARPCOD
				 AND SHPLOC.CMPCOD = ARPSHP.CMPCOD

				INNER JOIN OPRARPEXPFLT


EXPFLT ON BKGFLT.CMPCOD = EXPFLT.CMPCOD
				 AND BKGFLT.FLTNUM = EXPFLT.FLTNUM
				 AND BKGFLT.FLTCARIDR


= EXPFLT.FLTCARIDR
				 AND BKGFLT.FLTSEQNUM = EXPFLT.FLTSEQNUM
				 AND BKGFLT.FLTORG = EXPFLT.ARPCOD




			WHERE
			 	 ARPSHP.ARPCOD = ?
				 AND ARPSHP.AVLPCS > 0
				 AND SHPLOC.TXNPCS = 0

			]]>
		</QRY:Source>
	</QRY:Definition>
	<!--Added By A-4443 for cargo not flown report ends-->
	<!--A-4113 for ICRD-2045 Changes starts here -->
	<QRY:Definition>
		<QRY:Id>310</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.fetchnotfinalisedflights" Type="NATIVE">
			<![CDATA[
			  SELECT FLTNUM,FLTCARIDR,FLTSEQNUM,LEGSERNUM,ARPCOD,CMPCOD,FLTCARCOD
			  FROM OPRARPEXPFLT
			  WHERE
			  FLTDAT < ?
			  AND FINFLG <> 'F'
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>311</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.fetchnotclosedflights" Type="NATIVE">
			<![CDATA[
			  SELECT FLTNUM,FLTCARIDR,FLTSEQNUM,LEGSERNUM,ARPCOD,CMPCOD,FLTDAT,FFMRCVDAT
			  FROM OPRARPIMPFLT
			  WHERE
			  FLTDAT < ?
			  AND CLSFLG <> 'Y' AND CMPCOD=?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<!--A-4113 for ICRD-2045 Changes ends here -->
	<!-- A-4815 Changes starts here -->
	<QRY:Definition>
		<QRY:Id>287</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.cargotonnage.flightwise_detailed" Type="NATIVE">
			<![CDATA[
  SELECT ARLMST.TWOAPHCOD
  ||'-'
  || SEGSHP.FLTNUM FLTNUM,FLTMST.CMPCOD CMPCOD,
  FLTMST.FLTCARIDR


FLTCARIDR,
FLTMST.FLTSEQNUM FLTSEQNUM,
  FLTMST.FLTDAT FLTDAT,
  MST.SHPPFX
  || '-'
  || MST.MSTDOCNUM


AWBNUM,
  MST.ORGCOD ORGCOD,MST.DOCOWRIDR DOCOWRIDR,MST.SEQNUM SEQNUM,MST.DUPNUM DUPNUM,
  MST.DSTCOD


DSTCOD,
  MST.AGTCOD AGTCOD,
  REPLACE (MST.AGTNAM,',',' ')AGTNAM ,
  MST.PRDNAM PRDNAM,
  MST.SCCCOD


SCCCOD,
  SEGSHP.MFTWGT MFTWGT,
  (SEGSHP.MFTWGT/ MST.STDWGT)*
  (SELECT SUM(COALESCE(RATDTL.CHGWGT,0


))
  FROM OPRSHPRATDTL RATDTL
  WHERE MST.DOCOWRIDR = RATDTL.DOCOWRIDR
  AND MST.MSTDOCNUM   = RATDTL.MSTDOCNUM



AND MST.DUPNUM      = RATDTL.DUPNUM
  AND MST.SEQNUM      = RATDTL.SEQNUM
  AND MST.CMPCOD      = RATDTL.CMPCOD



  ) CHGWGT,
  DTL.CMDITMNAM
FROM OPRSEGSHP SEGSHP,
  OPRSHPMST MST ,
  OPRSHPRATDTL DTL,
  FLTOPRMST

FLTMST,

  SHRARLMST ARLMST
WHERE MST.DOCOWRIDR  = DTL.DOCOWRIDR
AND MST.MSTDOCNUM    = DTL.MSTDOCNUM
AND

MST.DUPNUM
= DTL.DUPNUM
AND MST.SEQNUM       = DTL.SEQNUM
AND MST.CMPCOD       = DTL.CMPCOD
AND

MST.DOCOWRIDR
= SEGSHP.DOCOWRIDR
AND MST.MSTDOCNUM    = SEGSHP.MSTDOCNUM
AND MST.DUPNUM       =
SEGSHP.DUPNUM
AND
MST.SEQNUM
= SEGSHP.SEQNUM
AND MST.CMPCOD       = SEGSHP.CMPCOD
AND SEGSHP.FLTCARIDR
= FLTMST.FLTCARIDR
AND
SEGSHP.FLTNUM
= FLTMST.FLTNUM
AND SEGSHP.FLTSEQNUM = FLTMST.FLTSEQNUM
AND
SEGSHP.CMPCOD    = FLTMST.CMPCOD
AND
ARLMST.CMPCOD
= SEGSHP.CMPCOD
AND ARLMST.ARLIDR    = SEGSHP.FLTCARIDR
AND
MST.SEQNUM       = 1
AND
SEGSHP.MFTPCS
>0
AND MST.CMPCOD       = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<!-- A-4815 Changes ends here -->
	<!-- A-4823 Changes starts here -->
	<QRY:Definition>
		<QRY:Id>312</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.cargotonnage.segmentlevel" Type="NATIVE">
			<![CDATA[
      		SELECT SEGORG,
      		  SEGDST,
      		  AGTCOD,
      		  AGTNAM,
      		  SUM(MFTWGT) MFTWGT,



      		  SUM(CHGWGT) CHGWGT
      		FROM
      		  (SELECT ARLMST.TWOAPHCOD
      		    ||'-'


      		    || SEGSHP.FLTNUM
FLTNUM,
      		    FLTMST.FLTDAT FLTDAT,
      		    MST.SHPPFX

|| '-'

      		    || MST.MSTDOCNUM
AWBNUM,
      		    MST.ORGCOD ORGCOD,

MST.DSTCOD DSTCOD,
      		    MST.AGTCOD
AGTCOD,

FLTSEG.SEGORG SEGORG,
      		    FLTSEG.SEGDST
SEGDST,
      		    REPLACE (MST.AGTNAM,',','
')AGTNAM
,
      		    MST.PRDNAM PRDNAM,

MST.SCCCOD SCCCOD,
      		    SEGSHP.MFTWGT MFTWGT,


MST.STDWGT,
      		    (SEGSHP.MFTWGT/
MST.STDWGT)*
      		    (SELECT SUM(COALESCE(RATDTL.CHGWGT,0

))
      		    FROM OPRSHPRATDTL RATDTL

WHERE MST.DOCOWRIDR = RATDTL.DOCOWRIDR


AND MST.MSTDOCNUM   = RATDTL.MSTDOCNUM

AND MST.DUPNUM      = RATDTL.DUPNUM
      		    AND

MST.SEQNUM      = RATDTL.SEQNUM
      		    AND
MST.CMPCOD      = RATDTL.CMPCOD
      		    ) CHGWGT


FROM OPRSEGSHP SEGSHP,
      		    OPRSHPMST
MST ,
      		    FLTOPRMST FLTMST,
      		    FLTOPRSEG

FLTSEG,
      		    SHRARLMST ARLMST

WHERE MST.DOCOWRIDR  = SEGSHP.DOCOWRIDR
      		  AND

MST.MSTDOCNUM    = SEGSHP.MSTDOCNUM

AND MST.DUPNUM       = SEGSHP.DUPNUM
      		AND MST.SEQNUM

= SEGSHP.SEQNUM
      		  AND MST.CMPCOD
= SEGSHP.CMPCOD
      		  AND SEGSHP.FLTCARIDR = FLTMST.FLTCARIDR


AND SEGSHP.FLTNUM    =
FLTMST.FLTNUM
      		  AND SEGSHP.FLTSEQNUM = FLTMST.FLTSEQNUM
      		  AND

SEGSHP.CMPCOD    = FLTMST.CMPCOD

AND ARLMST.CMPCOD    = SEGSHP.CMPCOD
      		  AND ARLMST.ARLIDR

= SEGSHP.FLTCARIDR
      		  AND
FLTSEG.FLTNUM    = SEGSHP.FLTNUM
      		  AND FLTSEG.FLTCARIDR = SEGSHP.FLTCARIDR


AND FLTSEG.FLTSEQNUM
= SEGSHP.FLTSEQNUM
      		  AND FLTSEG.SEGSERNUM = SEGSHP.SEGSERNUM

      		  AND
FLTSEG.CMPCOD
= SEGSHP.CMPCOD
      		  AND MST.SEQNUM       = 1
      		  AND SEGSHP.MFTPCS
>0

AND
MST.CMPCOD       = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<!-- A-4823 Changes ends here -->
	<!-- A-4815 Changes starts here -->
	<QRY:Definition>
		<QRY:Id>313</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.cargotonnage.sectorlevel" Type="NATIVE">
			<![CDATA[
		SELECT SEGORG,
  SEGDST,
  AGTCOD,
  AGTNAM,
  SUM(MFTWGT) MFTWGT,
  SUM(CHGWGT) CHGWGT,
  DOMIND
FROM



  (SELECT FLTMST.FLTDAT FLTDAT,
    MST.SHPPFX
    || '-'
    || MST.MSTDOCNUM AWBNUM,
    MST.AGTCOD

AGTCOD,

    FLTSEG.SEGORG SEGORG,
    FLTSEG.SEGDST SEGDST,
    REPLACE (MST.AGTNAM,',',' ')AGTNAM

,
    SEGSHP.MFTWGT
MFTWGT,
    MST.STDWGT,
    (SEGSHP.MFTWGT/ MST.STDWGT)*
    (SELECT SUM(COALESCE(RATDTL.CHGWGT,0

))

FROM OPRSHPRATDTL RATDTL
    WHERE MST.DOCOWRIDR = RATDTL.DOCOWRIDR
    AND MST.MSTDOCNUM
=
RATDTL.MSTDOCNUM

AND MST.DUPNUM      = RATDTL.DUPNUM
    AND MST.SEQNUM      = RATDTL.SEQNUM


    AND MST.CMPCOD      =
RATDTL.CMPCOD
    ) CHGWGT,
    CASE
      WHEN ORGMST.CNTCOD = DSTMST.CNTCOD


      AND (ORGMST.CNTCOD
=?
      OR DSTMST.CNTCOD   = ?)
      THEN 'D'
      ELSE 'I'
    END DOMIND

FROM
OPRSEGSHP SEGSHP,

    OPRSHPMST MST ,
    FLTOPRMST FLTMST,
    FLTOPRSEG FLTSEG,
    SHRARPMST

ORGMST,
    SHRARPMST DSTMST

  WHERE MST.DOCOWRIDR  = SEGSHP.DOCOWRIDR
  AND MST.MSTDOCNUM    = SEGSHP.MSTDOCNUM


  AND MST.DUPNUM
= SEGSHP.DUPNUM
  AND MST.SEQNUM       = SEGSHP.SEQNUM
  AND MST.CMPCOD
=
SEGSHP.CMPCOD
  AND SEGSHP.FLTCARIDR
= FLTMST.FLTCARIDR
  AND SEGSHP.FLTNUM    = FLTMST.FLTNUM

AND
SEGSHP.FLTSEQNUM = FLTMST.FLTSEQNUM

AND SEGSHP.CMPCOD    = FLTMST.CMPCOD
  AND MST.SEQNUM
=
1
  AND FLTSEG.FLTNUM    = SEGSHP.FLTNUM

AND FLTSEG.FLTCARIDR = SEGSHP.FLTCARIDR
  AND FLTSEG.FLTSEQNUM

= SEGSHP.FLTSEQNUM
  AND FLTSEG.SEGSERNUM
= SEGSHP.SEGSERNUM
  AND FLTSEG.CMPCOD    = SEGSHP.CMPCOD


  AND ORGMST.CMPCOD    = FLTSEG.CMPCOD
  AND
ORGMST.ARPCOD    = FLTSEG.SEGORG
  AND DSTMST.CMPCOD
=
FLTSEG.CMPCOD
  AND DSTMST.ARPCOD    = FLTSEG.SEGDST

  AND MST.SEQNUM       = 1
  AND SEGSHP.MFTPCS

>0
  AND MST.CMPCOD       = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<!-- A-4815 Changes ends here -->
	<QRY:Definition>
		<QRY:Id>314</QRY:Id>
		<QRY:Source Name="operaions.flthandling.cto.findexportflightprogressdetails" Type="NATIVE">
			<![CDATA[
					   SELECT LEG.CMPCOD,
					       LEG.FLTCARIDR,
					       LEG.FLTNUM,
					       LEG.LEGSERNUM,



					       LEG.FLTSEQNUM,
					       LEG.LEGORG ARPCOD,
					       EXP.FINFLG,
					       LEG.STD

FLTDAT,

					       MST.FLTOWN,
					       EXP.FLTCARCOD,
					       LEG.STD,


					       LEG.LEGSTA,
					       MST.FLTROU,

					       MST.FLTTYP,
					       LEG.ETD,


					       LEG.ATD,
					       BKGMST.SHPPFX BKGPFX,
					       BKGMST.MSTDOCNUM
BKGAWB ,

BKGMST.DOCOWRIDR
BKGOWRIDR,
					       BKGMST.SEQNUM BKGSEQNUM,
					       BKGMST.DUPNUM
BKGDUPNUM,

SEGULD.ULDNUM
BKGULDNUM,
					       (
					       CASE
					         WHEN SEGSHP.PLNPCS>0



					         THEN 'Y'
					         ELSE 'N'
					       END)LDPFLG,
					       (

CASE


					         WHEN SEGSHP.BDPPCS>0
					         THEN 'Y'
					         ELSE 'N'

END)BDPFLG,


					       (
					       CASE
					         WHEN 'MFT' = (SELECT TXNCOD  FROM
OPREXPFLTHIS EXPHIS

								WHERE
EXPHIS.FLTNUM = LEG.FLTNUM
								AND EXPHIS.FLTSEQNUM =
LEG.FLTSEQNUM
								AND EXPHIS.FLTCARIDR

= LEG.FLTCARIDR
								AND EXPHIS.CMPCOD = LEG.CMPCOD

AND EXPHIS.LEGSERNUM = LEG.LEGSERNUM


							    AND EXPHIS.TXNCOD='MFT')

					         THEN (CASE WHEN COALESCE(BKGFLT.NUMPCS,0)
= COALESCE(SEGSHP.MFTPCS,0)
THEN 'Y' ELSE
'P' END )
					         ELSE 'N'
					       END)MFTFLG,

					       (
					       CASE


					         WHEN DWSULD.ULDNUM IS NOT NULL
					         THEN 'Y'

					         ELSE
'N'
					       END)DWSFLG,

						   (
							CASE
							  WHEN 'OFL' =
							  (SELECT
TXNCOD

FROM OPREXPFLTHIS EXPHIS

							  WHERE EXPHIS.FLTNUM  = LEG.FLTNUM

							  AND
EXPHIS.FLTSEQNUM = LEG.FLTSEQNUM
							  AND EXPHIS.FLTCARIDR
= LEG.FLTCARIDR
							  AND EXPHIS.CMPCOD

= LEG.CMPCOD
							  AND EXPHIS.LEGSERNUM = LEG.LEGSERNUM

							  AND EXPHIS.TXNCOD    ='OFL'


							  )
							  THEN 'Y'
							  ELSE 'N'
							END)OFLFLG,

					       PRGMST.ACRGRP
ACRGRP,

					       PRGMST.MILSTN MILSTN,
					       PRGMST.MINTIM MINTIM,


					       PRGMST.MAXTIM MAXTIM,

					       PRGMST.PCTLWRRNG PCTLWRRNG,
						   PRGMST.PCTUPRRNG
PCTUPRRNG,

					       PRGMST.TFCCLR
TFCCLR,
					       NULL AS BKGDTLFLTCARIDR,

NULL AS BKGDTLFLTNUM,


					       NULL AS BKGDTLFLTSEQNUM,
					       NULL
AS BKGDTLCMPCOD,
					       NULL AS FLTORG,
					       NULL

AS FLTDST,
					       NULL AS IMPFLTFLTCARCOD,

NULL AS IMPLEGFLTCARIDR,
					       NULL

AS IMPLEGFLTSEQNUM,
					       NULL AS IMPLEGFLTNUM,

NULL AS IMPLEGLEGSERNUM,


					       NULL AS FLTOPRSTA,
					       NULL AS IMPLEGSTA,

NULL AS ARRTIM,

					       NVL(NVL(LEG.ATD,
LEG.ETD), LEG.STD) DEPTIM,
					       NULL
AS ARRTYPTIM,
					       (

					       CASE

					         WHEN LEG.ATD IS
NOT NULL
					         THEN 'A'
					         WHEN
LEG.ETD IS NOT NULL


THEN 'E'
					         ELSE 'S'
					       END) DEPTYPTIM,

					       NULL AS MINCONTIM,


					       NULL AS MAXCONTIM,
					       NULL AS SCCCOD,

					       NULL AS CONTIMSCCCOD,

NULL AS
LGTSTA,
					       NULL AS POU,
					       NULL AS MSTDOCNUM,

					       NULL
AS DUPNUM,

					       NULL AS SEQNUM,
					       NULL AS DOCOWRIDR, MST.FLTSTA,


						   LEG.ACRTYP,
						   (SELECT MAX(HNDOVRTIM)
MAXHNDOVRTIM
							  FROM FLTOPRCTRSTN

WHERE CMPCOD
= LEG.CMPCOD
							  AND FLTCARIDR = LEG.FLTCARIDR

AND FLTNUM = LEG.FLTNUM

AND FLTSEQNUM
= LEG.FLTSEQNUM
							  ) HNDOVRTIM
					     FROM FLTOPRLEG
LEG


INNER JOIN FLTOPRMST
MST

					     ON LEG.FLTCARIDR  = MST.FLTCARIDR


AND LEG.FLTNUM    = MST.FLTNUM

					     AND LEG.FLTSEQNUM = MST.FLTSEQNUM
					     AND LEG.CMPCOD

= MST.CMPCOD

					     INNER
JOIN FLTOPRSEG SEG

					     ON LEG.FLTCARIDR  =
SEG.FLTCARIDR

					     AND LEG.FLTNUM
= SEG.FLTNUM
					     AND LEG.FLTSEQNUM = SEG.FLTSEQNUM

AND LEG.CMPCOD
= SEG.CMPCOD

					     AND LEG.LEGORG    = SEG.SEGORG


LEFT OUTER JOIN CAPBKGFLTDTL
BKGFLT


					     ON  SEG.FLTCARIDR  = BKGFLT.FLTCARIDR

AND SEG.FLTNUM    = BKGFLT.FLTNUM


					     AND SEG.FLTSEQNUM = BKGFLT.FLTSEQNUM

AND SEG.CMPCOD    = BKGFLT.CMPCOD
					     AND SEG.SEGORG

= BKGFLT.FLTORG
					     AND SEG.SEGDST
= BKGFLT.FLTDST
					     AND BKGFLT.FLTBKGSTA ='C'



					     LEFT OUTER JOIN CAPBKGMST
BKGMST

					     ON BKGFLT.CMPCOD =BKGMST.CMPCOD


					     AND BKGFLT.UBRNUM=BKGMST.UBRNUM


					      LEFT OUTER JOIN OPRARPEXPFLT EXP



					     ON LEG.FLTCARIDR
= EXP.FLTCARIDR
					     AND LEG.FLTNUM    = EXP.FLTNUM

					     AND LEG.FLTSEQNUM
= EXP.FLTSEQNUM

AND LEG.CMPCOD    = EXP.CMPCOD
					     AND LEG.LEGORG
= EXP.ARPCOD

					     AND LEG.LEGSERNUM
= EXP.LEGSERNUM

					      LEFT OUTER
JOIN OPRFLTSEG FLTSEG



ON BKGFLT.FLTCARIDR  = FLTSEG.FLTCARIDR

					     AND BKGFLT.FLTNUM    = FLTSEG.FLTNUM

AND
BKGFLT.FLTSEQNUM = FLTSEG.FLTSEQNUM
					     AND
BKGFLT.CMPCOD    = FLTSEG.CMPCOD
					     AND
BKGFLT.FLTORG
= FLTSEG.POL

					     LEFT
OUTER JOIN OPRSEGSHP SEGSHP


ON BKGFLT.FLTCARIDR
= SEGSHP.FLTCARIDR
					     AND
BKGFLT.FLTNUM    = SEGSHP.FLTNUM
					     AND
BKGFLT.FLTSEQNUM = SEGSHP.FLTSEQNUM

AND BKGFLT.CMPCOD
= SEGSHP.CMPCOD
					     AND BKGFLT.DOCOWRIDR
= SEGSHP.DOCOWRIDR
					     AND
BKGFLT.MSTDOCNUM = SEGSHP.MSTDOCNUM

					     AND BKGFLT.SEQNUM
= SEGSHP.SEQNUM
					     AND BKGFLT.DUPNUM
= SEGSHP.DUPNUM
					     AND BKGFLT.SEGSERNUM
= SEGSHP.SEGSERNUM


					     LEFT OUTER JOIN
OPRSEGULD SEGULD

					     ON  FLTSEG.FLTCARIDR
= SEGULD.FLTCARIDR

AND FLTSEG.FLTNUM
= SEGULD.FLTNUM
					     AND FLTSEG.FLTSEQNUM = SEGULD.FLTSEQNUM

AND
FLTSEG.CMPCOD    = SEGULD.CMPCOD

AND FLTSEG.SEGSERNUM = SEGULD.SEGSERNUM
					     AND
SEGULD.ULDNUM
<>'BULK'

					     LEFT
OUTER JOIN OPRDWSULD DWSULD


					     ON DWSULD.CMPCOD
=SEGULD.CMPCOD
					     AND DWSULD.FLTCARIDR=SEGULD.FLTCARIDR


					     AND DWSULD.FLTNUM
=SEGULD.FLTNUM
					     AND DWSULD.FLTSEQNUM=SEGULD.FLTSEQNUM
					     AND DWSULD.ULDNUM

=SEGULD.ULDNUM


					     LEFT OUTER JOIN SHRFLTPRGCTCMST PRGMST

					     ON LEG.CMPCOD

=PRGMST.CMPCOD

AND LEG.LEGORG      =PRGMST.ARPCOD



AND MST.FLTTYP      =PRGMST.ACRGRP

					   WHERE
LEG.LEGORG = ?
 					    AND LEG.CMPCOD = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>315</QRY:Id>
		<QRY:Source Name="operaions.flthandling.cto.findexportflightprogressconnectionflights" Type="NATIVE">
			<![CDATA[
			   SELECT LEG.CMPCOD,
			     LEG.FLTCARIDR,
			     LEG.FLTNUM,
			     LEG.LEGSERNUM,
			     LEG.FLTSEQNUM,



			     LEG.LEGORG ARPCOD,
			     NULL AS
			   FINFLG,
			     LEG.STD FLTDAT,
			     FLTMST.FLTOWN,



			     FLTMST.FLTOWN AS
			   FLTCARCOD,
			    LEG.STD,
			     LEG.LEGSTA,
			     FLTMST.FLTROU,



			     FLTMST.FLTTYP,
			     LEG.ETD,
			     LEG.ATD,
			     MST.SHPPFX AS  BKGPFX,
			     NULL

AS  BKGAWB
,
			     NULL AS BKGOWRIDR,
			     NULL AS BKGSEQNUM,
			     NULL AS BKGDUPNUM,


			     NULL AS BKGULDNUM,

			     NULL AS LDPFLG,
			     NULL AS BDPFLG,
			     NULL AS
MFTFLG,

                             NULL AS
DWSFLG,
							 NULL AS OFLFLG,

NULL AS ACRGRP,


                             NULL AS MILSTN,
			     NULL
AS MINTIM,
			     NULL AS MAXTIM,

			     0 AS PCTLWRRNG,
				 0 AS PCTUPRRNG,


                             NULL
AS TFCCLR,
			      BKGDTL.FLTCARIDR as BKGDTLFLTCARIDR,

BKGDTL.FLTNUM as BKGDTLFLTNUM,


			          BKGDTL.FLTSEQNUM as BKGDTLFLTSEQNUM,

BKGDTL.CMPCOD  as BKGDTLCMPCOD,
			     BKGDTL.FLTORG,


			     BKGDTL.FLTDST,
			     IMPFLT.FLTCARCOD
IMPFLTFLTCARCOD,
			     IMPLEG.FLTCARIDR IMPLEGFLTCARIDR,


			     IMPLEG.FLTSEQNUM IMPLEGFLTSEQNUM,

IMPLEG.FLTNUM IMPLEGFLTNUM,
			     IMPLEG.LEGSERNUM
IMPLEGLEGSERNUM,

			    IMPFLT.FLTOPRSTA,

IMPLEG.STA IMPLEGSTA,
			     NVL(NVL(IMPLEG.ATA,
IMPLEG.ETA),   IMPLEG.STA)
ARRTIM,
			     NVL(NVL(LEG.ATD,
LEG.ETD),   LEG.STD) DEPTIM,
			     (CASE

			     					WHEN IMPLEG.ATA
IS NOT NULL THEN
'A'
			     					WHEN IMPLEG.ETA IS NOT NULL THEN 'E'

			     					ELSE 'S'
					END)
ARRTYPTIM,

(CASE
						     					WHEN LEG.ATD IS NOT NULL THEN 'A'

						     					WHEN LEG.ETD
IS
NOT NULL THEN 'E'
						     					ELSE 'S'
					END) DEPTYPTIM,
			     CONTIM.MINCONTIM,


			     CONTIM.MAXCONTIM,

			     CONTIM.SCCCOD,
			     NVL(CONTIM.SCCCOD,MST.SCCCOD) CONTIMSCCCOD,


			    CONTIM.LGTSTA,
			     OPRSEG.POU,

			     BKGDTL.MSTDOCNUM,
			     BKGDTL.DUPNUM,


			     BKGDTL.SEQNUM,
			    BKGDTL.DOCOWRIDR, FLTMST.FLTSTA,

				LEG.ACRTYP,
				(SELECT MAX(HNDOVRTIM)

MAXHNDOVRTIM
				  FROM FLTOPRCTRSTN
				  WHERE CMPCOD = LEG.CMPCOD

				  AND FLTCARIDR = LEG.FLTCARIDR


				  AND FLTNUM = LEG.FLTNUM
				  AND FLTSEQNUM = LEG.FLTSEQNUM

				  ) HNDOVRTIM
			     FROM
CAPBKGFLTDTL
BKGDTL,
			     OPRARPIMPFLT IMPFLT,
			     FLTOPRLEG IMPLEG,

			     FLTOPRLEG
LEG,

			     OPRFLTSEG OPRSEG,
			     OPRSEGSHP SEGSHP,
			     OPRSHPMST MST,
			     SHRCONTIMMST

CONTIM,

			     FLTOPRMST FLTMST
			    WHERE IMPLEG.FLTCARIDR = IMPFLT.FLTCARIDR
			    AND
IMPLEG.FLTNUM
= IMPFLT.FLTNUM

			    AND IMPLEG.FLTSEQNUM = IMPFLT.FLTSEQNUM
			    AND IMPLEG.CMPCOD
= IMPFLT.CMPCOD

			    AND IMPLEG.LEGSERNUM
= IMPFLT.LEGSERNUM
			    AND BKGDTL.MSTDOCNUM =
SEGSHP.MSTDOCNUM
			    AND BKGDTL.DUPNUM
= SEGSHP.DUPNUM

			    AND BKGDTL.SEQNUM = SEGSHP.SEQNUM

AND BKGDTL.DOCOWRIDR = SEGSHP.DOCOWRIDR

			    AND BKGDTL.CMPCOD
= SEGSHP.CMPCOD
			    AND
BKGDTL.FLTCARIDR = LEG.FLTCARIDR
			    AND BKGDTL.FLTNUM
= LEG.FLTNUM

			    AND BKGDTL.FLTSEQNUM
= LEG.FLTSEQNUM
			    AND BKGDTL.CMPCOD = LEG.CMPCOD

			    AND BKGDTL.FLTORG
= LEG.LEGORG


			    AND LEG.FLTCARIDR = FLTMST.FLTCARIDR
			    AND LEG.FLTNUM
= FLTMST.FLTNUM

			    AND
LEG.FLTSEQNUM = FLTMST.FLTSEQNUM
			    AND LEG.CMPCOD = FLTMST.CMPCOD

AND MST.MSTDOCNUM
= SEGSHP.MSTDOCNUM

AND MST.DUPNUM = SEGSHP.DUPNUM
			    AND MST.SEQNUM = SEGSHP.SEQNUM


			    AND MST.DOCOWRIDR
= SEGSHP.DOCOWRIDR
			    AND MST.CMPCOD = SEGSHP.CMPCOD
			    AND OPRSEG.POU
= BKGDTL.FLTORG


			    AND SEGSHP.FLTCARIDR = OPRSEG.FLTCARIDR
			    AND SEGSHP.FLTNUM = OPRSEG.FLTNUM


AND SEGSHP.FLTSEQNUM
= OPRSEG.FLTSEQNUM
			    AND SEGSHP.CMPCOD = OPRSEG.CMPCOD
			    AND SEGSHP.SEGSERNUM

= OPRSEG.SEGSERNUM

			    AND IMPFLT.FLTCARIDR = OPRSEG.FLTCARIDR
			    AND IMPFLT.FLTNUM =

OPRSEG.FLTNUM
			    AND IMPFLT.FLTSEQNUM
= OPRSEG.FLTSEQNUM
			    AND IMPFLT.CMPCOD = OPRSEG.CMPCOD


			    AND IMPFLT.ARPCOD = OPRSEG.POU

			    AND CONTIM.CMPCOD(+) = MST.CMPCOD
			    AND MST.SCCCOD

= CONTIM.SCCCOD(+)
			    AND MST.ORGCOD <> MST.DSTCOD

			    AND MST.DSTCOD <> OPRSEG.POU


			    AND OPRSEG.POU = ?
			    AND CONTIM.ARPCOD(+) = ?
			    AND OPRSEG.CMPCOD = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>314</QRY:Id>
				<QRY:Source Name="operations.flthandling.cto.findimportflightprogressdetails_part1" Type="NATIVE">
			<![CDATA[
 SELECT fltcaridr,
  fltnum,
  fltdat,
          y.cmpcod,
  arrtim,
  arrtyptim,
  fltrou,
  flttyp,



  fltsta,
  legsernum,
  arpcod,
  mstdocnum,
  dupnum,
  seqnum,
  docowridr,
  eta,
  ata,
  sta,


  std,

  shppfx,
  fltseqnum,
  acrgrp,
  milstn,
  mintim,
  maxtim,
        y.PCTLWRRNG,


          y.PCTUPRRNG,

          tfcclr,
           thruld,
 bdnuld,rcvflg,
  arrflg,
  docrcvcnt,


  docrcvflg,
  bdnflg,
  clsflg,

  bdncnt,
  mftshpcnt,
          SRVRCVCNT,
          SRVRCVFLG,


          fltown,
  lgtsta
        FROM
(SELECT fltcaridr,
          fltnum,
          fltdat,
  x.cmpcod,

arrtim,

  arrtyptim,

  fltrou,
  flttyp,
  fltsta,
  legsernum,
  arpcod,
  mstdocnum,
  dupnum,

seqnum,

  docowridr,
  eta,

  ata,
  sta,
  std,
  shppfx,
  fltseqnum,
  acrgrp,
  milstn,
  mintim,

maxtim,

  x.PCTLWRRNG,
  x.PCTUPRRNG,

tfcclr,
    COUNT (DISTINCT thruld) OVER (PARTITION BY x.cmpcod,
fltcaridr,
fltnum, fltseqnum, pou) thruld,
    COUNT (DISTINCT bdnuld) OVER (PARTITION BY x.cmpcod,
fltcaridr, fltnum,
fltseqnum, pou) bdnuld,rcvflg,
  arrflg,
  docrcvcnt,
  docrcvflg,
  bdnflg,
  clsflg,

bdncnt,
  mftshpcnt,
          COUNT (DISTINCT SRVRCVDOCNUM) OVER (PARTITION BY x.cmpcod, fltcaridr, fltnum, fltseqnum, pou) SRVRCVCNT,
                   
            
                 
                   
                 
                 
             

            
                 





  SRVRCVFLG,
  fltown,
    lgtsta








FROM

  (SELECT DISTINCT FLT.FLTCARIDR,
  Flt.Fltnum,
  Flt.Fltdat,
   Flt.cmpcod,

seg.pou,


            NVL(NVL(Leg.Ata, Leg.Eta), Leg.Sta) Arrtim,
  (
  CASE
    WHEN LEG.ATA
IS NOT NULL

    THEN 'A'

    WHEN LEG.ETA IS NOT NULL
    THEN 'E'
    ELSE 'S'
  END) ARRTYPTIM,

FLT.FLTROU,

  FLT.FLTTYP,
  FLT.FLTSTA,


			     LEG.LEGSERNUM,
			     LEG.LEGDST ARPCOD,


SEGSHP.MSTDOCNUM,

			     SEGSHP.DUPNUM,

			     SEGSHP.SEQNUM,
			    SEGSHP.DOCOWRIDR,

			     LEG.ETA,
			     LEG.ATA,

    LEG.STA,
	Trnleg.Std,

	shpmst.SHPPFX,
    FLT.FLTSEQNUM,

seguld.segsernum,


			   PRGMST.ACRGRP
ACRGRP,
      PRGMST.MILSTN MILSTN,
			   PRGMST.MINTIM MINTIM,

PRGMST.MAXTIM MAXTIM,
			   PRGMST.PCTLWRRNG
PCTLWRRNG,

			   PRGMST.PCTUPRRNG PCTUPRRNG,

PRGMST.TFCCLR TFCCLR,


    CASE WHEN NVL(SEGULD.RCVFLG,'N')='Y'
			AND NVL(ULDBDN.THRINTFLG,'X')='T'

			THEN
SEGULD.ULDNUM
		WHEN SEGULD.BDNITN='THRUNT' AND NVL(SEGULD.RCVFLG,'N')='N'
			THEN SEGULD.ULDNUM

		WHEN
SEGULD.BDNITN IS NULL AND NVL(SEGULD.RCVFLG,'N')='N' AND SEGULD.THRUNT='Y' AND SEGULD.ULDNUM<>'BULK'


			THEN SEGULD.ULDNUM
			ELSE NULL END thruld,
   CASE WHEN NVL(RCVFLG,'N')='Y'
			AND NVL(ULDBDN.THRINTFLG,'X')<>'T'


			THEN SEGULD.ULDNUM
		WHEN SEGULD.BDNITN IN ('BDN','INTUNT') AND NVL(SEGULD.RCVFLG,'N')='N'
			THEN

SEGULD.ULDNUM
		WHEN SEGULD.BDNITN IS NULL AND NVL(SEGULD.RCVFLG,'N')='N' AND NVL(SEGULD.THRUNT,'X')<>'Y'


			THEN SEGULD.ULDNUM
			ELSE NULL END bdnuld, rcvflg,
   CASE
    WHEN LEG.ATA IS NOT NULL
    THEN
'Y'

        ELSE 'N'
            END Arrflg,
            (SELECT COUNT(1)
            FROM OPRARPSHP
ARPSHPmst


            WHERE ARPSHPmst.CMPCOD  = ARPSHP.CMPCOD
        AND ARPSHPmst.DOCOWRIDR
= ARPSHP.DOCOWRIDR

      AND ARPSHPmst.MSTDOCNUM = ARPSHP.MSTDOCNUM
        AND ARPSHPmst.DUPNUM
= ARPSHP.DUPNUM
      AND
ARPSHPmst.Seqnum    = Arpshp.Seqnum
        AND ARPSHPmst.ARPCOD
=ARPSHP.ARPCOD
      AND ARPSHPmst.Docrcvflg
='Y'
        )DocrcvCNT,
            COALESCE (Arpshp.Docrcvflg,'N')
Docrcvflg,
  CASE
    WHEN SEGSHP.RCVPCS>0


    THEN 'Y'
    ELSE 'N'
  END BDNFLG,
  Imp.Clsflg,

(SELECT COUNT(DISTINCT MSTSEGshp.MSTDOCNUM


        ||'-'
        || MSTSEGshp.DOCOWRIDR)

FROM OPRSEGSHP MSTSEGshp join OPRFLTSEG FLTSEG
ON
               MSTSEGshp.CMPCOD = FLTSEG.CMPCOD

AND MSTSEGshp.FLTCARIDR = FLTSEG.FLTCARIDR

               AND MSTSEGshp.FLTNUM = FLTSEG.FLTNUM

AND MSTSEGshp.FLTSEQNUM = FLTSEG.FLTSEQNUM

               AND MSTSEGshp.SEGSERNUM = FLTSEG.SEGSERNUM

WHERE MSTSEGshp.CMPCOD = SEGSHP.CMPCOD

          AND MSTSEGshp.FLTCARIDR = SEGSHP.FLTCARIDR

AND MSTSEGshp.FLTNUM = SEGSHP.FLTNUM

          AND MSTSEGshp.FLTSEQNUM = SEGSHP.FLTSEQNUM

AND FLTSEG.POU = Seg.POU
               AND
MSTSEGshp.RCVPCS >0
          )bdncNT,
            (SELECT
COUNT(1)

            FROM OPRSEGSHP
MSTSEG join OPRFLTSEG FLTSEG ON
               MSTSEG.CMPCOD
= FLTSEG.CMPCOD
               AND MSTSEG.FLTCARIDR
= FLTSEG.FLTCARIDR
               AND MSTSEG.FLTNUM
= FLTSEG.FLTNUM
               AND MSTSEG.FLTSEQNUM
= FLTSEG.FLTSEQNUM
               AND MSTSEG.SEGSERNUM
= FLTSEG.SEGSERNUM
               WHERE MSTSEG.CMPCOD
= Seg.CMPCOD
               AND MSTSEG.FLTCARIDR
= Seg.FLTCARIDR
               AND MSTSEG.FLTNUM = Seg.FLTNUM

               AND MSTSEG.FLTSEQNUM
= Seg.FLTSEQNUM
               AND FLTSEG.POU = Seg.POU
         AND MSTSEG.MFTPCS
>0
          )MFTSHPCNT,


            CASE
             WHEN SRVRCV.SRVRCVSTA = 'A'

              THEN SRVRCV.mstdocnum


              ELSE NULL
            END SRVRCVDOCNUM,

    CASE
      WHEN SRVRCV.SRVRCVSTA = 'A'

THEN 'Y'

      ELSE 'N'
    END SRVRCVFLG,
	  DECODE(ARLMST.APHCODUSE,2,ARLMST.TWOAPHCOD,ARLMST.THRAPHCOD)FLTOWN,



    CASE
      WHEN TRNLEG.CMPCOD IS NOT NULL
      THEN
                (SELECT LGTSTA



                                                FROM SHRCONTIMMST CONTIM
                WHERE CONTIM.CMPCOD

= TRNLEG.CMPCOD
          AND CONTIM.ARPCOD   = TRNLEG.LEGORG
                    AND CONTIM.SCCCOD

=SHPMST.SCCCOD
          AND (Trnleg.Std - Leg.Sta )*24*60 BETWEEN Contim.Mincontim AND Contim.Maxcontim


        )
      ELSE NULL
    END LGTSTA
    FROM FLTOPRLEG LEG
JOIN FLTOPRMST FLT
ON LEG.CMPCOD
= FLT.CMPCOD
AND
LEG.FLTCARIDR = FLT.FLTCARIDR
    AND LEG.FLTNUM    = FLT.FLTNUM
AND LEG.FLTSEQNUM
= FLT.FLTSEQNUM

          INNER JOIN SHRARLMST ARLMST

          ON ARLMST.CMPCOD
= FLT.CMPCOD
  AND ARLMST.ARLIDR =
FLT.FLTCARIDR
LEFT OUTER JOIN OPRfltseg sEG
    ON leg.CMPCOD
= seg.CMPCOD
AND LEG.FLTCARIDR    =
SEG.FLTCARIDR
AND LEG.FLTNUM       = SEG.FLTNUM
    AND LEG.FLTSEQNUM
= SEG.FLTSEQNUM
AND LEG.LEGDST
= SEG.POU
LEFT OUTER JOIN oprsegshp segshp
ON SEG.CMPCOD     =
SEGSHP.CMPCOD
    AND SEG.FLTCARIDR =
SEGSHP.FLTCARIDR
AND SEG.FLTNUM       = SEGSHP.FLTNUM
AND SEG.FLTSEQNUM
= SEGSHP.FLTSEQNUM


          AND Seg.Segsernum = Segshp.Segsernum
          AND
SEGSHP.MFTPCS >0

LEFT OUTER JOIN oprshpmst shpmst
ON SEGSHP.CMPCOD
= shpmst.CMPCOD
    AND SEGSHP.DOCOWRIDR
= shpmst.DOCOWRIDR
AND SEGSHP.MSTDOCNUM = shpmst.MSTDOCNUM
AND
SEGSHP.DUPNUM    = shpmst.DUPNUM

AND SEGSHP.SEQNUM    = shpmst.SEQNUM

LEFT
OUTER JOIN OPRARPSHP ARPSHP
    ON shpmst.CMPCOD     =
ARPSHP.CMPCOD
AND shpmst.DOCOWRIDR = ARPSHP.DOCOWRIDR
AND
shpmst.MSTDOCNUM = ARPSHP.MSTDOCNUM
    AND
shpmst.DUPNUM    = ARPSHP.DUPNUM
AND Shpmst.Seqnum    = Arpshp.Seqnum
AND
SEG.POU          =ARPSHP.ARPCOD

LEFT OUTER JOIN Oprarpimpflt IMP
ON LEG.CMPCOD     = IMP.CMPCOD
AND
LEG.FLTCARIDR    = IMP.FLTCARIDR

AND LEG.FLTNUM    = IMP.FLTNUM
			    AND LEG.FLTSEQNUM = IMP.FLTSEQNUM

			    AND LEG.LEGSERNUM
= IMP.LEGSERNUM
				AND LEG.LEGDST = IMP.ARPCOD
 ]]>
				</QRY:Source>
		</QRY:Definition>
		
<QRY:Definition>
				<QRY:Id>390</QRY:Id>
				<QRY:Source Name="operations.flthandling.cto.findimportflightprogressdetails_part2" Type="NATIVE">
			<![CDATA[

    LEFT OUTER JOIN SHRFLTPRGCTCMST
PRGMST
ON LEG.CMPCOD  =PRGMST.CMPCOD
AND
LEG.LEGDST =PRGMST.ARPCOD
    AND FLT.FLTTYP = PRGMST.ACRGRP


LEFT OUTER JOIN Capbkgfltdtl Bkgflt
ON
Segshp.Cmpcod     = Bkgflt.Cmpcod
    AND SEGSHP.MSTDOCNUM =
Bkgflt.MSTDOCNUM
AND Segshp.Seqnum    =
Bkgflt.Seqnum
AND Segshp.Dupnum    = Bkgflt.Dupnum
    AND Segshp.Docowridr
= Bkgflt.Docowridr
AND Bkgflt.Fltorg
= LEG.LEGDST
LEFT OUTER JOIN Fltoprleg TRNLEG
    ON Bkgflt.Cmpcod
= TRNLEG.Cmpcod
AND Bkgflt.FLTCARIDR
= TRNLEG.FLTCARIDR
AND Bkgflt.FLTNUM    = TRNLEG.FLTNUM
    AND
Bkgflt.Fltseqnum = Trnleg.Fltseqnum
AND
Bkgflt.Fltorg    = Trnleg.Legorg

           LEFT OUTER JOIN QMSSHPALRLOG ALRLOG 
  ON Segshp.Cmpcod = ALRLOG.Cmpcod 
  AND SEGSHP.MSTDOCNUM = ALRLOG.MSTDOCNUM 
  AND Segshp.Seqnum = ALRLOG.Seqnum 
  AND Segshp.Dupnum = ALRLOG.Dupnum 
  AND SEGSHP.DOCOWRIDR = ALRLOG.DOCOWRIDR 
  AND SEGSHP.FLTCARIDR = ALRLOG.FLTCARIDR 
  AND SEGSHP.FLTNUM = ALRLOG.FLTNUM 
  AND SEGSHP.FLTSEQNUM = ALRLOG.FLTSEQNUM 
  AND ALRLOG.ARPCOD = LEG.LEGDST 
  AND ALRLOG.OPRTYP ='I' 
  LEFT OUTER JOIN QMSSRVRCVCSE SRVRCV
  ON ALRLOG.CMPCOD = SRVRCV.CMPCOD 
  AND ALRLOG.MSTDOCNUM =SRVRCV.MSTDOCNUM 
  AND ALRLOG.DOCOWRIDR = SRVRCV.DOCOWRIDR 
  AND ALRLOG.Seqnum = SRVRCV.Seqnum 
  AND ALRLOG.Dupnum = SRVRCV.Dupnum 
  AND ALRLOG.SERNUM = SRVRCV.ALRSERNUM 
  AND SRVRCV.CSETYP ='S' 
  AND SRVRCV.SRVRCVSTA ='A' 
          LEFT OUTER JOIN OPRULDBDNDTL ULDBDN

            ON SEGULD.Cmpcod     = ULDBDN.Cmpcod
            AND SEGULD.FLTCARIDR    = ULDBDN.FLTCARIDR


            AND SEGULD.FLTNUM    = ULDBDN.FLTNUM
            AND SEGULD.FLTSEQNUM    = ULDBDN.FLTSEQNUM

AND LEG.LEGSERNUM= ULDBDN.LEGSERNUM
            AND LEG.LEGDST= ULDBDN.ARPCOD
            AND SEGULD.ULDNUM
= ULDBDN.ULDNUM
WHERE LEG.LEGDST
= ?
          AND Leg.Cmpcod       = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>315</QRY:Id>
		<QRY:Source Name="operaions.flthandling.cto.findimportflightprogressconnectionflights" Type="NATIVE">
			<![CDATA[
			 		SELECT LEG.CMPCOD,
					  LEG.FLTCARIDR,
					  LEG.FLTNUM,
					  LEG.LEGSERNUM,
					  LEG.FLTSEQNUM,



					  LEG.LEGDST ARPCOD,
					  LEG.STA FLTDAT,
					  MST.FLTOWN,
					  MST.FLTOWN AS
					FLTCARCOD,



					MST.FLTTYP,
					  LEG.STA,

					  LEG.LEGSTA,
					  MST.FLTROU,
					  LEG.ETA,
					  LEG.ATA,



					  NULL AS OWRDIR,
					  SHPMST.SHPPFX AS SHPPFX,
					  SHPMST.MSTDOCNUM AS MSTDOCNUM,


					  NULL AS
SEQNUM,
			                  NULL AS DUPNUM,
					  BKGDTL.FLTNUM EXPFLTNUM,

BKGDTL.FLTSEQNUM

EXPFLTSEQNUM,
					  BKGDTL.FLTCARIDR EXPFLTCARIDR,
					  BKGDTL.FLTCARCOD EXPFLTCARCOD,

EXPLEG.LEGSERNUM

EXPLEGSERNUM,
					  EXPLEG.STD,
					  NVL(NVL(LEG.ATA,   LEG.ETA),   LEG.STA) ARRTIM,

(


					CASE
					WHEN LEG.ATA IS NOT NULL THEN 'A'
					WHEN LEG.ETA IS NOT NULL THEN 'E'

ELSE 'S'


					END) ARRTYPTIM,
					  NVL(NVL(EXPLEG.ATD,   EXPLEG.ETD),   EXPLEG.STD) DEPTIM,

(
					CASE


					WHEN EXPLEG.ATD IS NOT NULL THEN 'A'
					WHEN EXPLEG.ETD IS NOT NULL THEN 'E'

ELSE 'S'

					END)
DEPTYPTIM,
					  CONTIM.MINCONTIM,
					  CONTIM.MAXCONTIM,
					  CONTIM.SCCCOD,

NVL(CONTIM.SCCCOD,SHPMST.SCCCOD)

CONTIMSCCCOD,
					  CONTIM.LGTSTA,
					  EXP.FLTOPRSTA,
					  NULL
AS BDNFLG,
					  NULL AS ARRFLG,


			                  NULL AS CLSFLG,

NULL AS ACRGRP,
					  NULL AS MILSTN,

					  NULL AS MINTIM,

					  NULL AS MAXTIM,

NULL AS PCTLWRRNG,
					  NULL AS PCTUPRRNG,



NULL AS TFCCLR
					FROM OPRARPIMPFLT IMP,
					  CAPBKGFLTDTL
BKGDTL,
					  FLTOPRLEG EXPLEG,


					  OPRFLTSEG FLTSEG,
					  FLTOPRLEG LEG,
					  FLTOPRMST
MST,
					  OPRSEGSHP SEGSHP,

OPRSHPMST
SHPMST,
					  SHRCONTIMMST CONTIM,
					  OPRARPEXPFLT
EXP

					WHERE LEG.FLTCARIDR
= IMP.FLTCARIDR(+)

					 AND LEG.FLTNUM = IMP.FLTNUM(+)

					 AND LEG.FLTSEQNUM = IMP.FLTSEQNUM(+)

AND LEG.CMPCOD = IMP.CMPCOD(+)

					 AND LEG.LEGDST
= IMP.ARPCOD(+)
					 AND LEG.LEGSERNUM =
IMP.LEGSERNUM(+)
					 AND LEG.FLTCARIDR = MST.FLTCARIDR


					 AND LEG.FLTNUM = MST.FLTNUM

AND LEG.FLTSEQNUM = MST.FLTSEQNUM
					 AND LEG.CMPCOD = MST.CMPCOD


					 AND LEG.FLTCARIDR
= FLTSEG.FLTCARIDR
					 AND LEG.FLTNUM = FLTSEG.FLTNUM
					 AND LEG.FLTSEQNUM
= FLTSEG.FLTSEQNUM


					 AND LEG.CMPCOD = FLTSEG.CMPCOD
					 AND LEG.LEGDST = FLTSEG.POU

					 AND FLTSEG.FLTNUM
= SEGSHP.FLTNUM

					 AND FLTSEG.FLTSEQNUM = SEGSHP.FLTSEQNUM
					 AND FLTSEG.FLTCARIDR
= SEGSHP.FLTCARIDR

AND FLTSEG.SEGSERNUM
= SEGSHP.SEGSERNUM
					 AND FLTSEG.CMPCOD = SEGSHP.CMPCOD

AND BKGDTL.CMPCOD
= SEGSHP.CMPCOD

AND BKGDTL.MSTDOCNUM = SEGSHP.MSTDOCNUM
					 AND BKGDTL.SEQNUM
= SEGSHP.SEQNUM

AND BKGDTL.DUPNUM
= SEGSHP.DUPNUM
					 AND BKGDTL.DOCOWRIDR = SEGSHP.DOCOWRIDR

					 AND BKGDTL.FLTNUM
= EXPLEG.FLTNUM

					 AND BKGDTL.FLTSEQNUM = EXPLEG.FLTSEQNUM
					 AND BKGDTL.FLTCARIDR
= EXPLEG.FLTCARIDR

AND BKGDTL.FLTORG
= EXPLEG.LEGORG
					 AND BKGDTL.CMPCOD = EXPLEG.CMPCOD

					 AND EXPLEG.LEGORG
= LEG.LEGDST
					 AND
BKGDTL.CMPCOD = SHPMST.CMPCOD
					 AND BKGDTL.MSTDOCNUM =
SHPMST.MSTDOCNUM

AND BKGDTL.SEQNUM =
SHPMST.SEQNUM
					 AND BKGDTL.DUPNUM = SHPMST.DUPNUM

					 AND BKGDTL.DOCOWRIDR
= SHPMST.DOCOWRIDR


					 AND EXPLEG.FLTNUM = EXP.FLTNUM(+)
					 AND EXPLEG.FLTSEQNUM
= EXP.FLTSEQNUM(+)

AND EXPLEG.FLTCARIDR
= EXP.FLTCARIDR(+)
					 AND EXPLEG.LEGSERNUM = EXP.LEGSERNUM(+)

					 AND
EXPLEG.CMPCOD = EXP.CMPCOD(+)

					 AND CONTIM.CMPCOD(+) = SHPMST.CMPCOD
					 AND SHPMST.SCCCOD

= CONTIM.SCCCOD(+)
					 AND SHPMST.ORGCOD
<> SHPMST.DSTCOD
					 AND SHPMST.DSTCOD <> FLTSEG.POU


					 AND FLTSEG.POU = ?
					 AND LEG.LEGDST
= ?
					 AND LEG.CMPCOD = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>316</QRY:Id>
		<QRY:Source Name="operations.flthandling.findflightprogressdetailsformanifest" Type="NATIVE">
			<![CDATA[

				      SELECT MST.CMPCOD                      ,
				      seg.segsernum,
				        FLTMST.FLTTYP,



				        MST.SHPPFX                            ,
				        MST.DOCOWRIDR

,

				        MST.MSTDOCNUM                         ,
				        MST.DUPNUM

,

				        MST.EXEFLG                            ,
				        FLT.FLTORG

,

				        FLT.FLTDST                            ,
				        FLT.CFRPCS

,

				        FLT.CFRWGT                            ,
				        NVL(SEGSHP.MFTPCS,0)MFTPCS

,

				         NVL(SEGSHP.BDPPCS ,0)BDPPCS            ,
				        NVL(SEGSHP.OFLPCS,0)OFLPCS

,

				        NVL(ARPSHP.AVLPCS,0)AVLPCS,
				        NVL(ARPSHP.RCVPCS,0)RCVPCS,


				        NVL(ARPSHP.ACPPCS,0)ACPPCS,

				       ( CASE WHEN MST.ORGCOD!=FLT.FLTORG THEN
'Y' ELSE 'N'
END ) TRNSTFLG,
				        (case when ARPSHP.RCVPCS
> 0 OR ARPSHP.ACPPCS > 0 then 'Y'ELSE
'N' END)AVLFLG,

				        (
				        CASE
				          WHEN
SEGSHP.MFTPCS > 0

THEN 'Y'
				          ELSE 'N'

				        END) MFTFLG ,

				        (

CASE
				          WHEN SEGSHP.BDPPCS > 0

				           THEN 'Y'
				          ELSE
'N'

				        END )BDPFLG,
				        NVL(NVL(FLTLEG.ATD,
FLTLEG.ETD),   FLTLEG.STD)
STD
				         FROM OPRSHPMST
MST
				      INNER JOIN CAPBKGFLTDTL FLT


ON MST.DOCOWRIDR = FLT.DOCOWRIDR
				      AND
MST.MSTDOCNUM     = FLT.MSTDOCNUM
				      AND MST.DUPNUM

= FLT.DUPNUM
				      AND MST.SEQNUM
= FLT.SEQNUM
				        INNER JOIN FLTOPRMST FLTMST


				      ON  FLT.FLTNUM = FLTMST.FLTNUM

				      AND FLT.FLTSEQNUM = FLTMST.FLTSEQNUM


				      AND FLT.FLTCARIDR = FLTMST.FLTCARIDR
				      AND FLT.CMPCOD
= FLTMST.CMPCOD

INNER JOIN FLTOPRLEG
FLTLEG
				      ON  FLT.FLTNUM = FLTLEG.FLTNUM

				      AND FLT.FLTSEQNUM
= FLTLEG.FLTSEQNUM

				      AND FLT.FLTCARIDR = FLTLEG.FLTCARIDR
				      AND FLT.CMPCOD
= FLTLEG.CMPCOD

AND
FLT.FLTORG = FLTLEG.LEGORG
				      INNER JOIN FLTOPRSEG SEG

				           ON
FLT.CMPCOD
= SEG.CMPCOD
				      AND FLT.FLTCARIDR  = SEG.FLTCARIDR
				      AND FLT.FLTNUM
=
SEG.FLTNUM

AND FLT.FLTSEQNUM  = SEG.FLTSEQNUM
				      AND FLT.FLTORG     = SEG.SEGORG


AND FLT.FLTDST
= SEG.SEGDST
				      LEFT OUTER JOIN OPRSEGSHP SEGSHP
				      ON SEG.CMPCOD

=   SEGSHP.CMPCOD

				      AND SEG.FLTCARIDR     =SEGSHP.FLTCARIDR
				      AND SEG.FLTNUM
=SEGSHP.FLTNUM


				      AND SEG.FLTSEQNUM     =SEGSHP.FLTSEQNUM
				      AND
MST.CMPCOD        =SEGSHP.CMPCOD
				      AND

MST.DOCOWRIDR     =SEGSHP.DOCOWRIDR
				      AND MST.MSTDOCNUM
=SEGSHP.MSTDOCNUM
				      AND
MST.DUPNUM
=SEGSHP.DUPNUM
				      AND MST.SEQNUM        =SEGSHP.SEQNUM

LEFT OUTER
JOIN OPRARPSHP ARPSHP
ON
				      MST.CMPCOD         =ARPSHP.CMPCOD
				      AND MST.DOCOWRIDR

=ARPSHP.DOCOWRIDR

				      AND MST.MSTDOCNUM   =ARPSHP.MSTDOCNUM
				      AND MST.DUPNUM

=ARPSHP.DUPNUM
				      AND MST.SEQNUM
=ARPSHP.SEQNUM
				      AND ARPSHP.ARPCOD   = ?


				      WHERE FLT.FLTBKGSTA = 'C'
				      AND FLT.FLTORG
= ?
				      AND MST.MSTDOCNUM
IS NOT
NULL
				      AND FLT.CMPCOD        = ?
				      AND FLT.FLTCARIDR
= ?
				      AND FLT.FLTSEQNUM

= ?
				      AND FLT.FLTNUM        = ?
				      AND SEGSTA
<> 'D'


			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>316</QRY:Id>
		<QRY:Source Name="operations.flthandling.findflightcriticalitydetailsformanifest" Type="NATIVE">
			<![CDATA[

					    SELECT ARPCOD, ACRGRP,MILSTN,MINTIM, MAXTIM, PCTLWRRNG, PCTUPRRNG, TFCCLR FROM SHRFLTPRGCTCMST
WHERE 					    ARPCOD=? AND ACRGRP =? AND CMPCOD=?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>40</QRY:Id>
		<QRY:Source Name="operations.flthandling.flightdocument.fetchdocumentdetails" Type="NATIVE">
			<![CDATA[
			   SELECT FLT.DOCTYP,
				  FLT.RMK,
				  FLT.FILNAM,
				  FLT.CMPCOD,
				  FLT.FLTCARIDR,
				  FLT.FLTNUM,
				  FLT.FLTCARCOD,
				  FLT.FLTDAT,
				  FLT.ARPCOD,
				  FLT.FLTSEQNUM,
				  FLT.LEGSERNUM,
				  FLT.FILBLB
				FROM OPRFLTDOCDTL FLT
				WHERE FLT.CMPCOD  = ?
				AND FLT.FLTNUM    =?
				AND FLT.FLTCARIDR =?
				AND FLT.FLTSEQNUM =?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<!-- A-4781 Changes starts here -->
	<QRY:Definition>
		<QRY:Id>318</QRY:Id>
		<QRY:Source Name="operations.flthandling.loadplan.findFlightsforFBLtimetrigger" Type="NATIVE">
			<![CDATA[


			SELECT LEG.CMPCOD, LEG.FLTCARIDR, LEG.FLTNUM, LEG.FLTSEQNUM, LEG.LEGORG,LEG.LEGSERNUM, LEG.STD FLTDAT,MST.FLTROU,ARLMST.TWOAPHCOD 
FLTOWN,LEG.ACRTYP
			FROM FLTOPRMST MST JOIN FLTOPRLEG LEG
			ON MST.CMPCOD = LEG.CMPCOD
			AND MST.FLTCARIDR

=
LEG.FLTCARIDR
			AND MST.FLTNUM = LEG.FLTNUM
			AND MST.FLTSEQNUM = LEG.FLTSEQNUM
			JOIN SHRARLACTMST


ARLMST
			ON MST.CMPCOD     = ARLMST.CMPCOD
			AND MST.FLTCARIDR = ARLMST.ARLIDR
			JOIN SHRARLARPPAR


ARLPAR
			ON ARLPAR.CMPCOD = LEG.CMPCOD
			AND ARLPAR.ARPCOD = LEG.LEGORG
			AND ARLPAR.ARLIDR = LEG.FLTCARIDR



			AND ARLPAR.PARCOD ='shared.airline.timePeriodForFBLTimeTrigger'
			WHERE LEG.CMPCOD = ?
			AND COALESCE(ARLPAR.PARVAL,'0')

<> '0'
			AND LEG.STDUTC  between  Pkg_Frmwrk_Date.fun_get_sysdateutc() -(?)/24 and Pkg_Frmwrk_Date.fun_get_sysdateutc()+ (.000694 * ARLPAR.PARVAL)

			AND NOT EXISTS (SELECT 1 FROM OPREXPFLTHIS HIS
			WHERE


LEG.CMPCOD = HIS.CMPCOD
			AND LEG.FLTCARIDR = HIS.FLTCARIDR
			AND LEG.FLTNUM = HIS.FLTNUM
			AND
LEG.FLTSEQNUM

= HIS.FLTSEQNUM
			AND LEG.LEGSERNUM = HIS.LEGSERNUM
			AND HIS.TXNCOD = 'FBLSNT')



			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>2</QRY:Id>
		<QRY:Source Name="operations.manifest.findmanifestflightdetailsforimportprint" Type="NATIVE">
			<![CDATA[
			SELECT EXPFLT.FLTCARIDR, EXPFLT.FLTNUM, EXPFLT.FLTSEQNUM, EXPFLT.LEGSERNUM,
				   EXPFLT.ARPCOD, EXPFLT.CMPCOD, EXPFLT.FLTDAT,
				   EXPFLT.FLTCARCOD, ARLMST.ARLNAM,ARLMST.NATNTY
			  FROM OPRARPIMPFLT EXPFLT, SHRARLMST ARLMST
			 WHERE EXPFLT.CMPCOD = ARLMST.CMPCOD
			   AND EXPFLT.FLTCARIDR = ARLMST.ARLIDR
			   AND EXPFLT.FLTCARIDR = ?
			   AND EXPFLT.FLTNUM = ?
			   AND EXPFLT.FLTSEQNUM = ?
			   AND EXPFLT.CMPCOD = ?
			   AND EXPFLT.ARPCOD = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<!-- A-4781 Changes ends here -->
	<!-- Added by A-5253 as part of ICRD-18843 Start -->
	<QRY:Definition>
		<QRY:Id>319</QRY:Id>
		<QRY:Source Name="operations.flthandling.findarrivalnoticedetailsforreport" Type="NATIVE">
			<![CDATA[
SELECT  IMPFLT.FLTCARCOD,SEGSHP.FLTNUM,IMPFLT.FLTDAT,
					SEGSHP.CMPCOD,SEGSHP.FLTCARIDR,SEGSHP.FLTSEQNUM,SEGSHP.SEGSERNUM,



					SEGSHP.RCVPCS, SEGSHP.RCVWGT, SEGSHP.ARVRMK,
					MST.DOCOWRIDR, MST.SHPPFX,MST.MSTDOCNUM, MST.DUPNUM,MST.SEQNUM,MST.SHPDES,



					MST.SHPCOD,MST.SHPNAM,MST.CNSCOD,MST.CNSNAM, MST.CNSADRONE,
					CNT.CNSADRTWO,CNT.CNSCTY,CNT.CNSSTT,CNT.CNSCTR,CNT.CNSPSTCOD,ARPSHP.BNKRELREQFLG,




					CASE WHEN EXISTS (SELECT 1 FROM OPRSHPADLCNT ADLCNT
							    WHERE ADLCNT.CMPCOD = MST.CMPCOD



							    AND ADLCNT.DOCOWRIDR = MST.DOCOWRIDR
							    AND ADLCNT.MSTDOCNUM = MST.MSTDOCNUM


							    AND ADLCNT.DUPNUM
= MST.DUPNUM
							    AND ADLCNT.SEQNUM = MST.SEQNUM

AND ADLCNT.CNTTYP
= 'B' )


				    			    THEN 'Y' ELSE 'N' END BRKDTLAVL,



                      ASRMST.GNDTOTDSTCUR,ASRMST.CURCOD



				FROM OPRSHPMST
MST,OPRSHPMSTCNT CNT,OPRSEGSHP SEGSHP,OPRFLTSEG
FLTSEG,OPRARPIMPFLT IMPFLT,OPRARPSHP
ARPSHP,CSHQLTASRMST
ASRMST

				WHERE

					    MST.CMPCOD
= CNT.CMPCOD(+) AND
					    MST.DOCOWRIDR
= CNT.DOCOWRIDR(+)
AND
					    MST.MSTDOCNUM = CNT.MSTDOCNUM(+)
AND
					    MST.DUPNUM = CNT.DUPNUM(+)
AND

MST.SEQNUM = CNT.SEQNUM(+) AND


              				    MST.CMPCOD = ASRMST.CMPCOD(+)

AND
					    MST.DOCOWRIDR = ASRMST.DOCOWRIDR(+)
AND
					    MST.MSTDOCNUM = ASRMST.MSTDOCNUM(+) AND


					    MST.DUPNUM = ASRMST.DUPNUM(+)
AND
					    MST.SEQNUM = ASRMST.SEQNUM(+) AND

					    SEGSHP.CMPCOD=MST.CMPCOD(+)

AND

					    SEGSHP.DOCOWRIDR=MST.DOCOWRIDR(+) AND
					    SEGSHP.MSTDOCNUM=MST.MSTDOCNUM(+)
AND

SEGSHP.DUPNUM=MST.DUPNUM(+)
AND
					    SEGSHP.SEQNUM=MST.SEQNUM(+) AND

					    SEGSHP.FLTCARIDR=FLTSEG.FLTCARIDR(+)

AND

SEGSHP.FLTNUM=FLTSEG.FLTNUM(+) AND
					    SEGSHP.FLTSEQNUM=FLTSEG.FLTSEQNUM(+) AND


SEGSHP.SEGSERNUM=FLTSEG.SEGSERNUM(+)
AND
					    SEGSHP.CMPCOD=FLTSEG.CMPCOD(+) AND



					    SEGSHP.DOCOWRIDR = ARPSHP.DOCOWRIDR(+)
AND
					    SEGSHP.MSTDOCNUM = ARPSHP.MSTDOCNUM(+)
AND

					    SEGSHP.DUPNUM = ARPSHP.DUPNUM(+)
AND
					    SEGSHP.SEQNUM = ARPSHP.SEQNUM(+)
AND
					    SEGSHP.CMPCOD
= ARPSHP.CMPCOD(+) AND

              				    ARPSHP.ARPCOD(+)
= ? AND

					    FLTSEG.FLTCARIDR=IMPFLT.FLTCARIDR(+)
AND
					    FLTSEG.FLTNUM=IMPFLT.FLTNUM(+)

AND
					    FLTSEG.FLTSEQNUM=IMPFLT.FLTSEQNUM(+) AND

FLTSEG.CMPCOD=IMPFLT.CMPCOD(+) AND


FLTSEG.POU=IMPFLT.ARPCOD(+) AND

					    SEGSHP.FLTNUM=?
AND
					    SEGSHP.FLTSEQNUM =? AND


					    SEGSHP.FLTCARIDR =? AND
					    SEGSHP.CMPCOD=? AND


					    MST.MSTDOCNUM = ?
AND

					    MST.DOCOWRIDR = ? AND
					    MST.DUPNUM = ?
AND
					    MST.SEQNUM
= ? AND
					    MST.CMPCOD
= ? AND
              IMPFLT.ARPCOD(+) = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<!-- Added by A-5253 as part of ICRD-18843 End -->
	<QRY:Definition>
		<QRY:Id>320</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findmanifestshipmentsuldcombination" Type="NATIVE">
			<![CDATA[
			SELECT SHP.FLTCARIDR,
				   SHP.FLTNUM,
				   SHP.FLTSEQNUM,
				   SHP.ULDNUM,
				   SHP.MSTDOCNUM,



				   SHP.DOCOWRIDR,
				   SEG.POL POL,
				  SEG.POU POU,
				  SHP.FLTSEQNUM FLTSEQNUM,
				  SHP.SEQNUM


SEQNUM,
				  SHP.DUPNUM DUPNUM,
				  FLTLEG.STD FLTDAT,
                  FLT.FLTCARCOD FLTCARCOD



			 FROM  OPRSEGULDSHP SHP,
				   OPRFLTSEG SEG,
				   OPRARPEXPFLT FLT,
                   FLTOPRlEG

FLTLEG

			WHERE SEG.FLTNUM     = SHP.FLTNUM
			  AND SEG.FLTCARIDR    = SHP.FLTCARIDR
			  AND SEG.FLTSEQNUM

= SHP.FLTSEQNUM

			  AND SEG.SEGSERNUM    = SHP.SEGSERNUM
			  AND SEG.CMPCOD       = SHP.CMPCOD


AND SEG.FLTNUM  = FLT.FLTNUM

				AND SEG.FLTCARIDR = FLT.FLTCARIDR
				AND SEG.FLTSEQNUM = FLT.FLTSEQNUM


				AND SEG.CMPCOD    = FLT.CMPCOD

				AND FLT.FLTNUM    = FLTLEG.FLTNUM
				AND FLT.FLTCARIDR
= FLTLEG.FLTCARIDR

				AND FLT.FLTSEQNUM = FLTLEG.FLTSEQNUM

                AND
FLT.LEGSERNUM = FLTLEG.LEGSERNUM

				AND FLT.ARPCOD    = FLTLEG.LEGORG
				AND SHP.BDPPCS     >0


				AND SHP.SEQNUM     =1
				AND
SHP.ULDNUM       = ?
				AND SEG.POU        = ?
				AND SEG.POL        = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>315</QRY:Id>
		<QRY:Source Name="operaions.flthandling.cto.findexportflightprogress" Type="NATIVE">
			<![CDATA[
				 SELECT EXPFLT.CMPCOD,
  FLTMSTCARIDR,
  FLTMSTFLTNUM,
  FLTMSTFLTSEQNUM,
  FLTMSTFLTDAT,
  CARCOD,


  FLTLEGSERNUM,
  FLTLEGORG,
  FLTLEGDST,
  SEGORG,
  LEGSTD,
  LEGETD,
  LEGATD,
  FLTACRTYP,
  FLTOWN,


  FLTROU,
  FLTSTA,
  FINFLG ,
  BDPSTA,
  DEPTIM,
  LGTSTA,
  DEPTYPTIM,
  MFTPCS,
  BKGPCS,
  PLNPCS,

BDPPCS,

  OFLFLG,
  HNDOVRTIM,
  PRGMST.ACRGRP,
  PRGMST.MILSTN,
  PRGMST.MINTIM,
  PRGMST.MAXTIM,

PRGMST.PCTLWRRNG,

  PRGMST.PCTUPRRNG,
  PRGMST.TFCCLR,
  FLTTYP,
  ZONCOD,
  LODPLN.LSTUPDUSR LODPLNUSR,

DWSULDCNT,
  BDPULDCNT,

  SRVCSECNT,
  ACTFLTINF,
  BKGAWBCNT,
  BDPAWBCNT
FROM
  (SELECT CMPCOD,

FLTMSTCARIDR,
    FLTMSTFLTNUM,
    FLTMSTFLTSEQNUM,

    FLTMSTFLTDAT,
    CARCOD,
    FLTLEGSERNUM,

FLTLEGORG,
    FLTLEGDST,
    SEGORG,
    LEGSTD,

    LEGETD,
    LEGATD,
    FLTACRTYP,
    FLTOWN,

FLTROU,
    FLTSTA,
    FINFLG ,
	BDPSTA,
    DEPTIM,
    LGTSTA,

    DEPTYPTIM,
    SUM(NVL(MFTPCS,0))MFTPCS,

SUM(NVL(BKGPCS,0)) BKGPCS,
    SUM(NVL(PLNPCS,0))PLNPCS,

    SUM(NVL(BDPPCS,0)) BDPPCS,
    OFLFLG
,
    HNDOVRTIM,
          (SELECT COUNT(SEGULD.ULDNUM)
	  FROM OPRSEGULD SEGULD, OPRFLTSEG SEG

WHERE SEGULD.FLTNUM  = FLTMSTFLTNUM
	  AND SEGULD.FLTCARIDR = FLTMSTCARIDR
          AND SEGULD.FLTSEQNUM
= FLTMSTFLTSEQNUM
	  AND SEGULD.CMPCOD    = EXPFLTPRG.CMPCOD
	  AND SEG.CMPCOD = SEGULD.CMPCOD
	  AND
SEG.FLTCARIDR = SEGULD.FLTCARIDR
	  AND SEG.FLTNUM = SEGULD.FLTNUM
	  AND SEG.FLTSEQNUM = SEGULD.FLTSEQNUM

AND SEG.SEGSERNUM = SEGULD.SEGSERNUM
	  AND SEG.POL = FLTLEGORG
          AND SEGULD.ULDNUM   <> 'BULK'

) BDPULDCNT,
          (SELECT COUNT(DWS.ULDNUM)
          FROM
OPRSEGULD SEGULD,
            OPRDWSULD
DWS
          WHERE SEGULD.FLTNUM  = FLTMSTFLTNUM
          AND
SEGULD.FLTCARIDR = FLTMSTCARIDR

AND SEGULD.FLTSEQNUM = FLTMSTFLTSEQNUM
          AND SEGULD.CMPCOD
= EXPFLTPRG.CMPCOD
          AND
DWS.FLTNUM(+)    = FLTMSTFLTNUM
          AND DWS.FLTCARIDR(+) = FLTMSTCARIDR

          AND
DWS.FLTSEQNUM(+) = FLTMSTFLTSEQNUM
          AND DWS.LEGSERNUM(+) = FLTLEGSERNUM
          AND DWS.CMPCOD(+)

= EXPFLTPRG.CMPCOD
          AND DWS.ULDNUM(+)    = SEGULD.ULDNUM
          AND DWS.FLTCARIDR(+) = SEGULD.FLTCARIDR


          AND DWS.FLTNUM(+)    = SEGULD.FLTNUM
          AND DWS.FLTSEQNUM(+) = SEGULD.FLTSEQNUM

AND
DWS.CMPCOD(+)    = SEGULD.CMPCOD
          AND DWS.ARPCOD(+)    = FLTLEGORG
          AND SEGULD.ULDNUM

<> 'BULK'
          ) DWSULDCNT,
    FLTTYP,
          (SELECT COUNT(DISTINCT SRVCSE.MSTDOCNUM


            ||'-'
            || SRVCSE.DOCOWRIDR)
          FROM QMSSHPALRLOG ALRLOG,
            QMSSRVRCVCSE
SRVCSE

          WHERE SRVCSE.CMPCOD  = ALRLOG.CMPCOD
          AND SRVCSE.ALRSERNUM = ALRLOG.SERNUM

AND ALRLOG.FLTCARIDR
= FLTMSTCARIDR
          AND ALRLOG.FLTSEQNUM = FLTMSTFLTSEQNUM
          AND ALRLOG.FLTNUM
= FLTMSTFLTNUM

          AND ALRLOG.ARPCOD    = FLTLEGORG
          AND SRVCSE.CSETYP    ='S'

AND SRVCSE.SRVRCVSTA ='A'

          AND SRVCSE.OPRTYP    ='E'
          ) SRVCSECNT,
    ACTFLTINF,

COUNT(BKGMSTDOCNUM) BKGAWBCNT,
    SUBSTR(
ACTFLTINF,0,INSTR(ACTFLTINF,'~')-1) BDPAWBCNT,
RTRIM(XMLAGG(XMLELEMENT(A, BKGMSTSCC ||',')).EXTRACT('//text()'), ',') BKGMSTSCC,
RTRIM(XMLAGG(XMLELEMENT(A, BKGMSTPRD ||',')).EXTRACT('//text()'), ',') BKGMSTPRD
  FROM
    
    (SELECT DISTINCT FLTMST.CMPCOD,
      FLTMST.FLTCARIDR
FLTMSTCARIDR,
      FLTMST.FLTNUM FLTMSTFLTNUM,

FLTMST.FLTSEQNUM FLTMSTFLTSEQNUM,
      FLTMST.FLTDAT
FLTMSTFLTDAT,
      CASE
        WHEN ARLMST.APHCODUSE
= 2
        THEN ARLMST.TWOAPHCOD
        ELSE
ARLMST.THRAPHCOD
      END AS CARCOD,
      FLTLEG.LEGSERNUM
FLTLEGSERNUM,
      FLTLEG.LEGORG FLTLEGORG,

      FLTLEG.LEGDST FLTLEGDST,
      FLTSEG.SEGORG,

FLTLEG.STD LEGSTD,
      FLTLEG.ETD LEGETD,

      FLTLEG.ATD LEGATD,
      FLTLEG.ACRTYP FLTACRTYP,

FLTMST.FLTOWN,
      FLTMST.FLTROU,
      FLTMST.FLTSTA,

      EXPFLT.FINFLG ,
	  EXPFLT.BDPSTA
,
      NVL(NVL(FLTLEG.ATD, FLTLEG.ETD), FLTLEG.STD) DEPTIM,
      CASE
        WHEN TRNSHP.CMPCOD
IS
NOT NULL
        THEN
          (SELECT LGTSTA
          FROM SHRCONTIMMST CONTIM,
            FLTOPRLEG

TRNTIM
          WHERE CONTIM.CMPCOD  = TRNTIM.CMPCOD
          AND CONTIM.ARPCOD    = TRNTIM.LEGDST


          AND CONTIM.SCCCOD    =SHPMST.SCCCOD
          AND TRNTIM.CMPCOD    = TRNSEG.CMPCOD

AND TRNTIM.FLTCARIDR
= TRNSEG.FLTCARIDR
          AND TRNTIM.FLTNUM    = TRNSEG.FLTNUM
          AND
TRNTIM.FLTSEQNUM = TRNSEG.FLTSEQNUM

          AND TRNTIM.LEGDST    = TRNSEG.POU

AND ((FLTLEG.STD - TRNTIM.STA)*24*60) BETWEEN CONTIM.MINCONTIM
AND CONTIM.MAXCONTIM
          )

ELSE NULL
      END LGTSTA,
      (
      CASE
        WHEN
FLTLEG.ATD IS NOT NULL
        THEN 'A'

WHEN FLTLEG.ETD IS NOT NULL
        THEN 'E'

        ELSE 'S'
      END) DEPTYPTIM,
      BKGSEGSHP.MFTPCS,

BKGFLTDTL.NUMPCS BKGPCS,
      BKGSEGSHP.PLNPCS
PLNPCS,
      BKGSEGSHP.BDPPCS BDPPCS,
      CASE

WHEN 'OFL' =
          (SELECT TXNCOD

          FROM OPREXPFLTHIS EXPHIS
          WHERE EXPHIS.CMPCOD
= CMPCOD
          AND EXPHIS.ARPCOD    = FLTLEG.LEGORG

          AND EXPHIS.FLTCARIDR = FLTMST.FLTCARIDR

AND EXPHIS.FLTNUM    = FLTMST.FLTNUM
          AND
EXPHIS.FLTSEQNUM = FLTMST.FLTSEQNUM
          AND
EXPHIS.LEGSERNUM = FLTLEG.LEGSERNUM
          AND EXPHIS.TXNCOD
='OFL'
          )
        THEN 'Y'

ELSE 'N'
      END OFLFLG,
      (SELECT MAX(CTRSTN.HNDOVRTIM)
MAXHNDOVRTIM
      FROM FLTOPRCTRSTN
CTRSTN,
        SHRSTNOFFMST OFFMST
      WHERE CTRSTN.CMPCOD  =
FLTMST.CMPCOD
      AND CTRSTN.FLTCARIDR
= FLTMST.FLTCARIDR
      AND CTRSTN.FLTNUM    = FLTMST.FLTNUM

      AND CTRSTN.FLTSEQNUM = FLTMST.FLTSEQNUM

AND CTRSTN.CMPCOD    = OFFMST.CMPCOD
      AND CTRSTN.CTROFF
= OFFMST.OFFCOD
      AND CTRSTN.STNCOD
= OFFMST.STNCOD
      AND OFFMST.STNCOD    = ?
      AND OFFMST.ROLGRPCOD
= ?
      ) HNDOVRTIM,

FLTMST.FLTTYP,
      SHPMST.SCCCOD,
		(SELECT COUNT(NULLIF(BDPPCS,0))
        ||'~'
        ||COALESCE(SUM(BDPPCS),0)


        ||'~'
        ||COALESCE(SUM(MFTPCS),0)
		  ||'~'
		  ||COUNT(NULLIF(PLNPCS,0))
		  ||'~'

||COUNT(NULLIF(MFTPCS,0))
		FROM OPRSEGSHP SEGSHP,
		OPRFLTSEG SEG
      WHERE SEGSHP.CMPCOD  = FLTSEG.CMPCOD


      AND SEGSHP.FLTCARIDR = FLTSEG.FLTCARIDR
      AND SEGSHP.FLTNUM    = FLTSEG.FLTNUM
		AND SEGSHP.FLTSEQNUM
= FLTSEG.FLTSEQNUM
		AND SEG.CMPCOD       = SEGSHP.CMPCOD
		AND SEG.FLTCARIDR    = SEGSHP.FLTCARIDR

AND SEG.FLTNUM       = SEGSHP.FLTNUM
		AND SEG.FLTSEQNUM    = SEGSHP.FLTSEQNUM
		AND SEG.SEGSERNUM
= SEGSHP.SEGSERNUM
		AND SEG.POL          = FLTLEG.LEGORG
		AND SEG.SEGSERNUM = SEGSHP.SEGSERNUM
		)
ACTFLTINF,
		CASE
		WHEN COALESCE(BKGFLTDTL.FLTBKGSTA,'C') = 'C' THEN
		  BKGFLTDTL.MSTDOCNUM
		ELSE
		  NULL
		END BKGMSTDOCNUM,
		BKGMST.SCCCOD BKGMSTSCC,
        BKGMST.PRDNAM BKGMSTPRD
    FROM FLTOPRLEG FLTLEG,
      FLTOPRMST FLTMST,

FLTOPRSEG
FLTSEG,
      CAPBKGFLTDTL BKGFLTDTL,
      OPRARPEXPFLT EXPFLT,
      SHRARLMST ARLMST,

OPRFLTSEG
TRNSEG,
      OPRSEGSHP TRNSHP,
      OPRSHPMST SHPMST,
      CAPBKGMST BKGMST,
      OPRSEGSHP
BKGSEGSHP

    WHERE FLTLEG.CMPCOD      = FLTMST.CMPCOD
    AND FLTLEG.FLTCARIDR     = FLTMST.FLTCARIDR

AND FLTLEG.FLTNUM
= FLTMST.FLTNUM
    AND FLTLEG.FLTSEQNUM     = FLTMST.FLTSEQNUM
    AND FLTLEG.CMPCOD
= FLTSEG.CMPCOD(+)

    AND FLTLEG.FLTCARIDR     = FLTSEG.FLTCARIDR(+)
    AND FLTLEG.FLTNUM
= FLTSEG.FLTNUM(+)
    AND
FLTLEG.FLTSEQNUM     = FLTSEG.FLTSEQNUM(+)
    AND FLTLEG.LEGORG        =
FLTSEG.SEGORG(+)
    AND FLTSEG.CMPCOD
= BKGFLTDTL.CMPCOD(+)
    AND FLTSEG.FLTCARIDR     = BKGFLTDTL.FLTCARIDR(+)

AND FLTSEG.FLTNUM
= BKGFLTDTL.FLTNUM(+)
    AND FLTSEG.FLTSEQNUM     = BKGFLTDTL.FLTSEQNUM(+)

AND FLTSEG.SEGORG
= BKGFLTDTL.FLTORG(+)
    AND FLTSEG.SEGDST        = BKGFLTDTL.FLTDST(+)

AND EXPFLT.CMPCOD (+)
= FLTLEG.CMPCOD
    AND EXPFLT.FLTCARIDR (+) = FLTLEG.FLTCARIDR
    AND EXPFLT.FLTNUM(+)
= FLTLEG.FLTNUM

    AND EXPFLT.FLTSEQNUM(+)  = FLTLEG.FLTSEQNUM
    AND EXPFLT.ARPCOD(+)     = FLTLEG.LEGORG
	AND EXPFLT.LEGSERNUM(+)     = FLTLEG.LEGSERNUM
AND FLTLEG.CMPCOD
= ARLMST.CMPCOD
    AND FLTLEG.FLTCARIDR     = ARLMST.ARLIDR
    AND SHPMST.CMPCOD(+)
= BKGFLTDTL.CMPCOD

    AND SHPMST.DOCOWRIDR(+)  = BKGFLTDTL.DOCOWRIDR
    AND SHPMST.MSTDOCNUM(+)
= BKGFLTDTL.MSTDOCNUM

    AND SHPMST.DUPNUM(+)     = BKGFLTDTL.DUPNUM
    AND SHPMST.SEQNUM(+)
= BKGFLTDTL.SEQNUM
    AND BKGMST.CMPCOD(+)
= BKGFLTDTL.CMPCOD
    AND BKGMST.DOCOWRIDR(+)  = BKGFLTDTL.DOCOWRIDR

AND BKGMST.MSTDOCNUM(+)  =
BKGFLTDTL.MSTDOCNUM
    AND BKGMST.DUPNUM(+)     = BKGFLTDTL.DUPNUM
    AND
BKGMST.SEQNUM(+)     = BKGFLTDTL.SEQNUM

    AND BKGMST.UBRNUM(+)     = BKGFLTDTL.UBRNUM
    AND
BKGFLTDTL.CMPCOD     = BKGSEGSHP.CMPCOD(+)
    AND
BKGFLTDTL.FLTCARIDR  = BKGSEGSHP.FLTCARIDR(+)

AND BKGFLTDTL.FLTNUM     = BKGSEGSHP.FLTNUM(+)

    AND BKGFLTDTL.FLTSEQNUM  = BKGSEGSHP.FLTSEQNUM(+)

AND BKGFLTDTL.SEGSERNUM  = BKGSEGSHP.SEGSERNUM(+)

    AND BKGFLTDTL.DOCOWRIDR  = BKGSEGSHP.DOCOWRIDR(+)

AND BKGFLTDTL.MSTDOCNUM  = BKGSEGSHP.MSTDOCNUM(+)

    AND BKGFLTDTL.DUPNUM     = BKGSEGSHP.DUPNUM(+)

AND BKGFLTDTL.SEQNUM     = BKGSEGSHP.SEQNUM(+)

    AND BKGFLTDTL.CMPCOD     = TRNSHP.CMPCOD(+)

AND BKGFLTDTL.DOCOWRIDR  = TRNSHP.DOCOWRIDR(+)
    AND
BKGFLTDTL.MSTDOCNUM  = TRNSHP.MSTDOCNUM(+)

AND BKGFLTDTL.DUPNUM     = TRNSHP.DUPNUM(+)
    AND BKGFLTDTL.SEQNUM
= TRNSHP.SEQNUM(+)
    AND
(BKGFLTDTL.FLTCARIDR
      ||BKGFLTDTL.FLTNUM
      ||BKGFLTDTL.FLTSEQNUM)
<> (TRNSHP.FLTCARIDR(+)

||TRNSHP.FLTNUM(+)
      ||TRNSHP.FLTSEQNUM(+))
    AND TRNSHP.CMPCOD                 = TRNSEG.CMPCOD(+)

AND TRNSHP.FLTCARIDR
= TRNSEG.FLTCARIDR(+)
    AND TRNSHP.FLTNUM                 = TRNSEG.FLTNUM(+)

AND TRNSHP.FLTSEQNUM
= TRNSEG.FLTSEQNUM(+)
    AND TRNSHP.SEGSERNUM              = TRNSEG.SEGSERNUM(+)

AND TRNSEG.POU(+)
= ?
    AND FLTLEG.LEGORG                 = ?
    AND FLTLEG.CMPCOD
= ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>316</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findpendingshipmentforexportflightprogress" Type="NATIVE">
			<![CDATA[
		SELECT SHPMST.CMPCOD,
  SHPMST.SHPPFX BKGPFX,
  SHPMST.MSTDOCNUM BKGAWB ,
  SHPMST.DOCOWRIDR BKGOWRIDR,



  SHPMST.SEQNUM BKGSEQNUM,
  SHPMST.DUPNUM BKGDUPNUM,
  NVL(SEGSHP.MFTPCS,0)MFTPCS,
  NVL(BKGFLT.NUMPCS,0)


BKGPCS,
  NVL(SEGSHP.PLNPCS,0)PLNPCS,
  NVL(SEGSHP.BDPPCS,0) BDPPCS,
  NVL(SEGSHP.OFLPCS,0) OFLPCS,



  SEGULD.ULDNUM BKGULDNUM,
  (
  CASE
    WHEN DWSULD.ULDNUM IS NOT NULL
    THEN 'Y'
    ELSE 'N'


  END)DWSFLG
FROM
CAPBKGFLTDTL BKGFLT
INNER JOIN OPRSHPMST SHPMST
ON BKGFLT.CMPCOD     = SHPMST.CMPCOD
AND

BKGFLT.DOCOWRIDR
= SHPMST.DOCOWRIDR
AND BKGFLT.MSTDOCNUM = SHPMST.MSTDOCNUM
AND BKGFLT.SEQNUM    =
SHPMST.SEQNUM
AND
BKGFLT.DUPNUM
= SHPMST.DUPNUM
LEFT OUTER JOIN OPRFLTSEG FLTSEG
ON BKGFLT.FLTCARIDR
= FLTSEG.FLTCARIDR
AND
BKGFLT.FLTNUM
= FLTSEG.FLTNUM
AND BKGFLT.FLTSEQNUM = FLTSEG.FLTSEQNUM
AND
BKGFLT.CMPCOD    = FLTSEG.CMPCOD
AND
BKGFLT.FLTORG
= FLTSEG.POL
 LEFT OUTER JOIN OPRSEGSHP SEGSHP

 ON BKGFLT.FLTCARIDR  = SEGSHP.FLTCARIDR

 AND
BKGFLT.FLTNUM    = SEGSHP.FLTNUM
 AND BKGFLT.FLTSEQNUM
= SEGSHP.FLTSEQNUM
 AND BKGFLT.CMPCOD
= SEGSHP.CMPCOD

AND BKGFLT.DOCOWRIDR = SEGSHP.DOCOWRIDR

AND BKGFLT.MSTDOCNUM = SEGSHP.MSTDOCNUM
 AND
BKGFLT.SEQNUM
= SEGSHP.SEQNUM
 AND BKGFLT.DUPNUM
= SEGSHP.DUPNUM
 AND BKGFLT.SEGSERNUM = SEGSHP.SEGSERNUM


LEFT OUTER JOIN OPRSEGULDSHP SEGULDSHP
ON
SEGSHP.FLTCARIDR  = SEGULDSHP.FLTCARIDR
AND SEGSHP.FLTNUM

= SEGULDSHP.FLTNUM
AND SEGSHP.FLTSEQNUM
= SEGULDSHP.FLTSEQNUM
AND SEGSHP.CMPCOD    = SEGULDSHP.CMPCOD
AND

SEGSHP.DOCOWRIDR = SEGULDSHP.DOCOWRIDR
AND
SEGSHP.MSTDOCNUM = SEGULDSHP.MSTDOCNUM
AND SEGSHP.SEQNUM

= SEGULDSHP.SEQNUM
AND SEGSHP.DUPNUM
= SEGULDSHP.DUPNUM
AND SEGSHP.SEGSERNUM = SEGULDSHP.SEGSERNUM
LEFT

OUTER JOIN OPRSEGULD SEGULD
ON SEGULDSHP.FLTCARIDR
= SEGULD.FLTCARIDR
AND SEGULDSHP.FLTNUM    = SEGULD.FLTNUM
AND

SEGULDSHP.FLTSEQNUM = SEGULD.FLTSEQNUM
AND
SEGULDSHP.CMPCOD    = SEGULD.CMPCOD
AND SEGULDSHP.SEGSERNUM

= SEGULD.SEGSERNUM
AND SEGULDSHP.ULDNUM
= SEGULD.ULDNUM
AND SEGULD.ULDNUM   <>'BULK'
LEFT OUTER JOIN

OPRDWSULD DWSULD
ON SEGULD.CMPCOD
= DWSULD.CMPCOD
AND SEGULD.FLTCARIDR = DWSULD.FLTCARIDR
AND SEGULD.FLTNUM

= DWSULD.FLTNUM
AND SEGULD.FLTSEQNUM
= DWSULD.FLTSEQNUM
AND SEGULD.ULDNUM    = DWSULD.ULDNUM
WHERE BKGFLT.CMPCOD

= ?
AND BKGFLT.FLTNUM
= ?
AND BKGFLT.FLTCARIDR = ?
AND BKGFLT.FLTSEQNUM = ?
AND BKGFLT.FLTORG = ?
AND

BKGFLT.FLTBKGSTA <> 'X'

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>317</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findExportConnectionFlight" Type="NATIVE">
			<![CDATA[
	SELECT BKGFLTDTL.FLTCARCOD , BKGFLTDTL.FLTDAT, TRNLEG.FLTNUM, TRNLEG.LEGDST, TRNLEG.FLTSEQNUM, TRNLEG.FLTCARIDR,

TRNLEG.LEGSERNUM,
	SHPMST.SCCCOD, SHPMST.SHPPFX, SHPMST.MSTDOCNUM, IMPFLT.FLTOPRSTA, CONTIM.LGTSTA,

NVL(NVL(TRNLEG.ATA,   TRNLEG.ETA),   TRNLEG.STA) ARRTIM,
	NVL(NVL(FLTLEG.ATD,   FLTLEG.ETD),   FLTLEG.STD)

DEPTIM, TRNLEG.STA,
	(CASE
		WHEN TRNLEG.ATA IS NOT NULL THEN 'A'
		WHEN TRNLEG.ETA IS NOT NULL THEN

'E'
		ELSE 'S'
		END) ARRTYPTIM
	FROM
	FLTOPRLEG FLTLEG,
	FLTOPRLEG TRNLEG,
	CAPBKGFLTDTL BKGFLTDTL,



	OPRSEGSHP SEGSHP,
	OPRSEGSHP TRNSHP,
	OPRFLTSEG TRNSEG,
	OPRARPIMPFLT IMPFLT,
	SHRCONTIMMST CONTIM,



	OPRSHPMST SHPMST
	WHERE BKGFLTDTL.CMPCOD     = SHPMST.CMPCOD
	AND BKGFLTDTL.DOCOWRIDR = SHPMST.DOCOWRIDR



	AND BKGFLTDTL.MSTDOCNUM = SHPMST.MSTDOCNUM
	AND BKGFLTDTL.SEQNUM    = SHPMST.SEQNUM
	AND BKGFLTDTL.DUPNUM


= SHPMST.DUPNUM
	AND BKGFLTDTL.FLTCARIDR  = SEGSHP.FLTCARIDR(+)
	AND BKGFLTDTL.FLTNUM    = SEGSHP.FLTNUM(+)



	AND BKGFLTDTL.FLTSEQNUM = SEGSHP.FLTSEQNUM(+)
	AND BKGFLTDTL.CMPCOD    = SEGSHP.CMPCOD(+)
	AND BKGFLTDTL.DOCOWRIDR


= SEGSHP.DOCOWRIDR(+)
	AND BKGFLTDTL.MSTDOCNUM = SEGSHP.MSTDOCNUM(+)
	AND BKGFLTDTL.SEQNUM    = SEGSHP.SEQNUM(+)



	AND BKGFLTDTL.DUPNUM    = SEGSHP.DUPNUM(+)
	AND BKGFLTDTL.SEGSERNUM = SEGSHP.SEGSERNUM(+)
	AND BKGFLTDTL.CMPCOD


= TRNSHP.CMPCOD
	AND BKGFLTDTL.DOCOWRIDR     = TRNSHP.DOCOWRIDR
	AND BKGFLTDTL.MSTDOCNUM     = TRNSHP.MSTDOCNUM



	AND BKGFLTDTL.DUPNUM        = TRNSHP.DUPNUM
	AND BKGFLTDTL.SEQNUM        = TRNSHP.SEQNUM
	AND (BKGFLTDTL.FLTCARIDR||BKGFLTDTL.FLTNUM||BKGFLTDTL.FLTSEQNUM)


<> (TRNSHP.FLTCARIDR||TRNSHP.FLTNUM||TRNSHP.FLTSEQNUM)
	AND TRNSHP.CMPCOD        = TRNSEG.CMPCOD(+)



AND TRNSHP.FLTCARIDR     = TRNSEG.FLTCARIDR(+)
	AND TRNSHP.FLTNUM        = TRNSEG.FLTNUM(+)
	AND TRNSHP.FLTSEQNUM


= TRNSEG.FLTSEQNUM(+)
	AND TRNSHP.SEGSERNUM     = TRNSEG.SEGSERNUM(+)
	AND TRNLEG.CMPCOD        = TRNSEG.CMPCOD


	AND TRNLEG.FLTCARIDR     = TRNSEG.FLTCARIDR
	AND TRNLEG.FLTNUM        = TRNSEG.FLTNUM
	AND TRNLEG.FLTSEQNUM

= TRNSEG.FLTSEQNUM
	AND TRNLEG.LEGORG        = TRNSEG.POL

	AND IMPFLT.FLTCARIDR(+) = TRNSEG.FLTCARIDR



	AND IMPFLT.FLTNUM(+) = TRNSEG.FLTNUM
	AND IMPFLT.FLTSEQNUM(+) = TRNSEG.FLTSEQNUM
	AND IMPFLT.CMPCOD(+)


= TRNSEG.CMPCOD
	AND IMPFLT.ARPCOD(+) = TRNSEG.POU
	AND CONTIM.CMPCOD(+) = SHPMST.CMPCOD
	AND SHPMST.SCCCOD


like '%'|| CONTIM.SCCCOD(+)||'%'
AND ((CONTIM.MINCONTIM IS NULL and CONTIM.MAXCONTIM IS NULL) OR (((FLTLEG.STD - TRNLEG.STA)*24*60) BETWEEN CONTIM.MINCONTIM AND CONTIM.MAXCONTIM))


	AND CONTIM.ARPCOD(+)
= ?
	AND TRNSEG.POU(+)        =	 ?
	AND FLTLEG.CMPCOD        = BKGFLTDTL.CMPCOD


	AND FLTLEG.FLTCARIDR     = BKGFLTDTL.FLTCARIDR
	AND FLTLEG.FLTNUM        = BKGFLTDTL.FLTNUM
	AND FLTLEG.FLTSEQNUM

= BKGFLTDTL.FLTSEQNUM
	AND FLTLEG.LEGORG        = BKGFLTDTL.FLTORG
	AND BKGFLTDTL.CMPCOD  = ?
	AND BKGFLTDTL.FLTNUM

= ?

	AND BKGFLTDTL.FLTCARIDR = ?
	AND BKGFLTDTL.FLTSEQNUM = ?
	AND BKGFLTDTL.FLTORG = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>320</QRY:Id>
		<QRY:Source Name="operations.flthandling.interline.retrieveCTMOnwardShipments" Type="NATIVE">
			<![CDATA[
								SELECT MST.STDWGTCOD STDWGTCOD,
								  IMPFLT.FLTDAT,
								  MST.STDWGT STDWGT,
								  MST.GRSVOLUNT
STDVOLUNT,
								  MST.GRSVOL
STDVOL,
								  MST.STDPCS STDPCS,
								  MST.SHPPFX,

MST.SHPDES SHPDCL,
								  MST.SCCCOD
SCCCOD,
								  MST.ORGCOD ORGCOD,
								  MST.DOCNUM,

MST.MSTDOCNUM,
								  MST.DSTCOD
DSTCOD,
								  MST.PLTFLG,
								  MST.STDDISWGT DISSTDWGT,

MST.GRSDISVOL DISSTDVOL,

MST.CONFLG,
								  MST.EXEFLG,
								  MST.EFTAWBFLG,

MST.DUPNUM,
								  MST.DOCOWRIDR,

MST.CMPCOD,
								  MST.SEQNUM,
								  ARPSHP.AVLPCS,

ARPSHP.AVLWGT,
								  ARPSHP.AVLVOL,

								  MST.AGTCOD,
								  RTG.FLTCARCOD,ARPSHP.PLTUSEFLG

FROM
OPRARPIMPFLT IMPFLT
								INNER JOIN OPRFLTSEG FLTSEG
								ON FLTSEG.CMPCOD     = IMPFLT.CMPCOD


AND FLTSEG.FLTNUM    = IMPFLT.FLTNUM
								AND FLTSEG.FLTSEQNUM = IMPFLT.FLTSEQNUM
								AND FLTSEG.FLTCARIDR

= IMPFLT.FLTCARIDR
								AND FLTSEG.POU       = IMPFLT.ARPCOD
								AND IMPFLT.FLTDAT>= ?
								AND IMPFLT.FLTDAT<= ?
								INNER JOIN OPRSEGSHP SEGSHP


ON FLTSEG.CMPCOD     = SEGSHP.CMPCOD
								AND FLTSEG.FLTNUM    = SEGSHP.FLTNUM
								AND FLTSEG.FLTSEQNUM

= SEGSHP.FLTSEQNUM
								AND FLTSEG.FLTCARIDR = SEGSHP.FLTCARIDR
								AND FLTSEG.SEGSERNUM = SEGSHP.SEGSERNUM



INNER JOIN OPRSHPMST MST
								ON MST.CMPCOD     = SEGSHP.CMPCOD
								AND MST.MSTDOCNUM = SEGSHP.MSTDOCNUM


AND MST.DOCOWRIDR = SEGSHP.DOCOWRIDR
								AND MST.SEQNUM    = SEGSHP.SEQNUM
								AND MST.DUPNUM

= SEGSHP.DUPNUM
								AND MST.DSTCOD   != IMPFLT.ARPCOD
								INNER JOIN OPRARPSHP ARPSHP


ON MST.CMPCOD     = ARPSHP.CMPCOD
								AND MST.MSTDOCNUM = ARPSHP.MSTDOCNUM
								AND MST.DOCOWRIDR

= ARPSHP.DOCOWRIDR
								AND MST.SEQNUM    = ARPSHP.SEQNUM
								AND MST.DUPNUM    = ARPSHP.DUPNUM


								AND ARPSHP.SEQNUM = 1
								AND FLTSEG.POU    = ARPSHP.ARPCOD
								LEFT OUTER JOIN OPRSHPRTG
RTG

								ON MST.CMPCOD     = RTG.CMPCOD
								AND MST.MSTDOCNUM = RTG.MSTDOCNUM

AND MST.DOCOWRIDR =
RTG.DOCOWRIDR
								AND MST.SEQNUM    = RTG.SEQNUM
								AND MST.DUPNUM    =
RTG.DUPNUM







								WHERE ARPSHP.AVLPCS
>
0
								AND IMPFLT.CMPCOD                                                                   = ?



								AND
IMPFLT.ARPCOD
= ?
								AND ((MST.CMPCOD,MST.DOCOWRIDR,MST.MSTDOCNUM,MST.DUPNUM,MST.SEQNUM,MST.DSTCOD)
NOT IN

								  (SELECT RTG2.CMPCOD,
									RTG2.DOCOWRIDR,
									RTG2.MSTDOCNUM,

RTG2.DUPNUM,

									RTG2.SEQNUM,
									RTG2.DSTCOD
								  FROM OPRSHPRTG RTG2

WHERE RTG2.CMPCOD  = MST.CMPCOD

								  AND RTG2.MSTDOCNUM = MST.MSTDOCNUM
								  AND
RTG2.DOCOWRIDR = MST.DOCOWRIDR
								  AND RTG2.SEQNUM
= MST.SEQNUM
								  AND RTG2.DUPNUM
= MST.DUPNUM
								  )
								OR ( RTG.RTGSERNUM =

								  (SELECT MAX (RTGSERNUM) +
1
								  FROM OPRSHPRTG RTG1
								  WHERE RTG1.CMPCOD  = MST.CMPCOD

								  AND RTG1.MSTDOCNUM
= MST.MSTDOCNUM
								  AND RTG1.DOCOWRIDR = MST.DOCOWRIDR
								  AND RTG1.SEQNUM
= MST.SEQNUM

AND RTG1.DUPNUM    = MST.DUPNUM
								  AND RTG1.DSTCOD    = IMPFLT.ARPCOD

								  AND
RTG1.FLTCARCOD = IMPFLT.FLTCARCOD
								  )
								AND NOT EXISTS
								  (SELECT 1


FROM SHRARLARPPAR
								  WHERE ARPCOD = ?
								  AND PARCOD   = ?
								  AND PARVAL   = ?


								  AND CMPCOD   = IMPFLT.CMPCOD
								  AND ARLIDR   =
									(SELECT ARLIDR
									FROM
SHRARLMST

									WHERE ( TWOAPHCOD = RTG.FLTCARCOD
									OR THRAPHCOD      = RTG.FLTCARCOD
)
									AND CMPCOD
= IMPFLT.CMPCOD
									)
								  AND NVL (
									(SELECT PARVAL
FROM SHRSYSPAR WHERE PARCOD =
? AND CMPCOD = IMPFLT.CMPCOD
									), 'N' ) = 'Y'
								  )

AND NOT EXISTS
								  (SELECT
1
								  FROM SHRARLACTMST
								  WHERE TWOAPHCOD = RTG.FLTCARCOD

AND (ISSPRTARL  = 'Y'

								  OR OWNARLIND    = 'Y')
								  AND CMPCOD      = IMPFLT.CMPCOD

)



			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>367</QRY:Id>
		<QRY:Source Name="operations.flthandling.interline.retrieveCTMOnwardShipmentswithFlight" Type="NATIVE">
			<![CDATA[
							SELECT MST.STDWGTCOD STDWGTCOD,MST.STDWGT STDWGT,MST.GRSVOLUNT STDVOLUNT,MST.GRSVOL STDVOL,



				MST.STDPCS STDPCS,MST.SHPPFX,MST.SHPDES SHPDCL,MST.SCCCOD SCCCOD,MST.ORGCOD ORGCOD,MST.DOCNUM,MST.MSTDOCNUM,



				MST.DSTCOD DSTCOD,MST.PLTFLG,MST.STDDISWGT DISSTDWGT,MST.GRSDISVOL DISSTDVOL,MST.CONFLG,MST.EXEFLG,MST.DUPNUM,



				MST.DOCOWRIDR,MST.CMPCOD,MST.SEQNUM,ARPSHP.AVLPCS,ARPSHP.AVLWGT,ARPSHP.AVLVOL,AGTGRP.GRPNAM AGTGRP,



				TXN.TXNCOD,MST.AGTCOD,CST.CSTSTA
      FROM OPRARPIMPFLT IMPFLT
      INNER JOIN OPRFLTSEG FLTSEG



      ON FLTSEG.CMPCOD     = IMPFLT.CMPCOD
      AND FLTSEG.FLTNUM    = IMPFLT.FLTNUM
      AND FLTSEG.FLTSEQNUM


= IMPFLT.FLTSEQNUM
      AND FLTSEG.FLTCARIDR = IMPFLT.FLTCARIDR
      AND FLTSEG.POU       = IMPFLT.ARPCOD



INNER JOIN OPRSEGULDSHP ULDSHP
      ON FLTSEG.CMPCOD     = ULDSHP.CMPCOD
      AND FLTSEG.FLTNUM


= ULDSHP.FLTNUM
      AND FLTSEG.FLTSEQNUM = ULDSHP.FLTSEQNUM
      AND FLTSEG.FLTCARIDR = ULDSHP.FLTCARIDR



AND FLTSEG.SEGSERNUM = ULDSHP.SEGSERNUM
      INNER JOIN OPRSHPMST MST
      ON MST.CMPCOD     = ULDSHP.CMPCOD



AND MST.MSTDOCNUM = ULDSHP.MSTDOCNUM
      AND MST.DOCOWRIDR = ULDSHP.DOCOWRIDR
      AND MST.SEQNUM


= ULDSHP.SEQNUM
      AND MST.DUPNUM    = ULDSHP.DUPNUM
      AND MST.DSTCOD   != IMPFLT.ARPCOD



INNER JOIN OPRARPSHP ARPSHP
      ON MST.CMPCOD     = ARPSHP.CMPCOD
      AND MST.MSTDOCNUM = ARPSHP.MSTDOCNUM



AND MST.DOCOWRIDR = ARPSHP.DOCOWRIDR
      AND MST.SEQNUM    = ARPSHP.SEQNUM
      AND MST.DUPNUM


= ARPSHP.DUPNUM
      AND ARPSHP.SEQNUM = 1
      AND FLTSEG.POU    = ARPSHP.ARPCOD
      LEFT OUTER


JOIN OPRTXNHSE TXN
      ON MST.CMPCOD     = TXN.CMPCOD
      AND MST.MSTDOCNUM = TXN.MSTDOCNUM



AND MST.DOCOWRIDR = TXN.DOCOWRIDR
      AND MST.SEQNUM    = TXN.SEQNUM
      AND MST.DUPNUM    = TXN.DUPNUM



LEFT OUTER JOIN WHSOPRSHPLOC SHPLOC
      ON MST.CMPCOD     = SHPLOC.CMPCOD
      AND MST.MSTDOCNUM

=
SHPLOC.MSTDOCNUM
      AND MST.DOCOWRIDR = SHPLOC.DOCOWRIDR
      AND MST.SEQNUM    = SHPLOC.SEQNUM



AND MST.DUPNUM    = SHPLOC.DUPNUM
      AND FLTSEG.POU    = SHPLOC.ARPCOD
      LEFT OUTER JOIN CSTARPSHP


CST
      ON MST.CMPCOD     = CST.CMPCOD
      AND MST.MSTDOCNUM = CST.MSTDOCNUM
      AND MST.DOCOWRIDR


= CST.DOCOWRIDR
      AND MST.SEQNUM    = CST.SEQNUM
      AND MST.DUPNUM    = CST.DUPNUM
      AND

IMPFLT.ARPCOD
= CST.ARPCOD
      LEFT OUTER JOIN SHRGENMSTGRPDTL AGTGRP
       ON MST.CMPCOD = AGTGRP.CMPCOD

AND MST.AGTCOD
= AGTGRP.GRPENT AND AGTGRP.GRPCATCOD = 'GEN'
WHERE ARPSHP.TFROUTPCS = 0


   AND ARPSHP.AVLPCS
> 0
         AND IMPFLT.CMPCOD = ?
		 AND IMPFLT.FLTCARCOD = ?
   AND IMPFLT.ARPCOD

= ?
      AND IMPFLT.FLTNUM
= ?
      AND IMPFLT.FLTSEQNUM   = ?
      AND IMPFLT.LEGSERNUM   = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>319</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findImportConnectionFlight" Type="NATIVE">
			<![CDATA[
	Select  FLTCARCOD,
FLTDAT,
FLTNUM,
LEGDST,
FLTSEQNUM,
FLTCARIDR,
LEGSERNUM,
SCCCOD,
SHPPFX,
MSTDOCNUM,
CASE WHEN max(pry)=1 THEN 'G'
  WHEN max(pry)=2 THEN 'A'
  WHEN max(pry)=3 THEN 'R'
END LGTSTA, 
ARRTIM,
DEPTIM,
STA,
ARRTYPTIM,
ULDNUM,
THRUNT from
	 (SELECT distinct Bkgflt.FLTCARCOD , Bkgflt.FLTDAT, Trnleg.FLTNUM, Trnleg.LEGDST, Trnleg.FLTSEQNUM, Trnleg.FLTCARIDR, 


Trnleg.LEGSERNUM,
	SHPMST.SCCCOD, SHPMST.SHPPFX, SHPMST.MSTDOCNUM, CONTIM.LGTSTA,
  CASE WHEN CONTIM.LGTSTA='G' THEN 1
  WHEN CONTIM.LGTSTA='A' THEN 2
  WHEN CONTIM.LGTSTA='R' THEN 3
  END PRY,
  NVL(NVL(Trnleg.ATA,   


Trnleg.ETA),   Trnleg.STA) ARRTIM,
	NVL(NVL(Trnleg.ATD,   Trnleg.ETD),   Trnleg.STD) DEPTIM, Trnleg.STA,



	(CASE
		WHEN Trnleg.ATA IS NOT NULL THEN 'A'
		WHEN Trnleg.ETA IS NOT NULL THEN 'E'
		ELSE 'S'
		END)


ARRTYPTIM,
SEGULD.ULDNUM, 
SEGULD.THRUNT
FROM  OPRSEGULD SEGULD,
OPRSEGULDSHP SEGULDSHP,
  Capbkgfltdtl Bkgflt,
  Oprshpmst Shpmst,
  Fltoprleg Trnleg,

SHRCONTIMMST

CONTIM,
    Fltoprleg oprleg
WHERE SEGULD.cmpcod=SEGULDSHP.cmpcod 
and SEGULD.fltcaridr=SEGULDSHP.fltcaridr 
and SEGULD.fltnum=SEGULDSHP.fltnum 
and SEGULD.fltseqnum=SEGULDSHP.fltseqnum 
and SEGULD.segsernum=SEGULDSHP.segsernum 
and SEGULD.uldnum=SEGULDSHP.uldnum 

and SEGULDSHP.CMPCOD = shpmst.CMPCOD 
AND SEGULDSHP.DOCOWRIDR = shpmst.DOCOWRIDR 
AND SEGULDSHP.MSTDOCNUM = shpmst.MSTDOCNUM 
AND SEGULDSHP.DUPNUM = shpmst.DUPNUM 
AND SEGULDSHP.SEQNUM = shpmst.SEQNUM 
AND shpmst.Cmpcod = Bkgflt.Cmpcod 
AND shpmst.MSTDOCNUM = Bkgflt.MSTDOCNUM
And
shpmst.Seqnum = Bkgflt.Seqnum
And

shpmst.Dupnum = Bkgflt.Dupnum
And shpmst.Docowridr = Bkgflt.Docowridr
And
Bkgflt.Cmpcod = TRNLEG.Cmpcod
AND

Bkgflt.FLTCARIDR = TRNLEG.FLTCARIDR
And Bkgflt.FLTNUM = TRNLEG.FLTNUM
And
Bkgflt.Fltseqnum = Trnleg.Fltseqnum
And

Bkgflt.Fltorg = Trnleg.Legorg
and oprleg.cmpcod=SEGULD.cmpcod
and oprleg.fltnum=SEGULD.fltnum
and oprleg.fltcaridr=SEGULD.fltcaridr
and

oprleg.fltseqnum=SEGULD.fltseqnum
AND CONTIM.CMPCOD = SHPMST.CMPCOD
and INSTR(SHPMST.SCCCOD,CONTIM.SCCCOD) > 0


AND CONTIM.ARPCOD = Trnleg.Legorg
AND CONTIM.ARPCOD = oprleg.legdst
 AND   (Trnleg.Std - oprleg.Sta )*24*60 BETWEEN Contim.Mincontim

AND Contim.Maxcontim
AND seguldshp.mftpcs>0
And SEGULD.Fltnum =?
And SEGULD.Fltseqnum = ?
And SEGULD.Fltcaridr = ?
And SEGULD.Cmpcod = ?
and CONTIM.arpcod = ?)
group by FLTCARCOD, FLTDAT, FLTNUM, LEGDST, FLTSEQNUM, 
FLTCARIDR, LEGSERNUM, SHPPFX, SCCCOD, MSTDOCNUM, 
 ARRTIM, DEPTIM, STA, ARRTYPTIM, 
ULDNUM, THRUNT


			]]>
		</QRY:Source>
	</QRY:Definition>
	<!-- added by a-5133 as part of CR ICRD-14468 starts -->
	<QRY:Definition>
		<QRY:Id>321</QRY:Id>
		<QRY:Source Name="operations.flthandling.fetchFlightDetailsForCRA" Type="NATIVE">
			<![CDATA[
			SELECT ARLMST.TWOAPHCOD FROM OPRSEGSHP SHP, FLTOPRSEG FLT, SHRARLMST ARLMST
			WHERE FLT.CMPCOD = SHP.CMPCOD
			AND FLT.FLTNUM = SHP.FLTNUM
			AND FLT.FLTSEQNUM = SHP.FLTSEQNUM
			AND FLT.FLTCARIDR = SHP.FLTCARIDR
			AND FLT.SEGSERNUM = SHP.SEGSERNUM
			AND SHP.CMPCOD = ARLMST.CMPCOD
			AND SHP.FLTCARIDR = ARLMST.ARLIDR
			]]>
		</QRY:Source>
	</QRY:Definition>
	<!-- added by a-5133 as part of CR ICRD-14468 ends -->
	<QRY:Definition>
		<QRY:Id>324</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.finddeconsolidationdetails" Type="NATIVE">
			<![CDATA[
			SELECT SHPMST.CMPCOD,
  SHPMST.DOCOWRIDR,
  SHPMST.MSTDOCNUM,
  SHPMST.DUPNUM,
  SHPMST.DOCNUM,



  SHPMST.SEQNUM,
  SHPMST.SHPPFX,
  SHPMST.ORGCOD,
  SHPMST.DSTCOD,
  SHPMST.STDPCS,
  SHPMST.GRSVOL,



  SHPMST.STDWGT,
  SHPMST.SCCCOD,
  SHPLOC.WHSCOD,
  SHPLOC.STUCOD,
  SHPLOC.LOCCOD,
  ARPSHP.ARPCOD,



  ARPSHP.DCSFLG,
  ARPSHP.DCSREQFLG,
  ARPSHP.AVLPCS,
  ARPSHP.AVLWGT,
  ARPSHP.RCVPCS,
  ARPSHP.RCVWGT,



  ARPSHP.DCSPCS,
  ARPSHP.DCSWGT,
  ARPSHP.TOTDLVPCS,
  ARPSHP.TOTDLVWGT,
  ARPSHP.TOTDLVNOTPCS,

ARPSHP.LSTUPDTIM,
  ARPSHP.DCSTIM,
  ARPSHP.DCSCPLFLG,

  SHPLOC.LOCPCS,
  SHPLOC.LOCWGT,
  (SELECT DCSPCS

FROM OPRARPSHP SHP
  WHERE SHP.ARPCOD =ARPSHP.ARPCOD
  AND SHP.CMPCOD=SHPMST.CMPCOD
  AND SHP.SEQNUM=SHPMST.PARSEQNUM

AND SHP.MSTDOCNUM=SHPMST.MSTDOCNUM
  AND SHP.DOCOWRIDR=SHPMST.DOCOWRIDR
  AND SHP.DUPNUM = SHPMST.DUPNUM
  ) AS MSTDCSPCS,
  (SELECT RTRIM(XMLAGG(XMLELEMENT(A,
HSE.DOCNUM
    ||',')).EXTRACT('//text()'), ',') HSEPATH
  FROM OPRSHPHSE HSE
  WHERE HSE.CMPCOD  = SHPMST.CMPCOD

AND HSE.DOCOWRIDR = SHPMST.DOCOWRIDR
  AND HSE.MSTDOCNUM = SHPMST.MSTDOCNUM
  AND HSE.DUPNUM    = SHPMST.DUPNUM

  ) AS HSEPATH,
ARPSHP.PLTUSEFLG ARPPLTUSEFLG,
SHPDTL.PLTUSEFLG DTLPLTUSEFLG
FROM OPRSHPMST SHPMST
LEFT OUTER JOIN OPRSHPDTL SHPDTL
ON SHPMST.CMPCOD     = SHPDTL.CMPCOD
AND SHPMST.DOCOWRIDR = SHPDTL.DOCOWRIDR
AND SHPMST.MSTDOCNUM = SHPDTL.MSTDOCNUM
AND SHPMST.SEQNUM    = SHPDTL.SEQNUM
AND SHPMST.DUPNUM    = SHPDTL.DUPNUM
LEFT OUTER JOIN OPRARPSHP ARPSHP
ON SHPMST.CMPCOD

= ARPSHP.CMPCOD
AND
SHPMST.DOCOWRIDR = ARPSHP.DOCOWRIDR
AND SHPMST.MSTDOCNUM = ARPSHP.MSTDOCNUM
AND
SHPMST.SEQNUM
= ARPSHP.SEQNUM
AND
SHPMST.DUPNUM = ARPSHP.DUPNUM
AND ARPSHP.ARPCOD = ?
LEFT OUTER JOIN
WHSOPRSHPLOC
SHPLOC
ON SHPMST.CMPCOD
= SHPLOC.CMPCOD
AND SHPMST.DOCOWRIDR = SHPLOC.DOCOWRIDR
AND SHPMST.MSTDOCNUM

= SHPLOC.MSTDOCNUM
AND
SHPMST.SEQNUM = SHPLOC.SEQNUM
AND SHPMST.DUPNUM = SHPLOC.DUPNUM
AND SHPLOC.ARPCOD=ARPSHP.ARPCOD
WHERE

SHPMST.MSTDOCNUM
= ?
AND SHPMST.DOCOWRIDR = ?
AND SHPMST.DUPNUM = ?
AND SHPMST.CMPCOD = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>325</QRY:Id>
		<QRY:Source Name="operations.flthandling.ctm.findShipmentDetailsForCTM" Type="NATIVE">
			<![CDATA[
			SELECT DECODE (cstmap.cstautcod, NULL, 0,
  CASE
    WHEN ARPMSTDST.CNTCOD            ='DE'
    AND


NVL(cstmap.cstcntcod,'1234') = 'DE'
    AND SCICOD                      IN ('T1','TD','TF')
    THEN



(SELECT DECODE (COUNT (DISTINCT cst.cstautcod), LENGTH (cstmap.cstautcod) - LENGTH (REPLACE (cstmap.cstautcod,


',')) + 1, 1000, 100 )
										 FROM CSTARPSHP cst
										WHERE cst.cmpcod


= cstmap.cmpcod
										AND cst.arpcod                              = cstmap.arpcod
										AND

cst.docowridr
= MST.docowridr
										AND cst.mstdocnum

= MST.mstdocnum
										AND cst.dupnum
= MST.dupnum
										AND cst.seqnum

= MST.seqnum
										AND INSTR (cstmap.cstautcod,
cst.cstautcod) > 0
      AND cst.cststa

IN ('S','CC')
      )
    WHEN NVL(ORGCTY.EURNONEURIND,'N')
= 'N'
    AND NVL(DSTCTY.EURNONEURIND,'N')

= 'E'
    THEN
      (SELECT DECODE (COUNT (DISTINCT cst.cstautcod),
LENGTH (cstmap.cstautcod) - LENGTH

(REPLACE (cstmap.cstautcod, ',')) + 1, 1000, 100 )
      FROM CSTARPSHP
cst,
        CSTARPTXNMAP_VW


      WHERE cst.cmpcod                            = cstmap.cmpcod

AND cst.arpcod

= cstmap.arpcod
      AND cst.docowridr
= MST.docowridr
      AND cst.mstdocnum

= MST.mstdocnum
      AND cst.dupnum
= MST.dupnum
      AND cst.seqnum

= MST.seqnum
      AND INSTR (cstmap.cstautcod,
cst.cstautcod) > 0
      AND cst.cststa

IN ('S','CC')
      )
    WHEN ARPMSTORG.CNTCOD
<> ARPMSTDST.CNTCOD
	AND ARPMSTDST.CNTCOD

<>'DE'
    AND NVL(DSTCTY.EURNONEURIND,'N')
= 'N'
    THEN
      (SELECT DECODE (COUNT (DISTINCT cst.cstautcod),

LENGTH (cstmap.cstautcod) - LENGTH
(REPLACE (cstmap.cstautcod, ',')) + 1, 1000, 100 )
      FROM CSTARPSHP

cst
      WHERE cst.cmpcod
= cstmap.cmpcod
      AND cst.arpcod

= cstmap.arpcod
      AND cst.docowridr
= MST.docowridr
      AND cst.mstdocnum

= MST.mstdocnum
      AND cst.dupnum
= MST.dupnum
      AND cst.seqnum

= MST.seqnum
      AND INSTR (cstmap.cstautcod,
cst.cstautcod) > 0
      AND cst.cststa

IN ('S','CC')
      )
  END ) cststa
FROM
OPRSHPMST MST
LEFT OUTER JOIN CSTARPTXNMAP_VW CSTMAP


							ON  MST.CMPCOD = CSTMAP.CMPCOD
							AND
MST.DOCOWRIDR =CSTMAP.ARLIDR
LEFT OUTER JOIN OPRSHPMSTMIS

MIS
ON MST.DOCOWRIDR  = MIS.DOCOWRIDR
AND MST.MSTDOCNUM
= MIS.MSTDOCNUM
AND MST.DUPNUM    = MIS.DUPNUM
AND

MST.SEQNUM    = MIS.SEQNUM
AND MST.CMPCOD    = MIS.CMPCOD
LEFT
OUTER JOIN SHRARPMST ARPMSTORG
ON MST.CMPCOD

= ARPMSTORG.CMPCOD
AND MST.ORGCOD = ARPMSTORG.ARPCOD
LEFT
OUTER JOIN SHRCTYMST ORGCTY
ON ORGCTY.CMPCOD

= ARPMSTORG.CMPCOD
AND ORGCTY.CTYCOD = ARPMSTORG.CTYCOD
LEFT
OUTER JOIN SHRARPMST ARPMSTDST
ON MST.CMPCOD

= ARPMSTDST.CMPCOD
AND MST.DSTCOD = ARPMSTDST.ARPCOD
LEFT
OUTER JOIN SHRCTYMST DSTCTY
ON DSTCTY.CMPCOD

= ARPMSTDST.CMPCOD
AND DSTCTY.CTYCOD = ARPMSTDST.CTYCOD

							 WHERE MST.CMPCOD =?


								AND CSTMAP.ARPCOD   =?
								AND MST.DOCOWRIDR=?
								AND MST.MSTDOCNUM=?


AND MST.DUPNUM
=?
								AND MST.SEQNUM   =?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<!--Added by A-5493 for ICRD-23523-->
	<QRY:Definition>
		<QRY:Id>326</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findShipmentSummaryInFlight" Type="NATIVE">
			<![CDATA[
			SELECT shpmst.mstdocnum,
                   shpmst.docowridr,
                   shpmst.seqnum,



                   shpmst.dupnum,
                   shpmst.cmpcod,
                   shpmst.shppfx,



                   shpmst.rdycrgflg,
                   arpshp.arpcod,

arpshp.acppcs,


                   arpshp.acpwgt,
                   arpshp.tfrinpcs,

arpshp.tfrinwgt

            FROM
oprshpmst shpmst
            INNER JOIN oprarpshp arpshp

ON shpmst.mstdocnum = arpshp.mstdocnum


               AND shpmst.docowridr = arpshp.docowridr

AND shpmst.seqnum = arpshp.seqnum


               AND shpmst.cmpcod = arpshp.cmpcod

WHERE shpmst.cmpcod = ?
               AND arpshp.arpcod
= ?

			   AND (shpmst.mstdocnum,shpmst.docowridr,shpmst.seqnum,shpmst.dupnum)
IN
			]]>
		</QRY:Source>
	</QRY:Definition>
	<!--Added by A-5493 ends-->
	<QRY:Definition>
		<QRY:Id>326</QRY:Id>
		<QRY:Source Name="operations.flthandling.findnotocdryicedetails" Type="NATIVE">
			<![CDATA[
			select ICE.CMPCOD,
			  ICE.FLTCARIDR,
			  ICE.FLTNUM,
			  ICE.FLTSEQNUM,
			  ICE.LEGSERNUM,
			  ICE.SERNUM,
			  ICE.ULDNUM,
			  ICE.POU,
			  ICE.NETQTY,
			  ICE.CRGHLD,
			  ICE.POS,
			  ICE.LSTUPDUSR,
			  ICE.LSTUPDTIM
			from OPRNTCDRYICE ICE
			INNER JOIN FLTOPRLEG LEG
			ON LEG.FLTCARIDR = ICE.FLTCARIDR
			AND LEG.FLTSEQNUM = ICE.FLTSEQNUM
			AND LEG.FLTNUM = ICE.FLTNUM
			AND LEG.LEGSERNUM = ICE.LEGSERNUM
			AND LEG.CMPCOD = ICE.CMPCOD
			INNER JOIN FLTOPRSEG SEG
			ON SEG.FLTCARIDR=LEG.FLTCARIDR
			AND SEG.FLTNUM = LEG.FLTNUM
			AND SEG.FLTSEQNUM =LEG.FLTSEQNUM
			AND SEG.SEGORG = LEG.LEGORG
			AND SEG.CMPCOD = LEG.CMPCOD
			AND SEG.SEGDST=ICE.POU
			where ICE.FLTNUM =?
			and ICE.FLTCARIDR =?
			and ICE.FLTSEQNUM =?
			and ICE.CMPCOD =?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>327</QRY:Id>
		<QRY:Source Name="operations.flthandling.findnotocdryicehistorydetails" Type="NATIVE">
			<![CDATA[
			SELECT CMPCOD,
			  FLTCARIDR,
			  FLTNUM,
			  FLTSEQNUM,
			  LEGSERNUM,
			  SERNUM,
			  ULDNUM,
			  POU,
			  NETQTY,
			  CRGHLD,
			  POS,
			  LSTUPDUSR,
			  LSTUPDTIM
			FROM OPRNTCDRYICEHIS
			WHERE FLTNUM = ?
			AND FLTCARIDR = ?
			AND FLTSEQNUM = ?
			AND CMPCOD = ?
			AND VERNUM = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>375</QRY:Id>
		<QRY:Source Name="operations.flthandling.findUldsForRelease" Type="NATIVE">
			<![CDATA[
				SELECT MST.CMPCOD,
				  MST.DOMFLTFLG,
				  MST.FLTNUM,
				  MST.FLTSEQNUM,
				  MST.FLTROU,



				  OPRLEG.LEGORG,
				  OPRLEG.LEGDST,
				  OPRLEG.LEGSERNUM,
				  FLTSEG.POU,
				  ULDDTL.CLSFLG,



				  ULDDTL.ULDNUM,
				  OPRLEG.ATA,
				  OPRLEG.STA
				FROM FLTOPRMST MST
				INNER JOIN
FLTOPRLEG
OPRLEG

				ON OPRLEG.CMPCOD     = MST.CMPCOD
				AND OPRLEG.FLTCARIDR = MST.FLTCARIDR

AND OPRLEG.FLTNUM
=
MST.FLTNUM
				AND OPRLEG.FLTSEQNUM = MST.FLTSEQNUM
				INNER
JOIN
OPRFLTSEG
FLTSEG
				ON FLTSEG.CMPCOD     = OPRLEG.CMPCOD
				AND FLTSEG.FLTCARIDR = OPRLEG.FLTCARIDR



AND FLTSEG.FLTNUM    = OPRLEG.FLTNUM
				AND FLTSEG.FLTSEQNUM = OPRLEG.FLTSEQNUM
				AND FLTSEG.POU


= OPRLEG.LEGDST
				INNER JOIN OPRSEGULD SEGULD
				ON SEGULD.CMPCOD     = FLTSEG.CMPCOD
				AND SEGULD.FLTCARIDR


= FLTSEG.FLTCARIDR
				AND SEGULD.FLTNUM    = FLTSEG.FLTNUM
				AND SEGULD.FLTSEQNUM = FLTSEG.FLTSEQNUM



				AND SEGULD.SEGSERNUM =FLTSEG.SEGSERNUM
				INNER JOIN OPRULDDTL ULDDTL
				ON ULDDTL.CMPCOD

= SEGULD.CMPCOD

				AND ULDDTL.FLTCARIDR = SEGULD.FLTCARIDR
				AND ULDDTL.FLTNUM    = SEGULD.FLTNUM


				AND ULDDTL.FLTSEQNUM
= SEGULD.FLTSEQNUM
				AND ULDDTL.ULDNUM    = SEGULD.ULDNUM
				AND FLTSEG.POU

= ULDDTL.POU

where EXISTS (SELECT 1 FROM SHRUSEARPPAR WHERE PARCOD = 'operation.flthandling.triggerpointforuldrelease'


AND ARPCOD= FLTSEG.POU AND PARVAl = ? )
				AND ( OPRLEG.ATA IS not  NULL
						 OR OPRLEG.STAUTC+(SELECT


(to_number(PARVAL)/(select 24*60 from dual)) VAL FROM SHRSYSPAR  WHERE PARCOD = 'operations.flthandling.buffertimetoreleaseuld'


AND CMPCOD = ?) < sys_extract_utc(systimestamp))
				AND MST.CMPCOD = ?
				AND NVL(ULDDTL.CLSFLG,'N')  = 'N'
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>328</QRY:Id>
		<QRY:Source Name="operations.flthandling.findnotocflightdetails" Type="NATIVE">
			<![CDATA[
			SELECT NTC.CMPCOD,
  NTC.FLTCARIDR,
  NTC.FLTNUM,
  NTC.FLTSEQNUM,
  NTC.LEGSERNUM,
  NTC.LSTVERNUM,
  NTC.NTCPRPUSR,
  NTC.POL,
  NTC.LSTUPDUSR,
  NTC.LSTUPDTIM,
  NTC.NTCSTA,
  NTC.FINFLG,
  EXP.OPRREFCARCOD,
  EXP.OPRREFFLTNUM,
  EXP.OPRREFFLTDATUTC,
  NTC.TILNUM,
  NTC.LODCTL,
  NTC.STNLOD
FROM OPRNTCFLT NTC,
  OPRARPEXPFLT EXP
WHERE NTC.FLTNUM  =EXP.FLTNUM(+)
AND NTC.FLTCARIDR =EXP.FLTCARIDR(+)
AND NTC.FLTSEQNUM =EXP.FLTSEQNUM(+)
AND NTC.LEGSERNUM =EXP.LEGSERNUM(+)
AND NTC.CMPCOD    =EXP.CMPCOD(+)
AND NTC.FLTNUM    = ?
AND NTC.FLTCARIDR = ?
AND NTC.FLTSEQNUM = ?
AND NTC.CMPCOD    = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>376</QRY:Id>
		<QRY:Source Name="operations.flthandling.findULDListForBreakdownHHTforULD" Type="NATIVE">
			<![CDATA[

	SELECT  FLTMST.CMPCOD ,OPRLEG.LEGSERNUM,
	  FLTMST.FLTCARIDR ,
	  FLTMST.FLTNUM ,
	  FLTMST.FLTSEQNUM


,
	  SEG.SEGSERNUM ,
	  ULD.ULDNUM ,
	  ULD.GRSWGT,
	  ULD.NETWGT,
	  ULD.THRUNT,
	  ULD.ULDCTR,



	  ULD.TARWGT,
	  ULD.BDNCPLFLG ,
	  ULD.RMK ULDRMK,
		(SELECT
			CASE
			  WHEN ((IMPFLT.MFTSRC
='F'
			  AND SEGULD.BKGTYP   IS NULL)
			  OR ULDBKGMST.BKGSTA  ='XX')
			  THEN 'BDN Unit'
			  WHEN
(SEGULD.BKGTYP   = 'ULD'
			  AND ULDBKGMST.BKGTYP IS NOT NULL)
			  THEN (
				CASE
				  WHEN (ULDBDNDTL.ULDNUM
IS NOT NULL
				  AND ULDBDNDTL.THRINTFLG <>'T'
				  AND ULDBDNDTL.THRINTFLG <>'I')
				  THEN 'BDN
Unit'
				  ELSE ULDBKGMST.BKGTYP
				END)
			  WHEN (SEGULD.BKGTYP IS NOT NULL
			  AND SEGULD.BKGTYP
= 'NIL')
			  THEN ('BDN Unit')
			  WHEN (SEGULD.BKGTYP IS NOT NULL
			  AND SEGULD.BKGTYP   <> 'ULD')

THEN (
				CASE
				  WHEN (ULDBDNDTL.ULDNUM  IS NOT NULL
				  AND ULDBDNDTL.THRINTFLG <>'T'
				  AND
ULDBDNDTL.THRINTFLG <>'I')
				  THEN 'BDN Unit'
				  ELSE SEGULD.BKGTYP
				END)
			  ELSE 'BDN Unit'

END ULDCHAR
		  FROM OPRSEGULD SEGULD,
			CAPULDBKGMST ULDBKGMST,
			OPRULDBDNDTL ULDBDNDTL
		  WHERE
SEG.FLTCARIDR  = SEGULD.FLTCARIDR
		  AND SEG.FLTNUM       = SEGULD.FLTNUM
		  AND SEG.FLTSEQNUM    =
SEGULD.FLTSEQNUM
		  AND SEG.SEGSERNUM    = SEGULD.SEGSERNUM
		  AND SEG.CMPCOD       = SEGULD.CMPCOD

AND ULD.ULDNUM       = SEGULD.ULDNUM
		  AND SEGULD.CMPCOD    = ULDBKGMST.CMPCOD(+)
		  AND SEGULD.ULDBKGIDR
= ULDBKGMST.ULDBKGIDR(+)
		  AND SEGULD.CMPCOD    = ULDBDNDTL.CMPCOD(+)
		  AND SEGULD.FLTCARIDR = ULDBDNDTL.FLTCARIDR(+)

AND SEGULD.FLTNUM    = ULDBDNDTL.FLTNUM(+)
		  AND SEGULD.FLTSEQNUM = ULDBDNDTL.FLTSEQNUM(+)
		  AND
SEGULD.ULDNUM    = ULDBDNDTL.ULDNUM(+)
		  AND SEG.POU          = ULDBDNDTL.ARPCOD (+)
		  ) ULDCHAR
,
	  ULD.BKGTYP ,
	  ULD.ULDBKGIDR,
	  ULD.ULDDST,


	  ULD.ULDSTA ,
	  ULD.BUPFLG,
	  ULD.BDNITN,


	  SEG.POL ,
	  SEG.POU ,
	  OPRLEG.STA ATA,
	  OPRLEG.ATA
FLTATA,
	  SHP.MFTPCS SEGULDSPHMFTPCS,


	  SHP.MFTWGT SEGULDSPHMFTWGT,
	  SHP.MFTVOL SEGULDSPHMFTVOL,

	  SHP.DOCOWRIDR ,
	  SHP.MSTDOCNUM
,
	  SHP.DUPNUM
,
	  SHP.SEQNUM,
	  SHP.RMK SHPRMK,
	  SHP.LODPRT,

	  SHP.RCVPCS ,
	  SHP.RCVWGT
,
	  SHP.RCVVOL ,

	  SHP.SLCPCS ,
	  MST.PRDNAM,
	  MST.PRDPRT,
	  MST.CONFLG,

	  MST.SHPPFX,

MST.ORGCOD,
	  MST.DSTCOD,

	  MST.STDPCS,
	  ARPSHP.DCSREQFLG,
	  ARPSHP.DOCRCVFLG,

	  ARPSHP.RCVPCS
ARPRCVPCS,
	  MST.RDYCRGFLG,
	  ARPSHP.RCVWGT ARPRCVWGT,
	  SEGSHP.MFTPCS SEGSHPMFTPCS,
	  SEGSHP.MFTWGT SEGSHPMFTWGT,

SEGSHP.MFTVOL

SEGSHPMFTVOL,
	  HSE.DOCNUM ,
	  HSE.PCS HSEPCS,
	  HSE.WGT HSEWGT,
	  HSE.TXNREFNIN
HSESLACPCS,

	  HSE.MSTDOCNUM
HSEMSTDOCNUM,
	  HSE.DUPNUM HSEDUPNUM,
	  HSE.DOCOWRIDR HSEDOCOWRIDR,

HSE.SEQNUM HSESEQNUM,

	  HSE.SERNUM
HSESERNUM,
	  HSE.CMPCOD HSECMPCOD,
	  HSE.TXNCOD HSETXNCOD,

	  MST.STDWGT,
HSE.ARPCOD,

	  IMPFLT.BRKDWNFLG,IMPFLT.CLSFLG,   
	  (
  CASE ARLMST.APHCODUSE
    WHEN 2
    THEN ARLMST.TWOAPHCOD
    ELSE ARLMST.THRAPHCOD
  END) FLTCARCOD,


	  MST.SCCCOD,SHPDTL.APRFLG,

(SELECT THRINTFLG FROM OPRULDBDNDTL WHERE ULDNUM = ULD.ULDNUM

		AND FLTNUM = IMPFLT.FLTNUM
		AND FLTSEQNUM
= IMPFLT.FLTSEQNUM
		AND FLTCARIDR = IMPFLT.FLTCARIDR

AND ARPCOD = IMPFLT.ARPCOD
		AND LEGSERNUM =
IMPFLT.LEGSERNUM
		AND CMPCOD = IMPFLT.CMPCOD) AS THRINTFLG,


		(SELECT SHPDLVTIM FROM CAPBKGMST WHERE

			CMPCOD = MST.CMPCOD
			AND MSTDOCNUM = MST.MSTDOCNUM

AND DUPNUM = MST.DUPNUM
			AND SEQNUM =
MST.SEQNUM
			AND UBRNUM = MST.UBRNUM
			AND DOCOWRIDR = MST.DOCOWRIDR
) SHPDLVTIM,
  (SELECT 'Y' FROM
OPRFLTSEG FLTSEG
INNER JOIN OPRSEGULD SEGULD
ON FLTSEG.FLTCARIDR
= SEGULD.FLTCARIDR
AND FLTSEG.FLTNUM
= SEGULD.FLTNUM
AND FLTSEG.FLTSEQNUM = SEGULD.FLTSEQNUM
AND FLTSEG.SEGSERNUM
= SEGULD.SEGSERNUM
AND
FLTSEG.CMPCOD = SEGULD.CMPCOD
AND SEGULD.MFTFLG = 'Y'
LEFT OUTER JOIN OPRSEGULDSHP
ULDSHP
ON ULDSHP.FLTCARIDR
= SEGULD.FLTCARIDR
AND ULDSHP.FLTNUM = SEGULD.FLTNUM
AND ULDSHP.FLTSEQNUM
= SEGULD.FLTSEQNUM
AND
ULDSHP.SEGSERNUM = SEGULD.SEGSERNUM
AND ULDSHP.CMPCOD = SEGULD.CMPCOD
AND ULDSHP.ULDNUM
= SEGULD.ULDNUM

WHERE ULDSHP.CMPCOD = SHP.CMPCOD
AND ULDSHP.MSTDOCNUM = SHP.MSTDOCNUM
AND ULDSHP.DOCOWRIDR
= SHP.DOCOWRIDR

AND ULDSHP.SEQNUM = SHP.SEQNUM
AND ULDSHP.DUPNUM = SHP.DUPNUM
AND FLTSEG.POU = SEG.POU

GROUP BY
'Y'
HAVING COUNT(1) > 1) SPLIND


	FROM OPRFLTSEG SEG
	INNER JOIN FLTOPRLEG OPRLEG
	ON SEG.CMPCOD
= OPRLEG.CMPCOD

	AND
SEG.FLTCARIDR = OPRLEG.FLTCARIDR
	AND SEG.FLTNUM    = OPRLEG.FLTNUM
	AND SEG.FLTSEQNUM
= OPRLEG.FLTSEQNUM


	AND SEG.POU     = OPRLEG.LEGDST
	LEFT OUTER JOIN OPRARPIMPFLT IMPFLT

	ON OPRLEG.CMPCOD
= IMPFLT.CMPCOD

AND OPRLEG.FLTCARIDR  = IMPFLT.FLTCARIDR
	AND OPRLEG.FLTNUM
= IMPFLT.FLTNUM
	AND
OPRLEG.FLTSEQNUM
= IMPFLT.FLTSEQNUM
	AND OPRLEG.LEGDST     = IMPFLT.ARPCOD

	INNER
JOIN FLTOPRMST
FLTMST
	ON SEG.CMPCOD
= FLTMST.CMPCOD
	AND SEG.FLTCARIDR = FLTMST.FLTCARIDR
	AND SEG.FLTNUM
=
FLTMST.FLTNUM
	AND SEG.FLTSEQNUM
= FLTMST.FLTSEQNUM
	INNER JOIN SHRARLMST ARLMST
ON ARLMST.CMPCOD = FLTMST.CMPCOD
AND ARLMST.ARLIDR = FLTMST.FLTCARIDR

	LEFT OUTER JOIN OPRSEGULD ULD
	ON SEG.FLTCARIDR

= ULD.FLTCARIDR
	AND SEG.FLTNUM
= ULD.FLTNUM
	AND SEG.FLTSEQNUM = ULD.FLTSEQNUM
	AND SEG.SEGSERNUM

= ULD.SEGSERNUM
	AND SEG.CMPCOD
= ULD.CMPCOD
	AND ULD.MFTFLG = 'Y'

	LEFT
OUTER JOIN OPRSEGULDSHP
SHP
	ON ULD.FLTCARIDR  = SHP.FLTCARIDR

AND ULD.FLTNUM    = SHP.FLTNUM
	AND ULD.FLTSEQNUM
= SHP.FLTSEQNUM

AND ULD.SEGSERNUM = SHP.SEGSERNUM

AND ULD.CMPCOD    = SHP.CMPCOD
	AND ULD.ULDNUM
= SHP.ULDNUM


	LEFT OUTER JOIN OPRSEGSHP SEGSHP

ON SHP.DOCOWRIDR  = SEGSHP.DOCOWRIDR

	AND SHP.MSTDOCNUM = SEGSHP.MSTDOCNUM

AND SHP.DUPNUM    = SEGSHP.DUPNUM

AND SHP.SEQNUM    = SEGSHP.SEQNUM

	AND SHP.CMPCOD    = SEGSHP.CMPCOD

AND SHP.FLTCARIDR = SEGSHP.FLTCARIDR

AND SHP.FLTNUM    = SEGSHP.FLTNUM

	AND SHP.FLTSEQNUM = SEGSHP.FLTSEQNUM

AND SHP.SEGSERNUM = SEGSHP.SEGSERNUM


	LEFT OUTER JOIN OPRARPSHP
ARPSHP
	ON SHP.DOCOWRIDR  = ARPSHP.DOCOWRIDR

AND SHP.MSTDOCNUM = ARPSHP.MSTDOCNUM

	AND SHP.DUPNUM
= ARPSHP.DUPNUM
	AND SHP.SEQNUM    = ARPSHP.SEQNUM

AND SHP.CMPCOD    = ARPSHP.CMPCOD

	AND ARPSHP.ARPCOD
= SEG.POU

	LEFT OUTER JOIN OPRSHPDTL SHPDTL

	ON SHP.DOCOWRIDR  = SHPDTL.DOCOWRIDR

	AND SHP.MSTDOCNUM
= SHPDTL.MSTDOCNUM
	AND SHP.DUPNUM    =
SHPDTL.DUPNUM
	AND SHP.SEQNUM    = SHPDTL.SEQNUM

	AND SHP.CMPCOD
= SHPDTL.CMPCOD


	LEFT OUTER
JOIN OPRTXNHSE HSE
	ON SHP.DOCOWRIDR            =
HSE.DOCOWRIDR
	AND
SHP.MSTDOCNUM           = HSE.MSTDOCNUM

AND SHP.DUPNUM              = HSE.DUPNUM

	AND SHP.CMPCOD
= HSE.CMPCOD
	AND TO_CHAR( SHP.FLTCARIDR)
=HSE.TXNREFTWO
	AND SHP.FLTNUM
= HSE.TXNREFTHR

AND TO_CHAR(SHP.FLTSEQNUM ) = HSE.TXNREFFIV

AND TO_CHAR( SHP.ULDNUM )   = HSE.TXNREFSIX

AND HSE.TXNCOD
= 'MFT'

	LEFT OUTER JOIN OPRSHPMST MST
ON
	SHP.DOCOWRIDR = MST.DOCOWRIDR
	AND SHP.MSTDOCNUM
= MST.MSTDOCNUM

	AND SHP.DUPNUM = MST.DUPNUM

AND SHP.SEQNUM = MST.SEQNUM
	AND SHP.CMPCOD = MST.CMPCOD

	LEFT OUTER JOIN CAPBKGFLTDTL BKGFLT
	ON
MST.CMPCOD = BKGFLT.CMPCOD

	AND MST.UBRNUM = BKGFLT.UBRNUM

	AND MST.DOCOWRIDR = BKGFLT.DOCOWRIDR

	AND MST.MSTDOCNUM = BKGFLT.MSTDOCNUM

	AND MST.DUPNUM = BKGFLT.DUPNUM

	AND MST.SEQNUM = BKGFLT.SEQNUM

	AND SEG.POU = BKGFLT.FLTORG
	LEFT OUTER JOIN FLTOPRLEG OPRLEGOUT

ON  BKGFLT.CMPCOD =  OPRLEGOUT.CMPCOD

AND BKGFLT.FLTCARIDR = OPRLEGOUT.FLTCARIDR
	AND BKGFLT.FLTNUM
= OPRLEGOUT.FLTNUM
	AND BKGFLT.FLTSEQNUM
= OPRLEGOUT.FLTSEQNUM
	AND BKGFLT.FLTORG = OPRLEGOUT.LEGORG

	AND BKGFLT.FLTDST = OPRLEGOUT.LEGDST



	WHERE ULD.CMPCOD     = ?


			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>404</QRY:Id>
		<QRY:Source Name="operations.flthandling.findULDListForBreakdownHHTforAWB" Type="NATIVE">
			<![CDATA[

	SELECT  FLTMST.CMPCOD ,OPRLEG.LEGSERNUM,
	  FLTMST.FLTCARIDR ,
	  FLTMST.FLTNUM ,
	  FLTMST.FLTSEQNUM

,
	  SEG.SEGSERNUM ,
	  ULD.ULDNUM ,
	  ULD.GRSWGT,
	  ULD.NETWGT,
	  ULD.THRUNT,
	  ULD.ULDCTR,


	  ULD.TARWGT,
	  ULD.BDNCPLFLG ,
	  ULD.RMK ULDRMK,
		(SELECT
			CASE
			  WHEN ((IMPFLT.MFTSRC
='F'
			  AND SEGULD.BKGTYP   IS NULL)
			  OR ULDBKGMST.BKGSTA  ='XX')
			  THEN 'BDN Unit'
			  WHEN
(SEGULD.BKGTYP   = 'ULD'
			  AND ULDBKGMST.BKGTYP IS NOT NULL)
			  THEN (
				CASE
				  WHEN (ULDBDNDTL.ULDNUM
IS NOT NULL
				  AND ULDBDNDTL.THRINTFLG <>'T'
				  AND ULDBDNDTL.THRINTFLG <>'I')
				  THEN 'BDN
Unit'
				  ELSE ULDBKGMST.BKGTYP
				END)
			  WHEN (SEGULD.BKGTYP IS NOT NULL
			  AND SEGULD.BKGTYP
= 'NIL')
			  THEN ('BDN Unit')
			  WHEN (SEGULD.BKGTYP IS NOT NULL
			  AND SEGULD.BKGTYP   <> 'ULD')

THEN (
				CASE
				  WHEN (ULDBDNDTL.ULDNUM  IS NOT NULL
				  AND ULDBDNDTL.THRINTFLG <>'T'
				  AND
ULDBDNDTL.THRINTFLG <>'I')
				  THEN 'BDN Unit'
				  ELSE SEGULD.BKGTYP
				END)
			  ELSE 'BDN Unit'

END ULDCHAR
		  FROM OPRSEGULD SEGULD,
			CAPULDBKGMST ULDBKGMST,
			OPRULDBDNDTL ULDBDNDTL
		  WHERE
SEG.FLTCARIDR  = SEGULD.FLTCARIDR
		  AND SEG.FLTNUM       = SEGULD.FLTNUM
		  AND SEG.FLTSEQNUM    =
SEGULD.FLTSEQNUM
		  AND SEG.SEGSERNUM    = SEGULD.SEGSERNUM
		  AND SEG.CMPCOD       = SEGULD.CMPCOD

AND ULD.ULDNUM       = SEGULD.ULDNUM
		  AND SEGULD.CMPCOD    = ULDBKGMST.CMPCOD(+)
		  AND SEGULD.ULDBKGIDR
= ULDBKGMST.ULDBKGIDR(+)
		  AND SEGULD.CMPCOD    = ULDBDNDTL.CMPCOD(+)
		  AND SEGULD.FLTCARIDR = ULDBDNDTL.FLTCARIDR(+)

AND SEGULD.FLTNUM    = ULDBDNDTL.FLTNUM(+)
		  AND SEGULD.FLTSEQNUM = ULDBDNDTL.FLTSEQNUM(+)
		  AND
SEGULD.ULDNUM    = ULDBDNDTL.ULDNUM(+)
		  AND SEG.POU          = ULDBDNDTL.ARPCOD (+)
		  ) ULDCHAR
,
	  ULD.BKGTYP ,
	  ULD.ULDBKGIDR,
	  ULD.ULDDST,

	  ULD.ULDSTA ,
	  ULD.BUPFLG,
	  ULD.BDNITN,

	  SEG.POL ,
	  SEG.POU ,
	  OPRLEG.STA ATA,
	  OPRLEG.ATA
FLTATA,
	  SHP.MFTPCS SEGULDSPHMFTPCS,

	  SHP.MFTWGT SEGULDSPHMFTWGT,
	  SHP.MFTVOL SEGULDSPHMFTVOL,

	  SHP.DOCOWRIDR ,
	  SHP.MSTDOCNUM
,
	  SHP.DUPNUM ,
	  SHP.SEQNUM,
	  SHP.RMK SHPRMK,
	  SHP.LODPRT,

	  SHP.RCVPCS ,
	  SHP.RCVWGT
,
	  SHP.RCVVOL ,

	  SHP.SLCPCS ,
	  MST.PRDNAM,
	  MST.PRDPRT,
	  MST.CONFLG,
	  MST.RDYCRGFLG,
	  MST.SHPPFX,

MST.ORGCOD,
	  MST.DSTCOD,
	  MST.STDPCS,
	  ARPSHP.DCSREQFLG,
	  ARPSHP.DOCRCVFLG,

	  ARPSHP.RCVPCS
ARPRCVPCS,
ARPSHP.RCVWGT ARPRCVWGT,
	  SEGSHP.MFTPCS SEGSHPMFTPCS,
	  SEGSHP.MFTWGT SEGSHPMFTWGT,

SEGSHP.MFTVOL
SEGSHPMFTVOL,
	  HSE.DOCNUM ,
	  HSE.PCS HSEPCS,
	  HSE.WGT HSEWGT,
	  HSE.TXNREFNIN HSESLACPCS,

HSE.MSTDOCNUM
HSEMSTDOCNUM,
	  HSE.DUPNUM HSEDUPNUM,
	  HSE.DOCOWRIDR HSEDOCOWRIDR,
	  HSE.SEQNUM HSESEQNUM,

HSE.SERNUM
HSESERNUM,
	  HSE.CMPCOD HSECMPCOD,
	  HSE.TXNCOD HSETXNCOD,
  	  HSE.ARPCOD,

IMPFLT.BRKDWNFLG,   
(
  CASE ARLMST.APHCODUSE
    WHEN 2
    THEN ARLMST.TWOAPHCOD
    ELSE ARLMST.THRAPHCOD
  END) FLTCARCOD,

	  MST.STDWGT,

	  MST.SCCCOD,SHPDTL.APRFLG,
	   (SELECT THRINTFLG FROM
OPRULDBDNDTL WHERE ULDNUM = ULD.ULDNUM

		AND FLTNUM = IMPFLT.FLTNUM
		AND FLTSEQNUM = IMPFLT.FLTSEQNUM

AND FLTCARIDR = IMPFLT.FLTCARIDR

AND ARPCOD = IMPFLT.ARPCOD
		AND LEGSERNUM = IMPFLT.LEGSERNUM
		AND
CMPCOD = IMPFLT.CMPCOD) AS THRINTFLG,

		(SELECT SHPDLVTIM FROM CAPBKGMST WHERE
			CMPCOD = MST.CMPCOD

AND MSTDOCNUM = MST.MSTDOCNUM

AND DUPNUM = MST.DUPNUM
			AND SEQNUM = MST.SEQNUM
			AND UBRNUM =
MST.UBRNUM
			AND DOCOWRIDR = MST.DOCOWRIDR
) SHPDLVTIM
	FROM OPRFLTSEG SEG
	INNER JOIN FLTOPRLEG OPRLEG

ON SEG.CMPCOD     = OPRLEG.CMPCOD
	AND
SEG.FLTCARIDR = OPRLEG.FLTCARIDR
	AND SEG.FLTNUM    = OPRLEG.FLTNUM

AND SEG.FLTSEQNUM = OPRLEG.FLTSEQNUM

	AND SEG.POU     = OPRLEG.LEGDST
	LEFT OUTER JOIN OPRARPIMPFLT
IMPFLT
	ON OPRLEG.CMPCOD      = IMPFLT.CMPCOD

AND OPRLEG.FLTCARIDR  = IMPFLT.FLTCARIDR
	AND OPRLEG.FLTNUM
= IMPFLT.FLTNUM
	AND OPRLEG.FLTSEQNUM
= IMPFLT.FLTSEQNUM
	AND OPRLEG.LEGDST     = IMPFLT.ARPCOD
	INNER
JOIN FLTOPRMST FLTMST
	ON SEG.CMPCOD
= FLTMST.CMPCOD
	AND SEG.FLTCARIDR = FLTMST.FLTCARIDR
	AND SEG.FLTNUM
= FLTMST.FLTNUM
	AND SEG.FLTSEQNUM
= FLTMST.FLTSEQNUM
INNER JOIN SHRARLMST ARLMST
ON ARLMST.CMPCOD = FLTMST.CMPCOD
AND ARLMST.ARLIDR = FLTMST.FLTCARIDR

	LEFT OUTER JOIN OPRSEGULD ULD
	ON SEG.FLTCARIDR
= ULD.FLTCARIDR
	AND SEG.FLTNUM
= ULD.FLTNUM
	AND SEG.FLTSEQNUM = ULD.FLTSEQNUM
	AND SEG.SEGSERNUM
= ULD.SEGSERNUM
	AND SEG.CMPCOD
= ULD.CMPCOD
	AND ULD.MFTFLG = 'Y'
	LEFT OUTER JOIN OPRSEGULDSHP
SHP
	ON ULD.FLTCARIDR  = SHP.FLTCARIDR

AND ULD.FLTNUM    = SHP.FLTNUM
	AND ULD.FLTSEQNUM = SHP.FLTSEQNUM

AND ULD.SEGSERNUM = SHP.SEGSERNUM

AND ULD.CMPCOD    = SHP.CMPCOD
	AND ULD.ULDNUM    = SHP.ULDNUM

LEFT OUTER JOIN OPRSEGSHP SEGSHP

ON SHP.DOCOWRIDR  = SEGSHP.DOCOWRIDR
	AND SHP.MSTDOCNUM = SEGSHP.MSTDOCNUM

AND SHP.DUPNUM    = SEGSHP.DUPNUM

AND SHP.SEQNUM    = SEGSHP.SEQNUM
	AND SHP.CMPCOD    = SEGSHP.CMPCOD

AND SHP.FLTCARIDR = SEGSHP.FLTCARIDR

AND SHP.FLTNUM    = SEGSHP.FLTNUM
	AND SHP.FLTSEQNUM = SEGSHP.FLTSEQNUM

AND SHP.SEGSERNUM = SEGSHP.SEGSERNUM

	LEFT OUTER JOIN OPRARPSHP ARPSHP
	ON SHP.DOCOWRIDR  = ARPSHP.DOCOWRIDR

AND SHP.MSTDOCNUM = ARPSHP.MSTDOCNUM

AND SHP.DUPNUM    = ARPSHP.DUPNUM
	AND SHP.SEQNUM    = ARPSHP.SEQNUM

AND SHP.CMPCOD    = ARPSHP.CMPCOD

AND ARPSHP.ARPCOD = SEG.POU
	LEFT OUTER JOIN OPRSHPDTL SHPDTL

	ON SHP.DOCOWRIDR  = SHPDTL.DOCOWRIDR

AND SHP.MSTDOCNUM = SHPDTL.MSTDOCNUM
	AND SHP.DUPNUM    = SHPDTL.DUPNUM

	AND SHP.SEQNUM    = SHPDTL.SEQNUM

AND SHP.CMPCOD    = SHPDTL.CMPCOD
	LEFT OUTER JOIN OPRTXNHSE HSE

	ON SHP.DOCOWRIDR            = HSE.DOCOWRIDR

AND SHP.MSTDOCNUM           = HSE.MSTDOCNUM
	AND SHP.DUPNUM
= HSE.DUPNUM
	AND SHP.CMPCOD      =
HSE.CMPCOD
	AND TO_CHAR( SHP.FLTCARIDR) =HSE.TXNREFTWO
	AND SHP.FLTNUM
= HSE.TXNREFTHR

	AND TO_CHAR(SHP.FLTSEQNUM ) = HSE.TXNREFFIV
	AND TO_CHAR( SHP.ULDNUM )   = HSE.TXNREFSIX

AND HSE.TXNCOD
= 'MFT'
	INNER JOIN OPRSHPMST MST ON
	SHP.DOCOWRIDR = MST.DOCOWRIDR
	AND SHP.MSTDOCNUM
= MST.MSTDOCNUM

	AND SHP.DUPNUM = MST.DUPNUM
	AND SHP.SEQNUM = MST.SEQNUM
	AND SHP.CMPCOD = MST.CMPCOD

	LEFT OUTER
JOIN CAPBKGFLTDTL BKGFLT
	ON MST.CMPCOD = BKGFLT.CMPCOD
	AND MST.UBRNUM = BKGFLT.UBRNUM

	AND MST.DOCOWRIDR
= BKGFLT.DOCOWRIDR
	AND MST.MSTDOCNUM = BKGFLT.MSTDOCNUM
	AND MST.DUPNUM = BKGFLT.DUPNUM

	AND MST.SEQNUM
= BKGFLT.SEQNUM
	AND SEG.POU = BKGFLT.FLTORG
	LEFT OUTER JOIN FLTOPRLEG OPRLEGOUT

ON  BKGFLT.CMPCOD
=  OPRLEGOUT.CMPCOD
	AND BKGFLT.FLTCARIDR = OPRLEGOUT.FLTCARIDR
	AND BKGFLT.FLTNUM
= OPRLEGOUT.FLTNUM

AND BKGFLT.FLTSEQNUM = OPRLEGOUT.FLTSEQNUM
	AND BKGFLT.FLTORG = OPRLEGOUT.LEGORG

	AND BKGFLT.FLTDST
= OPRLEGOUT.LEGDST
	WHERE ULD.CMPCOD     = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>329</QRY:Id>
		<QRY:Source Name="operations.flthandling.findnotocdgrhistorydetails" Type="NATIVE">
			<![CDATA[
			SELECT NTC.CMPCOD,
				  NTC.DOCOWRIDR,
				  NTC.MSTDOCNUM,
				  NTC.DUPNUM,
				  NTC.SEQNUM,



                  NTC.SERNUM,
				  NTC.FLTCARIDR,
				  NTC.FLTNUM,
				  NTC.FLTSEQNUM,
				  NTC.LEGSERNUM,



                  NTC.SCCCOD,
				  NTC.ULDNUM,
				  NTC.UNIIDR,

NTC.DGRSERNUM,

				  NTC.PKGGRP,

				  NTC.PKGINS,
				  NTC.NUMPKG,
				  NTC.PCSINNULD,

NTC.PROSHPNAM PRPSHPNAM,

				  NTC.RMC,
				  NTC.PKGGRPRMC,

				  NTC.SHPCLS,
				  NTC.SUBRSKONE,

NTC.SUBRSKTWO ,

				  NTC.SUBRSKTHR,
				    NVL(SEG.POL,FLTSEG.SEGORG) AS POL,
					NVL(SEG.POU,FLTSEG.SEGDST) AS POU ,
					NVL(SEG.SEGSERNUM,FLTSEG.SEGSERNUM) AS SEGSERNUM,
				  SHP.STDPCS,

SHP.STDWGT,

				  NTC.TECNAM,
				  NTC.ALLPCKSERNUM,
				  NTC.OVRPCKSERNUM,

				  SHP.CAOFLG,

SHP.SHPPFX,

				  NTC.BDPPCS,
				  NTC.PKGHGT,
				  NVL(NTC.ERGCOD,DGR.ERGCOD) ERGCOD,
				  NTC.OVRVLDFLG,

NTC.LSTUPDUSR,

	               NTC.LSTUPDTIM, DGR.NUMPKG DGRNUMPKG,DGR.TOTTPTIND,

	  
	  DGR.RDOACTFLG,
	   DECODE( NVL(NTC.TPTIND,0) ,0,DGR.TPTIND ,NTC.TPTIND) TPTIND,
  DECODE( NVL(NTC.NETQTY,0) ,0,DGR.NETQTY ,NTC.NETQTY) NETQTY,
  NVL(NTC.NETQTYUNT,DGR.NETQTYUNT) AS NETQTYUNT ,
	  DGR.CARFLAG 
CAOFLG,DGR.SPLATHFLG,DGR.AUTCOD,DGR.PKGDIMHGT,
DGR.SRTDES
				FROM OPRNTCDGRHIS
NTC ,
				  OPRFLTSEG SEG ,
				  FLTOPRSEG FLTSEG,
				  OPRSHPMST
SHP,
				  FLTOPRLEG LEG,OPRSHPDGR
DGR
				WHERE NTC.CMPCOD
= SEG.CMPCOD(+)
				AND NTC.FLTNUM = SEG.FLTNUM(+)
				AND NTC.FLTCARIDR
= SEG.FLTCARIDR(+)
				
				AND NTC.FLTSEQNUM 
= SEG.FLTSEQNUM(+)
				AND NTC.SEGSERNUM = SEG.SEGSERNUM(+)
				And NTC.CMPCOD = FLTSEG.CMPCOD(+)
				AND NTC.FLTNUM = FLTSEG.FLTNUM(+)
				AND NTC.FLTCARIDR =FLTSEG.FLTCARIDR(+)
				AND NTC.FLTSEQNUM = FLTSEG.FLTSEQNUM(+)
				AND NTC.SEGSERNUM=FLTSEG.SEGSERNUM(+)	
				AND NTC.CMPCOD = LEG.CMPCOD

				AND NTC.FLTNUM

= LEG.FLTNUM
				AND NTC.FLTCARIDR = LEG.FLTCARIDR
				AND NTC.FLTSEQNUM = LEG.FLTSEQNUM
				AND NVL(SEG.POL,FLTSEG.SEGORG) = LEG.LEGORG
				AND NTC.CMPCOD = SHP.CMPCOD
				AND NTC.DOCOWRIDR = SHP.DOCOWRIDR
				AND
NTC.MSTDOCNUM

= SHP.MSTDOCNUM
				AND NTC.DUPNUM = SHP.DUPNUM
				AND NTC.SEQNUM = SHP.SEQNUM
				AND
NTC.CMPCOD
= DGR.CMPCOD
AND NTC.DOCOWRIDR = DGR.DOCOWRIDR
AND NTC.MSTDOCNUM = DGR.MSTDOCNUM
AND NTC.DUPNUM
=
DGR.DUPNUM
AND NTC.SEQNUM    = DGR.SEQNUM
AND NTC.DGRSERNUM    = DGR.SERNUM
				AND NTC.CMPCOD =
?


				AND NTC.FLTNUM = ?
				AND NTC.FLTCARIDR = ?
				AND NTC.FLTSEQNUM = ?
				AND NTC.VERNUM = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>330</QRY:Id>
		<QRY:Source Name="operations.flthandling.findnotocspecialloadhistorydetails" Type="NATIVE">
			<![CDATA[
			SELECT SPLLOD.CMPCOD,
			  SPLLOD.DOCOWRIDR,
			  SPLLOD.MSTDOCNUM,
			  SPLLOD.DUPNUM,
			  SPLLOD.ULDNUM,



			  SPLLOD.NUMPKG,
			  SPLLOD.NETQTY,
			  SPLLOD.SUPINF,
			  SPLLOD.RMK,
			  SPLLOD.FLTCARIDR,


			  SPLLOD.FLTNUM,

			  SPLLOD.FLTSEQNUM,
			  SPLLOD.LEGSERNUM,
			  SPLLOD.SEGSERNUM,

SPLLOD.SEQNUM,
			  SPLLOD.LSTUPDUSR,

			  SPLLOD.LSTUPDTIM,

			  FLTSEG.POL,
			  FLTSEG.POU,

SHP.CAOFLG,
			  SHP.SCCCOD,
			  SHP.SHPPFX,

			  SHP.SHPDES,

			  LEG.TALNUM,
			  SPLLOD.CRGHLD,
			  SPLLOD.POS,
			  SPLLOD.PCSINNULD,
			  SPLLOD.SPLLODCNT,
			  SPLLOD.SPLLODUNT,
			  SPLLOD.SPLLODSCC
			FROM OPRNTCSPLLODHIS
SPLLOD,
			  OPRFLTSEG FLTSEG,
			  OPRSHPMST
SHP,
			  FLTOPRLEG
LEG,
FLTOPRSEG FLTOPRSEG
			WHERE SPLLOD.CMPCOD = FLTSEG.CMPCOD(+)
			
			AND SPLLOD.FLTNUM = FLTSEG.FLTNUM(+)
			
			AND SPLLOD.FLTCARIDR 
= FLTSEG.FLTCARIDR(+)
			AND SPLLOD.FLTSEQNUM 
= FLTSEG.FLTSEQNUM(+)
			AND SPLLOD.SEGSERNUM = FLTSEG.SEGSERNUM(+)
			AND SPLLOD.CMPCOD    = FLTOPRSEG.CMPCOD(+)
			AND SPLLOD.FLTNUM    = FLTOPRSEG.FLTNUM(+)
			AND SPLLOD.FLTCARIDR = FLTOPRSEG.FLTCARIDR(+)
			AND SPLLOD.FLTSEQNUM = FLTOPRSEG.FLTSEQNUM(+)
			AND SPLLOD.SEGSERNUM = FLTOPRSEG.SEGSERNUM(+)
			AND SPLLOD.CMPCOD
= SHP.CMPCOD
			AND

SPLLOD.DOCOWRIDR = SHP.DOCOWRIDR
			AND SPLLOD.MSTDOCNUM = SHP.MSTDOCNUM
			AND
SPLLOD.DUPNUM = SHP.DUPNUM


AND SPLLOD.SEQNUM = SHP.SEQNUM
			AND SPLLOD.CMPCOD = LEG.CMPCOD
			AND
SPLLOD.FLTNUM = LEG.FLTNUM


AND SPLLOD.FLTCARIDR = LEG.FLTCARIDR
			AND SPLLOD.FLTSEQNUM = LEG.FLTSEQNUM

			AND FLTSEG.POL =
LEG.LEGORG

AND SPLLOD.CMPCOD = ?
			AND SPLLOD.FLTNUM = ?
			AND SPLLOD.FLTCARIDR
= ?
			AND SPLLOD.FLTSEQNUM
=
?
			AND SPLLOD.VERNUM = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>331</QRY:Id>
		<QRY:Source Name="operations.flthandling.findNotocDetailsForShipment" Type="NATIVE">
			<![CDATA[
			select NTC.CMPCOD,
			  NTC.DOCOWRIDR,
			  NTC.MSTDOCNUM,
			  NTC.DUPNUM,
			  NTC.SEQNUM,



			  NTC.FLTCARIDR,
			  NTC.FLTNUM,
			  NTC.FLTSEQNUM,
			  NTC.LEGSERNUM,
			  NTC.SERNUM,

NTC.ULDNUM,


			  NTC.UNIIDR,
			  NTC.NUMPKG,
			  NTC.PCSINNULD,
			  NTC.PROSHPNAM PRPSHPNAM,

NTC.ALLPCKSERNUM,


			  NTC.OVRPCKSERNUM,
			  NTC.DGRSERNUM,NTC.LSTUPDTIM,NTC.LSTUPDUSR,LEG.STD FLTDAT,
			  ARLMST.TWOAPHCOD FLTCARCOD,
			  NTC.SCCCOD,NTC.SEGSERNUM,NTC.SHPCLS,
			  NTC.PKGGRP,NTC.RMC,NTC.SUBRSKONE,NTC.SUBRSKTWO,
			  NTC.SUBRSKTHR,NTC.CRGHLD,NTC.POS
			from OPRNTCDGR NTC,FLTOPRMST MST,FLTOPRLEG LEG,
			SHRARLACTMST ARLMST

			where NTC.CMPCOD=MST.CMPCOD
			and NTC.FLTNUM=MST.FLTNUM

and NTC.FLTCARIDR=MST.FLTCARIDR

			and NTC.FLTSEQNUM=MST.FLTSEQNUM
			and NTC.CMPCOD=LEG.CMPCOD

and NTC.FLTNUM=LEG.FLTNUM
			and NTC.FLTCARIDR=LEG.FLTCARIDR

			and NTC.FLTSEQNUM=LEG.FLTSEQNUM

AND NTC.LEGSERNUM=LEG.LEGSERNUM
			AND NTC.CMPCOD=ARLMST.CMPCOD
			AND NTC.FLTCARIDR=ARLMST.ARLIDR
			and NTC.CMPCOD = ?
			and NTC.DOCOWRIDR = ?
			and NTC.MSTDOCNUM =

?
			and NTC.DUPNUM = ?
			and NTC.SEQNUM = ?
			
			
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>332</QRY:Id>
		<QRY:Source Name="operations.flthandling.findNotocFlightHistoryDetails" Type="NATIVE">
			<![CDATA[
			SELECT CMPCOD,
			  FLTCARIDR,
			  FLTNUM,
			  FLTSEQNUM,
			  LEGSERNUM,
			  VERNUM,
			  NTCPRPUSR,
			  POL,
			  
			  LSTUPDUSR,
			  LSTUPDTIM,
			   NTCSTA,
			FINFLG,
			OPRREFCARCOD,
			OPRREFFLTNUM,
			OPRREFFLTDATUTC,
			TILNUM
			FROM OPRNTCFLTHIS
			WHERE FLTNUM = ?
			AND FLTCARIDR = ?
			AND FLTSEQNUM = ?
			AND CMPCOD = ?
			AND VERNUM = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<!-- added by a-5125 for CRQ-ICRD-36091 -->
	<QRY:Definition>
		<QRY:Id>376</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findUCMMessageDetailsForExport" Type="NATIVE">
			<![CDATA[

									select 
									  FLTSEG.CMPCOD,
									  FLTSEG.FLTNUM,
									  FLTSEG.FLTSEQNUM,
									  FLTSEG.FLTCARIDR,
									  FLTSEG.POU,
									  EXPFLT.FLTCARCOD,
									  EXPFLT.FINFLG,
									  SEGULD.ULDNUM,
									  SEGULD.SEGSERNUM,
									  OPRLEG.LEGORG,
									  OPRLEG.LEGDST,
									  EXPFLT.ARPCOD,
									  'OUT' MSGSTA,
									  SUBSTR(SEGULD.ULDNUM,1,3) as ULDTYP,
									 (select THRAPHCOD from SHRARLMST where  cmpcod = SEGULD.CMPCOD  and 
									THRAPHCOD = SUBSTR(SEGULD.ULDNUM,length(SEGULD.ULDNUM)-2,length(SEGULD.ULDNUM))) as THRAPHCOD,
									  (select TWOAPHCOD from SHRARLMST where cmpcod = SEGULD.CMPCOD  and 
									  TWOAPHCOD =  	SUBSTR(SEGULD.ULDNUM,length(SEGULD.ULDNUM)-1,length(SEGULD.ULDNUM))) AS TWOAPHCOD
									  FROM OPRFLTSEG FLTSEG
									   INNER JOIN OPRARPEXPFLT EXPFLT
										ON EXPFLT.CMPCOD = FLTSEG.CMPCOD
										AND	EXPFLT.FLTNUM    = FLTSEG.FLTNUM
										AND EXPFLT.FLTSEQNUM = FLTSEG.FLTSEQNUM
										AND EXPFLT.FLTCARIDR = FLTSEG.FLTCARIDR
										AND EXPFLT.ARPCOD    = FLTSEG.POL
									  INNER JOIN FLTOPRLEG OPRLEG
										ON OPRLEG.CMPCOD     = FLTSEG.CMPCOD
										AND OPRLEG.FLTNUM    = FLTSEG.FLTNUM
										AND OPRLEG.FLTSEQNUM = FLTSEG.FLTSEQNUM
										AND OPRLEG.FLTCARIDR = FLTSEG.FLTCARIDR
										AND OPRLEG.LEGORG   = FLTSEG.POL
									   INNER JOIN OPRSEGULD SEGULD
										ON SEGULD.CMPCOD  = FLTSEG.CMPCOD
										AND SEGULD.FLTNUM    = FLTSEG.FLTNUM
										AND SEGULD.FLTSEQNUM = FLTSEG.FLTSEQNUM
										AND SEGULD.FLTCARIDR = FLTSEG.FLTCARIDR
								     	AND SEGULD.SEGSERNUM =FLTSEG.SEGSERNUM
										WHERE SEGULD.ULDNUM   <>'BULK'
										AND EXPFLT.FINFLG = 'F'
										AND EXPFLT.CMPCOD= ?
														
														AND EXPFLT.FLTNUM= ?
														AND EXPFLT.FLTCARIDR= ?
														AND EXPFLT.FLTSEQNUM= ?
														
														AND EXPFLT.LEGSERNUM= ?
														

														AND EXPFLT.ARPCOD= ?			


			]]>
		</QRY:Source>
	</QRY:Definition>
	<!-- added by a-5125 for CRQ-ICRD-36091 -->
	<QRY:Definition>
		<QRY:Id>377</QRY:Id>
		<QRY:Source Name="operations.flthandling.arrival.findUCMMessageDetailsForImport" Type="NATIVE">
			<![CDATA[
		SELECT OPRLEG.CMPCOD,
  OPRLEG.FLTNUM,
  OPRLEG.FLTSEQNUM,
  OPRLEG.FLTCARIDR,
						  

						  FLTSEG.POL,
						  SEGULD.ULDNUM,
						  SEGULD.SEGSERNUM,	 
  (CASE ARLMST.APHCODUSE
				WHEN 2
				THEN ARLMST.TWOAPHCOD
				ELSE ARLMST.THRAPHCOD
    END) FLTCARCOD,
  OPRLEG.LEGSERNUM,
  OPRLEG.LEGDST ARPCOD,


						  'IN' MSGSTA,


						  OPRLEG.LEGORG,
						  OPRLEG.LEGDST,
		  SUBSTR(SEGULD.ULDNUM,1,3) AS ULDTYP, 
		  (SELECT THRAPHCOD 
		  FROM SHRARLMST 
		  WHERE cmpcod = SEGULD.CMPCOD 
		  AND ACTIND = 'A'
		  AND THRAPHCOD = SUBSTR(SEGULD.ULDNUM,LENGTH(SEGULD.ULDNUM)-2,LENGTH(SEGULD.ULDNUM)) 
		  ) AS THRAPHCOD, 
		  (SELECT TWOAPHCOD 
		  FROM SHRARLMST 
		  WHERE cmpcod = SEGULD.CMPCOD 
		  AND ACTIND = 'A'
		  AND TWOAPHCOD = SUBSTR(SEGULD.ULDNUM,LENGTH(SEGULD.ULDNUM)-1,LENGTH(SEGULD.ULDNUM)) 
		  ) AS TWOAPHCOD 
FROM FLTOPRLEG OPRLEG inner join SHRARLMST arlmst
on OPRLEG.cmpcod = arlmst.cmpcod
and OPRLEG.fltcaridr = arlmst.arlidr
and arlmst.actind = 'A'
left outer join  OPRARPIMPFLT IMPFLT
		ON OPRLEG.CMPCOD = IMPFLT.CMPCOD 
		AND OPRLEG.FLTNUM = IMPFLT.FLTNUM 
		AND OPRLEG.FLTSEQNUM = IMPFLT.FLTSEQNUM 
		AND OPRLEG.FLTCARIDR = IMPFLT.FLTCARIDR 
		AND OPRLEG.LEGDST = IMPFLT.ARPCOD 
and IMPFLT.FLTOPRSTA           <>'C'
		LEFT OUTER JOIN OPRFLTSEG FLTSEG 
ON FLTSEG.CMPCOD     = OPRLEG.CMPCOD
AND FLTSEG.FLTNUM    = OPRLEG.FLTNUM
AND FLTSEG.FLTSEQNUM = OPRLEG.FLTSEQNUM
AND FLTSEG.FLTCARIDR = OPRLEG.FLTCARIDR
AND FLTSEG.POU       = OPRLEG.LEGDST
		LEFT OUTER JOIN OPRSEGULD SEGULD 
ON SEGULD.CMPCOD                   = OPRLEG.CMPCOD
AND SEGULD.FLTNUM                  = OPRLEG.FLTNUM
AND SEGULD.FLTSEQNUM               = OPRLEG.FLTSEQNUM
AND SEGULD.FLTCARIDR               = OPRLEG.FLTCARIDR
		AND SEGULD.SEGSERNUM =FLTSEG.SEGSERNUM 
WHERE COALESCE(SEGULD.BARROWFLG,'N') = 'N'
		AND OPRLEG.CMPCOD                  = ?
		AND OPRLEG.FLTNUM                  = ?
		AND OPRLEG.FLTCARIDR               = ?
		AND OPRLEG.FLTSEQNUM               = ?
		AND OPRLEG.LEGSERNUM               = ?
		AND OPRLEG.LEGDST                  = ?			
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>378</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findFlightDetailsForWAB" Type="NATIVE">
			<![CDATA[
			SELECT FLTLEG.CMPCOD CMPCOD,
			  FLTLEG.FLTNUM FLTNUM,
			  FLTLEG.FLTSEQNUM FLTSEQNUM,
			  FLTLEG.LEGSERNUM

LEGSERNUM,
			  FLTLEG.LEGORG ARPCOD,
			  FLTLEG.FLTCARIDR FLTCARIDR,
			  (CASE ARLMST.APHCODUSE


				WHEN 2
				THEN ARLMST.TWOAPHCOD
				ELSE ARLMST.THRAPHCOD
			  END) FLTCARCOD,
			  FLTLEG.STD
STD,

			  FLTLEG.STDUTC STDUTC,
			  FLTMST.FLTDAT FLTDAT
			FROM FLTOPRLEG FLTLEG ,
			  FLTOPRMST
FLTMST,

			  OPRARPEXPFLT EXPFLT,
			  SHRARLARPPAR ARLPAR,
			  SHRSYSPAR SYSPAR,
			  SHRARLMST
ARLMST
			WHERE
FLTMST.CMPCOD  = FLTLEG.CMPCOD
			AND FLTMST.FLTCARIDR = FLTLEG.FLTCARIDR
			AND FLTMST.FLTSEQNUM
= FLTLEG.FLTSEQNUM

			AND FLTMST.FLTNUM    = FLTLEG.FLTNUM
			AND FLTLEG.LEGORG    = EXPFLT.ARPCOD(+)

AND FLTLEG.FLTCARIDR
= EXPFLT.FLTCARIDR(+)
			AND FLTLEG.FLTSEQNUM = EXPFLT.FLTSEQNUM(+)
			AND FLTLEG.FLTNUM
= EXPFLT.FLTNUM(+)

			AND FLTLEG.CMPCOD    = EXPFLT.CMPCOD(+)
			AND nvl(EXPFLT.FINFLG,'N')   <>
'F'
			AND FLTMST.CMPCOD
= SYSPAR.CMPCOD
			AND SYSPAR.PARCOD    = 'operations.flthandling.wab.timeperiod'

AND SYSPAR.CMPCOD
= ARLPAR.CMPCOD
			AND ARLPAR.PARCOD    = 'operations.flthandling.weightscaleavailable'

AND ARLPAR.PARVAL
= 'Y'
			AND ARLPAR.ARLIDR    = FLTMST.FLTCARIDR
			AND ARLPAR.ARPCOD    = FLTLEG.LEGORG

AND ARLPAR.CMPCOD
= ARLMST.CMPCOD
			AND ARLPAR.ARLIDR    = ARLMST.ARLIDR
			AND sysdate >= FLTLEG.STDUTC
- (.000694
* SYSPAR.PARVAL)
			AND sysdate <= FLTLEG.STDUTC
			AND FLTLEG.CMPCOD =  ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>379</QRY:Id>
		<QRY:Source Name="operation.flithandling.findoperationaluldinstance" Type="NATIVE">
			<![CDATA[
			SELECT MTK.CMPCOD CMPCOD,
			  MTK.CONNUM ULDNUM,
			  MTK.FLTCARIDR FLTCARIDR,
			  (
			  CASE ARLMST.APHCODUSE



				WHEN 2
				THEN ARLMST.TWOAPHCOD
				ELSE ARLMST.THRAPHCOD
			  END) FLTCARCOD,
			  MTK.FLTNUM
FLTNUM,

			  MTK.FLTSEQNUM FLTSEQNUM,
			  MTK.LEGSERNUM LEGSERNUM,
			  MTK.ASGPRT POL,

MTK.POU POU,
			  NULL CNTSERNUM,
			  FLTSEG.SEGSERNUM,
			  NULL AS ULDORG,
			  'MTKULD'ULDTYPE
			FROM OPRFLTSEG FLTSEG,


			  MALFLTCON MTK ,

			  SHRARLMST ARLMST
			WHERE MTK.CMPCOD  = ARLMST.CMPCOD
			AND MTK.FLTCARIDR
= ARLMST.ARLIDR
			AND FLTSEG.CMPCOD(+)    = MTK.CMPCOD
			AND FLTSEG.FLTCARIDR(+) = MTK.FLTCARIDR


			AND FLTSEG.FLTNUM(+)    = MTK.FLTNUM
			AND FLTSEG.FLTSEQNUM(+) = MTK.FLTSEQNUM
			AND FLTSEG.POL(+)
= MTK.ASGPRT
			AND FLTSEG.POU(+)       = MTK.POU
			AND MTK.CMPCOD    = ?
			AND MTK.ASGPRT    = ?


			AND MTK.CONNUM    = ?
			UNION
			SELECT OPR.CMPCOD CMPCOD,
			  OPR.ULDNUM ULDNUM,
			  OPR.FLTCARIDR
FLTCARIDR,
			  (
			  CASE ARLMST.APHCODUSE

				WHEN 2
				THEN ARLMST.TWOAPHCOD
				ELSE ARLMST.THRAPHCOD


			  END) FLTCARCOD,
			  OPR.FLTNUM FLTNUM,

			  OPR.FLTSEQNUM FLTSEQNUM,
			  OPR.LEGSERNUM
LEGSERNUM,

			  OPR.POL POL,
			  OPR.POU POU,
			  NULL CNTSERNUM,
			  FLTSEG.SEGSERNUM,
			  (SELECT SEGFLT.POL
					  FROM OPRSEGULDSHP SEGSHP,
						OPRSEGULDSHP ULDSHP,
						OPRFLTSEG SEGFLT
					  WHERE SEGSHP.CMPCOD  = OPR.CMPCOD
					  AND SEGSHP.FLTNUM    = OPR.FLTNUM
					  AND SEGSHP.FLTCARIDR = OPR.FLTCARIDR
					  AND SEGSHP.FLTSEQNUM = OPR.FLTSEQNUM
					  AND SEGSHP.SEGSERNUM = FLTSEG.SEGSERNUM
					  AND SEGSHP.ULDNUM    = OPR.ULDNUM
					  AND SEGSHP.CMPCOD    = ULDSHP.CMPCOD
					  AND SEGSHP.ULDNUM    = ULDSHP.ULDNUM
					  AND SEGSHP.MSTDOCNUM = ULDSHP.MSTDOCNUM
					  AND SEGSHP.DOCOWRIDR = ULDSHP.DOCOWRIDR
					  AND SEGSHP.DUPNUM    = ULDSHP.DUPNUM
					  AND SEGSHP.SEQNUM    = ULDSHP.SEQNUM
					  AND ULDSHP.CMPCOD    = SEGFLT.CMPCOD
					  AND ULDSHP.FLTNUM    = SEGFLT.FLTNUM
					  AND ULDSHP.FLTCARIDR = SEGFLT.FLTCARIDR
					  AND ULDSHP.FLTSEQNUM = SEGFLT.FLTSEQNUM
					  AND ULDSHP.SEGSERNUM = SEGFLT.SEGSERNUM
					  AND SEGFLT.POU       = FLTSEG.POL
					  AND ROWNUM =1
					  )ULDORG,
'OPRULD' ULDTYPE

			FROM OPRFLTSEG FLTSEG,
			  OPRULDDTL OPR,
			  SHRARLMST ARLMST
			WHERE OPR.CMPCOD
= ARLMST.CMPCOD

			AND OPR.FLTCARIDR = ARLMST.ARLIDR

			AND FLTSEG.CMPCOD(+)    = OPR.CMPCOD

AND FLTSEG.FLTCARIDR(+) = OPR.FLTCARIDR
			AND FLTSEG.FLTNUM(+)    = OPR.FLTNUM
			AND FLTSEG.FLTSEQNUM(+)
= OPR.FLTSEQNUM

			AND FLTSEG.POL(+)       = OPR.POL
			AND FLTSEG.POU(+)       = OPR.POU
			AND
OPR.CMPCOD    = ?
			AND OPR.POL       = ?
			AND OPR.ULDNUM    = ?
			AND NOT EXISTS

			  (SELECT
1
			  FROM OPRDWSBLK DWSBLK
			  WHERE OPR.CMPCOD  = DWSBLK.CMPCOD
			  AND OPR.FLTCARIDR = DWSBLK.FLTCARIDR

AND OPR.FLTNUM    = DWSBLK.FLTNUM
			  AND OPR.FLTSEQNUM = DWSBLK.FLTSEQNUM

			  AND OPR.POL
= DWSBLK.ARPCOD
			  AND OPR.POU       = DWSBLK.POU
			  AND OPR.ULDNUM    = DWSBLK.CNTIDR
			  )

UNION
			SELECT BLK.CMPCOD CMPCOD,
			  BLK.CNTIDR ULDNUM,

			  BLK.FLTCARIDR FLTCARIDR,
			  (

CASE ARLMST.APHCODUSE
				WHEN 2
				THEN ARLMST.TWOAPHCOD

				ELSE ARLMST.THRAPHCOD
			  END) FLTCARCOD,

BLK.FLTNUM FLTNUM,

			  BLK.FLTSEQNUM FLTSEQNUM,

			  BLK.LEGSERNUM LEGSERNUM,
			  BLK.ARPCOD
POL,
			  BLK.POU POU,
			  BLK.CNTSERNUM CNTSERNUM,
			  FLTSEG.SEGSERNUM,

			  (SELECT SEGFLT.POL
					  FROM OPRSEGULDSHP SEGSHP,
						OPRSEGULDSHP ULDSHP,
						OPRFLTSEG SEGFLT
					  WHERE SEGSHP.CMPCOD  = BLK.CMPCOD
					  AND SEGSHP.FLTNUM    = BLK.FLTNUM
					  AND SEGSHP.FLTCARIDR = BLK.FLTCARIDR
					  AND SEGSHP.FLTSEQNUM = BLK.FLTSEQNUM
					  AND SEGSHP.SEGSERNUM = FLTSEG.SEGSERNUM
					  AND SEGSHP.ULDNUM    = BLK.CNTIDR
					  AND BLK.CNTIDR NOT LIKE 'BULK%'
					  AND SEGSHP.CMPCOD    = ULDSHP.CMPCOD
					  AND SEGSHP.ULDNUM    = ULDSHP.ULDNUM
					  AND SEGSHP.MSTDOCNUM = ULDSHP.MSTDOCNUM
					  AND SEGSHP.DOCOWRIDR = ULDSHP.DOCOWRIDR
					  AND SEGSHP.DUPNUM    = ULDSHP.DUPNUM
					  AND SEGSHP.SEQNUM    = ULDSHP.SEQNUM
					  AND ULDSHP.CMPCOD    = SEGFLT.CMPCOD
					  AND ULDSHP.FLTNUM    = SEGFLT.FLTNUM
					  AND ULDSHP.FLTCARIDR = SEGFLT.FLTCARIDR
					  AND ULDSHP.FLTSEQNUM = SEGFLT.FLTSEQNUM
					  AND ULDSHP.SEGSERNUM = SEGFLT.SEGSERNUM
					  AND SEGFLT.POU       = FLTSEG.POL
					  AND ROWNUM =1
					  )ULDORG,
			  'TCON' ULDTYPE

FROM OPRFLTSEG FLTSEG,
			  OPRDWSBLK BLK ,

			  SHRARLMST ARLMST
			WHERE BLK.CMPCOD        =
ARLMST.CMPCOD
			AND BLK.FLTCARIDR       = ARLMST.ARLIDR

			AND FLTSEG.CMPCOD(+)    = BLK.CMPCOD


			AND FLTSEG.FLTCARIDR(+) = BLK.FLTCARIDR
			AND FLTSEG.FLTNUM(+)    = BLK.FLTNUM
			AND FLTSEG.FLTSEQNUM(+)
= BLK.FLTSEQNUM
			AND FLTSEG.POL(+)       = BLK.ARPCOD
			AND FLTSEG.POU(+)       = BLK.POU
			AND BLK.CMPCOD
= ?
			AND BLK.ARPCOD          = ?
			AND BLK.CNTIDR			= ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>380</QRY:Id>
		<QRY:Source Name="operations.flthandling.findExportFlightEnquiryDetailsForHHT" Type="NATIVE">
			<![CDATA[
				SELECT OPRLEG.CMPCOD, OPRLEG.FLTCARIDR, OPRLEG.FLTNUM, OPRLEG.LEGSERNUM, OPRLEG.FLTSEQNUM,OPRLEG.LEGORG


ARPCOD,
				OPRLEG.STD FLTDAT,EXPFLT.FLTCARCOD,OPRMST.FLTROU,SEGULD.ULDNUM,FLTSEG.SEGORG POL ,FLTSEG.SEGDST


POU,SEGULD.ULDDST,EXPFLT.FLTOPRSTA,SEGULD.MFTFLG, SEGULD.BARROWFLG,

				(CASE
	                WHEN

OPRLEG.ATD IS NOT NULL THEN OPRLEG.ATD

	                WHEN OPRLEG.ETD IS NOT NULL THEN OPRLEG.ETD


	                ELSE OPRLEG.STD

				END) DEPTIM,

				(CASE


	                WHEN OPRLEG.ATD IS NOT NULL THEN 'A'

	                WHEN OPRLEG.ETD
IS NOT NULL
THEN 'E'
	                ELSE 'S'
				END) DEPTYPTIM
				FROM FLTOPRLEG
OPRLEG,


	                OPRARPEXPFLT EXPFLT,
			        FLTOPRSEG FLTSEG,
	                OPRSEGULD
SEGULD,


	                FLTOPRMST OPRMST
				WHERE

				OPRLEG.FLTCARIDR = EXPFLT.FLTCARIDR

(+)
				AND OPRLEG.FLTNUM
= EXPFLT.FLTNUM (+)
				AND OPRLEG.FLTSEQNUM = EXPFLT.FLTSEQNUM(+)

AND
OPRLEG.CMPCOD = EXPFLT.CMPCOD(+)

				AND OPRLEG.LEGORG = EXPFLT.ARPCOD(+)

				AND
OPRLEG.FLTCARIDR
= FLTSEG.FLTCARIDR

				AND OPRLEG.FLTNUM = FLTSEG.FLTNUM
				AND OPRLEG.FLTSEQNUM
= FLTSEG.FLTSEQNUM

				AND OPRLEG.CMPCOD
= FLTSEG.CMPCOD
				AND OPRLEG.CMPCOD = FLTSEG.CMPCOD

AND OPRLEG.LEGORG
=FLTSEG.SEGORG


				AND FLTSEG.SEGSERNUM=SEGULD.SEGSERNUM(+)
				AND FLTSEG.FLTCARIDR
= SEGULD.FLTCARIDR(+)

				AND FLTSEG.FLTNUM
= SEGULD.FLTNUM(+)
				AND FLTSEG.FLTSEQNUM = SEGULD.FLTSEQNUM(+)

				AND FLTSEG.CMPCOD
= SEGULD.CMPCOD(+)

				AND FLTSEG.FLTCARIDR = SEGULD.FLTCARIDR(+)


				AND OPRLEG.FLTNUM
= OPRMST.FLTNUM

				AND OPRLEG.FLTSEQNUM =OPRMST.FLTSEQNUM
				AND OPRLEG.FLTCARIDR
= OPRMST.FLTCARIDR

				AND OPRLEG.CMPCOD
= OPRMST.CMPCOD

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>381</QRY:Id>
		<QRY:Source Name="operations.flthandling.findImportFlightEnquiryDetailsForHHT" Type="NATIVE">
			<![CDATA[
				SELECT OPRLEG.CMPCOD, OPRLEG.FLTCARIDR, OPRLEG.FLTNUM, OPRLEG.LEGSERNUM, OPRLEG.FLTSEQNUM,OPRLEG.LEGDST


ARPCOD,
				OPRLEG.STD FLTDAT,IMPFLT.FLTCARCOD,OPRMST.FLTROU,SEGULD.ULDNUM,FLTSEG.SEGORG POL,FLTSEG.SEGDST


POU,SEGULD.ULDDST, IMPFLT.FLTOPRSTA, SEGULD.MFTFLG, SEGULD.BARROWFLG,



	            (CASE
					  WHEN OPRLEG.ATA
IS NOT NULL THEN OPRLEG.ATA
					  WHEN OPRLEG.ETA IS NOT
NULL THEN OPRLEG.ETA

					  ELSE OPRLEG.STA

				END) ARRTIM,

	           (CASE

WHEN OPRLEG.ATA IS NOT
NULL THEN 'A'

					  WHEN OPRLEG.ETA IS NOT NULL THEN 'E'
					  ELSE
'S'
				END) ARRTYPTIM


				FROM 	FLTOPRLEG
OPRLEG,
						OPRARPIMPFLT IMPFLT,

						FLTOPRSEG FLTSEG,

						OPRSEGULD SEGULD,
						FLTOPRMST
OPRMST
				WHERE


OPRLEG.FLTCARIDR = IMPFLT.FLTCARIDR (+)

					AND OPRLEG.FLTNUM = IMPFLT.FLTNUM(+)

					AND OPRLEG.FLTSEQNUM
= IMPFLT.FLTSEQNUM(+)
					AND
OPRLEG.CMPCOD = IMPFLT.CMPCOD(+)
					AND
OPRLEG.LEGDST = IMPFLT.ARPCOD(+)


					AND OPRLEG.FLTCARIDR
= FLTSEG.FLTCARIDR
					AND OPRLEG.FLTNUM
= FLTSEG.FLTNUM
					AND OPRLEG.FLTSEQNUM
= FLTSEG.FLTSEQNUM

					AND OPRLEG.CMPCOD = FLTSEG.CMPCOD

					AND OPRLEG.CMPCOD = FLTSEG.CMPCOD



					AND FLTSEG.SEGSERNUM=SEGULD.SEGSERNUM(+)


					AND FLTSEG.FLTCARIDR = SEGULD.FLTCARIDR(+)

					AND FLTSEG.FLTNUM = SEGULD.FLTNUM(+)
					AND

FLTSEG.FLTSEQNUM = SEGULD.FLTSEQNUM(+)
					AND
FLTSEG.CMPCOD = SEGULD.CMPCOD(+)
					AND FLTSEG.FLTCARIDR

= SEGULD.FLTCARIDR(+)

					AND OPRLEG.FLTNUM
= OPRMST.FLTNUM
					AND OPRLEG.FLTSEQNUM = OPRMST.FLTSEQNUM


					AND OPRLEG.FLTCARIDR = OPRMST.FLTCARIDR

					AND OPRLEG.CMPCOD = OPRMST.CMPCOD

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>382</QRY:Id>
		<QRY:Source Name="operations.flthandling.findflightdetailsforuldhht" Type="NATIVE">
			<![CDATA[

				SELECT ULD.CMPCOD ULDCMPCOD,
				  ULD.ULDNUM ULDULDNUM,
				  ULD.FLTCARIDR ULDFLTCARIDR,


				  ULD.FLTNUM ULDFLTNUM,
				  ULD.FLTSEQNUM ULDFLTSEQNUM,
				  ULD.POL ULDPOL,
				  FLTLEG.STD STD,
				  COALESCE(ULD.POU,ARPULD.POU) 

ULDPOU,
				  ULD.CLSFLG ULDCLSFLG,
				  ULD.LEGSERNUM ULDLEGSERNUM,
				  EXPFLT.FLTDAT EXPFLTFLTDAT,


				  EXPFLT.FLTSEQNUM EXPFLTFLTSEQNUM,
				  (
				  CASE ARLMST.APHCODUSE
				    WHEN 2
				    THEN
ARLMST.TWOAPHCOD

				    ELSE ARLMST.THRAPHCOD
				  END) FLTCARCOD,
				  COALESCE(EXPFLT.ARPCOD,ARPULD.ARPCOD)
ARPCOD,

				  SEGULD.THRUNT,
				  COALESCE(DWSBLK.ACTWGT,SEGULD.ACTWGT,ARPULD.ACTWGT) ACTWGT,
				  COALESCE(SEGULD.ULDOCP,ARPULD.ULDOCP) ULDOCP,
COALESCE(SEGULD.ULDDST,ARPULD.ULDDST)
ULDDST,
				  COALESCE(SEGULD.ULDCTR,ARPULD.ULDCTR) ULDCTR,

FLTOPRSTA,
				  SEGULD.MFTFLG ULDMFTFLG,
				  SEGULD.BDPFLG,
				  SEGULD.BDPCMPSTA,
				  SEGULD.RCVFLG,

SEGULD.ULDNUM SEGULDNUM,
				  ARPULD.ULDNUM ARPULDNUM,
				  SEGULD.BSEFLG,
				  SEGULD.BSEPLT,

COALESCE(SEGULD.BARROWFLG,ARPULD.BRWFLG) BARROWFLG,
				  SEGULD.SEGSERNUM,
				  SEGULD.LSTUPDTIM ULDLSTUPDTIM,

OPRMST.FLTTYP
				FROM OPRULDDTL ULD
				INNER JOIN SHRARLMST ARLMST
				ON ULD.CMPCOD     = ARLMST.CMPCOD


				AND ULD.FLTCARIDR = ARLMST.ARLIDR
				LEFT OUTER JOIN OPRARPEXPFLT EXPFLT
				ON ULD.CMPCOD
= EXPFLT.CMPCOD

				AND ULD.POL       = EXPFLT.ARPCOD
				AND ULD.FLTCARIDR = EXPFLT.FLTCARIDR

AND ULD.FLTNUM    = EXPFLT.FLTNUM

				AND ULD.FLTSEQNUM = EXPFLT.FLTSEQNUM

				LEFT OUTER JOIN
FLTOPRMST OPRMST
				ON ULD.CMPCOD = OPRMST.CMPCOD

				AND ULD.FLTCARIDR = OPRMST.FLTCARIDR

AND ULD.FLTNUM    = OPRMST.FLTNUM
				AND ULD.FLTSEQNUM = OPRMST.FLTSEQNUM


				LEFT OUTER JOIN
OPRFLTSEG FLTSEG
				ON ULD.CMPCOD     = FLTSEG.CMPCOD
				AND ULD.FLTCARIDR = FLTSEG.FLTCARIDR


AND ULD.FLTNUM    = FLTSEG.FLTNUM
				AND ULD.FLTSEQNUM = FLTSEG.FLTSEQNUM
				AND ULD.POL       = FLTSEG.POL

AND ULD.POU      = FLTSEG.POU
				LEFT OUTER JOIN OPRSEGULD SEGULD
				ON FLTSEG.CMPCOD     = SEGULD.CMPCOD

AND FLTSEG.FLTCARIDR =
SEGULD.FLTCARIDR
				AND FLTSEG.FLTNUM    = SEGULD.FLTNUM
				AND FLTSEG.FLTSEQNUM
= SEGULD.FLTSEQNUM

AND FLTSEG.SEGSERNUM = SEGULD.SEGSERNUM
				AND ULD.ULDNUM       = SEGULD.ULDNUM

LEFT OUTER JOIN
OPRDWSBLK DWSBLK
				ON EXPFLT.CMPCOD     = DWSBLK.CMPCOD
				AND EXPFLT.FLTCARIDR =
DWSBLK.FLTCARIDR

				AND EXPFLT.FLTNUM    = DWSBLK.FLTNUM
				AND EXPFLT.FLTSEQNUM = DWSBLK.FLTSEQNUM

AND EXPFLT.LEGSERNUM
= DWSBLK.LEGSERNUM
				AND EXPFLT.ARPCOD    =DWSBLK.ARPCOD
				AND ULD.ULDNUM
= DWSBLK.CNTIDR

				LEFT OUTER JOIN OPRARPULD ARPULD
				ON ULD.CMPCOD    = ARPULD.CMPCOD
				AND
ULD.POL      = ARPULD.ARPCOD

				AND ULD.ULDNUM   = ARPULD.ULDNUM
				WHERE ULD.CMPCOD = ?
				AND
ULD.ULDNUM   = ?



			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>383</QRY:Id>
		<QRY:Source Name="operations.flthandling.findshipmentsinuldfromflightforhht" Type="NATIVE">
			<![CDATA[
			SELECT MST.SHPPFX, MST.MSTDOCNUM, MST.SEQNUM, MST.DUPNUM, MST.DOCOWRIDR,
				MST.STDPCS, MST.STDWGT,MST.STDWGTCOD,




				NVL(SEGSHP.BDPPCS-SEGSHP.RCVPCS,0) BDPPCS,
				NVL(SEGSHP.BDPWGT-SEGSHP.RCVWGT,0) BDPWGT,
				NVL(SEGSHP.MFTPCS-SEGSHP.RCVPCS,0)


MFTPCS,
				NVL(SEGSHP.MFTWGT-SEGSHP.RCVWGT,0) MFTWGT,
				COUNT(SEGSHP.MSTDOCNUM) AWBCOUNT,

				SEGSHP.RCVPCS,SEGSHP.RCVWGT,MST.SCCCOD,



				MST.SHPDES,SEGULD.ULDNUM,SEGULD.MFTFLG,SEGULD.RCVFLG,SEGULD.BDPFLG,
				FLTSEG.POL, FLTSEG.POU,


MST.ORGCOD, MST.DSTCOD,SEGULD.FLTNUM,SEGULD.FLTSEQNUM,SEGULD.FLTCARIDR,RMPULD.RMPHDLTYP,

				SUM(
NVL(SEGSHP.BDPPCS-SEGSHP.RCVPCS,0)

) SUMBDPPCS,
				SUM( NVL(SEGSHP.MFTPCS-SEGSHP.RCVPCS,0) ) SUMMFTPCS,

SUM( NVL(SEGSHP.BDPWGT-SEGSHP.RCVWGT,0)

) SUMBDPWGT,
				SUM( NVL(SEGSHP.MFTWGT-SEGSHP.RCVWGT,0) )
SUMMFTWGT,
				SUM(NVL(SEGSHP.RCVPCS,0) )

SUMRCVPCS


			FROM OPRSEGULD SEGULD,
				OPRSEGULDSHP
SEGSHP,
				OPRSHPMST MST,
				OPRFLTSEG

FLTSEG ,WHSRMPULD RMPULD
			WHERE SEGULD.FLTNUM = SEGSHP.FLTNUM

				AND SEGULD.FLTSEQNUM = SEGSHP.FLTSEQNUM


				AND SEGULD.FLTCARIDR = SEGSHP.FLTCARIDR
				AND
SEGULD.CMPCOD = SEGSHP.CMPCOD
				AND SEGULD.ULDNUM

= SEGSHP.ULDNUM
				AND MST.MSTDOCNUM = SEGSHP.MSTDOCNUM

				AND MST.SEQNUM = SEGSHP.SEQNUM
				AND

MST.DUPNUM = SEGSHP.DUPNUM
				AND MST.DOCOWRIDR = SEGSHP.DOCOWRIDR

				AND MST.CMPCOD = SEGSHP.CMPCOD



				AND SEGULD.FLTNUM = FLTSEG.FLTNUM
				AND SEGULD.FLTSEQNUM
= FLTSEG.FLTSEQNUM
				AND SEGULD.FLTCARIDR

= FLTSEG.FLTCARIDR
				AND SEGULD.CMPCOD = FLTSEG.CMPCOD

				AND SEGULD.SEGSERNUM = FLTSEG.SEGSERNUM


				AND (SEGULD.ULDSTA IS NULL OR SEGULD.ULDSTA <> 'C')


				AND SEGULD.CMPCOD = RMPULD.CMPCOD(+)


				AND SEGULD.ULDNUM = RMPULD.ULDNUM(+)
				AND
SEGULD.FLTNUM = RMPULD.FLTNUM(+)
				AND SEGULD.FLTSEQNUM

= RMPULD.FLTSEQNUM(+)
				AND SEGULD.FLTCARIDR
= RMPULD.FLTCARIDR(+)
				AND RMPULD.ARPCOD(+)=?




				AND SEGULD.CMPCOD = ?
				AND SEGULD.ULDNUM
= ?
				AND SEGULD.FLTNUM=?
				AND SEGULD.FLTSEQNUM=?


				AND SEGULD.FLTCARIDR=?



			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>384</QRY:Id>
		<QRY:Source Name="operations.flthandling.findshipmentsinuldatairportforhht" Type="NATIVE">
			<![CDATA[

			SELECT MST.SHPPFX, MST.MSTDOCNUM, MST.SEQNUM, MST.DUPNUM, MST.DOCOWRIDR,
				MST.STDPCS, MST.STDWGT,


MST.STDWGTCOD,ULDSHP.NUMPCS,ULDSHP.WGT,MST.SCCCOD,
				MST.SHPDES, ARPULD.ULDNUM,ARPULD.ARPCOD POL,


ARPULD.POU, MST.ORGCOD, MST.DSTCOD ,
				COUNT(ULDSHP.MSTDOCNUM) AWBCOUNT,SUM(NVL(ULDSHP.NUMPCS,0)

)
TOTPCS,SUM(NVL(ULDSHP.WGT,0) ) TOTWGT
			FROM OPRARPULD ARPULD,
				OPRULDSHP ULDSHP,
				OPRSHPMST


MST

			WHERE ARPULD.ULDNUM = ULDSHP.ULDNUM AND
			ARPULD.ARPCOD = ULDSHP.ARPCOD AND
				ARPULD.CMPCOD


= ULDSHP.CMPCOD AND
				MST.MSTDOCNUM = ULDSHP.MSTDOCNUM
				AND MST.SEQNUM = ULDSHP.SEQNUM

AND

MST.DUPNUM = ULDSHP.DUPNUM
				AND MST.DOCOWRIDR = ULDSHP.DOCOWRIDR
				AND MST.CMPCOD = ULDSHP.CMPCOD




				AND ARPULD.CMPCOD = ?
				AND ARPULD.ULDNUM = ?
				AND ARPULD.ARPCOD=?




			]]>
		</QRY:Source>
	</QRY:Definition>
	<!-- Modified by A-5290 for ICRD-73444 fetching ULD.BKGTYP -->
	<!-- Modified by A-5290 for ICRD-124039 fetching SEG.POL -->
	<!--Added by A-4772 for ICRD-19647 starts here-->
	<QRY:Definition>
		<QRY:Id>385</QRY:Id>
		<QRY:Source Name="operations.flthandling.findshipmentsanduldforimportflight" Type="NATIVE">
			<![CDATA[

				 SELECT ULD.CMPCOD ULDCMPCOD,
                                  ULD.FLTCARIDR ULDFLTCARIDR,



                                  ULD.FLTNUM ULDFLTNUM,
                                  ULD.FLTSEQNUM

ULDFLTSEQNUM,

                                  ULD.SEGSERNUM ULDSEGSERNUM,


                                  ULD.ULDNUM ULDULDNUM,
                                   ULD.BDNITN

BDNITN,
								    
                                  (CASE ARLMST.APHCODUSE


                                   WHEN 2


THEN ARLMST.TWOAPHCOD

                                   ELSE ARLMST.THRAPHCOD


                                   END) FLTCARCOD,


ULD.GRSWGT GRSWGT,

                                  ULD.NETWGT NETWGT,


                                  ULD.THRUNT THRUNT,



                                  ULD.ULDCTR ULDCTR,
                                  ULD.TARWGT TARWGT,



                                  ULD.RMK ULDRMK,
								  ULD.ULDBKGIDR ULDBOOKINGID,
			                     ( CASE WHEN   ULD.ULDDST IS NULL
								THEN (SELECT  ULDBKGMST.DSTCOD  FROM CAPULDBKGMST ULDBKGMST 
											WHERE  ULDBKGMST.ULDBKGIDR =   ULD.ULDBKGIDR AND ULDBKGMST.BKGSTA <> 'XX' AND ULDBKGMST.CMPCOD =ULD.CMPCOD)
								ELSE ULD.ULDDST END) ULDDST,
			                    SHPMST.ORGCOD,


SHPMST.DSTCOD,
                  					SHPMST.STDPCS,

									SHPMST.STDWGT,
									SHPMST.GRSVOL,

SHP.CUSREF SHPCUSREF,


                                  SHP.MFTPCS
SHPPCS,
                                  SHP.MFTWGT SHPWGT,



SHP.MFTVOL SHPVOL,
                                  SHP.FLTCARIDR
SHPFLTCARIDR,


                                  SHP.FLTNUM SHPFLTNUM,

SHP.FLTSEQNUM
SHPFLTSEQNUM,

                                  SHP.SEGSERNUM SHPSEGSERNUM,


SHP.ULDNUM SHPULDNUM,


SHP.DOCOWRIDR SHPDOCOWRIDR,

SHP.MSTDOCNUM SHPMSTDOCNUM,


                                  SHP.DUPNUM SHPDUPNUM,

SHP.SEQNUM
SHPSEQNUM,

                                  SHP.RMK SHPRMK,


                                  SHP.CMPCOD SHPCMPCOD,

                                  SHP.LODPRT
LODPRT,


                                  SHP.RCVPCS
SHPRCVPCS,
                                  SHP.RCVWGT
SHPRCVWGT,


                                  SHP.RCVVOL SHPRCVVOL,

                                  SHP.SLCPCS
MFTSLCPCS ,
								  SEG.POU
,
								  SEGSHP.SHPPFX
SHPPFX    ,
								  ULD.BUPFLG BUPFLG,

ULD.ULDOCP ULDOCP,
								  ULD.INRSTWLSS INRSTWLSS,

								  ULD.ACTWGT ULDACTWGT,

ULD.LSTUPDTIM LSTUPDTIM,
								  ULD.BKGTYP BKGTYP,


								  MST.FLTDAT MSTFLTDAT,
								  SEG.POL


                                FROM OPRFLTSEG
SEG
                                INNER JOIN FLTOPRLEG
OPRLEG


ON  SEG.CMPCOD =  OPRLEG.CMPCOD

AND SEG.FLTCARIDR =  OPRLEG.FLTCARIDR



AND SEG.FLTNUM = OPRLEG.FLTNUM
                                AND SEG.FLTSEQNUM
= OPRLEG.FLTSEQNUM


                                AND SEG.POL = OPRLEG.LEGORG



INNER JOIN OPRSEGULD ULD
                                ON SEG.FLTCARIDR
= ULD.FLTCARIDR


AND SEG.FLTNUM = ULD.FLTNUM

AND SEG.FLTSEQNUM = ULD.FLTSEQNUM


AND SEG.SEGSERNUM = ULD.SEGSERNUM

                                AND SEG.CMPCOD = ULD.CMPCOD

INNER
JOIN FLTOPRMST MST
								ON SEG.FLTCARIDR
= MST.FLTCARIDR

AND SEG.FLTNUM
= MST.FLTNUM

                                AND SEG.FLTSEQNUM = MST.FLTSEQNUM


AND SEG.CMPCOD = MST.CMPCOD


LEFT
OUTER JOIN
                                SHRARLMST ARLMST ON


ULD.CMPCOD
= ARLMST.CMPCOD
                                AND  ULD.FLTCARIDR = ARLMST.ARLIDR



LEFT OUTER JOIN OPRSEGULDSHP SHP
                                ON ULD.FLTCARIDR = SHP.FLTCARIDR



AND ULD.FLTNUM = SHP.FLTNUM
                                AND ULD.FLTSEQNUM
= SHP.FLTSEQNUM


AND ULD.SEGSERNUM = SHP.SEGSERNUM

AND ULD.CMPCOD = SHP.CMPCOD


AND ULD.ULDNUM = SHP.ULDNUM

LEFT OUTER JOIN OPRSEGSHP SEGSHP


ON SHP.DOCOWRIDR = SEGSHP.DOCOWRIDR

                                AND SHP.MSTDOCNUM = SEGSHP.MSTDOCNUM



AND SHP.DUPNUM = SEGSHP.DUPNUM
                                AND

SHP.SEQNUM = SEGSHP.SEQNUM

AND SHP.CMPCOD = SEGSHP.CMPCOD


AND SHP.FLTCARIDR = SEGSHP.FLTCARIDR

                                AND SHP.FLTNUM = SEGSHP.FLTNUM


                                AND
SHP.FLTSEQNUM = SEGSHP.FLTSEQNUM
								AND SHP.SEGSERNUM = SEGSHP.SEGSERNUM



LEFT OUTER JOIN OPRSHPMST SHPMST
                                ON SHPMST.DOCOWRIDR = SEGSHP.DOCOWRIDR



                                AND SHPMST.MSTDOCNUM = SEGSHP.MSTDOCNUM



AND SHPMST.DUPNUM = SEGSHP.DUPNUM
                                AND SHPMST.SEQNUM = SEGSHP.SEQNUM



                                AND SHPMST.CMPCOD = SEGSHP.CMPCOD


WHERE
ULD.CMPCOD = ?

                                AND ULD.FLTCARIDR = ?



AND ULD.FLTNUM = ?
                                AND ULD.FLTSEQNUM = ?
								AND SEG.POU = ?



                                ORDER BY SHP.ULDNUM,SHP.DOCOWRIDR,SHP.MSTDOCNUM,SHP.DUPNUM,SHP.SEQNUM






			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>386</QRY:Id>
		<QRY:Source Name="operations.flthandling.findassignementdetailsforuldforhht" Type="NATIVE">
			<![CDATA[

					 SELECT ULD.CMPCOD ULDCMPCOD,
					   ULD.ULDNUM ULDULDNUM,
					   MST.FLTCARIDR ULDFLTCARIDR,

MST.FLTNUM ULDFLTNUM,
					   MST.FLTSEQNUM ULDFLTSEQNUM,
					   FLTSEG.POL ULDPOL,
					   FLTSEG.POU
ULDPOU,
					   ULD.CLSFLG ULDCLSFLG,
					   ULD.LEGSERNUM ULDLEGSERNUM,
					   (
					   CASE ARLMST.APHCODUSE

WHEN 2
					     THEN ARLMST.TWOAPHCOD
					     ELSE ARLMST.THRAPHCOD
					   END) FLTCARCOD,

ARPULD.ARPCOD ARPCOD,
					   SEGULD.THRUNT,
					   COALESCE(SEGULD.ACTWGT,ARPULD.ACTWGT) ACTWGT,

COALESCE(SEGULD.ULDDST,ARPULD.ULDDST) ULDDST,
					   COALESCE(SEGULD.ULDCTR,ARPULD.ULDCTR) ULDCTR,

SEGULD.MFTFLG ULDMFTFLG,
					   SEGULD.BDPFLG,
					   SEGULD.RCVFLG,
					   SEGULD.ULDNUM SEGULDNUM,

ARPULD.ULDNUM ARPULDNUM,
					   SEGULD.BARROWFLG,
					   MST.FLTDAT EXPFLTFLTDAT
					 FROM OPRULDDTL
ULD
					 INNER JOIN SHRARLMST ARLMST
					 ON ULD.CMPCOD     = ARLMST.CMPCOD
					 AND ULD.FLTCARIDR
= ARLMST.ARLIDR
					 LEFT OUTER JOIN FLTOPRMST MST
					 ON ULD.CMPCOD     = MST.CMPCOD



					           	AND ULD.FLTCARIDR = MST.FLTCARIDR

					           	AND ULD.FLTNUM =
MST.FLTNUM
					AND ULD.FLTSEQNUM = MST.FLTSEQNUM
					 LEFT OUTER JOIN OPRFLTSEG FLTSEG
					 ON ULD.CMPCOD
= FLTSEG.CMPCOD
					 AND ULD.FLTCARIDR = FLTSEG.FLTCARIDR
					 AND ULD.FLTNUM    = FLTSEG.FLTNUM

AND ULD.FLTSEQNUM = FLTSEG.FLTSEQNUM
					 AND ULD.POL       = FLTSEG.POL
					 AND ULD.POU       = FLTSEG.POU

LEFT OUTER JOIN OPRSEGULD SEGULD
					 ON FLTSEG.CMPCOD     = SEGULD.CMPCOD
					 AND FLTSEG.FLTCARIDR
= SEGULD.FLTCARIDR
					 AND FLTSEG.FLTNUM    = SEGULD.FLTNUM
					 AND FLTSEG.FLTSEQNUM = SEGULD.FLTSEQNUM

AND FLTSEG.SEGSERNUM = SEGULD.SEGSERNUM
					 AND ULD.ULDNUM       = SEGULD.ULDNUM
					 LEFT OUTER JOIN
OPRARPULD ARPULD
					 ON ULD.CMPCOD    = ARPULD.CMPCOD
					 AND ULD.POL      = ARPULD.ARPCOD

AND ULD.ULDNUM   = ARPULD.ULDNUM
					AND (ULD.CLSFLG IS NULL
					OR ULD.CLSFLG   <> 'Y')

WHERE ULD.CMPCOD = ?







AND ULD.ULDNUM = ?


			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>387</QRY:Id>
		<QRY:Source Name="operations.flthandling.findshorthaulflightsforffmsend" Type="NATIVE">
			<![CDATA[
	WITH SHTHALSPCCFG AS
			  (SELECT orgleg.LEGORG,
				dstleg.LEGDST,
    MST.FLTDAT,
    EXPFLT.FLTCARCOD,


				orgleg.LEGSERNUM,
    MST.FLTCARIDR,
    MST.FLTNUM,
    MST.FLTSEQNUM,
    MST.FLTROU,
    SHTHALMST.MSGTYP,


				SHTHALMST.MSGTRGTIM,
    SHTHALMST.SHTHALTIM,
    MST.FLTSTA,
    EXPFLT.FINFLG,
				dstleg.STA,


				dstleg.STAUTC,
				dstleg.ETA,
				orgleg.ATA,
				orgleg.STD,
				orgleg.STDUTC,
				orgleg.ETD,


				orgleg.etd + (orgleg.etd-orgleg.std) ETDUTC,
				orgleg.atd + (orgleg.stdutc-orgleg.std) ATDUTC,


				orgleg.ATD,
    EXPFLT.SHTHALMSGFLG,
    EXPFLT.ARPCOD
  FROM OPRSHTHALRTGMST SHTHALMST,
				OPRARPEXPFLT

EXPFLT ,
				FLTOPRMST MST,
				fltoprleg orgleg,
				fltoprleg dstleg
			  WHERE MST.FLTNUM

= orgleg.FLTNUM
			  AND MST.FLTSEQNUM        = orgleg.FLTSEQNUM
			  AND MST.FLTCARIDR        = orgleg.FLTCARIDR


			  AND MST.CMPCOD           = orgleg.CMPCOD
			  AND MST.CMPCOD           = dstleg.CMPCOD
			  AND
MST.FLTNUM
= dstleg.FLTNUM
			  AND MST.FLTCARIDR        = dstleg.FLTCARIDR
			  AND MST.FLTSEQNUM
= dstleg.FLTSEQNUM

			  AND orgleg.CMPCOD           = EXPFLT.CMPCOD(+)
			  AND orgleg.FLTNUM           = EXPFLT.FLTNUM(+)
			
			  AND orgleg.FLTCARIDR        = EXPFLT.FLTCARIDR(+)
			  AND orgleg.FLTSEQNUM        = EXPFLT.FLTSEQNUM(+)
			  AND orgleg.LEGSERNUM        = EXPFLT.LEGSERNUM(+)
			  AND orgleg.legorg        = EXPFLT.ARPCOD(+)
			
			  AND orgleg.CMPCOD    = SHTHALMST.CMPCOD
			  AND orgleg.legorg        = SHTHALMST.LEGORG
			  AND dstleg.legdst        = SHTHALMST.LEGDST

			  AND ( SHTHALMST.FLTNUM  IS NOT NULL
			  AND SHTHALMST.FLTCARIDR  > 0
			  AND mst.FLTNUM           = SHTHALMST.FLTNUM
			  AND mst.FLTCARIDR        = SHTHALMST.FLTCARIDR

AND (SHTHALMST.FLTSEQNUM =
0
			  OR mst.FLTSEQNUM         = SHTHALMST.FLTSEQNUM ) )
			  )
			SELECT
LEGORG,
			  LEGDST,

			  FLTDAT,
			  FLTCARCOD,
			  LEGSERNUM,
			  ARPCOD,
			  FLTCARIDR,

FLTNUM,
			  FLTSEQNUM,

			  FLTROU,
			  MSGTYP,
			  MSGTRGTIM,
			  SHTHALTIM,
			  STA,

STAUTC,
			  ETA,
			  ATA,

			  STD,
			  STDUTC,
			  ETD,
			  ETDUTC,
			  ATD,
			  ATDUTC,

SHTHALMSGFLG,
			  FLTSTA,

FINFLG,
			  TO_DATE (TO_CHAR (SYS_EXTRACT_UTC(SYSTIMESTAMP) , 'dd/mm/yyyy
hh24:mi:ss') , 'dd/mm/yyyy
hh24:mi:ss') CurentiemUTC,
			  (TO_DATE (TO_CHAR (SYS_EXTRACT_UTC(SYSTIMESTAMP)
, 'dd/mm/yyyy hh24:mi:ss')
, 'dd/mm/yyyy hh24:mi:ss') - TO_DATE (
			  CASE
				WHEN stdUTC <= NVL(etdUTC,stdUTC)

THEN stdUTC

ELSE
				  CASE
					WHEN etdUTC <= NVL(atdUTC,etdUTC)
					THEN etdUTC
					ELSE atdUTC

END

  END ))*24*60 locTIM ,
  MSGTRGTIM ,
  (TO_DATE (STAUTC) -TO_DATE (STDUTC))*(24*60) Diff ,


  SHTHALTIM
FROM
  (SELECT LEGORG,
    LEGDST,
    FLTDAT,
    FLTCARCOD,
    LEGSERNUM,
    ARPCOD,


    FLTCARIDR,
    FLTNUM,
    FLTSEQNUM,
    FLTROU,
    MSGTYP,
    MSGTRGTIM,
    SHTHALTIM,

STA,

    STAUTC,
    ETA,
    ATA,
    STD,
    STDUTC,
    ETD,
    ETDUTC,
    ATD,
    ATDUTC,

SHTHALMSGFLG,

    FLTSTA,
    FINFLG
  FROM SHTHALSPCCFG
  UNION ALL
  SELECT LEGORG,
    LEGDST,

FLTDAT,

    FLTCARCOD,
    LEGSERNUM,
    ARPCOD,
    FLTCARIDR,
    FLTNUM,
    FLTSEQNUM,

FLTROU,
    MSGTYP,

    MSGTRGTIM,
    SHTHALTIM,
    STA,
    STAUTC,
    ETA,
    ATA,
    STD,

STDUTC,
    ETD,
    ETDUTC,

    ATD,
    ATDUTC,
    SHTHALMSGFLG,
				FLTSTA,
				FINFLG

FROM
				(SELECT orgleg.LEGORG,

				  dstleg.LEGDST,
				  MST.FLTDAT,
				  EXPFLT.FLTCARCOD,

EXPFLT.LEGSERNUM,
				  EXPFLT.ARPCOD,

				  MST.FLTCARIDR,
				  MST.FLTNUM,
				  MST.FLTSEQNUM,

MST.FLTROU,
				  SHTHALMST.MSGTYP,

				  SHTHALMST.MSGTRGTIM,
				  SHTHALMST.SHTHALTIM,

MST.FLTSTA,
				  EXPFLT.FINFLG,
				  dstleg.STA,

				  dstleg.STAUTC,
				  dstleg.ETA,

dstleg.ATA,
				  orgleg.STD,
				  orgleg.STDUTC,
				  orgleg.ETD,

				  orgleg.ATD,
				  orgleg.etd
+ (orgleg.stdutc-orgleg.std) ETDUTC,
				  orgleg.atd + (orgleg.stdutc-orgleg.std)
ATDUTC,
      EXPFLT.SHTHALMSGFLG

FROM OPRSHTHALRTGMST SHTHALMST,
				  fltoprleg orgleg,
				  fltoprleg
dstleg,
				  OPRARPEXPFLT EXPFLT
,
				  FLTOPRMST MST
				WHERE MST.FLTNUM       = orgleg.FLTNUM

				AND MST.FLTSEQNUM      = orgleg.FLTSEQNUM

AND MST.FLTCARIDR      = orgleg.FLTCARIDR
				AND MST.cmpcod
= orgleg.cmpcod
				AND MST.CMPCOD
= dstleg.CMPCOD
				AND MST.FLTNUM         = dstleg.FLTNUM

AND MST.FLTCARIDR      = dstleg.FLTCARIDR

AND MST.FLTSEQNUM      = dstleg.FLTSEQNUM
				AND MST.CMPCOD
= EXPFLT.CMPCOD
				AND MST.FLTNUM
= EXPFLT.FLTNUM
				AND MST.FLTCARIDR      = EXPFLT.FLTCARIDR

				AND MST.FLTSEQNUM      = EXPFLT.FLTSEQNUM

AND SHTHALMST.LEGORG   = EXPFLT.ARPCOD
				AND orgleg.CMPCOD
= SHTHALMST.CMPCOD
				AND orgleg.legorg
= SHTHALMST.LEGORG
				AND dstleg.legdst      = SHTHALMST.LEGDST

    AND (SHTHALMST.FLTNUM IS NULL
)
    )SHTHALCFG
			  WHERE (SHTHALCFG.FLTNUM,SHTHALCFG.FLTCARIDR,SHTHALCFG.FLTSEQNUM)
NOT IN
    (SELECT
FLTNUM,FLTCARIDR,FLTSEQNUM FROM SHTHALSPCCFG
    )
  )
			WHERE NVL(SHTHALMSGFLG,'N')
<> 'Y'
AND FLTSTA
<> 'CAN'
AND NVL(FINFLG,'N')         <> 'F'
AND (
  CASE

    WHEN stdUTC <= NVL(etdUTC,stdUTC)

THEN stdUTC
    ELSE
      CASE
        WHEN etdUTC <= NVL(atdUTC,etdUTC)

        THEN etdUTC

ELSE atdUTC
      END
			  END       - TO_DATE (TO_CHAR (SYS_EXTRACT_UTC(SYSTIMESTAMP)
, 'dd/mm/yyyy
hh24:mi:ss') , 'dd/mm/yyyy hh24:mi:ss')) *(24*60) <= MSGTRGTIM
			AND (STAUTC -STDUTC)*(24*60)
<= SHTHALTIM
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>388</QRY:Id>
		<QRY:Source Name="operations.flthandling.validateshorthaulflights" Type="NATIVE">
			<![CDATA[
		SELECT SHTHALMST.CMPCOD,
		  SHTHALMST.LEGORG,
		  SHTHALMST.LEGDST,
		  SHTHALMST.MSGTRGTIM,
		  SHTHALMST.FLTNUM,
		  SHTHALMST.FLTCARIDR,
		  SHTHALMST.FLTSEQNUM,
		  SHTHALMST.MSGTYP
			FROM OPRSHTHALRTGMST SHTHALMST,
			FLTOPRLEG LEG
			WHERE LEG.CMPCOD     = SHTHALMST.CMPCOD
			AND LEG.LEGORG       = SHTHALMST.LEGORG
			AND LEG.LEGDST       = SHTHALMST.LEGDST
			AND SHTHALMST.CMPCOD = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<!--Added by A-5117 for ICRD-31277 starts here-->
	<QRY:Definition>
		<QRY:Id>389</QRY:Id>
		<QRY:Source Name="operations.flthandling.findDataForCarrierCertificate" Type="NATIVE">
			<![CDATA[
	SELECT DISTINCT
  MST.CMPCOD AS CMPCOD,MST.MSTDOCNUM, MST.DUPNUM AS DUPNUM, MST.SEQNUM AS SEQNUM,MST.ORGCOD AS ORG,MST.SHPPFX AS SHPPFX, MST.DSTCOD AS DEST, MST.CNSNAM AS CNSNAM, MST.SHPNAM AS SHPNAM, MST.DOCOWRIDR
  AS OWNIDR, FLT.POU AS POU,FLT.POL AS POL, MST.SLCPCS AS SLCPCS, MST.SHPDES AS DES, MST.STDPCS AS STDPCS, MST.STDWGT AS STDWGT, MST.DOCNUM AS HSEDOCNUM, CNT.AGTADR,FLT.FLTCARIDR,FLT.FLTNUM,FLT.FLTSEQNUM,SEG.SEGSERNUM,SEG.MFTPCS,SEG.MFTWGT, IMP.BRKDWNFLG,IMP.FLTDAT,
  LEG.STA,LEG.STD,EXPFLT.FLTCARCOD,CNT.CNSSTT,SHRCUSMST.PHNONE, case when SEG.FLTNUM = HSE.TXNREFTHR then HSE.PCS else 0  end PCS,
   case when SEG.FLTNUM = HSE.TXNREFTHR then HSE.WGT else 0 end WGT,CASE  WHEN SEG.FLTNUM = HSE.TXNREFTHR  then HSE.DOCNUM  else null  end DOCNUM,  CASE WHEN SEG.FLTNUM = HSE.TXNREFTHR  THEN HSE.SEQNUM   else 0  end HSESEQNUM,
   BKG.SHPDLVTIM,
 (SELECT ARLNAM FROM shrarlmst WHERE arlidr= FLT.FLTCARIDR and CMPCOD=MST.CMPCOD
  )ARLNAM,LEG.ATA, LEG.ETA, QMSPLN.MILSTNTIM AS NFDPLNDAT
FROM
  OPRSHPMST MST, OPRSEGSHP SEG, OPRFLTSEG FLT, OPRSHPMSTCNT CNT, FLTOPRLEG LEG, SHRCUSMST, OPRTXNHSE HSE, OPRARPIMPFLT IMP,CAPBKGMST BKG,OPRARPEXPFLT EXPFLT,QMSSHPMILSTNPLN QMSPLN
WHERE
  SEG.CMPCOD         = LEG.CMPCOD
AND FLT.FLTCARIDR    = LEG.FLTCARIDR
      AND FLT.FLTNUM    = LEG.FLTNUM
AND FLT.FLTSEQNUM    = LEG.FLTSEQNUM
      AND FLT.POU   = LEG.LEGDST
      AND SEG.DOCOWRIDR  = MST.DOCOWRIDR
AND SEG.MSTDOCNUM    = MST.MSTDOCNUM
AND SEG.DUPNUM       = MST.DUPNUM

      AND SEG.CMPCOD    = MST.CMPCOD
AND MST.CMPCOD       = BKG.CMPCOD(+)
AND MST.DOCOWRIDR    = BKG.DOCOWRIDR(+)
AND MST.DUPNUM       = BKG.DUPNUM(+)
AND MST.MSTDOCNUM    = BKG.MSTDOCNUM(+)
AND SEG.FLTNUM       = FLT.FLTNUM
AND SEG.FLTSEQNUM    = FLT.FLTSEQNUM
AND SEG.FLTCARIDR    = FLT.FLTCARIDR
AND SEG.SEGSERNUM    = FLT.SEGSERNUM
AND FLT.FLTNUM       = IMP.FLTNUM(+)
AND FLT.FLTCARIDR    = IMP.FLTCARIDR(+)
AND FLT.FLTSEQNUM    = IMP.FLTSEQNUM(+)
AND FLT.POU          = IMP.ARPCOD(+)
AND FLT.FLTNUM       = EXPFLT.FLTNUM(+)
AND FLT.FLTCARIDR    = EXPFLT.FLTCARIDR(+)
AND FLT.FLTSEQNUM    = EXPFLT.FLTSEQNUM(+)

AND MST.CMPCOD       = CNT.CMPCOD
AND MST.DOCOWRIDR    = CNT.DOCOWRIDR
		   AND MST.MSTDOCNUM = CNT.MSTDOCNUM
AND MST.DUPNUM       = CNT.DUPNUM
AND MST.SEQNUM       = CNT.SEQNUM
AND MST.CMPCOD       = SHRCUSMST.CMPCOD(+)
AND MST.CNSCOD       = SHRCUSMST.CUSCOD(+)
AND HSE.DOCOWRIDR(+) = MST.DOCOWRIDR
AND HSE.MSTDOCNUM(+) = MST.MSTDOCNUM
AND HSE.DUPNUM(+)    = MST.DUPNUM
			AND HSE.SEQNUM(+)    =  MST.SEQNUM
AND HSE.CMPCOD(+)    = MST.CMPCOD
			AND QMSPLN.CMPCOD(+) = MST.CMPCOD 
			AND QMSPLN.DOCOWRIDR(+) = MST.DOCOWRIDR 
			AND QMSPLN.MSTDOCNUM(+) = MST.MSTDOCNUM 
			and QMSPLN.DUPNUM(+) = MST.DUPNUM 
			AND QMSPLN.SEQNUM(+)=MST.SEQNUM
			and QMSPLN.MILSTNCOD(+) = 'NFD'
			and SEG.MFTPCS > 0
			]]>
		</QRY:Source>
	</QRY:Definition>
	<!--Added by A-5117 for ICRD-31277 ends here-->
	<QRY:Definition>
		<QRY:Id>387</QRY:Id>
		<QRY:Source Name="operations.flthandling.findexportflightsforairport" Type="NATIVE">
			<![CDATA[
			SELECT OPRLEG.CMPCOD,
		  OPRLEG.FLTCARIDR,
		  OPRLEG.FLTNUM,
		  OPRMST.FLTDAT,
		  OPRLEG.LEGORG,



		  OPRLEG.LEGDST,
		  OPRLEG.TALNUM,
		  OPRLEG.ACRTYP,
		  (
		  CASE
			WHEN OPRLEG.ATD IS NOT NULL



			THEN OPRLEG.ATD
			WHEN OPRLEG.ETD IS NOT NULL
			THEN OPRLEG.ETD
			WHEN OPRLEG.STD IS NOT NULL


			THEN
OPRLEG.STD
			ELSE NULL
		  END) DEPDAT,
		  (
		  CASE
			WHEN OPRLEG.ATD IS NOT NULL
			THEN

'A'

			WHEN OPRLEG.ETD IS NOT NULL
			THEN 'E'
			WHEN OPRLEG.STD IS NOT NULL
			THEN 'S'
			ELSE

NULL
		  END)
DEPDATTYP,
		  (
		  CASE
			WHEN OPRLEG.ATDUTC IS NOT NULL
			THEN OPRLEG.ATDUTC

WHEN
OPRLEG.STDUTC
IS NOT NULL
			THEN OPRLEG.STDUTC
			ELSE NULL
		  END) DEPDATUTC,
		  NVL(EXPFLT.FLTOPRSTA,'O')FLTOPRSTA,

EXPFLT.BDPSTA,

		  OPRLEG.LEGSERNUM,
		  OPRLEG.FLTSEQNUM,
		  OPRLEG.LEGORG ARPCOD,
		   CASE
			WHEN
ARLMST.APHCODUSE

= 2
			THEN ARLMST.TWOAPHCOD
			ELSE ARLMST.THRAPHCOD
		  END AS FLTCARCOD,


FLTSEG.SEGORG,


FLTSEG.SEGDST,
		  (SELECT COUNT(OPRSEGULD.THRUNT)
		  FROM OPRSEGULD
		  WHERE
OPRSEGULD.FLTCARIDR
=FLTSEG.FLTCARIDR

AND OPRSEGULD.FLTNUM      = FLTSEG.FLTNUM
		  AND OPRSEGULD.FLTSEQNUM
= FLTSEG.FLTSEQNUM

		  AND OPRSEGULD.CMPCOD
= FLTSEG.CMPCOD
		  AND OPRSEGULD.THRUNT
= 'Y'
		  AND OPRSEGULD.SEGSERNUM
= FLTSEG.SEGSERNUM

AND OPRSEGULD.BARROWFLG   = 'N'
		  AND
OPRSEGULD.ULDNUM NOT LIKE 'BULK%'

) THRUNT,
		  (SELECT COUNT(OPRSEGULD.THRUNT)

FROM OPRSEGULD

WHERE OPRSEGULD.FLTCARIDR =FLTSEG.FLTCARIDR

AND OPRSEGULD.FLTNUM      = FLTSEG.FLTNUM

AND OPRSEGULD.FLTSEQNUM
= FLTSEG.FLTSEQNUM
		  AND OPRSEGULD.CMPCOD
= FLTSEG.CMPCOD
		  AND OPRSEGULD.THRUNT
= 'N'

AND OPRSEGULD.SEGSERNUM   = FLTSEG.SEGSERNUM

		  AND OPRSEGULD.ULDNUM NOT LIKE 'BULK%'

) NORM,

(SELECT NVL(SUM(OPRSEGULD.NETWGT),0)
		  FROM
OPRSEGULD
		  WHERE OPRSEGULD.FLTCARIDR =FLTSEG.FLTCARIDR


AND OPRSEGULD.FLTNUM      = FLTSEG.FLTNUM

AND OPRSEGULD.FLTSEQNUM   = FLTSEG.FLTSEQNUM
		  AND
OPRSEGULD.CMPCOD
= FLTSEG.CMPCOD
		  AND OPRSEGULD.SEGSERNUM
= FLTSEG.SEGSERNUM
		  ) NETWGT,

OPRMST.FLTSTA
		FROM
FLTOPRLEG OPRLEG,
		  OPRARPEXPFLT EXPFLT,

		  FLTOPRSEG FLTSEG,
		  FLTOPRMST
OPRMST,
		  SHRARLMST
ARLMST
		WHERE OPRLEG.FLTCARIDR = EXPFLT.FLTCARIDR(+)

		AND OPRLEG.FLTNUM
= EXPFLT.FLTNUM(+)
		AND
OPRLEG.FLTSEQNUM   = EXPFLT.FLTSEQNUM(+)
		AND OPRLEG.CMPCOD
= EXPFLT.CMPCOD(+)

AND OPRLEG.LEGORG
= EXPFLT.ARPCOD(+)
		AND OPRLEG.LEGSERNUM   = EXPFLT.LEGSERNUM(+)

		AND OPRLEG.FLTCARIDR
= FLTSEG.FLTCARIDR

AND OPRLEG.FLTNUM      = FLTSEG.FLTNUM
		AND OPRLEG.FLTSEQNUM
= FLTSEG.FLTSEQNUM

AND OPRLEG.CMPCOD
= FLTSEG.CMPCOD
		AND OPRLEG.LEGORG      = FLTSEG.SEGORG

		AND OPRLEG.FLTNUM
= OPRMST.FLTNUM
		AND
OPRLEG.FLTSEQNUM   = OPRMST.FLTSEQNUM
		AND OPRLEG.FLTCARIDR
= OPRMST.FLTCARIDR

AND OPRLEG.CMPCOD
= OPRMST.CMPCOD
		AND OPRMST.CMPCOD        = ARLMST.CMPCOD

        AND
OPRMST.FLTCARIDR     = ARLMST.ARLIDR
		AND OPRMST.FLTSTA <> 'CAN'
		AND OPRMST.FLTSTA <> 'TBC'


AND OPRMST.CMPCOD      = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<!--Added by A-4113 for ICRD-44205 starts here-->
		<QRY:Id>391</QRY:Id>
		<QRY:Source Name="operations.flthandling.findimportflightsforairport" Type="NATIVE">
			<![CDATA[
		SELECT OPRLEG.CMPCOD,
		  OPRLEG.FLTCARIDR,
		  OPRLEG.FLTNUM,
		  OPRMST.FLTDAT,
		  OPRLEG.LEGORG,



		  OPRLEG.LEGDST,
		  OPRLEG.TALNUM,
		  OPRLEG.ACRTYP,
		  (
		  CASE
		    WHEN OPRLEG.ATA IS NOT

NULL

		    THEN OPRLEG.ATA
		    WHEN OPRLEG.ETA IS NOT NULL
		    THEN OPRLEG.ETA
		    WHEN

OPRLEG.STA IS NOT
NULL
		    THEN OPRLEG.STA
		    ELSE NULL
		  END) ARRDAT,
		  (
		  CASE

WHEN
OPRLEG.ATA IS NOT
NULL
		    THEN 'A'
		    WHEN OPRLEG.ETA IS NOT NULL
		    THEN 'E'
		    WHEN
OPRLEG.STA
IS NOT NULL

		    THEN 'S'
		    ELSE NULL
		  END) ARRDATTYP,
		  (
		  CASE

WHEN OPRLEG.ATAUTC
IS NOT NULL

		    THEN OPRLEG.ATAUTC
		    WHEN OPRLEG.STAUTC IS NOT NULL

THEN OPRLEG.STAUTC

		    ELSE NULL

END) ARRDATUTC,
		  NVL(IMPFLT.FLTOPRSTA,'A')FLTOPRSTA,

OPRLEG.LEGSERNUM,
		  OPRLEG.FLTSEQNUM,


		  OPRLEG.LEGDST ARPCOD,
		   CASE
			WHEN ARLMST.APHCODUSE
= 2
			THEN ARLMST.TWOAPHCOD
			ELSE ARLMST.THRAPHCOD


END AS FLTCARCOD,
		  FLTSEG.SEGORG,

FLTSEG.SEGDST,
		  (SELECT COUNT(OPRSEGULD.THRUNT)
		  FROM

OPRSEGULD
		  WHERE OPRSEGULD.FLTCARIDR
=FLTSEG.FLTCARIDR
		  AND OPRSEGULD.FLTNUM      = FLTSEG.FLTNUM


AND OPRSEGULD.FLTSEQNUM   = FLTSEG.FLTSEQNUM

AND OPRSEGULD.CMPCOD      = FLTSEG.CMPCOD
		  AND OPRSEGULD.THRUNT

= 'Y'
		  AND OPRSEGULD.SEGSERNUM
= FLTSEG.SEGSERNUM
		  AND OPRSEGULD.BARROWFLG   = 'N'
		  AND OPRSEGULD.ULDNUM

NOT LIKE 'BULK%'

) THRUNT,
		  (SELECT COUNT(OPRSEGULD.THRUNT)
		  FROM OPRSEGULD
		  WHERE OPRSEGULD.FLTCARIDR

=FLTSEG.FLTCARIDR

AND OPRSEGULD.FLTNUM      = FLTSEG.FLTNUM
		  AND OPRSEGULD.FLTSEQNUM   = FLTSEG.FLTSEQNUM


AND
OPRSEGULD.CMPCOD      = FLTSEG.CMPCOD
		  AND OPRSEGULD.THRUNT      = 'N'
		  AND OPRSEGULD.SEGSERNUM


= FLTSEG.SEGSERNUM
		  AND OPRSEGULD.ULDNUM NOT LIKE 'BULK%'
		  ) NORM,
		  (SELECT NVL(SUM(SEGSHP.RCVWGT),0)



FROM OPRSEGSHP SEGSHP
		  WHERE SEGSHP.FLTCARIDR = FLTSEG.FLTCARIDR
		  AND SEGSHP.FLTNUM      = FLTSEG.FLTNUM



AND SEGSHP.FLTSEQNUM   = FLTSEG.FLTSEQNUM
		  AND SEGSHP.CMPCOD      = FLTSEG.CMPCOD
		  AND SEGSHP.SEGSERNUM


= FLTSEG.SEGSERNUM
		   ) TOTBDNWGT,
		    (SELECT NVL(SUM(SEGSHP.MFTWGT),0)
			  FROM OPRSEGSHP SEGSHP


			  WHERE SEGSHP.FLTCARIDR = FLTSEG.FLTCARIDR
			  AND SEGSHP.FLTNUM      = FLTSEG.FLTNUM
			  AND
SEGSHP.FLTSEQNUM
= FLTSEG.FLTSEQNUM
			  AND SEGSHP.CMPCOD      = FLTSEG.CMPCOD
			  AND SEGSHP.SEGSERNUM
= FLTSEG.SEGSERNUM

			  ) TOTMFTWGT,
		   OPRMST.FLTSTA
		FROM FLTOPRLEG OPRLEG,
		  OPRARPIMPFLT
IMPFLT,

FLTOPRSEG FLTSEG,

		  FLTOPRMST OPRMST,
		  SHRARLMST ARLMST
		WHERE OPRLEG.FLTCARIDR
= IMPFLT.FLTCARIDR(+)

AND OPRLEG.FLTNUM
= IMPFLT.FLTNUM(+)
		AND OPRLEG.FLTSEQNUM   = IMPFLT.FLTSEQNUM(+)

AND OPRLEG.CMPCOD
= IMPFLT.CMPCOD(+)

		AND OPRLEG.LEGDST      = IMPFLT.ARPCOD(+)
		AND OPRLEG.LEGSERNUM
= IMPFLT.LEGSERNUM(+)


		AND OPRLEG.FLTCARIDR
= FLTSEG.FLTCARIDR
		AND OPRLEG.FLTNUM      = FLTSEG.FLTNUM

AND OPRLEG.FLTSEQNUM
= FLTSEG.FLTSEQNUM

AND OPRLEG.CMPCOD      = FLTSEG.CMPCOD
		AND OPRLEG.LEGDST
= FLTSEG.SEGDST


		AND OPRLEG.FLTNUM
= OPRMST.FLTNUM
		AND OPRLEG.FLTSEQNUM   = OPRMST.FLTSEQNUM

AND OPRLEG.FLTCARIDR
= OPRMST.FLTCARIDR

AND OPRLEG.CMPCOD      = OPRMST.CMPCOD

		AND OPRMST.CMPCOD
= ARLMST.CMPCOD

AND OPRMST.FLTCARIDR
= ARLMST.ARLIDR

		AND OPRMST.CMPCOD      = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>392</QRY:Id>
		<QRY:Source Name="operations.flthandling.getuldcontentspart1" Type="NATIVE">
			<![CDATA[
	SELECT BKGSHPFIL.*
	FROM
	(SELECT ULDSHPFIL.*,
	OPRTRG.THRCARIDR,
    OPRTRG.THRCARCOD ,
    OPRTRG.THRFLTNUM

,
    OPRTRG.THRFLTDAT ,
    OPRTRG.THRDSTCOD ,
    OPRTRG.SERNUM THRSERNUM,
    SHPMST.SHPPFX,

SHPMST.MSTDOCNUM
SHPMSTDOCNUM,
	SHPMST.DUPNUM SHPDUPNUM,
	SHPMST.SEQNUM SHPSEQNUM,
    SHPMST.STDPCS,

SHPMST.STDWGT,

    SHPMST.SCCCOD,
    SHPMST.SHPDES,
    SHPMST.ORGCOD,
    SHPMST.DSTCOD,
    BKGMST.SHPRMK,

BKGMST.TOTNUMPCS,

    BKGFLTDTL.FLTCARCOD BKGFLTCARCOD,
    BKGFLTDTL.FLTCARIDR BKGFLTCARIDR,

BKGFLTDTL.FLTNUM BKGFLTNUM,

    BKGFLTDTL.FLTDAT BKGFLTDAT,
    BKGFLTDTL.FLTSEQNUM BKGFLTSEQNUM,

BKGFLTDTL.FLTORG,
    BKGFLTDTL.FLTDST,

    BKGFLTDTL.NUMPCS BKGFLTPCS,
    BKGFLTDTL.WGT BKGFLTWGT,

BKGFLTDTL.FLTBKGSTA,
    BKGFLTDTL.LWRDCKONE,

    BKGFLTDTL.UPRDCKONE,
    BKGFLTDTL.LWRDCKTWO,

BKGFLTDTL.UPRDCKTWO,
    FLTLEG.TALNUM,
    ULDMST.TAREWGT,

    ULDMST.TAREWGTUNT,
    ULDMST.STRWGTLMT,

ULDMST.MAXVOL,
    ULDMST.MAXVOLUNT,
    ULDMST.ULDTYPPOS,

    ULDMST.CTRCOD,
	FLTMST.FLTDAT,

FLTMST.FLTOWN FLTCARCOD,
    STUMST.CURLOCCOD ULDLOCCOD
	FROM

    (SELECT ULDDTL.CMPCOD,
      ULDDTL.FLTCARIDR,

ULDDTL.FLTNUM,
      ULDDTL.FLTSEQNUM,
      ULDDTL.LEGSERNUM,

      ULDDTL.POL,
      ULDDTL.POU,

ULDDTL.ULDNUM,
      ULDDTL.CLSFLG,
      ULDSHP.MSTDOCNUM,

      ULDSHP.DOCOWRIDR,
      ULDSHP.DUPNUM,

ULDSHP.SEQNUM,
      ARPULD.ULDCTR,
	  ULDDTL.POL ULDARPCOD,

      0 AS RCVPCS,
      0 AS RCVWGT,

0 AS BDPPCS,
      0 AS BDPWGT,
      0 AS MFTPCS,
      0 AS MFTWGT,

      ULDSHP.NUMPCS ULDPCS,

ULDSHP.WGT ULDWGT,
	  ARPULD.NETWGT ACTWGT,
      NULL AS ULDPOS,
      NULL
AS ULDBKGIDR,
      ARPULD.ULDVOL,

NULL AS RCVFLG ,
	  NULL AS LOCCOD,
      NULL AS SEGULDCTR,

      0    AS TOTBDPPCS,
      0
AS TOTBDPWGT,
      0    AS TOTBDPVOL
      FROM OPRULDDTL ULDDTL,

      OPRULDSHP ULDSHP,

OPRARPULD ARPULD
      WHERE ULDDTL.CMPCOD        = ARPULD.CMPCOD
      AND ULDDTL.POL
=
ARPULD.ARPCOD
      AND ULDDTL.ULDNUM          = ARPULD.ULDNUM
      AND ARPULD.ULDNUM          = ULDSHP.ULDNUM


   	  AND ARPULD.CMPCOD  		 = ULDSHP.CMPCOD
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>393</QRY:Id>
		<QRY:Source Name="operations.flthandling.getuldcontentspart2" Type="NATIVE">
			<![CDATA[
    UNION
    SELECT ULDDTL.CMPCOD,
      ULDDTL.FLTCARIDR,
      ULDDTL.FLTNUM,
      ULDDTL.FLTSEQNUM,


      ULDDTL.LEGSERNUM,
      ULDDTL.POL,
      ULDDTL.POU,
      ULDDTL.ULDNUM,
      ULDDTL.CLSFLG,


      SEGULDSHP.MSTDOCNUM,
      SEGULDSHP.DOCOWRIDR,
      SEGULDSHP.DUPNUM,
      SEGULDSHP.SEQNUM
,

      SEGULDSHP.CNTIDR ULDCTR,
	  ULDDTL.POL ULDARPCOD,
      SEGULDSHP.RCVPCS,
      SEGULDSHP.RCVWGT,


      SEGULDSHP.BDPPCS,
      SEGULDSHP.BDPWGT,
      SEGULDSHP.MFTPCS MFTPCS,
      SEGULDSHP.MFTWGT
MFTWGT,

      SEGULDSHP.MFTPCS ULDPCS,
      SEGULDSHP.MFTWGT ULDWGT,
      SEGULD.ACTWGT ACTWGT,

SEGULD.ULDPOS,

      SEGULD.ULDBKGIDR,
      SEGULD.ULDVOL,
      SEGULD.RCVFLG,
	  SEGULD.LOCCOD,

SEGULD.ULDCTR SEGULDCTR,

SUM(SEGULDSHP.BDPPCS) OVER (PARTITION BY SEGULDSHP.FLTNUM, SEGULDSHP.FLTCARIDR,
SEGULDSHP.FLTSEQNUM,
SEGULDSHP.SEGSERNUM, SEGULDSHP.ULDNUM, SEGULDSHP.CMPCOD) TOTBDPPCS,
      SUM(SEGULDSHP.BDPWGT)
OVER
(PARTITION BY SEGULDSHP.FLTNUM, SEGULDSHP.FLTCARIDR, SEGULDSHP.FLTSEQNUM, SEGULDSHP.SEGSERNUM,
SEGULDSHP.ULDNUM,
SEGULDSHP.CMPCOD) TOTBDPWGT,
      SUM(SEGULDSHP.BDPVOL) OVER (PARTITION BY SEGULDSHP.FLTNUM,
SEGULDSHP.FLTCARIDR,
SEGULDSHP.FLTSEQNUM, SEGULDSHP.SEGSERNUM, SEGULDSHP.ULDNUM, SEGULDSHP.CMPCOD) TOTBDPVOL

FROM OPRSEGULD
SEGULD,
      OPRSEGULDSHP SEGULDSHP,
      OPRULDDTL ULDDTL
    WHERE ULDDTL.CMPCOD
= SEGULD.CMPCOD

      AND ULDDTL.FLTCARIDR       = SEGULD.FLTCARIDR
   	  AND ULDDTL.FLTNUM
= SEGULD.FLTNUM

      AND ULDDTL.FLTSEQNUM       = SEGULD.FLTSEQNUM
      AND ULDDTL.ULDNUM
= SEGULD.ULDNUM
    AND
SEGULD.FLTCARIDR       = SEGULDSHP.FLTCARIDR(+)
    AND SEGULD.FLTNUM
= SEGULDSHP.FLTNUM(+)

    AND SEGULD.FLTSEQNUM       = SEGULDSHP.FLTSEQNUM(+)
    AND SEGULD.SEGSERNUM
= SEGULDSHP.SEGSERNUM(+)

    AND SEGULD.CMPCOD          = SEGULDSHP.CMPCOD(+)
    AND SEGULD.ULDNUM
= SEGULDSHP.ULDNUM(+)
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>394</QRY:Id>
		<QRY:Source Name="operations.flthandling.getuldcontentspart3" Type="NATIVE">
			<![CDATA[
		)ULDSHPFIL
  INNER JOIN SHRULDTYPMST ULDMST
  ON ULDMST.ULDTYPCOD = SUBSTR(ULDSHPFIL.ULDNUM,0,3)


  AND ULDMST.CMPCOD   = ULDSHPFIL.CMPCOD
  LEFT OUTER JOIN OPRSHPMST SHPMST
  ON SHPMST.MSTDOCNUM  =
ULDSHPFIL.MSTDOCNUM

  AND SHPMST.DOCOWRIDR = ULDSHPFIL.DOCOWRIDR
  AND SHPMST.DUPNUM    = ULDSHPFIL.DUPNUM

AND SHPMST.SEQNUM
= ULDSHPFIL.SEQNUM
  AND SHPMST.CMPCOD    = ULDSHPFIL.CMPCOD
  LEFT OUTER JOIN
CAPBKGMST BKGMST
  ON
BKGMST.MSTDOCNUM  = SHPMST.MSTDOCNUM
  AND BKGMST.DOCOWRIDR = SHPMST.DOCOWRIDR

AND BKGMST.DUPNUM
= SHPMST.DUPNUM
  AND BKGMST.SEQNUM    = SHPMST.SEQNUM
  AND BKGMST.CMPCOD    =
SHPMST.CMPCOD
  LEFT
OUTER JOIN CAPBKGDTL BKGDTL
  ON BKGDTL.CMPCOD  = BKGMST.CMPCOD
  AND BKGDTL.UBRNUM
= BKGMST.UBRNUM

  LEFT OUTER JOIN CAPBKGFLTDTL BKGFLTDTL
  ON BKGFLTDTL.UBRNUM  = BKGMST.UBRNUM

AND BKGFLTDTL.CMPCOD
= BKGMST.CMPCOD
  AND BKGFLTDTL.FLTORG = ULDSHPFIL.POU
  LEFT OUTER JOIN FLTOPRLEG
FLTLEG
  ON FLTLEG.CMPCOD
= BKGFLTDTL.CMPCOD
  AND FLTLEG.FLTCARIDR = BKGFLTDTL.FLTCARIDR
  AND FLTLEG.FLTNUM
= BKGFLTDTL.FLTNUM

  AND FLTLEG.FLTSEQNUM = BKGFLTDTL.FLTSEQNUM
  AND FLTLEG.LEGORG=BKGFLTDTL.FLTORG

LEFT OUTER JOIN OPRULDTHRRTG
OPRTRG
  ON OPRTRG.CMPCOD    =ULDSHPFIL.CMPCOD
  AND OPRTRG.FLTCARIDR=ULDSHPFIL.FLTCARIDR

AND OPRTRG.FLTNUM
=ULDSHPFIL.FLTNUM
  AND OPRTRG.FLTSEQNUM  = ULDSHPFIL.FLTSEQNUM
  AND OPRTRG.ULDNUM
= ULDSHPFIL.ULDNUM

  LEFT OUTER JOIN FLTOPRMST FLTMST
  ON FLTMST.CMPCOD = ULDSHPFIL.CMPCOD
  AND
FLTMST.FLTCARIDR  = ULDSHPFIL.FLTCARIDR

  AND FLTMST.FLTNUM  = ULDSHPFIL.FLTNUM
  AND FLTMST.FLTSEQNUM
= ULDSHPFIL.FLTSEQNUM
  LEFT OUTER JOIN
WHSSTUMST STUMST
  ON STUMST.CMPCOD     = ULDSHPFIL.CMPCOD

AND STUMST.STUCOD    = ULDSHPFIL.ULDNUM

  AND STUMST.ARPCOD     = ULDSHPFIL.ULDARPCOD
  ) BKGSHPFIL
LEFT
OUTER JOIN FLTOPRMST OPRMST
ON OPRMST.CMPCOD
= BKGSHPFIL.CMPCOD
AND OPRMST.FLTCARIDR  = BKGSHPFIL.FLTCARIDR
AND
OPRMST.FLTNUM = BKGSHPFIL.FLTNUM
AND
OPRMST.FLTSEQNUM = BKGSHPFIL.FLTSEQNUM
AND INSTR(SUBSTR(FLTROU,INSTR(FLTROU,?)),BKGSHPFIL.FLTORG
)>=0
			]]>
		</QRY:Source>
	</QRY:Definition>
	<!--Added by A-4113 for ICRD-44205 ends here-->
	<!--Added by A-5135 for ICRD-28211 starts-->
	<QRY:Definition>
		<QRY:Id>398</QRY:Id>
		<QRY:Source Name="operations.flthandling.findflightdetailsforscalepublish" Type="NATIVE">
			<![CDATA[
			SELECT FLTLEG.CMPCOD,
			  FLTLEG.FLTCARIDR,
			  DECODE(ARLMST.APHCODUSE,2,ARLMST.TWOAPHCOD,ARLMST.THRAPHCOD)

FLTCARCOD,
			  FLTLEG.FLTNUM,
			  FLTLEG.FLTSEQNUM,
			  FLTMST.FLTORG,
			  FLTMST.FLTDST,
			  TO_CHAR(FLTMST.CRTTIM,'dd-MON-yyyy')

CRTTIM,
			  TO_CHAR(FLTMST.FLTDAT,'dd-MON-yyyy') FLTDAT,
			  FLTMST.FLTTYP,
			  FLTMST.FLTROU,


			  FLTLEG.LEGORG,
			  FLTLEG.LEGDST,
			  ORGARP.CNTCOD ORGCNT,
			  DSTARP.CNTCOD DSTCNT,
			  TO_CHAR(FLTLEG.STA,'dd-MON-yyyy HH24:MI:SS') STA,

			  FLTLEG.STAUTC,
			  TO_CHAR(FLTLEG.STD,'dd-MON-yyyy HH24:MI:SS') STD,
			  FLTLEG.STDUTC,


			  TO_CHAR(FLTLEG.ETA,'dd-MON-yyyy HH24:MI:SS') ETA,
			  TO_CHAR(FLTLEG.ETD,'dd-MON-yyyy HH24:MI:SS')
ETD,

			  TO_CHAR(FLTLEG.ATA,'dd-MON-yyyy HH24:MI:SS') ATA,
			  FLTLEG.ATAUTC,
			  TO_CHAR(FLTLEG.ATD,'dd-MON-yyyy HH24:MI:SS') ATD,

			  FLTLEG.ATDUTC,
			  FLTLEG.ACRTYP,
			  FLTLEG.LEGSERNUM,
			  FLTMST.FLTSTA


			FROM FLTOPRLEG FLTLEG
			INNER JOIN FLTOPRMST FLTMST
			ON FLTLEG.CMPCOD     = FLTMST.CMPCOD

AND FLTLEG.FLTCARIDR
= FLTMST.FLTCARIDR
			AND FLTLEG.FLTNUM    = FLTMST.FLTNUM
			AND FLTLEG.FLTSEQNUM
= FLTMST.FLTSEQNUM

			LEFT OUTER JOIN FLTOPRLEG FLTLEG_1
			ON FLTMST.CMPCOD     = FLTLEG_1.CMPCOD

AND FLTMST.FLTCARIDR
= FLTLEG_1.FLTCARIDR
			AND FLTMST.FLTNUM    = FLTLEG_1.FLTNUM
			AND FLTMST.FLTSEQNUM
= FLTLEG_1.FLTSEQNUM

			AND FLTMST.FLTORG = FLTLEG_1.LEGORG
			INNER JOIN SHRARLMST ARLMST
			ON
FLTLEG.CMPCOD     = ARLMST.CMPCOD

			AND FLTLEG.FLTCARIDR = ARLMST.ARLIDR
			INNER JOIN SHRARPMST
ORGARP
			ON FLTLEG.CMPCOD  = ORGARP.CMPCOD

			AND FLTLEG.LEGORG = ORGARP.ARPCOD
			INNER JOIN SHRARPMST
DSTARP
			ON FLTLEG.CMPCOD  = DSTARP.CMPCOD

			AND FLTLEG.LEGDST = DSTARP.ARPCOD
			INNER JOIN SHRARLARPPAR
ARLPAR
			ON FLTMST.CMPCOD     = ARLPAR.CMPCOD

			AND FLTMST.FLTCARIDR = ARLPAR.ARLIDR
			AND FLTMST.FLTORG
= ARLPAR.ARPCOD
			LEFT OUTER JOIN SHRUSEARPPAR
ARPPAR
			ON FLTMST.CMPCOD  = ARPPAR.CMPCOD
			AND FLTMST.FLTORG
= ARPPAR.ARPCOD
			AND ARPPAR.PARCOD
= 'opeations.flthandling.weightscalepublishoffset'
			LEFT OUTER
JOIN SHRSTNARPPARMST PARMST
			ON ARPPAR.CMPCOD
= PARMST.CMPCOD
			AND ARPPAR.PARCOD     	= PARMST.PARCOD

WHERE FLTLEG.CMPCOD     = ?
			AND FLTMST.FLTSTA NOT IN ('CAN','TBC')
			AND ARLPAR.PARCOD     	= 'operations.flthandling.weightscaleavailable'

AND ARLPAR.PARVAL     	= 'Y'
			]]>
		</QRY:Source>
	</QRY:Definition>
	<!--Added by A-5135 for ICRD-28211 ends-->
	<!--Added by A-5117 for ICRD-29421 starts here-->
	<QRY:Definition>
		<QRY:Id>395</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findShipmentsInUld" Type="NATIVE">
			<![CDATA[
				SELECT ULDSHP.CMPCOD,
					ULDSHP.FLTCARIDR,
					ULDSHP.FLTNUM,
					ULDSHP.ULDNUM,
					ULDSHP.FLTSEQNUM,

SHP.DOCOWRIDR,
					SHP.MSTDOCNUM,
					SHP.DUPNUM,
					SHP.SEQNUM,
					ULDSHP.BDPPCS,
					ULDSHP.BDPWGT,

SHP.SHPDES,
					SHP.SCCCOD,
					SHP.SHPPFX,
					DTL.ANMTYP,
					DTL.SHPHGT,
					DTL.SHPLEN,

DTL.SHPWID,
					ULD.ULDCTR,
					ULD.BARROWFLG,
					ULD.SEGSERNUM,
					DTL.MSTDOCNUM LODINSDOCNUM,

DTL.BDPWGT LODWGT
				FROM OPRSEGULD ULD
				JOIN OPRFLTSEG FLT
					ON ULD.FLTNUM     = FLT.FLTNUM

AND ULD.FLTCARIDR = FLT.FLTCARIDR
					AND ULD.FLTSEQNUM = FLT.FLTSEQNUM
					AND ULD.SEGSERNUM = FLT.SEGSERNUM

AND ULD.CMPCOD    = FLT.CMPCOD
				LEFT OUTER JOIN OPRSEGULDSHP ULDSHP
					ON ULD.CMPCOD     = ULDSHP.CMPCOD
AND
ULD.FLTCARIDR = ULDSHP.FLTCARIDR
					AND ULD.FLTNUM    = ULDSHP.FLTNUM
AND ULD.FLTSEQNUM = ULDSHP.FLTSEQNUM

AND ULD.SEGSERNUM = ULDSHP.SEGSERNUM
					AND ULD.ULDNUM    = ULDSHP.ULDNUM
					AND ULDSHP.BDPPCS>0
				LEFT OUTER JOIN OPRSHPMST
SHP
					ON ULDSHP.CMPCOD     = SHP.CMPCOD
AND ULDSHP.DOCOWRIDR = SHP.DOCOWRIDR
AND ULDSHP.MSTDOCNUM
= SHP.MSTDOCNUM
AND ULDSHP.SEQNUM = SHP.SEQNUM
AND ULDSHP.DUPNUM = SHP.DUPNUM

LEFT OUTER JOIN OPRULDINSSHPDTL
DTL
					ON  ULDSHP.CMPCOD     = DTL.CMPCOD
					AND ULDSHP.FLTCARIDR  = DTL.FLTCARIDR
					AND ULDSHP.FLTNUM
= DTL.FLTNUM
					AND ULDSHP.FLTSEQNUM  = DTL.FLTSEQNUM
					AND ULDSHP.SEGSERNUM  = DTL.SEGSERNUM

AND ULDSHP.MSTDOCNUM  = DTL.MSTDOCNUM
AND ULDSHP.DOCOWRIDR = DTL.DOCOWRIDR
AND ULDSHP.DUPNUM = DTL.DUPNUM

AND ULDSHP.SEQNUM = DTL.SEQNUM
AND ULDSHP.ULDNUM = DTL.ULDNUM
				WHERE ULD.CMPCOD  	 = ?
					AND
ULD.FLTCARIDR = ?
					AND ULD.FLTNUM    = ?
					AND ULD.FLTSEQNUM = ?
					AND ULD.ULDNUM    = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>396</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findUldLoadingInstructionDetails" Type="NATIVE">
			<![CDATA[
				SELECT DTL.ASLFLG,
					DTL.BLKFLG,
					DTL.C2PFLG,
					DTL.C3PFLG,
					DTL.CADFLG,
					DTL.CNTDIM,

DTL.CNTLODFLG,
					DTL.CSUFLG,
					DTL.DLCCOD ,
					DTL.EICFLG ,
					DTL.ENGTYP ,
					DTL.OVPFLG,

DTL.FRNDIM ,
					DTL.FULFLG ,
					DTL.ICCFLG ,
					DTL.LATLODFLG ,
					DTL.LDPFLG ,
					DTL.LSTUPDTIM
,
					DTL.LSTUPDUSR ,
					DTL.TOPURGFLG ,
					DTL.RERDIM ,
					DTL.RMK ,
					DTL.PRRFLG ,
					DTL.FRKLFTFLG
,
					DTL.ULDNUM ,
					DTL.SPAULDNUM ,
					DTL.BLPFLG ,
					DTL.ZOLFLG,
					DTL.COMWGT ,
					DTL.EICWGT
,
					DTL.OBCWGT ,
					DTL.OVRLAPWGT ,
					DTL.PALSTKWGT ,
					DTL.UCBWGT,
					DTL.EMTFLG,

DTL.CTRONEFLG ,
					DTL.FRNONEFLG ,
					DTL.RERONEFLG,
					DTL.MAIDEKFLG,
					TAG.SEGSERNUM,
					DTL.MAGFLG,
					DTL.LDPPLNRMK
FROM
OPRULDINSDTL DTL
				JOIN OPRFLTSEG FLT
					ON DTL.CMPCOD     = FLT.CMPCOD
					AND DTL.FLTNUM    =
FLT.FLTNUM
					AND DTL.FLTCARIDR = FLT.FLTCARIDR
					AND DTL.FLTSEQNUM = FLT.FLTSEQNUM
					AND DTL.SEGSERNUM
= FLT.SEGSERNUM
				INNER JOIN OPRULDTAG  TAG
					ON DTL.CMPCOD     = TAG.CMPCOD
					AND DTL.FLTCARIDR
= TAG.FLTCARIDR
					AND DTL.FLTNUM    = TAG.FLTNUM
					AND DTL.FLTSEQNUM = TAG.FLTSEQNUM
					AND DTL.SEGSERNUM

= TAG.SEGSERNUM
					AND DTL.ULDNUM 	  = TAG.ULDNUM
				WHERE DTL.CMPCOD  	  = ?
      AND
DTL.FLTCARIDR = ?
      AND DTL.FLTNUM = ?
AND DTL.FLTSEQNUM = ?
					AND DTL.ULDNUM    = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<!--Added by A-5117 for ICRD-29421 ends here-->
	<QRY:Definition>
		<QRY:Id>397</QRY:Id>
		<QRY:Source Name="operations.flthandling.findflightbuildupdetails" Type="NATIVE">
			<![CDATA[
				SELECT
  FLTOPRSEG.FLTCARIDR SEGFLTCARIDR,
  FLTOPRSEG.FLTNUM SEGFLTNUM,
  FLTOPRSEG.FLTSEQNUM SEGFLTSEQNUM,


  FLTOPRSEG.SEGSERNUM SEGSEGSERNUM,
  FLTMST.FLTCARIDR,
  FLTMST.FLTNUM,
  FLTMST.FLTDAT,
  FLTMST.FLTROU,

FLTMST.FLTSTA,
  NVL(EXPFLT.FLTOPRSTA,'O')FLTOPRSTA,
  EXPFLT.BDPSTA,
  EXPLEG.STA OPRSTA,
  EXPLEG.STD
OPRSTD,
  EXPLEG.TALNUM,
  EXPLEG.LEGDST,
  EXPLEG.LEGORG,
  EXPLEG.LEGSERNUM,


  (
  CASE
    WHEN
EXPLEG.ATA IS NOT NULL
    THEN EXPLEG.ATA
    WHEN EXPLEG.ETA IS NOT NULL
    THEN
EXPLEG.ETA
    WHEN
EXPLEG.STA IS NOT NULL
    THEN EXPLEG.STA
    ELSE NULL
  END) ARRDAT,
  (
  CASE

    WHEN EXPLEG.ATA
IS NOT NULL
    THEN 'A'
    WHEN EXPLEG.ETA IS NOT NULL
    THEN 'E'
    WHEN EXPLEG.STA
IS NOT NULL

THEN 'S'
    ELSE NULL
  END) ARRDATTYP,
  (
  CASE
    WHEN EXPLEG.ATAUTC IS NOT NULL

    THEN
EXPLEG.ATAUTC
    WHEN EXPLEG.STAUTC IS NOT NULL
    THEN EXPLEG.STAUTC
    ELSE NULL
  END) ARRDATUTC,


  (
  CASE
    WHEN EXPLEG.ATD IS NOT NULL
    THEN EXPLEG.ATD
    WHEN EXPLEG.ETD IS NOT NULL
    THEN

EXPLEG.ETD
    WHEN EXPLEG.STD IS NOT NULL
    THEN EXPLEG.STD
    ELSE NULL
  END) DEPDAT,
  (
  CASE


    WHEN EXPLEG.ATD IS NOT NULL
    THEN 'A'
    WHEN EXPLEG.ETD IS NOT NULL
    THEN 'E'
    WHEN EXPLEG.STD

IS NOT NULL
    THEN 'S'
    ELSE NULL
  END) DEPDATTYP,
  (
  CASE
    WHEN EXPLEG.ATDUTC IS NOT NULL


    THEN EXPLEG.ATDUTC
    WHEN EXPLEG.STDUTC IS NOT NULL
    THEN EXPLEG.STDUTC
    ELSE NULL
  END)
DEPDATUTC,

  FLTOPRSEG.SEGORG SEGPOL,
  FLTOPRSEG.SEGDST SEGPOU,
  FLTOPRSEG.CMPCOD SEGCMPCOD,
  FLTOPRSEG.FLTCARIDR

SEGFLTCARIDR,
  FLTOPRSEG.FLTNUM SEGFLTNUM,
  FLTOPRSEG.FLTSEQNUM SEGFLTSEQNUM,
  FLTOPRSEG.SEGSERNUM

SEGSEGSERNUM,
  SHPMST.DOCOWRIDR DOCOWRIDR,
  SHPMST.DUPNUM DUPNUM,
  SHPMST.SEQNUM SEQNUM,
  SHPMST.CMPCOD

MSTCMPCOD,
  SHPMST.MSTDOCNUM MSTDOCNUM,
  SHPMST.SCCCOD MSTSCCCOD,
  SHPMST.SHPDES MSTSHPDES,
  SHPMST.ORGCOD

MSTORGCOD,
  SHPMST.DSTCOD MSTDSTCOD,
  SHPMST.STDWGTCOD MSTSTDWGTCOD,
  SHPMST.STDDISWGT MSTSTDDISWGT,


SHPMST.PRDNAM MSTPRDNAM,
  SHPMST.PRDPRT MSTPRDPRT,
  SHPMST.SHPPFX,
  SHPMST.STDPCS,
  SHPMST.STDWGT,


SHPMST.GRSVOL,
  SHPMST.CONFLG,
  SHPMST.GRSVOLUNT,


  ULD.CMPCOD ULDCMPCOD,
  ULD.FLTCARIDR ULDFLTCARIDR,


ULD.FLTNUM ULDFLTNUM,
  ULD.FLTSEQNUM ULDFLTSEQNUM,
  ULD.SEGSERNUM ULDSEGSERNUM,
  ULD.BARROWFLG BARROWFLG,


ULD.ULDNUM ULDULDNUM,
  ULD.ULDOCP ULDULDOCP,
  ULD.ULDDST ULDULDDST,
  ULD.GRSWGT,
  ULD.NETWGT,

ULD.THRUNT,

  (
  CASE
    WHEN ULD.BDNITN='THRUNT'
    THEN 'T'
    WHEN ULD.BDNITN='INTUNT'

THEN 'I'
    WHEN
ULD.BDNITN='BDN'
    THEN 'B'
    WHEN ULD.THRUNT = 'Y'
    THEN 'T'
    ELSE 'B'

END)INTTHRFLG,

  ULD.BDNCPLFLG,
  ULD.ULDCTR,
  ULD.TARWGT,
  ULD.ULDVOL,
  ULD.MFTFLG ULDMFTFLG,

ULD.ULDBKGIDR ULDBKGIDR,

  ULD.ULDVOL ULDVOL,
  ULD.LWRDCKONE LWRDCKONE,
  ULD.LWRDCKTWO LWRDCKTWO,

ULD.UPRDCKONE,
  ULD.UPRDCKTWO,

  ULD.RMK ULDRMK,
  ULD.ACTWGT ACTWGT,
  ULDSHP.CUSREF SHPCUSREF,

ULDSHP.MFTPCS SHPPCS,
  ULDSHP.MFTWGT
SHPWGT,
  ULDSHP.MFTVOL SHPVOL,
  ULDSHP.FLTCARIDR SHPFLTCARIDR,

ULDSHP.FLTNUM SHPFLTNUM,
  ULDSHP.FLTSEQNUM
SHPFLTSEQNUM,
  ULDSHP.SEGSERNUM SHPSEGSERNUM,
  CASE

WHEN ULD.BARROWFLG = 'Y'
    THEN 'BULK'

ELSE ULDSHP.ULDNUM
  END SHPULDNUM,
  ULDSHP.DOCOWRIDR
SHPDOCOWRIDR,
  ULDSHP.MSTDOCNUM SHPMSTDOCNUM,

ULDSHP.DUPNUM SHPDUPNUM,
  ULDSHP.SEQNUM SHPSEQNUM,

ULDSHP.RMK SHPRMK,
  ULDSHP.CMPCOD SHPCMPCOD,

  ULDSHP.LODPRT,
  ULDSHP.RCVPCS SHPRCVPCS,
  ULDSHP.RCVWGT
SHPRCVWGT,

  ULDSHP.BDPPCS SHPBDPPCS,

  ULDSHP.BDPWGT SHPBDPWGT,
  ULDSHP.BDPVOL SHPBDPVOL,
  ULDSHP.ADDSCC
ADDSCCSCCCOD,
  RTG.SERNUM RTGSERNUM,

  RTG.SEGSERNUM RTGSEGSERNUM,
  RTG.FLTSEQNUM RTGFLTSEQNUM,

RTG.FLTNUM RTGFLTNUM,
  RTG.FLTCARIDR RTGCARIDR,

  RTG.CMPCOD RTGCMPCOD,
  ULD.BARROWFLG BARROWFLG,

CASE
    WHEN ULD.BARROWFLG = 'Y'
    THEN 'BULK'

    ELSE RTG.ULDNUM
  END RTGULDNUM,
  RTG.THRCARIDR
RTGTHRCARIDR,
  RTG.THRCARCOD RTGTHRCARCOD,
  RTG.THRFLTNUM
RTGTHRFLTNUM,
  RTG.THRFLTDAT RTGTHRFLTDAT,

RTG.THRDSTCOD RTGTHRDSTCOD,
  SEGSHP.PLNPCS,
  SEGSHP.PLNWGT,

SEGSHP.PLNVOL,
  SEGSHP.MFTPCS SEGSHPMFTPCS,

SEGSHP.MFTWGT SEGSHPMFTWGT,
  SEGSHP.MFTVOL SEGSHPMFTVOL,

  SEGSHP.BDPPCS SEGSHPBDPPCS,
  SEGSHP.BDPWGT
SEGSHPBDPWGT,
  SEGSHP.BDPVOL SEGSHPBDPVOL,
  SHPMIS.SCICOD,

  SHPMIS.CRSREFONE,
  SHPOCI.CNTCOD,

SHPOCI.CUSINF,
  SHPOCI.CUSINFIDF,
  SHPOCI.INFIDF,
  BKGFLTDTL.FLTORG
ONWFLTORG,
  BKGFLTDTL.MSTDOCNUM
BKGMSTDOCNUM,
  BKGFLTDTL.FLTCARIDR ONWFLTCARIDR,
  BKGFLTDTL.FLTCARCOD
ONWFLTCARCOD,
  BKGFLTDTL.FLTNUM
ONWFLTNUM,
  BKGFLTDTL.FLTSEQNUM ONWFLTSEQNUM,
  BKGFLTDTL.NUMPCS BKDPCS,

BKGFLTDTL.WGT BKDWGT,

BKGFLTDTL.FLTDST ONWFLTDST,
  BKGFLTDTL.UBRNUM UBRNUM,
  BKGFLTDTL.SERNUM BKGDTLSERNUM,

  NVL (ONRLEG.STD,BKGFLTDTL.FLTDAT)
ONWSTD,
  SHPDIM.DIMSERNUM SHPDIMSERNUM,
  SHPDIM.WGTCOD SHPDIMWGTCOD,

  SHPDIM.WGT SHPDIMWGT,
  SHPDIM.MIPUNTCOD
SHPDIMMIPUNTCOD,
  SHPDIM.PCSLEN SHPDIMPCSLEN,
  SHPDIM.PCSWID
SHPDIMPCSWID,
  SHPDIM.PCSHGT SHPDIMPCSHGT,

SHPDIM.NUMPCS SHPDIMNUMPCS,
  OTHSRV.OTHSRVINF OTHSRVOTHSRVINF,

  SHPMST.HDLINF
FROM  FLTOPRMST FLTMST

INNER JOIN FLTOPRSEG FLTOPRSEG
ON (FLTOPRSEG.FLTNUM    = FLTMST.FLTNUM
AND
FLTOPRSEG.FLTCARIDR = FLTMST.FLTCARIDR
AND
FLTOPRSEG.CMPCOD    = FLTMST.CMPCOD
AND FLTOPRSEG.FLTSEQNUM
= FLTMST.FLTSEQNUM)

INNER JOIN FLTOPRLEG
EXPLEG
ON (FLTOPRSEG.FLTSEQNUM = EXPLEG.FLTSEQNUM
AND FLTOPRSEG.FLTNUM
= EXPLEG.FLTNUM
AND FLTOPRSEG.FLTCARIDR
= EXPLEG.FLTCARIDR
AND FLTOPRSEG.CMPCOD    = EXPLEG.CMPCOD
AND
FLTOPRSEG.SEGORG    = EXPLEG.LEGORG)

LEFT
OUTER JOIN OPRARPEXPFLT EXPFLT
ON EXPFLT.FLTNUM     = EXPLEG.FLTNUM
AND EXPFLT.FLTCARIDR = EXPLEG.FLTCARIDR
AND
EXPFLT.FLTSEQNUM = EXPLEG.FLTSEQNUM
AND EXPFLT.LEGSERNUM = EXPLEG.LEGSERNUM
AND EXPFLT.ARPCOD    = EXPLEG.LEGORG
AND
EXPFLT.CMPCOD    = EXPLEG.CMPCOD

LEFT OUTER JOIN OPRSEGULD ULD
ON (FLTOPRSEG.FLTCARIDR = ULD.FLTCARIDR
AND

FLTOPRSEG.FLTNUM    = ULD.FLTNUM
AND FLTOPRSEG.FLTSEQNUM = ULD.FLTSEQNUM
AND FLTOPRSEG.CMPCOD    = ULD.CMPCOD
AND

FLTOPRSEG.SEGSERNUM = ULD.SEGSERNUM)
LEFT OUTER JOIN OPRSEGULDSHP ULDSHP
ON (ULD.FLTNUM    = ULDSHP.FLTNUM
AND

ULD.FLTSEQNUM = ULDSHP.FLTSEQNUM
AND ULD.FLTCARIDR = ULDSHP.FLTCARIDR
AND ULD.SEGSERNUM = ULDSHP.SEGSERNUM
AND

ULD.CMPCOD    = ULDSHP.CMPCOD
AND ULD.ULDNUM    = ULDSHP.ULDNUM)
LEFT OUTER JOIN OPRSEGSHP SEGSHP
ON

(ULDSHP.DOCOWRIDR = SEGSHP.DOCOWRIDR
AND ULDSHP.MSTDOCNUM = SEGSHP.MSTDOCNUM
AND ULDSHP.DUPNUM    =
SEGSHP.DUPNUM
AND
ULDSHP.SEQNUM    = SEGSHP.SEQNUM
AND ULDSHP.CMPCOD    = SEGSHP.CMPCOD
AND ULDSHP.FLTCARIDR
= SEGSHP.FLTCARIDR
AND
ULDSHP.FLTNUM    = SEGSHP.FLTNUM
AND ULDSHP.FLTSEQNUM = SEGSHP.FLTSEQNUM
AND
ULDSHP.SEGSERNUM = SEGSHP.SEGSERNUM)
LEFT
OUTER JOIN OPRULDTHRRTG RTG
ON ( ULD.FLTCARIDR = RTG.FLTCARIDR
AND
ULD.FLTNUM     = RTG.FLTNUM
AND ULD.FLTSEQNUM
= RTG.FLTSEQNUM
AND ULD.SEGSERNUM  = RTG.SEGSERNUM
AND
ULD.CMPCOD     = RTG.CMPCOD
AND ULD.ULDNUM
= RTG.ULDNUM)
LEFT OUTER JOIN OPRSHPMST SHPMST
ON (SEGSHP.DOCOWRIDR
= SHPMST.DOCOWRIDR
AND SEGSHP.MSTDOCNUM
= SHPMST.MSTDOCNUM
AND SEGSHP.DUPNUM    = SHPMST.DUPNUM
AND
SEGSHP.SEQNUM    = SHPMST.SEQNUM
AND SEGSHP.CMPCOD
= SHPMST.CMPCOD)
LEFT OUTER JOIN OPRSHPMSTMIS
SHPMIS
ON (SHPMST.DOCOWRIDR = SHPMIS.DOCOWRIDR
AND SHPMST.MSTDOCNUM
= SHPMIS.MSTDOCNUM
AND SHPMST.DUPNUM
= SHPMIS.DUPNUM
AND SHPMST.SEQNUM    = SHPMIS.SEQNUM
AND SHPMST.CMPCOD
= SHPMIS.CMPCOD)
LEFT OUTER
JOIN OPRSHPOCI SHPOCI
ON (SHPMST.DOCOWRIDR = SHPOCI.DOCOWRIDR
AND SHPMST.MSTDOCNUM
= SHPOCI.MSTDOCNUM
AND
SHPMST.DUPNUM    = SHPOCI.DUPNUM
AND SHPMST.SEQNUM    = SHPOCI.SEQNUM
AND SHPMST.CMPCOD
= SHPOCI.CMPCOD)
LEFT
OUTER JOIN OPRSHPDIMDTL SHPDIM
ON (SHPMST.DOCOWRIDR = SHPDIM.DOCOWRIDR
AND SHPMST.MSTDOCNUM
= SHPDIM.MSTDOCNUM
AND
SHPMST.DUPNUM    = SHPDIM.DUPNUM
AND SHPMST.SEQNUM    = SHPDIM.SEQNUM
AND SHPMST.CMPCOD
= SHPDIM.CMPCOD)
LEFT
OUTER JOIN CAPBKGFLTDTL BKGFLTDTL
ON (SHPMST.MSTDOCNUM =BKGFLTDTL.MSTDOCNUM
AND
SHPMST.DOCOWRIDR =BKGFLTDTL.DOCOWRIDR
AND
SHPMST.DUPNUM    =BKGFLTDTL.DUPNUM
AND SHPMST.SEQNUM    =BKGFLTDTL.SEQNUM
AND
SHPMST.CMPCOD    =BKGFLTDTL.CMPCOD
AND
FLTOPRSEG.SEGDST = BKGFLTDTL.FLTORG
AND BKGFLTDTL.FLTBKGSTA not
in ('X','R'))
LEFT OUTER JOIN FLTOPRLEG
ONRLEG
ON (BKGFLTDTL.FLTSEQNUM = ONRLEG.FLTSEQNUM
AND BKGFLTDTL.FLTNUM
= ONRLEG.FLTNUM
AND BKGFLTDTL.FLTCARIDR
= ONRLEG.FLTCARIDR
AND BKGFLTDTL.FLTORG    = ONRLEG.LEGORG
AND
BKGFLTDTL.CMPCOD    = ONRLEG.CMPCOD)
LEFT
OUTER JOIN OPRSHPOTHSRV OTHSRV
ON (SHPMST.DOCOWRIDR   = OTHSRV.DOCOWRIDR
AND
SHPMST.MSTDOCNUM   = OTHSRV.MSTDOCNUM
AND
SHPMST.DUPNUM      = OTHSRV.DUPNUM
AND SHPMST.SEQNUM      =
OTHSRV.SEQNUM
AND SHPMST.CMPCOD      = OTHSRV.CMPCOD)

WHERE
FLTOPRSEG.FLTCARIDR = ?
AND FLTOPRSEG.FLTNUM
= ?
AND FLTOPRSEG.FLTSEQNUM   = ?
AND FLTOPRSEG.CMPCOD      = ?


			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>392</QRY:Id>
		<QRY:Source Name="operations.flthandling.findDgrDetailsInUld" Type="NATIVE">
			<![CDATA[
	SELECT NTC.ULDNUM,
		   SHPDGR.CMPCOD,
		   SHPDGR.DOCOWRIDR,
		   SHPDGR.MSTDOCNUM,
		   SHPDGR.UNIIDR,

		   SHPDGR.PKGGRP,
		   NTC.PKGHGT,
		   SHPDGR.SHPCLS,
		   SHPDGR.SUBRSKONE,
		   SHPDGR.SUBRSKTWO,

		   SHPDGR.SUBRSKTHR,
		   SHPDGR.ALLPCKSERNUM,
		   SHPDGR.OVRPCKSERNUM,


	   NTC.PCSINNULD PCSINULD,

SHPDGR.CARFLAG,

       SHPDGR.NETQTYUNT,
       SHPDGR.NETQTY,
       SHPDGR.NOOFALLPACKS,

SHPDGR.NOOFOVRPACKS,

       SHPDGR.SCCCOD,
       SHPDGR.SCCCODONE,
       SHPDGR.SCCCODTWO,

SHPDGR.SERNUM SERNUM,

	   SHPDGR.TPTIND,
    SHPDGR.RDOACTFLG,
	SHPDGR.NUMPKG,
	SHPDGR.TOTTPTIND,
	SHPDGR.PKGGRPDIMHGT



			FROM
OPRNTCDGR NTC

		INNER JOIN FLTOPRLEG LEG ON
		NTC.CMPCOD = LEG.CMPCOD
AND NTC.FLTNUM = LEG.FLTNUM


AND NTC.FLTCARIDR = LEG.FLTCARIDR
AND NTC.FLTSEQNUM = LEG.FLTSEQNUM
AND NTC.LEGSERNUM = LEG.LEGSERNUM


		INNER JOIN OPRSHPDGR SHPDGR ON 
		NTC.CMPCOD = SHPDGR.CMPCOD
		AND NTC.MSTDOCNUM = SHPDGR.MSTDOCNUM


		AND NTC.DUPNUM = SHPDGR.DUPNUM
		AND NTC.SEQNUM = SHPDGR.SEQNUM
		AND NTC.DOCOWRIDR = SHPDGR.DOCOWRIDR


		AND NTC.UNIIDR = SHPDGR.UNIIDR
		AND NTC.DGRSERNUM = SHPDGR.SERNUM

		WHERE
			NTC.CMPCOD
= ?
AND NTC.FLTNUM = ?
AND NTC.FLTCARIDR = ?
AND NTC.FLTSEQNUM = ?
AND NTC.ULDNUM = ?
			AND LEG.LEGORG
= ?
			AND NTC.PCSINNULD > 0



















































			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>393</QRY:Id>
		<QRY:Source Name="operations.flthandling.findFreightDisruptionDetails" Type="NATIVE">
			<![CDATA[
		  SELECT ULD.ULDNUM,
		  OPRSEG.POL,
		  OPRSEG.POU,
		  OPRSEG.FLTCARIDR SHPFLTCARIDR,
		  OPRSEG.FLTNUM

SHPFLTNUM,
		  OPRSEG.FLTSEQNUM SHPFLTSEQNUM,
		  OPRSEG.SEGSERNUM SHPSEGSERNUM,
		  EXPFLT.LEGSERNUM

SHPLEGSERNUM,
		  SHP.DOCOWRIDR SHPDOCOWRIDR,
		  SHP.MSTDOCNUM SHPMSTDOCNUM,
		  SHP.DUPNUM SHPDUPNUM,


		  SHP.SEQNUM SHPSEQNUM,
		  SHP.CMPCOD SHPCMPCOD,
		  MST.SCCCOD MSTSCCCOD,
		  MST.ORGCOD MSTORGCOD,


		  MST.DSTCOD MSTDSTCOD,
		  MST.STDWGTCOD MSTSTDWGTCOD,
		  MST.STDDISWGT MSTSTDDISWGT,
		  MST.SHPPFX,


		  MST.STDPCS,
		  MST.STDWGT,
		  MST.GRSVOL,
		  SHP.MFTPCS,
		  MST.SHPDES,
		  MST.CONFLG,

SHP.MFTWGT,
		  SHP.BDPPCS,

		  SHP.BDPWGT,
		  SHP.BDPVOL,
		  EXPFLT.FINFLG,
		  ULD.BARROWFLG,

ULD.ULDCTR,
		  ULD.ULDBKGIDR,
		  ULD.BKGTYP,
		  ULD.BUPFLG,
		  ULD.ULDLKGCNFFLG,
		  ULD.ACTWGT,
		  ULD.THRUNT,
		  MST.PLTFLG,
		(SELECT
		CASE
		WHEN (ARPSHP.PLTUSEFLG = 'Y'
		AND SHPDTL.PLTUSEFLG ='Y')
		THEN 'Y'
		ELSE 'N'
		END pltflg
		FROM OPRARPSHP ARPSHP
		INNER JOIN OPRSHPDTL SHPDTL
		ON ARPSHP.CMPCOD = SHPDTL.CMPCOD
		AND ARPSHP.DOCOWRIDR =SHPDTL.DOCOWRIDR
		AND ARPSHP.MSTDOCNUM =SHPDTL.MSTDOCNUM
		AND ARPSHP.DUPNUM =SHPDTL.DUPNUM
		AND ARPSHP.SEQNUM =SHPDTL.SEQNUM
		WHERE ARPSHP.SEQNUM = SHP.SEQNUM
		AND ARPSHP.CMPCOD = SHP.CMPCOD
		AND ARPSHP.DOCOWRIDR = SHP.DOCOWRIDR
		AND ARPSHP.MSTDOCNUM = SHP.MSTDOCNUM
		AND ARPSHP.DUPNUM = SHP.DUPNUM
		AND ARPSHP.ARPCOD = EXPFLT.ARPCOD
		) PLTUSEFLG
FROM OPRARPEXPFLT EXPFLT,
		  FLTOPRLEG
FLTLEG ,
		  OPRFLTSEG OPRSEG ,
		  OPRSEGULDSHP SHP ,
		  OPRSEGULD
ULD ,
		  OPRSHPMST MST
		WHERE
EXPFLT.FLTNUM    =FLTLEG.FLTNUM
		AND EXPFLT.FLTCARIDR   =FLTLEG.FLTCARIDR

AND EXPFLT.FLTSEQNUM   =FLTLEG.FLTSEQNUM

		AND EXPFLT.CMPCOD      =FLTLEG.CMPCOD
		AND ((EXPFLT.ARPCOD
= FLTLEG.LEGORG
		AND (FLTLEG.LEGSERNUM
<>EXPFLT.LEGSERNUM
		OR FLTLEG.LEGSTA      IN('TBC','CAN')))

OR EXISTS
		  (SELECT 1
		  FROM FLTOPRSEG
FLTSEG
		  WHERE FLTSEG.FLTNUM(+)  =OPRSEG.FLTNUM
		  AND
FLTSEG.CMPCOD(+)    =OPRSEG.CMPCOD
		  AND
FLTSEG.FLTCARIDR(+) =OPRSEG.FLTCARIDR
		  AND FLTSEG.FLTSEQNUM(+)
=OPRSEG.FLTSEQNUM
		  AND FLTSEG.SEGSERNUM(+)
=OPRSEG.SEGSERNUM
		  AND(FLTSEG.SEGSTA       ='D')

) )
		AND EXPFLT.FLTNUM   =OPRSEG.FLTNUM
		AND
EXPFLT.CMPCOD   =OPRSEG.CMPCOD
		AND EXPFLT.FLTCARIDR=OPRSEG.FLTCARIDR

AND EXPFLT.FLTSEQNUM=OPRSEG.FLTSEQNUM

		AND EXPFLT.ARPCOD   =OPRSEG.POL
		AND OPRSEG.FLTCARIDR=ULD.FLTCARIDR

AND OPRSEG.FLTNUM   =ULD.FLTNUM

		AND OPRSEG.FLTSEQNUM=ULD.FLTSEQNUM
		AND OPRSEG.SEGSERNUM=ULD.SEGSERNUM

AND OPRSEG.CMPCOD   =ULD.CMPCOD

		AND ULD.FLTCARIDR   =SHP.FLTCARIDR(+)
		AND ULD.FLTNUM      =SHP.FLTNUM(+)

AND ULD.FLTSEQNUM   =SHP.FLTSEQNUM(+)

		AND ULD.SEGSERNUM   =SHP.SEGSERNUM(+)
		AND ULD.ULDNUM
=SHP.ULDNUM(+)
		AND ULD.CMPCOD      =SHP.CMPCOD(+)

		AND MST.MSTDOCNUM(+)=SHP.MSTDOCNUM
		AND MST.DOCOWRIDR(+)=SHP.DOCOWRIDR

AND MST.DUPNUM(+)   =SHP.DUPNUM

		AND MST.SEQNUM(+)   =SHP.SEQNUM
		AND MST.CMPCOD(+)   =SHP.CMPCOD

AND EXPFLT.CMPCOD   =?
		AND EXPFLT.FLTCARIDR=
?
		AND EXPFLT.FLTNUM   =?
		AND EXPFLT.FLTDAT   =?

AND EXPFLT.ARPCOD = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>399</QRY:Id>
		<QRY:Source Name="operations.flthandling.findIRPsWithOrdinoDetails" Type="NATIVE">
			<![CDATA[
	SELECT distinct CHG.PAYTYP,MST.DOMFLG,MST.MSTDOCNUM, MST.DOCOWRIDR, MST.OWRCOD,MST.DUPNUM, MST.SEQNUM, MST.CMPCOD,
MST.SHPPFX,
MST.ORGCOD, MST.DSTCOD,MST.STDPCS, MST.STDWGT, MST.STDWGTCOD, ORO.OROPCS ,
ORO.OROWGT ,MST.SHPDES,MST.EXESTN,
COALESCE(Mst.Exedat,MST.CPTDAT) ISSDAT,MST.SHPCOD,MST.CNSCOD,
CNT.SHPACCNUM, CNT.SHPTELNUM, CNT.SHPSTT,
CNT.SHPCTY, CNT.SHPCTR, CNT.CNSACCNUM,
CNT.CNSCTR, CNT.CNSCTY, CNT.CNSSTT, CNT.CNSTELNUM,MST.AGTCOD,MST.SCCCOD,MST.PRDNAM,

MST.SHPNAM, MST.SHPADRONE, MST.CNSNAM, MST.CNSADRONE,
ORO.FLTCARIDR,ORO.FLTNUM,ORO.FLTSEQNUM,ORO.OROISSDAT,CNT.CNSMALIDR,ORO.ORONUM,FLT.FLTDAT,
CASE
WHEN ORO.OROISSDAT + IRP1.PARVAL < SYSDATE AND ORO.IRPLMTNFY IS NULL
THEN '1IRP'
WHEN ORO.OROISSDAT +
IRP2.PARVAL < SYSDATE AND ORO.IRPLMTNFY = '1IRP'
THEN '2IRP'
WHEN ORO.OROISSDAT + IRP3.PARVAL < SYSDATE
AND ORO.IRPLMTNFY = '2IRP'
THEN '3IRP'
END IRP
FROM OPRSHPMST MST
INNER JOIN OPRARPSHP ARPSHP
ON MST.MSTDOCNUM
= ARPSHP.MSTDOCNUM
AND MST.DOCOWRIDR = ARPSHP.DOCOWRIDR
AND MST.DUPNUM = ARPSHP.DUPNUM
AND MST.SEQNUM
= ARPSHP.SEQNUM
AND MST.CMPCOD = ARPSHP.CMPCOD
AND MST.DSTCOD = ARPSHP.ARPCOD
INNER JOIN OPRSEGSHP SEGSHP
ON
SEGSHP.MSTDOCNUM = MST.MSTDOCNUM
AND SEGSHP.DOCOWRIDR = MST.DOCOWRIDR
AND SEGSHP.DUPNUM = MST.DUPNUM
AND
SEGSHP.SEQNUM = MST.SEQNUM
AND SEGSHP.CMPCOD = MST.CMPCOD
INNER JOIN OPRFLTORO ORO
ON ORO.MSTDOCNUM =
MST.MSTDOCNUM
AND ORO.DOCOWRIDR = MST.DOCOWRIDR
AND ORO.DUPNUM = MST.DUPNUM
AND ORO.SEQNUM = MST.SEQNUM
AND
ORO.FLTCARIDR = SEGSHP.FLTCARIDR
AND ORO.FLTNUM = SEGSHP.FLTNUM
AND ORO.FLTSEQNUM = SEGSHP.FLTSEQNUM
AND
ORO.CMPCOD = SEGSHP.CMPCOD
INNER JOIN FLTOPRMST FLT
ON FLT.FLTCARIDR = SEGSHP.FLTCARIDR
AND FLT.FLTNUM
= SEGSHP.FLTNUM
AND FLT.FLTSEQNUM = SEGSHP.FLTSEQNUM
AND FLT.CMPCOD = SEGSHP.CMPCOD
INNER JOIN OPRSHPMSTCNT
CNT
ON CNT.DOCOWRIDR = MST.DOCOWRIDR
AND CNT.MSTDOCNUM = MST.MSTDOCNUM
 AND CNT.DUPNUM = MST.DUPNUM

AND CNT.SEQNUM = MST.SEQNUM
 AND CNT.CMPCOD = MST.CMPCOD
 LEFT OUTER JOIN OPRSHPCHGDTL CHG
ON CHG.DOCOWRIDR
= MST.DOCOWRIDR
AND CHG.MSTDOCNUM = MST.MSTDOCNUM
AND CHG.DUPNUM    = MST.DUPNUM
AND CHG.SEQNUM    =
MST.SEQNUM
AND CHG.CMPCOD    = MST.CMPCOD
LEFT OUTER JOIN SHRUSEARPPAR IRP1
ON IRP1.CMPCOD = ARPSHP.CMPCOD
AND
IRP1.ARPCOD = ARPSHP.ARPCOD
AND IRP1.PARCOD = 'operations.flthandling.firstIRPLimit'
LEFT OUTER JOIN
SHRUSEARPPAR IRP2
ON IRP2.CMPCOD = ARPSHP.CMPCOD
AND IRP2.ARPCOD = ARPSHP.ARPCOD
AND IRP2.PARCOD = 'operations.flthandling.secondIRPLimit'
LEFT
OUTER JOIN SHRUSEARPPAR IRP3
ON IRP3.CMPCOD = ARPSHP.CMPCOD
AND IRP3.ARPCOD = ARPSHP.ARPCOD
AND IRP3.PARCOD
= 'operations.shipment.cto.irpperiod'
WHERE ARPSHP.CMPCOD = ?
AND ARPSHP.SEQNUM = 1
AND OROSTA <> 'D'
AND
((ORO.OROISSDAT + IRP1.PARVAL < SYSDATE AND ORO.IRPLMTNFY IS NULL )
OR (ORO.OROISSDAT + IRP2.PARVAL <
SYSDATE AND ORO.IRPLMTNFY = '1IRP' )
OR (ORO.OROISSDAT + IRP3.PARVAL < SYSDATE AND ORO.IRPLMTNFY = '2IRP' ))
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>400</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.tk.findordinodetails" Type="NATIVE">
			<![CDATA[
    Select
  Mst.Mstdocnum,
  Mst.CNSNAM,
  Mst.CNSCOD,
   ( CASE WHEN (MST.CNSCOD like SYSPAR.PARVAL
)
	  THEN CNT.CNSTELNUM
	  ELSE
	  COALESCE (CUS.PHNONE,CUS.MOBNUM)END) PHNONE,
  CST.REGNUM ,
CST.REGDAT
,
  PAR.PARVAL CUSARPCOD,
  Mst.Docowridr,
  Mst.Dupnum,
  Mst.Seqnum,
  Mst.Cmpcod,
  Mst.Shppfx,

LEG.STA,
  Mst.Orgcod,
  Mst.Dstcod,
  Mst.Stdpcs,
  Mst.Stdwgt,
  ORO.OROPCS ,
  Oro.Orowgt ,
  NVL(CSTSHPDTL.TRSSHPDES,Mst.Shpdes)
Shpdes,
  Mst.Scccod,
  Segshp.Rcvpcs,
  Segshp.Rcvwgt,
  Segshp.Mftpcs,
  Segshp.Mftwgt ,
  Oro.Oroissdat,

Oro.ORODLVDAT,
  Oro.Orosta,
  ORO.ARPCOD,
  Segshp.Fltcaridr,
  ARL.TWOAPHCOD,
  SEGSHP.FLTNUM,
  SEGSHP.FLTSEQNUM,

SEGSHP.SEGSERNUM,
  ORO.ORONUM,
  Oro.Irplmtnfy ,
  ORO.IRPNFYDAT ,
  Impflt.Clsflg,flthis.STRTIM,

MST.DOMFLG,Arpshp.DOCRCVFLG,Arpshp.DOCHDRFLG,
  Arpshp.HDRTOO,
  Arpshp.HDRTIM,
  Arpshp.HDRRMK,
  Mst.SHPNAM,

Mst.CNSADRONE,
  MSTCNT.CNSADRTWO,
	MSTCNT.CNSSTT,
	MSTCNT.CNSCTR,
	MSTCNT.CNSCTY,
	MSTCNT.CNSPSTCOD,

MSTCNT.CNSMALIDR,
   ATRDTL.PARVAL BNDWHSCOD,
  ROW_NUMBER()OVER(PARTITION BY Mst.Docowridr, Mst.Dupnum,Mst.Seqnum,Mst.Cmpcod,Mst.Mstdocnum,

Segshp.Fltcaridr,SEGSHP.FLTNUM,SEGSHP.FLTSEQNUM,LEG.STA order by Mst.Docowridr, Mst.Dupnum,
  Mst.Seqnum,Mst.Cmpcod,Mst.Mstdocnum,Segshp.Fltcaridr,SEGSHP.FLTNUM,SEGSHP.FLTSEQNUM,LEG.STA)rnum
FROM
OPRSHPMST MST
Inner Join Oprarpshp Arpshp
On Mst.Docowridr = Arpshp.Docowridr
And Mst.Mstdocnum =Arpshp.Mstdocnum
And
Mst.Dupnum =Arpshp.Dupnum
And Mst.Seqnum =Arpshp.Seqnum
AND Mst.CMPCOD =Arpshp.CMPCOD
LEFT OUTER JOIN
SHRSYSPAR SYSPAR
ON MST.CMPCOD= SYSPAR.CMPCOD
AND SYSPAR.PARCOD='common.customer.walkincustomer'
LEFT
OUTER JOIN SHRUSEARPPAR PAR
ON Mst.CMPCOD=PAR.CMPCOD
AND Arpshp.ARPCOD=PAR.ARPCOD
AND PAR.PARCOD='shared.area.airport.trsCustomsReferenceCode'
LEFT
OUTER JOIN CSTTRSARPSHP CST
ON MST.MSTDOCNUM=CST.MSTDOCNUM
AND MST.DOCOWRIDR=CST.DOCOWRIDR
AND MST.DUPNUM=CST.DUPNUM
AND
MST.SEQNUM=CST.SEQNUM
AND MST.CMPCOD=CST.CMPCOD
LEFT OUTER JOIN OPRSHPMSTCNT  MSTCNT
ON MSTCNT.MSTDOCNUM
= MST.MSTDOCNUM
AND MSTCNT.DOCOWRIDR = MST.DOCOWRIDR
AND MSTCNT.DUPNUM = MST.DUPNUM
AND MSTCNT.SEQNUM
= MST.SEQNUM
AND MSTCNT.Cmpcod = Mst.Cmpcod
LEFT OUTER JOIN SHRCUSMST CUS
ON CUS.CMPCOD=MST.CMPCOD
AND
CUS.CUSCOD=MST.CNSCOD
LEFT OUTER JOIN OPRSHPMSTCNT CNT
ON MST.MSTDOCNUM=CNT.MSTDOCNUM
AND MST.DOCOWRIDR=CNT.DOCOWRIDR
AND
MST.DUPNUM=CNT.DUPNUM
AND MST.SEQNUM=CNT.SEQNUM
AND MST.CMPCOD=CNT.CMPCOD
INNER JOIN OPRSEGSHP SEGSHP
ON
SEGSHP.MSTDOCNUM = MST.MSTDOCNUM
AND SEGSHP.DOCOWRIDR = MST.DOCOWRIDR
AND SEGSHP.DUPNUM = MST.DUPNUM
AND
SEGSHP.SEQNUM = MST.SEQNUM
AND Segshp.Cmpcod = Mst.Cmpcod
AND SEGSHP.MFTPCS>0
INNER JOIN FLTOPRLEG LEG
ON
LEG.FLTCARIDR = SEGSHP.FLTCARIDR
AND LEG.FLTNUM = SEGSHP.FLTNUM
And LEG.Fltseqnum = Segshp.Fltseqnum
And
Leg.Cmpcod = Segshp.Cmpcod
LEFT OUTER JOIN OPRARPIMPFLT IMPFLT
ON IMPFLT.FLTCARIDR = Leg.FLTCARIDR
AND
IMPFLT.FLTNUM = Leg.FLTNUM
And Impflt.Fltseqnum = Leg.Fltseqnum
And IMPFLT.LEGSERNUM = Leg.LEGSERNUM
And
Impflt.Cmpcod = Leg.Cmpcod
LEFT OUTER JOIN Oprimpflthis flthis
ON flthis.FLTCARIDR = Leg.FLTCARIDR
AND
flthis.FLTNUM = Leg.FLTNUM
And flthis.Fltseqnum = Leg.Fltseqnum
And flthis.LEGSERNUM = Leg.LEGSERNUM
And
flthis.Cmpcod = Leg.Cmpcod
and flthis.TXNCOD ='BDN'
LEFT OUTER JOIN OPRFLTORO ORO
ON ORO.MSTDOCNUM =
MST.MSTDOCNUM
AND ORO.DOCOWRIDR = MST.DOCOWRIDR
AND ORO.DUPNUM = MST.DUPNUM
AND ORO.SEQNUM = MST.SEQNUM
AND
ORO.FLTCARIDR = SEGSHP.FLTCARIDR
AND ORO.FLTNUM = SEGSHP.FLTNUM
AND ORO.FLTSEQNUM = SEGSHP.FLTSEQNUM
And
Oro.Cmpcod = Segshp.Cmpcod
Left outer join WHSOPRSHPLOC shploc
ON ORO.Docowridr = shploc.Docowridr
AND
ORO.Mstdocnum =shploc.Mstdocnum
AND ORO.Dupnum =shploc.Dupnum
AND ORO.Seqnum =shploc.Seqnum
AND ORO.ARPCOD
=shploc.Arpcod
AND ORO.CMPCOD =shploc.CMPCOD
Left outer join WHSLOCMST locmst
on shploc.ARPCOD=locmst.ARPCOD
and
shploc.WHSCOD=locmst.WHSCOD
And shploc.LOCCOD=locmst.LOCCOD
and shploc.cmpcod=locmst.cmpcod
Left outer
JOIN WHSZONATRDTL ATRDTL
ON locmst.CMPCOD = ATRDTL.CMPCOD
AND locmst.ARPCOD = ATRDTL.ARPCOD
AND locmst.WHSCOD
= ATRDTL.WHSCOD
AND locmst.ZONCOD = ATRDTL.ZONCOD
AND ATRDTL.PARCOD = 'BNGWHSCOD'
 LEFT OUTER JOIN CSTTRSSHPDTL
CSTSHPDTL
       ON CSTSHPDTL.REPTYP='I'
       AND CSTSHPDTL.MSTDOCNUM=Mst.Mstdocnum
       AND CSTSHPDTL.DOCOWRIDR=Mst.Docowridr

AND CSTSHPDTL.DUPNUM=Mst.Dupnum
       AND CSTSHPDTL.SEQNUM=Mst.SEQNUM
       AND CSTSHPDTL.CSTAUTCOD
= 'TRS'
       AND CSTSHPDTL.CMPCOD= ?
INNER JOIN SHRARLACTMST ARL
ON Arl.Cmpcod = SEGSHP.Cmpcod
AND
ARL.ARLIDR = SEGSHP.FLTCARIDR
Where Mst.Cmpcod = ?
And (Mst.Dstcod = ? or ORO.oronum is not null)
And
Arpshp.Docrcvflg ='Y'
And Mst.Seqnum = 1
AND ( (((ORO.orosta <> 'P'
AND Oro.ARPCOD      <> Mst.Dstcod)
OR
(Oro.ARPCOD       = Mst.Dstcod))
AND Oro.ARPCOD       = Arpshp.Arpcod)
OR (Oro.ARPCOD      IS NULL
AND
Mst.Dstcod       = Arpshp.Arpcod) )
AND ( (Leg.Legdst    = Oro.ARPCOD
AND ((ORO.orosta    <> 'P'
AND
Oro.ARPCOD      <> Mst.Dstcod)
OR (Oro.ARPCOD       = Mst.Dstcod)))
OR (Oro.ARPCOD      IS NULL
AND Leg.Legdst
= Mst.Dstcod) )
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>401</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.tk.checkForIntermediateOrdino" Type="NATIVE">
			<![CDATA[
   Select
  ORO.Mstdocnum,
  ORO.Docowridr,
  ORO.Dupnum,
  ORO.Seqnum,
  ORO.Cmpcod,
  Mst.Shppfx,
  ORO.ARPCOD,
  Oro.Oroissdat,
  Oro.Orosta,
  ORO.Fltcaridr,
  ORO.FLTNUM,
  ORO.FLTSEQNUM,
  ORO.ORONUM
From Oprfltoro Oro Join
Oprshpmst Mst
ON Oro.MSTDOCNUM = MST.MSTDOCNUM
AND Oro.DOCOWRIDR = MST.DOCOWRIDR
AND Oro.DUPNUM = MST.DUPNUM
AND Oro.SEQNUM = MST.SEQNUM
AND Oro.Cmpcod = Mst.Cmpcod
Where Oro.Cmpcod = ?
And Oro.Arpcod != ?
And Oro.Docowridr = ?
And Oro.Mstdocnum = ?
And Oro.Seqnum = ?
And ORO.dupnum = ?
and ORO.oronum is not null
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>400</QRY:Id>
		<QRY:Source Name="operations.flthandling.findBreakdownhistorydetailsforuld" Type="OBJECT">
			<![CDATA[
SELECT
uldBreakDownHistory
FROM
BreakdownHistory as uldBreakDownHistory
WHERE
uldBreakDownHistory.breakdownHistoryPK.companyCode= ? and
uldBreakDownHistory.breakdownHistoryPK.airportCode= ? and
uldBreakDownHistory.breakdownHistoryPK.carrierId= ? and
uldBreakDownHistory.breakdownHistoryPK.flightNumber= ? and
uldBreakDownHistory.breakdownHistoryPK.flightSequenceNumber= ? and
uldBreakDownHistory.breakdownHistoryPK.legSerialNumber= ? and
uldBreakDownHistory.breakdownHistoryPK.uldNumber= ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>402</QRY:Id>
		<QRY:Source Name="operations.flthandling.findHandlingAgreementInterfaceDetails" Type="OBJECT">
			<![CDATA[
			SELECT *
				FROM
					( WITH QFDFLT AS
					(SELECT FLTLEG.STD,
					  FLTLEG.STA,
					  FLTLEG.STDUTC,
					  FLTLEG.STAUTC,
					  FLTLEG.LEGSERNUM,
					  FLTLEG.FLTCARIDR,
					  FLTLEG.FLTSEQNUM,
					  FLTLEG.FLTNUM,
					  FLTLEG.CMPCOD,
					  FLTLEG.LEGORG,
					  FLTLEG.LEGDST,
					  FLTSEG.SEGORG,
        FLTLEG.TALNUM,
					  FLTSEG.SEGDST,
					  FLTSEG.SEGSERNUM,
					  FLTLEG.ACRTYP,
					  ACTMST.TWOAPHCOD,
					  (SELECT STD
					  FROM FLTOPRLEG LEG
					  WHERE LEG.cmpcod  = FLTMST.cmpcod
					  AND LEG.fltnum    = FLTMST.fltnum
					  AND LEG.fltseqnum = FLTMST.fltseqnum
					  AND LEG.fltcaridr = FLTMST.fltcaridr
					  AND LEG.legorg    = FLTMST.fltorg
					  ) FLTDAT,
					  (SELECT COUNT(ULDSEG.MALIDR)
					  FROM MTKMALULDSEG ULDSEG
					  WHERE ULDSEG.CMPCOD  =FLTSEG.cmpcod
					  AND ULDSEG.FLTNUM    = FLTSEG.FLTNUM
					  AND ULDSEG.FLTSEQNUM = FLTSEG.FLTSEQNUM
					  AND ULDSEG.FLTCARIDR = FLTSEG.FLTCARIDR
					  AND ULDSEG.SEGSERNUM = FLTSEG.SEGSERNUM
					  AND ULDSEG.ACPSTA    = 'Y'
					  ) EXPBAGCNT,
					  (SELECT SUM(ULDSEG.WGT)
					  FROM MTKMALULDSEG ULDSEG
					  WHERE ULDSEG.CMPCOD  =FLTSEG.cmpcod
					  AND ULDSEG.FLTNUM    = FLTSEG.FLTNUM
					  AND ULDSEG.FLTSEQNUM = FLTSEG.FLTSEQNUM
					  AND ULDSEG.FLTCARIDR = FLTSEG.FLTCARIDR
					  AND ULDSEG.SEGSERNUM = FLTSEG.SEGSERNUM
					  AND ULDSEG.ACPSTA    = 'Y'
					  ) EXPBAGWGT,
					  (SELECT COUNT(ULDSEG.MALIDR)
					  FROM MTKMALULDSEG ULDSEG
					  WHERE ULDSEG.CMPCOD  =FLTSEG.cmpcod
					  AND ULDSEG.FLTNUM    = FLTSEG.FLTNUM
					  AND ULDSEG.FLTSEQNUM = FLTSEG.FLTSEQNUM
					  AND ULDSEG.FLTCARIDR = FLTSEG.FLTCARIDR
					  AND ULDSEG.SEGSERNUM = FLTSEG.SEGSERNUM
					  AND ULDSEG.ARRSTA    = 'Y'
					  ) IMPBAGCNT,
					  (SELECT SUM(ULDSEG.WGT)
					  FROM MTKMALULDSEG ULDSEG
					  WHERE ULDSEG.CMPCOD  =FLTSEG.cmpcod
					  AND ULDSEG.FLTNUM    = FLTSEG.FLTNUM
					  AND ULDSEG.FLTSEQNUM = FLTSEG.FLTSEQNUM
					  AND ULDSEG.FLTCARIDR = FLTSEG.FLTCARIDR
					  AND ULDSEG.SEGSERNUM = FLTSEG.SEGSERNUM
					  AND ULDSEG.ARRSTA    = 'Y'
					  ) IMPBAGWGT,
					  FLTMST.FLTORG,
					  (
					  CASE
						WHEN ((SELECT COUNT(1)
						  FROM SHRUSEARPPAR ARPPAR
						  WHERE ARPPAR.CMPCOD          = FLTLEG.CMPCOD
						  AND ARPPAR.PARCOD            = 'operations.flthandling.offlineflagforhainterface'
						  AND ARPPAR.ARPCOD           IN(FLTSEG.SEGDST)
						  AND NVL(ARPPAR.PARVAL, 'Y') <> 'Y' ) = 1)
						THEN 'I'
						ELSE 'E'
					  END) IMPEXPFLG
					FROM FLTOPRLEG FLTLEG
					INNER JOIN SHRARLACTMST ACTMST
					ON ACTMST.CMPCOD  = FLTLEG.CMPCOD
					AND ACTMST.ARLIDR = FLTLEG.FLTCARIDR
					INNER JOIN FLTOPRSEG FLTSEG
					ON FLTSEG.CMPCOD     = FLTLEG.CMPCOD
					AND FLTSEG.FLTNUM    = FLTLEG.FLTNUM
					AND FLTSEG.FLTSEQNUM = FLTLEG.FLTSEQNUM
					AND FLTSEG.FLTCARIDR = FLTLEG.FLTCARIDR
					INNER JOIN FLTOPRMST FLTMST
					ON FLTSEG.CMPCOD     = FLTMST.CMPCOD
					AND FLTSEG.FLTNUM    = FLTMST.FLTNUM
					AND FLTSEG.FLTSEQNUM = FLTMST.FLTSEQNUM
					AND FLTSEG.FLTCARIDR = FLTMST.FLTCARIDR
					WHERE FLTLEG.CMPCOD    = ?
					AND TRUNC(FLTLEG.STD) >= TRUNC(?)
					AND TRUNC(FLTLEG.STD) <= TRUNC(?)
					AND (FLTLEG.LEGDST     = (
					  CASE
						WHEN ((SELECT COUNT(1)
						  FROM SHRUSEARPPAR ARPPAR
						  WHERE ARPPAR.CMPCOD = FLTLEG.CMPCOD
						  AND ARPPAR.PARCOD   = 'operations.flthandling.offlineflagforhainterface'
						  AND ARPPAR.ARPCOD  IN(FLTSEG.SEGDST)
						  AND ARPPAR.PARVAL   = 'N' ) > 0)
						THEN FLTSEG.SEGDST
						ELSE NULL
					  END)
  OR FLTLEG.LEGDST = FLTSEG.SEGDST)
					)
				  SELECT QFDFLT.FLTNUM,
					QFDFLT.FLTCARIDR,
					QFDFLT.FLTSEQNUM,
					QFDFLT.TWOAPHCOD,
					QFDFLT.CMPCOD,
					QFDFLT.FLTDAT,
					QFDFLT.FLTORG,
					QFDFLT.STD,
					QFDFLT.STDUTC,
					QFDFLT.STA,
					QFDFLT.STAUTC,
					QFDFLT.LEGORG,
					QFDFLT.LEGDST,
  QFDFLT.TALNUM,
					QFDFLT.SEGORG,
					QFDFLT.LEGSERNUM,
					QFDFLT.SEGSERNUM,
					QFDFLT.SEGDST,
					QFDFLT.ACRTYP,
					QFDFLT.IMPEXPFLG,
					SEGSHP.DOCOWRIDR,
					SEGSHP.MSTDOCNUM,
					SEGSHP.DUPNUM,
					SEGSHP.SEQNUM,
					SEGSHP.MFTPCS,
					SEGSHP.MFTWGT,
					SEGSHP.RCVPCS,
					SEGSHP.RCVWGT,
					SHPMST.SHPPFX,
					SHPMST.PRDCOD,
					SHPMST.PRDNAM,
					SHPMST.SCCCOD,
					ULDTYP.ULDTYP,
					SEGULD.ULDNUM,
					QFDFLT.EXPBAGCNT,
					QFDFLT.EXPBAGWGT,
					QFDFLT.IMPBAGCNT,
					QFDFLT.IMPBAGWGT
				  FROM QFDFLT
				  INNER JOIN OPRSEGSHP SEGSHP
				  ON QFDFLT.CMPCOD     = SEGSHP.CMPCOD
				  AND QFDFLT.FLTNUM    = SEGSHP.FLTNUM
				  AND QFDFLT.FLTCARIDR = SEGSHP.FLTCARIDR
				  AND QFDFLT.FLTSEQNUM = SEGSHP.FLTSEQNUM
				  AND QFDFLT.SEGSERNUM = SEGSHP.SEGSERNUM
					INNER JOIN OPRSEGULDSHP SEGULDSHP
					ON SEGSHP.CMPCOD     = SEGULDSHP.CMPCOD
					AND SEGSHP.FLTNUM    = SEGULDSHP.FLTNUM
					AND SEGSHP.FLTCARIDR = SEGULDSHP.FLTCARIDR
					AND SEGSHP.FLTSEQNUM = SEGULDSHP.FLTSEQNUM
					AND SEGSHP.SEGSERNUM = SEGULDSHP.SEGSERNUM
					AND SEGSHP.MSTDOCNUM = SEGULDSHP.MSTDOCNUM
					AND SEGSHP.DOCOWRIDR = SEGULDSHP.DOCOWRIDR
					AND SEGSHP.SEQNUM    = SEGULDSHP.SEQNUM
					AND SEGSHP.DUPNUM    = SEGULDSHP.DUPNUM
				  INNER JOIN OPRSEGULD SEGULD
					ON SEGULDSHP.CMPCOD     = SEGULD.CMPCOD
					AND SEGULDSHP.FLTNUM    = SEGULD.FLTNUM
					AND SEGULDSHP.FLTCARIDR = SEGULD.FLTCARIDR
					AND SEGULDSHP.FLTSEQNUM = SEGULD.FLTSEQNUM
					AND SEGULDSHP.SEGSERNUM = SEGULD.SEGSERNUM
					AND SEGULDSHP.ULDNUM    = SEGULD.ULDNUM
				  INNER JOIN OPRSHPMST SHPMST
				  ON SEGSHP.CMPCOD     = SHPMST.CMPCOD
				  AND SEGSHP.MSTDOCNUM = SHPMST.MSTDOCNUM
				  AND SEGSHP.DOCOWRIDR = SHPMST.DOCOWRIDR
				  AND SEGSHP.SEQNUM    = SHPMST.SEQNUM
				  AND SEGSHP.DUPNUM    = SHPMST.DUPNUM
				  LEFT OUTER JOIN SHRULDTYPMST ULDTYP
				  ON SUBSTR(SEGULD.ULDNUM, 0, 3) = ULDTYP.ULDTYPCOD
				  AND SEGULD.CMPCOD              = ULDTYP.CMPCOD
				  AND SEGULD.ULDNUM             <> 'BULK'
				  INNER JOIN OPRARPEXPFLT EXPFLT
				  ON QFDFLT.CMPCOD       = EXPFLT.CMPCOD
				  AND QFDFLT.FLTNUM      = EXPFLT.FLTNUM
				  AND QFDFLT.FLTCARIDR   = EXPFLT.FLTCARIDR
				  AND QFDFLT.FLTSEQNUM   = EXPFLT.FLTSEQNUM
				  AND QFDFLT.SEGORG      = EXPFLT.ARPCOD
				  WHERE QFDFLT.IMPEXPFLG = 'E'
				  AND EXPFLT.FLTOPRSTA   = 'F'
				  UNION ALL
				  SELECT QFDFLT.FLTNUM,
					QFDFLT.FLTCARIDR,
					QFDFLT.FLTSEQNUM,
					QFDFLT.TWOAPHCOD,
					QFDFLT.CMPCOD,
					QFDFLT.FLTDAT,
					QFDFLT.FLTORG,
					QFDFLT.STD,
					QFDFLT.STDUTC,
					QFDFLT.STA,
					QFDFLT.STAUTC,
					QFDFLT.LEGORG,
					QFDFLT.LEGDST,
  QFDFLT.TALNUM,
					QFDFLT.SEGORG,
					QFDFLT.LEGSERNUM,
					QFDFLT.SEGSERNUM,
					QFDFLT.SEGDST,
					QFDFLT.ACRTYP,
					QFDFLT.IMPEXPFLG,
					SEGSHP.DOCOWRIDR,
					SEGSHP.MSTDOCNUM,
					SEGSHP.DUPNUM,
					SEGSHP.SEQNUM,
					SEGSHP.MFTPCS,
					SEGSHP.MFTWGT,
					SEGSHP.RCVPCS,
					SEGSHP.RCVWGT,
					SHPMST.SHPPFX,
					SHPMST.PRDCOD,
					SHPMST.PRDNAM,
					SHPMST.SCCCOD,
					ULDTYP.ULDTYP,
					SEGULD.ULDNUM,
					QFDFLT.EXPBAGCNT,
					QFDFLT.EXPBAGWGT,
					QFDFLT.IMPBAGCNT,
					QFDFLT.IMPBAGWGT
				  FROM QFDFLT
				  INNER JOIN OPRSEGSHP SEGSHP
				  ON QFDFLT.CMPCOD     = SEGSHP.CMPCOD
				  AND QFDFLT.FLTNUM    = SEGSHP.FLTNUM
				  AND QFDFLT.FLTCARIDR = SEGSHP.FLTCARIDR
				  AND QFDFLT.FLTSEQNUM = SEGSHP.FLTSEQNUM
				  AND QFDFLT.SEGSERNUM = SEGSHP.SEGSERNUM
					INNER JOIN OPRSEGULDSHP SEGULDSHP
					ON SEGSHP.CMPCOD     = SEGULDSHP.CMPCOD
					AND SEGSHP.FLTNUM    = SEGULDSHP.FLTNUM
					AND SEGSHP.FLTCARIDR = SEGULDSHP.FLTCARIDR
					AND SEGSHP.FLTSEQNUM = SEGULDSHP.FLTSEQNUM
					AND SEGSHP.SEGSERNUM = SEGULDSHP.SEGSERNUM
					AND SEGSHP.MSTDOCNUM = SEGULDSHP.MSTDOCNUM
					AND SEGSHP.DOCOWRIDR = SEGULDSHP.DOCOWRIDR
					AND SEGSHP.SEQNUM    = SEGULDSHP.SEQNUM
					AND SEGSHP.DUPNUM    = SEGULDSHP.DUPNUM
				  INNER JOIN OPRSEGULD SEGULD
					ON SEGULDSHP.CMPCOD     = SEGULD.CMPCOD
					AND SEGULDSHP.FLTNUM    = SEGULD.FLTNUM
					AND SEGULDSHP.FLTCARIDR = SEGULD.FLTCARIDR
					AND SEGULDSHP.FLTSEQNUM = SEGULD.FLTSEQNUM
					AND SEGULDSHP.SEGSERNUM = SEGULD.SEGSERNUM
					AND SEGULDSHP.ULDNUM    = SEGULD.ULDNUM
				  INNER JOIN OPRSHPMST SHPMST
				  ON SEGSHP.CMPCOD     = SHPMST.CMPCOD
				  AND SEGSHP.MSTDOCNUM = SHPMST.MSTDOCNUM
				  AND SEGSHP.DOCOWRIDR = SHPMST.DOCOWRIDR
				  AND SEGSHP.SEQNUM    = SHPMST.SEQNUM
				  AND SEGSHP.DUPNUM    = SHPMST.DUPNUM
				  LEFT OUTER JOIN SHRULDTYPMST ULDTYP
				  ON SUBSTR(SEGULD.ULDNUM, 0, 3) = ULDTYP.ULDTYPCOD
				  AND SEGULD.CMPCOD              = ULDTYP.CMPCOD
				  AND SEGULD.ULDNUM             <> 'BULK'
				  INNER JOIN OPRARPIMPFLT IMPFLT
				  ON QFDFLT.CMPCOD       = IMPFLT.CMPCOD
				  AND QFDFLT.FLTNUM      = IMPFLT.FLTNUM
				  AND QFDFLT.FLTCARIDR   = IMPFLT.FLTCARIDR
				  AND QFDFLT.FLTSEQNUM   = IMPFLT.FLTSEQNUM

	
				  AND QFDFLT.SEGDST      = IMPFLT.ARPCOD
				  WHERE QFDFLT.IMPEXPFLG = 'I'
				  AND IMPFLT.FLTOPRSTA   = 'C'
				  )
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>403</QRY:Id>
		<QRY:Source Name="operations.flthandling.checkisontopuld" Type="OBJECT">
			<![CDATA[
SELECT SEGULD.BSEPLT
FROM OPRSEGULD SEGULD,
  (SELECT *
  FROM
    (SELECT EXPFLT.CMPCOD,
      EXPFLT.FLTCARIDR,

EXPFLT.FLTNUM,
      EXPFLT.FLTSEQNUM,
      SEGULD.SEGSERNUM,
      SEGULD.ULDNUM,
      DENSE_RANK()
OVER (ORDER BY EXPFLT.FLTDAT DESC ) rnk
    FROM OPRARPEXPFLT EXPFLT,
      OPRFLTSEG FLTSEG,
      OPRSEGULD
SEGULD
    WHERE EXPFLT.CMPCOD  = FLTSEG.CMPCOD
    AND EXPFLT.FLTCARIDR = FLTSEG.FLTCARIDR
    AND EXPFLT.FLTNUM
= FLTSEG.FLTNUM
    AND EXPFLT.FLTSEQNUM = FLTSEG.FLTSEQNUM
    AND EXPFLT.ARPCOD    = FLTSEG.POL

AND FLTSEG.CMPCOD    = SEGULD.CMPCOD
    AND FLTSEG.FLTCARIDR = SEGULD.FLTCARIDR
    AND FLTSEG.FLTNUM
= SEGULD.FLTNUM
    AND FLTSEG.FLTSEQNUM = SEGULD.FLTSEQNUM
    AND FLTSEG.SEGSERNUM = SEGULD.SEGSERNUM

AND SEGULD.CMPCOD    = ?
    AND SEGULD.ULDNUM    =?
    AND EXPFLT.ARPCOD    =?
    )
  WHERE rnk =
1
  )Z
WHERE Z.CMPCOD  = SEGULD.CMPCOD
AND Z.FLTCARIDR = SEGULD.FLTCARIDR
AND Z.FLTNUM    = SEGULD.FLTNUM
AND
Z.FLTSEQNUM = SEGULD.FLTSEQNUM
AND Z.SEGSERNUM = SEGULD.SEGSERNUM
AND Z.ULDNUM    = SEGULD.ULDNUM
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>404</QRY:Id>
		<QRY:Source Name="operations.flthandling.findontopulds" Type="OBJECT">
			<![CDATA[
SELECT SEGULD.ULDNUM
FROM OPRSEGULD SEGULD,
  (SELECT *
  FROM
    (SELECT EXPFLT.CMPCOD,
      EXPFLT.FLTCARIDR,

EXPFLT.FLTNUM,
      EXPFLT.FLTSEQNUM,
      SEGULD.SEGSERNUM,
      SEGULD.ULDNUM,
      DENSE_RANK()
OVER (ORDER BY EXPFLT.FLTDAT DESC ) rnk
    FROM OPRARPEXPFLT EXPFLT,
      OPRFLTSEG FLTSEG,
      OPRSEGULD
SEGULD
    WHERE EXPFLT.CMPCOD  = FLTSEG.CMPCOD
    AND EXPFLT.FLTCARIDR = FLTSEG.FLTCARIDR
    AND EXPFLT.FLTNUM
= FLTSEG.FLTNUM
    AND EXPFLT.FLTSEQNUM = FLTSEG.FLTSEQNUM
    AND EXPFLT.ARPCOD    = FLTSEG.POL

AND FLTSEG.CMPCOD    = SEGULD.CMPCOD
    AND FLTSEG.FLTCARIDR = SEGULD.FLTCARIDR
    AND FLTSEG.FLTNUM
= SEGULD.FLTNUM
    AND FLTSEG.FLTSEQNUM = SEGULD.FLTSEQNUM
    AND FLTSEG.SEGSERNUM = SEGULD.SEGSERNUM

AND SEGULD.BSEFLG    = 'Y'
    AND SEGULD.CMPCOD    = ?
    AND SEGULD.ULDNUM    =?
    AND EXPFLT.ARPCOD
=?
    )
  WHERE rnk = 1
  )Z
WHERE SEGULD.CMPCOD  = Z.CMPCOD
AND SEGULD.FLTCARIDR = Z.FLTCARIDR
AND
SEGULD.FLTNUM    = Z.FLTNUM
AND SEGULD.FLTSEQNUM = Z.FLTSEQNUM
AND SEGULD.SEGSERNUM = Z.SEGSERNUM
AND
SEGULD.BSEPLT    = Z.ULDNUM
AND SEGULD.ULDNUM   <>'BULK'
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>401</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findexportflighttransactiondetail" Type="NATIVE">
			<![CDATA[
	SELECT HIS.TXNCOD, HIS.ARPCOD, HIS.STRTIM, HIS.ENDTIM
	  FROM OPREXPFLTHIS HIS
	 WHERE HIS.FLTNUM = ?
	   AND HIS.FLTCARIDR = ?
	   AND HIS.FLTSEQNUM = ?
	   AND HIS.ARPCOD = ?
	   AND HIS.CMPCOD = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>392</QRY:Id>
		<QRY:Source Name="operations.flighthandling.finduniddetailsinmanifestedflight" Type="NATIVE">
			<![CDATA[
		SELECT DGR.UNIIDR,
		  DGR.CMPCOD,
		  DGR.MSTDOCNUM,
		  DGR.DOCOWRIDR,
		  DGR.DUPNUM,
		  DGR.SEQNUM,

DGR.SHPCLS,
		  DGR.ERGCOD,
		  DGR.NOOFALLPACKS,
		  DGR.NOOFOVRPACKS,
		  DGR.NUMPKG,
		  DGR.NETQTY,

DGR.TPTIND,
		  DGR.NETQTYUNT,
		  DGR.SCCCOD
		FROM OPRSEGSHP SHP,
		  OPRFLTSEG FLT ,
		  OPRSHPDGR
DGR,
		  OPRNTCDGR NTC
		WHERE SHP.CMPCOD  = FLT.CMPCOD
		AND SHP.FLTNUM    = FLT.FLTNUM
		AND SHP.FLTCARIDR
= FLT.FLTCARIDR
		AND SHP.FLTSEQNUM = FLT.FLTSEQNUM
		AND SHP.SEGSERNUM = FLT.SEGSERNUM
		AND NTC.FLTNUM
= FLT.FLTNUM
		AND NTC.FLTSEQNUM = FLT.FLTSEQNUM
		AND NTC.FLTCARIDR = FLT.FLTCARIDR
		AND NTC.SEGSERNUM
= FLT.SEGSERNUM
		AND NTC.CMPCOD  = FLT.CMPCOD
		AND DGR.CMPCOD = NTC.CMPCOD
		AND DGR.MSTDOCNUM = NTC.MSTDOCNUM

		AND DGR.DOCOWRIDR = NTC.DOCOWRIDR
		AND DGR.SEQNUM = NTC.SEQNUM
		AND DGR.DUPNUM = NTC.DUPNUM
		AND
DGR.CMPCOD    = SHP.CMPCOD
		AND DGR.DOCOWRIDR = SHP.DOCOWRIDR
		AND DGR.MSTDOCNUM = SHP.MSTDOCNUM

AND DGR.SEQNUM    = SHP.SEQNUM
		AND DGR.DUPNUM    = SHP.DUPNUM
		AND DGR.UNIIDR    = NTC.UNIIDR
		AND
DGR.SERNUM    = NTC.DGRSERNUM
		AND SHP.CMPCOD    = ?
		AND SHP.FLTNUM    = ?
		AND SHP.FLTCARIDR = ?

AND SHP.FLTSEQNUM = ?
		AND FLT.POL       = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<!--Added for ICRD-54548 BY A-5117 -->
	<QRY:Definition>
		<QRY:Id>405</QRY:Id>
		<QRY:Source Name="operations.flthandling.generateSundurmaSupalanPrintDetails" Type="NATIVE">
			<![CDATA[
SELECT IMPFLT.CMPCOD,
  IMPFLT.NAT,
  LEG.TALNUM,
  CSTTRSSHP.REGNUM ,
  FLTMST.FLTNUM,
  FLTMST.FLTDAT,

FLTMST.FLTROU,
  SHPMST.MSTDOCNUM,
  SHPMST.DOCOWRIDR,
  SHPMST.SEQNUM,
  SHPMST.SHPDES,
  SHPMST.SHPPFX,

SEGSHP.RCVPCS,
  SEGSHP.RCVWGT,
  SHPMST.CNSNAM,
  SHPDTL.SPLNOT,
  IMPFLT.ARPCOD,
  MST.NATNTY
FROM
OPRARPIMPFLT IMPFLT
JOIN FLTOPRLEG LEG
ON IMPFLT.FLTCARIDR = LEG.FLTCARIDR
AND IMPFLT.FLTNUM = LEG.FLTNUM

AND IMPFLT.FLTSEQNUM = LEG.FLTSEQNUM
AND IMPFLT.LEGSERNUM = LEG.LEGSERNUM
AND IMPFLT.CMPCOD = LEG.CMPCOD

JOIN OPRSEGSHP SEGSHP
ON IMPFLT.FLTCARIDR = SEGSHP.FLTCARIDR
AND IMPFLT.FLTNUM = SEGSHP.FLTNUM
AND
IMPFLT.FLTSEQNUM = SEGSHP.FLTSEQNUM
AND IMPFLT.CMPCOD = SEGSHP.CMPCOD

JOIN FLTOPRMST FLTMST
ON IMPFLT.FLTCARIDR
= FLTMST.FLTCARIDR
AND IMPFLT.FLTNUM = FLTMST.FLTNUM
AND IMPFLT.FLTSEQNUM = FLTMST.FLTSEQNUM
AND IMPFLT.CMPCOD
= FLTMST.CMPCOD
JOIN OPRSHPMST SHPMST
ON SEGSHP.DOCOWRIDR = SHPMST.DOCOWRIDR
AND SEGSHP.MSTDOCNUM
= SHPMST.MSTDOCNUM
AND SEGSHP.DUPNUM = SHPMST.DUPNUM
AND SEGSHP.SEQNUM = SHPMST.SEQNUM
AND SEGSHP.CMPCOD
= SHPMST.CMPCOD

LEFT OUTER JOIN CSTARPFLT CSTFLT
ON SEGSHP.FLTCARIDR = CSTFLT.FLTCARIDR
AND SEGSHP.FLTNUM
= CSTFLT.FLTNUM
AND SEGSHP.FLTSEQNUM = CSTFLT.FLTSEQNUM
AND SEGSHP.CMPCOD = CSTFLT.CMPCOD



LEFT
OUTER JOIN CSTTRSARPSHP CSTTRSSHP
ON  SEGSHP.MSTDOCNUM = CSTTRSSHP.MSTDOCNUM
AND SEGSHP.DOCOWRIDR =
CSTTRSSHP.DOCOWRIDR
AND SEGSHP.DUPNUM    = CSTTRSSHP.DUPNUM
AND SEGSHP.SEQNUM    = CSTTRSSHP.SEQNUM
AND
SEGSHP.CMPCOD    = CSTTRSSHP.CMPCOD


LEFT OUTER JOIN CSTTRSSHPDTL SHPDTL
ON SEGSHP.DUPNUM     = SHPDTL.DUPNUM
AND
SEGSHP.MSTDOCNUM =SHPDTL.MSTDOCNUM
AND SEGSHP.DOCOWRIDR =SHPDTL.DOCOWRIDR
AND SEGSHP.SEQNUM = SHPDTL.SEQNUM
AND
SEGSHP.CMPCOD    = SHPDTL.CMPCOD

LEFT OUTER JOIN SHRARLACTMST MST
ON IMPFLT.FLTCARIDR = MST.ARLIDR
AND
IMPFLT.CMPCOD    = MST.CMPCOD


WHERE
	 IMPFLT.CMPCOD = ?
	 AND IMPFLT.FLTCARIDR = ?
	 AND IMPFLT.FLTNUM
= ?
	 AND IMPFLT.FLTSEQNUM = ?
	 AND SHPMST.DSTCOD = ?
	 AND LEG.LEGORG = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>406</QRY:Id>
		<QRY:Source Name="operations.flthandling.findOperationalImportFlightStatus" Type="NATIVE">
			<![CDATA[
	 SELECT
  (SELECT FLTOWN
  FROM FLTOPRMST
  WHERE CMPCOD = LEG.CMPCOD
  AND FLTNUM    = LEG.FLTNUM

AND FLTCARIDR = LEG.FLTCARIDR
  AND FLTSEQNUM = LEG.FLTSEQNUM
  ) FLTCARCOD ,
  LEG.FLTCARIDR,
  LEG.FLTNUM,

LEG.FLTSEQNUM,
  COALESCE (LEG.ATA, LEG.STA )FLTDAT,
  LEG.LEGDST ARPCOD ,
  IMP.FLTOPRSTA,
  LEG.LEGSERNUM,

LEG.CMPCOD ,
  LEG.ARVGTE,
  LEG.ATA
FROM FLTOPRLEG LEG ,OPRARPIMPFLT IMP
WHERE LEG.CMPCOD
= IMP.CMPCOD(+)
AND LEG.FLTNUM                                              = IMP.FLTNUM(+)
AND LEG.FLTCARIDR
= IMP.FLTCARIDR(+)
AND LEG.FLTSEQNUM                                           = IMP.FLTSEQNUM(+)
AND
LEG.LEGSERNUM                                           = IMP.LEGSERNUM(+)
AND LEG.LEGDST
= IMP.ARPCOD (+)
AND LEG.CMPCOD                                              = ?
AND (LEG.FLTCARIDR,
LEG.FLTNUM, LEG.FLTSEQNUM, LEG.LEGDST) IN (
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>407</QRY:Id>
		<QRY:Source Name="operations.flthandling.findSpecialSccs" Type="NATIVE">
			<![CDATA[
			 SELECT
			  SCCCOD
			  FROM SHRSCCMST
			WHERE CMPCOD = ?
			AND NTCIND='Y'
			AND DGRIND= 'N'
			AND SCCCOD IN(

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>408</QRY:Id>
		<QRY:Source Name="operations.flthandling.findordinopiecesandweight" Type="NATIVE">
			<![CDATA[
				 SELECT oro.mstdocnum,
				 oro.docowridr,
				 oro.dupnum,
				 oro.seqnum,
				 oro.cmpcod,

decode (MAX(arp.rcvpcs) , 0 , SUM(oro.oropcs) ,MAX(arp.rcvpcs))  totaloropcs,
				 decode (MAX(arp.rcvwgt)
, 0 , SUM(oro.orowgt) ,MAX(arp.rcvwgt))  totalorowgt
				 FROM oprfltoro oro,oprarpshp arp
				 where
oro.cmpcod=arp.cmpcod
				 and oro.mstdocnum=arp.mstdocnum
				 and oro.docowridr=arp.docowridr

and oro.dupnum=arp.dupnum
				 and oro.seqnum=arp.seqnum
				 and oro.arpcod=arp.arpcod
				 and oro.cmpcod
= ?
				 and oro.arpcod = ?
			     and oro.docowridr= ?
				 and oro.mstdocnum= ?
				 and oro.dupnum
= ?
				 and oro.seqnum   = ?
				 GROUP BY oro.mstdocnum,
				 oro.docowridr,
				 oro.dupnum,

oro.seqnum,
				 oro.cmpcod
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>410</QRY:Id>
		<QRY:Source Name="operations.flthandling.findOperationalULDDetails" Type="NATIVE">
			<![CDATA[
				SELECT  ULD.CMPCOD CMPCOD, ULD.ULDNUM,
						ULD.FLTCARIDR, ULD.FLTNUM,
						ULD.FLTSEQNUM,


							(CASE ARLMST.APHCODUSE
							   WHEN 2
							      THEN ARLMST.TWOAPHCOD
							   ELSE ARLMST.THRAPHCOD


						     END) FLTCARCOD,FLT.STD FLTDAT
							FROM
							OPRULDDTL ULD
						INNER JOIN SHRARLMST
ARLMST ON

							     ULD.CMPCOD = ARLMST.CMPCOD
							AND  ULD.FLTCARIDR = ARLMST.ARLIDR

JOIN FLTOPRLEG FLT

						  ON ULD.CMPCOD=FLT.CMPCOD
						  AND ULD.FLTNUM=FLT.FLTNUM

AND ULD.FLTCARIDR=FLT.FLTCARIDR

						  AND ULD.FLTSEQNUM=FLT.FLTSEQNUM
						  AND ULD.LEGSERNUM=FLT.LEGSERNUM

WHERE
							ULD.CMPCOD
= ?
						    AND ULD.ULDNUM = ?
						    AND (ULD.CLSFLG IS NULL OR ULD.CLSFLG <> 'Y')
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>401</QRY:Id>
		<QRY:Source Name="operations.flthandling.findLatestArrivedFlightForStackerThruULD" Type="NATIVE">
			<![CDATA[
						SELECT CMPCOD,
						  ARPCOD,
						  FLTCARCOD,
						  FLTCARIDR,
						  FLTNUM,
						  FLTDAT,
						  FLTSEQNUM,
						  LEGSERNUM,
						  ULDNUM,
						  RCVFLG,
						  BDNITN,
						  THRUNT,
						  POU,
						  POL,
						  STA
						FROM
						  (SELECT SEGULD.CMPCOD,
							FLTSEG.SEGDST ARPCOD,
							(SELECT
							  CASE
								WHEN ARLMST.APHCODUSE = 2
			THEN ARLMST.TWOAPHCOD
			ELSE ARLMST.THRAPHCOD
		  END AS FLTCARCOD
							FROM SHRARLMST ARLMST
							WHERE ARLMST.CMPCOD=FLTSEG.CMPCOD
AND ARLMST.ARLIDR=FLTSEG.FLTCARIDR
							AND ACTIND         ='A'
							) AS FLTCARCOD,
							FLTSEG.FLTCARIDR,
							FLTLEG.FLTNUM,
							FLTLEG.STA FLTDAT,
							FLTLEG.FLTSEQNUM,
							FLTLEG.LEGSERNUM,
							SEGULD.ULDNUM,
							SEGULD.RCVFLG,
							SEGULD.BDNITN,
							SEGULD.THRUNT,
							FLTSEG.SEGDST POU,
							SEGORG POL,
							FLTLEG.STA,
							MAX(FLTLEG.STA) OVER (PARTITION BY SEGULD.CMPCOD,SEGULD.ULDNUM) MAXSTA
					       FROM OPRSEGULD SEGULD
						  INNER JOIN FLTOPRSEG FLTSEG					   
                          ON SEGULD.CMPCOD = FLTSEG.CMPCOD
					      AND SEGULD.FLTCARIDR = FLTSEG.FLTCARIDR
						  AND SEGULD.FLTNUM    = FLTSEG.FLTNUM
					      AND SEGULD.FLTSEQNUM = FLTSEG.FLTSEQNUM
						  AND SEGULD.SEGSERNUM = FLTSEG.SEGSERNUM				  
                          LEFT OUTER JOIN OPRARPIMPFLT IMPFLT
						  ON FLTSEG.CMPCOD     = IMPFLT.CMPCOD
						  AND FLTSEG.FLTCARIDR = IMPFLT.FLTCARIDR
						  AND FLTSEG.FLTNUM    = IMPFLT.FLTNUM
						  AND FLTSEG.FLTSEQNUM = IMPFLT.FLTSEQNUM
					      AND FLTSEG.SEGDST = IMPFLT.ARPCOD  
					     INNER JOIN FLTOPRLEG FLTLEG
						  ON FLTSEG.CMPCOD = FLTLEG.CMPCOD
					      AND FLTSEG.FLTCARIDR = FLTLEG.FLTCARIDR
						  AND FLTSEG.FLTNUM    = FLTLEG.FLTNUM
						  AND FLTSEG.FLTSEQNUM = FLTLEG.FLTSEQNUM
					      AND FLTSEG.SEGDST = FLTLEG.LEGDST 
					WHERE SEGULD.CMPCOD = ?
						  AND FLTSEG.SEGDST    = ?
					      AND SEGULD.ULDNUM = ?) 
						  WHERE NVL(RCVFLG,'N') != 'Y'
				  AND STA = MAXSTA
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>403</QRY:Id>
		<QRY:Source Name="operations.flthandling.checkforShipmentsInsideCarrierBuiltupUld" Type="NATIVE">
			<![CDATA[
			SELECT SHP.ULDNUM,
				  SHP.ARPCOD,
				  SHP.MSTDOCNUM,
				  SHP.DOCOWRIDR,
				  SHP.SEQNUM,

SHP.DUPNUM ,
				  ULD.ACTWGT,
				  ULD.CMPCOD ULDCMPCOD,
				  ULD.ULDNUM ULDULDNUM,
				  ULD.ARPCOD ULDPOL,
				  ULD.POU
ULDPOU,
				  ULD.INBFLTCARIDR ULDFLTCARIDR,
				  ULD.INBFLTCARCOD FLTCARCOD,
				  ULD.ACTWGT,

ULD.ULDDST,
				  ULD.ULDCTR,
				  ULD.ULDNUM ARPULDNUM,
				  ULD.BRWFLG BARROWFLG,
				  'Y' ULDCLSFLG

			FROM OPRARPULD ULD
			INNER JOIN OPRULDSHP SHP
			ON ULD.CMPCOD = SHP.CMPCOD
			AND ULD.ULDNUM =
SHP.ULDNUM
			AND ULD.ARPCOD = SHP.ARPCOD
			WHERE ULD.CMPCOD = ?
			  AND ULD.ULDNUM = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>402</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findimportflightdetailsforuldhht" Type="NATIVE">
			<![CDATA[
			SELECT ULD.CMPCOD CMPCOD,
			  ULD.ULDNUM ULDNUM,
			  ULD.FLTCARIDR FLTCARIDR,
			  ULD.FLTNUM FLTNUM,


			  ULD.FLTSEQNUM FLTSEQNUM,
			  ULD.POL ULDPOL,
			  ULD.POU ULDPOU,
			  ULD.LEGSERNUM LEGSERNUM,


			  ULD.ATA,
			  ULD.STA,
			  NVL(ULD.STA,IMPFLT.FLTDAT) FLTDAT,
			  (
			  CASE ARLMST.APHCODUSE

WHEN 2
				THEN
ARLMST.TWOAPHCOD
				ELSE ARLMST.THRAPHCOD
			  END) FLTCARCOD,
			  SEGULD.THRUNT,

SEGULD.BDNITN,

			  SEGULD.BDNCPLFLG,
			  SEGULD.BUPFLG,
			  SEGULD.ULDDST,
			  IMPFLT.FLTOPRSTA,

FLTSEG.SEGSERNUM,

			  SEGULD.MFTFLG ULDMFTFLG,
			  SEGULD.ULDCTR,
			  (
			  CASE
				WHEN(
(SELECT COUNT(1)
				  FROM OPRSEGULDSHP
SEGSHP
				  WHERE ULD.CMPCOD  = SEGSHP.CMPCOD
				  AND ULD.FLTCARIDR
= SEGSHP.FLTCARIDR
				  AND ULD.FLTNUM
= SEGSHP.FLTNUM
				  AND ULD.FLTSEQNUM = SEGSHP.FLTSEQNUM

AND ULD.ULDNUM    = SEGSHP.ULDNUM

				  AND SEGSHP.RCVPCS > 0 ) > 0)
				THEN 'Y'
				ELSE 'N'

END) BDNSTRFLG,
			  BDNDTL.THRINTFLG

			FROM (SELECT * FROM (SELECT Z.* ,
			  DENSE_RANK() OVER
(PARTITION BY Z.CMPCOD,Z.ULDNUM ORDER BY LEG.STA
DESC ) RNK,
			  LEG.STA,
			  LEG.LEGSERNUM,

LEG.ATA
			FROM
			  (SELECT SEGULD.CMPCOD,
				SEG.POL,

				SEG.POU,
				SEGULD.ULDNUM,
				SEGULD.FLTNUM
,
				SEGULD.FLTSEQNUM,
				SEGULD.FLTCARIDR
			  FROM
OPRSEGULD SEGULD,
				OPRFLTSEG SEG
			  WHERE
SEGULD.ULDNUM  = ?
			  AND SEGULD.CMPCOD    = SEG.CMPCOD

			  AND SEG.FLTNUM    = SEGULD.FLTNUM

AND SEG.FLTSEQNUM = SEGULD.FLTSEQNUM
			  AND SEG.FLTCARIDR =
SEGULD.FLTCARIDR
			  AND SEG.SEGSERNUM
= SEGULD.SEGSERNUM
			  AND SEG.POU = ?
			  UNION
			  SELECT RMPULD.CMPCOD,
        SEG.POL POL,

SEG.POU POU,
        RMPULD.ULDNUM,
        RMPULD.FLTNUM ,
        RMPULD.FLTSEQNUM,
        RMPULD.FLTCARIDR

FROM WHSRMPULD RMPULD
				INNER JOIN OPRFLTSEG SEG
				ON SEG.CMPCOD     = RMPULD.CMPCOD
				AND SEG.FLTNUM
= RMPULD.FLTNUM
				AND SEG.FLTSEQNUM = RMPULD.FLTSEQNUM
				AND SEG.FLTCARIDR = RMPULD.FLTCARIDR

INNER JOIN OPRSEGULD ULD
				ON SEG.FLTCARIDR    = ULD.FLTCARIDR
      AND SEG.FLTNUM    = ULD.FLTNUM

AND SEG.FLTSEQNUM = ULD.FLTSEQNUM
      AND SEG.SEGSERNUM = ULD.SEGSERNUM
      AND SEG.CMPCOD    = ULD.CMPCOD

      AND ULD.ULDNUM    =RMPULD.ULDNUM
				WHERE RMPULD.ULDNUM = ?
				UNION
				SELECT RMPULD.CMPCOD,

SEG.POL POL,
        SEG.POU POU,
        RMPULD.ULDNUM,
        RMPULD.FLTNUM ,
        RMPULD.FLTSEQNUM,

RMPULD.FLTCARIDR
				FROM WHSRMPULD RMPULD
				INNER JOIN OPRFLTSEG SEG
				ON SEG.CMPCOD     = RMPULD.CMPCOD

AND SEG.FLTNUM    = RMPULD.FLTNUM
				AND SEG.FLTSEQNUM = RMPULD.FLTSEQNUM
				AND SEG.FLTCARIDR = RMPULD.FLTCARIDR

LEFT OUTER JOIN OPRSEGULD ULD
				ON SEG.FLTCARIDR    = ULD.FLTCARIDR
      AND SEG.FLTNUM    = ULD.FLTNUM

AND SEG.FLTSEQNUM = ULD.FLTSEQNUM
      AND SEG.SEGSERNUM = ULD.SEGSERNUM
      AND SEG.CMPCOD    = ULD.CMPCOD

      AND ULD.ULDNUM    =RMPULD.ULDNUM
				WHERE RMPULD.ULDNUM = ?
				AND NOT EXISTS(
				SELECT RMPULD.CMPCOD,

SEG.POL POL,
        SEG.POU POU,
        RMPULD.ULDNUM,
        RMPULD.FLTNUM ,
        RMPULD.FLTSEQNUM,

RMPULD.FLTCARIDR
				FROM WHSRMPULD RMPULD
				INNER JOIN OPRFLTSEG SEG
				ON SEG.CMPCOD     = RMPULD.CMPCOD

AND SEG.FLTNUM    = RMPULD.FLTNUM
				AND SEG.FLTSEQNUM = RMPULD.FLTSEQNUM
				AND SEG.FLTCARIDR = RMPULD.FLTCARIDR

INNER JOIN OPRSEGULD ULD
				ON SEG.FLTCARIDR    = ULD.FLTCARIDR
      AND SEG.FLTNUM    = ULD.FLTNUM

AND SEG.FLTSEQNUM = ULD.FLTSEQNUM
      AND SEG.SEGSERNUM = ULD.SEGSERNUM
      AND SEG.CMPCOD    = ULD.CMPCOD

      AND ULD.ULDNUM    =RMPULD.ULDNUM
				WHERE RMPULD.ULDNUM = ?
				)

			  )Z,
			  FLTOPRLEG

LEG
			WHERE Z.CMPCOD  = LEG.CMPCOD
			AND Z.FLTNUM    = LEG.FLTNUM
			AND Z.FLTSEQNUM = LEG.FLTSEQNUM
			AND Z.FLTCARIDR = LEG.FLTCARIDR
AND Z.POU = LEG.LEGDST
			))
			 ULD,
			  OPRARPIMPFLT IMPFLT,
			  SHRARLMST ARLMST,
			  OPRSEGULD
SEGULD,

			  OPRFLTSEG FLTSEG,
			  OPRULDBDNDTL BDNDTL,
				SHRSYSPAR SYSPAR
			WHERE ULD.CMPCOD
= IMPFLT.CMPCOD(+)
			AND ULD.FLTCARIDR
= IMPFLT.FLTCARIDR(+)
			AND ULD.FLTNUM          = IMPFLT.FLTNUM(+)

AND ULD.FLTSEQNUM       = IMPFLT.FLTSEQNUM(+)

			AND ULD.LEGSERNUM       = IMPFLT.LEGSERNUM(+)

AND ULD.POU             = IMPFLT.ARPCOD(+)
			AND ULD.CMPCOD
= ARLMST.CMPCOD(+)
			AND ULD.FLTCARIDR
= ARLMST.ARLIDR(+)
			AND ULD.CMPCOD          = FLTSEG.CMPCOD(+)

AND ULD.FLTCARIDR       = FLTSEG.FLTCARIDR(+)

AND ULD.FLTNUM          = FLTSEG.FLTNUM(+)
			AND ULD.FLTSEQNUM
= FLTSEG.FLTSEQNUM(+)
			AND ULD.POL
= FLTSEG.POL(+)
			AND ULD.POU             = FLTSEG.POU(+)

AND SEGULD.CMPCOD(+)    = ULD.CMPCOD

AND SEGULD.FLTCARIDR(+) = ULD.FLTCARIDR
			AND SEGULD.FLTNUM
(+)   = ULD.FLTNUM
			AND SEGULD.FLTSEQNUM(+)
= ULD.FLTSEQNUM
			AND SEGULD.ULDNUM(+)    = ULD.ULDNUM

			AND BDNDTL.CMPCOD(+)    = ULD.CMPCOD

			AND BDNDTL.FLTCARIDR(+) = ULD.FLTCARIDR

			AND BDNDTL.FLTNUM(+)    = ULD.FLTNUM

			AND BDNDTL.FLTSEQNUM(+) = ULD.FLTSEQNUM
			AND
BDNDTL.LEGSERNUM(+) = ULD.LEGSERNUM

AND BDNDTL.ARPCOD(+)    = ULD.POU
			AND BDNDTL.ULDNUM(+)    = ULD.ULDNUM
			AND SYSPAR.CMPCOD(+)
= ULD.CMPCOD
      AND SYSPAR.PARCOD(+)       ='operations.flthandling.excludethresholddaysperiodforcargocheckhht'

AND ULD.CMPCOD
= ?
			AND ULD.ULDNUM          = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>403</QRY:Id>
		<QRY:Source Name="operations.flthandling.findimportflightsforairportpart1" Type="NATIVE">
			<![CDATA[

			SELECT SEGSCC.*,
  (SELECT NVL(IMPFLT.FLTOPRSTA,'A')FLTOPRSTA
  FROM OPRARPIMPFLT IMPFLT
  WHERE SEGSCC.FLTCARIDR = IMPFLT.FLTCARIDR
			AND SEGSCC.FLTNUM      = IMPFLT.FLTNUM
  AND SEGSCC.FLTSEQNUM   = IMPFLT.FLTSEQNUM
			AND SEGSCC.CMPCOD      = IMPFLT.CMPCOD
			AND SEGSCC.ARPCOD      = IMPFLT.ARPCOD


  AND SEGSCC.LEGSERNUM   = IMPFLT.LEGSERNUM
  )FLTOPRSTA,
  (SELECT OPRMST.FLTSTA
  FROM FLTOPRMST OPRMST


  WHERE SEGSCC.FLTNUM  = OPRMST.FLTNUM
			AND SEGSCC.FLTSEQNUM   = OPRMST.FLTSEQNUM
  AND SEGSCC.FLTCARIDR = OPRMST.FLTCARIDR
  AND SEGSCC.CMPCOD    = OPRMST.CMPCOD
  )FLTSTA,
  (SELECT OPRMST.FLTDAT

  FROM FLTOPRMST OPRMST
  WHERE SEGSCC.FLTNUM  = OPRMST.FLTNUM
  AND SEGSCC.FLTSEQNUM = OPRMST.FLTSEQNUM
  AND SEGSCC.FLTCARIDR = OPRMST.FLTCARIDR
  AND SEGSCC.CMPCOD    = OPRMST.CMPCOD
  )FLTDAT,
			(SELECT

    CASE
      WHEN ARLMST.APHCODUSE = 2
      THEN ARLMST.TWOAPHCOD
      ELSE ARLMST.THRAPHCOD

END FLTCARCOD


			  FROM SHRARLMST ARLMST
  WHERE SEGSCC.CMPCOD  = ARLMST.CMPCOD
			  AND SEGSCC.FLTCARIDR
= ARLMST.ARLIDR

			)FLTCARCOD,

			(
			  CASE
				WHEN SEGSCC.ATA IS NOT NULL
				THEN SEGSCC.ATA
    WHEN SEGSCC.ETA IS NOT NULL
				THEN SEGSCC.ETA
				WHEN SEGSCC.STA IS NOT NULL
				THEN SEGSCC.STA

ELSE NULL

			  END) ARRDAT,
			  (
			  CASE
				WHEN SEGSCC.ATA IS NOT NULL
				THEN 'A'
    WHEN SEGSCC.ETA IS NOT NULL
				THEN 'E'
				WHEN SEGSCC.STA IS NOT NULL
				THEN 'S'
				ELSE NULL

END) ARRDATTYP,

			  (
			  CASE
				WHEN SEGSCC.ATAUTC IS NOT NULL
				THEN SEGSCC.ATAUTC

WHEN SEGSCC.STAUTC IS NOT NULL

				THEN SEGSCC.STAUTC
				ELSE NULL
			  END) ARRDATUTC
			FROM

(SELECT SEG.CMPCOD,
    SEG.FLTCARIDR,

    SEG.FLTNUM,
    SEG.FLTSEQNUM,
    SEG.SEGSERNUM,
			  MAX(SEG.LEGORG)LEGORG,

			  MAX(SEG.LEGDST) LEGDST,

MAX(SEG.TALNUM) TALNUM,
			  MAX(SEG.ACRTYP) ACRTYP,
			  MAX(SEG.ATA) ATA,

			  MAX(SEG.ETA) ETA,

MAX(SEG.STA) STA,
			  MAX(SEG.ATAUTC) ATAUTC,
			  MAX(SEG.STAUTC)STAUTC,

			  MAX(SEG.LEGSERNUM)
LEGSERNUM,
			  MAX(SEG.ARPCOD)ARPCOD ,
			  MAX(SEG.SEGORG)SEGORG,
			  MAX(SEG.SEGDST)SEGDST,


			  MAX(SEG.TOTBDNWGT) TOTBDNWGT,
			  MAX(SEG.TOTMFTWGT) TOTMFTWGT,
			  MAX(SEG.THRUNT) THRUNT,

MAX(SEG.NORM)NORM,
			  rtrim (xmlagg ( xmlelement (e, scccod || ',') ORDER BY sccpry).extract ('//text()'),
',') scc

				FROM (
  select * from (
SELECT distinct SEGSHPDTL.CMPCOD,SEGSHPDTL.FLTCARIDR,SEGSHPDTL.FLTNUM,SEGSHPDTL.LEGORG,
    SEGSHPDTL.LEGDST , SEGSHPDTL.TALNUM,SEGSHPDTL.ACRTYP,SEGSHPDTL.ATA,
    SEGSHPDTL.ETA,SEGSHPDTL.STA,SEGSHPDTL.ATAUTC,SEGSHPDTL.STAUTC,
    SEGSHPDTL.LEGSERNUM,SEGSHPDTL.SEGSERNUM,SEGSHPDTL.FLTSEQNUM,SEGSHPDTL.ARPCOD,
    SEGSHPDTL.SEGORG,SEGSHPDTL.SEGDST,
    SEGSHPDTL.THRUNT,SEGSHPDTL.NORM,TOTBDNWGT,TOTMFTWGT,
    SCCMST.SCCCOD,SCCMST.SCCPRY,
    dense_rank() OVER (partition BY SEGSHPDTL.FLTCARIDR,SEGSHPDTL.FLTNUM,SEGSHPDTL.FLTSEQNUM,SEGSHPDTL.SEGSERNUM 
    order by SEGSHPDTL.FLTCARIDR,SEGSHPDTL.FLTNUM,SEGSHPDTL.FLTSEQNUM,SEGSHPDTL.SEGSERNUM,SCCMST.SCCPRY asc) SCC_RANK

FROM
    ( SELECT DISTINCT ULD.*,
        SUM(SEGSHP.RCVWGT)OVER (PARTITION BY ULD.FLTCARIDR,ULD.FLTNUM,ULD.FLTSEQNUM,ULD.SEGSERNUM)TOTBDNWGT,
        SUM(SEGSHP.MFTWGT)OVER (PARTITION BY ULD.FLTCARIDR,ULD.FLTNUM,ULD.FLTSEQNUM,ULD.SEGSERNUM)TOTMFTWGT,

SEGSHP.DOCOWRIDR ,
      SEGSHP.MSTDOCNUM,

     SEGSHP.DUPNUM,
     SEGSHP.SEQNUM
  FROM

(SELECT OPRLEG.CMPCOD,
			  OPRLEG.FLTCARIDR,

			  OPRLEG.FLTNUM,
			  OPRLEG.LEGORG,
			  OPRLEG.LEGDST,

OPRLEG.TALNUM,
			  OPRLEG.ACRTYP,
			  OPRLEG.ATA,

			  OPRLEG.ETA,
			  OPRLEG.STA,
			  OPRLEG.ATAUTC,

OPRLEG.STAUTC,
			  OPRLEG.LEGSERNUM,
			  FLTSEG.SEGSERNUM,

			  OPRLEG.FLTSEQNUM,
			  OPRLEG.LEGDST
ARPCOD,
			  FLTSEG.SEGORG,
			  FLTSEG.SEGDST,
        SEGULD.ULDNUM,

        SUM (

CASE
            WHEN (NVL(SEGULD.BDNITN,'TNURST') = 'THRUNT' OR (SEGULD.THRUNT = 'Y' AND NVL(SEGULD.BDNITN,'TNURST')
<> 'BDN' AND NVL(SEGULD.BDNITN,'TNURST') <> 'INTUNT' ))
            AND NVL(SEGULD.BARROWFLG,'N') <>
'Y'
				AND SEGULD.ULDNUM NOT LIKE 'BULK%'
				THEN 1
				ELSE 0
			  END )OVER (PARTITION BY FLTSEG.FLTCARIDR,FLTSEG.FLTNUM,FLTSEG.FLTSEQNUM,FLTSEG.SEGSERNUM)THRUNT,

SUM (
          CASE
            WHEN ( SEGULD.BDNITN   <> 'THRUNT'
            OR SEGULD.THRUNT <> 'Y'
)
            AND SEGULD.ULDNUM NOT LIKE 'BULK%'
            THEN 1
            ELSE 0

END )OVER (PARTITION BY seguld.FLTCARIDR,seguld.FLTNUM,seguld.FLTSEQNUM,seguld.SEGSERNUM)NORM
        FROM FLTOPRLEG OPRLEG,
			  FLTOPRSEG FLTSEG,
			  OPRSEGULD SEGULD
			WHERE OPRLEG.FLTCARIDR = FLTSEG.FLTCARIDR


			AND OPRLEG.FLTNUM      = FLTSEG.FLTNUM
			AND OPRLEG.FLTSEQNUM   = FLTSEG.FLTSEQNUM
        AND OPRLEG.CMPCOD      = FLTSEG.CMPCOD
			AND OPRLEG.LEGDST      = FLTSEG.SEGDST
			AND SEGULD.FLTCARIDR =FLTSEG.FLTCARIDR


			AND SEGULD.FLTNUM      = FLTSEG.FLTNUM
			AND SEGULD.FLTSEQNUM   = FLTSEG.FLTSEQNUM
        AND SEGULD.CMPCOD      = FLTSEG.CMPCOD
			AND SEGULD.SEGSERNUM   = FLTSEG.SEGSERNUM
			 AND OPRLEG.LEGSTA  <> 'CAN'

AND OPRLEG.LEGSTA  <> 'TBC'
			AND OPRLEG.CMPCOD      = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>404</QRY:Id>
		<QRY:Source Name="operations.flthandling.findimportflightsforairportpart2" Type="NATIVE">
			<![CDATA[

			)ULD
			INNER JOIN OPRSEGULDSHP SEGSHP
			ON ULD.CMPCOD     = SEGSHP.CMPCOD
      AND ULD.FLTCARIDR = SEGSHP.FLTCARIDR
			AND ULD.FLTNUM      = SEGSHP.FLTNUM
			AND ULD.FLTSEQNUM   = SEGSHP.FLTSEQNUM


			AND ULD.SEGSERNUM   = SEGSHP.SEGSERNUM
			AND ULD.ULDNUM = SEGSHP.ULDNUM
			)SEGSHPDTL
    INNER JOIN OPRSHPMST SHPMST
			ON SEGSHPDTL.DOCOWRIDR  = SHPMST.DOCOWRIDR
			AND SEGSHPDTL.MSTDOCNUM = SHPMST.MSTDOCNUM


			AND SEGSHPDTL.DUPNUM    = SHPMST.DUPNUM
			AND SEGSHPDTL.SEQNUM    = SHPMST.SEQNUM
    AND SEGSHPDTL.CMPCOD    = SHPMST.CMPCOD

			INNER JOIN SHRSCCMST SCCMST
			LEFT OUTER JOIN (select cmpcod , scccod , SCCPRY from SHRSCCMST 
union select 'X','',9999 from dual)  SCCMST
			ON  decode(SHPMST.SCCCOD,'','X',SHPMST.CMPCOD)                     
= SCCMST.CMPCOD
    AND INSTR(NVL(SHPMST.SCCCOD,'X'),SCCMST.SCCCOD)> 0  ) where SCC_RANK < 46  )SEG

		  GROUP BY SEG.CMPCOD,
			SEG.FLTCARIDR,
			SEG.FLTNUM,


			SEG.FLTSEQNUM,
			SEG.SEGSERNUM
				  )SEGSCC
   UNION
  SELECT distinct FLTL.CMPCOD,
  FLTL.FLTCARIDR,
  FLTL.FLTNUM,
  FLTL.FLTSEQNUM,
  FLTS.SEGSERNUM,
  FLTL.LEGORG,
  FLTL.LEGDST,
  FLTL.TALNUM,
  FLTL.ACRTYP,
  FLTL.ATA,
  FLTL.ETA,
  FLTL.STA,
  FLTL.ATAUTC,
  FLTL.STAUTC,
  FLTL.LEGSERNUM,
  FLTL.LEGDST ARPCOD,
  FLTS.SEGORG,
  FLTS.SEGDST,
  0 TOTBDNWGT,
  0 TOTMFTWGT,
  0 thrunt,
  0 norm,
  null SCC,
  'A' FLTOPRSTA,
  FLTM.FLTSTA,
  FLTM.FLTDAT,
  ARL.TWOAPHCOD FLTCARCOD ,
  (
    CASE
      WHEN FLTL.ATA IS NOT NULL
      THEN FLTL.ATA
      WHEN FLTL.ETA IS NOT NULL
      THEN FLTL.ETA
      WHEN FLTL.STA IS NOT NULL
      THEN FLTL.STA
      ELSE NULL
    END) ARRDAT,
    (
    CASE
      WHEN FLTL.ATA IS NOT NULL
      THEN 'A'
      WHEN FLTL.ETA IS NOT NULL
      THEN 'E'
      WHEN FLTL.STA IS NOT NULL
      THEN 'S'
      ELSE NULL
    END) ARRDATTYP,
   (
    CASE
      WHEN FLTL.ATAUTC IS NOT NULL
      THEN ATAUTC
      WHEN FLTL.STAUTC IS NOT NULL
      THEN STAUTC
      ELSE NULL
    END) ARRDATUTC
    FROM FLTOPRMST FLTM,
      FLTOPRLEG FLTL,
      FLTOPRSEG FLTS,
      SHRARLMST ARL
    WHERE FLTM.CMPCOD  = FLTL.CMPCOD
    AND FLTM.FLTCARIDR = FLTL.FLTCARIDR
    AND FLTM.FLTNUM    = FLTL.FLTNUM
    AND FLTM.FLTSEQNUM = FLTL.FLTSEQNUM
    AND FLTL.CMPCOD      = FLTS.CMPCOD
    AND FLTL.FLTCARIDR   = FLTS.FLTCARIDR
    AND FLTL.FLTNUM      = FLTS.FLTNUM
    AND FLTL.FLTSEQNUM   = FLTS.FLTSEQNUM
    AND FLTL.LEGDST      = FLTS.SEGDST
    AND FLTL.CMPCOD      = ARL.CMPCOD
    AND FLTL.FLTCARIDR   = ARL.ARLIDR
    AND NOT EXISTS (SELECT CMPCOD FROM oprseguld SEGULD 
    WHERE FLTS.FLTCARIDR              = SEGULD.FLTCARIDR
    AND FLTS.FLTNUM                   = SEGULD.FLTNUM
    AND FLTS.FLTSEQNUM                = SEGULD.FLTSEQNUM
    AND FLTS.CMPCOD                   = SEGULD.CMPCOD
    AND FLTS.segsernum                = SEGULD.segsernum    
    )
	AND FLTL.LEGSTA  <> 'CAN' 
	AND FLTL.LEGSTA  <> 'TBC'
    AND FLTL.CMPCOD = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>405</QRY:Id>
		<QRY:Source Name="operations.flthandling.findPendingBuildupDetailsWith" Type="NATIVE">
			<![CDATA[

WITH
  FLT_DET AS
  (
    SELECT
      flt.fltcaridr,
    flt.fltnum,
      seg.segsernum,
    flt.fltseqnum,

flt.cmpcod,
    seg.segorg pol,
    seg.segdst pou,
    flt.fltdat,
	bkg.shppfx,
    bkgflt.mstdocnum,

bkgflt.docowridr,
    bkgflt.dupnum,
    bkgflt.seqnum,
    bkgflt.UBRNUM,
    bkgflt.cfrpcs,
    bkgflt.cfrwgt,

bkgflt.cfrvol,
    bkgflt.lwrdckone,
	bkgflt.lwrdcktwo,
	bkgflt.uprdckone,
	bkgflt.uprdcktwo ,

bkg.scccod ,
    flt.lstuldbdpdat,
    flt.bdpsta,
        NVL(
      (
        SELECT
          MAX(refhis.vernum)

FROM
          capbkgmsthis refhis,
          capbkgmstfltdtlhis fltrefhis
        WHERE
          refhis.ubrnum
= bkg.ubrnum
    AND refhis.cmpcod    = bkg.cmpcod
    AND refhis.BKGDATGMT      < PKG_FRMWRK_DATE.FUN_GET_UTCDATE(flt.cmpcod,flt.arpcod,flt.lstuldbdpdat)

AND fltrefhis.cmpcod    = refhis.cmpcod
    AND fltrefhis.vernum    = refhis.vernum
    AND fltrefhis.ubrnum
= refhis.ubrnum
    AND fltrefhis.fltnum    = bkgflt.fltnum
        AND
          (
            fltrefhis.fltseqnum
= bkgflt.fltseqnum
          OR fltrefhis.fltseqnum=0
          )
    AND fltrefhis.fltcaridr    = bkgflt.fltcaridr

)
      ,0) bkgver,
      (
        SELECT
          MAX(refhis.vernum)
        FROM
          capbkgmsthis
refhis
        WHERE
          refhis.ubrnum   = bkg.ubrnum
    AND refhis.cmpcod   = bkg.cmpcod

)
      maxbkgver ,
    bkg.ORGCOD,
    bkg.dstcod,
    bkg.prdnam prdcod,
    bkg.TOTNUMPCS,
    bkg.TOTWGT,

bkg.TOTVOL ,
    arpshp.rcvpcs,
    arpshp.rcvwgt,
    arpshp.rcvVOL,
    arpshp.bdppcs,
    arpshp.bdpwgt,

arpshp.bdpVOL,
    arpshp.avlpcs,
    arpshp.avlwgt,
    arpshp.avlVOL ,
    arpshp.acppcs,
    arpshp.acpwgt,

arpshp.acpVOL,
    arpshp.TRNSITPCS,
    arpshp.TRNSITWGT
    FROM
      oprarpexpflt flt,
    fltoprseg
seg,
    capbkgmst bkg,
    capbkgfltdtl bkgflt,
    OPRARPSHP arpshp,
      fltoprleg leg
    WHERE

seg.fltnum              = bkgflt.fltnum
  AND seg.fltcaridr         = bkgflt.fltcaridr
  AND seg.fltseqnum
= bkgflt.fltseqnum
  AND seg.segorg            = bkgflt.fltorg
  AND seg.segdst            = bkgflt.fltdst

AND seg.cmpcod            = bkgflt.cmpcod
  AND bkgflt.cmpcod         = leg.cmpcod
  AND bkgflt.fltnum
= leg.fltnum
  AND bkgflt.fltcaridr      = leg.fltcaridr
  AND bkgflt.fltseqnum      = leg.fltseqnum

AND bkgflt.fltorg         = leg.legorg
  AND bkgflt.fltbkgsta NOT IN ('X','R')
  AND seg.cmpcod
= flt.cmpcod
  AND bkg.ubrnum            = bkgflt.ubrnum
  AND bkg.cmpcod            = bkgflt.cmpcod

AND bkg.bkgsta           <> 'X'
  AND leg.fltnum            = flt.fltnum
  AND leg.fltcaridr
= flt.fltcaridr
  AND leg.fltseqnum         = flt.fltseqnum
  AND leg.LEGSERNUM         = flt.LEGSERNUM

AND leg.cmpcod            = flt.cmpcod
  AND bkg.mstdocnum         = arpshp.mstdocnum(+)
  AND bkg.docowridr
= arpshp.docowridr(+)
  AND bkg.dupnum            = arpshp.dupnum(+)
  AND bkg.seqnum            = arpshp.seqnum(+)

AND bkg.cmpcod            = arpshp.cmpcod(+)
  AND bkg.orgcod            = arpshp.arpcod(+)
        AND
flt.bdpsta            = 'C'
		AND NVL(flt.fltoprsta,'N') NOT    IN ('F','R')
  AND flt.lstuldbdpdat
>= ?
  AND flt.lstuldbdpdat     <= ?
  and leg.legorg = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>406</QRY:Id>
		<QRY:Source Name="operations.flthandling.findPendingBuildupDetailsSelect" Type="NATIVE">
			<![CDATA[
	 SELECT *
    FROM
      (
	SELECT DISTINCT flthis.fltcarcod fltcaridr,
        flthis.fltnum fltnum,

flthis.fltdat fltdat,
  expflt.fltseqnum fltseqnum,
  flthis.fltorg fltorg,
  flthis.fltsegnum fltsegnum,

expflt.cmpcod,
        fltdtl.fltorg pol,
        fltdtl.fltdst pou,
  expflt.shppfx,
  expflt.mstdocnum,

expflt.docowridr,
  expflt.dupnum,
  expflt.seqnum,
  expflt.UBRNUM,
        fltdtl.cfrpcs,
        fltdtl.cfrwgt,

fltdtl.cfrvol,
  expflt.lwrdckone,
	expflt.lwrdcktwo,
	expflt.uprdckone,
	expflt.uprdcktwo ,
  expflt.scccod
,
  expflt.ORGCOD,
  expflt.dstcod,
  expflt.prdcod,
  expflt.TOTNUMPCS,
  expflt.TOTWGT,
  expflt.TOTVOL
,
  expflt.rcvpcs,
  expflt.rcvwgt,
  expflt.rcvVOL,
  expflt.bdppcs,
  expflt.bdpwgt,
  expflt.bdpVOL,

expflt.avlpcs,
  expflt.avlwgt,
  expflt.avlVOL ,
  expflt.acppcs,
  expflt.acpwgt,
  expflt.acpVOL,

expflt.TRNSITPCS,
  expflt.TRNSITWGT,
        arpflt.lstuldbdpdat,
        segshp.bdppcs segbdppcs,

segshp.bdpwgt segbdpwgt,
        segshp.bdpVOL segbdpVOL,
        NVL(arpflt.bdpsta,'O') bdpsta,

fltdtl.shprnk
FROM capbkgmsthis msthis,
  capbkgmstfltdtlhis flthis,
        capbkgfltdtl fltdtl,

oprarpexpflt arpflt,
        oprsegshp segshp,
  FLT_DET expflt
WHERE flthis.ubrnum       = msthis.ubrnum
AND
flthis.cmpcod         = msthis.cmpcod
AND flthis.vernum         = msthis.vernum
AND flthis.fltbkgsta
NOT IN ('X','R')
AND msthis.bkgsta        <> 'X'
AND msthis.ubrnum         = expflt.ubrnum
AND msthis.cmpcod
= expflt.cmpcod
AND expflt.bkgver <> expflt.maxbkgver
      AND fltdtl.cmpcod         = flthis.cmpcod

AND fltdtl.fltnum         = flthis.fltnum
      AND fltdtl.fltcaridr      = flthis.fltcaridr
      AND
fltdtl.fltseqnum      = flthis.fltseqnum
      AND fltdtl.ubrnum         = flthis.ubrnum
      AND arpflt.cmpcod(+)
= fltdtl.cmpcod
      AND arpflt.fltnum(+)      = fltdtl.fltnum
      AND arpflt.fltcaridr(+)   = fltdtl.fltcaridr

AND arpflt.fltseqnum(+)   = fltdtl.fltseqnum
      AND segshp.fltnum (+)     = fltdtl.fltnum
      AND
segshp.fltcaridr (+)  = fltdtl.fltcaridr
      AND segshp.fltseqnum (+)  = fltdtl.fltseqnum
      AND
segshp.cmpcod (+)     = fltdtl.cmpcod
      AND segshp.cmpcod (+)     = fltdtl.cmpcod
      AND ( segshp.segsernum
= expflt.segsernum
      OR segshp.segsernum      IS NULL )
      AND fltdtl.mstdocnum      = segshp.mstdocnum(+)

AND fltdtl.docowridr      = segshp.docowridr(+)
      AND fltdtl.dupnum         = segshp.dupnum(+)

AND fltdtl.seqnum         = segshp.seqnum(+)
      AND fltdtl.cmpcod         = segshp.cmpcod(+)

AND ( arpflt.arpcod       = expflt.pol
      OR arpflt.arpcod         IS NULL )
AND(( msthis.vernum
= expflt.bkgver
AND( expflt.cmpcod        = flthis.cmpcod
AND expflt.fltnum         = flthis.fltnum
AND
expflt.fltcaridr      = flthis.fltcaridr
AND expflt.fltseqnum      = flthis.fltseqnum
AND expflt.pol
= flthis.fltorg
AND( flthis.cfrpcs       <>expflt.cfrpcs
OR flthis.cfrwgt         <>expflt.cfrwgt
OR
flthis.cfrvol         <>expflt.cfrvol
OR flthis.lwrdckone       <>expflt.lwrdckone
OR flthis.lwrdcktwo       <>expflt.lwrdcktwo
OR flthis.uprdckone       <>expflt.uprdckone
OR flthis.uprdcktwo       <> expflt.uprdcktwo) )
OR msthis.scccod         <>expflt.scccod )
OR( msthis.vernum         = expflt.maxbkgver
      AND expflt.bkgver
= 0 ) )
      ) exp
ORDER BY exp.fltnum,
  exp.fltsegnum,
  exp.fltorg
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>407</QRY:Id>
		<QRY:Source Name="operations.flthandling.findeTagConfigurations" Type="OBJECT">
			<![CDATA[
			SELECT
					uldTagConfigurations
			FROM
					com.ibsplc.icargo.business.operations.flthandling.cto.ULDTagConfigurations AS uldTagConfigurations
			WHERE
					uldTagConfigurations.uldTagConfigurationsPK.companyCode = ? AND	uldTagConfigurations.uldTagConfigurationsPK.configurationType = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>408</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.finduldtagconfigurationdetails" Type="NATIVE">
			<![CDATA[
			SELECT CFGVAL, INFOUT, PTROUT, INFRMKCTG, TAGRMKCTG FROM OPRULDTAGCFG WHERE CMPCOD = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>412</QRY:Id>
	<QRY:Source Name="operations.flthandling.getTareWeightofULDType" Type="NATIVE">
		<![CDATA[
			SELECT MAX(TAREWGT) TAREWGT
			FROM SHRULDTYPMST ULDTYPMST
			WHERE ULDTYPMST.CMPCOD      = ?
			AND ULDTYPMST.ULDTYPCOD = SUBSTR(?,0,3)
		]]>
	</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>409</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findoperationaluldweighingdetails" Type="NATIVE">
			<![CDATA[
			SELECT ACTWGT,
			  ARPCOD,
			  CMPCOD,
			  FLTCARIDR,
			  FLTNUM,
			  LEGSERNUM,
			  FLTSEQNUM,
			  LODCATCOD,
			  TARWGT,
			  ULDDST,
			  ULDNUM,
			  ULDRMK,
			  WGTTIM,
			  SERNUM
			FROM OPRULDWGTDTL WGTDTL
			WHERE WGTDTL.CMPCOD  = ?
			AND WGTDTL.ARPCOD    = ?
			AND WGTDTL.ULDNUM    = ?
			AND WGTDTL.SERNUM =
			  (SELECT MAX(SERNUM)
			  FROM OPRULDWGTDTL DTL
			  WHERE DTL.CMPCOD     = ?
			  AND DTL.ARPCOD       = ?
			  AND DTL.ULDNUM       = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>410</QRY:Id>
	<QRY:Source Name="operations.flthandling.ctm.findULDLevelCTMDetails" Type="NATIVE">
		<![CDATA[
			WITH CTM AS
  (SELECT DISTINCT LOC.ARPCOD,
    LOC.STUCOD,
    CTM.CMPCOD,
    CTM.CTMREFNUM
  FROM OPRMFTCTMSHP CTM
  JOIN WHSOPRSHPLOC LOC
  ON CTM.CMPCOD     = LOC.CMPCOD
  AND CTM.DOCOWRIDR = LOC.DOCOWRIDR
  AND CTM.MSTDOCNUM = LOC.MSTDOCNUM
  AND CTM.DUPNUM    = LOC.DUPNUM
  AND CTM.SEQNUM    = LOC.SEQNUM
  WHERE LOC.ARPCOD  =?
  AND CTM.CTMREFNUM =?
  AND CTM.CMPCOD    =?
  )
SELECT LOC.STUCOD,
  LOC.LOCCOD,
  MST.SHPPFX,
  MST.MSTDOCNUM,
  CTM1.TRFPCS,
  CTM1.TRFWGT,
  MST.DSTCOD,
  CTM1.RMK,
  LOC.LOCPCS
FROM CTM
JOIN WHSOPRSHPLOC LOC
ON CTM.CMPCOD  = LOC.CMPCOD
AND CTM.ARPCOD = LOC.ARPCOD
AND LOC.STUCOD =CTM.STUCOD
JOIN OPRSHPMST MST
ON MST.DOCOWRIDR  = LOC.DOCOWRIDR
AND MST.MSTDOCNUM = LOC.MSTDOCNUM
AND MST.SEQNUM    = LOC.SEQNUM
AND MST.DUPNUM    = LOC.DUPNUM
AND MST.CMPCOD    = LOC.CMPCOD
LEFT OUTER JOIN OPRMFTCTMSHP CTM1
ON LOC.CMPCOD     = CTM1.CMPCOD
AND LOC.DOCOWRIDR = CTM1.DOCOWRIDR
AND LOC.MSTDOCNUM = CTM1.MSTDOCNUM
AND LOC.DUPNUM    = CTM1.DUPNUM
AND LOC.SEQNUM    = CTM1.SEQNUM
JOIN SHRSYSPAR SYS
ON SYS.CMPCOD    = LOC.CMPCOD
AND SYS.PARCOD   ='warehouse.defaults.defaultStorageUnit'
WHERE MST.SEQNUM = 1
AND LOC.STUCOD  <> SYS.PARVAL
UNION
SELECT DISTINCT
  CASE
    WHEN LOC.STUCOD = SYS.PARVAL
    THEN 'BULK'
  END,
  LOC.LOCCOD,
  MST.SHPPFX,
  MST.MSTDOCNUM,
  CTM1.TRFPCS,
  CTM1.TRFWGT,
  MST.DSTCOD,
  CTM1.RMK,
  LOC.LOCPCS
FROM CTM
JOIN OPRMFTCTMSHP CTM1
ON CTM.CMPCOD     = CTM1.CMPCOD
AND CTM.CTMREFNUM = CTM1.CTMREFNUM
JOIN SHRSYSPAR SYS
ON SYS.CMPCOD  = CTM1.CMPCOD
AND SYS.PARCOD ='warehouse.defaults.defaultStorageUnit'
JOIN WHSOPRSHPLOC LOC
ON CTM1.DOCOWRIDR  = LOC.DOCOWRIDR
AND CTM1.MSTDOCNUM = LOC.MSTDOCNUM
AND CTM1.SEQNUM    = LOC.SEQNUM
AND CTM1.DUPNUM    = LOC.DUPNUM
AND CTM1.CMPCOD    = LOC.CMPCOD
AND CTM.ARPCOD     = LOC.ARPCOD
AND SYS.PARVAL     = LOC.STUCOD
JOIN OPRSHPMST MST
ON MST.DOCOWRIDR  = LOC.DOCOWRIDR
AND MST.MSTDOCNUM = LOC.MSTDOCNUM
AND MST.SEQNUM    = LOC.SEQNUM
AND MST.DUPNUM    = LOC.DUPNUM
AND MST.CMPCOD    = LOC.CMPCOD
WHERE MST.SEQNUM  = 1
		]]>
	</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>411</QRY:Id>
	<QRY:Source Name="operations.flthandling.interline.retrieveAirportHubShipments" Type="NATIVE">
		<![CDATA[
		UNION 
					SELECT MST.STDWGTCOD STDWGTCOD,ARPSHP.ACPDAT ACPDAT, 
					  MST.STDWGT STDWGT, 
					  MST.GRSVOLUNT STDVOLUNT, 
					  MST.GRSVOL STDVOL, 
					  MST.STDPCS STDPCS, 
					  MST.SHPPFX, 
					  MST.SHPDES SHPDCL, 
					  MST.SCCCOD SCCCOD, 
					  MST.ORGCOD ORGCOD, 
					  MST.DOCNUM, 
					  MST.MSTDOCNUM, 
					  MST.DSTCOD DSTCOD, 
					  MST.PLTFLG, 
					  MST.STDDISWGT DISSTDWGT, 
					  MST.GRSDISVOL DISSTDVOL, 
					  MST.CONFLG, 
					  MST.EXEFLG, 
					  MST.EFTAWBFLG, 
					  MST.DUPNUM, 
					  MST.DOCOWRIDR, 
					  MST.CMPCOD, 
					  MST.SEQNUM, 
					  ARPSHP.AVLPCS, 
					  ARPSHP.AVLWGT, 
					  ARPSHP.AVLVOL, 
					  MST.AGTCOD, 
					  ARPSHP.INBCARCOD FLTCARCOD,
					   ARPSHP.PLTUSEFLG
					FROM 
					OPRARPSHP ARPSHP , OPRSHPMST MST 
					where MST.CMPCOD = ARPSHP.CMPCOD 
					AND MST.MSTDOCNUM = ARPSHP.MSTDOCNUM 
					AND MST.DOCOWRIDR = ARPSHP.DOCOWRIDR 
					AND MST.SEQNUM = ARPSHP.SEQNUM 
					AND MST.DUPNUM = ARPSHP.DUPNUM 
					AND ARPSHP.AVLPCS>0 
					and ARPSHP.ARPCOD = ? 
					AND TRUNC(ARPSHP.ACPDAT) BETWEEN TRUNC(?) AND  TRUNC(?)
					AND NOT EXISTS 
							(SELECT 1 
							FROM SHRARLACTMST 
							WHERE TWOAPHCOD = ARPSHP.OUBCARCOD 
							AND (ISSPRTARL = 'Y' 
							OR OWNARLIND = 'Y') 
							AND CMPCOD = MST.CMPCOD 
							) 
					 AND NOT EXISTS
					(SELECT 1
					FROM SHRARLARPPAR
					WHERE ARPCOD = ARPSHP.ARPCOD
					AND PARCOD   = 'operations.flthandling.handlecarrier'
					AND PARVAL   = 'Y'
					AND CMPCOD   = ARPSHP.CMPCOD
					AND ARLIDR   =
					  (SELECT ARLIDR
					  FROM SHRARLMST
					  WHERE ( TWOAPHCOD = ARPSHP.OUBCARCOD
					  OR THRAPHCOD      = ARPSHP.OUBCARCOD )
					  AND ACTIND = 'A' 
					  AND CMPCOD        = ARPSHP.CMPCOD
					  )
					AND NVL (
					  (SELECT PARVAL
					  FROM SHRSYSPAR
					  WHERE PARCOD = 'operations.flthandling.ctm.blockretreivehandlecarriershipments'
					  AND CMPCOD   = ARPSHP.CMPCOD
					  ), 'N' )     = 'Y'
					) 		
		]]>
	</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>412</QRY:Id>
	<QRY:Source Name="operations.flthandling.cto.findimportflightprogressdetails_flightdetails" Type="NATIVE">
		<![CDATA[
			SELECT * FROM ( SELECT * FROM (SELECT DISTINCT FLT.FLTCARIDR,
  Flt.Fltnum,
  Flt.cmpcod,
  FLT.FLTSEQNUM
FROM FLTOPRLEG LEG
JOIN FLTOPRMST FLT
ON LEG.CMPCOD     = FLT.CMPCOD
AND LEG.FLTCARIDR = FLT.FLTCARIDR
AND LEG.FLTNUM    = FLT.FLTNUM
AND LEG.FLTSEQNUM = FLT.FLTSEQNUM
INNER JOIN SHRARLMST ARLMST
ON ARLMST.CMPCOD  = FLT.CMPCOD
AND ARLMST.ARLIDR = FLT.FLTCARIDR
LEFT OUTER JOIN OPRfltseg sEG
ON leg.CMPCOD     = seg.CMPCOD
AND LEG.FLTCARIDR = SEG.FLTCARIDR
AND LEG.FLTNUM    = SEG.FLTNUM
AND LEG.FLTSEQNUM = SEG.FLTSEQNUM
AND LEG.LEGDST    = SEG.POU

	]]>
	</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>416</QRY:Id>
	<QRY:Source Name="operations.flthandling.cto.findexportflightprogressdetails_flightdetails" Type="NATIVE">
		<![CDATA[
		select cmpcod,fltcaridr FLTMSTCARIDR,fltnum FLTMSTFLTNUM,fltseqnum FLTMSTFLTSEQNUM,legorg FLTLEGORG,std LEGSTD from fltoprleg fltleg where
                                                                        FLTLEG.LEGORG    =  ? 
                                                                                        AND FLTLEG.CMPCOD    = ?
	]]>
	</QRY:Source>
	</QRY:Definition>
<QRY:Definition>
		<QRY:Id>417</QRY:Id>
		<QRY:Source Name="operations.flthandling.findoperationalflightloaddetails" Type="OBJECT">
	  	<![CDATA[
	  		SELECT flightLoadDetail from
				OperationalFlightLoadDetails  as flightLoadDetail
				WHERE
				flightLoadDetail.operationalFlightLoadDetailsPK.companyCode= ? AND				
				flightLoadDetail.operationalFlightLoadDetailsPK.carrierId= ? AND
				flightLoadDetail.operationalFlightLoadDetailsPK.flightNumber= ? AND
				flightLoadDetail.operationalFlightLoadDetailsPK.flightSequenceNumber= ? AND
				flightLoadDetail.operationalFlightLoadDetailsPK.segmentSerialNumber= ?  
		]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>418</QRY:Id>
		<QRY:Source Name="operations.flthandling.findpendingairlinedetails" Type="OBJECT">
	  	<![CDATA[
	  	SELECT  FRMARL,TOOARL,SUM(TOTAL) AS TOTAL FROM (
  (select impflt.fltcarcod frmarl,
   ONWRTG.FLTCARCOD TOOARL, 
   COUNT(SEGSHP.MSTDOCNUM)  AS TOTAL 
 FROM OPRARPIMPFLT IMPFLT, 
   OPRSEGSHP SEGSHP, 
   OPRSHPRTG ONWRTG, 
    OPRFLTSEG FLTSEG,
   OPRARPSHP ARPSHP 
  WHERE FLTSEG.CMPCOD    = IMPFLT.CMPCOD
  AND FLTSEG.FLTCARIDR = IMPFLT.FLTCARIDR
  AND FLTSEG.FLTNUM    = IMPFLT.FLTNUM
  AND FLTSEG.FLTSEQNUM = IMPFLT.FLTSEQNUM
  AND FLTSEG.POU    =    IMPFLT.ARPCOD 
  AND SEGSHP.CMPCOD    = IMPFLT.CMPCOD
  AND SEGSHP.FLTCARIDR = IMPFLT.FLTCARIDR
  AND SEGSHP.FLTNUM    = IMPFLT.FLTNUM
  AND SEGSHP.FLTSEQNUM = IMPFLT.FLTSEQNUM
  AND SEGSHP.SEGSERNUM = FLTSEG.SEGSERNUM
  and  ARPSHP.CMPCOD  = SEGSHP.CMPCOD
  AND ARPSHP.DOCOWRIDR = SEGSHP.DOCOWRIDR
  AND ARPSHP.MSTDOCNUM = SEGSHP.MSTDOCNUM
  AND ARPSHP.SEQNUM    = SEGSHP.SEQNUM
  AND ARPSHP.DUPNUM    = SEGSHP.DUPNUM
  AND ARPSHP.CMPCOD    = ONWRTG.CMPCOD
  AND ARPSHP.DOCOWRIDR = ONWRTG.DOCOWRIDR
  AND ARPSHP.MSTDOCNUM = ONWRTG.MSTDOCNUM
  AND ARPSHP.SEQNUM    = ONWRTG.SEQNUM
  AND ARPSHP.DUPNUM    = ONWRTG.DUPNUM
 AND ARPSHP.AVLPCS    > 0
  AND ARPSHP.SEQNUM    = 1
  AND FLTSEG.POU    = ARPSHP.ARPCOD
 AND ONWRTG.RTGSERNUM = 
   (SELECT MAX (RTGSERNUM) + 1 
   FROM OPRSHPRTG RTG1 
    WHERE RTG1.CMPCOD  = ARPSHP.CMPCOD
    AND RTG1.MSTDOCNUM = ARPSHP.MSTDOCNUM
    AND RTG1.DOCOWRIDR = ARPSHP.DOCOWRIDR
    AND RTG1.SEQNUM    = ARPSHP.SEQNUM
    AND RTG1.DUPNUM    = ARPSHP.DUPNUM
   AND RTG1.DSTCOD = IMPFLT.ARPCOD 
   AND RTG1.FLTCARCOD = IMPFLT.FLTCARCOD 
   ) 
 
 AND NOT EXISTS 
   (SELECT 1 
   FROM SHRARLARPPAR 
   WHERE ARPCOD = ?
   AND PARCOD = 'operations.flthandling.handlecarrier' 
   AND PARVAL = 'Y' 
   AND CMPCOD = IMPFLT.CMPCOD 
   AND ARLIDR = 
     (SELECT ARLIDR 
     FROM SHRARLMST 
     WHERE ( TWOAPHCOD = ONWRTG.FLTCARCOD 
     OR THRAPHCOD = ONWRTG.FLTCARCOD ) 
	  AND ACTIND = 'A' 
     AND CMPCOD = IMPFLT.CMPCOD 
     ) 
   AND NVL ( 
     (SELECT PARVAL 
     FROM SHRSYSPAR 
     WHERE PARCOD = 'operations.flthandling.ctm.blockretreivehandlecarriershipments'
      AND CMPCOD = IMPFLT.CMPCOD 
     ), 'N' ) = 'Y' 
   ) 
 AND NOT EXISTS 
   (SELECT 1 
   FROM SHRARLACTMST 
   WHERE TWOAPHCOD = ONWRTG.FLTCARCOD 
   AND (ISSPRTARL = 'Y' 
   OR OWNARLIND = 'Y') 
   AND CMPCOD = IMPFLT.CMPCOD 
   ) 
 AND IMPFLT.ARPCOD = ? 
 AND IMPFLT.FLTDAT BETWEEN ? AND ? 
  GROUP BY impflt.fltcarcod, ONWRTG.FLTCARCOD
	) 
   

		]]>
	</QRY:Source>
	</QRY:Definition>
<QRY:Definition>
		<QRY:Id>412</QRY:Id>
		<QRY:Source Name="operations.flthandling.findontopuldManifestDetails" Type="NATIVE">
			<![CDATA[
			SELECT EXPFLT.CMPCOD,
				  EXPFLT.ARPCOD,
				  EXPFLT.FLTCARCOD,
				  EXPFLT.FLTCARIDR,
				  EXPFLT.FLTNUM,

EXPFLT.FLTSEQNUM,
				  FLTSEG.POL SEGPOL,
				  FLTSEG.POU SEGPOU,
				  SEGULD.SEGSERNUM,
				  SEGULD.ULDNUM,

SEGULD.ULDCTR,
				  SEGULD.BARROWFLG,
				  SEGULD.BSEFLG,
				  SEGULD.BSEPLT,
				  SEGULD.TARWGT,

SEGULD.ACTWGT,
				  SEGULD.NETWGT,
				  SEGULD.GRSWGT,
				  SEGULD.BUPFLG,
				  SEGULD.BKGTYP BKGTYP,

SEGULD.ULDBKGIDR ULDBKGIDR,
				  SEGULD.ULDDST ULDULDDST,
				  SEGULD.LOCCOD
				FROM OPRARPEXPFLT
EXPFLT,
				  OPRFLTSEG FLTSEG,
				  OPRSEGULD SEGULD
				WHERE EXPFLT.CMPCOD  = FLTSEG.CMPCOD
				AND
EXPFLT.FLTCARIDR = FLTSEG.FLTCARIDR
				AND EXPFLT.FLTNUM    = FLTSEG.FLTNUM
				AND EXPFLT.FLTSEQNUM
= FLTSEG.FLTSEQNUM
				AND EXPFLT.ARPCOD    = FLTSEG.POL
				AND FLTSEG.CMPCOD    = SEGULD.CMPCOD

AND FLTSEG.FLTCARIDR = SEGULD.FLTCARIDR
				AND FLTSEG.FLTNUM    = SEGULD.FLTNUM
				AND FLTSEG.FLTSEQNUM
= SEGULD.FLTSEQNUM
				AND FLTSEG.SEGSERNUM = SEGULD.SEGSERNUM
				AND SEGULD.CMPCOD    = ?
				AND EXPFLT.FLTCARIDR
= ?
				AND EXPFLT.FLTNUM    = ?
				AND EXPFLT.FLTSEQNUM = ?
				AND EXPFLT.ARPCOD    =?
				AND SEGULD.BSEPLT    =?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>412</QRY:Id>
		<QRY:Source Name="operations.flthandling.fetchapplicableshipmentsforexportstorage" Type="NATIVE">
			<![CDATA[
		SELECT DISTINCT MST.CMPCOD,
		MST.DOCOWRIDR,
		MST.MSTDOCNUM,
		MST.SEQNUM,
		MST.DUPNUM,
		MST.ORGCOD
		FROM OPRSHPMST MST
		INNER JOIN OPRARPSHP ARP
		ON MST.CMPCOD 			= ARP.CMPCOD
		AND MST.DOCOWRIDR		= ARP.DOCOWRIDR
		AND MST.MSTDOCNUM     	= ARP.MSTDOCNUM
		AND MST.SEQNUM         	= ARP.SEQNUM
		AND MST.DUPNUM 			= ARP.DUPNUM
		AND MST.ORGCOD         	= ARP.ARPCOD
		INNER JOIN OPRSEGSHP SEGSHP
		ON MST.CMPCOD = SEGSHP.CMPCOD
		AND MST.DOCOWRIDR      = SEGSHP.DOCOWRIDR
		AND MST.MSTDOCNUM      = SEGSHP.MSTDOCNUM
		AND MST.SEQNUM         = SEGSHP.SEQNUM
		AND MST.DUPNUM         = SEGSHP.DUPNUM
		INNER JOIN OPRFLTSEG FLTSEG
		ON SEGSHP.CMPCOD = FLTSEG.CMPCOD
		AND SEGSHP.FLTCARIDR   = FLTSEG.FLTCARIDR
		AND SEGSHP.FLTNUM      = FLTSEG.FLTNUM
		AND SEGSHP.FLTSEQNUM   = FLTSEG.FLTSEQNUM
		AND SEGSHP.SEGSERNUM   = FLTSEG.SEGSERNUM
		INNER JOIN FLTOPRLEG FLTLEG
		ON FLTSEG.CMPCOD = FLTLEG.CMPCOD
		AND FLTSEG.FLTCARIDR   = FLTLEG.FLTCARIDR
		AND FLTSEG.FLTNUM      = FLTLEG.FLTNUM
		AND FLTSEG.FLTSEQNUM   = FLTLEG.FLTSEQNUM
		AND FLTSEG.POL         = FLTLEG.LEGORG
		INNER JOIN FLTOPRMST FLTMST
		ON FLTLEG.CMPCOD = FLTMST.CMPCOD
		AND FLTLEG.FLTCARIDR = FLTMST.FLTCARIDR
		AND FLTLEG.FLTNUM = FLTMST.FLTNUM
		AND FLTLEG.FLTSEQNUM = FLTMST.FLTSEQNUM
		where MST.CMPCOD = ?
		AND TRUNC(FLTLEG.STD) = ?
		AND FLTMST.FLTSTA NOT IN ('CAN')
		AND MST.STDPCS = ARP.BDPPCS
		AND ARP.ACPPCS         > 0
		AND ARP.MFTPCS         > 0
		AND MST.DTACPTFLG = 'Y'
		AND ARP.ACPPCS         > 0
		AND ARP.MFTPCS         > 0
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>414</QRY:Id>
		<QRY:Source Name="operations.flthandling.findShipmentDtlsforBreakDownForHHT" Type="NATIVE">
			<![CDATA[
		SELECT ARPSHP.RCVPCS
		FROM OPRARPSHP ARPSHP
		INNER JOIN OPRSHPMST SHPMST
		ON SHPMST.CMPCOD     = ARPSHP.CMPCOD
		AND SHPMST.DOCOWRIDR = ARPSHP.DOCOWRIDR
		AND SHPMST.MSTDOCNUM = ARPSHP.MSTDOCNUM
		AND SHPMST.DUPNUM    = ARPSHP.DUPNUM
		AND SHPMST.SEQNUM    = ARPSHP.SEQNUM
		AND ARPSHP.ARPCOD    = ?
		AND SHPMST.CMPCOD    = ?
		AND SHPMST.DOCOWRIDR = ?
		AND SHPMST.MSTDOCNUM = ?
		AND SHPMST.DUPNUM    = ?
		AND SHPMST.SEQNUM    = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>416</QRY:Id>
		<QRY:Source Name="operations.flthandling.findOperationalExportFlightStatus" Type="NATIVE">
			<![CDATA[
		SELECT
  (SELECT FLTOWN
  FROM FLTOPRMST
  WHERE CMPCOD  = LEG.CMPCOD
  AND FLTNUM    = LEG.FLTNUM

AND FLTCARIDR = LEG.FLTCARIDR
  AND FLTSEQNUM = LEG.FLTSEQNUM
  ) FLTCARCOD ,
  LEG.FLTCARIDR,
  LEG.FLTNUM,

LEG.FLTSEQNUM,
  COALESCE (LEG.ATD, LEG.STD )FLTDAT,
  LEG.LEGORG ARPCOD ,
  EXP.FLTOPRSTA,
  EXP.RELFLG,

EXP.FINFLG,
  LEG.LEGSERNUM,
  LEG.CMPCOD
FROM FLTOPRLEG LEG ,OPRARPEXPFLT EXP
WHERE LEG.CMPCOD
= EXP.CMPCOD(+)
AND LEG.FLTNUM                                              = EXP.FLTNUM(+)
AND LEG.FLTCARIDR
= EXP.FLTCARIDR(+)
AND LEG.FLTSEQNUM                                           = EXP.FLTSEQNUM(+)
AND
LEG.LEGSERNUM                                           = EXP.LEGSERNUM(+)
AND LEG.LEGORG
= EXP.ARPCOD (+)
AND LEG.CMPCOD                                              = ?
AND (LEG.FLTCARIDR,
LEG.FLTNUM, LEG.FLTSEQNUM, LEG.LEGORG) IN (
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>417</QRY:Id>
		<QRY:Source Name="operations.flthandling.fetchFlightsForAutoProcess" Type="NATIVE">
			<![CDATA[
			  SELECT FLTLEG.CMPCOD,
    FLTLEG.FLTCARIDR,
    FLTLEG.FLTNUM,
    FLTLEG.FLTSEQNUM,
    FLTLEG.LEGDST,

FLTLEG.STAUTC,
    FLTLEG.ATAUTC,
    FLTLEG.STA FLTDAT,
    FLTLEG.LEGSERNUM,
    FLTLEG.LEGDST ARPCOD,

IMPFLT.FFMRCVDAT,
    ARPPAR.PARCOD,
    USEARP.OFLFLG,
    (CASE
	ARLMST.APHCODUSE
	WHEN 2

THEN ARLMST.TWOAPHCOD
	ELSE ARLMST.THRAPHCOD
	END) FLTCARCOD,
     STN.NONMECFLG,
	EXPFLT.FINFLG
  FROM FLTOPRLEG FLTLEG

INNER JOIN FLTOPRMST FLTMST
  ON FLTLEG.CMPCOD     = FLTMST.CMPCOD
  AND FLTLEG.FLTCARIDR = FLTMST.FLTCARIDR

AND FLTLEG.FLTNUM    = FLTMST.FLTNUM
  AND FLTLEG.FLTSEQNUM = FLTMST.FLTSEQNUM
  LEFT OUTER JOIN OPRARPIMPFLT
IMPFLT
  ON FLTLEG.CMPCOD     = IMPFLT.CMPCOD
  AND FLTLEG.LEGDST    = IMPFLT.ARPCOD
  AND FLTLEG.FLTCARIDR
= IMPFLT.FLTCARIDR
  AND FLTLEG.FLTNUM    = IMPFLT.FLTNUM
  AND FLTLEG.FLTSEQNUM = IMPFLT.FLTSEQNUM
  LEFT OUTER JOIN OPRARPEXPFLT EXPFLT 
  ON FLTLEG.CMPCOD = EXPFLT.CMPCOD 
  AND FLTLEG.LEGORG = EXPFLT.ARPCOD 
  AND FLTLEG.FLTCARIDR = EXPFLT.FLTCARIDR 
  AND FLTLEG.FLTNUM = EXPFLT.FLTNUM 
  AND FLTLEG.FLTSEQNUM = EXPFLT.FLTSEQNUM 
  AND FLTLEG.LEGSERNUM = EXPFLT.LEGSERNUM 
INNER JOIN SHRSTNARP ARP
  ON FLTLEG.CMPCOD  = ARP.CMPCOD
  AND FLTLEG.LEGDST = ARP.ARPCOD
  INNER JOIN
SHRSTNMST STN
  ON STN.CMPCOD  = ARP.CMPCOD
  AND STN.STNCOD = ARP.STNCOD
  INNER JOIN SHRUSEARP USEARP

ON ARP.CMPCOD  = USEARP.CMPCOD
  AND ARP.ARPCOD = USEARP.ARPCOD
  INNER JOIN SHRUSEARPPAR ARPPAR
  ON
ARP.CMPCOD                    = ARPPAR.CMPCOD
  AND ARP.ARPCOD                   = ARPPAR.ARPCOD
  AND ARPPAR.PARCOD                ='operations.flthandling.autoclsflt.minimumduration'
  LEFT OUTER JOIN SHRUSEARPPAR ARPPARFORCLS
ON ARP.CMPCOD           = ARPPARFORCLS.CMPCOD
AND ARP.ARPCOD          = ARPPARFORCLS.ARPCOD
AND ARPPARFORCLS.PARCOD ='operations.flthandling.flightsforautoclosure'
  INNER
JOIN SHRARLMST ARLMST
  ON FLTLEG.CMPCOD = ARLMST.CMPCOD
  AND  FLTLEG.FLTCARIDR = ARLMST.ARLIDR

WHERE FLTLEG.CMPCOD              = ?
  AND 1                =
  CASE
    WHEN ARPPARFORCLS.PARVAL     = 'BDNCPL'
    AND EXISTS
      (SELECT 1
      FROM OPRFLTSEG FLTSEG,
        OPRSEGULD SEGULD
      WHERE FLTLEG.CMPCOD  = FLTSEG.CMPCOD
      AND FLTLEG.LEGDST    = FLTSEG.POU
      AND FLTLEG.FLTCARIDR = FLTSEG.FLTCARIDR
      AND FLTLEG.FLTNUM    = FLTSEG.FLTNUM
      AND FLTLEG.FLTSEQNUM = FLTSEG.FLTSEQNUM
      AND SEGULD.CMPCOD    = FLTSEG.CMPCOD
      AND SEGULD.SEGSERNUM = FLTSEG.SEGSERNUM
      AND SEGULD.FLTCARIDR = FLTSEG.FLTCARIDR
      AND SEGULD.FLTNUM    = FLTSEG.FLTNUM
      AND SEGULD.FLTSEQNUM = FLTSEG.FLTSEQNUM
      AND SEGULD.BDNCPLFLG ='Y'
      )
    AND NOT EXISTS
      (SELECT 1
      FROM OPRFLTSEG FLTSEG,
        OPRSEGULD SEGULD
      WHERE FLTLEG.CMPCOD           = FLTSEG.CMPCOD
      AND FLTLEG.LEGDST             = FLTSEG.POU
      AND FLTLEG.FLTCARIDR          = FLTSEG.FLTCARIDR
      AND FLTLEG.FLTNUM             = FLTSEG.FLTNUM
      AND FLTLEG.FLTSEQNUM          = FLTSEG.FLTSEQNUM
      AND SEGULD.CMPCOD             = FLTSEG.CMPCOD
      AND SEGULD.SEGSERNUM          = FLTSEG.SEGSERNUM
      AND SEGULD.FLTCARIDR          = FLTSEG.FLTCARIDR
      AND SEGULD.FLTNUM             = FLTSEG.FLTNUM
      AND SEGULD.FLTSEQNUM          = FLTSEG.FLTSEQNUM
      AND NVL(SEGULD.BDNCPLFLG,'N') ='N'
      )
    THEN 1
    WHEN ARPPARFORCLS.PARVAL IS NULL
    THEN 1
    WHEN ARPPARFORCLS.PARVAL ='ALLFLT'
    THEN 1
    ELSE 0
  END
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>418</QRY:Id>
		<QRY:Source Name="operations.flthandling.closeOperationalulds" Type="OBJECT">
			<![CDATA[
			CALL PKG_OPR_SHP.SPR_RELEASE_ULD (?)
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>419</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.isbreakdownstartedforflight" Type="NATIVE">
			<![CDATA[
		SELECT 'Y' BDNSTRFLG FROM DUAL WHERE EXISTS( SELECT SHP.MSTDOCNUM
		FROM OPRSEGSHP SHP,
		OPRFLTSEG SEG,
		SHRUSEARP USEARP
		WHERE SEG.FLTNUM  =SHP.FLTNUM
		AND SEG.FLTCARIDR =SHP.FLTCARIDR
		AND SEG.FLTSEQNUM =SHP.FLTSEQNUM
		AND SEG.SEGSERNUM =SHP.SEGSERNUM
		AND SEG.CMPCOD    =SHP.CMPCOD
		AND SEG.CMPCOD    =USEARP.CMPCOD
		AND SEG.POU       =USEARP.ARPCOD
		AND USEARP.OFLFLG='N'
		AND SEG.CMPCOD    =?
		AND SEG.FLTNUM    =?
		AND SEG.FLTCARIDR =?
		AND SEG.FLTSEQNUM =?
        AND SHP.RCVPCS > 0
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>420</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.finddeconsolidationdetailsforautocomplete" Type="NATIVE">
			<![CDATA[
					SELECT ARPSHP.CMPCOD,
		  ARPSHP.DOCOWRIDR,
		  ARPSHP.MSTDOCNUM,
		  ARPSHP.DUPNUM,
		  ARPSHP.SEQNUM,

ARPSHP.ARPCOD,
		  ARPSHP.LSTUPDTIM,
		  ARPSHP.DCSTIM,
  ARPSHP.AVLPCS,
  ARPSHP.AVLWGT,
		  SHPLOC.WHSCOD,

SHPLOC.STUCOD,
		  SHPLOC.LOCCOD,
		  SHPLOC.LOCPCS,
		  SHPLOC.LOCWGT,
  ARPSHPHSE.TOTAVLPCSHSE,
  ARPSHPHSE.TOTAVLWGTHSE

FROM OPRARPSHP ARPSHP
		INNER JOIN WHSOPRSHPLOC SHPLOC
		ON ARPSHP.CMPCOD     = SHPLOC.CMPCOD
  SHPLOCGRP.TOTLOCPCS,
  SHPLOCGRP.TOTLOCWGT
AND ARPSHP.DOCOWRIDR = SHPLOC.DOCOWRIDR

AND ARPSHP.DUPNUM    = SHPLOC.DUPNUM
		AND ARPSHP.ARPCOD    = SHPLOC.ARPCOD
		INNER JOIN
  (SELECT CMPCOD,
    DOCOWRIDR,
    MSTDOCNUM,
    DUPNUM,
    SEQNUM,
    ARPCOD,
    SUM(LOCPCS) TOTLOCPCS,
    SUM(LOCWGT) TOTLOCWGT
  FROM WHSOPRSHPLOC SHPLOC
  WHERE SEQNUM = 1
  GROUP BY CMPCOD,
    DOCOWRIDR,
    MSTDOCNUM,
    DUPNUM,
    SEQNUM,
    ARPCOD
  ) SHPLOCGRP
ON ARPSHP.CMPCOD                   = SHPLOCGRP.CMPCOD
AND ARPSHP.DOCOWRIDR               = SHPLOCGRP.DOCOWRIDR
AND ARPSHP.MSTDOCNUM               = SHPLOCGRP.MSTDOCNUM
AND ARPSHP.DUPNUM                  = SHPLOCGRP.DUPNUM
AND ARPSHP.SEQNUM                  = SHPLOCGRP.SEQNUM
AND ARPSHP.ARPCOD                  = SHPLOCGRP.ARPCOD

<> 1
		  GROUP BY ARPSHP.CMPCOD,
			ARPSHP.DOCOWRIDR,
			ARPSHP.MSTDOCNUM,
			ARPSHP.DUPNUM,
			ARPSHP.ARPCOD
		  
		  ) ARPSHPHSE
		ON ARPSHP.CMPCOD                                     = ARPSHPHSE.CMPCOD
= ARPSHPHSE.DOCOWRIDR
		AND ARPSHP.MSTDOCNUM                                 = ARPSHPHSE.MSTDOCNUM
		AND ARPSHP.DUPNUM                                    = ARPSHPHSE.DUPNUM
= ARPSHPHSE.ARPCOD
		WHERE ARPSHP.seqnum                                  = 1
AND ARPSHP.DCSFLG                  = 'Y'
= 'Y'
		AND COALESCE(ARPSHP.DCSCPLFLG,'N')                   = 'N'
		AND ARPSHP.CMPCOD = ?
AND ARPSHP.DCSTIM + ?              < SYSDATE
AND TOTLOCPCS   > 0
< SYSDATE
AND AVLPCS - TOTAVLPCSHSE > 0
		ORDER BY CMPCOD,
		  DOCOWRIDR,
		  MSTDOCNUM,
		  DUPNUM
		]]>
	</QRY:Source>
</QRY:Definition>
<QRY:Definition>
	<QRY:Id>421</QRY:Id>
	<QRY:Source Name="operations.flthandling.cto.canFFMUpdateImportManifest" Type="NATIVE">
			<![CDATA[
				SELECT ARPCOD || '-' || COALESCE(MANUPD,'N') MANUPDFLG
				FROM OPRARPIMPFLT
				WHERE CMPCOD  = ?
				AND FLTCARIDR = ?
				AND FLTSEQNUM = ?
				AND FLTNUM    = ?
		]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>419</QRY:Id>
	<QRY:Source Name="operations.flthandling.findshipmentsforairportuldnotoc" Type="NATIVE">
		<![CDATA[
			  SELECT ULDSHP.CMPCOD, 
  ULDSHP.DOCOWRIDR, 
  ULDSHP.MSTDOCNUM, 
  ULDSHP.DUPNUM, 
  ULDSHP.ULDNUM, 
  ULDSHP.SEQNUM, 
  ULDSHP.NUMPCS BDPPCS, 
  ULDSHP.WGT BDPWGT,  
  SHP.CAOFLG, 
  SHP.SHPPFX, 
  SHP.SCCCOD MSTSCCCOD, 
  SHP.STDPCS, 
  SHP.STDWGT, 
  SCC.SCCCOD, 
  SCC.DGRIND, 
  ULD.POU, 
  ULD.ULDNUM, 
  DGR.SCCCOD DGSCCCOD, 
  DGR.SCCCODONE DGSCCCODONE, 
  DGR.SCCCODTWO DGSCCCODTWO, 
  DGR.UNIIDR, 
  DGR.PROSHPNAM, 
  DGR.TECNAM, 
  DGR.PKGGRP, 
  DGR.PKGINS, 
  DGR.RMC, 
  DGR.PKGGRPRMC, 
  DGR.ERGCOD, 
  DGR.SHPCLS, 
  DGR.SUBRSKONE, 
  DGR.SUBRSKTWO , 
  DGR.SUBRSKTHR, 
  DGR.ALLPCKSERNUM, 
  DGR.OVRPCKSERNUM, 
  DGR.NOOFOVRPACKS, 
  DGR.NOOFALLPACKS, 
  DGR.PKGGRPDIMHGT, 
  DGR.PKGDIMHGT, 
  DGR.NUMPKG, 
  DGR.NETQTY, 
  DGR.NETQTYUNT, 
  DGR.NETGRSIND, 
  DGR.TPTIND, 
  DGR.RDOACTFLG,
  ULD.INBFLTCARIDR FLTCARIDR,
ULDSHP.NONDGRFLG, 
  ULDSHP.NONSPLLODFLG  
FROM OPRARPULD ULD, 
  OPRULDSHP ULDSHP, 
  OPRSHPMST SHP, 
  OPRSHPDGR DGR, 
  SHRSCCMST SCC 
WHERE ULD.ARPCOD = ULDSHP.ARPCOD 
AND ULD.ULDNUM = ULDSHP.ULDNUM 
AND ULD.CMPCOD = ULDSHP.CMPCOD 
AND ULDSHP.CMPCOD = SHP.CMPCOD 
AND ULDSHP.MSTDOCNUM = SHP.MSTDOCNUM 
AND ULDSHP.DOCOWRIDR = SHP.DOCOWRIDR 
AND ULDSHP.DUPNUM = SHP.DUPNUM 
AND ULDSHP.SEQNUM = SHP.SEQNUM 
AND SHP.CMPCOD = DGR.CMPCOD(+) 
AND SHP.MSTDOCNUM = DGR.MSTDOCNUM(+) 
AND SHP.DOCOWRIDR = DGR.DOCOWRIDR(+) 
AND SHP.DUPNUM = DGR.DUPNUM(+) 
AND SHP.SEQNUM = DGR.SEQNUM(+) 
AND SCC.CMPCOD = SHP.CMPCOD 
AND ULD.CMPCOD = ? 
AND ULD.ULDNUM = ?
AND ULD.ARPCOD = ? 
AND SCC.NTCIND = 'Y' 
AND INSTR(SHP.SCCCOD,SCC.SCCCOD) > 0
		]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
<QRY:Id>420</QRY:Id>
<QRY:Source Name="operations.flthandling.findUldNotocDetailsForShipment" Type="NATIVE">
<![CDATA[	
SELECT ARPDGR.CMPCOD,
  ARPDGR.DOCOWRIDR,
  ARPDGR.MSTDOCNUM,
  ARPDGR.DUPNUM,
  ARPDGR.SEQNUM,
  NULL FLTCARIDR,
  NULL FLTNUM,
  NULL FLTSEQNUM,
 NULL LEGSERNUM,
  NULL SERNUM,
  ARPDGR.ULDNUM,
  ARPDGR.UNIIDR,
  ARPDGR.NUMPKG,
  ARPDGR.PCSINNULD,
  ARPDGR.PROSHPNAM PRPSHPNAM,
  ARPDGR.ALLPCKSERNUM,
  ARPDGR.OVRPCKSERNUM,
  ARPDGR.DGRSERNUM,
   NULL LSTUPDTIM,
   NULL LSTUPDUSR,
  NULL FLTDAT,
  NULL FLTCARCOD,
  NULL SCCCOD,
  NULL SEGSERNUM,
  NULL SHPCLS,
  NULL PKGGRP,
  NULL RMC,
  NULL SUBRSKONE,
  NULL SUBRSKTWO,
  NULL SUBRSKTHR,
  NULL CRGHLD,
  NULL POS
FROM OPRARPDGR ARPDGR 
WHERE ARPDGR.CMPCOD = ? 
AND ARPDGR.DOCOWRIDR = ? 
AND ARPDGR.MSTDOCNUM = ? 
AND ARPDGR.DUPNUM = ? 
AND ARPDGR.SEQNUM = ? 
]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
		<QRY:Id>291</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findImportFlightOperationsDetails" Type="NATIVE">
			<![CDATA[	
			SELECT FLTMST.CMPCOD,
			  LEG.FLTCARIDR,
			  LEG.FLTNUM,
			  LEG.FLTSEQNUM,
			(SELECT (CASE B.APHCODUSE WHEN 2 THEN B.TWOAPHCOD ELSE B.THRAPHCOD END)
			FROM SHRARLMST B WHERE
			B.CMPCOD = LEG.CMPCOD
			AND B.ARLIDR = LEG.FLTCARIDR
			) FLTCARCOD,
			  LEG.LEGDST,
			  LEG.LEGORG,
			  LEG.ATA,
			  LEG.ETA,
			  LEG.STA,
			  LEG.LEGSERNUM,
			  LEG.TALNUM,
			  LEG.ACRTYP,
			  FLTMST.FLTROU,
			  FLTMST.FLTDAT,
			  FLTMST.FLTTYP,
			  FLTMST.DOMFLTFLG,
			  ULDSHP.ADDSCC,
			  ULDSHP.MFTPCS,
			  ULDSHP.MFTWGT,
			  ULDSHP.RCVPCS,
			  ULDSHP.RCVWGT,
			  ULDSHP.RMK,
			  SEGULD.ULDNUM,
			  SEGULD.ULDSTA,
			  SEGULD.GRSWGT,
			  SEGULD.BSEFLG,
			  RMPULD.RCVHNDFLG,
			  SEGULD.NETWGT,
			  SEGULD.TARWGT,
			  SEGULD.RMK,
			  SEGULD.RMK ULDRMK,
			  SHPMST.SHPPFX,
			  SHPMST.MSTDOCNUM,
			  SHPMST.DOCOWRIDR,
			  SHPMST.DUPNUM,
			  SHPMST.SEQNUM,
			  SHPMST.PRDNAM,
			  SHPMST.STDWGT,
			  SHPMST.STDPCS,
			  SHPMST.SCCCOD,
			  SHPMST.ORGCOD,
			  SHPMST.DSTCOD,
			  SHPMST.CNSNAM,
			  SHPMST.SHPDES,
			  DMGDIS.MSTDOCNUM DMGDOCNUM,
			  SHPMST.ORGCOD,
        		  SHPMST.DSTCOD,
        		  SEGULD.ULDPOS ULDPOS,
				  SEGULD.BDNITN
			FROM FLTOPRLEG LEG
			INNER JOIN FLTOPRMST FLTMST
			ON LEG.CMPCOD     = FLTMST.CMPCOD
			AND LEG.FLTNUM    = FLTMST.FLTNUM
			AND LEG.FLTCARIDR = FLTMST.FLTCARIDR
			AND LEG.FLTSEQNUM = FLTMST.FLTSEQNUM
			INNER JOIN OPRFLTSEG FLTSEG
			ON LEG.CMPCOD     = FLTSEG.CMPCOD
			AND LEG.FLTNUM    = FLTSEG.FLTNUM
			AND LEG.FLTCARIDR = FLTSEG.FLTCARIDR
			AND LEG.FLTSEQNUM = FLTSEG.FLTSEQNUM
			AND LEG.LEGDST    = FLTSEG.POU
			INNER JOIN OPRSEGULD SEGULD
			ON FLTSEG.FLTNUM     = SEGULD.FLTNUM
			AND FLTSEG.FLTCARIDR = SEGULD.FLTCARIDR
			AND FLTSEG.FLTNUM    = SEGULD.FLTNUM
			AND FLTSEG.FLTSEQNUM = SEGULD.FLTSEQNUM
			AND FLTSEG.SEGSERNUM = SEGULD.SEGSERNUM
			AND FLTSEG.CMPCOD    = SEGULD.CMPCOD
			LEFT OUTER JOIN OPRSEGULDSHP ULDSHP
			ON SEGULD.FLTNUM     = ULDSHP.FLTNUM
			AND SEGULD.FLTCARIDR = ULDSHP.FLTCARIDR
			AND SEGULD.FLTNUM    = ULDSHP.FLTNUM
			AND SEGULD.FLTSEQNUM = ULDSHP.FLTSEQNUM
			AND SEGULD.SEGSERNUM = ULDSHP.SEGSERNUM
			AND SEGULD.CMPCOD    = ULDSHP.CMPCOD
			AND SEGULD.ULDNUM    = ULDSHP.ULDNUM
			LEFT OUTER JOIN WHSRMPULD RMPULD
			ON SEGULD.FLTNUM     = RMPULD.FLTNUM
			AND SEGULD.FLTCARIDR = RMPULD.FLTCARIDR
			AND SEGULD.FLTSEQNUM = RMPULD.FLTSEQNUM
			AND SEGULD.CMPCOD    = RMPULD.CMPCOD
			AND SEGULD.ULDNUM    = RMPULD.ULDNUM
			AND LEG.LEGDST = RMPULD.ARPCOD
			LEFT OUTER JOIN OPRARPIMPFLT IMPFLT
			ON LEG.CMPCOD     = IMPFLT.CMPCOD
			AND LEG.FLTNUM    = IMPFLT.FLTNUM
			AND LEG.FLTCARIDR = IMPFLT.FLTCARIDR
			AND LEG.FLTSEQNUM = IMPFLT.FLTSEQNUM
			AND LEG.LEGDST    = IMPFLT.ARPCOD
			LEFT OUTER JOIN OPRSHPMST SHPMST
			ON ULDSHP.DUPNUM     = SHPMST.DUPNUM
			AND ULDSHP.SEQNUM    = SHPMST.SEQNUM
			AND ULDSHP.MSTDOCNUM = SHPMST.MSTDOCNUM
			AND ULDSHP.DOCOWRIDR = SHPMST.DOCOWRIDR
			AND ULDSHP.CMPCOD    = SHPMST.CMPCOD
			LEFT OUTER JOIN OPRDMGDIS DMGDIS
			ON 'Y' = ?
			AND ULDSHP.DUPNUM                             = DMGDIS.DUPNUM
			AND ULDSHP.SEQNUM                            = DMGDIS.SEQNUM
			AND ULDSHP.MSTDOCNUM                         = DMGDIS.MSTDOCNUM
			AND ULDSHP.DOCOWRIDR                         = DMGDIS.DOCOWRIDR
			AND LEG.LEGDST                               = DMGDIS.ARPCOD
			AND ULDSHP.CMPCOD                            = DMGDIS.CMPCOD
			]]>
		</QRY:Source>
			</QRY:Definition>
<QRY:Definition>
	<QRY:Id>417</QRY:Id>
	<QRY:Source Name="operations.flthandling.fetchexportflightmanifesteddetails" Type="NATIVE">
		<![CDATA[
			  SELECT SEG.CMPCOD,
			  SEG.FLTCARIDR,
			  SEG.FLTNUM,
			  SEG.FLTSEQNUM,
			  SEG.POL,
			  (SELECT  COUNT(ULDSHP.MSTDOCNUM) 
			  FROM OPRSEGULDSHP  ULDSHP , 
			  OPRSEGULD SEGULD 
			  WHERE SEGULD.CMPCOD    = ULDSHP.CMPCOD
			  AND SEGULD.FLTCARIDR = ULDSHP.FLTCARIDR
			  AND SEGULD.FLTNUM    = ULDSHP.FLTNUM
			  AND SEGULD.FLTSEQNUM = ULDSHP.FLTSEQNUM
			  AND SEGULD.SEGSERNUM = ULDSHP.SEGSERNUM
			  AND SEGULD.ULDNUM    = ULDSHP.ULDNUM
			  AND (ULDSHP.ULDNUM ='BULK'
			  OR SEGULD.BARROWFLG ='Y')   
			  AND ULDSHP.FLTNUM = ?
			  AND ULDSHP.FLTCARIDR= ?
			  AND ULDSHP.FLTSEQNUM= ?
			  ) BULKAWBCOUNT  ,
			  SUM(CASE WHEN (ULDSHP.ULDNUM    ='BULK' OR SEGULD.BARROWFLG = 'Y')
			  THEN ULDSHP.MFTPCS ELSE 0 END) BULKMFTPCS,
			  SUM(CASE WHEN (ULDSHP.ULDNUM    ='BULK' OR SEGULD.BARROWFLG = 'Y')
			  THEN ULDSHP.MFTWGT ELSE 0 END) BULKMFTWGT,
			  
			  SUM(CASE WHEN (ULDSHP.ULDNUM    <> 'BULK' AND (SEGULD.BARROWFLG <> 'Y' OR SEGULD.BARROWFLG IS NULL ))
			  THEN ULDSHP.MFTPCS ELSE 0 END) ULDMFTPCS,
			  SUM(CASE WHEN (ULDSHP.ULDNUM    <> 'BULK' AND (SEGULD.BARROWFLG <> 'Y' OR SEGULD.BARROWFLG IS NULL ))
			  THEN ULDSHP.MFTWGT ELSE 0 END) ULDMFTWGT,
			   (SELECT  COUNT(ULDSHP.MSTDOCNUM) 
			  FROM OPRSEGULDSHP  ULDSHP , 
			  OPRSEGULD SEGULD 
			  WHERE SEGULD.CMPCOD    = ULDSHP.CMPCOD
			  AND SEGULD.FLTCARIDR = ULDSHP.FLTCARIDR
			  AND SEGULD.FLTNUM    = ULDSHP.FLTNUM
			  AND SEGULD.FLTSEQNUM = ULDSHP.FLTSEQNUM
			  AND SEGULD.SEGSERNUM = ULDSHP.SEGSERNUM
			  AND SEGULD.ULDNUM    = ULDSHP.ULDNUM
			  AND (ULDSHP.ULDNUM <>'BULK'
			  AND (SEGULD.BARROWFLG <> 'Y' OR SEGULD.BARROWFLG IS NULL ))   
			  AND ULDSHP.FLTNUM = ?
			  AND ULDSHP.FLTCARIDR= ?
			  AND ULDSHP.FLTSEQNUM=?
			  )   ULDAWBCOUNT ,
			  SUM(NVL(OFL.OFLPCS,0)) OFLPCS,
			  SUM(NVL(OFL.OFLWGT,0)) OFLWGT,
			    COUNT(OFL.MSTDOCNUM) OFLAWBCOUNT
			FROM OPRFLTSEG SEG,
			  OPRSEGULD SEGULD,
			  OPRSEGULDSHP ULDSHP,
			  OPROFLDTL OFL
			  
			WHERE SEG.CMPCOD     = SEGULD.CMPCOD
			AND SEG.FLTCARIDR    = SEGULD.FLTCARIDR
			AND SEG.FLTNUM       = SEGULD.FLTNUM
			AND SEG.FLTSEQNUM    = SEGULD.FLTSEQNUM
			AND SEGULD.CMPCOD    = ULDSHP.CMPCOD
			AND SEGULD.FLTCARIDR = ULDSHP.FLTCARIDR
			AND SEGULD.FLTNUM    = ULDSHP.FLTNUM
			AND SEGULD.FLTSEQNUM = ULDSHP.FLTSEQNUM
			AND SEGULD.SEGSERNUM = ULDSHP.SEGSERNUM
			AND SEGULD.ULDNUM    = ULDSHP.ULDNUM
			AND SEGULD.CMPCOD    = OFL.CMPCOD(+)
			AND SEGULD.FLTCARIDR = OFL.FLTCARIDR(+)
			AND SEGULD.FLTNUM    = OFL.FLTNUM(+)
			AND SEGULD.FLTSEQNUM = OFL.FLTSEQNUM(+)
			AND SEGULD.SEGSERNUM = OFL.SEGSERNUM(+)
		]]>
	</QRY:Source>
</QRY:Definition>
<QRY:Definition>
	<QRY:Id>417</QRY:Id>
	<QRY:Source Name="operations.flthandling.fetchimportflightmanifesteddetails" Type="NATIVE">
		<![CDATA[
			  SELECT SEG.CMPCOD,
		  SEG.FLTCARIDR,
		  SEG.FLTNUM,
		  SEG.FLTSEQNUM,
		  SEG.POL,
		  
		  SUM(CASE WHEN (ULDSHP.ULDNUM    ='BULK' OR SEGULD.BARROWFLG = 'Y')
		  THEN ULDSHP.MFTPCS ELSE 0 END) BULKMFTPCS,
		  SUM(CASE WHEN (ULDSHP.ULDNUM    ='BULK' OR SEGULD.BARROWFLG = 'Y')
		  THEN ULDSHP.MFTWGT ELSE 0 END) BULKMFTWGT,
		  
		  SUM(CASE WHEN (ULDSHP.ULDNUM    <> 'BULK' AND (SEGULD.BARROWFLG <> 'Y' OR SEGULD.BARROWFLG IS NULL ))
		  THEN ULDSHP.MFTPCS ELSE 0 END) ULDMFTPCS,
		  SUM(CASE WHEN (ULDSHP.ULDNUM    <> 'BULK' AND (SEGULD.BARROWFLG <> 'Y' OR SEGULD.BARROWFLG IS NULL ))
		  THEN ULDSHP.MFTWGT ELSE 0 END) ULDMFTWGT
		  
		FROM OPRFLTSEG SEG,
		  OPRSEGULD SEGULD,
		  OPRSEGULDSHP ULDSHP
		  
		WHERE SEG.CMPCOD     = SEGULD.CMPCOD
		AND SEG.FLTCARIDR    = SEGULD.FLTCARIDR
		AND SEG.FLTNUM       = SEGULD.FLTNUM
		AND SEG.FLTSEQNUM    = SEGULD.FLTSEQNUM
		AND SEGULD.CMPCOD    = ULDSHP.CMPCOD
		AND SEGULD.FLTCARIDR = ULDSHP.FLTCARIDR
		AND SEGULD.FLTNUM    = ULDSHP.FLTNUM
		AND SEGULD.FLTSEQNUM = ULDSHP.FLTSEQNUM
		AND SEGULD.SEGSERNUM = ULDSHP.SEGSERNUM
		AND SEGULD.ULDNUM    = ULDSHP.ULDNUM
		]]>
	</QRY:Source>
</QRY:Definition>


<QRY:Definition>
		<QRY:Id>419</QRY:Id>
		<QRY:Source Name="operations.flthandling.fetchapplicableflightdetailsforairlineexportbilling" Type="OBJECT">
		<![CDATA[
			SELECT MST.CMPCOD,
			  MST.FLTCARIDR,
			  MST.FLTNUM,
			  MST.FLTDAT,
			  MST.FLTSEQNUM,
			  LEG.LEGORG,
			  ARLPAR.PARVAL CUSCOD,
			  STNMST.CURCOD
			FROM FLTOPRMST MST,
			  OPRARPEXPFLT EXPFLT,
			  FLTOPRLEG LEG,
			  SHRARLPAR ARLPAR,
			  SHRSTNMST STNMST
			WHERE MST.CMPCOD      = EXPFLT.CMPCOD
			AND MST.FLTCARIDR     = EXPFLT.FLTCARIDR
			AND MST.FLTNUM        = EXPFLT.FLTNUM
			AND MST.FLTSEQNUM     = EXPFLT.FLTSEQNUM
			AND EXPFLT.CMPCOD     = LEG.CMPCOD
			AND EXPFLT.FLTCARIDR  = LEG.FLTCARIDR
			AND EXPFLT.FLTNUM     = LEG.FLTNUM
			AND EXPFLT.FLTSEQNUM  = LEG.FLTSEQNUM
			AND EXPFLT.LEGSERNUM  = LEG.LEGSERNUM
			AND MST.CMPCOD        = ARLPAR.CMPCOD
			AND MST.FLTCARIDR     = ARLPAR.ARLIDR
			AND ARLPAR.PARCOD = 'shared.airline.airlinecreditcustomer'
			AND LEG.CMPCOD = STNMST.CMPCOD
			AND LEG.LEGORG = STNMST.STNCOD
			
			AND EXPFLT.FINFLG    IN ('F','R')
			AND EXPFLT.FINDAT    >= ?
			AND EXPFLT.FLTDAT    <= ?
		]]>
	</QRY:Source>
</QRY:Definition>

<QRY:Definition>
		<QRY:Id>420</QRY:Id>
		<QRY:Source Name="operations.flthandling.fetchapplicableflightdetailsforairlineimportbilling" Type="OBJECT">
		<![CDATA[
			SELECT MST.CMPCOD,
			  MST.FLTCARIDR,
			  MST.FLTNUM,
			  MST.FLTSEQNUM,
			  LEG.LEGDST,
			  ARLPAR.PARVAL CUSCOD,
			  STNMST.CURCOD
			FROM FLTOPRMST MST,
			  OPRARPIMPFLT IMPFLT,
			  FLTOPRLEG LEG,
			  SHRARLPAR ARLPAR,
			  SHRSTNMST STNMST
			WHERE MST.CMPCOD      = IMPFLT.CMPCOD
			AND MST.FLTCARIDR     = IMPFLT.FLTCARIDR
			AND MST.FLTNUM        = IMPFLT.FLTNUM
			AND MST.FLTSEQNUM     = IMPFLT.FLTSEQNUM
			AND IMPFLT.CMPCOD     = LEG.CMPCOD
			AND IMPFLT.FLTCARIDR  = LEG.FLTCARIDR
			AND IMPFLT.FLTNUM     = LEG.FLTNUM
			AND IMPFLT.FLTSEQNUM  = LEG.FLTSEQNUM
			AND IMPFLT.LEGSERNUM  = LEG.LEGSERNUM
			AND MST.CMPCOD        = ARLPAR.CMPCOD
			AND MST.FLTCARIDR     = ARLPAR.ARLIDR
			AND ARLPAR.PARCOD = 'shared.airline.airlinecreditcustomer'
			AND LEG.CMPCOD = STNMST.CMPCOD
			AND LEG.LEGORG = STNMST.STNCOD
			AND IMPFLT.ARLBLGFLG <> 'Y'	
			AND IMPFLT.CLSFLG     = 'Y'
			AND IMPFLT.CLSDAT    >= ?
			AND IMPFLT.CLSDAT    <= ?
		]]>
	</QRY:Source>
</QRY:Definition>

<QRY:Definition>
		<QRY:Id>421</QRY:Id>
		<QRY:Source Name="operations.flthandling.fetchflightdetailsforairlineexportbilling" Type="OBJECT">
		<![CDATA[
SELECT FLTLEG.CMPCOD,
  FLTLEG.FLTCARIDR,
  FLTLEG.FLTNUM,
  FLTLEG.FLTSEQNUM,
  FLTLEG.LEGORG,
			   ARLPAR.PARVAL,
			CUSMST.CUSNAM,
			  SUM(
			  CASE
				WHEN (ULDSHP.ULDNUM ='BULK'
				OR SEGULD.BARROWFLG = 'Y')
				THEN ULDSHP.MFTPCS
				ELSE 0
			  END) BULKMFTPCS,
			  SUM(
			  CASE
				WHEN (ULDSHP.ULDNUM ='BULK'
				OR SEGULD.BARROWFLG = 'Y')
				THEN ULDSHP.MFTWGT
				ELSE 0
			  END) BULKMFTWGT,
			  SUM(
			  CASE
				WHEN (ULDSHP.ULDNUM <> 'BULK'
				OR SEGULD.BARROWFLG <> 'Y')
				THEN ULDSHP.MFTPCS
				ELSE 0
			  END) ULDMFTPCS,
			  SUM(
			  CASE
				WHEN (ULDSHP.ULDNUM <> 'BULK'
				OR SEGULD.BARROWFLG <> 'Y')
				THEN ULDSHP.MFTWGT
				ELSE 0
			  END) ULDMFTWGT,
			  SUM(NVL(OFL.OFLPCS,0)) OFLPCS,
			  SUM(NVL(OFL.OFLWGT,0)) OFLWGT
			FROM OPRFLTSEG SEG,
			  OPRSEGULD SEGULD,
			  OPRSEGULDSHP ULDSHP,
			  OPROFLDTL OFL,        
			SHRARLPAR ARLPAR,
  SHRCUSMST CUSMST,
  FLTOPRMST FLTMST,
  FLTOPRLEG FLTLEG
WHERE FLTMST.cmpcod  =FLTLEG.cmpcod
AND FLTMST.fltcaridr = FLTLEG.fltcaridr
AND FLTMST.fltnum    = FLTLEG.fltnum
AND FLTMST.fltseqnum =FLTLEG.fltseqnum
AND FLTMST.cmpcod    =SEG.cmpcod (+)
AND FLTMST.fltcaridr = SEG.fltcaridr(+)
AND FLTMST.fltnum    = SEG.fltnum(+)
AND FLTMST.fltseqnum = SEG.fltseqnum(+)
AND SEG.CMPCOD       = SEGULD.CMPCOD(+)
AND SEG.FLTCARIDR    = SEGULD.FLTCARIDR(+)
AND SEG.FLTNUM       = SEGULD.FLTNUM(+)
AND SEG.FLTSEQNUM    = SEGULD.FLTSEQNUM(+)
AND SEGULD.CMPCOD    = ULDSHP.CMPCOD(+)
AND SEGULD.FLTCARIDR = ULDSHP.FLTCARIDR(+)
AND SEGULD.FLTNUM    = ULDSHP.FLTNUM(+)
AND SEGULD.FLTSEQNUM = ULDSHP.FLTSEQNUM(+)
AND SEGULD.SEGSERNUM = ULDSHP.SEGSERNUM(+)
AND SEGULD.ULDNUM    = ULDSHP.ULDNUM(+)
AND SEGULD.CMPCOD    = OFL.CMPCOD(+)
AND SEGULD.FLTCARIDR = OFL.FLTCARIDR(+)
AND SEGULD.FLTNUM    = OFL.FLTNUM(+)
AND SEGULD.FLTSEQNUM = OFL.FLTSEQNUM(+)
AND SEGULD.SEGSERNUM = OFL.SEGSERNUM(+)
AND FLTMST.CMPCOD       = ARLPAR.CMPCOD
AND FLTMST.Fltcaridr    = ARLPAR.Arlidr
AND ARLPAR.PARCOD    = 'shared.airline.airlinecreditcustomer'
AND CUSMST.CMPCOD    = ARLPAR.cmpcod
AND CUSMST.CUSCOD    = UPPER(ARLPAR.PARVAL)
AND FLTLEG.CMPCOD       = ?
AND FLTLEG.FLTCARIDR    = ?
AND FLTLEG.FLTNUM       = ?
AND FLTLEG.FLTSEQNUM    = ?
AND FLTLEG.legorg       = ?
GROUP BY FLTLEG.CMPCOD,
  FLTLEG.FLTCARIDR,
  FLTLEG.FLTNUM,
  FLTLEG.FLTSEQNUM,
  FLTLEG.LEGORG,
			  ARLPAR.PARVAL,
			CUSMST.CUSNAM
		]]>
	</QRY:Source>
</QRY:Definition>
<QRY:Definition>
		<QRY:Id>422</QRY:Id>
		<QRY:Source Name="operations.flthandling.fetchflightdetailsforairlineimportbilling" Type="OBJECT">
		<![CDATA[
			SELECT FLTLEG.CMPCOD,
  FLTLEG.FLTCARIDR,
  FLTLEG.FLTNUM,
  FLTLEG.FLTSEQNUM,
  FLTLEG.LEGDST,
			  ARLPAR.PARVAL,
			 CUSMST.CUSNAM,
			  SUM(
			  CASE
				WHEN (ULDSHP.ULDNUM ='BULK'
				OR SEGULD.BARROWFLG = 'Y')
				THEN ULDSHP.MFTPCS
				ELSE 0
			  END) BULKMFTPCS,
			  SUM(
			  CASE
				WHEN (ULDSHP.ULDNUM ='BULK'
				OR SEGULD.BARROWFLG = 'Y')
				THEN ULDSHP.MFTWGT
				ELSE 0
			  END) BULKMFTWGT,
			  SUM(
			  CASE
				WHEN (ULDSHP.ULDNUM <> 'BULK'
				OR SEGULD.BARROWFLG <> 'Y')
				THEN ULDSHP.MFTPCS
				ELSE 0
			  END) ULDMFTPCS,
			  SUM(
			  CASE
				WHEN (ULDSHP.ULDNUM <> 'BULK'
				OR SEGULD.BARROWFLG <> 'Y')
				THEN ULDSHP.MFTWGT
				ELSE 0
			  END) ULDMFTWGT
FROM fltoprmst FLTMST,
  FLTOPRLEG FLTLEG,
  OPRFLTSEG SEG,
  OPRSEGULD SEGULD,
  OPRSEGULDSHP ULDSHP,
  SHRARLPAR ARLPAR,
  SHRCUSMST CUSMST
WHERE FLTMST.cmpcod  =FLTLEG.cmpcod
AND FLTMST.fltcaridr = FLTLEG.fltcaridr
AND FLTMST.fltnum    = FLTLEG.fltnum
AND FLTMST.fltseqnum =FLTLEG.fltseqnum
AND FLTMST.cmpcod    =SEG.cmpcod (+)
AND FLTMST.fltcaridr = SEG.fltcaridr(+)
AND FLTMST.fltnum    = SEG.fltnum(+)
AND FLTMST.fltseqnum = SEG.fltseqnum(+)
AND SEG.cmpcod       = seguld.cmpcod(+)
AND SEG.fltcaridr    = seguld.fltcaridr(+)
AND SEG.fltnum       = seguld.fltnum(+)
AND SEG.fltseqnum    = seguld.fltseqnum(+)
AND seguld.cmpcod    = uldshp.cmpcod(+)
AND seguld.fltcaridr = uldshp.fltcaridr(+)
AND seguld.fltnum    = uldshp.fltnum(+)
AND seguld.fltseqnum = uldshp.fltseqnum(+)
AND seguld.segsernum = uldshp.segsernum(+)
AND seguld.uldnum    = uldshp.uldnum(+)
AND FLTMST.cmpcod    = ARLPAR.cmpcod
AND FLTMST.fltcaridr = ARLPAR.arlidr
AND ARLPAR.PARCOD    = 'shared.airline.airlinecreditcustomer'
AND CUSMST.CMPCOD    = ARLPAR.cmpcod
AND CUSMST.cuscod    = UPPER(ARLPAR.parval)
AND FLTLEG.cmpcod    = ?
AND FLTLEG.fltcaridr = ?
AND FLTLEG.fltnum    = ?
AND fltleg.fltseqnum = ?
AND fltleg.legdst    = ?
GROUP BY FLTLEG.CMPCOD,
  FLTLEG.FLTCARIDR,
  FLTLEG.FLTNUM,
  FLTLEG.fltseqnum,
  FLTLEG.LEGDST,
			   ARLPAR.PARVAL,
			CUSMST.CUSNAM
		]]>
	</QRY:Source>
</QRY:Definition>
 <!--Added by A-5956 for ICRD-85414(Arrival screen revamp)starts-->
<QRY:Definition>
		<QRY:Id>450</QRY:Id>
		<QRY:Source Name="operations.manifest.findHouseLevelInfoForAWB" Type="NATIVE">
<![CDATA[	
					SELECT SHPMST.CMPCOD,
					  SHPMST.MSTDOCNUM,
					  SHPMST.DUPNUM,
					  SHPMST.DOCNUM,
					  SHPMST.ORGCOD,
					  SHPMST.DSTCOD,
					  SHPMST.STDPCS,
					  SHPMST.STDWGT,
					  TXNHSE.PCS MFTPCS,
					  TXNHSE.WGT MFTWGT,
					  ARPSHP.RCVPCS,
					  ARPSHP.RCVWGT,
					  TXNHSE.TXNREFSIX TXNHSE 
					FROM OPRSHPMST SHPMST
					LEFT OUTER JOIN OPRARPSHP ARPSHP
					ON SHPMST.DOCOWRIDR  = ARPSHP.DOCOWRIDR
					AND SHPMST.MSTDOCNUM = ARPSHP.MSTDOCNUM
					AND SHPMST.DUPNUM    = ARPSHP.DUPNUM
					AND SHPMST.CMPCOD    = ARPSHP.CMPCOD
					LEFT OUTER JOIN OPRTXNHSE TXNHSE
					ON TXNHSE.TXNCOD     = ?
					AND SHPMST.DOCOWRIDR = TXNHSE.DOCOWRIDR
					AND SHPMST.MSTDOCNUM = TXNHSE.MSTDOCNUM
					AND SHPMST.DUPNUM    = TXNHSE.DUPNUM
					AND SHPMST.SEQNUM    = TXNHSE.SEQNUM
					AND SHPMST.CMPCOD    = TXNHSE.CMPCOD
					AND TXNHSE.TXNREFTWO =?
					AND TXNHSE.TXNREFTHR =?
					AND TXNHSE.TXNREFFIV = ?
					WHERE SHPMST.CMPCOD  = ?
					AND SHPMST.MSTDOCNUM = ?
					AND SHPMST.DOCOWRIDR = ?
					AND SHPMST.DUPNUM    = ?
					AND ARPSHP.ARPCOD 	 = ?
					AND SHPMST.SEQNUM    >1
		]]>
	</QRY:Source>
</QRY:Definition>
<!--Added by A-5956 for ICRD-85414(Arrival screen revamp)ends-->
<QRY:Definition>
	<QRY:Id>422</QRY:Id>
	<QRY:Source Name="operations.flthandling.mawberrordata" Type="NATIVE">
		<![CDATA[
			SELECT a.SHPPFX,
			  a.mstdocnum,
			  a.cmpcod ,
			  a.dupnum,
			  a.seqnum,
			  (
			  CASE
				WHEN EXEFLG = 'N'
				THEN 'AWBNOTEXE'
			  END
			  ||
			  CASE
				WHEN (BDPPCS + oflpcs ) = 0
				AND NUMPCS              > 0
				THEN ','
				  || 'BKDNOTBDP'
				WHEN BDPPCS != 0
				AND NUMPCS  != 0
				AND BDPPCS   > NUMPCS
				THEN ','
				  || 'BDPPCS_GRT_BKGPCS'
				WHEN BDPPCS != 0
				AND NUMPCS  != 0
				AND BDPPCS   < NUMPCS
				THEN ','
				  || 'BDPPCS_LESS_BKGPCS'
				WHEN (BDPPCS + oflpcs ) > 0
				AND NUMPCS              = 0
				THEN ','
				  || 'BDPNOTBKD'
			  END
			  ||
			  CASE
				WHEN BDPWGT != 0
				AND WGT     != 0
				AND BDPWGT   > WGT
				THEN ','
				  || 'BDPWGT_GRT_BKGWGT'
				WHEN BDPWGT != 0
				AND WGT     != 0
				AND BDPWGT   < WGT
				THEN ','
				  || 'BDPWGT_LESS_BKGWGT'
			  END )AS ERRCOD
			FROM
			  (SELECT SUM (a.BDPPCS )BDPPCS,
				SUM (a.BDPWGT )BDPWGT,
				SUM(a.OFLPCS)OFLPCS,
				SUM(a.NUMPCS)NUMPCS,
				SUM(a.WGT)WGT,
				a.shppfx,
				a.MSTDOCNUM ,
				a.exeflg,
				a.cmpcod ,
				a.dupnum,
				a.seqnum
			  FROM
				(SELECT FLTOPRSEG.SEGORG,
				  FLTOPRSEG.FLTCARIDR,
				  FLTOPRSEG.FLTNUM,
				  FLTOPRSEG.FLTSEQNUM,
				  FLTOPRSEG.CMPCOD AS FLTCMPCOD,
				  FLTOPRSEG.CMPCOD,
				  MST.DOCOWRIDR,
				  MST.SHPPFX,
				  MST.SEQNUM,
				  MST.DUPNUM,
				  SEGSHP.BDPPCS,
				  SEGSHP.oflpcs,
				  SEGSHP.BDPWGT,
				  0 NUMPCS,
				  0 WGT,
				  MST.EXEFLG,
				  MST.MSTDOCNUM
				FROM FLTOPRSEG FLTOPRSEG
				INNER JOIN oprsegshp SEGSHP
				ON FLTOPRSEG.FLTCARIDR  = SEGSHP.FLTCARIDR
				AND FLTOPRSEG.FLTNUM    = SEGSHP.FLTNUM
				AND FLTOPRSEG.FLTSEQNUM = SEGSHP.FLTSEQNUM
				AND FLTOPRSEG.SEGSERNUM = SEGSHP.SEGSERNUM
				AND FLTOPRSEG.CMPCOD    = SEGSHP.CMPCOD
				AND segshp.bdppcs       > 0
				INNER JOIN OPRSHPMST MST
				ON MST.CMPCOD     = SEGSHP.CMPCOD
				AND MST.DOCOWRIDR = SEGSHP.DOCOWRIDR
				AND MST.MSTDOCNUM = SEGSHP.MSTDOCNUM
				AND MST.SEQNUM    = SEGSHP.SEQNUM
				AND MST.DUPNUM    = SEGSHP.DUPNUM
				UNION
				SELECT FLTSEG.SEGORG,
				  FLTSEG.FLTCARIDR,
				  FLTSEG.FLTNUM,
				  FLTSEG.FLTSEQNUM,
				  FLTSEG.CMPCOD AS FLTCMPCOD,
				  FLTSEG.CMPCOD,
				  MST.DOCOWRIDR,
				  MST.SHPPFX,
				  MST.SEQNUM,
				  MST.DUPNUM,
				  0 BDPPCS,
				  0 oflpcs,
				  0 BDPWGT,
				  BKGDTL.NUMPCS,
				  BKGDTL.WGT,
				  MST.EXEFLG,
				  MST.MSTDOCNUM
				FROM FLTOPRSEG FLTSEG
				INNER JOIN CAPBKGFLTDTL BKGDTL
				ON FLTSEG.FLTCARIDR  = BKGDTL.FLTCARIDR
				AND FLTSEG.FLTNUM    = BKGDTL.FLTNUM
				AND FLTSEG.FLTSEQNUM = BKGDTL.FLTSEQNUM
				AND FLTSEG.SEGORG    = BKGDTL.FLTORG
				AND FLTSEG.SEGDST    = BKGDTL.FLTDST
				AND FLTSEG.CMPCOD    = BKGDTL.CMPCOD
				AND BKGDTL.FLTBKGSTA ='C'
				INNER JOIN OPRSHPMST MST
				ON MST.CMPCOD     = BKGDTL.CMPCOD
				AND MST.DOCOWRIDR = BKGDTL.DOCOWRIDR
				AND MST.MSTDOCNUM = BKGDTL.MSTDOCNUM
				AND MST.SEQNUM    = BKGDTL.SEQNUM
				AND MST.DUPNUM    = BKGDTL.DUPNUM
				) A
			 
			  where a.SEGORG  = ?
			  AND a.FLTCARIDR = ?
			  AND a.FLTNUM    = ?
			  AND a.FLTSEQNUM = ?
			  AND a.CMPCOD    = ?
			  GROUP BY a.SHPPFX,
				a.mstdocnum ,
				a.cmpcod ,
				a.dupnum,
				a.seqnum,
				a.exeflg
			  ORDER BY a.SHPPFX,
				a.MSTDOCNUM
			  )a
		]]>
	</QRY:Source>
</QRY:Definition>
<QRY:Definition>
	<QRY:Id>423</QRY:Id>
	<QRY:Source Name="operations.flthandling.hawberrordata" Type="NATIVE">
		<![CDATA[
		 SELECT SHPPFX, 
  MSTDOCNUM, 
  DUPNUM, 
  MSTSEQNUM, 
  HSESEQNUM, 
  DOCNUM, 
  HAWBBDP, 
  ERRCOD
FROM
  (SELECT SHPPFX,
    MSTDOCNUM,
    DUPNUM,
    MSTSEQNUM,
    HSESEQNUM,
    DOCNUM,
    HAWBBDP,
    (NO_HAWB_INFO || ',' || 
    HAWBPCS_LESS_MAWBPCS || ',' || 
    HAWBPCS_GRT_MAWBPCS || ',' ||
    SHPDTL_INSUFF || ',' ||
    CNSDTL_INSUFF )ERRCOD
    FROM
    (SELECT SHPPFX,
      MSTDOCNUM,
      DUPNUM,
      MSTSEQNUM,
      HSESEQNUM,
      DOCNUM,
      HAWBBDP,
  ( 
  CASE 
    WHEN HAWBBDP IS NULL 
    THEN 'NO_HAWB_INFO' 
      END)NO_HAWB_INFO,
      (
      CASE
        WHEN TXNPCS < BDPPCS THEN
        'HAWBPCS_LESS_MAWBPCS'
      END)HAWBPCS_LESS_MAWBPCS,
      (
      CASE
    WHEN TXNPCS > BDPPCS 
        THEN 'HAWBPCS_GRT_MAWBPCS'
      END)HAWBPCS_GRT_MAWBPCS,
      (
      CASE
    WHEN SHPNAM IS NULL 
    OR SHPADRONE IS NULL 
    OR SHPCTR IS NULL 
    OR SHPCTY IS NULL 
    OR SHPPSTCOD IS NULL 
        THEN 'SHPDTL_INSUFF'
      END)SHPDTL_INSUFF,
      (
      CASE
    WHEN CNSNAM IS NULL 
    OR CNSADRONE IS NULL 
    OR CNSCTR IS NULL 
    OR CNSCTY IS NULL 
    OR CNSPSTCOD IS NULL 
        THEN 'CNSDTL_INSUFF'
      END)CNSDTL_INSUFF
FROM 
  (SELECT HSE.SHPPFX , 
    HSE.MSTDOCNUM, 
    HSE.DUPNUM, 
    SEGSHP.SEQNUM MSTSEQNUM, 
    HSE.SEQNUM HSESEQNUM, 
    HSE.DOCNUM, 
    SEGSHP.BDPPCS, 
    (SELECT SUM(PCS) 
    FROM OPRTXNHSE TXNHSE 
    WHERE TXNHSE.CMPCOD =SEGSHP.CMPCOD 
    AND TXNHSE.MSTDOCNUM = SEGSHP.MSTDOCNUM 
    AND TXNHSE.DOCOWRIDR = SEGSHP.DOCOWRIDR 
    AND TXNHSE.DUPNUM = SEGSHP.DUPNUM 
    AND TXNHSE.TXNREFTWO = SEGSHP.FLTCARIDR 
    AND TXNHSE.TXNREFTHR = SEGSHP.FLTNUM 
    AND TXNHSE.TXNREFFIV = SEGSHP.FLTSEQNUM 
    AND TXNHSE.ARPCOD = FLTSEG.POL 
    AND TXNHSE.TXNCOD ='MFT' 
    ) TXNPCS, 
    (SELECT SUM(WGT) 
    FROM OPRTXNHSE TXNHSE 
    WHERE TXNHSE.CMPCOD =SEGSHP.CMPCOD 
    AND TXNHSE.MSTDOCNUM = SEGSHP.MSTDOCNUM 
    AND TXNHSE.DOCOWRIDR = SEGSHP.DOCOWRIDR 
    AND TXNHSE.DUPNUM = SEGSHP.DUPNUM 
    AND TXNHSE.TXNREFTWO = SEGSHP.FLTCARIDR 
    AND TXNHSE.TXNREFTHR = SEGSHP.FLTNUM 
    AND TXNHSE.TXNREFFIV = SEGSHP.FLTSEQNUM 
    AND TXNHSE.ARPCOD = FLTSEG.POL 
    AND TXNHSE.TXNCOD ='MFT' 
    ) TXNWGT, 
    (SELECT distinct 1 
    FROM OPRTXNHSE TXNHSE 
    WHERE TXNHSE.CMPCOD = HSE.CMPCOD 
    AND TXNHSE.MSTDOCNUM = HSE.MSTDOCNUM 
    AND TXNHSE.DOCOWRIDR = HSE.DOCOWRIDR 
    AND TXNHSE.SEQNUM = HSE.SEQNUM 
    AND TXNHSE.DUPNUM = HSE.DUPNUM 
    AND TXNHSE.TXNREFTWO = SEGSHP.FLTCARIDR 
    AND TXNHSE.TXNREFTHR = SEGSHP.FLTNUM 
    AND TXNHSE.TXNREFFIV = SEGSHP.FLTSEQNUM 
    AND TXNHSE.ARPCOD = FLTSEG.POL 
    AND TXNHSE.TXNCOD ='MFT' 
    )HAWBBDP, 
    HSE.SHPNAM, 
    HSE.SHPADRONE, 
    HSECNT.SHPCTR, 
    HSECNT.SHPCTY, 
    HSECNT.SHPPSTCOD, 
    HSE.CNSNAM, 
    HSE.CNSADRONE, 
    HSECNT.CNSCTR, 
    HSECNT.CNSCTY, 
    HSECNT.CNSPSTCOD 
  FROM OPRFLTSEG FLTSEG 
  JOIN OPRSEGSHP SEGSHP 
  ON FLTSEG.FLTCARIDR = SEGSHP.FLTCARIDR 
  AND FLTSEG.FLTNUM = SEGSHP.FLTNUM 
  AND FLTSEG.FLTSEQNUM = SEGSHP.FLTSEQNUM 
  AND FLTSEG.SEGSERNUM = SEGSHP.SEGSERNUM 
  AND FLTSEG.CMPCOD = SEGSHP.CMPCOD 
  JOIN OPRSHPMST HSE 
  ON SEGSHP.CMPCOD =HSE.CMPCOD 
  AND SEGSHP.MSTDOCNUM = HSE.MSTDOCNUM 
  AND SEGSHP.DOCOWRIDR = HSE.DOCOWRIDR 
  AND SEGSHP.DUPNUM = HSE.DUPNUM 
  AND SEGSHP.SEQNUM = HSE.PARSEQNUM 
  JOIN OPRSHPMSTCNT HSECNT 
  ON HSE.CMPCOD =HSECNT.CMPCOD 
  AND HSE.MSTDOCNUM = HSECNT.MSTDOCNUM 
  AND HSE.DOCOWRIDR = HSECNT.DOCOWRIDR 
  AND HSE.DUPNUM = HSECNT.DUPNUM 
  AND HSE.SEQNUM = HSECNT.SEQNUM 
  WHERE FLTSEG.POL = ?
  AND FLTSEG.FLTCARIDR = ?
  AND FLTSEG.FLTNUM = ?
  AND FLTSEG.FLTSEQNUM = ?
  AND FLTSEG.CMPCOD = ?
      )
    )
		]]>
	</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>421</QRY:Id>
<QRY:Source Name="operations.flthandling.findPendingBuildupDetails" Type="NATIVE">
<![CDATA[	
   SUBSTR(MSTDOCNUM,5) ASC )
AS
  RANK FROM
  (SELECT CMPCOD,
   DOCOWRIDR,  
   SHPPFX,
   MSTDOCNUM,
   AWBNUM, 
   SEQNUM,
   DUPNUM,
   ARPCOD,
   POU, 
   STDPCS, 
   STDWGT, 
   GRSDISVOL,
   BKGPCS, 
   BKGVOL, 
   BKGWGT, 
   BDPPCS, 
        CASE WHEN SHPSTA='ONH' THEN 0 ELSE AVLBDPPCS END AVLBDPPCS,
        CASE WHEN SHPSTA='ONH' THEN 0 ELSE AVLBDPWGT END AVLBDPWGT,
        CASE WHEN SHPSTA='ONH' THEN 0 ELSE DECODE(FLTPCS,0,0,NVL(ROUND((FLTVOL/FLTPCS)*AVLBDPPCS),0)) END AVLBDPVOL,        
   LAT, 
   SCCCOD, 
   RDYCRGFLG, 
   TRNSIT,
   LOCCOD, 
   WHSCOD,
   LOCPCS, 
   LOCWGT , 
   STUCOD, 
   NXTLOC, 
   IRRFLG , 
   SHPSTA, 
   SRVSTA, 
   BLKAUT, 
   SRVRCVSTA, 
   FLTPCS,
        SRVDES,
   STUTYPNAM,
   FLTWGT,
        FLTVOL,
        FLTNUM,
        FLTSEQNUM,
        FLTCARIDR,
        BDPFLTCARIDR,
        BDPFLTNUM,
        BDPFLTSEQNUM,
		 PLTUSEFLG,
    MSTPLTFLG
 FROM 
   (SELECT DISTINCT AWBDTL.CMPCOD,
	 AWBDTL.DOCOWRIDR, 
     AWBDTL.SEQNUM, 
     AWBDTL.DUPNUM,
     AWBDTL.ORGCOD, 
     AWBDTL.DSTCOD, 
     AWBDTL.FLTORG, 
     arpshp.AVLPCS, 
     AWBDTL.FLTPCS, 
		  AWBDTL.FLTWGT,
		  AWBDTL.FLTVOL,
          AWBDTL.FLTNUM,
          AWBDTL.FLTSEQNUM,
          AWBDTL.FLTCARIDR,
          CASE
            WHEN SEGSHP.BDPPCS>0
            THEN SEGSHP.FLTCARIDR
            ELSE NULL
          END BDPFLTCARIDR,
          CASE
            WHEN SEGSHP.BDPPCS>0
            THEN SEGSHP.FLTNUM
            ELSE NULL
          END BDPFLTNUM,
          CASE
            WHEN SEGSHP.BDPPCS>0
            THEN SEGSHP.FLTSEQNUM
            ELSE NULL
          END BDPFLTSEQNUM,
		  
     NVL(SEGSHP.BDPPCS,0)BDPPCS, 
     AWBDTL.RDYCRGFLG AS RDYCRGFLG, 
     ( 
     CASE 
       WHEN AWBDTL.FLTORG = AWBDTL.ORGCOD 
		THEN 'N'
		ELSE 'Y'
	  END ) AS TRNSIT,
     ARPSHP.ARPCOD,
	 AWBDTL.SHPPFX,
	 AWBDTL.MSTDOCNUM,
     AWBDTL.SHPPFX 
     ||'-' 
     || AWBDTL.MSTDOCNUM AWBNUM, 
     AWBDTL.FLTDST POU, 
     AWBDTL.STDPCS, 
     AWBDTL.STDWGT, 
     AWBDTL.GRSDISVOL,
     AWBDTL.BKGPCS BKGPCS, 
     AWBDTL.BKGVOL BKGVOL, 
     AWBDTL.BKGWGT BKGWGT, 
     ( 
     CASE 
            WHEN (AWBDTL.FLTORG   = AWBDTL.ORGCOD)
        THEN (
          CASE
                  WHEN (BKGMST.SHPRDYTIM IS NOT NULL)
       THEN TO_CHAR(BKGMST.SHPRDYTIM,'DD-Mon-YYYY HH24:MI') 
         ||'(' 
         ||'L' 
         ||')' 
       ELSE NULL 
              END)
           ELSE
          (SELECT TO_CHAR(COALESCE(min(FLTLEG.ATA),min(FLTLEG.ETA),min(FLTLEG.STA)), 'DD-Mon-YYYY HH24:MI')||  ' ('
       || ( 
       CASE 
                  WHEN min(FLTLEG.ATA) IS NOT NULL
         THEN 'A' 
         ELSE 
           CASE 
                      WHEN min(FLTLEG.ETA) IS NOT NULL
             THEN 'E' 
             ELSE 'S' 
           END 
       END) 
       ||')' 
     FROM CAPBKGFLTDTL FLTDTL, 
       FLTOPRLEG FLTLEG 
     WHERE AWBDTL.CMPCOD = FLTDTL.CMPCOD 
     AND AWBDTL.MSTDOCNUM = FLTDTL.MSTDOCNUM 
     AND AWBDTL.DUPNUM = FLTDTL.DUPNUM 
     AND AWBDTL.SEQNUM = FLTDTL.SEQNUM 
     AND AWBDTL.DOCOWRIDR = FLTDTL.DOCOWRIDR 
     AND AWBDTL.FLTORG = FLTDTL.FLTDST 
     AND FLTDTL.CMPCOD = FLTLEG.CMPCOD 
     AND FLTDTL.FLTCARIDR = FLTLEG.FLTCARIDR 
     AND FLTDTL.FLTNUM = FLTLEG.FLTNUM 
     AND FLTDTL.FLTSEQNUM = FLTLEG.FLTSEQNUM 
     AND FLTDTL.FLTDST = FLTLEG.LEGDST 
     AND FLTDTL.FLTBKGSTA <> 'X'
          )
          END) LAT,
          AWBDTL.SCCCOD,          
     CASE 
       WHEN SHPLOC.ARPCOD = ARPSHP.ARPCOD 
        AND (SHPLOC.STUCOD <> ULDDTL.ULDNUM
        OR ULDDTL.FLTNUM   IS NULL
        OR ULDDTL.FLTNUM    = '-1')
       THEN SHPLOC.LOCCOD 
       ELSE NULL 
     END LOCCOD, 
	 CASE 
       WHEN SHPLOC.ARPCOD = ARPSHP.ARPCOD 
        AND (SHPLOC.STUCOD <> ULDDTL.ULDNUM
        OR ULDDTL.FLTNUM   IS NULL
        OR ULDDTL.FLTNUM    = '-1')
       THEN SHPLOC.WHSCOD 
       ELSE NULL 
     END WHSCOD,
     CASE 
       WHEN SHPLOC.ARPCOD = ARPSHP.ARPCOD 
        AND (SHPLOC.STUCOD <> ULDDTL.ULDNUM
        OR ULDDTL.FLTNUM   IS NULL
        OR ULDDTL.FLTNUM    = '-1')
       THEN 
          CASE
            WHEN SHPLOC.STUCOD =SYSPAR.PARVAL
          THEN SHPLOC.LOCPCS - SHPLOC.TXNPCS 
            ELSE SHPLOC.LOCPCS
       END 
       ELSE 0 
     END LOCPCS, 
     CASE 
       WHEN SHPLOC.ARPCOD = ARPSHP.ARPCOD 
        AND (SHPLOC.STUCOD <> ULDDTL.ULDNUM
        OR ULDDTL.FLTNUM   IS NULL
        OR ULDDTL.FLTNUM    = '-1')
        THEN
          CASE
            WHEN SHPLOC.STUCOD =SYSPAR.PARVAL
          THEN DECODE(SHPLOC.LOCPCS,0,0,COALESCE(ROUND((SHPLOC.LOCWGT/SHPLOC.LOCPCS)*(SHPLOC.LOCPCS-SHPLOC.TXNPCS),2),0)) 
            ELSE SHPLOC.LOCWGT
       END 
       ELSE 0 
     END LOCWGT, 
     CASE 
       WHEN SHPLOC.ARPCOD = ARPSHP.ARPCOD 
        AND (SHPLOC.STUCOD <> ULDDTL.ULDNUM
        OR ULDDTL.FLTNUM   IS NULL
        OR ULDDTL.FLTNUM    = '-1')
       THEN SHPLOC.STUCOD 
       ELSE NULL 
     END STUCOD, 
     CASE 
       WHEN SHPLOC.ARPCOD = ARPSHP.ARPCOD 
        AND (SHPLOC.STUCOD <> ULDDTL.ULDNUM
        OR ULDDTL.FLTNUM   IS NULL
        OR ULDDTL.FLTNUM    = '-1')
       THEN SHPLOC.NXTLOC 
       ELSE NULL 
     END NXTLOC, 
     CASE 
       WHEN COALESCE(SHPLOC.ARPCOD,'XXX') != ARPSHP.ARPCOD 
				THEN (ARPSHP.AVLPCS+DECODE(AWBDTL.FLTORG,ARPSHP.ARPCOD,0,ARPSHP.TRNSITPCS))
			WHEN SHPLOC.STUCOD =SYSPAR.PARVAL OR ZONMST.ZONTYP='AUTO'
        OR ((ARPULD.ARPCOD !=NULL
        OR ULDDTL.FLTNUM   != COALESCE(SEGSHP.FLTNUM,'XXXX'))
				AND ULDDTL.FLTNUM IS NOT NULL
				AND ULDDTL.FLTNUM != '-1')
				THEN COALESCE(SHPLOC.LOCPCS-SHPLOC.TXNPCS,0)
            ELSE COALESCE(SHPLOC.LOCPCS-COALESCE(SEGSHP.BDPPCS,0),0)
     END AVLBDPPCS, 
	 CASE 
       WHEN COALESCE(SHPLOC.ARPCOD,'XXX') != ARPSHP.ARPCOD 
				THEN (ARPSHP.AVLWGT+DECODE(AWBDTL.FLTORG,ARPSHP.ARPCOD,0,ARPSHP.TRNSITWGT))
			WHEN SHPLOC.STUCOD =SYSPAR.PARVAL OR ZONMST.ZONTYP='AUTO'
        OR ((ARPULD.ARPCOD !=NULL
        OR ULDDTL.FLTNUM   != COALESCE(SEGSHP.FLTNUM,'XXXX'))
				AND ULDDTL.FLTNUM IS NOT NULL
				AND ULDDTL.FLTNUM != '-1')
				THEN DECODE(SHPLOC.LOCPCS,0,0,COALESCE(ROUND((SHPLOC.LOCWGT/SHPLOC.LOCPCS)*(SHPLOC.LOCPCS-SHPLOC.TXNPCS),2),0))
            ELSE DECODE(SHPLOC.LOCPCS,0,0,COALESCE(ROUND((SHPLOC.LOCWGT/SHPLOC.LOCPCS)*(SHPLOC.LOCPCS-COALESCE(SEGSHP.BDPPCS,0)),2),0))
     END AVLBDPWGT,
     CASE 
       WHEN ARPSHP.ARPCOD = AWBDTL.FLTORG 
       AND (COALESCE(ARPSHP.AVLPCS,0) !=0 
      AND AWBDTL.STDPCS <= ARPSHP.AVLPCS+ DECODE(NVL(ARPSHP.BDPPCS,0),0,ARPSHP.MFTPCS,ARPSHP.BDPPCS))
       THEN 'ARR' 
       WHEN ARPSHP.ARPCOD = AWBDTL.FLTORG 
      AND ((NVL(ARPSHP.AVLPCS,0)+ DECODE(NVL(ARPSHP.BDPPCS,0),0,ARPSHP.MFTPCS,ARPSHP.BDPPCS))>0
	  AND (AWBDTL.STDPCS        -(NVL(ARPSHP.AVLPCS,0)+ DECODE(NVL(ARPSHP.BDPPCS,0),0,ARPSHP.MFTPCS,ARPSHP.BDPPCS)) >0))
       THEN 'PAR' 
       ELSE 
         CASE 
           WHEN (SELECT COUNT(1) 
             FROM OPRARPSHP 
             WHERE AWBDTL.CMPCOD = CMPCOD 
             AND AWBDTL.DOCOWRIDR = DOCOWRIDR 
             AND AWBDTL.MSTDOCNUM = MSTDOCNUM 
             AND AWBDTL.SEQNUM = SEQNUM 
             AND AWBDTL.DUPNUM = DUPNUM 
             AND AWBDTL.FLTORG <> ARPCOD)>0 
            THEN 
                CASE WHEN NVL((SELECT COUNT(1)
                FROM OPRARPSHP
                WHERE AWBDTL.CMPCOD  = CMPCOD
                AND AWBDTL.DOCOWRIDR = DOCOWRIDR
                AND AWBDTL.MSTDOCNUM = MSTDOCNUM
                AND AWBDTL.SEQNUM    = SEQNUM
                AND AWBDTL.DUPNUM    = DUPNUM
                AND AWBDTL.FLTORG   = ARPCOD
                AND (AVLPCS > 0 OR BDPPCS > 0)),0) <= 0
                  THEN
                    'ONH'
                END
           ELSE 'NAR' 
         END 
     END SHPSTA, 
     SRVRCV.MANACTTYP SRVSTA, 
     SRVRCV.SRVRCVSTA, 
     (SELECT RTRIM(XMLAGG(XMLELEMENT(A,( AUT.AUTNAM 
       || ',' 
       ||CHR(10)))).EXTRACT('//text()'),',' 
       ||CHR(10)) 
     FROM OPRSHPBLK BLK, 
       OPRTXNBLKLVL LVL, 
       OPRBLKAUT AUT 
     WHERE BLK.CMPCOD = LVL.CMPCOD 
     AND BLK.BLKAUT = LVL.BLKAUT 
     AND BLK.CMPCOD = AWBDTL.CMPCOD 
     AND BLK.DOCOWRIDR = AWBDTL.DOCOWRIDR 
     AND BLK.MSTDOCNUM = AWBDTL.MSTDOCNUM 
     AND BLK.DUPNUM = AWBDTL.DUPNUM 
     AND BLK.SEQNUM = AWBDTL.SEQNUM 
     AND BLK.ARPCOD = AWBDTL.FLTORG 
     AND AUT.CMPCOD = BLK.CMPCOD 
     AND AUT.AUTCOD = BLK.BLKAUT 
     AND BLK.BLKSTA = 'B' 
     AND LVL.CHKTYP = 'E' 
     AND LVL.BLKTXN = 'BDP' 
) BLKAUT, 
     (SELECT COUNT(1) 
     FROM OPRSHPIRRDTL IRPDTL 
     WHERE IRPDTL.CMPCOD = AWBDTL.CMPCOD 
     AND IRPDTL.DOCOWRIDR = AWBDTL.DOCOWRIDR 
     AND IRPDTL.MSTDOCNUM = AWBDTL.MSTDOCNUM 
     AND IRPDTL.DUPNUM = AWBDTL.DUPNUM 
     AND IRPDTL.SEQNUM = AWBDTL.SEQNUM 
	 AND IRPDTL.ARPCOD  = AWBDTL.FLTORG
     )IRRFLG,
     (
	  CASE
		WHEN SRVRCVSTA = 'A'
		THEN ONETIM.FLDDES
		ELSE NULL
	  END) SRVDES,
		  STUMST.STUTYPNAM,
		  ARPSHP.PLTUSEFLG,
		  AWBDTL.MSTPLTFLG
   FROM CAPBKGMST BKGMST, 
     OPRSEGSHP SEGSHP, 
     WHSOPRSHPLOC SHPLOC, 
     OPRARPSHP ARPSHP, 
     SHRSYSPAR SYSPAR, 
     OPRULDDTL ULDDTL, 
     QMSSRVRCVCSE SRVRCV, 
	 SHRONETIM ONETIM,
		  OPRARPULD ARPULD,
          WHSSTUMST STUMST,
	 WHSLOCMST LOCMST,
     WHSZONMST ZONMST,
     (SELECT Z.CMPCOD, 
       Z.MSTDOCNUM, 
       Z.DOCOWRIDR, 
       Z.SEQNUM, 
       Z.DUPNUM, 
       Z.FLTORG, 
       Z.FLTDST, 
       Z.FLTNUM, 
       Z.FLTSEQNUM, 
       Z.FLTCARIDR, 
       Z.BKGPCS, 
       Z.BKGWGT, 
       Z.BKGVOL, 
       Z.ORGCOD, 
       Z.DSTCOD, 
       Z.RDYCRGFLG, 
       Z.SCCCOD, 
       Z.STDPCS, 
       Z.STDWGT, 
	   Z.GRSDISVOL,
       Z.SHPPFX , 
       Z.SEGSERNUM, 
       MAX(Z.FLTPCS) AS FLTPCS,
	   MAX(Z.FLTWGT) AS FLTWGT,
	   MAX(Z.FLTVOL) AS FLTVOL,
	   Z.MSTPLTFLG
     FROM 
       (SELECT SHPMST.CMPCOD, 
         SHPMST.MSTDOCNUM, 
         SHPMST.DOCOWRIDR, 
         SHPMST.SEQNUM, 
         SHPMST.DUPNUM, 
         SHPMST.ORGCOD, 
         SHPMST.DSTCOD, 
         SHPMST.RDYCRGFLG, 
         SHPMST.SCCCOD, 
         SHPMST.STDPCS, 
         SHPMST.STDWGT, 
		 SHPMST.GRSDISVOL,
         SHPMST.SHPPFX, 
         SHPMST.PLTFLG MSTPLTFLG,		 
         FLTDTL.NUMPCS BKGPCS, 
         FLTDTL.WGT BKGWGT, 
         FLTDTL.VOL BKGVOL, 
         FLTDTL.NUMPCS FLTPCS,
		 FLTDTL.WGT FLTWGT,
		 FLTDTL.VOL FLTVOL,
         FLTDTL.FLTORG FLTORG, 
         FLTDTL.FLTDST FLTDST, 
         FLTDTL.FLTNUM, 
         FLTDTL.FLTSEQNUM, 
         FLTDTL.FLTCARIDR, 
         FLTDTL.SEGSERNUM 
       FROM OPRSHPMST SHPMST, 
         CAPBKGFLTDTL FLTDTL 
       WHERE FLTDTL.CMPCOD = SHPMST.CMPCOD 
       AND FLTDTL.MSTDOCNUM = SHPMST.MSTDOCNUM 
       AND FLTDTL.SEQNUM = SHPMST.SEQNUM 
       AND FLTDTL.DUPNUM = SHPMST.DUPNUM 
       AND FLTDTL.DOCOWRIDR = SHPMST.DOCOWRIDR 
       AND FLTDTL.FLTBKGSTA IN ('C') 
       AND FLTDTL.FLTORG = ? 
       AND FLTDTL.FLTCARCOD = ? 
       AND FLTDTL.FLTNUM =? 
       AND FLTDTL.FLTSEQNUM = ? 
       AND FLTDTL.FLTCARIDR = ? 
       UNION 
       SELECT SHPMST.CMPCOD, 
         SHPMST.MSTDOCNUM, 
         SHPMST.DOCOWRIDR, 
         SHPMST.SEQNUM, 
         SHPMST.DUPNUM, 
         SHPMST.ORGCOD, 
         SHPMST.DSTCOD, 
         SHPMST.RDYCRGFLG, 
         SHPMST.SCCCOD, 
         SHPMST.STDPCS, 
         SHPMST.STDWGT, 
		 SHPMST.GRSDISVOL,
         SHPMST.SHPPFX, 
		 SHPMST.PLTFLG MSTPLTFLG,
         FLTDTL.NUMPCS BKGPCS, 
         FLTDTL.WGT BKGWGT, 
         FLTDTL.VOL BKGVOL, 
         PLNSHP.PLNPCS FLTPCS, 
		 PLNSHP.PLNWGT FLTWGT,
		 PLNSHP.PLNVOL FLTVOL,
         PLNSHP.SEGORG FLTORG, 
         PLNSHP.SEGDST FLTDST, 
         PLNSHP.FLTNUM, 
         PLNSHP.FLTSEQNUM, 
         PLNSHP.FLTCARIDR, 
         PLNSHP.SEGSERNUM 
       FROM OPRSHPMST SHPMST, 
         OPRLODPLNSHP PLNSHP, 
         CAPBKGFLTDTL FLTDTL 
       WHERE PLNSHP.CMPCOD = SHPMST.CMPCOD 
       AND PLNSHP.MSTDOCNUM = SHPMST.MSTDOCNUM 
       AND PLNSHP.SEQNUM = SHPMST.SEQNUM 
       AND PLNSHP.DUPNUM = SHPMST.DUPNUM 
       AND PLNSHP.DOCOWNIDR = SHPMST.DOCOWRIDR 
       AND PLNSHP.CMPCOD = FLTDTL.CMPCOD(+) 
       AND PLNSHP.MSTDOCNUM = FLTDTL.MSTDOCNUM(+) 
       AND PLNSHP.SEQNUM = FLTDTL.SEQNUM(+) 
       AND PLNSHP.DUPNUM = FLTDTL.DUPNUM(+) 
       AND PLNSHP.DOCOWNIDR = FLTDTL.DOCOWRIDR(+) 
       AND PLNSHP.FLTNUM = FLTDTL.FLTNUM(+) 
       AND PLNSHP.FLTSEQNUM = FLTDTL.FLTSEQNUM(+) 
       AND PLNSHP.FLTCARIDR = FLTDTL.FLTCARIDR(+) 
       AND PLNSHP.SEGORG = FLTDTL.FLTORG(+) 
       AND PLNSHP.SEGDST = FLTDTL.FLTDST(+) 
       AND NVL(FLTDTL.FLTBKGSTA,'C') IN ('C') 
       AND PLNSHP.SEGORG = ? 
       AND PLNSHP.CMPCOD = ? 
       AND PLNSHP.FLTNUM = ? 
       AND PLNSHP.FLTSEQNUM = ? 
       AND PLNSHP.FLTCARIDR = ? 
       )Z 
     GROUP BY Z.CMPCOD, 
       Z.MSTDOCNUM, 
       Z.DOCOWRIDR, 
       Z.SEQNUM, 
       Z.DUPNUM, 
       Z.BKGPCS, 
       Z.BKGVOL, 
       Z.BKGWGT, 
       Z.FLTORG, 
       Z.FLTDST, 
       Z.FLTNUM, 
       Z.FLTSEQNUM, 
       Z.FLTCARIDR, 
       Z.ORGCOD, 
       Z.DSTCOD, 
       Z.RDYCRGFLG, 
       Z.SCCCOD, 
       Z.STDPCS, 
       Z.STDWGT, 
	   Z.GRSDISVOL,
       Z.SHPPFX, 
       Z.SEGSERNUM,
	   Z.MSTPLTFLG
     ) AWBDTL 
   WHERE AWBDTL.CMPCOD = BKGMST.CMPCOD(+)
   AND AWBDTL.MSTDOCNUM = BKGMST.MSTDOCNUM(+)
   AND AWBDTL.SEQNUM = BKGMST.SEQNUM(+) 
   AND AWBDTL.DUPNUM = BKGMST.DUPNUM(+)
   AND AWBDTL.DOCOWRIDR = BKGMST.DOCOWRIDR(+)
   AND AWBDTL.CMPCOD = SEGSHP.CMPCOD(+) 
   AND AWBDTL.DOCOWRIDR = SEGSHP.DOCOWRIDR(+) 
   AND AWBDTL.MSTDOCNUM = SEGSHP.MSTDOCNUM(+) 
   AND AWBDTL.DUPNUM = SEGSHP.DUPNUM(+) 
   AND AWBDTL.SEQNUM = SEGSHP.SEQNUM(+) 
   AND AWBDTL.FLTCARIDR = SEGSHP.FLTCARIDR(+) 
   AND AWBDTL.FLTNUM = SEGSHP.FLTNUM(+) 
   AND AWBDTL.FLTSEQNUM = SEGSHP.FLTSEQNUM(+) 
   AND AWBDTL.SEGSERNUM = SEGSHP.SEGSERNUM(+) 
   AND AWBDTL.CMPCOD = SHPLOC.CMPCOD(+) 
   AND AWBDTL.FLTORG = SHPLOC.ARPCOD(+) 
   AND AWBDTL.DOCOWRIDR = SHPLOC.DOCOWRIDR(+) 
   AND AWBDTL.MSTDOCNUM = SHPLOC.MSTDOCNUM(+) 
   AND AWBDTL.DUPNUM = SHPLOC.DUPNUM(+) 
   AND AWBDTL.SEQNUM = SHPLOC.SEQNUM(+) 
   AND AWBDTL.CMPCOD = ARPSHP.CMPCOD (+) 
   AND AWBDTL.DOCOWRIDR = ARPSHP.DOCOWRIDR (+) 
   AND AWBDTL.MSTDOCNUM = ARPSHP.MSTDOCNUM (+) 
   AND AWBDTL.DUPNUM = ARPSHP.DUPNUM (+) 
   AND AWBDTL.SEQNUM = ARPSHP.SEQNUM (+) 
   AND AWBDTL.FLTDST != COALESCE(ARPSHP.ARPCOD,'XXX') 
   AND AWBDTL.CMPCOD = SRVRCV.CMPCOD(+) 
   AND AWBDTL.FLTORG = SRVRCV.ARPCOD(+) 
   AND AWBDTL.DOCOWRIDR = SRVRCV.DOCOWRIDR(+) 
   AND AWBDTL.MSTDOCNUM = SRVRCV.MSTDOCNUM(+) 
   AND AWBDTL.DUPNUM = SRVRCV.DUPNUM(+) 
   AND AWBDTL.SEQNUM = SRVRCV.SEQNUM(+) 
   AND AWBDTL.FLTCARIDR = SRVRCV.FLTCARIDR(+) 
   AND AWBDTL.FLTNUM = SRVRCV.FLTNUM(+) 
   AND AWBDTL.FLTSEQNUM = SRVRCV.FLTSEQNUM(+) 
   AND SYSPAR.CMPCOD = AWBDTL.CMPCOD 
   AND SYSPAR.PARCOD = 'warehouse.defaults.defaultStorageUnit' 
   AND SHPLOC.CMPCOD = ULDDTL.CMPCOD(+) 
   AND SHPLOC.STUCOD = ULDDTL.ULDNUM(+) 
   AND SRVRCV.MANACTTYP = ONETIM.FLDVAL(+)
   AND SRVRCV.CMPCOD = ONETIM.CMPCOD(+)
		AND SHPLOC.CMPCOD    = ARPULD.CMPCOD(+)
		AND SHPLOC.ARPCOD    = ARPULD.ARPCOD(+)
		AND SHPLOC.STUCOD    = ARPULD.ULDNUM(+)
   AND ONETIM.FLDTYP(+) = 'qualitymanagement.defaults.servicerecovery.actiontypes'
        AND SHPLOC.CMPCOD    = STUMST.CMPCOD(+)
        AND SHPLOC.ARPCOD    = STUMST.ARPCOD(+)
        AND SHPLOC.STUCOD    = STUMST.STUCOD(+)
	AND SHPLOC.CMPCOD = LOCMST.CMPCOD(+)
	AND SHPLOC.ARPCOD = LOCMST.ARPCOD(+)
	AND SHPLOC.WHSCOD = LOCMST.WHSCOD(+)
	AND SHPLOC.LOCCOD = LOCMST.LOCCOD(+)
	AND LOCMST.CMPCOD = ZONMST.CMPCOD(+)
	AND LOCMST.ARPCOD = ZONMST.ARPCOD(+)
	AND LOCMST.WHSCOD = ZONMST.WHSCOD(+)
	AND LOCMST.ZONCOD = ZONMST.ZONCOD(+)
]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
		<QRY:Id>422</QRY:Id>
		<QRY:Source Name="operations.flthandling.findpendingairlineairporthubdetails" Type="OBJECT">
	  	<![CDATA[	  	
   UNION ALL
 (SELECT ARPSHP.INBCARCOD FRMARL,
    ARPSHP.OUBCARCOD TOOARL,
    COUNT(ARPSHP.MSTDOCNUM) AS TOTAL
  FROM   OPRARPSHP ARPSHP,
    OPRSHPRTG ONWRTG
  WHERE
   ONWRTG.CMPCOD    = ARPSHP.CMPCOD
  AND ONWRTG.DOCOWRIDR = ARPSHP.DOCOWRIDR
  AND ONWRTG.MSTDOCNUM = ARPSHP.MSTDOCNUM
  AND ONWRTG.SEQNUM    = ARPSHP.SEQNUM
  AND ONWRTG.DUPNUM    = ARPSHP.DUPNUM
  AND (ARPSHP.AVLPCS   + 
  ARPSHP.ACPPCS )   > 0 
  AND ARPSHP.INBCARCOD    IS NOT NULL
AND ARPSHP.SEQNUM    = 1
AND ONWRTG.RTGSERNUM =
  (SELECT MAX (RTGSERNUM) + 1
  FROM OPRSHPRTG RTG1
    WHERE RTG1.CMPCOD  = ONWRTG.CMPCOD
    AND RTG1.MSTDOCNUM = ONWRTG.MSTDOCNUM
    AND RTG1.DOCOWRIDR = ONWRTG.DOCOWRIDR
    AND RTG1.SEQNUM    = ONWRTG.SEQNUM
    AND RTG1.DUPNUM    = ONWRTG.DUPNUM
  AND RTG1.DSTCOD    = ARPSHP.ARPCOD
  )
  AND ARPSHP.ARPCOD = ?
  AND TRUNC(ARPSHP.ACPDAT) BETWEEN TRUNC(?) AND TRUNC(?)
AND NOT EXISTS
  (SELECT 1
  FROM SHRARLARPPAR
    WHERE ARPCOD = ARPSHP.ARPCOD
  AND PARCOD   = 'operations.flthandling.handlecarrier'
  AND PARVAL   = 'Y'
  AND CMPCOD   = ARPSHP.CMPCOD
  AND ARLIDR   =
    (SELECT ARLIDR
    FROM SHRARLMST
    WHERE ( TWOAPHCOD = ONWRTG.FLTCARCOD
    OR THRAPHCOD      = ONWRTG.FLTCARCOD )
	AND ACTIND = 'A' 
    AND CMPCOD        = ARPSHP.CMPCOD
    )
  AND NVL (
    (SELECT PARVAL
    FROM SHRSYSPAR
    WHERE PARCOD = 'operations.flthandling.ctm.blockretreivehandlecarriershipments'
    AND CMPCOD   = ARPSHP.CMPCOD
    ), 'N' )     = 'Y'
  )
AND NOT EXISTS
  (SELECT 1
  FROM SHRARLACTMST
  WHERE TWOAPHCOD = ONWRTG.FLTCARCOD
  AND (ISSPRTARL  = 'Y'
  OR OWNARLIND    = 'Y')
  AND CMPCOD      = ARPSHP.CMPCOD
  )
  GROUP BY ARPSHP.INBCARCOD, ARPSHP.OUBCARCOD
  )
]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>424</QRY:Id>
<QRY:Source Name="operations.flthandling.findawbmanifestdetailsforcarriercertificate" Type="NATIVE">
<![CDATA[	
SELECT FLTSEG.FLTCARIDR, FLTSEG.FLTNUM, 
SEGSHP.CMPCOD, 
SEGSHP.MSTDOCNUM, 
SEGSHP.MFTPCS, 
FLTSEG.POL, 
FLTSEG.POU 
from OPRSEGSHP SEGSHP, 
OPRFLTSEG FLTSEG 
WHERE SEGSHP.FLTCARIDR = FLTSEG.FLTCARIDR 
AND SEGSHP.FLTNUM = FLTSEG.FLTNUM 
AND SEGSHP.FLTSEQNUM= FLTSEG.FLTSEQNUM 
AND SEGSHP.SEGSERNUM= FLTSEG.SEGSERNUM 
AND SEGSHP.DOCOWRIDR= ? 
AND SEGSHP.MSTDOCNUM= ? 
AND SEGSHP.DUPNUM =? 
and SEGSHP.SEQNUM = ? 
AND SEGSHP.CMPCOD = ? 
]]>
</QRY:Source>
</QRY:Definition>


<QRY:Definition>
	<QRY:Id>421</QRY:Id>
	<QRY:Source Name="operations.flthandling.findmanifestdetailsforffmo.nh" Type="NATIVE">
		<![CDATA[


WITH FLTDTL AS (
SELECT CMPCOD, UBRNUM,FLTORG, FLTDST, FLTCARCOD, FLTNUM, FLTDAT FROM CAPBKGFLTDTL DTL
WHERE UBRNUM IN (SELECT UBRNUM FROM CAPBKGFLTDTL WHERE 
CMPCOD = ? AND FLTNUM = ? AND FLTCARIDR = ? AND FLTSEQNUM = ? )
AND (DTL.CMPCOD||'~'||DTL.FLTNUM||'~'||DTL.FLTCARIDR||'~'||DTL.FLTSEQNUM) != (?) )
SELECT 
FLTSEG.POL,FLTSEG.POU, EXPFLT.ARPCOD, SHPMST.CONFLG,
SHPMST.CMPCOD, SHPMST.MSTDOCNUM, SHPMST.DOCOWRIDR, SHPMST.SEQNUM, SHPMST.DUPNUM, 
SHPMST.SHPPFX, SHPMST.SCCCOD, SHPMST.ORGCOD, SHPMST.DSTCOD, SHPMST.STDPCS, 
  SHPMST.STDDISWGT, SHPMST.STDWGT, SHPMST.SHPDES, SHPMST.PRDPRT,  SHPMST.CNSNAM,
ULDSHP.MFTPCS,ULDSHP.MFTWGT,ULDSHP.MFTVOL, ULDSHP.BDPPCS, ULDSHP.BDPWGT,ULDSHP.BDPVOL,
SEGULD.ULDNUM, /*SEGULD.ULDRMKS */
CASE WHEN SEGULD.GRSWGT = 0 THEN SEGULD.ACTWGT ELSE SEGULD.GRSWGT END ACTWGT, /* GROSS WEIGHT */
SEGULD.ULDCTR, SEGULD.RMK ULDRMK, THRRTG.THRDSTCOD, THRRTG.THRCARCOD, THRRTG.THRFLTNUM, THRRTG.THRFLTDAT,
  FLTDTL.FLTORG, FLTDTL.FLTDST, FLTDTL.FLTCARCOD, FLTDTL.FLTNUM, FLTDTL.FLTDAT
FROM OPRARPEXPFLT EXPFLT,
  OPRFLTSEG FLTSEG,
  OPRSEGULDSHP ULDSHP,
  OPRSEGULD SEGULD,
  OPRULDTHRRTG THRRTG,
  OPRSHPMST SHPMST,
    FLTDTL
WHERE EXPFLT.CMPCOD  = FLTSEG.CMPCOD
AND EXPFLT.FLTCARIDR = FLTSEG.FLTCARIDR
AND EXPFLT.FLTNUM    = FLTSEG.FLTNUM
AND EXPFLT.FLTSEQNUM = FLTSEG.FLTSEQNUM
AND ULDSHP.CMPCOD  = FLTSEG.CMPCOD
AND ULDSHP.FLTCARIDR = FLTSEG.FLTCARIDR
AND ULDSHP.FLTNUM    = FLTSEG.FLTNUM
AND ULDSHP.FLTSEQNUM = FLTSEG.FLTSEQNUM
AND ULDSHP.SEGSERNUM = FLTSEG.SEGSERNUM
AND SEGULD.CMPCOD  = ULDSHP.CMPCOD
AND SEGULD.FLTCARIDR = ULDSHP.FLTCARIDR
AND SEGULD.FLTNUM    = ULDSHP.FLTNUM
AND SEGULD.FLTSEQNUM = ULDSHP.FLTSEQNUM
AND SEGULD.SEGSERNUM = ULDSHP.SEGSERNUM
AND SEGULD.ULDNUM = ULDSHP.ULDNUM
AND THRRTG.CMPCOD(+)  = ULDSHP.CMPCOD
AND THRRTG.FLTCARIDR(+) = ULDSHP.FLTCARIDR
AND THRRTG.FLTNUM(+) = ULDSHP.FLTNUM
AND THRRTG.FLTSEQNUM(+) = ULDSHP.FLTSEQNUM
AND THRRTG.SEGSERNUM(+) = ULDSHP.SEGSERNUM
AND THRRTG.ULDNUM(+) = ULDSHP.ULDNUM
AND SHPMST.CMPCOD = ULDSHP.CMPCOD
AND SHPMST.DOCOWRIDR = ULDSHP.DOCOWRIDR
AND SHPMST.MSTDOCNUM = ULDSHP.MSTDOCNUM
AND SHPMST.SEQNUM = ULDSHP.SEQNUM
AND SHPMST.DUPNUM = ULDSHP.DUPNUM
AND SHPMST.CMPCOD = FLTDTL.CMPCOD(+)
AND SHPMST.UBRNUM = FLTDTL.UBRNUM(+)
AND (FLTSEG.POL = ? OR FLTSEG.POU = ?)
AND EXPFLT.CMPCOD = ?
AND EXPFLT.FLTNUM = ?
AND EXPFLT.FLTCARIDR = ?
AND EXPFLT.FLTSEQNUM = ?
AND EXPFLT.ARPCOD = ?
ORDER BY FLTSEG.POU,SHPMST.DOCOWRIDR, SHPMST.MSTDOCNUM, SHPMST.DUPNUM, SHPMST.SEQNUM, SEGULD.ULDNUM,
THRRTG.THRDSTCOD, THRRTG.THRCARCOD, THRRTG.THRFLTNUM, THRRTG.THRFLTDAT,
FLTDTL.FLTDST, FLTDTL.FLTCARCOD, FLTDTL.FLTNUM, FLTDTL.FLTDAT


		]]>
	</QRY:Source>
</QRY:Definition>				



<QRY:Definition>
	<QRY:Id>422</QRY:Id>
	<QRY:Source Name="operations.manifest.validateuldsformanifest" Type="NATIVE">
		<![CDATA[
	SELECT ULD.FLTCARIDR,
	  ULD.FLTNUM,
	  ULD.FLTSEQNUM,
	  ULD.ULDNUM,
	  FLTLEG.LEGORG AS POL,
	  FLTLEG.LEGDST AS POU,
	  (
	  CASE ARLMST.APHCODUSE
	    WHEN 2
	    THEN ARLMST.TWOAPHCOD
	    ELSE ARLMST.THRAPHCOD
	  END) FLTCARCOD,
	  FLTLEG.STD FLTDAT
	FROM OPRULDDTL ULD
	LEFT OUTER JOIN SHRARLMST ARLMST
	ON ULD.CMPCOD     = ARLMST.CMPCOD
	AND ULD.FLTCARIDR = ARLMST.ARLIDR
	LEFT OUTER JOIN FLTOPRLEG FLTLEG
	ON ULD.FLTNUM      = FLTLEG.FLTNUM
	AND ULD.FLTCARIDR  = FLTLEG.FLTCARIDR
	AND ULD.FLTSEQNUM  = FLTLEG.FLTSEQNUM
	AND ULD.LEGSERNUM  = FLTLEG.LEGSERNUM
	AND ULD.CMPCOD     = FLTLEG.CMPCOD
	WHERE (ULD.CLSFLG IS NULL
	OR ULD.CLSFLG      = 'N')
	AND ULD.CMPCOD     = ?
	AND ULD.ULDNUM in (
		]]>
	</QRY:Source>
</QRY:Definition>

<QRY:Definition>
	<QRY:Id>423</QRY:Id>
	<QRY:Source Name="operations.manifest.uldcurrentflightstatus" Type="NATIVE">
		<![CDATA[
			SELECT SEG.CMPCOD,
			  EXPFLT.FLTCARCOD,
			  EXPFLT.FLTCARIDR,
			  EXPFLT.LEGSERNUM,
			  EXPFLT.ARPCOD,
			  SEG.FLTNUM,
			  SEG.FLTSEQNUM,
			  SEG.ULDNUM,
			  SEG.ULDSTA,
			  EXPFLT.FLTOPRSTA,
			  EXPFLT.FLTDAT,
			  DTL.CLSFLG
			FROM OPRSEGULD SEG,
			  OPRARPEXPFLT EXPFLT,
			  OPRULDDTL DTL
			WHERE SEG.FLTNUM         = EXPFLT.FLTNUM
			AND SEG.FLTCARIDR        = EXPFLT.FLTCARIDR
			AND SEG.FLTSEQNUM        = EXPFLT.FLTSEQNUM
			AND SEG.CMPCOD           = EXPFLT.CMPCOD
			AND SEG.FLTNUM           = DTL.FLTNUM
			AND SEG.FLTCARIDR        = DTL.FLTCARIDR
			AND SEG.FLTSEQNUM        = DTL.FLTSEQNUM
			AND SEG.CMPCOD           = DTL.CMPCOD
			AND (SEG.BDPFLG          = 'Y'
			OR SEG.MFTFLG            = 'Y' )
			AND NVL(SEG.RCVFLG,'N') != 'Y'
			AND SEG.ULDNUM          != 'BULK'
			AND NVL(SEG.ULDSTA,'O')  = 'O'
			AND DTL.CMPCOD           = ?
			AND DTL.ULDNUM           = ?
			]]>
	</QRY:Source>
</QRY:Definition>

<QRY:Definition>
	<QRY:Id>424</QRY:Id>
	<QRY:Source Name="operations.shipment.lite.findimportshipmentlistingdetails" Type="NATIVE">
		<![CDATA[
			
				SELECT MST.CMPCOD,
				  MST.MSTDOCNUM ,
				  MST.DOCOWRIDR,
				  MST.DUPNUM,
				  MST.SEQNUM,
				  MST.SHPPFX,
				  MST.SCCCOD,
				  MST.CNSCOD,
				  MST.CNSNAM,
				  MST.DSTCOD,
				  MST.SRCIND,
				  DLVNOT.DLVNOTNUM,
				  DLVNOT.DLVNOTPCS,
				  DLVNOT.DLVNOTWGT,
				  MST.STDPCS,
				  MST.STDWGT,
				  SEGSHP.MFTPCS SEGMFTPCS,
				  SEGSHP.MFTWGT SEGMFTWGT,
				  SHP.TOTDLVPCS,
				  SHP.TOTDLVWGT,
				  SHP.AVLPCS,
				  SHP.AVLWGT,
				  SHP.RCVPCS,
				  SHP.RCVWGT,
				  SHP.MFTPCS,
				  SHP.MFTWGT,
				  ARL.TWOAPHCOD,
				  LEG.FLTCARIDR,
				  LEG.FLTNUM,
				  LEG.FLTSEQNUM,
				  LEG.LEGSERNUM,				  
				  LEG.LEGDST,
				  LEG.STA,
				  LEG.ATA,
				  LEG.ETA,
				  SEG.POL,
				  SEG.POU,
				  SEGULD.ULDNUM,
				  SEGULD.MFTPCS ULDMFTPCS,
				  SEGULD.MFTWGT ULDMFTWGT,
				  SEGULD.RCVWGT ULDRCVWGT,
				  SEGULD.RCVPCS ULDRCVPCS,				  
				  SHP.LSTUPDTIM ARPLSTUPDTIM,
				  SEGSHP.LSTUPDTIM SEGLSTUPDTIM,
				  MST.LSTUPDTIM SHPLSTUPDTIM
				FROM FLTOPRLEG LEG
				JOIN OPRFLTSEG SEG
				ON LEG.FLTCARIDR  =SEG.FLTCARIDR
				AND LEG.FLTNUM    =SEG.FLTNUM
				AND LEG.FLTSEQNUM =SEG.FLTSEQNUM
				AND LEG.CMPCOD    =SEG.CMPCOD
				AND LEG.LEGDST    =SEG.POU
				JOIN SHRARLACTMST ARL
				ON LEG.FLTCARIDR  =ARL.arlidr
				AND LEG.CMPCOD    =ARL.CMPCOD
				JOIN OPRSEGSHP SEGSHP
				ON SEG.FLTCARIDR  =SEGSHP.FLTCARIDR
				AND SEG.FLTNUM =SEGSHP.FLTNUM
				AND SEG.FLTSEQNUM =SEGSHP.FLTSEQNUM
				AND SEG.SEGSERNUM =SEGSHP.SEGSERNUM
				AND SEG.CMPCOD    =SEGSHP.CMPCOD
				JOIN OPRSEGULDSHP SEGULD
				ON SEG.FLTCARIDR  =SEGULD.FLTCARIDR
				AND SEG.FLTNUM =SEGULD.FLTNUM
				AND SEG.FLTSEQNUM   =SEGULD.FLTSEQNUM
				AND SEG.SEGSERNUM =SEGSHP.SEGSERNUM
				AND SEG.CMPCOD    =SEGULD.CMPCOD				
				AND SEGSHP.MSTDOCNUM  =SEGULD.MSTDOCNUM
				AND SEGSHP.DOCOWRIDR =SEGULD.DOCOWRIDR
				AND SEGSHP.DUPNUM    =SEGULD.DUPNUM
				AND SEGSHP.SEQNUM    =SEGULD.SEQNUM
				JOIN OPRSHPMST MST
				ON SEGSHP.MSTDOCNUM  =MST.MSTDOCNUM
				AND SEGSHP.DOCOWRIDR =MST.DOCOWRIDR
				AND SEGSHP.DUPNUM    =MST.DUPNUM
				AND SEGSHP.SEQNUM    =MST.SEQNUM
				AND SEGSHP.CMPCOD    =MST.CMPCOD
				LEFT OUTER JOIN OPRARPSHP SHP
				ON MST.MSTDOCNUM  =SHP.MSTDOCNUM
				AND MST.DOCOWRIDR =SHP.DOCOWRIDR
				AND MST.DUPNUM    =SHP.DUPNUM
				AND MST.SEQNUM    =SHP.SEQNUM
				AND MST.CMPCOD    =SHP.CMPCOD
				AND SHP.ARPCOD    = LEG.LEGDST
				LEFT OUTER JOIN OPRSHPDLVNOT DLVNOT
				ON MST.MSTDOCNUM  =DLVNOT.MSTDOCNUM
				AND MST.DOCOWRIDR =DLVNOT.DOCOWRIDR
				AND MST.DUPNUM    =DLVNOT.DUPNUM
				AND MST.CMPCOD    =DLVNOT.CMPCOD
				AND MST.SEQNUM    =DLVNOT.SEQNUM
				AND SHP.ARPCOD    =DLVNOT.ARPCOD
				AND DLVNOT.DLVPCS =0
			]]>
	</QRY:Source>
</QRY:Definition>
<QRY:Definition>
	<QRY:Id>430</QRY:Id>
	<QRY:Source Name="operations.flthandling.findtruckflightsforshipments" Type="NATIVE">
		<![CDATA[
			SELECT DISTINCT ARP.CMPCOD,
  FLTSEG.FLTCARIDR,
  FLTSEG.FLTNUM,
  FLTSEG.FLTSEQNUM
FROM OPRARPSHP ARP
INNER JOIN OPRSEGSHP SEGSHP
ON ARP.CMPCOD     = SEGSHP.CMPCOD
AND ARP.DOCOWRIDR = SEGSHP.DOCOWRIDR
AND ARP.MSTDOCNUM = SEGSHP.MSTDOCNUM
AND ARP.SEQNUM    = SEGSHP.SEQNUM
AND ARP.DUPNUM    = SEGSHP.DUPNUM
INNER JOIN OPRFLTSEG FLTSEG
ON SEGSHP.CMPCOD     = FLTSEG.CMPCOD
AND SEGSHP.FLTCARIDR = FLTSEG.FLTCARIDR
AND SEGSHP.FLTNUM    = FLTSEG.FLTNUM
AND SEGSHP.FLTSEQNUM = FLTSEG.FLTSEQNUM
AND SEGSHP.SEGSERNUM = FLTSEG.SEGSERNUM
AND FLTSEG.POU       = ARP.ARPCOD
INNER JOIN FLTOPRMST FLTMST
ON FLTSEG.CMPCOD       = FLTMST.CMPCOD
AND FLTSEG.FLTCARIDR   = FLTMST.FLTCARIDR
AND FLTSEG.FLTNUM      = FLTMST.FLTNUM
AND FLTSEG.FLTSEQNUM   = FLTMST.FLTSEQNUM
WHERE ARP.CMPCOD = ?
AND FLTMST.FLTSTA NOT IN ('CAN') 
AND ARP.DOCOWRIDR=?
AND ARP.MSTDOCNUM =?
AND ARP.CMPCOD = ?
AND ARP.SEQNUM = ?
AND ARP.DUPNUM = ?
AND FLTMST.FLTTYP = 'T'
AND SEGSHP.MFTPCS > 0 
AND FLTSEG.POU = ?

			]]>
	</QRY:Source>
</QRY:Definition>
<QRY:Definition>
	<QRY:Id>425</QRY:Id>
	<QRY:Source Name="operation.flithandling.findpreviousflightdetailsforuldmawbreport" Type="NATIVE">
		<![CDATA[
			SELECT SEGSHP.CMPCOD, 
			   SEGSHP.MSTDOCNUM, 
			   SEGSHP.DUPNUM, 
			   SEGSHP.SEQNUM, 
			   SEGSHP.DOCOWRIDR, 
			   SEGSHP.FLTCARIDR, 
			   ARLMST.TWOAPHCOD, 
			   ARLMST.THRAPHCOD, 
			   ARLMST.APHCODUSE, 
			   NULL INBCARCOD,
			   SEGSHP.FLTNUM, 
			   TRUNC(FLTLEG.STA) FLTDAT 
			 FROM OPRSEGSHP SEGSHP, 
			   FLTOPRSEG FLTSEG, 
			   FLTOPRLEG FLTLEG, 
			   SHRARLMST ARLMST 
			 WHERE SEGSHP.CMPCOD = FLTSEG.CMPCOD 
			 AND SEGSHP.FLTCARIDR = FLTSEG.FLTCARIDR 
			 AND SEGSHP.FLTNUM = FLTSEG.FLTNUM 
			 AND SEGSHP.FLTSEQNUM = FLTSEG.FLTSEQNUM 
			 AND SEGSHP.SEGSERNUM = FLTSEG.SEGSERNUM 
			 AND FLTSEG.CMPCOD = FLTLEG.CMPCOD 
			 AND FLTSEG.FLTCARIDR = FLTLEG.FLTCARIDR 
			 AND FLTSEG.FLTNUM = FLTLEG.FLTNUM 
			 AND FLTSEG.FLTSEQNUM = FLTLEG.FLTSEQNUM 
			 AND FLTSEG.SEGDST = FLTLEG.LEGDST 
			 AND ARLMST.ARLIDR = FLTLEG.FLTCARIDR 
			 AND INSTR (?, (SEGSHP.DOCOWRIDR
			   || SEGSHP.MSTDOCNUM 
			   ||SEGSHP.DUPNUM 
				||SEGSHP.SEQNUM ) )>0 
			 AND (SEGSHP.CMPCOD, FLTLEG.LEGORG, FLTLEG.LEGDST,FLTLEG.STA) IN 
			   (SELECT SEGSHP.CMPCOD, 
				 FLTLEG.LEGORG, 
				 FLTLEG.LEGDST, 
				 MIN(FLTLEG.STA) STA 
			   FROM OPRSEGSHP SEGSHP, 
				 FLTOPRSEG FLTSEG, 
				 FLTOPRLEG FLTLEG, 
				 SHRARLMST ARLMST 
			   WHERE SEGSHP.CMPCOD = FLTSEG.CMPCOD 
			   AND SEGSHP.FLTCARIDR = FLTSEG.FLTCARIDR 
			   AND SEGSHP.FLTNUM = FLTSEG.FLTNUM 
			   AND SEGSHP.FLTSEQNUM = FLTSEG.FLTSEQNUM 
			   AND SEGSHP.SEGSERNUM = FLTSEG.SEGSERNUM 
			   AND FLTSEG.CMPCOD = FLTLEG.CMPCOD 
			   AND FLTSEG.FLTCARIDR = FLTLEG.FLTCARIDR 
			   AND FLTSEG.FLTNUM = FLTLEG.FLTNUM 
			   AND FLTSEG.FLTSEQNUM = FLTLEG.FLTSEQNUM 
			   AND FLTSEG.SEGDST = FLTLEG.LEGDST 
			   AND ARLMST.ARLIDR = FLTLEG.FLTCARIDR 
			   AND INSTR (?, (SEGSHP.DOCOWRIDR
				|| SEGSHP.MSTDOCNUM
				 ||SEGSHP.DUPNUM 
				||SEGSHP.SEQNUM ) )>0 
			   AND FLTLEG.LEGDST=? 
			   GROUP BY SEGSHP.CMPCOD, FLTLEG.LEGORG, FLTLEG.LEGDST 
			   )union
         SELECT SEGSHP.CMPCOD, 
			   SEGSHP.MSTDOCNUM, 
			   SEGSHP.DUPNUM, 
			   SEGSHP.SEQNUM, 
			   SEGSHP.DOCOWRIDR, 
			   SEGSHP.FLTCARIDR, 
			   NULL, 
			   NULL, 
			   0, 
         ARPSHP.INBCARCOD,
			   ARPSHP.INBFLTNUM FLTNUM, 
			   ARPSHP.INBFLTDAT FLTDAT 
			 FROM OPRSEGSHP SEGSHP, 
			   FLTOPRSEG FLTSEG, 
			   FLTOPRLEG FLTLEG, 
			   SHRARLMST ARLMST,
			   OPRARPSHP ARPSHP
			 WHERE SEGSHP.CMPCOD = FLTSEG.CMPCOD 
			 AND SEGSHP.FLTCARIDR = FLTSEG.FLTCARIDR 
			 AND SEGSHP.FLTNUM = FLTSEG.FLTNUM 
			 AND SEGSHP.FLTSEQNUM = FLTSEG.FLTSEQNUM 
			 AND SEGSHP.SEGSERNUM = FLTSEG.SEGSERNUM 
			 AND FLTSEG.CMPCOD = FLTLEG.CMPCOD 
			 AND FLTSEG.FLTCARIDR = FLTLEG.FLTCARIDR 
			 AND FLTSEG.FLTNUM = FLTLEG.FLTNUM 
			 AND FLTSEG.FLTSEQNUM = FLTLEG.FLTSEQNUM 
			 AND FLTSEG.SEGDST = FLTLEG.LEGDST 
			 AND ARLMST.ARLIDR = FLTLEG.FLTCARIDR
			 AND SEGSHP.CMPCOD  = ARPSHP.CMPCOD(+)
			 AND SEGSHP.DOCOWRIDR = ARPSHP.DOCOWRIDR(+)
			 AND SEGSHP.MSTDOCNUM = ARPSHP.MSTDOCNUM(+)
			 AND SEGSHP.DUPNUM = ARPSHP.DUPNUM(+)
			 AND SEGSHP.SEQNUM = ARPSHP.SEQNUM(+)
			 AND ( ARPSHP.ARPCOD IS NULL 
			 OR FLTSEG.SEGORG  = ARPSHP.ARPCOD)
			 AND INSTR (?, (SEGSHP.DOCOWRIDR
			|| SEGSHP.MSTDOCNUM
			||SEGSHP.DUPNUM
			||SEGSHP.SEQNUM ) )>0
]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
	<QRY:Id>423</QRY:Id>
	<QRY:Source Name="operations.flthandling.isNotocOrDWSCaptured" Type="NATIVE">
		<![CDATA[
			SELECT MST.CMPCOD,
  MST.ARPCOD,
  MST.FLTCARIDR,
  MST.FLTNUM,
  MST.FLTSEQNUM,
  MST.LEGSERNUM
FROM OPRDWSMST MST
WHERE MST.LEGSERNUM =?
AND MST.CMPCOD      =?
AND MST.ARPCOD      =?
AND MST.FLTCARIDR   =?
AND MST.FLTSEQNUM   =?
AND MST.FLTNUM      =?
UNION
SELECT NTC.CMPCOD,
  NTC.POL,
  NTC.FLTCARIDR,
  NTC.FLTNUM,
  NTC.FLTSEQNUM,
  NTC.LEGSERNUM
FROM OPRNTCFLT NTC
WHERE FLTNUM  = ?
AND FLTCARIDR = ?
AND FLTSEQNUM = ?
AND CMPCOD    = ? 
]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>426</QRY:Id>
	<QRY:Source Name="operations.flthandling.fetchapplicableexportawbsinflightforpayment" Type="NATIVE">
		<![CDATA[
				SELECT MST.CMPCOD, 
				MST.FLTCARIDR, 
				MST.FLTNUM, 
				MST.FLTSEQNUM, 
				MST.FLTDAT, 
				LEG.LEGORG, 
				SEGSHP.DOCOWRIDR, 
				SEGSHP.MSTDOCNUM, 
				SEGSHP.DUPNUM, 
				SEGSHP.SEQNUM ,
				SEGSHP.SHPPFX,
				ARLPAR.PARVAL,
			    STNPAR.PARVAL CURCOD,
				SHRARL.TWOAPHCOD, 
				SHRARL.THRAPHCOD,
				SHRARL.APHCODUSE
				FROM FLTOPRMST MST 
				INNER JOIN FLTOPRLEG LEG 
				ON MST.CMPCOD = LEG.CMPCOD 
				AND MST.FLTCARIDR = LEG.FLTCARIDR 
				AND MST.FLTNUM = LEG.FLTNUM 
				AND MST.FLTSEQNUM = LEG.FLTSEQNUM 
				INNER JOIN OPRARPEXPFLT EXPFLT 
				ON LEG.CMPCOD = EXPFLT.CMPCOD 
				AND LEG.FLTCARIDR = EXPFLT.FLTCARIDR 
				AND LEG.FLTNUM = EXPFLT.FLTNUM 
				AND LEG.FLTSEQNUM = EXPFLT.FLTSEQNUM 
				AND LEG.LEGORG = EXPFLT.ARPCOD 
				INNER JOIN OPRFLTSEG SEG 
				ON EXPFLT.CMPCOD = SEG.CMPCOD 
				AND EXPFLT.FLTCARIDR = SEG.FLTCARIDR 
				AND EXPFLT.FLTNUM = SEG.FLTNUM 
				AND EXPFLT.FLTSEQNUM = SEG.FLTSEQNUM 
				AND EXPFLT.ARPCOD = SEG.POL 
				INNER JOIN OPRSEGSHP SEGSHP 
				ON SEG.CMPCOD = SEGSHP.CMPCOD 
				AND SEG.FLTCARIDR = SEGSHP.FLTCARIDR 
				AND SEG.FLTNUM = SEGSHP.FLTNUM 
				AND SEG.FLTSEQNUM = SEGSHP.FLTSEQNUM 
				AND SEG.SEGSERNUM = SEGSHP.SEGSERNUM 
				AND SEGSHP.BDPPCS > 0 
				INNER JOIN OPRARPSHP ARPSHP 
				ON SEGSHP.CMPCOD = ARPSHP.CMPCOD 
				AND SEGSHP.DOCOWRIDR = ARPSHP.DOCOWRIDR 
				AND SEGSHP.MSTDOCNUM = ARPSHP.MSTDOCNUM 
				AND SEGSHP.DUPNUM = ARPSHP.DUPNUM 
				AND SEGSHP.SEQNUM = ARPSHP.SEQNUM 
				AND EXPFLT.ARPCOD = ARPSHP.ARPCOD 
				AND ARPSHP.ACPPCS > 0 
				INNER JOIN SHRARLPAR ARLPAR 
				ON MST.CMPCOD = ARLPAR.CMPCOD 
				AND MST.FLTCARIDR = ARLPAR.ARLIDR 
				AND ARLPAR.PARCOD = 'shared.airline.airlinecreditcustomer' 
				INNER JOIN SHRSTNPAR STNPAR
				ON LEG.CMPCOD        = STNPAR.CMPCOD
				AND LEG.LEGORG       = STNPAR.STNCOD
				AND STNPAR.PARCOD='shared.station.basecurrency'
				INNER JOIN SHRARLMST SHRARL
			    ON MST.CMPCOD = SHRARL.CMPCOD 
			    AND MST.FLTCARIDR = SHRARL.ARLIDR	  
				WHERE EXPFLT.FINFLG IN ('F','R') 
				AND MST.FLTSTA <> 'CAN' 
				AND NOT EXISTS  ( SELECT 1
				  FROM CSHPAYADV PAYADV					 
				  INNER JOIN CSHPAYADVSRV ADVSRV  
				  ON PAYADV.CMPCOD     = ADVSRV.CMPCOD
				  AND PAYADV.STNCOD    = ADVSRV.STNCOD
				  AND PAYADV.PAYADVNUM = ADVSRV.PAYADVNUM  
				  AND (PAYADV.CNLPAYADV is   NULL and PAYADV.payadvsts='F')
				  WHERE
				  PAYADV.CMPCOD     = SEG.CMPCOD
				  AND PAYADV.FLTCARIDR = SEG.FLTCARIDR
				  AND PAYADV.FLTNUM    = SEG.FLTNUM
				  AND PAYADV.FLTSEQNUM = SEG.FLTSEQNUM
				  AND PAYADV.STNCOD= SEG.POL 
				  AND PAYADV.CMPCOD     = ARPSHP.CMPCOD
				  AND PAYADV.DOCOWRIDR = ARPSHP.DOCOWRIDR
				  AND PAYADV.MSTDOCNUM = ARPSHP.MSTDOCNUM
				  AND PAYADV.DUPNUM    = ARPSHP.DUPNUM
				  AND PAYADV.SEQNUM    = ARPSHP.SEQNUM  
				  AND ADVSRV.SRVCOD=(SELECT  PARVAL from SHRSYSPAR  where 
          PARCOD='cashiering.defaults.payment.exportawbinflighthandlingservice'
          AND CMPCOD= MST.CMPCOD))
				AND LEG.ATDUTC>= ? 
				AND LEG.ATDUTC<= ?
			]]>
	</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>427</QRY:Id>
	<QRY:Source Name="operations.flthandling.findshipmentdetailsInflightforpayment" Type="NATIVE">
		<![CDATA[
		
		        SELECT K.CMPCOD, 
				K.FLTCARIDR, 
				K.FLTNUM, 
				K.FLTSEQNUM, 
				K.MSTDOCNUM, 
				K.DOCOWRIDR, 
				K.DUPNUM, 
				K.SEQNUM, 
				K.POL,
				K.MFTPCS, 
				K.MFTWGT, 
				K.TOTLSEMFTWGT,
				ARLPAR.PARVAL,				
				NVL( 
				(SELECT MIN(TXNDAT) DAT 
				FROM OPRSHPHIS HIS 
				WHERE HIS.CMPCOD = K.CMPCOD 
				AND HIS.MSTDOCNUM = K.MSTDOCNUM 
				AND HIS.DOCOWRIDR = K.DOCOWRIDR 
				AND HIS.DUPNUM = K.DUPNUM 
				AND HIS.ARPCOD = K.POL 
				AND (HIS.TXNCOD ='RCS' 
				OR HIS.TXNCOD = 'FOH') 
				),ARPSHP.ACPDAT) FLTACPDAT, 

				(SELECT MIN(TXNDAT) DAT 
				FROM OPRSHPHIS HIS 
				WHERE HIS.CMPCOD = K.CMPCOD 
				AND HIS.MSTDOCNUM = K.MSTDOCNUM 
				AND HIS.DOCOWRIDR = K.DOCOWRIDR 
				AND HIS.DUPNUM = K.DUPNUM 
				AND HIS.ARPCOD = K.POL 
				AND (HIS.TXNCOD ='RCF') 
				) FLTBRKDWNDAT, 

				OPRLEG.ATD 
				FROM 
				(SELECT SEGSHP.CMPCOD, 
				SEGSHP.FLTCARIDR, 
				SEGSHP.FLTNUM, 
				SEGSHP.FLTSEQNUM, 
				SEGSHP.MSTDOCNUM, 
				SEGSHP.DOCOWRIDR, 
				SEGSHP.DUPNUM, 
				SEGSHP.SEQNUM, 
				FLTSEG.POL, 
				SEGSHP.MFTPCS, 
				SEGSHP.MFTWGT, 
				SUM(ULDSHP.MFTWGT) TOTLSEMFTWGT 

				FROM OPRSEGSHP SEGSHP 
				INNER JOIN OPRFLTSEG FLTSEG 
				ON SEGSHP.CMPCOD = FLTSEG.CMPCOD 
				AND SEGSHP.FLTCARIDR = FLTSEG.FLTCARIDR 
				AND SEGSHP.FLTNUM = FLTSEG.FLTNUM 
				AND SEGSHP.FLTSEQNUM = FLTSEG.FLTSEQNUM 
				AND SEGSHP.SEGSERNUM = FLTSEG.SEGSERNUM 
                AND SEGSHP.BDPPCS>0
				LEFT OUTER JOIN OPRSEGULDSHP ULDSHP 
				ON SEGSHP.CMPCOD = ULDSHP.CMPCOD 
				AND SEGSHP.FLTCARIDR = ULDSHP.FLTCARIDR 
				AND SEGSHP.FLTNUM = ULDSHP.FLTNUM 
				AND SEGSHP.FLTSEQNUM = ULDSHP.FLTSEQNUM 
				AND SEGSHP.SEGSERNUM = ULDSHP.SEGSERNUM 
				AND SEGSHP.DOCOWRIDR = ULDSHP.DOCOWRIDR 
				AND SEGSHP.MSTDOCNUM = ULDSHP.MSTDOCNUM 
				AND SEGSHP.DUPNUM = ULDSHP.DUPNUM 
				AND SEGSHP.SEQNUM = ULDSHP.SEQNUM 
				AND NOT EXISTS 
				(SELECT 1 
				FROM OPRSHPBDNDTL SHPBDN 
				INNER JOIN OPRULDBDNDTL ULDBDN 
				ON ULDBDN.CMPCOD = SHPBDN.CMPCOD 
				AND ULDBDN.FLTCARIDR = SHPBDN.FLTCARIDR 
				AND ULDBDN.FLTNUM = SHPBDN.FLTNUM 
				AND ULDBDN.FLTSEQNUM = SHPBDN.FLTSEQNUM 
				AND ULDBDN.ULDNUM = SHPBDN.ULDNUM 
				AND ULDBDN.ARPCOD = SHPBDN.ARPCOD 
				WHERE SHPBDN.CMPCOD = ULDSHP.CMPCOD 
				AND SHPBDN.DOCOWRIDR = ULDSHP.DOCOWRIDR 
				AND SHPBDN.MSTDOCNUM = ULDSHP.MSTDOCNUM 
				AND SHPBDN.DUPNUM = ULDSHP.DUPNUM 
				AND SHPBDN.SEQNUM = ULDSHP.SEQNUM 
				AND ULDBDN.ULDNUM = ULDSHP.ULDNUM 
				AND ULDBDN.ARPCOD = FLTSEG.POL 
				AND ULDBDN.THRINTFLG = 'T' 
				) 

			    WHERE SEGSHP.CMPCOD = ?
					AND SEGSHP.FLTCARIDR = ?
					AND SEGSHP.FLTNUM = ? 
					AND SEGSHP.FLTSEQNUM = ?
					AND SEGSHP.MSTDOCNUM = ?
					AND SEGSHP.DOCOWRIDR = ?
					AND SEGSHP.DUPNUM = ?
					AND SEGSHP.SEQNUM = ?
					AND FLTSEG.POL = ?  
				GROUP BY SEGSHP.CMPCOD, 
				SEGSHP.FLTCARIDR, 
				SEGSHP.FLTNUM, 
				SEGSHP.FLTSEQNUM, 
				SEGSHP.MSTDOCNUM, 
				SEGSHP.DOCOWRIDR, 
				SEGSHP.DUPNUM, 
				SEGSHP.SEQNUM, 
				FLTSEG.POL, 
				SEGSHP.MFTPCS, 
				SEGSHP.MFTWGT 
				) K 

				INNER JOIN FLTOPRLEG OPRLEG 
				ON K.CMPCOD = OPRLEG.CMPCOD 
				AND K.FLTCARIDR = OPRLEG.FLTCARIDR 
				AND K.FLTNUM = OPRLEG.FLTNUM 
				AND K.FLTSEQNUM = OPRLEG.FLTSEQNUM 
				AND K.POL = OPRLEG.LEGORG 

				INNER JOIN OPRARPSHP ARPSHP 
				ON K.CMPCOD = ARPSHP.CMPCOD 
				AND K.MSTDOCNUM = ARPSHP.MSTDOCNUM 
				AND K.DOCOWRIDR = ARPSHP.DOCOWRIDR 
				AND K.DUPNUM = ARPSHP.DUPNUM 
				AND K.SEQNUM = ARPSHP.SEQNUM 
				AND K.POL = ARPSHP.ARPCOD
				
				INNER JOIN SHRARLPAR ARLPAR
				ON K.CMPCOD     = ARLPAR.CMPCOD
				AND K.FLTCARIDR = ARLPAR.ARLIDR
				AND ARLPAR.PARCOD = 'shared.airline.airlinecreditcustomer'


			]]>
	</QRY:Source> 
</QRY:Definition>
<QRY:Definition>
<QRY:Id>428</QRY:Id>
	<QRY:Source Name="operations.flthandling.fetchapplicabletransitawbsinflightforpayment" Type="NATIVE">
		<![CDATA[
			SELECT MST.CMPCOD, 
			MST.FLTCARIDR, 
			MST.FLTNUM, 
			MST.FLTSEQNUM,
			MST.FLTDAT,
			LEG.LEGORG, 
			SEGSHP.DOCOWRIDR, 
			SEGSHP.MSTDOCNUM, 
			SEGSHP.DUPNUM, 
			SEGSHP.SEQNUM ,
			SEGSHP.SHPPFX,
			ARLPAR.PARVAL,
			STNPAR.PARVAL CURCOD,
            SHRARL.TWOAPHCOD, 
			SHRARL.THRAPHCOD,
			SHRARL.APHCODUSE
			FROM FLTOPRMST MST 
			INNER JOIN FLTOPRLEG LEG 
			ON MST.CMPCOD = LEG.CMPCOD 
			AND MST.FLTCARIDR = LEG.FLTCARIDR 
			AND MST.FLTNUM = LEG.FLTNUM 
			AND MST.FLTSEQNUM = LEG.FLTSEQNUM 
			INNER JOIN OPRARPEXPFLT EXPFLT 
			ON LEG.CMPCOD = EXPFLT.CMPCOD 
			AND LEG.FLTCARIDR = EXPFLT.FLTCARIDR 
			AND LEG.FLTNUM = EXPFLT.FLTNUM 
			AND LEG.FLTSEQNUM = EXPFLT.FLTSEQNUM 
			AND LEG.LEGORG = EXPFLT.ARPCOD 
			INNER JOIN OPRFLTSEG SEG 
			ON EXPFLT.CMPCOD = SEG.CMPCOD 
			AND EXPFLT.FLTCARIDR = SEG.FLTCARIDR 
			AND EXPFLT.FLTNUM = SEG.FLTNUM 
			AND EXPFLT.FLTSEQNUM = SEG.FLTSEQNUM 
			AND EXPFLT.ARPCOD = SEG.POL 
			INNER JOIN OPRSEGSHP SEGSHP 
			ON SEG.CMPCOD = SEGSHP.CMPCOD 
			AND SEG.FLTCARIDR = SEGSHP.FLTCARIDR 
			AND SEG.FLTNUM = SEGSHP.FLTNUM 
			AND SEG.FLTSEQNUM = SEGSHP.FLTSEQNUM 
			AND SEG.SEGSERNUM = SEGSHP.SEGSERNUM 
			AND SEGSHP.BDPPCS > 0 
			INNER JOIN OPRARPSHP ARPSHP 
			ON SEGSHP.CMPCOD = ARPSHP.CMPCOD 
			AND SEGSHP.DOCOWRIDR = ARPSHP.DOCOWRIDR 
			AND SEGSHP.MSTDOCNUM = ARPSHP.MSTDOCNUM 
			AND SEGSHP.DUPNUM = ARPSHP.DUPNUM 
			AND SEGSHP.SEQNUM = ARPSHP.SEQNUM 
			AND EXPFLT.ARPCOD = ARPSHP.ARPCOD 
			AND (ARPSHP.RCVPCS > 0 OR ARPSHP.DCSPCS >0) 
			INNER JOIN SHRARLPAR ARLPAR 
			ON MST.CMPCOD = ARLPAR.CMPCOD 
			AND MST.FLTCARIDR = ARLPAR.ARLIDR 
			AND ARLPAR.PARCOD = 'shared.airline.airlinecreditcustomer' 
			INNER JOIN SHRSTNPAR STNPAR
		  ON LEG.CMPCOD        = STNPAR.CMPCOD
		  AND LEG.LEGORG       = STNPAR.STNCOD
		  AND STNPAR.PARCOD='shared.station.basecurrency'
			INNER JOIN SHRARLMST SHRARL
			ON MST.CMPCOD = SHRARL.CMPCOD 
			AND MST.FLTCARIDR = SHRARL.ARLIDR	  
			WHERE EXPFLT.FINFLG IN ('F','R') 
			AND MST.FLTSTA <> 'CAN' 
			AND EXISTS 
			(SELECT 1 
			FROM OPRSHPMST SHPMST 
			WHERE SEGSHP.CMPCOD = SHPMST.CMPCOD 
			AND SEGSHP.DOCOWRIDR = SHPMST.DOCOWRIDR 
			AND SEGSHP.MSTDOCNUM = SHPMST.MSTDOCNUM 
			AND SEGSHP.DUPNUM = SHPMST.DUPNUM 
			AND SEGSHP.SEQNUM = SHPMST.SEQNUM 
			AND EXPFLT.ARPCOD <> SHPMST.ORGCOD 
			AND EXPFLT.ARPCOD <> SHPMST.DSTCOD 
			) 
			AND NOT EXISTS  ( SELECT 1
				  FROM CSHPAYADV PAYADV					 
				  INNER JOIN CSHPAYADVSRV ADVSRV  
				  ON PAYADV.CMPCOD     = ADVSRV.CMPCOD
				  AND PAYADV.STNCOD    = ADVSRV.STNCOD
				  AND PAYADV.PAYADVNUM = ADVSRV.PAYADVNUM  
				  AND (PAYADV.CNLPAYADV is   NULL and PAYADV.payadvsts='F')
				  WHERE
				  PAYADV.CMPCOD     = SEG.CMPCOD
				  AND PAYADV.FLTCARIDR = SEG.FLTCARIDR
				  AND PAYADV.FLTNUM    = SEG.FLTNUM
				  AND PAYADV.FLTSEQNUM = SEG.FLTSEQNUM
				  AND PAYADV.STNCOD= SEG.POL 
				  AND PAYADV.CMPCOD     = ARPSHP.CMPCOD
				  AND PAYADV.DOCOWRIDR = ARPSHP.DOCOWRIDR
				  AND PAYADV.MSTDOCNUM = ARPSHP.MSTDOCNUM
				  AND PAYADV.DUPNUM    = ARPSHP.DUPNUM
				  AND PAYADV.SEQNUM    = ARPSHP.SEQNUM  
				  AND ADVSRV.SRVCOD=(SELECT  PARVAL from SHRSYSPAR  where 
          PARCOD='cashiering.defaults.payment.transitawbinflighthandlingservice'		  
          AND CMPCOD= MST.CMPCOD))
			AND LEG.ATDUTC>=? 
			AND LEG.ATDUTC<=? 				   
]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
		<QRY:Id>424</QRY:Id>
		<QRY:Source Name="operations.flthandling.finddwsdetailsforjob" Type="NATIVE">
		<![CDATA[
			SELECT DWSDTL.CMPCOD,
			  DWSDTL.FLTCARIDR,
			  ARLMST.TWOAPHCOD FLTARCOD,
			  DWSDTL.FLTNUM,
			  DWSDTL.FLTSEQNUM,
			  FLTMST.FLTDAT,
			  DWSDTL.ARPCOD,
			  DWSDTL.LEGORG,
			  DWSDTL.ULDNUM,
			  DWSDTL.WGTSRC,
			  DWSDTL.ULDWGT,
			  DWSDTL.POU,
			  DWSDTL.LEGSERNUM,
			  DWSDTL.LODCTG,
			  DWSDTL.CNTSERNUM,
			  DWSDTL.TARWGT,
			  DWSDTL.ACTWGT,
			  DWSDTL.NETWGT,
			  DWSDTL.MFTWGT,
			  DWSDTL.BLKRMK,
			  DWSDTL.BLTUSR,
			  DWSDTL.BLTDAT,
			  (SELECT ULDWGTDTL.WGTTIM
			  FROM OPRULDWGTDTL ULDWGTDTL
			  WHERE EXPFLT.CMPCOD  = ULDWGTDTL.CMPCOD
			  AND EXPFLT.ARPCOD    = ULDWGTDTL.ARPCOD
			  AND DWSDTL.ULDNUM    = ULDWGTDTL.ULDNUM
			  AND EXPFLT.FLTCARIDR = ULDWGTDTL.FLTCARIDR
			  AND EXPFLT.FLTNUM    = ULDWGTDTL.FLTNUM
			  AND EXPFLT.FLTSEQNUM = ULDWGTDTL.FLTSEQNUM
			  AND EXPFLT.LEGSERNUM = ULDWGTDTL.LEGSERNUM
			  AND ULDWGTDTL.SERNUM =
				(SELECT MAX(SERNUM)
				FROM OPRULDWGTDTL DTL
				WHERE DTL.CMPCOD     = EXPFLT.CMPCOD
				AND DTL.ARPCOD       = EXPFLT.ARPCOD
				AND DTL.ULDNUM       = DWSDTL.ULDNUM
				AND DTL.FLTCARIDR(+) = EXPFLT.FLTCARIDR
				AND DTL.FLTNUM(+)    = EXPFLT.FLTNUM
				AND DTL.FLTSEQNUM(+) = EXPFLT.FLTSEQNUM
				AND DTL.LEGSERNUM(+) = EXPFLT.LEGSERNUM
				)
			  ) WGTTIM,
			  (SELECT NVL(ULDTAGPTRFLG,'N')
				||'~'
				||NVL(ULDTAGPTRUSR,'')
				||'~'
				||NVL(ULDTAGPTRDAT,'')
				||'~'
				||NVL(TAGRMK,'')
			  FROM FLTOPRSEG FLTSEG
			  INNER JOIN OPRULDTAG ULDTAG
			  ON FLTSEG.CMPCOD     = ULDTAG.CMPCOD
			  AND FLTSEG.FLTCARIDR = ULDTAG.FLTCARIDR
			  AND FLTSEG.FLTNUM    = ULDTAG.FLTNUM
			  AND FLTSEG.FLTSEQNUM = ULDTAG.FLTSEQNUM
			  AND FLTSEG.SEGSERNUM = ULDTAG.SEGSERNUM
			  WHERE DWSDTL.CMPCOD  = FLTSEG.CMPCOD
			  AND DWSDTL.FLTCARIDR = FLTSEG.FLTCARIDR
			  AND DWSDTL.FLTNUM    = FLTSEG.FLTNUM
			  AND DWSDTL.LEGORG    = FLTSEG.SEGORG
			  AND ULDTAG.ULDNUM    = DWSDTL.ULDNUM
			  ) ULDTAGPTRDET,
			  EXPFLT.FLTOPRSTA,
			  EXPFLT.FINFLG,
			  EXPFLT.OPRREFCARCOD,EXPFLT.OPRREFFLTNUM,EXPFLT.OPRREFFLTDATUTC,DWSDTL.DCSTRAFLG,
			  DWSDTL.ESTBLKWGT,
			  DWSDTL.ESTULDWGT,
			  DWSDTL.DWSRMK,
			  DWSDTL.PRTDAT,
			  DWSDTL.DCSSTA,
			  DWSDTL.DCSREJRSN,
			  DWSDTL.LSTUPDTIM,
			  DWSDTL.LSTUPDUSR,
			  DWSDTL.ULDBKGIDR,
			  FLTSEG.SEGSERNUM,
			  DWSDTL.GRSWGT,
			  DWSDTL.ULDCTR,
			  DWSDTL.BARROWFLG,
			  DWSDTL.ULDOCP,
			  DWSDTL.BSEFLG,
			  DWSDTL.BSEPLT,
			  DWSDTL.STD,
			  NVL(ARPPAR.PARVAL,'N') TAGPRTAVLSTN
			FROM FLTOPRMST FLTMST
			INNER JOIN
			  (SELECT DWS.*
			  FROM
				(SELECT DWSMST.CMPCOD,
				  DWSMST.ARPCOD,
				  DWSMST.FLTCARIDR,
      NULL UBRNUM,
				  DWSMST.FLTNUM,
				  DWSMST.FLTSEQNUM,
				  CNTIDR ULDNUM,
				  COALESCE(DWSBLK.ACTWGT,DWSBLK.GRSWGT) ULDWGT,
				  DWSBLK.POU POU,
				  DWSBLK.CNTSERNUM,
				  0 TARWGT,
				  DWSBLK.ACTWGT ACTWGT,
				  DWSBLK.NETWGT NETWGT,
				  0 MFTWGT,
				  DWSBLK.BLKRMK BLKRMK,
				  DWSBLK.BLTUSR BLTUSR,
				  DWSBLK.BLTDAT BLTDAT,
				  DWSMST.ESTBLKWGT,
				  DWSMST.ESTULDWGT,
				  DWSMST.DWSRMK,
				  DWSMST.PRTDAT,
				  DWSMST.LSTUPDTIM,
				  DWSMST.LSTUPDUSR,
				  DWSMST.DCSSTA,
				  DWSMST.DCSREJRSN,
				  NULL AS ULDBKGIDR,
				  DWSBLK.GRSWGT,
				  NULL AS ULDCTR,
				  'N' BARROWFLG,
				  NULL AS ULDOCP,
				  NULL AS BSEFLG,
				  NULL AS BSEPLT,
				  FLTLEG.LEGSERNUM,
				  FLTLEG.LEGORG,
				  FLTLEG.ACRTYP,
				  FLTLEG.STD,
				  1 SRTORD,
				  DWSBLK.CONIDR LODCTG,
				  'DWS' WGTSRC,
				   DWSBLK.DCSTRAFLG
				FROM OPRDWSMST DWSMST
				INNER JOIN OPRDWSBLK DWSBLK
				ON DWSMST.CMPCOD     = DWSBLK.CMPCOD
				AND DWSMST.ARPCOD    = DWSBLK.ARPCOD
				AND DWSMST.FLTCARIDR = DWSBLK.FLTCARIDR
				AND DWSMST.FLTNUM    = DWSBLK.FLTNUM
				AND DWSMST.FLTSEQNUM = DWSBLK.FLTSEQNUM
				AND DWSMST.LEGSERNUM = DWSBLK.LEGSERNUM
				INNER JOIN FLTOPRLEG FLTLEG
				ON DWSMST.CMPCOD     = FLTLEG.CMPCOD
				AND DWSMST.FLTCARIDR = FLTLEG.FLTCARIDR
				AND DWSMST.FLTNUM    = FLTLEG.FLTNUM
				AND DWSMST.FLTSEQNUM = FLTLEG.FLTSEQNUM
				AND DWSMST.LEGSERNUM = FLTLEG.LEGSERNUM
				AND DECODE(FLTLEG.ETD,NULL,FLTLEG.STDUTC,PKG_FRMWRK_DATE.FUN_GET_UTCDATE(FLTLEG.CMPCOD, FLTLEG.LEGORG, FLTLEG.ETD)) BETWEEN ? AND ?
				UNION
				SELECT DWSMST.CMPCOD,
				  DWSMST.ARPCOD,
				  DWSMST.FLTCARIDR,
       NULL UBRNUM,
				  DWSMST.FLTNUM,
				  DWSMST.FLTSEQNUM,
				  ULDNUM,
				  COALESCE(DWSULD.ACTWGT,DWSULD.GRSWGT) ULDWGT,
				  DWSULD.POU POU,
				  0 CNTSERNUM,
				  DWSULD.TARWGT,
				  DWSULD.ACTWGT ACTWGT,
				  DWSULD.NETWGT NETWGT,
				  DWSULD.MFTWGT,
				  DWSULD.BLKRMK BLKRMK,
				  DWSULD.BLTUSR BLTUSR,
				  DWSULD.BLTDAT BLTDAT,
				  DWSMST.ESTBLKWGT,
				  DWSMST.ESTULDWGT,
				  DWSMST.DWSRMK,
				  DWSMST.PRTDAT,
				  DWSMST.LSTUPDTIM,
				  DWSMST.LSTUPDUSR,
				  DWSMST.DCSSTA,
				  DWSMST.DCSREJRSN,
				  DWSULD.ULDBKGIDR,
				  DWSULD.GRSWGT,
				  DWSULD.ULDCTR,
				  'N' BARROWFLG,
				  DWSULD.ULDOCP,
				  DWSULD.BASPLTFLG BSEFLG,
				  DWSULD.BASPLTULD BSEPLT,
				  FLTLEG.LEGSERNUM,
				  FLTLEG.LEGORG,
				  FLTLEG.ACRTYP,
				  FLTLEG.STD,
				  2 SRTORD,
				  DWSULD.CONIDR LODCTG,
				  'DWS' WGTSRC,
				   DWSULD.DCSTRAFLG
				FROM OPRDWSMST DWSMST
				INNER JOIN OPRDWSULD DWSULD
				ON DWSMST.CMPCOD     = DWSULD.CMPCOD
				AND DWSMST.ARPCOD    = DWSULD.ARPCOD
				AND DWSMST.FLTCARIDR = DWSULD.FLTCARIDR
				AND DWSMST.FLTNUM    = DWSULD.FLTNUM
				AND DWSMST.FLTSEQNUM = DWSULD.FLTSEQNUM
				AND DWSMST.LEGSERNUM = DWSULD.LEGSERNUM
				INNER JOIN FLTOPRLEG FLTLEG
				ON DWSMST.CMPCOD     = FLTLEG.CMPCOD
				AND DWSMST.FLTCARIDR = FLTLEG.FLTCARIDR
				AND DWSMST.FLTNUM    = FLTLEG.FLTNUM
				AND DWSMST.FLTSEQNUM = FLTLEG.FLTSEQNUM
				AND DWSMST.LEGSERNUM = FLTLEG.LEGSERNUM
				AND DECODE(FLTLEG.ETD,NULL,FLTLEG.STDUTC,PKG_FRMWRK_DATE.FUN_GET_UTCDATE(FLTLEG.CMPCOD, FLTLEG.LEGORG, FLTLEG.ETD)) BETWEEN ? AND ?
				)DWS
			  WHERE INSTR(?,'DWS') > 0
			  UNION
			  SELECT SEGULD.CMPCOD,
				FLTSEG.POL ARPCOD,
				SEGULD.FLTCARIDR,
     NULL UBRNUM,
				SEGULD.FLTNUM,
				SEGULD.FLTSEQNUM,
				ULDNUM,
				CASE
				  WHEN SEGULD.ACTWGT > 0
				  THEN SEGULD.ACTWGT
				  ELSE SEGULD.GRSWGT
				END ULDWGT,
				FLTSEG.POU,
				0 CNTSERNUM,
				SEGULD.TARWGT,
				SEGULD.ACTWGT,
				SEGULD.NETWGT NETWGT,
				SEGULD.MFTWGT,
				NULL AS BLKRMK,
				SEGULD.LSTUPDUSR BLTUSR,
				SEGULD.ULDBDPTIM BLTDAT,
				0 ESTBLKWGT,
				0 ESTULDWGT,
				NULL AS DWSRMK,
				NULL AS PRTDAT,
				NULL AS LSTUPDTIM,
				NULL AS LSTUPDUSR,
				NULL AS DCSSTA,
				NULL AS DCSREJRSN,
				SEGULD.ULDBKGIDR ULDBKGIDR,
				SEGULD.GRSWGT,
				SEGULD.ULDCTR,
				COALESCE(SEGULD.BARROWFLG, 'N') BARROWFLG,
				SEGULD.ULDOCP,
				SEGULD.BSEFLG,
				SEGULD.BSEPLT,
				FLTLEG.LEGSERNUM,
				FLTLEG.LEGORG,
				FLTLEG.ACRTYP,
				FLTLEG.STD,
				3 SRTORD,
				SEGULD.CONIDR LODCTG,
				'BDP' WGTSRC,
				NULL AS DCSTRAFLG
			  FROM OPRFLTSEG FLTSEG
			  INNER JOIN OPRSEGULD SEGULD
			  ON FLTSEG.CMPCOD               = SEGULD.CMPCOD
			  AND FLTSEG.FLTCARIDR           = SEGULD.FLTCARIDR
			  AND FLTSEG.FLTNUM              = SEGULD.FLTNUM
			  AND FLTSEG.FLTSEQNUM           = SEGULD.FLTSEQNUM
			  AND FLTSEG.SEGSERNUM           = SEGULD.SEGSERNUM
			  INNER JOIN FLTOPRLEG FLTLEG
			  ON FLTSEG.CMPCOD     = FLTLEG.CMPCOD
			  AND FLTSEG.FLTCARIDR = FLTLEG.FLTCARIDR
			  AND FLTSEG.FLTNUM    = FLTLEG.FLTNUM
			  AND FLTSEG.FLTSEQNUM = FLTLEG.FLTSEQNUM
			  AND FLTSEG.POL = FLTLEG.LEGORG
			  AND DECODE(FLTLEG.ETD,NULL,FLTLEG.STDUTC,PKG_FRMWRK_DATE.FUN_GET_UTCDATE(FLTLEG.CMPCOD, FLTLEG.LEGORG, FLTLEG.ETD)) BETWEEN ? AND ?
			  WHERE INSTR(?,'BDP') > 0
			  UNION
			  SELECT BKGFLT.CMPCOD,
				BKGFLT.FLTORG ARPCOD,
				BKGFLT.FLTCARIDR,
     BKGFLT.UBRNUM UBRNUM,
				BKGFLT.FLTNUM,
				BKGFLT.FLTSEQNUM,
				'BULK' ULDNUM,
				  SUM(CFRWGT -NVL(
				  (SELECT SUM(BDPWGT)
				  FROM OPRSEGULDSHP
				  WHERE CMPCOD         = FLTLEG.CMPCOD
				  AND FLTCARIDR        = FLTLEG.FLTCARIDR
				  AND FLTNUM           = FLTLEG.FLTNUM
				  AND FLTSEQNUM        = FLTLEG.FLTSEQNUM
				  AND BKGFLT.DOCOWRIDR = DOCOWRIDR
				  AND BKGFLT.MSTDOCNUM = MSTDOCNUM
				  AND BKGFLT.SEQNUM    = SEQNUM
				  AND BKGFLT.DUPNUM    = DUPNUM
				  ),0)) ULDWGT,
				BKGFLT.FLTDST POU,
				0 CNTSERNUM,
				  0 TARWGT,
				0 ACTWGT,
				SUM(CFRWGT) NETWGT,
				0 MFTWGT,
				NULL AS BLKRMK,
				NULL AS BLTUSR,
				NULL AS BLTDAT,
				0 ESTBLKWGT,
				0 ESTULDWGT,
				NULL AS DWSRMK,
				NULL AS PRTDAT,
				NULL AS LSTUPDTIM,
				NULL AS LSTUPDUSR,
				NULL AS DCSSTA,
				NULL AS DCSREJRSN,
				NULL AS ULDBKGIDR,
				SUM(CFRWGT) GRSWGT,
				NULL AS ULDCTR,
				NULL AS BARROWFLG,
				NULL AS ULDOCP,
				NULL AS BSEFLG,
				NULL AS BSEPLT,
				FLTLEG.LEGSERNUM,
				FLTLEG.LEGORG,
				FLTLEG.ACRTYP,
				FLTLEG.STD,
				4 SRTORD,
				'C' LODCTG,
				'BKD' WGTSRC,
				NULL AS DCSTRAFLG
			  FROM CAPBKGFLTDTL BKGFLT
			  INNER JOIN FLTOPRLEG FLTLEG
			  ON BKGFLT.CMPCOD     = FLTLEG.CMPCOD
			  AND BKGFLT.FLTCARIDR = FLTLEG.FLTCARIDR
			  AND BKGFLT.FLTNUM    = FLTLEG.FLTNUM
			  AND BKGFLT.FLTSEQNUM = FLTLEG.FLTSEQNUM
			  AND BKGFLT.FLTORG = FLTLEG.LEGORG
			  AND DECODE(FLTLEG.ETD,NULL,FLTLEG.STDUTC,PKG_FRMWRK_DATE.FUN_GET_UTCDATE(FLTLEG.CMPCOD, FLTLEG.LEGORG, FLTLEG.ETD)) BETWEEN ? AND ?
			  AND BKGFLT.FLTBKGSTA    = 'C'
			  WHERE INSTR(?,'BKD') > 0
			  GROUP BY BKGFLT.CMPCOD,
				BKGFLT.FLTORG,
				BKGFLT.FLTCARIDR,
				BKGFLT.FLTNUM,
				BKGFLT.FLTSEQNUM,
				BKGFLT.FLTDST,
				  BKGFLT.DOCOWRIDR,
				  BKGFLT.MSTDOCNUM,
				  BKGFLT.SEQNUM,
				  BKGFLT.DUPNUM,
				FLTLEG.LEGSERNUM,
				FLTLEG.LEGORG,
				FLTLEG.ACRTYP,
    FLTLEG.STD,
    BKGFLT.UBRNUM
			  UNION
			  SELECT FLTLEG.CMPCOD,
				FLTLEG.LEGORG ARPCOD,
				FLTLEG.FLTCARIDR,
     NULL UBRNUM,
				FLTLEG.FLTNUM,
				FLTLEG.FLTSEQNUM,
				NULL ULDNUM,
				0 ULDWGT,
				FLTLEG.LEGDST POU,
				0 CNTSERNUM,
				0 TARWGT,
				0 ACTWGT,
				0 NETWGT,
				0 MFTWGT,
				NULL AS BLKRMK,
				NULL AS BLTUSR,
				NULL AS BLTDAT,
				0 ESTBLKWGT,
				0 ESTULDWGT,
				NULL AS DWSRMK,
				NULL AS PRTDAT,
				NULL AS LSTUPDTIM,
				NULL AS LSTUPDUSR,
				NULL AS DCSSTA,
				NULL AS DCSREJRSN,
				NULL AS ULDBKGIDR,
				0 GRSWGT,
				NULL AS ULDCTR,
				NULL AS BARROWFLG,
				NULL AS ULDOCP,
				NULL AS BSEFLG,
				NULL AS BSEPLT,
				FLTLEG.LEGSERNUM,
				FLTLEG.LEGORG,
				FLTLEG.ACRTYP,
				FLTLEG.STD,
				5 SRTORD,
				NULL AS LODCTG,
				'NIL' WGTSRC
				'FLT' WGTSRC,
				NULL AS DCSTRAFLG
			  FROM FLTOPRLEG FLTLEG
			  WHERE DECODE(FLTLEG.ETD,NULL,FLTLEG.STDUTC,PKG_FRMWRK_DATE.FUN_GET_UTCDATE(FLTLEG.CMPCOD, FLTLEG.LEGORG, FLTLEG.ETD)) BETWEEN ? AND ?
			  AND INSTR(?,'NIL') > 0
			  AND NOT EXISTS
				(SELECT 1
				FROM CAPBKGFLTDTL
				WHERE FLTLEG.CMPCOD  = CMPCOD
				AND FLTLEG.FLTCARIDR = FLTCARIDR
				AND FLTLEG.FLTNUM    = FLTNUM
				AND FLTLEG.FLTSEQNUM = FLTSEQNUM
				AND FLTLEG.LEGORG    = FLTORG
				AND FLTBKGSTA        = 'C'
				)
			  AND NOT EXISTS
				(SELECT 1
				FROM OPRFLTSEG SEG,
				  OPRSEGULD ULD
				WHERE FLTLEG.CMPCOD  = SEG.CMPCOD
				AND FLTLEG.FLTCARIDR = SEG.FLTCARIDR
				AND FLTLEG.FLTNUM    = SEG.FLTNUM
				AND FLTLEG.FLTSEQNUM = SEG.FLTSEQNUM
				AND FLTLEG.LEGORG    = SEG.POL
				AND SEG.CMPCOD       = ULD.CMPCOD
				AND SEG.FLTCARIDR    = ULD.FLTCARIDR
				AND SEG.FLTNUM       = ULD.FLTNUM
				AND SEG.FLTSEQNUM    = ULD.FLTSEQNUM
				AND SEG.SEGSERNUM    = ULD.SEGSERNUM
				)
			  ) DWSDTL ON FLTMST.CMPCOD = DWSDTL.CMPCOD
			AND FLTMST.FLTCARIDR        = DWSDTL.FLTCARIDR
			AND FLTMST.FLTNUM           = DWSDTL.FLTNUM
			AND FLTMST.FLTSEQNUM        = DWSDTL.FLTSEQNUM
			LEFT OUTER JOIN OPRARPEXPFLT EXPFLT
			ON DWSDTL.CMPCOD    =EXPFLT.CMPCOD
			AND DWSDTL.FLTCARIDR=EXPFLT.FLTCARIDR
			AND DWSDTL.FLTNUM   =EXPFLT.FLTNUM
			AND DWSDTL.FLTSEQNUM=EXPFLT.FLTSEQNUM
			AND DWSDTL.LEGSERNUM=EXPFLT.LEGSERNUM
			INNER JOIN SHRARLARPPAR ARLARP
			ON DWSDTL.CMPCOD     = ARLARP.CMPCOD
			AND DWSDTL.LEGORG    = ARLARP.ARPCOD
			AND DWSDTL.FLTCARIDR = ARLARP.ARLIDR
			AND ARLARP.PARCOD    = 'operations.flthandling.altea.datatransmissionreqd'
			AND ARLARP.PARVAL    = 'Y'
			INNER JOIN SHRSYSPAR SYSPAR
			ON DWSDTL.CMPCOD  = SYSPAR.CMPCOD
			AND SYSPAR.PARCOD = 'operations.flthandling.alteafm.restrictedaircraftypes'
			AND PKG_FRMWRK.Fun_String_Check(SYSPAR.PARVAL,DWSDTL.ACRTYP,',') = 0
			INNER JOIN SHRARLMST ARLMST
			ON FLTMST.CMPCOD     = ARLMST.CMPCOD
			AND FLTMST.FLTCARIDR = ARLMST.ARLIDR
			INNER JOIN FLTOPRSEG FLTSEG
			ON DWSDTL.CMPCOD     = FLTSEG.CMPCOD
			AND DWSDTL.FLTCARIDR = FLTSEG.FLTCARIDR
			AND DWSDTL.FLTNUM    = FLTSEG.FLTNUM
			AND DWSDTL.FLTSEQNUM = FLTSEG.FLTSEQNUM
			AND DWSDTL.ARPCOD    = FLTSEG.SEGORG
			AND DWSDTL.POU       = FLTSEG.SEGDST
			LEFT OUTER JOIN SHRUSEARPPAR ARPPAR
			ON DWSDTL.CMPCOD    = ARPPAR.CMPCOD
			AND DWSDTL.LEGORG   = ARPPAR.ARPCOD
			AND ARPPAR.PARCOD   = 'operations.flthandling.uldtagprintingavailable'
			WHERE FLTMST.FLTSTA ='ACT'
			AND DWSDTL.CMPCOD   = ?
			AND (DWSDTL.ULDNUM LIKE 'BULK%'
			OR NVL(ARPPAR.PARCOD,'N') <> 'Y'
			OR EXISTS
			  (SELECT 1
			  FROM OPRULDTAG ULDTAG
			  WHERE FLTSEG.CMPCOD  = ULDTAG.CMPCOD
			  AND FLTSEG.FLTCARIDR = ULDTAG.FLTCARIDR
			  AND FLTSEG.FLTNUM    = ULDTAG.FLTNUM
			  AND FLTSEG.FLTSEQNUM = ULDTAG.FLTSEQNUM
			  AND FLTSEG.SEGSERNUM = ULDTAG.SEGSERNUM
			  AND ULDTAG.ULDNUM    = DWSDTL.ULDNUM
			  ))
			AND NOT EXISTS
			  (SELECT 1
			  FROM OPRDWSMST
			  WHERE DWSDTL.CMPCOD =CMPCOD
			  AND DWSDTL.FLTCARIDR=FLTCARIDR
			  AND DWSDTL.FLTNUM   =FLTNUM
			  AND DWSDTL.FLTSEQNUM=FLTSEQNUM
			  AND DWSDTL.ARPCOD   =ARPCOD
			  AND NVL(INSTR(?,DCSSTA),1) > 0
			  )
	]]>
	</QRY:Source>
</QRY:Definition>
<!--Added by A-5117 for ICRD-131206 starts-->
<QRY:Definition>
	<QRY:Id>425</QRY:Id>
	<QRY:Source Name="operations.flthandling.cto.findUldLoadingDetails" Type="NATIVE">
		<![CDATA[					
		SELECT LODDTL.FLTCARIDR,
		  LODDTL.FLTNUM,
		  LODDTL.FLTSEQNUM,
		  LODDTL.SEGSERNUM,
		  LODDTL.ULDNUM,
		  LODDTL.CMPCOD,
		  LODDTL.LODHGT,
		  LODDTL.LODVOL,
		  LODDTL.ULDPRY,
		  LODDTL.POU ,
		  LODDTL.POL ,
		  LODDTL.RIGFLG ,
		  LODDTL.ADDLODDTL ,
		  LODDTL.LSTUPDTIM ,
		  LODDTL.LSTUPDUSR,
		  LODDTL.LODRMK,
			  ACCDTL.LODACCPCS,
			  ACCDTL.LODACCWGT,
			  ACCDTL.LODACCRMK,
			  ACCDTL.LODACCCOD,
		  LINKDTL.FWDLINULD,
		  LINKDTL.AFTLINULD,
		  LINKDTL.LFTLINULD,
		  LINKDTL.RGTLINULD,
		  LINKDTL.FWDLINVAL,
		  LINKDTL.AFTLINVAL,
		  LINKDTL.LFTLINVAL,
		  LINKDTL.RGTLINVAL
		FROM OPRULDLODDTL LODDTL,
		  OPRULDLODACCDTL ACCDTL,
		  OPRULDLODLINDTL LINKDTL
		WHERE LODDTL.FLTCARIDR = ACCDTL.FLTCARIDR (+)
		AND LODDTL.FLTNUM    = ACCDTL.FLTNUM(+)
		AND LODDTL.FLTSEQNUM = ACCDTL.FLTSEQNUM(+)
		AND LODDTL.SEGSERNUM = ACCDTL.SEGSERNUM(+)
		AND LODDTL.ULDNUM    = ACCDTL.ULDNUM(+)
		AND LODDTL.CMPCOD    = ACCDTL.CMPCOD(+)
		AND LODDTL.FLTCARIDR = LINKDTL.FLTCARIDR (+)
		AND LODDTL.FLTNUM    = LINKDTL.FLTNUM(+)
		AND LODDTL.FLTSEQNUM = LINKDTL.FLTSEQNUM(+)
		AND LODDTL.SEGSERNUM = LINKDTL.SEGSERNUM(+)
		AND LODDTL.ULDNUM    = LINKDTL.ULDNUM(+)
		AND LODDTL.CMPCOD    = LINKDTL.CMPCOD(+)
		AND LODDTL.CMPCOD    = ?
		AND LODDTL.FLTCARIDR = ?
		AND LODDTL.FLTNUM    = ?
		AND LODDTL.FLTSEQNUM = ?
		AND LODDTL.SEGSERNUM = ?
		AND LODDTL.ULDNUM    = ?				
			]]>
	</QRY:Source>
</QRY:Definition>

<!--Added by A-5117 for ICRD-131206 ends-->
<QRY:Definition>
	<QRY:Id>426</QRY:Id>
	<QRY:Source Name="operations.flthandling.cto.deleteULDTagDCSConfigurations" Type="NATIVE">
		<![CDATA[
			DELETE FROM OPRULDTAGDCSCFG
		]]>
	</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>427</QRY:Id>
	<QRY:Source Name="operations.flthandling.cto.findULDTagDCSConfigurationDetails" Type="NATIVE">
		<![CDATA[
			SELECT CFGTYP,CFGVAL,PCSTRAFLG,WGTTRAFLG,RMKTRAFLG,PTROUT,TAGRMKCTG,INFOUT,INFRMKCTG FROM OPRULDTAGDCSCFG WHERE CMPCOD = ?
		]]>
	</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>428</QRY:Id>
	<QRY:Source Name="operations.flthandling.cto.findULDLoadDetailsForDCS" Type="NATIVE">
		<![CDATA[
			SELECT FLT.FLTNUM FLTNUM,
  FLT.FLTCARIDR FLTCARIDR,
  FLT.FLTSEQNUM FLTSEQNUM,
  FLT.SEGSERNUM SEGSERNUM,
  FLT.POL, FLT.POU,
  SEGSHP.ULDNUM ULDNUM,
  SEGSHP.BDPPCS,
  SEGSHP.BDPWGT,	  
  SHP.SHPPFX SHPPFX,
  
SHP.MSTDOCNUM MSTDOCNUM,
  SHP.DOCOWRIDR DOCOWRIDR,
  SHP.DUPNUM DUPNUM,
  SHP.SEQNUM SEQNUM,
  SHP.CMPCOD CMPCOD,
  SHP.SCCCOD MSTSCCCOD,
  SPL.NETQTY NETQTY,
  SPL.NUMPKG NUMPKG,
  SPL.RMK RMK,
 (CASE
	WHEN SPL.MSTDOCNUM IS NOT NULL
	THEN 'NTC'   
	ELSE 'BDP'
  END)  SRCIND,
  SPL.SUPINF SUPINF,
  SPL.ULDNUM SPLULDNUM,
  SCC.SCCCOD SPLSCCCOD,
  SCC.DGRIND,
  SEGSHP.NONSPLLODFLG
FROM OPRFLTSEG FLT,
  OPRSEGULDSHP SEGSHP,
  OPRNTCSPLLOD SPL,
  OPRSHPMST SHP,
   SHRSCCMST SCC
WHERE FLT.CMPCOD     = SEGSHP.CMPCOD
AND FLT.FLTNUM       = SEGSHP.FLTNUM
AND FLT.FLTCARIDR    = SEGSHP.FLTCARIDR
AND FLT.FLTSEQNUM    = SEGSHP.FLTSEQNUM
AND FLT.SEGSERNUM    = SEGSHP.SEGSERNUM
AND SEGSHP.FLTNUM    = SPL.FLTNUM(+)
AND SEGSHP.FLTCARIDR = SPL.FLTCARIDR(+)
AND SEGSHP.FLTSEQNUM = SPL.FLTSEQNUM(+)
AND SEGSHP.SEGSERNUM = SPL.SEGSERNUM(+)
AND SEGSHP.ULDNUM    = SPL.ULDNUM(+)
AND SEGSHP.MSTDOCNUM = SPL.MSTDOCNUM(+)
AND SEGSHP.DOCOWRIDR = SPL.DOCOWRIDR(+)
AND SEGSHP.DUPNUM    = SPL.DUPNUM(+)
AND SEGSHP.SEQNUM    = SPL.SEQNUM(+)
AND SEGSHP.CMPCOD    = SPL.CMPCOD(+)
AND SEGSHP.MSTDOCNUM = SHP.MSTDOCNUM
AND SEGSHP.DOCOWRIDR = SHP.DOCOWRIDR
AND SEGSHP.DUPNUM    = SHP.DUPNUM
AND SEGSHP.SEQNUM    = SHP.SEQNUM
AND SEGSHP.CMPCOD    = SHP.CMPCOD
AND SCC.CMPCOD       = SHP.CMPCOD
AND ((SPL.MSTDOCNUM IS NOT NULL
AND SCC.NTCIND       = 'Y'
AND INSTR(SHP.SCCCOD,SCC.SCCCOD) > 0) 
OR (SPL.MSTDOCNUM IS NULL 
AND INSTR(SHP.SCCCOD,SCC.SCCCOD) > 0))
AND FLT.FLTNUM       = ?
AND FLT.FLTCARIDR    = ?
AND FLT.FLTSEQNUM    = ?
AND SEGSHP.ULDNUM    = ?
]]>
	</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>429</QRY:Id> 
		<QRY:Source Name="operations.flthandling.isshipmentsnotreadyforbuildup" Type="NATIVE">
		<![CDATA[  
		 SELECT SHPMST.MSTDOCNUM , 
				SHPMST.DOCOWRIDR, 
				SHPMST.DUPNUM, 
				SHPMST.SEQNUM,
				SHPMST.SHPPFX,
				ARPSHP.AVLPCS, 
				SHPMST.RDYCRGFLG, 
				SHPBLK.BLKSTA, 
				LVL.CHKTYP 
				FROM OPRSHPMST SHPMST 
				LEFT OUTER JOIN OPRARPSHP ARPSHP 
				ON SHPMST.CMPCOD = ARPSHP.CMPCOD 
				AND SHPMST.DOCOWRIDR = ARPSHP.DOCOWRIDR 
				AND SHPMST.MSTDOCNUM = ARPSHP.MSTDOCNUM 
				AND SHPMST.DUPNUM = ARPSHP.DUPNUM 
				AND SHPMST.SEQNUM = ARPSHP.SEQNUM 
				AND ARPSHP.ARPCOD = ?
				LEFT OUTER JOIN OPRSHPBLK SHPBLK 
				ON SHPMST.CMPCOD =SHPBLK.CMPCOD 
				AND SHPMST.DOCOWRIDR =SHPBLK.DOCOWRIDR 
				AND SHPMST.MSTDOCNUM =SHPBLK.MSTDOCNUM 
				AND SHPMST.DUPNUM =SHPBLK.DUPNUM 
				AND SHPMST.SEQNUM =SHPBLK.SEQNUM 
				AND SHPBLK.BLKSTA = 'B'  
				AND( SHPBLK.ARPCOD = ? 
				OR SHPBLK.ARPCOD IS NULL) 
				LEFT OUTER JOIN OPRTXNBLKLVL LVL 
				ON SHPBLK.BLKAUT = LVL.BLKAUT 
				AND SHPBLK.CMPCOD = LVL.CMPCOD 
				AND LVL.CHKTYP = 'E'
				AND LVL.BLKTXN = 'BDP'
				WHERE SHPMST.CMPCOD = ? 
				AND (SHPMST.MSTDOCNUM,SHPMST.DOCOWRIDR,SHPMST.SEQNUM,SHPMST.DUPNUM) IN
]]>
	</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>429</QRY:Id>
	<QRY:Source Name="operations.flthandling.findCargoTonnageSummary" Type="NATIVE">
		<![CDATA[
		SELECT A.CMPCOD,
  A.FLTCARIDR,
  A.FLTCARCOD,
  A.FLTNUM,
  A.FLTDAT,
  A.FLTSEQNUM,
  A.SEGSERNUM,
  A.AWBCOUNT,
  A.MFTPCS,
  A.MFTWGT,
  A.ARPCOD,
  A.IND
FROM (
  (SELECT CMPCOD,
    FLTCARIDR,
    FLTCARCOD,
    FLTNUM,
    FLTDAT,
    FLTSEQNUM,
    SEGSERNUM,
    COUNT(MSTDOCNUM) AWBCOUNT,
    SUM(MFTPCS) MFTPCS,
    SUM(MFTWGT) MFTWGT,
    ARPCOD,
    'E' IND
  FROM
    (SELECT SEGSHP.CMPCOD,
      SEGSHP.FLTCARIDR,
      SEGSHP.SEGSERNUM,
      CASE
        WHEN ARLMST.APHCODUSE =2
        THEN ARLMST.TWOAPHCOD
        WHEN ARLMST.APHCODUSE =3
        THEN ARLMST.THRAPHCOD
      END FLTCARCOD,
      SEGSHP.FLTNUM FLTNUM,
      SEGSHP.FLTSEQNUM,
      TRUNC(FLTLEG.STD) FLTDAT,
      SEGSHP.MSTDOCNUM ,
      SEGSHP.MFTWGT ,
      SEGSHP.MFTPCS,
      FLTSEG.POL ARPCOD
    FROM OPRSEGSHP SEGSHP,
      OPRFLTSEG FLTSEG,
      OPRARPEXPFLT FLT,
      SHRARLMST ARLMST,
      FLTOPRLEG FLTLEG
    WHERE SEGSHP.FLTCARIDR = FLTSEG.FLTCARIDR
    AND SEGSHP.FLTNUM      = FLTSEG.FLTNUM
    AND SEGSHP.FLTSEQNUM   = FLTSEG.FLTSEQNUM
    AND SEGSHP.SEGSERNUM   = FLTSEG.SEGSERNUM
    AND SEGSHP.CMPCOD      = FLTSEG.CMPCOD
    AND FLTSEG.FLTCARIDR   = FLT.FLTCARIDR
    AND FLTSEG.FLTNUM      = FLT.FLTNUM
    AND FLTSEG.FLTSEQNUM   = FLT.FLTSEQNUM
    AND FLTSEG.CMPCOD      = FLT.CMPCOD
    AND FLTSEG.POL         = FLT.ARPCOD
    AND FLTSEG.FLTCARIDR   = FLTLEG.FLTCARIDR
    AND FLTSEG.FLTNUM      = FLTLEG.FLTNUM
    AND FLTSEG.FLTSEQNUM   = FLTLEG.FLTSEQNUM
    AND FLTSEG.CMPCOD      = FLTLEG.CMPCOD
    AND FLTSEG.POL         = FLTLEG.LEGORG
    AND ARLMST.CMPCOD      = SEGSHP.CMPCOD
    AND ARLMST.ARLIDR      = SEGSHP.FLTCARIDR
    AND SEGSHP.SEQNUM      = 1
    AND SEGSHP.MFTPCS      > 0
    AND SEGSHP.CMPCOD      = ?
    AND FLT.FINFLG         = 'F'
    )
  GROUP BY CMPCOD,
    FLTCARIDR,
    FLTCARCOD,
    FLTNUM,
    FLTDAT,
    FLTSEQNUM,
    SEGSERNUM,
    ARPCOD
  )
UNION
  (SELECT CMPCOD,
    FLTCARIDR,
    FLTCARCOD,
    FLTNUM,
    FLTDAT,
    FLTSEQNUM,
    SEGSERNUM,
    COUNT(MSTDOCNUM) AWBCOUNT,
    SUM(RCVPCS) MFTPCS,
    SUM(RCVWGT) MFTWGT,
    ARPCOD,
    'I' IND
  FROM
    (SELECT SEGSHP.CMPCOD,
      SEGSHP.FLTCARIDR,
      SEGSHP.SEGSERNUM,
      CASE
        WHEN ARLMST.APHCODUSE =2
        THEN ARLMST.TWOAPHCOD
        WHEN ARLMST.APHCODUSE =3
        THEN ARLMST.THRAPHCOD
      END FLTCARCOD,
      SEGSHP.FLTNUM FLTNUM,
      SEGSHP.FLTSEQNUM,
      TRUNC(FLTLEG.STA) FLTDAT,
      SEGSHP.MSTDOCNUM ,
      SEGSHP.RCVWGT ,
      SEGSHP.RCVPCS,
      FLTSEG.POU ARPCOD
    FROM OPRSEGSHP SEGSHP,
      OPRFLTSEG FLTSEG,
      OPRARPIMPFLT FLT,
      SHRARLMST ARLMST,
      FLTOPRLEG FLTLEG
    WHERE SEGSHP.FLTCARIDR = FLTSEG.FLTCARIDR
    AND SEGSHP.FLTNUM      = FLTSEG.FLTNUM
    AND SEGSHP.FLTSEQNUM   = FLTSEG.FLTSEQNUM
    AND SEGSHP.SEGSERNUM   = FLTSEG.SEGSERNUM
    AND SEGSHP.CMPCOD      = FLTSEG.CMPCOD
    AND FLTSEG.FLTCARIDR   = FLT.FLTCARIDR
    AND FLTSEG.FLTNUM      = FLT.FLTNUM
    AND FLTSEG.FLTSEQNUM   = FLT.FLTSEQNUM
    AND FLTSEG.CMPCOD      = FLT.CMPCOD
    AND FLTSEG.POU         = FLT.ARPCOD
    AND FLTSEG.FLTCARIDR   = FLTLEG.FLTCARIDR
    AND FLTSEG.FLTNUM      = FLTLEG.FLTNUM
    AND FLTSEG.FLTSEQNUM   = FLTLEG.FLTSEQNUM
    AND FLTSEG.CMPCOD      = FLTLEG.CMPCOD
    AND FLTSEG.POU         = FLTLEG.LEGDST
    AND ARLMST.CMPCOD      = SEGSHP.CMPCOD
    AND ARLMST.ARLIDR      = SEGSHP.FLTCARIDR
    AND SEGSHP.SEQNUM      = 1
    AND SEGSHP.RCVPCS      > 0
    AND SEGSHP.CMPCOD      = ?
    AND FLT.CLSFLG         = 'Y'
    )
  GROUP BY CMPCOD,
    FLTCARIDR,
    FLTCARCOD,
    FLTNUM,
    FLTDAT,
    FLTSEQNUM,
    SEGSERNUM,
    ARPCOD
  )) A
WHERE A.FLTDAT BETWEEN ? AND ?
AND A.CMPCOD = ? 
		]]>
	</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>431</QRY:Id>
	<QRY:Source Name="operations.flthandling.findMonthlyCargoTonnageSummary" Type="NATIVE">
		<![CDATA[
		SELECT A.CMPCOD,
  A.FLTCARCOD,
  TO_CHAR(FLTDAT,'MON') FLTMON,
  TO_CHAR(FLTDAT,'YYYY') FLTYER,
  SUM(A.AWBCOUNT) AWBCOUNT,
  SUM(A.MFTPCS) MFTPCS,
  SUM(A.MFTWGT) MFTWGT
FROM (
  (SELECT CMPCOD,
    FLTCARIDR,
    FLTCARCOD,
    FLTNUM,
    FLTDAT,
    FLTSEQNUM,
    SEGSERNUM,
    COUNT(MSTDOCNUM) AWBCOUNT,
    SUM(MFTPCS) MFTPCS,
    SUM(MFTWGT) MFTWGT,
    ARPCOD,
    'E' IND
  FROM
    (SELECT SEGSHP.CMPCOD,
      SEGSHP.FLTCARIDR,
      SEGSHP.SEGSERNUM,
      CASE
        WHEN ARLMST.APHCODUSE =2
        THEN ARLMST.TWOAPHCOD
        WHEN ARLMST.APHCODUSE =3
        THEN ARLMST.THRAPHCOD
      END FLTCARCOD,
      SEGSHP.FLTNUM FLTNUM,
      SEGSHP.FLTSEQNUM,
      TRUNC(FLTLEG.STD) FLTDAT,
      SEGSHP.MSTDOCNUM ,
      SEGSHP.MFTWGT ,
      SEGSHP.MFTPCS,
      FLTSEG.POL ARPCOD
    FROM OPRSEGSHP SEGSHP,
      OPRFLTSEG FLTSEG,
      OPRARPEXPFLT FLT,
      SHRARLMST ARLMST,
      FLTOPRLEG FLTLEG
    WHERE SEGSHP.FLTCARIDR = FLTSEG.FLTCARIDR
    AND SEGSHP.FLTNUM      = FLTSEG.FLTNUM
    AND SEGSHP.FLTSEQNUM   = FLTSEG.FLTSEQNUM
    AND SEGSHP.SEGSERNUM   = FLTSEG.SEGSERNUM
    AND SEGSHP.CMPCOD      = FLTSEG.CMPCOD
    AND FLTSEG.FLTCARIDR   = FLT.FLTCARIDR
    AND FLTSEG.FLTNUM      = FLT.FLTNUM
    AND FLTSEG.FLTSEQNUM   = FLT.FLTSEQNUM
    AND FLTSEG.CMPCOD      = FLT.CMPCOD
    AND FLTSEG.POL         = FLT.ARPCOD
    AND FLTSEG.FLTCARIDR   = FLTLEG.FLTCARIDR
    AND FLTSEG.FLTNUM      = FLTLEG.FLTNUM
    AND FLTSEG.FLTSEQNUM   = FLTLEG.FLTSEQNUM
    AND FLTSEG.CMPCOD      = FLTLEG.CMPCOD
    AND FLTSEG.POL         = FLTLEG.LEGORG
    AND ARLMST.CMPCOD      = SEGSHP.CMPCOD
    AND ARLMST.ARLIDR      = SEGSHP.FLTCARIDR
    AND SEGSHP.SEQNUM      = 1
    AND SEGSHP.MFTPCS      > 0
    AND SEGSHP.CMPCOD      = ?
    AND FLT.FINFLG         = 'F'
    )
  GROUP BY CMPCOD,
    FLTCARIDR,
    FLTCARCOD,
    FLTNUM,
    FLTDAT,
    FLTSEQNUM,
    SEGSERNUM,
    ARPCOD
  )
UNION
  (SELECT CMPCOD,
    FLTCARIDR,
    FLTCARCOD,
    FLTNUM,
    FLTDAT,
    FLTSEQNUM,
    SEGSERNUM,
    COUNT(MSTDOCNUM) AWBCOUNT,
    SUM(RCVPCS) MFTPCS,
    SUM(RCVWGT) MFTWGT,
    ARPCOD,
    'I' IND
  FROM
    (SELECT SEGSHP.CMPCOD,
      SEGSHP.FLTCARIDR,
      SEGSHP.SEGSERNUM,
      CASE
        WHEN ARLMST.APHCODUSE =2
        THEN ARLMST.TWOAPHCOD
        WHEN ARLMST.APHCODUSE =3
        THEN ARLMST.THRAPHCOD
      END FLTCARCOD,
      SEGSHP.FLTNUM FLTNUM,
      SEGSHP.FLTSEQNUM,
      TRUNC(FLTLEG.STA) FLTDAT,
      SEGSHP.MSTDOCNUM ,
      SEGSHP.RCVWGT ,
      SEGSHP.RCVPCS,
      FLTSEG.POU ARPCOD
    FROM OPRSEGSHP SEGSHP,
      OPRFLTSEG FLTSEG,
      OPRARPIMPFLT FLT,
      SHRARLMST ARLMST,
      FLTOPRLEG FLTLEG
    WHERE SEGSHP.FLTCARIDR = FLTSEG.FLTCARIDR
    AND SEGSHP.FLTNUM      = FLTSEG.FLTNUM
    AND SEGSHP.FLTSEQNUM   = FLTSEG.FLTSEQNUM
    AND SEGSHP.SEGSERNUM   = FLTSEG.SEGSERNUM
    AND SEGSHP.CMPCOD      = FLTSEG.CMPCOD
    AND FLTSEG.FLTCARIDR   = FLT.FLTCARIDR
    AND FLTSEG.FLTNUM      = FLT.FLTNUM
    AND FLTSEG.FLTSEQNUM   = FLT.FLTSEQNUM
    AND FLTSEG.CMPCOD      = FLT.CMPCOD
    AND FLTSEG.POU         = FLT.ARPCOD
    AND FLTSEG.FLTCARIDR   = FLTLEG.FLTCARIDR
    AND FLTSEG.FLTNUM      = FLTLEG.FLTNUM
    AND FLTSEG.FLTSEQNUM   = FLTLEG.FLTSEQNUM
    AND FLTSEG.CMPCOD      = FLTLEG.CMPCOD
    AND FLTSEG.POU         = FLTLEG.LEGDST
    AND ARLMST.CMPCOD      = SEGSHP.CMPCOD
    AND ARLMST.ARLIDR      = SEGSHP.FLTCARIDR
    AND SEGSHP.SEQNUM      = 1
    AND SEGSHP.RCVPCS      > 0
    AND SEGSHP.CMPCOD      = ?
    AND FLT.CLSFLG         = 'Y'
    )
  GROUP BY CMPCOD,
    FLTCARIDR,
    FLTCARCOD,
    FLTNUM,
    FLTDAT,
    FLTSEQNUM,
    SEGSERNUM,
    ARPCOD
  )) A
WHERE A.FLTDAT BETWEEN ? AND ?
AND A.CMPCOD = ?
		]]>
	</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>432</QRY:Id>
	<QRY:Source Name="operations.flthandling.findBuildUpPieces" Type="NATIVE">
		<![CDATA[
		SELECT SHP.FLTNUM, SHP.FLTSEQNUM, MST.FLTCARIDR, MST.FLTDAT 
 FROM OPRSEGSHP SHP, FLTOPRMST MST 
 WHERE SHP.CMPCOD =MST.CMPCOD 
 AND SHP.FLTNUM = MST.FLTNUM 
 AND SHP.FLTCARIDR = MST.FLTCARIDR 
 AND SHP.FLTSEQNUM = MST.FLTSEQNUM 
 AND SHP.BDPPCS > 0 
 AND SHP.MSTDOCNUM =? 
 AND SHP.DOCOWRIDR =? 
 AND SHP.DUPNUM =? 
 AND SHP.SEQNUM = ? 
 AND SHP.CMPCOD =? 
]]>
	</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>433</QRY:Id>
	<QRY:Source Name="operations.flthandling.findUnplannedShipmentsone" Type="NATIVE">
		<![CDATA[
		SELECT ULDSHP.CMPCOD,
  ULDSHP.FLTCARIDR,
  ULDSHP.FLTNUM,
  ULDSHP.ULDNUM,
  ULDSHP.FLTSEQNUM,
  ULDSHP.DOCOWRIDR,
  ULDSHP.MSTDOCNUM,
  ULDSHP.SEGSERNUM,
  ULDSHP.DUPNUM,
  ULDSHP.SEQNUM,
  ULDSHP.BDPPCS,
  ULDSHP.BDPWGT,
  ULDSHP.BDPVOL,
  ULDSHP.ORGCOD MSTORGCOD,
  ULDSHP.DSTCOD MSTDSTCOD,
  ULDSHP.SHPPFX,
  (SELECT RTRIM ( XMLAGG (XMLELEMENT (e, DSTCOD
    || ',') ).extract ('//text()'), ',')
  FROM OPRSHPRTG RTG
  WHERE ULDSHP.DOCOWRIDR = RTG.DOCOWRIDR
  AND ULDSHP.MSTDOCNUM   = RTG.MSTDOCNUM
  AND ULDSHP.DUPNUM      = RTG.DUPNUM
  AND ULDSHP.SEQNUM      = RTG.SEQNUM
  AND ULDSHP.CMPCOD      = RTG.CMPCOD
  ) RTGDSTCOD,
  BKGFLTDTL.FLTORG BKDFLTORG,
  BKGFLTDTL.FLTCARIDR BKDFLTCARIDR,
  BKGFLTDTL.FLTCARCOD BKDFLTCARCOD,
  BKGFLTDTL.FLTNUM BKDFLTNUM,
  BKGFLTDTL.FLTSEQNUM BKDFLTSEQNUM,
  BKGFLTDTL.FLTDAT BKDFLTDAT,
  BKGFLTDTL.FLTBKGSTA BKDFLTBKGSTA,
  BKGFLTDTL.NUMPCS BKDPCS,
  BKGFLTDTL.WGT BKDWGT,
  BKGFLTDTL.VOL BKDVOL,
  BKGFLTDTL.FLTDST BKDFLTDST,
  BKGFLTDTL.UBRNUM UBRNUM,
  BKGFLTDTL.SERNUM BKDDTLSERNUM
FROM
  (SELECT ULDSHP.CMPCOD,
    ULDSHP.FLTCARIDR,
    ULDSHP.FLTNUM,
    ULDSHP.ULDNUM,
    ULDSHP.FLTSEQNUM,
    ULDSHP.DOCOWRIDR,
    ULDSHP.MSTDOCNUM,
    ULDSHP.SEGSERNUM,
    ULDSHP.DUPNUM,
    ULDSHP.SEQNUM,
    ULDSHP.BDPPCS,
    ULDSHP.BDPWGT,
    ULDSHP.BDPVOL,
    MST.ORGCOD,
    MST.DSTCOD,
	MST.SHPPFX
  FROM OPRSEGULD ULD
  JOIN OPRFLTSEG FLT
  ON ULD.FLTNUM     = FLT.FLTNUM
  AND ULD.FLTCARIDR = FLT.FLTCARIDR
  AND ULD.FLTSEQNUM = FLT.FLTSEQNUM
  AND ULD.SEGSERNUM = FLT.SEGSERNUM
  AND ULD.CMPCOD    = FLT.CMPCOD
  INNER JOIN OPRSEGULDSHP ULDSHP
  ON ULD.CMPCOD     = ULDSHP.CMPCOD
  AND ULD.FLTCARIDR = ULDSHP.FLTCARIDR
  AND ULD.FLTNUM    = ULDSHP.FLTNUM
  AND ULD.FLTSEQNUM = ULDSHP.FLTSEQNUM
  AND ULD.SEGSERNUM = ULDSHP.SEGSERNUM
  AND ULD.ULDNUM    = ULDSHP.ULDNUM
  AND ULDSHP.BDPPCS >0
  INNER JOIN OPRSHPMST MST
  ON MST.CMPCOD     =ULDSHP.CMPCOD
  AND MST.MSTDOCNUM =ULDSHP.MSTDOCNUM
  AND MST.DOCOWRIDR =ULDSHP.DOCOWRIDR
  AND MST.DUPNUM    =ULDSHP.DUPNUM
  AND MST.SEQNUM    =ULDSHP.SEQNUM
  WHERE ULD.CMPCOD  = ?
  AND ULD.FLTCARIDR = ?
  AND ULD.FLTNUM    = ?
  AND ULD.FLTSEQNUM = ?
  AND FLT.POL       = ?
  
]]>
	</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>434</QRY:Id>
	<QRY:Source Name="operations.flthandling.findUnplannedShipmentstwo" Type="NATIVE">
		<![CDATA[
		AND NOT EXISTS
    (SELECT 1
    FROM CAPBKGFLTDTL BKG
    WHERE BKG.MSTDOCNUM            =ULDSHP.MSTDOCNUM
    AND BKG.DOCOWRIDR              =ULDSHP.DOCOWRIDR
    AND BKG.DUPNUM                 =ULDSHP.DUPNUM
    AND BKG.SEQNUM                 =ULDSHP.SEQNUM
    AND BKG.FLTNUM                 =ULDSHP.FLTNUM
    AND BKG.FLTCARIDR              =ULDSHP.FLTCARIDR
    AND BKG.FLTSEQNUM              =ULDSHP.FLTSEQNUM
    AND BKG.FLTORG                 =FLT.POL
    AND BKG.CMPCOD                 =ULDSHP.CMPCOD
    AND BKG.FLTBKGSTA              = 'C'
    )
  AND NOT EXISTS
    (SELECT 1
    FROM OPRLODPLNSHP LODSHP
    WHERE LODSHP.MSTDOCNUM=ULDSHP.MSTDOCNUM
    AND LODSHP.DOCOWNIDR  =ULDSHP.DOCOWRIDR
    AND LODSHP.DUPNUM     =ULDSHP.DUPNUM
    AND LODSHP.SEQNUM     =ULDSHP.SEQNUM
    AND LODSHP.FLTNUM     =ULDSHP.FLTNUM
    AND LODSHP.FLTCARIDR  =ULDSHP.FLTCARIDR
    AND LODSHP.FLTSEQNUM  =ULDSHP.FLTSEQNUM
    AND LODSHP.SEGORG     =FLT.POL
    AND LODSHP.CMPCOD     =ULDSHP.CMPCOD
    )
  ) ULDSHP
LEFT OUTER JOIN CAPBKGFLTDTL BKGFLTDTL 
ON ULDSHP.MSTDOCNUM  =BKGFLTDTL.MSTDOCNUM
AND ULDSHP.DOCOWRIDR =BKGFLTDTL.DOCOWRIDR
AND ULDSHP.DUPNUM    =BKGFLTDTL.DUPNUM
AND ULDSHP.SEQNUM    =BKGFLTDTL.SEQNUM
AND ULDSHP.CMPCOD    =BKGFLTDTL.CMPCOD 
]]>
	</QRY:Source>
	</QRY:Definition>
	
	<QRY:Definition>
		<QRY:Id>451</QRY:Id>
		<QRY:Source Name="operations.manifest.findTransactionHouses" Type="NATIVE">
<![CDATA[	
					SELECT SHPMST.CMPCOD,
					  SHPMST.MSTDOCNUM,
					  SHPMST.DUPNUM,
					  SHPMST.DOCNUM,
					  SHPMST.DOCOWRIDR,
					  SHPMST.ORGCOD,
					  SHPMST.DSTCOD,
					  SHPMST.STDPCS,
					  SHPMST.STDWGT,
					  SHPMST.SHPDES,
					  TXNHSE.ARPCOD,
                      TXNHSE.SEQNUM,
                      TXNHSE.TXNCOD,
					  TXNHSE.PCS MFTPCS,
					  TXNHSE.WGT MFTWGT,
					  TXNHSE.TXNREFONE,
					  TXNHSE.TXNREFTWO,
					  TXNHSE.TXNREFTHR,
					  TXNHSE.TXNREFFOR,
					  TXNHSE.TXNREFFIV,
					  TXNHSE.TXNREFNIN,
					  TXNHSE.TXNREFSEV,
					  TXNHSE.SERNUM,
					  TXNHSE.TXNREFSIX TXNHSE 
					FROM OPRSHPMST SHPMST
					INNER JOIN OPRTXNHSE TXNHSE
					ON TXNHSE.TXNCOD     = ?
					AND SHPMST.DOCOWRIDR = TXNHSE.DOCOWRIDR
					AND SHPMST.MSTDOCNUM = TXNHSE.MSTDOCNUM
					AND SHPMST.DUPNUM    = TXNHSE.DUPNUM
					AND SHPMST.SEQNUM    = TXNHSE.SEQNUM
					AND SHPMST.CMPCOD    = TXNHSE.CMPCOD
					AND SHPMST.SEQNUM    >1
]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	   <QRY:Id>452</QRY:Id>
	   <QRY:Source Name="operations.flthandling.cto.findbuildupdetails" Type="NATIVE">
			<![CDATA[
						SELECT LODGRP.CMPCOD,
					LODGRP.FLTNUM,
					LODGRP.FLTSEQNUM,
					LODGRP.FLTCARIDR,
					LODGRP.POL LODPLNPOL,
					LODGRP.GRPIDR,
					LODGRP.FCLIDR,
					LODGRP.GRPSTA,
					LODGRP.GRPTYP,
					POSPOL.POS,
					SEGULD.ULDNUM,
					SEGULD.PLNPOS ULDPOS,
					--SEGULD.BDPCPLFLG,
					SEGULD.BARROWFLG,
					--SEGULD.DISRMK,
					SEGULDSHP.ULDNUM SEGULDNUM,
					SEGULDSHP.MSTDOCNUM,
					SEGULDSHP.DUPNUM,
					SEGULDSHP.SEQNUM,
					SEGULDSHP.DOCOWRIDR,
					SEGULDSHP.MFTPCS SHPMFTPCS,
					SEGULDSHP.MFTWGT SHPMFTWGT,
					SEGULDSHP.MFTVOL SHPMFTVOL,
					SEGULDSHP.BDPPCS SHPBDPPCS,
					SEGULDSHP.BDPWGT SHPBDPWGT,
					SEGULDSHP.BDPVOL SHPBDPVOL,
					  STUMST.CURLOCCOD ULDLOC,
					  STUMST.CURWHSCOD ULDWHS,
					SEGULD.ULDDST ULDPOU,
					NVL(LODGRP.DUEDAT,FLTLEG.STD) DUEDAT,
					SEGULD.ACTWGT,
                    SHPMST.SCCCOD,
					FLTSEG.POL FLTSEGPOL,
					FLTSEG.POU FLTSEGPOU,
					SHPMST.ORGCOD SHPORG,
					SHPMST.DSTCOD SHPDST,
					SHPMST.SHPPFX SHPPFX,
					SHPMST.SHPNAM,
					SHPMST.PRDCOD,
					SHPMST.PRDNAM,
					DWSBLK.BLKRMK BLKRMK,
					DWSULD.BLKRMK ULDRMK,
					DWSULD.ULDNUM DWSULDNUM,
					DWSBLK.CNTIDR DWSCNTIDR,
					NVL(CASE 
					WHEN DWSULD.NETWGT > 0
				    THEN DWSULD.NETWGT
				    ELSE DWSBLK.NETWGT
				   	END,0) NETWGT,
				  	NVL(CASE
				    WHEN DWSULD.GRSWGT > 0
				    THEN DWSULD.GRSWGT
				    ELSE DWSBLK.GRSWGT
				 	END,0) GRSWGT,
				  	NVL(SEGULD.TARWGT,0) TARWGT,
				  	CASE 
    				WHEN SEGULD.ULDNUM = 'BULK'
    				THEN 'BULK'
    				ELSE SUBSTR(SEGULD.ULDNUM,1,3)
  					END BSETYP,
  					SEGULD.ULDCTR,
  					CASE 
    				WHEN SEGULD.BSEFLG = 'Y'
    				THEN 'Y'
    				ELSE 'N'
 				 	END BSEPALIND,
					Fltleg.ACRTYP,
					Fltmst.FLTROU
				FROM OPRLODPLNGRPDTL LODGRP
				  INNER JOIN OPRLODPLNPOSPOL POSPOL
					  ON LODGRP.GRPIDR     = POSPOL.GRPIDR
					  AND LODGRP.FLTNUM    = POSPOL.FLTNUM
					  AND LODGRP.FLTSEQNUM = POSPOL.FLTSEQNUM
					  AND LODGRP.FLTCARIDR = POSPOL.FLTCARIDR
					  AND LODGRP.POL       = POSPOL.POL
					  AND LODGRP.CMPCOD    = POSPOL.CMPCOD
				 -- INNER JOIN OPRLODPLNULD LODULD
					--  ON POSPOL.CMPCOD     = LODULD.CMPCOD
					 -- AND POSPOL.FLTNUM    = LODULD.FLTNUM
					--  AND POSPOL.FLTSEQNUM = LODULD.FLTSEQNUM
					 -- AND POSPOL.FLTCARIDR = LODULD.FLTCARIDR
					 -- AND POSPOL.POL       = LODULD.SEGORG
					--  AND POSPOL.POS       = LODULD.POS
					 -- AND POSPOL.POSSERNUM = LODULD.POSSERNUM
				  INNER JOIN OPRFLTSEG FLTSEG
					  ON LODGRP.CMPCOD     = FLTSEG.CMPCOD
					  AND LODGRP.FLTNUM    = FLTSEG.FLTNUM
					  AND LODGRP.FLTSEQNUM = FLTSEG.FLTSEQNUM
					  AND LODGRP.FLTCARIDR = FLTSEG.FLTCARIDR
					  AND LODGRP.POL    = FLTSEG.POL
					  AND LODGRP.POU    = FLTSEG.POU
				  INNER JOIN OPRSEGULD SEGULD
					  ON POSPOL.CMPCOD     = SEGULD.CMPCOD
					  AND POSPOL.FLTNUM    = SEGULD.FLTNUM
					  AND POSPOL.FLTSEQNUM = SEGULD.FLTSEQNUM
					  AND POSPOL.FLTCARIDR = SEGULD.FLTCARIDR
					  AND POSPOL.POS    = SEGULD.PLNPOS
					  AND FLTSEG.SEGSERNUM = SEGULD.SEGSERNUM
				  INNER JOIN FLTOPRLEG FLTLEG
					  ON  LODGRP.FLTNUM    = FLTLEG.FLTNUM
					  AND LODGRP.FLTSEQNUM = FLTLEG.FLTSEQNUM
					  AND LODGRP.FLTCARIDR = FLTLEG.FLTCARIDR
					  AND LODGRP.POL       = FLTLEG.LEGORG
					  AND LODGRP.CMPCOD    = FLTLEG.CMPCOD
				  LEFT OUTER JOIN OPRSEGULDSHP SEGULDSHP
					  ON SEGULD.CMPCOD     = SEGULDSHP.CMPCOD
					  AND SEGULD.FLTNUM    = SEGULDSHP.FLTNUM
					  AND SEGULD.FLTSEQNUM = SEGULDSHP.FLTSEQNUM
					  AND SEGULD.FLTCARIDR = SEGULDSHP.FLTCARIDR
					  AND SEGULD.ULDNUM    = SEGULDSHP.ULDNUM
					  AND SEGULD.SEGSERNUM = SEGULDSHP.SEGSERNUM
					LEFT OUTER JOIN WHSSTUMST STUMST
						ON SEGULD.ULDNUM  = STUMST.STUCOD
						AND LODGRP.POL = STUMST.ARPCOD
						AND SEGULD.CMPCOD  = STUMST.CMPCOD
				  LEFT OUTER JOIN OPRSHPMST SHPMST
					  ON SEGULDSHP.CMPCOD     = SHPMST.CMPCOD
					  AND SEGULDSHP.MSTDOCNUM = SHPMST.MSTDOCNUM
					  AND SEGULDSHP.SEQNUM    = SHPMST.SEQNUM
					  AND SEGULDSHP.DUPNUM    = SHPMST.DUPNUM
					  AND SEGULDSHP.DOCOWRIDR = SHPMST.DOCOWRIDR
				  LEFT OUTER JOIN OPRDWSBLK DWSBLK
					  ON DWSBLK.CMPCOD     = LODGRP.CMPCOD
					  AND DWSBLK.FLTNUM    = LODGRP.FLTNUM
					  AND DWSBLK.FLTSEQNUM = LODGRP.FLTSEQNUM
					  AND DWSBLK.FLTCARIDR = LODGRP.FLTCARIDR
					  AND DWSBLK.CNTIDR    = SEGULD.ULDNUM
					  AND DWSBLK.ARPCOD    = LODGRP.POL
				  LEFT OUTER JOIN OPRDWSULD DWSULD
					  ON DWSULD.CMPCOD     = LODGRP.CMPCOD
					  AND DWSULD.FLTNUM    = LODGRP.FLTNUM
					  AND DWSULD.FLTSEQNUM = LODGRP.FLTSEQNUM
					  AND DWSULD.FLTCARIDR = LODGRP.FLTCARIDR
					  AND DWSULD.ULDNUM    = SEGULD.ULDNUM
					  AND DWSULD.ARPCOD    = LODGRP.POL
					  Left Outer Join Fltoprmst Fltmst
						On  Fltleg.Fltnum = Fltmst.Fltnum
						And Fltleg.Fltseqnum = Fltmst.Fltseqnum
						And Fltleg.Fltcaridr = Fltmst.Fltcaridr
						AND FLTLEG.CMPCOD = Fltmst.cmpcod
				      WHERE LODGRP.CMPCOD = ?
]]>
	</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>453</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findlyinglistshipmentdetailsminimal" Type="NATIVE">
			<![CDATA[
				SELECT DENSE_RANK() OVER (ORDER BY RNK.CMPCOD,RNK.SHPPFX, RNK.MSTDOCNUM, RNK.DOCOWRIDR, RNK.DUPNUM, RNK.SEQNUM) RANK,
			  RNK.UBRNUM,
			  RNK.CMPCOD,
			  RNK.SHPPFX,
			  RNK.MSTDOCNUM,
              RNK.DOCOWRIDR,
			  RNK.DUPNUM,
			  RNK.SEQNUM,
			  RNK.STDPCS,
			  RNK.STDWGT,
			  RNK.GRSVOL,
			  RNK.PRDNAM,
RNK.SCCCOD,
RNK.DOCTYP,
(SELECT DISTINCT BLKSTA
  FROM OPRSHPBLK BLK
  WHERE BLK.MSTDOCNUM(+)=RNK.MSTDOCNUM
  AND BLK.DOCOWRIDR(+)  =RNK.DOCOWRIDR
  AND BLK.DUPNUM(+)     =RNK.DUPNUM
  AND BLK.SEQNUM(+)     =RNK.SEQNUM
  AND BLK.CMPCOD(+)     =RNK.CMPCOD
  AND BLK.ARPCOD        = ?
  AND BLKSTA            ='B'
  ) BLKSTA,
  (SELECT uld.numpcs
    || '-'
    ||uld.wgt
  FROM opruldshp uld
  WHERE uld.mstdocnum=rnk.mstdocnum
  AND uld.docowridr  = rnk.docowridr
  AND uld.uldnum     = rnk.stucod
  AND uld.cmpcod     =rnk.cmpcod
  AND uld.dupnum     =rnk.dupnum
  AND uld.seqnum     =rnk.seqnum
  AND uld.arpcod     =rnk.arpcod
  )ulddtl,
			  RNK.EXEDAT,
			  RNK.SHPDES,
			  RNK.EXEFLG,
			  RNK.ORGCOD,
			  RNK.DSTCOD,
			  RNK.ACPDAT,
RNK.FLTCARIDR,
			  RNK.FLTCARCOD,
    RNK.FLTBKG,
    RNK. FLTLDPPLN,
			  RNK.RTGSERNUM,
			  RNK.WHSCOD,
			  RNK.LOCCOD,
  RNK.STUCOD,
  RNK.LOCPCS,
  RNK.TXNPCS,
  RNK.SUMTOT,
  RNK.LOCWGT,
RNK.LOCTYPNAM,
			  RNK.ZONCOD,
			  RNK.STGSTCCOD,
			  --RNK.FCLIDR,
			  RNK.DSTCOD RTGDSTCOD,
			  RNK.ARPCOD,
RNK.AVLPCS,
				RNK.SHPINUSE,
  RNK.AVLWGT,
  NVL(RNK.OFLPCS,0)OFLPCS,
 -- RNK.ELCAWBFLG,
  --RNK.RCGFLG,
  RNK.TSKGRPIDR
FROM
  (SELECT SHPMST.UBRNUM,
    SHPMST.CMPCOD,
    SHPMST.SHPPFX,
    SHPMST.MSTDOCNUM,
    SHPMST.DOCOWRIDR,
    SHPMST.DUPNUM,
    SHPMST.SEQNUM,
    SHPMST.PRDNAM,
    SHPMST.STDPCS,
    SHPMST.STDWGT,
    SHPMST.GRSVOL,
    SHPMST.SCCCOD,
	shploc.DOCTYP,
    SHPMST.EXEDAT,
    SHPMST.SHPDES,
    SHPMST.EXEFLG,
   -- SHPMST.ELCAWBFLG,
   -- SHPMST.RCGFLG,
    SHPMST.ORGCOD,
    SHPMST.DSTCOD,
    SHPDTL.ACPDAT,
    RTG.FLTCARIDR,
    RTG.FLTCARCOD,
      (SELECT RTRIM(XMLAGG(XMLELEMENT(e,(FLTDTL1.FLTCARCOD
        ||' '
        ||FLTDTL1.FLTNUM
        ||' '
        ||FLTDTL1.FLTDAT)
        ||'/')).extract('//text()'),',') FLTBKG
      FROM CAPBKGFLTDTL FLTDTL1
      WHERE FLTDTL.CMPCOD  = FLTDTL1.CMPCOD(+)
      AND FLTDTL.DOCOWRIDR = FLTDTL1.DOCOWRIDR(+)
      AND FLTDTL.MSTDOCNUM = FLTDTL1.MSTDOCNUM(+)
      AND FLTDTL.DUPNUM    = FLTDTL1.DUPNUM(+)
      AND FLTDTL.SEQNUM    = FLTDTL1.SEQNUM(+)
      AND FLTDTL.UBRNUM    = FLTDTL1.UBRNUM(+)
      )FLTBKG,
      (SELECT RTRIM(XMLAGG(XMLELEMENT(e,( ARLMST.TWOAPHCOD
        ||' '
        ||FLTMST.FLTNUM
        ||' '
        ||'(P)  '
        ||to_char(LEG.STD,'DD-MON-YY HH24:MI'))
        ||'  /')).extract('//text()'),',') FLTLDPPLN
      FROM FLTOPRMST FLTMST,
        SHRARLMST ARLMST,
        OPRSEGSHP SEG,
		FLTOPRLEG LEG
      WHERE SHPMST.CMPCOD  = SEG.CMPCOD(+)
      AND SHPMST.DOCOWRIDR = SEG.DOCOWRIDR(+)
      AND SHPMST.MSTDOCNUM = SEG.MSTDOCNUM(+)
      AND SHPMST.DUPNUM    = SEG.DUPNUM(+)
      AND SHPMST.SEQNUM    = SEG.SEQNUM(+)
      AND FLTMST.FLTNUM    =SEG.FLTNUM
      AND FLTMST.FLTCARIDR = SEG.FLTCARIDR
      AND FLTMST.FLTSEQNUM =SEG.FLTSEQNUM
      AND FLTMST.CMPCOD    = SEG.CMPCOD
      AND ARLMST.CMPCOD    = FLTMST.CMPCOD
      AND ARLMST.ARLIDR    = FLTMST.FLTCARIDR
	  AND FLTMST.FLTNUM    =LEG.FLTNUM
	  AND FLTMST.FLTCARIDR = LEG.FLTCARIDR
	  AND FLTMST.FLTSEQNUM =LEG.FLTSEQNUM
      AND FLTMST.CMPCOD    = LEG.CMPCOD
      AND FLTMST.FLTORG    = LEG.LEGORG
      AND SEG.PLNPCS       > 0
      )FLTLDPPLN,
    RTG.RTGSERNUM,
    shploc.WHSCOD,
    shploc.LOCCOD,
    shploc.STUCOD,
    shploc.LOCPCS,
    shploc.txnpcs,
    ( SUM(shploc.locpcs - shploc.txnpcs) over (PARTITION BY shploc.docowridr,shploc.mstdocnum,shploc.dupnum,shploc.seqnum,shploc.cmpcod ) ) AS SUMTOT,
    shploc.LOCWGT,
               locmst.LOCTYPNAM,
locmst.ZONCOD,
               locmst.STGSTCCOD,
    --STGSTC.FCLIDR,
    RTG.DSTCOD RTGDSTCOD,
    ARP.ARPCOD,
	       ARP.AVLPCS,
ARP.AVLWGT,
    (SELECT SUM (OFLPCS)
    FROM OPROFLDTL OFL,
      OPRFLTSEG FLTSEG
    WHERE OFL.CMPCOD  = SHPMST.CMPCOD
	             AND OFL.DOCOWRIDR = SHPMST.DOCOWRIDR
AND OFL.MSTDOCNUM = SHPMST.MSTDOCNUM
    AND OFL.DUPNUM    = SHPMST.DUPNUM
    AND OFL.SEQNUM    = SHPMST.SEQNUM
    AND OFL.CMPCOD    = FLTSEG.CMPCOD
    AND OFL.FLTNUM    = FLTSEG.FLTNUM
	             AND OFL.FLTSEQNUM = FLTSEG.FLTSEQNUM
    AND OFL.FLTCARIDR = FLTSEG.FLTCARIDR
	             AND OFL.SEGSERNUM = FLTSEG.SEGSERNUM
    AND FLTSEG.POL    = ?
	        GROUP BY OFL.CMPCOD,
	                 OFL.DOCOWRIDR,
	                 OFL.MSTDOCNUM,
OFL.DUPNUM,
      OFL.SEQNUM
    ) AS OFLPCS ,
    (SELECT
      CASE
        WHEN COUNT(*) > 0
        THEN 'Y'
        ELSE 'N'
      END LODPLN
    FROM OPRLODPLNSHP SHP,
      OPRLODPLNPOL POL
    WHERE SHP.CMPCOD  = POL.CMPCOD
AND SHP.FLTCARIDR = POL.FLTCARIDR
    AND SHP.FLTNUM    = POL.FLTNUM
				AND SHP.FLTSEQNUM = POL.FLTSEQNUM
      AND SHP.DOCOWNIDR = SHPMST.DOCOWRIDR
				AND SHP.MSTDOCNUM = SHPMST.MSTDOCNUM
    AND SHP.DUPNUM    = SHPMST.DUPNUM
    AND SHP.SEQNUM    = SHPMST.SEQNUM
    AND SHP.SEGORG    = ARP.ARPCOD
    AND SHP.CMPCOD    = SHPMST.CMPCOD
				) AS SHPINUSE,
(SELECT RTRIM(XMLAGG(XMLELEMENT(e,( DTL.POL || '-' || DTL.POU || '*'|| SHP.GRPIDR || DTL.FLTCARIDR || DTL.FLTNUM || DTL.FLTSEQNUM)
      ||'/')).extract('//text()'),',') TSKGRPIDR
    FROM
    OPRLODPLNGRPDTL DTL,
    OPRLODPLNSHP SHP
    WHERE SHP.FLTCARIDR = DTL.FLTCARIDR
    AND SHP.FLTNUM    = DTL.FLTNUM
    AND SHP.FLTSEQNUM = DTL.FLTSEQNUM
    AND SHP.DOCOWNIDR = SHPMST.DOCOWRIDR
    AND SHP.MSTDOCNUM = SHPMST.MSTDOCNUM
    AND SHP.DUPNUM    = SHPMST.DUPNUM
    AND SHP.SEQNUM    = SHPMST.SEQNUM
    AND SHP.SEGORG    = ARP.ARPCOD
    AND SHP.CMPCOD    = SHPMST.CMPCOD
    AND DTL.POL = ARP.ARPCOD
    ) AS TSKGRPIDR
	  FROM OPRSHPMST SHPMST,
	       OPRSHPDTL SHPDTL,
OPRSHPRTG RTG,
	       OPRARPSHP ARP,
	       OPRARPARLSHP DTL,
	       CAPBKGFLTDTL FLTDTL,
whsoprshploc shploc,
               whslocmst locmst,
               whsstgstc stgstc,
               whspcsdtl pcsdtl
  WHERE SHPMST.CMPCOD  = SHPDTL.CMPCOD(+)
  AND SHPMST.DOCOWRIDR = SHPDTL.DOCOWRIDR(+)
  AND SHPMST.MSTDOCNUM = SHPDTL.MSTDOCNUM(+)
  AND SHPMST.DUPNUM    = SHPDTL.DUPNUM(+)
  AND SHPMST.SEQNUM    = SHPDTL.SEQNUM(+)
  AND SHPDTL.DOCOWRIDR = RTG.DOCOWRIDR(+)
  AND SHPDTL.MSTDOCNUM = RTG.MSTDOCNUM(+)
  AND SHPDTL.DUPNUM    = RTG.DUPNUM(+)
  AND SHPDTL.SEQNUM    = RTG.SEQNUM(+)
  AND SHPDTL.CMPCOD    = RTG.CMPCOD(+)
  AND SHPMST.CMPCOD    = ARP.CMPCOD
  AND SHPMST.DOCOWRIDR = ARP.DOCOWRIDR
  AND SHPMST.MSTDOCNUM = ARP.MSTDOCNUM
  AND SHPMST.DUPNUM    = ARP.DUPNUM
  AND SHPMST.SEQNUM    = ARP.SEQNUM
  AND ARP.CMPCOD       = DTL.CMPCOD(+)
  AND ARP.DOCOWRIDR    = DTL.DOCOWRIDR(+)
  AND ARP.MSTDOCNUM    = DTL.MSTDOCNUM(+)
  AND ARP.DUPNUM       = DTL.DUPNUM(+)
  AND ARP.SEQNUM       = DTL.SEQNUM(+)
  AND ARP.ARPCOD       = DTL.ARPCOD(+)
  AND ARP.AVLPCS       > 0
  AND SHPMST.CMPCOD    = FLTDTL.CMPCOD(+)
  AND SHPMST.DOCOWRIDR = FLTDTL.DOCOWRIDR(+)
  AND SHPMST.MSTDOCNUM = FLTDTL.MSTDOCNUM(+)
  AND SHPMST.DUPNUM    = FLTDTL.DUPNUM(+)
  AND SHPMST.SEQNUM    = FLTDTL.SEQNUM(+)
  AND SHPMST.UBRNUM    = FLTDTL.UBRNUM(+)
  AND shploc.cmpcod    = SHPMST.cmpcod
  AND shploc.docowridr = SHPMST.docowridr
  AND shploc.mstdocnum = SHPMST.mstdocnum
  AND shploc.seqnum    = SHPMST.seqnum
  AND shploc.dupnum    = SHPMST.dupnum
  AND shploc.cmpcod    = locmst.cmpcod
  AND shploc.arpcod    = locmst.arpcod
  AND shploc.whscod    = locmst.whscod
  AND shploc.loccod    = locmst.loccod
  AND LOCMST.cmpcod    = STGSTC.cmpcod
  AND LOCMST.WHSCOD    = STGSTC.WHSCOD
  AND LOCMST.CMPCOD    = STGSTC.CMPCOD
  AND LOCMST.ARPCOD    = STGSTC.ARPCOD
  AND LOCMST.STGSTCCOD = STGSTC.STGSTCCOD
  AND shploc.cmpcod    = pcsdtl.cmpcod(+)
  AND shploc.arpcod    = pcsdtl.arpcod(+)
  AND shploc.STUCOD   IN( 'DEFAULT')
  AND shploc.txnpcs    = 0
  AND SHPMST.CMPCOD    = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
 <QRY:Definition>
		<QRY:Id>454</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findlyinglistulddetailsminimal" Type="NATIVE">
			<![CDATA[SELECT DENSE_RANK() OVER( ORDER BY RNK.CMPCOD, RNK.ARPCOD, RNK.ULDNUM) RANK,
			     RNK.ARPCOD,
                 RNK.POU,RNK.ULDCTR,RNK.BRWFLG,RNK.ULDDST,
			     RNK.CMPCOD,
			     RNK.ULDNUM,
			     RNK.NUMPCS,
			     RNK.WGT,
			     RNK.SHPPFX,
                 RNK.MSTDOCNUM,
			     RNK.DOCOWRIDR,
			     --RNK.BSEPLT,
			     RNK.DUPNUM,
			     RNK.SEQNUM,
                 RNK.STDPCS,
				 RNK.PRDNAM,
			     RNK.STDWGT,
			     RNK.GRSVOL,
				 RNK.SCCCOD,
                 RNK.SCCPRY,
				(SELECT DISTINCT blksta
     FROM oprshpblk blk
     WHERE blk.mstdocnum(+) = rnk.mstdocnum
  AND blk.docowridr(+)   = rnk.docowridr
  AND blk.dupnum(+)      = rnk.dupnum
  AND blk.seqnum(+)      = rnk.seqnum
  AND blk.cmpcod(+)      = rnk.cmpcod
  AND blk.arpcod         = ?
  AND blksta             = 'B'
  ) blksta,
   (SELECT SUM(oflpcs)
       FROM oprofldtl fltdtl
  WHERE fltdtl.cmpcod  = rnk.cmpcod
       AND fltdtl.docowridr = rnk.docowridr
       AND fltdtl.mstdocnum = rnk.mstdocnum
  AND fltdtl.dupnum    = rnk.dupnum
  AND fltdtl.seqnum    = rnk.seqnum
  AND fltdtl.uldnum    = rnk.uldnum
       GROUP BY fltdtl.cmpcod,
         fltdtl.docowridr,
         fltdtl.mstdocnum,
         fltdtl.dupnum,
    fltdtl.seqnum
  ) oflpcs,
			     RNK.EXEDAT,
  RNK.SHPDES,
  RNK.EXEFLG,
			     RNK.ORGCOD,
			     RNK.DSTCOD,
			     RNK.ACPDAT,
			     RNK.FLTCARCOD,
  RNK.FLTBKG,
  RNK.FLTLDPPLN,
RNK.RTESEQNUM,
  RNK.WHSCOD,
  RNK.LOCCOD,
  RNK.STUCOD,
  RNK.LOCPCS,
  RNK.LOCWGT,
  RNK.ACPPCS,
  RNK.ACPWGT,
  RNK.LOCTYPNAM,
  RNK.ZONCOD,
  RNK.DSTCOD RTGDSTCOD,
  --RNK.FCLIDR,
  RNK.TARWGT,
  RNK.GRSWGT,
  RNK.NETWGT
			   FROM
			    (SELECT ARP.ARPCOD,
			       ARP.POU,
			       ARP.ULDCTR,
    			   ARP.ULDDST,
				     ARP.BRWFLG,
			       ULD.CMPCOD,
			       ULD.ULDNUM,
             ULD.NUMPCS,
			       ULD.WGT,
			       SHPMST.SHPPFX,
			       SHPMST.MSTDOCNUM,
			       SHPMST.DOCOWRIDR,
             --ARP.BSEPLT,
			       SHPMST.DUPNUM,
			       SHPMST.SEQNUM,
			       SHPMST.STDPCS,
			       SHPMST.STDWGT,
			       SHPMST.PRDNAM,
             SHPMST.GRSVOL,
			       SHPMST.SCCCOD,
				     SCCMST.SCCPRY,
			       SHPMST.EXEDAT,
			       SHPMST.SHPDES,
				     SHPMST.EXEFLG,
			       SHPMST.ORGCOD,
             SHPMST.DSTCOD,
			       SHPDTL.ACPDAT,
			       RTG.FLTCARCOD,
    (SELECT RTRIM(XMLAGG(XMLELEMENT(e,(FLTDTL.FLTCARCOD
      ||' '
      ||FLTDTL.FLTNUM
      ||' '
      ||FLTDTL.FLTDAT)
      ||';')).extract('//text()'),',') FLTBKG
    FROM CAPBKGFLTDTL FLTDTL
    WHERE SHPMST.CMPCOD  = FLTDTL.CMPCOD
    AND SHPMST.DOCOWRIDR = FLTDTL.DOCOWRIDR(+)
    AND SHPMST.MSTDOCNUM = FLTDTL.MSTDOCNUM(+)
    AND SHPMST.DUPNUM    = FLTDTL.DUPNUM(+)
    AND SHPMST.SEQNUM    = FLTDTL.SEQNUM(+)
    AND SHPMST.UBRNUM    = FLTDTL.UBRNUM(+)
    )FLTBKG,
    (SELECT RTRIM(XMLAGG(XMLELEMENT(e,( ARLMST.TWOAPHCOD
      ||' '
      ||FLTMST.FLTNUM
      ||' '
      ||'(P)  '
      ||to_char(LEG.STD,'DD-MON-YY HH24:MI'))
      ||'  /')).extract('//text()'),',') FLTLDPPLN
    FROM FLTOPRMST FLTMST,
      SHRARLMST ARLMST,
      OPRSEGSHP SEG,
	  FLTOPRLEG LEG
    WHERE SHPMST.CMPCOD  = SEG.CMPCOD(+)
    AND SHPMST.DOCOWRIDR = SEG.DOCOWRIDR(+)
    AND SHPMST.MSTDOCNUM = SEG.MSTDOCNUM(+)
    AND SHPMST.DUPNUM    = SEG.DUPNUM(+)
    AND SHPMST.SEQNUM    = SEG.SEQNUM(+)
    AND FLTMST.FLTNUM    =SEG.FLTNUM
    AND FLTMST.FLTCARIDR = SEG.FLTCARIDR
    AND FLTMST.FLTSEQNUM =SEG.FLTSEQNUM
    AND FLTMST.CMPCOD    = SEG.CMPCOD
    AND ARLMST.CMPCOD    = FLTMST.CMPCOD
    AND ARLMST.ARLIDR    = FLTMST.FLTCARIDR
	AND FLTMST.FLTNUM    =LEG.FLTNUM
    AND FLTMST.FLTCARIDR = LEG.FLTCARIDR
    AND FLTMST.FLTSEQNUM =LEG.FLTSEQNUM
    AND FLTMST.CMPCOD    = LEG.CMPCOD
    AND FLTMST.FLTORG    = LEG.LEGORG
    AND SEG.PLNPCS       > 0
    )FLTLDPPLN,
	 RTG.RTESEQNUM,
	 SHPLOC.WHSCOD,
    SHPLOC.LOCCOD,
    SHPLOC.STUCOD,
    SHPLOC.LOCPCS,
    SHPLOC.LOCWGT,
    ARPSHP.ACPPCS,
    ARPSHP.ACPWGT,
    LOCMST.LOCTYPNAM,
    LOCMST.ZONCOD,
	RTG.DSTCOD RTGDSTCOD,
  	--STGSTC.FCLIDR,
	ARP.TARWGT,
	ARP.NETWGT,
    ARP.GRSWGT
  FROM OPRULDSHP ULD,
	    OPRSHPMST SHPMST,
	    OPRSHPDTL SHPDTL,
	    WHSOPRSHPLOC SHPLOC,
        OPRARPSHP ARPSHP,
        WHSLOCMST LOCMST,
	    OPRSHPRTG RTG,
	    OPRARPULD ARP,
	    whsstgstc stgstc,
		SHRSCCMST SCCMST
  WHERE ARP.CMPCOD     = ULD.CMPCOD
  AND ARP.ARPCOD       = ULD.ARPCOD
  AND ARP.ULDNUM       = ULD.ULDNUM
 -- AND NVL(ARP.BSEFLG,'N')	   = 'N'
  AND ULD.CMPCOD       = SHPMST.CMPCOD
  AND ULD.DOCOWRIDR    = SHPMST.DOCOWRIDR
  AND ULD.MSTDOCNUM    = SHPMST.MSTDOCNUM
  AND ULD.DUPNUM       = SHPMST.DUPNUM
  AND ULD.SEQNUM       = SHPMST.SEQNUM
  AND ARPSHP.CMPCOD    =ULD.CMPCOD
  AND ARPSHP.MSTDOCNUM =ULD.MSTDOCNUM
  AND ARPSHP.DUPNUM    =ULD.DUPNUM
  AND ARPSHP.DOCOWRIDR =ULD.DOCOWRIDR
  AND ARPSHP.SEQNUM    =ULD.SEQNUM
  AND ARPSHP.ARPCOD    =ULD.ARPCOD
  AND SHPMST.CMPCOD    = SHPDTL.CMPCOD(+)
AND SHPMST.DOCOWRIDR = SHPDTL.DOCOWRIDR(+)
			     AND SHPMST.MSTDOCNUM = SHPDTL.MSTDOCNUM(+)
  AND SHPMST.DUPNUM    = SHPDTL.DUPNUM(+)
  AND SHPMST.SEQNUM    = SHPDTL.SEQNUM(+)
  AND SHPMST.DOCOWRIDR = RTG.DOCOWRIDR(+)
			     AND SHPMST.MSTDOCNUM = RTG.MSTDOCNUM(+)
  AND SHPMST.DUPNUM    = RTG.DUPNUM(+)
  AND SHPMST.SEQNUM    = RTG.SEQNUM(+)
  AND SHPMST.CMPCOD    = RTG.CMPCOD(+)
  AND SHPLOC.CMPCOD    = ULD.CMPCOD
			     AND SHPLOC.DOCOWRIDR = ULD.DOCOWRIDR
			     AND SHPLOC.MSTDOCNUM = ULD.MSTDOCNUM
  AND SHPLOC.SEQNUM    = ULD.SEQNUM
  AND SHPLOC.DUPNUM    = ULD.DUPNUM
  AND SHPLOC.STUCOD    = ULD.ULDNUM
  AND SHPLOC.CMPCOD    = LOCMST.CMPCOD
  AND SHPLOC.ARPCOD    = LOCMST.ARPCOD
  AND SHPLOC.WHSCOD    = LOCMST.WHSCOD
  AND SHPLOC.LOCCOD    = LOCMST.LOCCOD
  AND LOCMST.cmpcod    = STGSTC.cmpcod
  AND LOCMST.WHSCOD    = STGSTC.WHSCOD
  AND LOCMST.CMPCOD    = STGSTC.CMPCOD
  AND LOCMST.ARPCOD    = STGSTC.ARPCOD
  AND LOCMST.STGSTCCOD = STGSTC.STGSTCCOD
  AND SHPMST.CMPCOD=SCCMST.CMPCOD(+)
  AND SHPMST.SCCCOD=SCCMST.SCCCOD(+)
  AND shpmst.cmpcod    = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
    <QRY:Definition>
		<QRY:Id>455</QRY:Id>
		<QRY:Source Name="operations.flthandling.cto.findlyinglistuldshipmentdetails" Type="NATIVE">
			<![CDATA[
				SELECT
				       uld.uldnum
				     FROM opruldshp uld,
				       oprshpmst shpmst,
				       oprshpdtl shpdtl,
				       whsoprshploc shploc,
				       oprarpshp arpshp,
				       whslocmst locmst,
				       oprshprtg rtg,
				       oprarpuld arp
				     WHERE arp.cmpcod = uld.cmpcod
				     AND arp.arpcod = uld.arpcod and arp.uldnum = uld.uldnum
				     AND uld.cmpcod = shpmst.cmpcod
				     AND uld.docowridr = shpmst.docowridr
				     AND uld.mstdocnum = shpmst.mstdocnum
				     AND uld.dupnum = shpmst.dupnum
				     AND uld.seqnum = shpmst.seqnum
				     AND arpshp.cmpcod = uld.cmpcod
				     AND arpshp.mstdocnum = uld.mstdocnum
				     AND arpshp.dupnum = uld.dupnum
				     AND arpshp.docowridr = uld.docowridr
				     AND arpshp.seqnum = uld.seqnum
				     AND arpshp.arpcod = uld.arpcod
				     AND shpmst.cmpcod = shpdtl.cmpcod(+)
				     AND shpmst.docowridr = shpdtl.docowridr(+)
				     AND shpmst.mstdocnum = shpdtl.mstdocnum(+)
				     AND shpmst.dupnum = shpdtl.dupnum(+)
				     AND shpmst.seqnum = shpdtl.seqnum(+)
				     AND shpmst.docowridr = rtg.docowridr(+)
				     AND shpmst.mstdocnum = rtg.mstdocnum(+)
				     AND shpmst.dupnum = rtg.dupnum(+)
				     AND shpmst.seqnum = rtg.seqnum(+)
				     AND shpmst.cmpcod = rtg.cmpcod(+)
				     AND shploc.cmpcod = uld.cmpcod
				     AND shploc.docowridr = uld.docowridr
				     AND shploc.mstdocnum = uld.mstdocnum
				     AND shploc.seqnum = uld.seqnum
				     AND shploc.dupnum = uld.dupnum
				     AND shploc.stucod = uld.uldnum
				     AND shploc.cmpcod = locmst.cmpcod
				     AND shploc.arpcod = locmst.arpcod
				     AND shploc.whscod = locmst.whscod
				     AND shploc.loccod = locmst.loccod
				     AND shpmst.cmpcod = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
   	<QRY:Definition>
		<QRY:Id>456</QRY:Id>
		<QRY:Source Name="operations.flthandling.findshipmentsinplanflight" Type="NATIVE">
			<![CDATA[
				SELECT MST.MSTDOCNUM,
				  MST.DOCOWRIDR,
				  MST.DUPNUM,
				  MST.SEQNUM,
				  MST.STDPCS,
                  MST.STDPCS,
				  MST.STDWGT,
				  MST.STDWGTCOD,
				  MST.ORGCOD,
				  MST.DSTCOD,
				  MST.EXEFLG,MST.CONFLG,
				  MST.AGTCOD,
				  MST.SHPPFX,MST.SHPSTA,
				  SHP.BDPPCS,
				  SHP.BDPWGT,
				  SHP.BDPVOL,
                  SHP.MFTPCS,
				  SHP.MFTWGT,
                  SHP.MFTVOL,
				  SHP.LSTUPDTIM,
				  MSTMIS.MSGTYP,
				  MSTMIS.MSGSEQNUM,
				  MSTMIS.STACOD,
                  SEG.POL,
				  SEG.POU,
                  MST.SCCCOD,
                  MST.PRDCOD,
				  MST.PRDNAM,
				  MST.SHPCOD,
				  MST.SHPNAM,
				  MST.CNSCOD,
				  MST.CNSNAM,
				  MST.AGTCOD,
				  MST.AGTNAM,
				  MSTCNT.SHPMALIDR,
				  MSTCNT.CNSMALIDR
                FROM OPRSHPMST MST,
				OPRSHPMSTCNT MSTCNT,
			    OPRSHPMSTMIS MSTMIS,
				OPRSEGSHP SHP,
                OPRFLTSEG SEG
				WHERE MST.CMPCOD = MSTMIS.CMPCOD
				 AND MST.MSTDOCNUM = MSTMIS.MSTDOCNUM
                 AND MST.DOCOWRIDR = MSTMIS.DOCOWRIDR
				 AND MST.DUPNUM = MSTMIS.DUPNUM
				 AND MST.SEQNUM = MSTMIS.SEQNUM
                 AND MSTMIS.CMPCOD = SHP.CMPCOD
				 AND MSTMIS.MSTDOCNUM = SHP.MSTDOCNUM
				 AND MSTMIS.DOCOWRIDR =SHP.DOCOWRIDR
				 AND MSTMIS.DUPNUM = SHP.DUPNUM
				 AND MSTMIS.SEQNUM = SHP.SEQNUM
				 AND SHP.FLTCARIDR= SEG.FLTCARIDR
				 AND SHP.FLTNUM = SEG.FLTNUM
				 AND SEG.FLTSEQNUM = SHP.FLTSEQNUM
				 AND SEG.CMPCOD= SHP.CMPCOD
				 AND SEG.SEGSERNUM = SHP.SEGSERNUM
				  AND MST.CMPCOD       = MSTCNT.CMPCOD(+)
				 AND MST.MSTDOCNUM    = MSTCNT.MSTDOCNUM(+)
				 AND MST.DOCOWRIDR    = MSTCNT.DOCOWRIDR(+)
				 AND MST.DUPNUM       = MSTCNT.DUPNUM(+)
				 AND MST.SEQNUM       = MSTCNT.SEQNUM(+)
				 AND SHP.BDPPCS > 0
                 AND SEG.CMPCOD =  ?
                 AND SEG.FLTCARIDR = ?
                 AND SEG.FLTNUM = ?
                 AND SEG.FLTSEQNUM = ? ]]>
	</QRY:Source>
</QRY:Definition>
<QRY:Definition>
	<QRY:Id>457</QRY:Id>
	<QRY:Source Name="operations.flthandling.findcustomsreportedawbs" Type="NATIVE">
		<![CDATA[
			SELECT CST.MSTDOCNUM MSTDOCNUM
			FROM CSTARPSHP CST
			INNER JOIN OPRSEGSHP SHP
			ON CST.CMPCOD = SHP.CMPCOD AND
			  CST.DOCOWRIDR =SHP.DOCOWRIDR AND
			  CST.MSTDOCNUM = SHP.MSTDOCNUM AND
			  CST.DUPNUM = SHP.DUPNUM AND
			  CST.SEQNUM = SHP.SEQNUM AND
			  (CST.CSTSTACOD IS NOT NULL AND CST.CSTSTACOD<>'CX') AND 
			  CST.CSTAUTCOD =?
			INNER JOIN FLTOPRSEG SEG
			ON SHP.CMPCOD = SEG.CMPCOD AND
			   SHP.FLTCARIDR = SEG.FLTCARIDR AND
			   SHP.FLTNUM = SEG.FLTNUM AND
			   SHP.FLTSEQNUM = SEG.FLTSEQNUM AND
			   SHP.SEGSERNUM = SEG.SEGSERNUM
			INNER JOIN FLTOPRLEG LEG
			ON LEG.CMPCOD = SEG.CMPCOD AND
			   LEG.FLTCARIDR = SEG.FLTCARIDR AND
			   LEG.FLTNUM = SEG.FLTNUM AND
			   LEG.FLTSEQNUM = SEG.FLTSEQNUM AND
			   LEG.LEGORG = SEG.SEGORG
			WHERE LEG.CMPCOD = ?
			     AND LEG.FLTCARIDR = ?
			     AND LEG.FLTNUM = ?
			     AND LEG.FLTSEQNUM = ?
			     AND  LEG.LEGSERNUM = ?  
]]>
	</QRY:Source>
	</QRY:Definition>
<QRY:Definition>
	<QRY:Id>473</QRY:Id>
	<QRY:Source Name="operations.flthandling.finduldactualweightfromairport" Type="NATIVE">
		<![CDATA[
			SELECT
				ACTWGT
			FROM
				OPRARPULD
			WHERE
				CMPCOD = ?
				AND ARPCOD = ?
				AND ULDNUM = ?
		]]>
	</QRY:Source>
</QRY:Definition>
<QRY:Definition>
	<QRY:Id>474</QRY:Id>
	<QRY:Source Name="operations.flthandling.finduldactualweightfromdws" Type="NATIVE">
		<![CDATA[
			SELECT
				ACTWGT
			FROM
				OPRDWSULD
			WHERE
				CMPCOD = ?
				AND ARPCOD = ?
				AND ULDNUM = ?
				AND FLTCARIDR = ?
				AND FLTNUM = ?
				AND FLTSEQNUM = ?
				AND LEGSERNUM = ?
	]]>
	</QRY:Source>
</QRY:Definition>
<QRY:Definition>
                <QRY:Id>482</QRY:Id>
                <QRY:Source Name="operations.flthandling.findmanifestdetailsForFlight" Type="NATIVE">
                <![CDATA[
              SELECT
FLTSEG.FLTCARIDR FLTCARIDR,
FLTSEG.FLTNUM FLTNUM,
FLTSEG.FLTSEQNUM FLTSEQNUM,
FLTSEG.SEGSERNUM FLTSEGSERNUM, 
FLTSEG.CMPCOD CMPCOD,
FLTSEG.POL FLTPOL,  
FLTSEG.POU FLTPOU,
SEGULD.MFTPCS MFTPCS,
SEGULD.MFTWGT MFTWGT,
SEGULD.MFTVOL MFTVOL,
MST.MSTDOCNUM MSTDOCNUM,
MST.DOCOWRIDR DOCOWRIDR,
MST.STDPCS STDPCS,
MST.STDWGT STDWGT,
MST.SHPDES SHPDES,
MST.SHPPFX SHPPFX,
MST.SCCCOD SCCCOD,
MST.ORGCOD ORGCOD,
MST.DSTCOD DSTCOD,
MST.PRDNAM PRDNAM,
MST.CNSCOD CNSCOD,
MST.CNSNAM CNSNAM,
MST.DUPNUM DUPNUM,
MST.SEQNUM SEQNUM,
SEGULD.BDPPCS BDPPCS,
SEGULD.BDPWGT BDPWGT,
SEGULD.BDPVOL BDPVOL,
SEGULD.ADDSCC ADDSCCSCCCOD,
SEGULD.ULDNUM ULDNUM,
pkg_opr_shp.FUN_GET_CLEARINGAGENT(MST.CMPCOD, MST.MSTDOCNUM,MST.DUPNUM,MST.SEQNUM,MST.DOCOWRIDR) CLRAGTCOD
FROM OPRFLTSEG FLTSEG
INNER JOIN OPRSEGULDSHP SEGULD
ON SEGULD.CMPCOD     = FLTSEG.CMPCOD
AND SEGULD.FLTNUM    = FLTSEG.FLTNUM
AND SEGULD.FLTSEQNUM = FLTSEG.FLTSEQNUM
AND SEGULD.FLTCARIDR = FLTSEG.FLTCARIDR
AND SEGULD.SEGSERNUM = FLTSEG.SEGSERNUM
INNER JOIN OPRSHPMST MST
ON MST.CMPCOD     = SEGULD.CMPCOD
AND MST.DOCOWRIDR = SEGULD.DOCOWRIDR
AND MST.MSTDOCNUM = SEGULD.MSTDOCNUM
AND MST.SEQNUM    = SEGULD.SEQNUM
AND MST.DUPNUM    = SEGULD.DUPNUM
where MST.CMPCOD=?
and FLTSEG.FLTNUM=?
and FLTSEG.FLTCARIDR=?
and FLTSEG.FLTSEQNUM=?
]]>
                </QRY:Source>
                </QRY:Definition>
				
				
</QRY:Definitions>