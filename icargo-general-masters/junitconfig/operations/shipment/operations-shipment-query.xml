<?xml version="1.0"?>
<QRY:Definitions xmlns:QRY="http://www.ibsplc.com/xibase/persistence/queries" module="operations.shipment">

<QRY:Definition>
<QRY:Id>1</QRY:Id> 
<QRY:Source Name="operations.shipment.findshipments" Type="NATIVE">
	<![CDATA[
	SELECT MST.DOCOWRIDR,MST.DUPNUM,MST.SEQNUM,MST.CMPCOD,
	MST.SHPPFX,MST.MSTDOCNUM,MST.DOCTYP,MST.MSTDOCNUM DOCNUM,
	MST.CPTDAT,MST.OWRCOD,MST.CNSCOD,MST.ORGCOD,
	MST.DSTCOD,MST.SHPSTA,MST.UBRNUM,MST.SHPTYP,MST.PRGSTA,MST.CONFLG,
	MST.SCCCOD, MST.LSTUPDTIM, MST.LSTUPDUSR, MST.SHPCOD
	FROM OPRSHPIDX MST
	WHERE MST.CMPCOD=?
	AND   MST.MSTDOCNUM=?
]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>2</QRY:Id>
<QRY:Source Name="operations.shipment.findshipmentacceptancedetails" Type="NATIVE">
	<![CDATA[ 
	SELECT
			OPR.ACPARPCOD, MST.CMPCOD, MST.DOCOWRIDR, MST.MSTDOCNUM, MST.DUPNUM,
	       	MST.SEQNUM, MST.DTACPTFLG, ORGCOD, DSTCOD, MST.SCCCOD, STDPCS, MST.SHPPFX, MST.SRCIND,
	       	STDWGT, STDWGTCOD, SHPDES, OPR.ACPRMK, TOTACPPCS, TOTACPWGT, TOTACPVOL,
	       	STDDISWGT, SHPSTA, PLTFLG, EXEFLG, OPR.PLTUSEFLG, MST.CONFLG, MST.GRSVOL,
	       	MST.GRSDISVOL, HSE.ARPCOD HSEARPCOD, HSE.TXNREFONE, HSE.TXNREFTWO,
	       	HSE.TXNREFTHR, HSE.TXNREFFOR, HSE.TXNREFFIV, HSE.TXNREFSIX, HSE.DOCNUM,
	       	HSE.PCS, HSE.WGT, HSE.SEQNUM HSCSEQNUM,
		   	MST.LSTUPDTIM SHPLSTUPDTIM, MST.LSTUPDUSR SHPLSTUPDUSR,
	       	OPR.LSTUPDTIM OPRLSTUPDTIM, OPR.LSTUPDUSR OPRLSTUPDUSR,
		   	HSE.LSTUPDTIM HSELSTUPDTIM, HSE.LSTUPDUSR HSELSTUPDUSR,
			ARP.LSTUPDTIM ARPLSTUPDTIM, ARP.LSTUPDUSR ARPLSTUPDUSR,
		    HSE.SERNUM HSESERNUM, HSE.TXNCOD TXNCOD,
			FLT.FLTNUM FLTNUM,FLT.FLTDAT FLTDAT,FLT.POU FLTPOU,MST.SHPNAM
	  FROM 	OPRSHPMST MST,
	  		OPRSHPDTL OPR,
			OPRARPSHP ARP,
	  		OPRTXNHSE HSE,
			OPRACPFLTDTL FLT
	 WHERE MST.CMPCOD = OPR.CMPCOD(+)
	   AND MST.DOCOWRIDR = OPR.DOCOWRIDR(+)
	   AND MST.MSTDOCNUM = OPR.MSTDOCNUM(+)
	   AND MST.DUPNUM = OPR.DUPNUM(+)
	   AND MST.CMPCOD = HSE.CMPCOD(+)
	   AND MST.DOCOWRIDR = HSE.DOCOWRIDR(+)
	   AND MST.MSTDOCNUM = HSE.MSTDOCNUM(+)
	   AND MST.DUPNUM = HSE.DUPNUM(+)
	   AND MST.SEQNUM = HSE.SEQNUM(+)

	   AND OPR.CMPCOD = ARP.CMPCOD(+)
	   AND OPR.DOCOWRIDR = ARP.DOCOWRIDR(+)
	   AND OPR.MSTDOCNUM = ARP.MSTDOCNUM(+)
	   AND OPR.DUPNUM = ARP.DUPNUM(+)
	   AND OPR.SEQNUM = ARP.SEQNUM(+)
	   AND OPR.ACPARPCOD = ARP.ARPCOD(+)
		

	    AND OPR.DOCOWRIDR = FLT.DOCOWRIDR(+)
	   AND OPR.MSTDOCNUM = FLT.MSTDOCNUM(+)
	   AND OPR.DUPNUM = FLT.DUPNUM(+)
	   AND OPR.SEQNUM = FLT.SEQNUM(+)
	   AND OPR.CMPCOD = FLT.CMPCOD(+)

	   AND HSE.TXNCOD(+) = ?
	   AND MST.CMPCOD = ?
	   AND MST.DOCOWRIDR = ?
	   AND MST.MSTDOCNUM = ?
	   AND MST.DUPNUM = ?
	   ORDER BY  MST.DOCOWRIDR, MST.MSTDOCNUM, MST.DUPNUM,MST.SEQNUM
	]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>3</QRY:Id>
<QRY:Source Name="operations.shipment.findawbacceptancedetails" Type="NATIVE">
	<![CDATA[

	SELECT DTL.SEQNUM, DTL.DUPNUM, DTL.MSTDOCNUM, DTL.DOCOWRIDR, DTL.CMPCOD,
	       DTL.ACPIDR, DTL.WHSCOD, DTL.LOCCOD, DTL.ACPPCS, DTL.ACPWGT,
	       DTL.ACPWGTCOD, DTL.ACPVOL, DTL.CMDITMNAM, DTL.ACPDISWGT, DTL.SHPACPTIM,
		   MST.SHPDES, MST.STDPCS, MST.STDWGT,
		   DTL.LSTUPDTIM ACPLSTUPDTIM, DTL.LSTUPDUSR ACPLSTUPDUSR,
		   MST.LSTUPDTIM SHPMSTLSTUPDTIM, MST.LSTUPDUSR SHPMSTLSTUPDUSR, DTL.ARPCOD
	  FROM OPRSHPACPDTL DTL, OPRSHPMST  MST
	 WHERE DTL.CMPCOD = MST.CMPCOD
	   AND DTL.DOCOWRIDR = MST.DOCOWRIDR
	   AND DTL.MSTDOCNUM = MST.MSTDOCNUM
	   AND DTL.DUPNUM = MST.DUPNUM
	   AND DTL.SEQNUM = MST.SEQNUM
	   AND DTL.CMPCOD = ?
	   AND DTL.DOCOWRIDR = ?
	   AND DTL.MSTDOCNUM = ?
	   

   	]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>4</QRY:Id>
<QRY:Source Name="operations.shipment.finduldacceptancedetails" Type="NATIVE">
	<![CDATA[
		SELECT DTL.SEQNUM, DTL.DUPNUM, DTL.MSTDOCNUM, DTL.DOCOWRIDR, DTL.CMPCOD,
	       DTL.WHSCOD, DTL.LOCCOD, DTL.ULDNUM, DTL.ULDWGT, DTL.ULDWGTCOD,
	       DTL.ACPPCS, DTL.ULDDISWGT, DTL.ULDCTR, DTL.ULDACPTIM, MST.SHPDES, MST.STDPCS, MST.STDWGT,
	       ULDACP.WHSCOD, ULDACP.LOCCOD, ULDACP.GRSWGT,
	       ULDACP.GRSDISWGT, ULDACP.GRSWGTCOD, ULDACP.TARWGT, ULDACP.TARDISWGT,
	       ULDACP.TARWGTCOD, ULDACP.FLTCARIDR, ULDACP.FLTNUM, ULDACP.FLTSEQNUM,
	       ULDACP.SEGSERNUM, ULDACP.FLTDAT, ULDACP.RATTYP, ULDACP.ACPUSR,
	       ULDACP.ACPDAT, ULDACP.POU, NVL (ULDACP.SERNUM, 0) ULDACPSERNUM,
		   ULDACP.LSTUPDTIM ULDACPLSTUPDTIM, ULDACP.LSTUPDUSR ULDACPLSTUPDUSR,
		   MST.LSTUPDTIM MSTLSTUPDTIM,DTL.LSTUPDTIM DTLLSTUPDTIM,DTL.ARPCOD
	  FROM OPRULDACPDTL DTL,
	  	   OPRSHPMST MST,
		   OPRULDACP ULDACP
	 WHERE DTL.CMPCOD = MST.CMPCOD
	   AND DTL.DOCOWRIDR = MST.DOCOWRIDR
	   AND DTL.MSTDOCNUM = MST.MSTDOCNUM
	   AND DTL.DUPNUM = MST.DUPNUM
	   AND DTL.SEQNUM = MST.SEQNUM
	   AND DTL.CMPCOD = ULDACP.CMPCOD(+)
	   AND DTL.ULDNUM = ULDACP.ULDNUM(+)
	   AND DTL.ARPCOD = ULDACP.ARPCOD(+)
	   AND DTL.ULDSERNUM = ULDACP.SERNUM(+)
	   AND DTL.CMPCOD = ?
	   AND DTL.ARPCOD = ? 
	   AND DTL.DOCOWRIDR = ?
	   AND DTL.MSTDOCNUM = ?
	   AND DTL.DUPNUM = ?
   ]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>5</QRY:Id>
<QRY:Source Name="operations.shipment.findpiecesfortransaction" Type="NATIVE">
	<![CDATA[
				SELECT OPRTXNHIS.CMPCOD, OPRTXNHIS.DOCOWRIDR,
				       OPRTXNHIS.MSTDOCNUM, OPRTXNHIS.DUPNUM,
				       OPRTXNHIS.SEQNUM, OPRTXNHIS.GRPIDR PCSIDR,
				       OPRTXNHIS.ARPCOD,
				       OPRTXNHIS.TXNCOD, OPRTXNHIS.TXNREFEGT,
				       OPRTXNHIS.TXNREFNIN, OPRTXNHIS.TXNREFTEN
				  FROM  OPRSHPTXNPCSGRPHIS OPRTXNHIS,
				  		OPRSHPPCSGRP OPRSHPCS
				 WHERE OPRTXNHIS.CMPCOD = OPRSHPCS.CMPCOD
				   AND OPRTXNHIS.DOCOWRIDR = OPRSHPCS.DOCOWRIDR
				   AND OPRTXNHIS.MSTDOCNUM = OPRSHPCS.MSTDOCNUM
				   AND OPRTXNHIS.DUPNUM = OPRSHPCS.DUPNUM
				   AND OPRTXNHIS.SEQNUM = OPRSHPCS.SEQNUM
				   AND OPRTXNHIS.PCSIDR = OPRSHPCS.PCSIDR
				    AND OPRTXNHIS.CMPCOD = ?
				    AND OPRTXNHIS.DOCOWRIDR = ?
				    AND OPRTXNHIS.MSTDOCNUM = ?
				    AND OPRTXNHIS.DUPNUM = ?
				    AND OPRTXNHIS.SEQNUM = ?
				    AND OPRTXNHIS.ARPCOD = ?
				    AND OPRTXNHIS.TXNCOD = ?



	]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>6</QRY:Id>
<QRY:Source Name="operations.shipment.findacceptanceenquirydetails" Type="NATIVE">
	<![CDATA[
	(SELECT /*+ FIRST_ROWS(25) */ MST.CMPCOD CMPCOD, MST.DOCOWRIDR OWRIDR, MST.SHPPFX AWBPFX,MST.STDPCS,
			MST.DUPNUM DUPNUM, MST.SEQNUM SEQNUM, MST.MSTDOCNUM AWBNUM,
			MST.UBRNUM UBRNUM, MST.ORGCOD ORG, MST.DSTCOD DST,
			MST.SCCCOD SCC, MST.AGTCOD AGTCOD, MST.SHPNAM SHPNAM,
			SHPDTL.ACPDAT ACPDAT, ' ' ULDNUM, SHPACPDTL.CMDITMNAM CMDITMNAM,
			SHPACPDTL.WHSCOD WHSCOD, SHPACPDTL.LOCCOD LOCCOD,
			SHPACPDTL.ACPPCS ACPPCS, SHPACPDTL.ACPWGT ACPWGT, SHPACPDTL.ACPVOL ACPVOL, SHPACPDTL.ARPCOD
		FROM OPRSHPMST  MST,OPRSHPDTL SHPDTL, OPRSHPACPDTL SHPACPDTL
	]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>7</QRY:Id>
<QRY:Source Name="operations.shipment.findsourcetransactions" Type="NATIVE">
	<![CDATA[
	SELECT SRCTXNCOD FROM OPRSHPSRCTXN WHERE TXNCOD = ?
	]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>8</QRY:Id>
<QRY:Source Name="operations.shipment.findprevioustransactionsfromhistory" Type="NATIVE">
	<![CDATA[
	SELECT CMPCOD,ARPCOD,DOCOWRIDR,MSTDOCNUM,
	DUPNUM,SEQNUM,TXNCOD,TXNHISIDR,HIS.GRPIDR PCSIDR,TXNREFONE,
	TXNREFTWO,TXNREFTHR,TXNREFFOR,TXNREFFIV,TXNREFSEV,TXNREFSIX,
	TXNREFEGT,TXNREFNIN,TXNREFTEN
	FROM OPRSHPTXNPCSGRPHIS HIS
	WHERE CMPCOD=? 
		  
	  	
	]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>9</QRY:Id>
<QRY:Source Name="operations.shipment.findtransactionpriorities" Type="NATIVE">
	<![CDATA[
	SELECT TXNCOD,TXNNAM,TXNPRT
	FROM OPRTXNPRT
	ORDER BY TXNPRT  DESC
	]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>10</QRY:Id>
<QRY:Source Name="operations.shipment.findshipmentpieces" Type="NATIVE">
	<![CDATA[
		SELECT SHPPCS.CMPCOD, SHPPCS.DOCOWRIDR,
		       SHPPCS.MSTDOCNUM, SHPPCS.DUPNUM,
		       SHPPCS.SEQNUM, SHPPCS.GRPIDR PCSIDR,
		       SHPPCS.PCSWGT,
		       SHPPCS.PCSVOL
		  FROM
		  		OPRSHPPCSGRP SHPPCS
		 WHERE
		 		SHPPCS.CMPCOD = ?
			AND SHPPCS.DOCOWRIDR = ?
			AND SHPPCS.MSTDOCNUM = ?
			AND SHPPCS.DUPNUM = ?
			AND SHPPCS.SEQNUM = ?
	]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>11</QRY:Id>
<QRY:Source Name="operations.shipment.findnonstandardshipments" Type="NATIVE">
	<![CDATA[
		SELECT MST.DOCOWRIDR,MST.DUPNUM ,MST.SEQNUM,MST.CMPCOD,
		IDX.SHPPFX,MST.MSTDOCNUM,MST.DOCTYP,MST.DOCNUM,
		MST.CPTDAT,MST.CNSCOD,MST.ORGCOD,STDDISWGT,
		MST.DSTCOD,MST.SHPSTA,MST.UBRNUM,MST.SHPTYP,MST.CONFLG,IDX.OWRCOD,MST.PARSEQNUM,
		MST.LSTUPDUSR, MST.LSTUPDTIM
		FROM OPRSHPIDX IDX,OPRSHPMST  MST
		WHERE
		MST.DOCOWRIDR=IDX.DOCOWRIDR AND
		MST.CMPCOD=IDX.CMPCOD AND
		MST.DUPNUM=IDX.DUPNUM AND
		MST.MSTDOCNUM=IDX.MSTDOCNUM AND
		MST.CMPCOD=? AND
		MST.DOCNUM=?
	]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>12</QRY:Id>
<QRY:Source Name="operations.shipment.findshipmentdetails" Type="NATIVE">
<!--Edited Query By A-5901 to add executed user details  last name for BUG ICRD-81177 on 12 Aug 2014  -->
<!--Edited Query By E-1190 for Performance issue, Please without prior verification from LATISH donot add any joins
All Many to Many Relations should be fetched separately refer rating details
  -->
	<![CDATA[
	SELECT MST.MSTDOCNUM,
			  MST.CMPCOD MSTCMPCOD,
			  MST.DOCOWRIDR MSTDOCOWRIDR,
			  MST.CPTDAT MSTCPTDAT,
			  MST.DUPNUM MSTDUPNUM,
			  MST.SEQNUM MSTSEQNUM,
			  MST.DOCNUM,
			  ACC.JRNDAT,
			  MST.PLTFLG,
			  MST.SHPBNDFLG,
			  MST.DOCTYP,
			  MST.PARSEQNUM,
			  MST.RFCFLG,
			  MST.CRAIMPFLG,
			  MST.SHPPFX,
			  MST.SHPSTA,
			  MST.SHPTYP,
			  MST.UBRNUM,
			  MST.CONFLG,
			  MST.HSEFINFLG,
			  MST.EHMFLG,
			  ACC.IATCOD,
			  MST.DOCOWRIDR,
			  CNT.CNSACCNUM,
			  MST.CNSADRONE,
			  CNT.CNSADRTWO,
			  MST.CNSCOD,
			  CNT.CNSCTR,
			  CNT.CNSCTY,
			  CNT.CNSMALIDR,
			  MST.CNSNAM,
			  CNT.CNSPRTNFNFLG,
			  CNT.CNSPSTCOD,
			  CNT.CNSSTT,
			  CNT.CNSTELNUM,
			  CNT.SHPACCNUM,
			  MST.SHPADRONE,
			  CNT.SHPADRTWO,
			  MST.SHPCOD,
			  CNT.SHPCTR,
			  CNT.SHPCTY,
			  CNT.SHPMALIDR,
			  MST.SHPNAM,
			  CNT.SHPPSTCOD,
			  MST.SHPSTA,
			  CNT.SHPSTT,
			  CNT.SHPTELNUM,
			  CNT.NFYACCNUM,
			  CNT.NFYADRONE,
			  CNT.NFYADRTWO,
			  MST.NFYCOD,
			  CNT.NFYCTR,
			  CNT.NFYCTY,
			  CNT.NFYMALIDR,
			  MST.NFYNAM,
			  CNT.NFYPSTCOD,
			  CNT.NFYSTT,
			  CNT.NFYTELNUM,
			  MST.RATCUSCOD,
			  MST.AGTCOD,
			  MST.AGTNAM,
			  ACC.CASCOD,
			  MST.SCCCOD,
			  MST.DTACPTFLG,
			  MST.STDDISWGT,
			  MST.STDPCS,
			  MST.STDWGT,
			  MST.STDWGTCOD,
			  MST.HDLINF,
			  MST.SHPDES,
			  MST.ORGCOD,
			  MST.DSTCOD,
			  MIS.SCICOD,
			  MIS.REQRTG,
			  MIS.AGTSIG,
			  MST.SPTRATIDR,
			  MST.PAYTYP MSTPAYTYP,
			  ACC.DVLCUS,
			  ACC.DVLCAR,
			  MST.CURCOD,
			  MST.EXEUSRCOD EXEUSRCOD,
			  MST.EXESTN,
			  MST.EXEFLG,
			  MST.EXEDAT,
			  MST.DOMFLG,
			  ACC.ACCINF,
			  ACC.INSMINAMT,
			  ACC.INSAMT,
			  mst.PRDNAM,
			  mst.PRDPRT,
			  ACC.OTHPAYTYP ACCOTHPAYTYP,
			  MIS.TRTMOD,
			  ACC.RATCONIDR,
			  mst.PRDCOD,
			  MIS.SHPINFONE,
			  MIS.SHPINFTWO,
			  MIS.SNDFILREF MISSNDFILREF,
			  ACC.SRVCRGCLS,
			  ACC.TOTDUECARPPCHG,
			  ACC.TOTDUECARCCCHG,
			  ACC.SALINCCASIND ACCSALINCCASIND,
			  ACC.SALINCAMT ACCSALINCAMT,
			  MIS.PRMTYP,
			  MIS.LSTEVLDAT,
			  MIS.QTNREVNUM,
			  MIS.EVLTYP,
			  ACC.TOTARLCHG,
			  ACC.JNTREV,
			  ACC.GSCCMS,
			  ACC.GSCADLCMS,
			  ACC.PAYMOD ACCPAYMOD,
			  ACC.TOTDUEAGTPPCHG,
			  ACC.TOTDUEAGTCCCHG,
			  ACC.WGTPPCHG,
			  ACC.WGTCCCHG,
			  ACC.DSTCNVRAT ACCDSTCNVRAT,
			  ACC.DSTCURCOD ACCDSTCURCOD,
			  ACC.DSTCCFCHG ACCDSTCCFCHG,
			  ACC.TOTDSTCCFCHG ACCTOTDSTCCFCHG,
			  ACC.VALPPCHG,
			  ACC.VALCCCHG,
			  ACC.TAXPPD,
			  ACC.TAXCCF,
			  ACC.AGTACCNUM ACCAGTACCNUM,
			  MST.GRSVOL,
			  MST.GRSDISVOL,
			  MST.GRSVOLUNT,
			  ACC.TOTPPD,
			  ACC.TOTCCF,
			  ACC.CSHFLG,
			  MST.OWRCOD,
			  ACC.SPTRAT,
			  ACC.SPTRATAPRDAT,
			  ACC.SPTRATREQDAT,
			  ACC.SPTRATSTA,
			  ACC.CMSPPD,
			  ACC.CMSCCF,
			  MST.SLCPCS SLCPCS,
			  MST.RDYCRGFLG,
			  MIS.REQFLT REQFLT,
			  MIS.CRSREFONE CRSREFONE,
			  MIS.CRSREFTWO CRSREFTWO,
			  ACC.UNQREFONE UNQREFONE,
		  (SELECT COUNT(1)
		  FROM OPRSHPDOCDTL DOCDTL
		  WHERE MST.CMPCOD  = DOCDTL.CMPCOD
		  AND MST.MSTDOCNUM = DOCDTL.MSTDOCNUM
		  AND MST.DOCOWRIDR = DOCDTL.DOCOWRIDR
		  AND MST.DUPNUM    = DOCDTL.DUPNUM
		  AND MST.SEQNUM    = DOCDTL.SEQNUM
		  ) SHPDOCCNT,
			  ACC.UNQREFTWO UNQREFTWO,
			  ACC.UNQREFTHR UNQREFTHR,
			  ACC.CMSAMT ACCCMSAMT,
			  ACC.CMSPCT ACCCMSPCT,
			  ACC.UNQREFFOR UNQREFFOR,
			  ACC.UNQREFFIV UNQREFFIV,
			  FLT.FLTDAT FLTFLTDAT,
			  ACC.HGRWGTBRK,
			  FLT.DUPNUM FLTDUPNUM,
			  FLT.SEGSERNUM FLTSEGSERNUM,
			  FLT.FLTNUM FLTFLTNUM,
			  FLT.DOCOWRIDR FLTDOCOWRIDR,
			  FLT.SEQNUM FLTSEQNUM,
			  FLT.FLTCARIDR FLTFLTCARIDR,
			  FLT.RTGSERNUM FLTRTGSERNUM,
			  FLT.RTESEQNUM FLTRTESEQNUM,
			  FLT.FLTSEQNUM FLTFLTSEQNUM,
			  FLT.MSTDOCNUM FLTMSTDOCNUM,
			  FLT.DSTCOD RTGDSTCOD,
			  FLT.FLTCARCOD FLTFLTCARCOD,
			  FLT.CMPCOD FLTCMPCOD,
			  FLT.DSTCOD FLTDSTCOD,
			  DCL.CMPCOD DCLCMPCOD,
			  DCL.DOCOWRIDR DCLDOCOWRIDR,
			  DCL.MSTDOCNUM DCLMSTDOCNUM,
			  DCL.DUPNUM DCLDUPNUM,
			  DCL.SEQNUM DCLSEQNUM,
			  DCL.SHPDCLCOD,
			  DCL.SHPDES DCLSHPDES,
			  DCL.RMK DCLRMK,
			  NFY.CMPCOD NFYCMPCOD,
			  NFY.DOCOWRIDR NFYDOCOWRIDR,
			  NFY.MSTDOCNUM NFYMSTDOCNUM,
			  NFY.DUPNUM NFYDUPNUM,
			  NFY.SEQNUM NFYSEQNUM,
			  NFY.NFYCOD NFYNFYCOD,
			  NFY.NFYNAM NFYNFYNAM,
			  NFY.NFYTELNUM NFYNFYTELNUM,
			  NFY.NFYMALIDR NFYNFYMALIDR,
			  NFY.NFYADRONE NFYNFYADRONE,
			  NFY.NFYADRTWO NFYNFYADRTWO,
			  NFY.NFYCTY NFYNFYCTY,
			  NFY.NFYSTT NFYNFYSTT,
			  NFY.NFYCTR NFYNFYCTR,
			  NFY.NFYPSTCOD NFYNFYPSTCOD,
			  NFY.PRTNFNFLG NFYPRTNFNFLG,
			  NFY.NFYMOD NFYNFYMOD,
			  NFY.NFYTELNUM NFYNFYTELNUM,
			  NFY.NFYCTY NFYNFYCTY,
			  NFY.NFYACCNUM NFYNFYACCNUM,
			  ARPSHP.ACPPCS - ARPSHP.TOTDLVPCS TOTACPPCS,
			  ARPSHP.ACPWGT - ARPSHP.TOTDLVWGT TOTACPWGT,
			  ARPSHP.ACPVOL TOTACPVOL,
			  DTL.DRPOFFDAT,
			  DTL.PLTUSEFLG,
			  MST.SRCIND,
			  SRV.CMPCOD SRVCMPCOD,
			  DTL.APRFLG,
			  DTL.ACPFNLFLG,
			  DTL.ACPDAT,
			  COALESCE(DTL.ACPARPCOD,ARPSHP.ARPCOD) ACPARPCOD,
			  SRV.DOCOWRIDR SRVDOCOWRIDR,
			  SRV.DUPNUM SRVDUPNUM,
			  SRV.MSTDOCNUM SRVMSTDOCNUM,
			  SRV.SEQNUM SRVSEQNUM,
			  SRV.SRVCOD SRVCOD,
			  MST.MISMTH,
			  MST.STKHLDCOD,
			  MST.CAOFLG,
			  MST.LSTUPDTIM MSTLSTUPDTIM,
			  MST.LSTUPDUSR MSTLSTUPDUSR,
			  ARPSHP.LSTUPDTIM ARPSHPLSTUPDTIM,
			  ARPSHP.LSTUPDUSR ARPSHPLSTUPDUSR,
			  MST.CHGCOD,
			  MIS.CHRTRFLG,
			  ACC.RATCONSTA,
			  MIS.REQFLTSEQNUM REQFLTSEQNUM,
			  MIS.REQFLTCARIDR REQFLTCARIDR,
			  MIS.AGTREF MISAGTREF,
			  MIS.REQFLTDAT REQFLTDAT,
			  MIS.REQFLTCARCOD REQFLTCARCOD,
			  MIS.SHPSIG,
			  MIS.NOMHDLPTYPLC,
			  MIS.NOMHDLPTY,
			  MIS.REQFLTNUM REQFLTNUM,
			  MIS.BOE BOE,
			  ACC.VFYEXEFLG,
			  ACC.ATOCMTTAX ACCATOCMTTAX,
			  ACC.MNLCPTFLG ACCMNLCPTFLG,
			  ACC.DSTEXGRATBSS ACCDSTEXGRATBSS,
			  ACC.DSTCURCNVDAT ACCDSTCURCNVDAT,
			  ADLCNT.CNTTYP,
			  ADLCNT.CNTADR,
			  MIS.BKGCRNDAT,
			  ADLCNT.CNTCTY,
			  ADLCNT.CNTCTR,
			  ADLCNT.CNTPSTCOD,
			  ADLCNT.CNTSTT,
			  ADLCNT.CNTTELNUM,
			  ADLCNT.CNSMALIDR,
			  ADLCNT.CNTERINUM,
			  ADLCNT.CTTCUSCOD CNTCOD,
			  ADLCNT.CTTCUSNAM CNTNAM,
			  SHPDCL.MSTDOCNUM SHPDCLDOCNUM,
			  SHPDCL.ADLHNDINF,
			  SHPDCL.DEPARPNAM,
			  SHPDCL.DSTARPNAM,
			  SHPDCL.SGNNAM,
			  SHPDCL.SGNTTL,
			  SHPDCL.SGNDAT,
			  SHPDCL.SGNPLC,
			   CUS.CSTAUTCOD,
			   CUS.PARTYP,
			  CUS.PARVAL,
			   CUS.SERNUM AS CUSSERNUM,
			   SPLREQ.SERNUM AS SHPSSRSERNUM,
			  SPLREQ.SPLSRVREQ,
			  BKGMST.SHPRDYTIM,
			  BKGMST.BKGROU,
			  BKGMST.STNCOD BKGSTNCOD,
			  MIS.EVTTIMUTC,
			  MIS.EVTINF,
			  CNT.AGTSTN AGTSTACOD,
			  ACC.SALINCAMT ACCSALINCAMT,
			  ACC.SALINCCASIND ACCSALINCCASIND,
			  CNT.AGTADR CNTAGTADR,
			  CNT.AGTCTR CNTAGTCTR,
			  CNT.AGTCTY CNTAGTCTY,
			  CNT.AGTPSTCOD CNTAGTPSTCOD,
			  CNT.AGTSTT CNTAGTSTT,
			  CNT.AGTCTY MISAGTPLC,
			  CNT.SHPSTN SHPSTNCOD,
			  CNT.CNSSTN CNSSTNCOD,
			  CNT.SHPREFNUM CNTSHPREFNUM,
			  CNT.SHPCFTNUM SHPCFTNUM,
			  CNT.SHPCFTTYP SHPCFTTYP,
			  CNT.SHPCSFNUM SHPCSFNUM,
			  MIS.SHPINFONE,
			  MIS.SHPINFTWO,
			  NFY.NFDSTN NFDSTNCOD,
			  MIS.LSTSHPSRC MISLSTSHPSRC,
			  MIS.LSTVERNUM,
			  FLTBOK.SERNUM FLTBOKSERNUM,
			  FLTBOK.CARIDR FLTBOKCARIDR,
			  FLTBOK.CARCOD FLTBOKCARCOD,
			  FLTBOK.FLTDAT FLTBOKFLTDAT,
			  FLTBOK.FLTNUM FLTBOKFLTNUM,
			  FLTBOK.SEGNUM FLTBOKSEGNUM,
			  FLTBOK.SEGORG FLTBOKSEGORG,
			  FLTBOK.SEGDST FLTBOKSEGDST,
			  MIS.LNKSHPPFX,
			  MIS.LNKMSTDOCNUM,
			  MIS.PKGTYP,
			  MIS.SHPBNDFLG MISSHPBNDFLG,
			  MST.EFTAWBFLG
			FROM OPRSHPMST MST,
		       OPRSHPRTG FLT,
		       OPRSHPDCL DCL,
		       OPRSHPNFY NFY,
		       OPRSHPDTL DTL,
		       OPRSHPSRV SRV,
		       OPRARPSHP ARPSHP,
		       OPRSHPMSTACC ACC,
		       OPRSHPMSTMIS MIS,
		       OPRSHPMSTCNT CNT,
               OPRSHPADLCNT ADLCNT,
           	   OPRSHPSHPDCL SHPDCL, 
			   OPRSHPCSTINF CUS,
			   OPRSHPSPLSRVREQ SPLREQ,
			   CAPBKGMST BKGMST,
			   OPRSHPFLTBOK FLTBOK,
				ADMUSRMST USRMST
		   WHERE  MST.DOCOWRIDR    = FLTBOK.DOCOWRIDR(+)
           AND MST.MSTDOCNUM    = FLTBOK.MSTDOCNUM(+)
           AND MST.DUPNUM       = FLTBOK.DUPNUM(+)
           AND MST.SEQNUM       = FLTBOK.SEQNUM(+)
           AND MST.CMPCOD       = FLTBOK.CMPCOD(+) 
	       AND MST.CMPCOD = ACC.CMPCOD
		   AND MST.DOCOWRIDR = ACC.DOCOWRIDR
		   AND MST.MSTDOCNUM = ACC.MSTDOCNUM
		   AND MST.DUPNUM = ACC.DUPNUM
		   AND MST.SEQNUM = ACC.SEQNUM
		   AND MST.CMPCOD = MIS.CMPCOD
		   AND MST.DOCOWRIDR = MIS.DOCOWRIDR
		   AND MST.MSTDOCNUM = MIS.MSTDOCNUM
		   AND MST.DUPNUM = MIS.DUPNUM
		   AND MST.SEQNUM = MIS.SEQNUM
		   AND MST.CMPCOD = CNT.CMPCOD
		   AND MST.DOCOWRIDR = CNT.DOCOWRIDR
		   AND MST.MSTDOCNUM = CNT.MSTDOCNUM
		   AND MST.DUPNUM = CNT.DUPNUM
		   AND MST.SEQNUM = CNT.SEQNUM
		   AND MST.CMPCOD = FLT.CMPCOD(+)
		   AND MST.DOCOWRIDR = FLT.DOCOWRIDR(+)
		   AND MST.MSTDOCNUM = FLT.MSTDOCNUM(+)
		   AND MST.DUPNUM = FLT.DUPNUM(+)
		   AND MST.SEQNUM = FLT.SEQNUM(+)
		   AND MST.CMPCOD = DTL.CMPCOD(+)
		   AND MST.DOCOWRIDR = DTL.DOCOWRIDR(+)
		   AND MST.MSTDOCNUM = DTL.MSTDOCNUM(+)
		   AND MST.DUPNUM = DTL.DUPNUM(+)
		   AND MST.SEQNUM = DTL.SEQNUM(+)
		   AND DTL.CMPCOD = ARPSHP.CMPCOD(+)
		   AND DTL.DOCOWRIDR = ARPSHP.DOCOWRIDR(+)
		   AND DTL.MSTDOCNUM = ARPSHP.MSTDOCNUM(+)
		   AND DTL.DUPNUM = ARPSHP.DUPNUM(+)
		   AND DTL.SEQNUM = ARPSHP.SEQNUM(+)
		   AND DTL.ACPARPCOD = ARPSHP.ARPCOD(+)
		   AND MST.CMPCOD = SRV.CMPCOD(+)
		   AND MST.DOCOWRIDR = SRV.DOCOWRIDR(+)
		   AND MST.MSTDOCNUM = SRV.MSTDOCNUM(+)
		   AND MST.DUPNUM = SRV.DUPNUM(+)
		   AND MST.SEQNUM = SRV.SEQNUM(+)
		   AND MST.CMPCOD = DCL.CMPCOD(+)
		   AND MST.DOCOWRIDR = DCL.DOCOWRIDR(+)
		   AND MST.MSTDOCNUM = DCL.MSTDOCNUM(+)
		   AND MST.DUPNUM = DCL.DUPNUM(+)
		   AND MST.SEQNUM = DCL.SEQNUM(+)
		   AND MST.CMPCOD = NFY.CMPCOD(+)
		   AND MST.DOCOWRIDR = NFY.DOCOWRIDR(+)
		   AND MST.MSTDOCNUM = NFY.MSTDOCNUM(+)
		   AND MST.DUPNUM = NFY.DUPNUM(+)
		   AND MST.SEQNUM = NFY.SEQNUM(+)
           AND MST.CMPCOD = ADLCNT.CMPCOD(+)
		   AND MST.DOCOWRIDR = ADLCNT.DOCOWRIDR(+)
		   AND MST.MSTDOCNUM = ADLCNT.MSTDOCNUM(+)
		   AND MST.DUPNUM = ADLCNT.DUPNUM(+)
		   AND MST.SEQNUM = ADLCNT.SEQNUM(+)
		   AND MST.CMPCOD = SHPDCL.CMPCOD(+)
		   AND MST.DOCOWRIDR = SHPDCL.DOCOWRIDR(+)
		   AND MST.MSTDOCNUM = SHPDCL.MSTDOCNUM(+)
		   AND MST.DUPNUM = SHPDCL.DUPNUM(+)
		   AND MST.SEQNUM = SHPDCL.SEQNUM(+)
			AND MST.CMPCOD        = CUS.CMPCOD(+)
			AND MST.DOCOWRIDR     = CUS.DOCOWRIDR(+)
			AND MST.MSTDOCNUM     = CUS.MSTDOCNUM(+)
			AND MST.DUPNUM        = CUS.DUPNUM(+)
			AND MST.SEQNUM        = CUS.SEQNUM(+)
		    AND MST.CMPCOD = SPLREQ.CMPCOD(+)
			AND MST.DOCOWRIDR     = SPLREQ.DOCOWRIDR(+)
			AND MST.MSTDOCNUM     = SPLREQ.MSTDOCNUM(+)
			AND MST.DUPNUM        = SPLREQ.DUPNUM(+)
			AND MST.SEQNUM        = SPLREQ.SEQNUM(+)
		   AND MST.CMPCOD = BKGMST.CMPCOD(+)
		   AND MST.UBRNUM = BKGMST.UBRNUM(+)
			AND MST.CMPCOD = USRMST.CMPCOD(+)
			AND MST.EXEUSRCOD = USRMST.USRCOD(+)
			
		]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>13</QRY:Id>
<QRY:Source Name="operations.shipment.findhouses" Type="NATIVE">
	<![CDATA[
		SELECT HSE.CMPCOD, HSE.MSTDOCNUM, HSE.DOCOWRIDR, HSE.DUPNUM, HSE.SEQNUM,
		       HSE.DOCNUM, HSE.HSEPTH,MST.orgcod,mst.stdwgtcod,mst.domflg,MST.agtcod,MST.agtnam,MST.owrcod, HSE.PARSEQNUM, MST.STDPCS, MST.STDWGT, MST.STDDISWGT,MST.SHPDES,MST.SRCIND,
           dimdtl.dimsernum, dimdtl.ratlinsernum, dimdtl.diswgt,DIMDTL.numpcs, dimdtl.pcshgt, dimdtl.pcslen, dimdtl.pcsvol,
           dimdtl.pcswid, dimdtl.wgt, dimdtl.wgtcod, dimdtl.tiltbl, dimdtl.lstupdtim, dimdtl.lstupdusr
		  FROM OPRSHPHSE HSE, OPRSHPMST  MST,OPRSHPDIMDTL DIMDTL
		 WHERE MST.CMPCOD = HSE.CMPCOD
		   AND MST.MSTDOCNUM = HSE.MSTDOCNUM
		   AND MST.DOCOWRIDR = HSE.DOCOWRIDR
		   AND MST.DUPNUM = HSE.DUPNUM
		   AND MST.SEQNUM = HSE.SEQNUM
		   AND MST.CMPCOD = DIMDTL.CMPCOD(+)
		   AND MST.MSTDOCNUM = DIMDTL.MSTDOCNUM(+)
		   AND MST.DOCOWRIDR = DIMDTL.DOCOWRIDR(+)
		   AND MST.DUPNUM = DIMDTL.DUPNUM(+)
		   AND MST.SEQNUM = DIMDTL.SEQNUM(+)
		   AND HSE.CMPCOD = ?
		   AND HSE.MSTDOCNUM = ?
		   AND HSE.DOCOWRIDR = ?
		   AND HSE.DUPNUM = ?
   		   AND HSE.PARSEQNUM = ?
	]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>14</QRY:Id>
<QRY:Source Name="operations.shipment.findratingdetails" Type="NATIVE">
	<![CDATA[
	SELECT
		RAT.CMPCOD RATCMPCOD, RAT.DOCOWRIDR RATDOCOWRIDR,
		RAT.MSTDOCNUM RATMSTDOCNUM,RAT.DUPNUM RATDUPNUM,RAT.IATRATCLSBSS,
		RAT.SEQNUM RATSEQNUM, RAT.RATLINSERNUM RATRATLINSERNUM, RAT.NUMPCS RATNUMPCS, RAT.RATCLSPER RATRATCLSPER, RAT.ULDRATCLSTYP RATULDRATCLSTYP, RAT.GRSWGTCOD RATGRSWGTCOD, RAT.CTRORG RATCTRORG,
		GRSWGT,GRSDISWGT,RAT.GRSVOL, CMDITMNUM, CMDITMNAM, IATRATCLS, ACTRATCLS, ARLRATCLS,RAT.ALLINNRATFLG,RAT.ALLINNATR,RAT.ACTALLINNRATFLG,RAT.ACTALLINNATR,
		IATRAT, ARLRAT, CHGWGT,
		 RATDES, ARLRATLINIDR,IATRATLINIDR, RAT.SCCCOD,
		 (select sccpry from shrsccmst sccmst where sccmst.scccod=rat.scccod and sccmst.cmpcod=rat.cmpcod) pry,
		 OVRFLWFLG,IATCOD,
		 IATCHG,NETCHG,DSCPCT,ALNBSECHG, ALNCHG, IATBSECHG,RAT.TAX,RAT.ARLTRFNAM,
		 RAT.IATTRFNAM,
		 RAT.ARLTRFSERNUM, RAT.IATTRFSERNUM,
		 RAT.ARLTRFRATSERNUM, RAT.IATTRFRATSERNUM,
		 RAT.IATULDTYP IATULDTYP,RAT.CRTREF,
		 RAT.NUMULD NUMULD,RAT.SRVCOD,RAT.RCP,RAT.ADJWGT,
		DIM.CMPCOD DIMCMPCOD,DIM.DOCOWRIDR DIMDOCOWRIDR,
		DIM.MSTDOCNUM DIMMSTDOCNUM,DIM.DUPNUM DIMDUPNUM,
		DIM.SEQNUM DIMSEQNUM,DIM.RATLINSERNUM,DIM.DIMSERNUM,DIM.TILTBL,
		DIM.PCSLEN,DIM.PCSHGT,DIM.PCSWID,DIM.PCSVOL,DIM.NUMPCS,DIM.WGT, DIM.DISWGT,MST.CURCOD,
		RAT.HRMCMDCOD,RAT.IATRATTYP,RAT.ARLRATTYP ,RAT.ADDARLRATLINIDS , RAT.TRKOALRATFLG ,RAT.MINCHGAPDFLG,RAT.TAXPCT,
		ULD.CMPCOD ULDCMPCOD,ULD.DOCOWRIDR ULDDOCOWRIDR,ULD.MSTDOCNUM ULDMSTDOCNUM,ULD.DUPNUM ULDDUPNUM,ULD.SEQNUM ULDSEQNUM,ULD.RATLINSERNUM ULDRATLINSERNUM,
		ULD.SERNUM ULDSERNUM, ULD.ULDNUM ULDNUM,ULD.SLCPCS ULDSLCPCS
	FROM OPRSHPRATDTL RAT,OPRSHPDIMDTL DIM,OPRSHPMST MST, OPRSHPRATULD ULD
	WHERE
		RAT.CMPCOD=DIM.CMPCOD(+) AND
		RAT.DOCOWRIDR=DIM.DOCOWRIDR(+) AND
		RAT.MSTDOCNUM=DIM.MSTDOCNUM(+) AND
		RAT.DUPNUM =DIM.DUPNUM(+) AND
		RAT.SEQNUM=DIM.SEQNUM(+) AND
		RAT.RATLINSERNUM=DIM.RATLINSERNUM(+) AND
		RAT.CMPCOD=MST.CMPCOD(+) AND
		RAT.DOCOWRIDR=MST.DOCOWRIDR(+) AND
		RAT.MSTDOCNUM=MST.MSTDOCNUM(+) AND
		RAT.DUPNUM =MST.DUPNUM(+) AND
		RAT.SEQNUM=MST.SEQNUM(+) 
		AND RAT.CMPCOD      =ULD.CMPCOD(+)
		AND RAT.DOCOWRIDR   =ULD.DOCOWRIDR(+)
		AND RAT.MSTDOCNUM   =ULD.MSTDOCNUM(+)
		AND RAT.DUPNUM      =ULD.DUPNUM(+)
		AND RAT.SEQNUM      =ULD.SEQNUM(+)
		AND RAT.RATLINSERNUM=ULD.RATLINSERNUM(+) AND
		RAT.CMPCOD=? AND
		RAT.DOCOWRIDR=? AND
		RAT.MSTDOCNUM=? AND
		RAT.DUPNUM =?  AND
		RAT.SEQNUM=?
	ORDER BY RAT.CMPCOD,RAT.DOCOWRIDR,RAT.MSTDOCNUM,RAT.RATLINSERNUM,RAT.DUPNUM,RAT.SEQNUM	]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>15</QRY:Id>
<QRY:Source Name="operations.shipment.findhawbdetails" Type="NATIVE">
	<![CDATA[
		SELECT
			MST.CMPCOD, MST.MSTDOCNUM, MST.DOCOWRIDR, MST.DUPNUM,
			MST.SEQNUM, MST.PARSEQNUM, MST.DOCNUM, MST.PLTFLG,
			MST.CONFLG, MST.ORGCOD, MST.DSTCOD,MST.SHPPFX,MST.EHMFLG,
			MST.STDPCS, MST.STDWGT,MST.GRSVOL STDVOL, MST.SHPCOD, MST.SHPNAM,
			MST.CNSCOD, MST.CNSNAM, MST.SHPDES, MST.HDLINF,MST.STDWGTCOD,
			HSE.HSEPTH,MST.STDDISWGT,MST.CNSADRONE, MST.SHPADRONE,
			MST.SLCPCS , MST.SCCCOD, MST.CURCOD, MST.PAYTYP,
			CNT.CNSADRTWO,CNT.CNSCTR,CNT.CNSCTY,CNT.CNSMALIDR,
			CNT.CNSPRTNFNFLG,CNT.CNSPSTCOD,CNT.CNSSTT,CNT.CNSTELNUM,
			CNT.SHPADRTWO,CNT.SHPCTR,CNT.SHPCTY,CNT.SHPMALIDR,CNT.SHPPSTCOD,
			CNT.SHPSTT,CNT.SHPTELNUM,CNT.CNSACCNUM,CNT.SHPACCNUM,
			MST.LSTUPDTIM MSTLSTUPDTIM, MST.LSTUPDUSR MSTLSTUPDUSR,
			HSE.LSTUPDTIM HSELSTUPDTIM, HSE.LSTUPDUSR HSELSTUPDUSR, MIS.MANUPD,
      DIMDTL.RATLINSERNUM,DIMDTL.DIMSERNUM,DIMDTL.DISWGT,DIMDTL.NUMPCS,
      DIMDTL.PCSHGT, DIMDTL.PCSLEN, DIMDTL.PCSVOL, DIMDTL.PCSWID, 
      DIMDTL.WGT,DIMDTL.WGTCOD, DIMDTL.TILTBL,DIMDTL.LSTUPDTIM,DIMDTL.LSTUPDUSR,
	  RAT.ARLRAT,RAT.CHGWGT,RAT.TAX, RAT.CMDITMNUM,RAT.CMDITMNAM,RAT.RATDES,RAT.HRMCMDCOD,RAT.GRSWGT RATGRSWGT,RAT.GRSVOL RATGRSVOL,RAT.IATRAT,RAT.NUMPCS RATNUMPCS,
  RAT.IATRATCLS,RAT.ACTRATCLS,RAT.ARLRATCLS,RAT.ARLRATLINIDR,RAT.IATRATLINIDR,RAT.ARLTRFNAM, RAT.IATTRFNAM,RAT.RCP,RAT.IATTRFSERNUM,RAT.ARLTRFSERNUM,
  RAT.ARLTRFRATSERNUM,RAT.IATTRFRATSERNUM,RAT.RATLINSERNUM RATRATLINSERNUM,RAT.SCCCOD RATSCCCOD,RAT.ARLRATTYP,RAT.IATRATTYP,RAT.OVRFLWFLG,
  RAT.ULDNUM,RAT.IATCOD,RAT.SRVCOD,RAT.ALNCHG,RAT.IATCHG,RAT.NETCHG,RAT.ALNBSECHG,RAT.IATBSECHG,RAT.DSCPCT,RAT.IATULDTYP,RAT.NUMULD,RAT.CRTREF,
  RAT.ACTARLRAT RATACTARLRAT,RAT.ACTCHGWGT RATACTCHGWGT,RAT.ACTCMDITMNUM RATACTCMDITMNUM,RAT.ACTGRSVOL RATACTGRSVOL,RAT.ACTIATRAT RATACTIATRAT,
  RAT.ARLRATTYP RATARLRATTYP,  RAT.ARLRATTYP RATARLRATTYP,RAT.CONFLG RATCONFLG,RAT.CTRORG RATCTRORG,RAT.DOCOWRIDR RATDOCOWRIDR,RAT.DSCPCT RATDSCPCT,
  RAT.DUPNUM RATDUPNUM,RAT.GRSDISWGT RATGRSDISWGT,RAT.GRSWGTCOD RATGRSWGTCOD,RAT.IATBSECHG RATIATBSECHG,RAT.LSTUPDTIM RATLSTUPDTIM,RAT.LSTUPDUSR RATLSTUPDUSR,
  RAT.MIPCOMNUM RATMIPCOMNUM,RAT.MIPCTRORN RATMIPCTRORN,RAT.MIPGODDES RATMIPGODDES,RAT.MIPGRSVOL RATMIPGRSVOL,RAT.MIPGRSWGTCOD RATMIPGRSWGTCOD,
  RAT.MIPHRMCMDCOD RATMIPHRMCMDCOD,RAT.MIPRATCLS RATMIPRATCLS,RAT.MIPSLAC RATMIPSLAC,RAT.MIPSRVCOD RATMIPSRVCOD,RAT.MIPULDNUM RATMIPULDNUM,RAT.MIPVOLCOD RATMIPVOLCOD,
  RAT.MSTDOCNUM RATMSTDOCNUM,RAT.OVRFLWFLG RATOVRFLWFLG,RAT.PARSERNUM RATPARSERNUM, RAT.RATLINSEQNUM RATRATLINSEQNUM,RAT.SHPTAXPCT, RAT.SLC,RAT.TAXBSSVAL,RAT.TAXPCT,
  RAT.ULDRATCLSTYP RATULDRATCLSTYP,RAT.ADDARLRATLINIDS,RAT.TRKOALRATFLG
		FROM OPRSHPMST  MST, OPRSHPHSE HSE,OPRSHPMSTCNT CNT, oprshpmstmis MIS,OPRSHPDIMDTL DIMDTL,OPRSHPRATDTL RAT
		WHERE
			MST.CMPCOD = HSE.CMPCOD
			AND MST.MSTDOCNUM = HSE.MSTDOCNUM
			AND MST.DOCOWRIDR = HSE.DOCOWRIDR
			AND MST.DUPNUM = HSE.DUPNUM
			AND MST.SEQNUM = HSE.SEQNUM
			AND MST.PARSEQNUM = HSE.PARSEQNUM

			AND MST.CMPCOD = CNT.CMPCOD
			AND MST.MSTDOCNUM = CNT.MSTDOCNUM
			AND MST.DOCOWRIDR = CNT.DOCOWRIDR
			AND MST.DUPNUM = CNT.DUPNUM
			AND MST.SEQNUM = CNT.SEQNUM

			AND MST.CMPCOD     = MIS.CMPCOD
			AND MST.MSTDOCNUM  = MIS.MSTDOCNUM
			AND MST.DOCOWRIDR  = MIS.DOCOWRIDR
			AND MST.DUPNUM     = MIS.DUPNUM
			AND MST.SEQNUM     = MIS.SEQNUM

			AND MST.CMPCOD    = RAT.CMPCOD(+)
			AND MST.MSTDOCNUM = RAT.MSTDOCNUM(+)
			AND MST.DOCOWRIDR = RAT.DOCOWRIDR(+)
			AND MST.DUPNUM    = RAT.DUPNUM(+)
			AND MST.SEQNUM    = RAT.SEQNUM(+)
			AND RAT.RATLINSERNUM(+)    = 1
			AND MST.CMPCOD          = ACC.CMPCOD
			AND MST.MSTDOCNUM       = ACC.MSTDOCNUM
			AND MST.DOCOWRIDR       = ACC.DOCOWRIDR
			AND MST.DUPNUM          = ACC.DUPNUM
			AND MST.SEQNUM          = ACC.SEQNUM
            AND MST.CMPCOD     = DIMDTL.CMPCOD(+)
			AND MST.MSTDOCNUM  = DIMDTL.MSTDOCNUM(+)
			AND MST.DOCOWRIDR  = DIMDTL.DOCOWRIDR(+)
			AND MST.DUPNUM     = DIMDTL.DUPNUM(+)
			AND MST.SEQNUM     = DIMDTL.SEQNUM(+)
			AND MST.CMPCOD     = RAT.CMPCOD(+)
			AND MST.MSTDOCNUM  = RAT.MSTDOCNUM(+)
			AND MST.DOCOWRIDR  = RAT.DOCOWRIDR(+)
			AND MST.DUPNUM     = RAT.DUPNUM(+)
			AND MST.SEQNUM     = RAT.SEQNUM(+) 
			AND	MST.CMPCOD = ?
	  		AND MST.MSTDOCNUM = ?
	  		AND MST.DOCOWRIDR = ?
	  		AND MST.DUPNUM = ?
	  		AND MST.PARSEQNUM = ?
        ORDER BY MST.SEQNUM,RAT.RATLINSERNUM,DIMDTL.RATLINSERNUM,DIMDTL.DIMSERNUM
	  		]]>
</QRY:Source>
</QRY:Definition>
<!--Modified by A-5116 for ICRD-23628 -->
<QRY:Definition>
<QRY:Id>16</QRY:Id>
<QRY:Source Name="operations.shipment.findshipmentmasterdetails" Type="NATIVE">
	<![CDATA[
		SELECT MST.CMPCOD,MST.PLTFLG, MST.DOMFLG,
  MST.STDPCS,
  MST.CURCOD,
  MST.AGTCOD,
  MST.AGTNAM,
  MST.STDWGT,
  MST.SCCCOD,
  MST.ORGCOD,
  MST.GRSVOL,
  MST.OWRCOD,
  MST.GRSDISVOL,
  MST.STDDISWGT,
  MST.SHPSTA,
  MST.EXEFLG,
  MST.SHPPFX,
  MST.OWRCOD,
  MST.SLCPCS,
  MST.DSTCOD,
  MST.CONFLG,
  MST.SHPTYP,
  MST.SEQNUM AS SHPSEQNUM,
  MST.DUPNUM AS SHPDUPNUM,
  MST.DOCOWRIDR,
  HSE.HSEPTH,
  DTL.PLTUSEFLG,
  MST.SHPDES,
  MST.SRCIND,
  MST.HSEFINFLG,
  MST.UBRNUM,
  MST.LSTUPDTIM,
  MST.STKHLDCOD,
  MST.DOCTYP,
  MIS.DOCSUBTYP,
  MST.MSTDOCNUM,
  MST.CPTDAT,
  MST.SHPNAM,
  MST.SHPADRONE,
  MST.CNSADRONE,
  MST.CNSNAM,
  MIS.JNVPAR, 
  CNT.CNSCTY,
  CNT.CNSSTT,
  CNT.CNSCTR,
  CNT.CNSPSTCOD,
  CNT.SHPCTY,
  CNT.SHPSTT,
  CNT.SHPCTR,
  CNT.SHPPSTCOD ,
  RTG.MSTDOCNUM RTGDOCNUM,
  RTG.FLTCARIDR,
  RTG.DSTCOD AS RTGDSTCOD,
  RTG.FLTCARCOD,
  RTG.RTGSERNUM,
  RTG.DUPNUM,
  CUSMSTCON.CUSGRP,
  MST.CNSCOD CUSCOD,
  MST.SHPCOD MSTSHPCOD,
  CUSMSTSHP.CUSGRP SHPGRP,
  CUSMSTSHP.CUSCOD SHPCOD,
  AGTGRP.GRPNAM AGTGRP,
    SHRMST.CNTCOD,
  (SELECT RTRIM(XMLAGG(XMLELEMENT(A, SHPRTG.DSTCOD,SHPRTG.FLTCARCOD
    ||' ')).EXTRACT('//text()'), ' ') DSTCOD
  FROM OPRSHPRTG SHPRTG
  WHERE SHPRTG.CMPCOD  = MST.CMPCOD
  AND SHPRTG.DOCOWRIDR = MST.DOCOWRIDR
  AND SHPRTG.MSTDOCNUM = MST.MSTDOCNUM
  AND SHPRTG.DUPNUM    = MST.DUPNUM
  AND SHPRTG.SEQNUM    = MST.SEQNUM
  ) AS RTGDSTCOD,
   (SELECT FLDDES STDWGTCODSES
		   FROM SHRONETIM SOT
		  WHERE SOT.CMPCOD=MST.CMPCOD
		 AND SOT.FLDTYP  ='shared.defaults.weightUnitCodes'
		  AND SOT.FLDVAL  =MST.STDWGTCOD
	 ) STDWGTCODSES  
FROM OPRSHPMST MST,
  OPRSHPMSTMIS MIS,
  OPRSHPHSE HSE,
  OPRSHPDTL DTL,
   OPRSHPRTG RTG,
  OPRSHPMSTCNT CNT,
  SHRGENMSTGRPDTL AGTGRP,
  SHRCUSMST CUSMSTCON,
  SHRCUSMST CUSMSTSHP,
  SHRARPMST SHRMST
WHERE MST.CMPCOD  = MIS.CMPCOD
          AND MST.MSTDOCNUM = MIS.MSTDOCNUM
	      AND MST.DOCOWRIDR = MIS.DOCOWRIDR
          AND MST.DUPNUM = MIS.DUPNUM
	      AND MST.SEQNUM = MIS.SEQNUM
			  AND MST.Cmpcod    = Rtg.Cmpcod(+)
			And Mst.Mstdocnum = Rtg.Mstdocnum(+)
			And Mst.Docowridr = Rtg.Docowridr(+)
			And Mst.Seqnum    = Rtg.Seqnum(+)
			AND MST.Dupnum    = Rtg.Dupnum(+)
	      AND MST.CMPCOD = HSE.CMPCOD(+)
	      AND MST.MSTDOCNUM = HSE.MSTDOCNUM(+)
	      AND MST.DOCOWRIDR = HSE.DOCOWRIDR(+)
	      AND MST.DUPNUM = HSE.DUPNUM(+)
	      AND MST.SEQNUM = HSE.SEQNUM(+) 
		  AND MST.CMPCOD = DTL.CMPCOD(+)
	      AND MST.MSTDOCNUM = DTL.MSTDOCNUM(+)
	      AND MST.DOCOWRIDR = DTL.DOCOWRIDR(+)
	      AND MST.DUPNUM = DTL.DUPNUM(+)
	      AND MST.SEQNUM = DTL.SEQNUM(+)
AND MST.CMPCOD    = CNT.CMPCOD(+)
AND MST.MSTDOCNUM = CNT.MSTDOCNUM(+)
AND MST.DOCOWRIDR = CNT.DOCOWRIDR(+)
AND MST.DUPNUM    = CNT.DUPNUM(+)
AND MST.SEQNUM    = CNT.SEQNUM(+)
	AND MST.CMPCOD = CUSMSTCON.CMPCOD(+)
	AND MST.CNSCOD = CUSMSTCON.CUSCOD(+)
	AND MST.CMPCOD = CUSMSTSHP.CMPCOD(+)
	AND MST.SHPCOD = CUSMSTSHP.CUSCOD(+)
	AND MST.CMPCOD = AGTGRP.CMPCOD(+)
	AND MST.AGTCOD = AGTGRP.GRPENT(+)
	AND AGTGRP.GRPCATCOD(+) = 'GEN'
	  AND MST.CMPCOD      = SHRMST.CMPCOD(+)
  AND MST.ORGCOD      =  SHRMST.ARPCOD(+)
	      AND MST.CMPCOD =?
	      AND MST.MSTDOCNUM = ?
	      AND MST.DOCOWRIDR = ?
	      AND MST.DUPNUM = ?
              AND MST.SEQNUM = ?
	]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>17</QRY:Id>
<QRY:Source Name="operations.shipment.findhawbpiecedetails" Type="NATIVE">
	<![CDATA[
		SELECT CMPCOD, DOCOWRIDR, MSTDOCNUM, DUPNUM, SEQNUM, PCSGRP.GRPIDR   PCSIDR
		FROM OPRSHPPCSGRP PCSGRP
		WHERE   CMPCOD =?
				AND  DOCOWRIDR =?
				AND  MSTDOCNUM =?
				AND  DUPNUM =?
				AND  SEQNUM =?
	]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>344</QRY:Id>
<QRY:Source Name="operations.shipment.findccahistory" Type="NATIVE">
	<![CDATA[
		SELECT CCA.CMPCOD, CCA.DOCOWRIDR, CCA.SHPPFX, CCA.MSTDOCNUM, CCA.DUPNUM, CCA.SEQNUM,
		CCA.CCAREFNUM, CCA.ORGSHPNAM, CCA.ORGCNSNAM, CCA.REVGRSWGT, CCA.ORGGRSWGT,
		CCA.REVWGTCHG, CCA.REVVALCHG, CCA.REVTAX, CCA.REVTOTDUEAGTCHG, CCA.REVTOTDUECARCHG,
		CCA.REVTOTPPD, CCA.REVTOTCCF, CCA.ORGWGTCHG, CCA.ORGVALCHG, CCA.ORGTAX,
		CCA.ORGTOTDUEAGTCHG, CCA.ORGTOTPPD, CCA.ORGTOTCCF, CCA.ORGTOTDUECARCHG,				
		
		CCA.CORNUM, CCA.ORGPAYTYPFRT, CCA.REVCURCOD, CCA.ORGCURCOD, CCA.BLGCEN, CCA.AGTSTN, CCA.CORUSR, CCA.CORTYP,
        CCA.CORDAT, CCA.CCAIND, CCA.EXPIMPIND, CCA.CORRSN, CCA.CORRMK, CCA.CCAISSDAT, CCA.CCAISSSTN, CCA.ACPUSR,
        CCA.ACPRMK, CCA.DOCIDR, CCA.ARCIDR, CCA.ORGAGTCNTCOD, CCA.INTMISDTL, CCA.VERNUM,
		CCA.LSTUPDTIM, CCA.LSTUPDUSR, CCA.SHPVERNUM
		FROM OPRSHPCCAHIS CCA
		WHERE CMPCOD = ?
	]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>18</QRY:Id>
<QRY:Source Name="operations.shipment.findcca" Type="NATIVE">
	<![CDATA[
		SELECT CCA.CMPCOD, CCA.DOCOWRIDR, MST.SHPPFX, CCA.MSTDOCNUM, CCA.DUPNUM, CCA.SEQNUM,
		CCA.CCAREFNUM, CCA.ORGSHPNAM, CCA.ORGCNSNAM, CCA.REVGRSWGT, CCA.ORGGRSWGT,CCA.REVCNSNAM,CCA.REVCNSNAM,CCA.REVSHPNAM,CCA.ORGAGTCNTCOD,CCA.REVAGTCNTCOD,
		CCA.REVWGTCHG, CCA.REVVALCHG, CCA.REVTAX, CCA.REVTOTDUEAGTCHG, CCA.REVTOTDUECARCHG,
		CCA.REVTOTPPD, CCA.REVTOTCCF, CCA.ORGWGTCHG, CCA.ORGVALCHG, CCA.ORGTAX,CCA.REVCURCOD,
		CCA.ORGTOTDUEAGTCHG, CCA.ORGTOTPPD, CCA.ORGTOTCCF, CCA.ORGTOTDUECARCHG,CCA.ORGVOLWGT,CCA.REVVOLWGT,CCA.ACPUSR,
		CCA.REVCHGWGT,CCA.ORGCHGWGT,CCA.ORGWGTCHG,CCA.REVWGTCHG,CCA.ORGSHPCOD,CCA.ORGCNSCOD,CCA.ORGCURCOD,CCA.REVSHPCOD,CCA.REVCNSCOD,
		CCA.ORGAGTCOD,CCA.REVAGTCOD,CCA.ORGAGTNAM,CCA.REVAGTNAM,CCA.ORGAGTCOD,CCA.REVAGTCOD,CCA.ORGIATCOD,CCA.REVIATCOD,CCA.CORRMK,CCA.CCAIND,CCA.CCASTA,
		CCA.ORGCNSACCNUM,CCA.ORGSHPACCNUM,CCA.REVCNSACCNUM,CCA.REVSHPACCNUM,MST.EXEDAT,CCA.REVCNSCOD,CCA.REVSHPCOD,CCA.ORGCNSCOD,CCA.LSTUPDTIM,CCA.LSTUPDUSR, CCA.CCAISSDAT, CCA.CCAISSSTN,CCA.CORNUM,CCA.ORGCNSACCNUM,CCA.ORGSHPACCNUM,CCA.REVCNSACCNUM,CCA.REVSHPACCNUM,MST.EXEDAT,CCA.REVCNSCOD,CCA.REVSHPCOD,CCA.ORGCNSCOD,CCA.LSTUPDTIM,CCA.LSTUPDUSR, CCA.CCAISSDAT, CCA.CCAISSSTN,CCA.CORNUM,CCA.REVMKTCHG,CCA.ORGMKTCHG,CCA.CORRSN,
		CCA.ORGSHPCOD,CCA.REVORGCOD,CCA.ORGORGCOD,CCA.REVDSTCOD,CCA.ORGDSTCOD,MST.EXESTN,CCA.SRCIND,CCA.SERNUM,CCA.ORGPAYTYPOTH,CCA.REVPAYTYPOTH,CCA.ORGPAYTYPFRT,CCA.REVPAYTYPFRT
		FROM OPRSHPCCA CCA, OPRSHPMST  MST
		WHERE
				MST.CMPCOD = CCA.CMPCOD
			AND MST.MSTDOCNUM = CCA.MSTDOCNUM
			AND MST.DOCOWRIDR = CCA.DOCOWRIDR
			AND MST.DUPNUM = CCA.DUPNUM
			AND MST.SEQNUM = CCA.SEQNUM
		   	AND MST.CMPCOD = ?
		
	]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>19</QRY:Id>
<QRY:Source Name="operations.shipment.finddangerousgoods" Type="NATIVE">
<!-- OPRSHPNTC is removed by E-1190 , Not required for Service and Screen loading  -->
	<![CDATA[
		SELECT DGR.CMPCOD,
		  DGR.DOCOWRIDR,
		  DGR.DUPNUM,
		  DGR.SPLATHFLG,
		  DGR.MSTDOCNUM,
		  DGR.NETQTY,
		  DGR.NUMPKG,
		  DGR.PKGGRP,
		  DGR.PKGINS,
		  DGR.PKGTYP,
		  DGR.SCCCOD,
		  DGR.SCCCODONE,
		  DGR.SCCCODTWO,
		  DGR.SEQNUM,
		  DGR.UNDSERNUM,
		  DGR.SERNUM,
		  DGR.UNIIDR,
		  DGR.PROSHPNAM,
		  DGR.ERGCOD,
		  DGR.TECNAM,
		  DGR.TPTIND,
		  DGR.NETQTYUNT,
		  DGR.ALLPCKSERNUM,
		  DGR.OVRPCKSERNUM,
		  DGR.NOOFOVRPACKS,
		  DGR.NOOFALLPACKS,
		  DGR.CARFLAG,
		  DGR.RMC,
		  DGR.PKGGRPRMC,
			  DGR.PSGNONLTDFBNFLG,
			  DGR.CRGFBNFLG,
			  DGR.PSGLTDNOTRESFLG,
			  DGR.PSGLTDMAXQTY,
		  DGR.RDOACTFLG,
		  DGR.SHPCLS,
		  DGR.SUBRSKONE,
		  DGR.SUBRSKTWO,
		  DGR.SUBRSKTHR,
		  DGR.TECNAMFLG,
		  DGR.AUTCOD,
		  DGR.DGQVAL,
		  DGR.UPDSRC,
		  DGR.SRTDES,
		  DGR.GRSINDCRG,
			  DGR.PKGDIMLEN,
			  DGR.PKGDIMHGT,
			  DGR.PKGDIMWID,
			  DGR.TOTTPTIND,
			  DGR.NETGRSIND,
			  DGR.PKGGRPDIMLEN,
			  DGR.PKGGRPDIMHGT,
			  DGR.PKGGRPDIMWID,
		  NCL.NCLNAM,
		  NCL.NCLVAL,
		  NCL.NCLUNT,
		  NCL.NCLSERNUM
				   FROM OPRSHPDGR  DGR  
				LEFT OUTER  JOIN OPRSHPDGRNCL NCL
				  ON DGR.CMPCOD = NCL.CMPCOD
				AND DGR.DOCOWRIDR = NCL.DOCOWRIDR
				AND DGR.MSTDOCNUM = NCL.MSTDOCNUM
				AND DGR.DUPNUM = NCL.DUPNUM
				AND DGR.SEQNUM = NCL.SEQNUM
				AND DGR.SERNUM = NCL.SERNUM
		WHERE 
		
	]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>19</QRY:Id>
<QRY:Source Name="operations.shipment.uld.finddangerousgoods" Type="NATIVE">
	<![CDATA[
		SELECT		DGR.CMPCOD, DGR.DOCOWRIDR, DGR.DUPNUM,DGR.MSTDOCNUM, DGR.NETQTY,DGR.NUMPKG, DGR.PKGGRP,
							DGR.PKGINS, DGR.PKGTYP,DGR.SCCCOD,DGR.SCCCODONE,DGR.SCCCODTWO,DGR.SUBRSKONE,DGR.SUBRSKTWO,DGR.SUBRSKTHR, DGR.SEQNUM, DGR.SERNUM,DGR.UNIIDR, DGR.PROSHPNAM,DGR.ERGCOD,
							DGR.TECNAM,DGR.TPTIND,DGR.NETQTYUNT,DGR.ALLPCKSERNUM,DGR.OVRPCKSERNUM,DGR.NOOFOVRPACKS,
							DGR.NOOFALLPACKS,DGR.CARFLAG,DGR.RMC, DGR.PKGGRPRMC,SHR.RDOACTFLG,SHR.SHPCLS,SHR.SUBRSK,SHR.TECNAMFLG,
							NTC.BDPPCS,NTC.SERNUM NTCSERNUM,NTC.ULDNUM
					    
				   FROM OPRSHPDGR  DGR INNER JOIN SHRDGRUNDMST  SHR
					              ON    DGR.CMPCOD=SHR.CMPCOD 
				                       AND  DGR.UNIIDR=SHR.UNDNUM 
				   LEFT OUTER  JOIN     OPRNTCDGR  NTC
					          ON  DGR.CMPCOD=NTC.CMPCOD
					      AND   DGR.DOCOWRIDR=NTC.DOCOWRIDR
					      AND   DGR.MSTDOCNUM=NTC.MSTDOCNUM
					      AND   DGR.DUPNUM=NTC.DUPNUM
					      AND   DGR.SEQNUM=NTC.SEQNUM
					      AND   DGR.SERNUM=NTC.PARSERNUM           
				WHERE
						 DGR.CMPCOD=?
					
					        
        
	]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>21</QRY:Id>
<QRY:Source Name="operations.shipment.finddisctributedpcs" Type="NATIVE">
	<![CDATA[
		SELECT
			MST.CMPCOD, MST.MSTDOCNUM, MST.DOCOWRIDR, MST.DUPNUM,
			MST.SEQNUM, MST.PARSEQNUM, MST.DOCNUM, PCS.GRPIDR PCSIDR
		FROM OPRSHPMST  MST, OPRSHPPCSGRP PCS
		WHERE
			MST.CMPCOD = PCS.CMPCOD
			AND MST.MSTDOCNUM = PCS.MSTDOCNUM
			AND MST.DOCOWRIDR = PCS.DOCOWRIDR
			AND MST.DUPNUM = PCS.DUPNUM
			AND MST.SEQNUM = PCS.SEQNUM
			AND	MST.CMPCOD = ?
	  		AND MST.DOCOWRIDR = ?
	  		AND MST.MSTDOCNUM = ?
	  		AND MST.DUPNUM = ?
	  		AND MST.PARSEQNUM = ?

	]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>22</QRY:Id>
<QRY:Source Name="operations.shipment.findhousesforshipment" Type="NATIVE">
	<![CDATA[
		SELECT
				HSE.CMPCOD, HSE.MSTDOCNUM, HSE.DOCOWRIDR, HSE.DUPNUM,
				HSE.SEQNUM, HSE.DOCNUM, HSE.HSEPTH, HSE.PARSEQNUM,
				MST.LSTUPDTIM MSTLSTUPDTIM, MST.LSTUPDUSR MSTLSTUPDUSR,MST.STDPCS STDPCS,MST.STDWGT STDWGT,MST.SCCCOD
		FROM OPRSHPHSE HSE, OPRSHPMST MST
		WHERE
				HSE.CMPCOD = MST.CMPCOD
			AND HSE.MSTDOCNUM = MST.MSTDOCNUM
			AND HSE.DOCOWRIDR = MST.DOCOWRIDR
			AND HSE.DUPNUM = MST.DUPNUM
			AND HSE.SEQNUM = MST.SEQNUM

	]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>23</QRY:Id>
<QRY:Source Name="operations.shipment.hasRateLineUsedInAwb" Type="NATIVE">
	<![CDATA[
SELECT DTL.CMPCOD,
  DTL.MSTDOCNUM,
  ACC.JRNDAT
FROM OPRSHPRATDTL DTL,
  OPRSHPMSTACC ACC
WHERE DTL.CMPCOD          =ACC.CMPCOD
AND DTL.DOCOWRIDR         =ACC.DOCOWRIDR
AND DTL.MSTDOCNUM         =ACC.MSTDOCNUM
AND DTL.DUPNUM            =ACC.DUPNUM
AND DTL.SEQNUM            =ACC.SEQNUM
AND DTL.CMPCOD            = ?
AND ( DTL.IATRATLINIDR    = ?
OR DTL.ARLRATLINIDR       = ? )
AND ( DTL.IATTRFRATSERNUM = ?
OR DTL.ARLTRFRATSERNUM    = ? )
AND ( DTL.IATTRFNAM       = ?
OR DTL.ARLTRFNAM          = ? )
AND ( DTL.IATTRFSERNUM    = ?
OR DTL.ARLTRFSERNUM       = ? )

	]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>24</QRY:Id>
<QRY:Source Name="operations.shipment.finddnsummary" Type="NATIVE">
	<![CDATA[
	    	  SELECT DLVNOT.DOCNUM,
			  DLVNOT.DLVNOTNUM,
			  DLVNOT.DLVNOTPCS,
			  DLVNOT.DOCOWRIDR,
			  DLVNOT.DLVCUSCOD,
			  DLVNOT.DLVCUSNAM,
			  DLVNOT.DLVNOTWGT,
			  DLVNOT.DLVPCS,
			  DLVNOT.DLVWGT,
			  DLVNOTULD.ULDNUM,
			  MST.SHPPFX MSTSHPPFX,
			  MST.PARSEQNUM MSTPARSEQNUM,
			  MST.MSTDOCNUM MSTMSTDOCNUM
			FROM OPRSHPMST MST,
			  OPRSHPDLVNOT DLVNOT
			LEFT OUTER JOIN OPRSHPDLVNOTULD DLVNOTULD
			ON DLVNOTULD.DLVNOTNUM=DLVNOT.DLVNOTNUM
			AND DLVNOTULD.CMPCOD  =DLVNOT.CMPCOD
			AND DLVNOTULD.ARPCOD  =DLVNOT.ARPCOD
			WHERE DLVNOT.CMPCOD   = MST.CMPCOD
			AND DLVNOT.MSTDOCNUM  = MST.MSTDOCNUM
			AND DLVNOT.DOCOWRIDR  = MST.DOCOWRIDR
			AND DLVNOT.DUPNUM     = MST.DUPNUM
			AND DLVNOT.SEQNUM     = MST.SEQNUM
            AND DLVNOT.CMPCOD=?  AND
            DLVNOT.DOCOWRIDR=? AND
            DLVNOT.MSTDOCNUM=? AND
            DLVNOT.DUPNUM=?
	]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>25</QRY:Id>
<QRY:Source Name="operations.shipment.finddeliverysummary" Type="NATIVE">
	<![CDATA[
	    	SELECT DLVDTL.MSTDOCNUM,DLVDTL.CNSNAM,DLVDTL.DLVPCS,DLVDTL.DLVWGT,DLVDTL.DLVDAT,DLVDTL.DOCOWRIDR,
			MST.SHPPFX MSTSHPPFX,MST.PARSEQNUM MSTPARSEQNUM,MST.MSTDOCNUM MSTMSTDOCNUM
			FROM OPRSHPDLVDTL DLVDTL, OPRSHPMST MST
            WHERE
			DLVDTL.CMPCOD = MST.CMPCOD
			AND DLVDTL.MSTDOCNUM = MST.MSTDOCNUM
			AND DLVDTL.DOCOWRIDR = MST.DOCOWRIDR
			AND DLVDTL.DUPNUM = MST.DUPNUM
			AND DLVDTL.SEQNUM = MST.SEQNUM
            AND DLVDTL.CMPCOD=?  AND
            DLVDTL.DOCOWRIDR=? AND
            DLVDTL.MSTDOCNUM=? AND
            DLVDTL.DUPNUM=?
	]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>26</QRY:Id>
<QRY:Source Name="operations.shipment.findshipmentsinuld" Type="NATIVE">
	<![CDATA[
				SELECT SHP.ARPCOD SHPARPCOD, SHP.CMPCOD SHPCMPCOD, SHP.DOCOWRIDR SHPDOCOWRIDR,
				       SHP.DUPNUM SHPDUPNUM, SHP.MSTDOCNUM SHPMSTDOCNUM, SHP.NUMPCS SHPNUMPCS,
				       SHP.SEQNUM SHPSEQNUM, SHP.ULDNUM SHPULDNUM, SHP.WGT, SHP.VOL,
				       ARPULD.ARPCOD ULDARPCOD, ARPULD.CMPCOD ULDCMPCOD, ARPULD.GRSWGT,
				       ARPULD.NETWGT, ARPULD.TARWGT, ARPULD.ULDNUM ULDULDNUM,ARPULD.ULDCTR ULDCTR, ARPULD.ACTWGT, MST.SHPPFX, MST.SHPDES,
				       MST.SCCCOD, MST.PRDPRT, MST.PRDNAM, MST.ORGCOD, MST.DSTCOD, RTG.SERNUM,
				       RTG.ULDNUM, RTG.ARPCOD, RTG.CMPCOD, RTG.THRCARIDR, RTG.THRCARCOD,
					   ARPULD.ULDBKGIDR,ARPULD.ALTIDR, ARPULD.BUPFLG,  ARPULD.BKGTYP,
				       RTG.THRFLTNUM, RTG.THRFLTDAT, RTG.THRDSTCOD, MST.STDPCS, MST.STDWGT,
				       MST.GRSVOL, ARPSHP.AVLPCS, ARPSHP.AVLWGT,
				       ARPSHP.LSTUPDTIM ARPSHPLSTUPDTIM, ARPSHP.LSTUPDUSR ARPSHPLSTUPDUSR,ARPSHP.PLTUSEFLG PLTUSEFLG,
				       ARPULD.LSTUPDTIM ARPULDLSTUPDTIM, ARPULD.LSTUPDUSR ARPULDLSTUPDUSR,
				       MST.LSTUPDTIM MSTLSTUPDTIM, MST.LSTUPDUSR MSTLSTUPDUSR,MST.PLTFLG,
				       DTL.LSTUPDTIM DTLLSTUPDTIM, DTL.LSTUPDUSR DTLLSTUPDUSR,DTL.PLTUSEFLG PLTUSEFLGDTL,MST.RDYCRGFLG,MST.STDWGTCOD, 
	           		       SEGSHP.LSTUPDUSR SEGSHPLSTUPDUSR,SEGSHP.LSTUPDTIM SEGSHPLSTUPDTIM,ARPULD.POU ARPULDPOU, MST.EXEFLG,MST.EFTAWBFLG,MST.CONFLG,
						   ARPDGR.ULDNUM DGRULDNUM,ARPDGR.SERNUM ARPDGRSERNUM,ARPDGR.SCCCOD DGRSCCCOD,ARPDGR.UNIIDR,ARPDGR.PKGGRP,ARPDGR.PKGINS,ARPDGR.NUMPKG,ARPDGR.PARSERNUM,ARPDGR.DGRSERNUM,ARPDGR.BDPPCS,ARPDGR.PROSHPNAM,ARPDGR.RMC, 
ARPDGR.SHPCLS,ARPDGR.SUBRSKTWO,ARPDGR.SUBRSKTHR,ARPDGR.SUBRSKONE,ARPDGR.TECNAM,ARPDGR.ALLPCKSERNUM,ARPDGR.OVRPCKSERNUM,ARPDGR.PKGHGT,ARPDGR.ERGCOD,ARPDGR.PCSINNULD,DRYICE.NETQTY DRYICENETQTY,DRYICE.POU,DRYICE.ULDNUM DRYICEULDNUM,SPLLOD.NUMPKG SPLLODNUMPKG,
  SPLLOD.NETQTY SPLNETQTY,SPLLOD.SUPINF,SPLLOD.RMK,SPLLOD.ULDNUM SPLULDNUM,
ARPULD.RMK ULDRMK,MIS.SCICOD SCICOD,ARPDGR.OVRVLDFLG,SHP.NONDGRFLG, SHP.NONSPLLODFLG,DGR.NETQTY DGRNETQTY,
  DGR.NETQTYUNT,
  DGR.TOTTPTIND,
  DGR.TPTIND TPTIND,MST.OWRCOD 
				  FROM OPRARPULD ARPULD,
				       OPRULDSHP SHP,
				       OPRSHPMST MST,
				       OPRARPTHRRTG RTG,
				       OPRSHPDTL DTL,
				       OPRARPSHP ARPSHP,
				       OPRSEGSHP SEGSHP,
					   OPRARPDGR ARPDGR,
					   OPRARPSPLLOD SPLLOD,
					   OPRARPDRYICE DRYICE,
					   OPRSHPMSTMIS MIS,
					    OPRSHPDGR DGR
				 WHERE SHP.ULDNUM = ARPULD.ULDNUM
				   AND SHP.ARPCOD = ARPULD.ARPCOD
				   AND SHP.CMPCOD = ARPULD.CMPCOD
				   AND ARPULD.ULDNUM = RTG.ULDNUM(+)
				   AND ARPULD.ARPCOD = RTG.ARPCOD(+)
				   AND ARPULD.CMPCOD = RTG.CMPCOD(+)
				   AND SHP.MSTDOCNUM = MST.MSTDOCNUM
				   AND SHP.DOCOWRIDR = MST.DOCOWRIDR
				   AND SHP.DUPNUM = MST.DUPNUM
				   AND SHP.SEQNUM = MST.SEQNUM
				   AND SHP.CMPCOD = MST.CMPCOD
				   AND MST.CMPCOD = DTL.CMPCOD
				   AND MST.DOCOWRIDR = DTL.DOCOWRIDR
				   AND MST.MSTDOCNUM = DTL.MSTDOCNUM
				   AND MST.SEQNUM = DTL.SEQNUM
				   AND MST.DUPNUM = DTL.DUPNUM
				   AND SHP.MSTDOCNUM = ARPSHP.MSTDOCNUM
				   AND SHP.DOCOWRIDR = ARPSHP.DOCOWRIDR
				   AND SHP.DUPNUM = ARPSHP.DUPNUM
				   AND SHP.SEQNUM = ARPSHP.SEQNUM
				   AND SHP.CMPCOD = ARPSHP.CMPCOD
				   AND SHP.ARPCOD = ARPSHP.ARPCOD
			       	   AND SHP.CMPCOD = SEGSHP.CMPCOD(+)
				   AND SHP.MSTDOCNUM = SEGSHP.MSTDOCNUM(+)
				   AND SHP.DOCOWRIDR = SEGSHP.DOCOWRIDR(+)
				   AND SHP.DUPNUM = SEGSHP.DUPNUM(+)
			           AND SHP.SEQNUM = SEGSHP.SEQNUM(+)
					AND SHP.CMPCOD=ARPDGR.CMPCOD(+) 
					AND SHP.DOCOWRIDR=ARPDGR.DOCOWRIDR(+) 
					AND SHP.MSTDOCNUM=ARPDGR.MSTDOCNUM(+) 
					AND SHP.DUPNUM=ARPDGR.DUPNUM(+) 
					AND SHP.SEQNUM=ARPDGR.SEQNUM(+) 
					AND SHP.ARPCOD=ARPDGR.ARPCOD(+) 
					AND SHP.ULDNUM=ARPDGR.ULDNUM(+) 
					AND SHP.CMPCOD=SPLLOD.CMPCOD(+) 
					AND SHP.DOCOWRIDR=SPLLOD.DOCOWRIDR(+) 
					AND SHP.MSTDOCNUM=SPLLOD.MSTDOCNUM(+) 
					AND SHP.DUPNUM=SPLLOD.DUPNUM(+) 
					AND SHP.SEQNUM=SPLLOD.SEQNUM(+) 
					AND SHP.ARPCOD=SPLLOD.ARPCOD(+) 
					AND SHP.ULDNUM=SPLLOD.ULDNUM(+) 
					AND ARPULD.CMPCOD=DRYICE.CMPCOD(+) 
					AND ARPULD.ARPCOD=DRYICE.ARPCOD(+) 
					AND ARPULD.ULDNUM=DRYICE.ULDNUM(+) 
					AND MST.CMPCOD    = MIS.CMPCOD(+)
					AND MST.MSTDOCNUM = MIS.MSTDOCNUM(+)
					AND MST.DOCOWRIDR = MIS.DOCOWRIDR(+)
					AND MST.DUPNUM    = MIS.DUPNUM(+)
					AND MST.SEQNUM    = MIS.SEQNUM(+)
					AND ARPDGR.CMPCOD    = DGR.CMPCOD(+)
					AND ARPDGR.MSTDOCNUM = DGR.MSTDOCNUM(+)
					AND ARPDGR.DOCOWRIDR = DGR.DOCOWRIDR(+)
					AND ARPDGR.DUPNUM    = DGR.DUPNUM(+)
					AND ARPDGR.SEQNUM    = DGR.SEQNUM(+)
					AND ARPDGR.DGRSERNUM = DGR.SERNUM(+)
				   AND SHP.ULDNUM = ?
				   AND SHP.ARPCOD = ?
		   	   	   AND SHP.CMPCOD = ?

	]]>
</QRY:Source>
</QRY:Definition>
<!--Modified for ICRD-98540 by A-5165-->
<QRY:Definition>
<QRY:Id>27</QRY:Id>
<QRY:Source Name="operations.shipment.finddeliverylistbreakdownmode" Type="NATIVE">
	<![CDATA[
SELECT SUBQRY.MSTDOCNUM ,
  SUBQRY.DOCOWRIDR,
  SUBQRY.DUPNUM,
  SUBQRY.STDPCS,
  SUBQRY.STDWGT,
  SUBQRY.SEQNUM,
  SUBQRY.DOCNUM,
  SUBQRY.ORGCOD,
  SUBQRY.DSTCOD,
  SUBQRY.SHPSTA,
  SUBQRY.SHPPFX,
  SUBQRY.CMPCOD,
  SUBQRY.CONFLG,
  SUBQRY.CNSNAM,
  SUBQRY.ARPCOD,
  SUBQRY.AVLPCS,
  SUBQRY.TFROUTPCS,
  SUBQRY.TOTDLVNOTPCS,
  SUBQRY.TOTDLVNOTWGT,
  SUBQRY.TOTDLVPCS,
  SUBQRY.TOTDLVWGT,
  SUBQRY.SECCLRSTA,
  SUBQRY.CUSCLRSTA,
  SUBQRY.RCVPCS,
  SUBQRY.RCVWGT,
  SUBQRY.CUSMAXPRI,
  SUBQRY.CUSPRI,
  SUBQRY.SCCMATVAL,
  SUBQRY.CUSSCCCOD,
  SUBQRY.CUSAGTCOD,
  SUBQRY.CUSCOD,
  ULDSHP.ULDNUM,
  SEGSHP.MFTPCS,
  IMPFLT.FLTCARCOD,
  IMPFLT.FLTNUM,
  IMPFLT.FLTDAT,
  SEG.POL,
  DLVNOT.DLVNOTNUM,
  DLVDTL.DLVDAT,
  DLVDTL.DLVWGT,
  DLVDTL.DLVPCS,
  COALESCE(DLVDTL.CNSNAM,DLVDTL.DLVRTO) DLVRTO,
  DLVDTL.DLVDTLSEQNUM,
  BLB.CUSSIGIMG,
  BKGMST.SHPRDYTIM,
  BKGMST.SHPDLVTIM,
  SUBQRY.SCCCOD,
  SUBQRY.DOCHDRFLG,
  SUBQRY.PLTFLG,
  SUBQRY.PLTUSEFLG,
  SUBQRY.PLTUSEFLGDTL
FROM
  (SELECT K.MSTDOCNUM ,
    K.DOCOWRIDR,
    K.DUPNUM,
    K.STDPCS,
    K.STDWGT,
    K.SEQNUM,
    K.DOCNUM,
    K.ORGCOD,
    K.DSTCOD,
    K.SHPSTA,
    K.SHPPFX,
    K.CMPCOD,
    K.CONFLG,
    K.CNSNAM,
    K.ARPCOD,
    K.TOTDLVNOTPCS,
    K.TOTDLVNOTWGT,
    K.TOTDLVPCS,
    K.TOTDLVWGT,
    K.SECCLRSTA,
    K.CUSCLRSTA,
    K.TFROUTPCS,
    K.MFTPCS,
    K.AVLPCS,
    K.RCVPCS,
    K.RCVWGT,
    K.CUSMAXPRI,
    K.CUSPRI,
    K.SCCMATVAL,
    K.CUSSCCCOD,
    K.CUSAGTCOD,
    K.CUSCOD,
	K.SCCCOD,
	K.DOCHDRFLG,
	K.PLTFLG,
	K.PLTUSEFLG,
	K.PLTUSEFLGDTL
  FROM
    (SELECT M.MSTDOCNUM ,
      M.DOCOWRIDR,
      M.DUPNUM,
      M.STDPCS,
      M.STDWGT,
      M.SEQNUM,
      M.DOCNUM,
      M.ORGCOD,
      M.DSTCOD,
      M.SHPSTA,
      M.SHPPFX,
      M.CMPCOD,
      M.CONFLG,
      M.CNSNAM,
      M.ARPCOD,
      M.TOTDLVNOTPCS,
      M.TOTDLVNOTWGT,
      M.TOTDLVPCS,
      M.TOTDLVWGT,
      M.SECCLRSTA,
      M.CUSCLRSTA,
      M.TFROUTPCS,
      M.AVLPCS,
      M.MFTPCS,
      M.RCVPCS,
      M.RCVWGT,
      MAX(M.CUSPRI) OVER(PARTITION BY M.MSTDOCNUM, M.DOCOWRIDR, M.SEQNUM, M.DUPNUM, M.CMPCOD) CUSMAXPRI,
      M.CUSPRI,
      M.SCCMATVAL,
      M.CUSSCCCOD,
      M.CUSAGTCOD,
      M.CUSCOD,
	  M.SCCCOD,
	  M.DOCHDRFLG,
	  M.PLTFLG,
	  M.PLTUSEFLG,
	  M.PLTUSEFLGDTL
    FROM
      (SELECT Q.MSTDOCNUM ,
        Q.DOCOWRIDR,
        Q.DUPNUM,
        Q.STDPCS,
        Q.STDWGT,
        Q.SEQNUM,
        Q.DOCNUM,
        Q.ORGCOD,
        Q.DSTCOD,
        Q.SHPSTA,
        Q.SHPPFX,
        Q.CMPCOD,
        Q.CONFLG,
        Q.CNSNAM,
        Q.ARPCOD,
        Q.TOTDLVNOTPCS,
        Q.TOTDLVNOTWGT,
        Q.TOTDLVPCS,
        Q.TOTDLVWGT,
        Q.SECCLRSTA,
        Q.CUSCLRSTA,
        Q.TFROUTPCS,
        Q.AVLPCS,
        Q.MFTPCS,
        Q.RCVPCS,
        Q.RCVWGT,
        CASE
          WHEN Q.SCCMATVAL > 0
          AND Q.CUSSCCCOD IS NOT NULL
          THEN 2
          WHEN Q.CUSSCCCOD IS NULL
          THEN 0
          ELSE -1
        END CUSPRI,
        Q.SCCMATVAL,
        Q.CUSSCCCOD,
        Q.CUSAGTCOD,
        Q.CUSCOD,
		  Q.SCCCOD,
		  Q.DOCHDRFLG,
		  Q.PLTFLG,
		  Q.PLTUSEFLG,
		  Q.PLTUSEFLGDTL
      FROM
        (SELECT MST.MSTDOCNUM ,
          MST.DOCOWRIDR,
          MST.DUPNUM,
          MST.STDPCS,
          MST.STDWGT,
          MST.SEQNUM,
          MST.DOCNUM,
          MST.ORGCOD,
          MST.DSTCOD,
          MST.SHPSTA,
          MST.SHPPFX,
          MST.CMPCOD,
          MST.CONFLG,
          MST.CNSNAM,
          SHP.ARPCOD,
          SHP.TOTDLVNOTPCS,
          SHP.TOTDLVNOTWGT,
          SHP.TOTDLVPCS,
          SHP.TOTDLVWGT,
          SHP.SECCLRSTA,
           CASE
                  WHEN CSTSHP.CSTAUTCOD ='HMRC'
                  THEN
                    CASE
                      WHEN CSTSHP.CSTSTACOD IN ('CA','CR','CQ','CS','CX','XO','XA','XS','XX')
                      THEN 'Hold'
                      WHEN CSTSHP.CSTSTACOD IN('CB','CC','CT','CU','CW','XC')
                      THEN 'Cleared'
                    END
                  ELSE
                    CASE
                      WHEN CSTSHP.CSTAUTCOD <>'HMRC'
                      THEN
                        CASE
                          WHEN CSTSHP.CSTSTA = 'S'
                THEN 'Cleared'
                WHEN CSTSHP.CSTSTA = 'E'
                THEN 'Hold'
                          WHEN CSTSHP.CSTSTA = 'R'
                  THEN 'Required'
                  WHEN CSTSHP.CSTSTA = 'Y'
                  THEN 'Required'
                        END
                    END
                END CUSCLRSTA,
          SHP.TFROUTPCS,
          SHP.AVLPCS,
          SHP.MFTPCS,
         ( CASE 
            WHEN SHP.DCSFLG = 'Y' OR SHP.DCSREQFLG = 'Y'
            THEN (SHP.ACPPCS+SHP.DCSPCS)
            ELSE (SHP.ACPPCS + SHP.RCVPCS)
            END) RCVPCS,
         ( CASE 
            WHEN SHP.DCSFLG = 'Y' OR SHP.DCSREQFLG = 'Y'
            THEN (SHP.ACPWGT +SHP.DCSWGT)
            ELSE (SHP.ACPWGT + SHP.RCVWGT)
            END) RCVWGT,
          INSTR(?
          || CUSAGT.SCCCOD
          || ?, ?
          || MST.SCCCOD
          || ?) SCCMATVAL,
          CUSAGT.SCCCOD CUSSCCCOD,
          CUSAGT.AGTCOD CUSAGTCOD,
          CUSAGT.CUSCOD,
		  MST.SCCCOD,
		  MST.SHPDES,
		  (SELECT DISTINCT arpshp.DOCHDRFLG
			  FROM OPRARPSHP arpshp
			  WHERE arpshp.MSTDOCNUM =mst.MSTDOCNUM
			  AND arpshp.DOCOWRIDR   =mst.DOCOWRIDR
			  AND arpshp.DUPNUM      =mst.DUPNUM
			  AND arpshp.SEQNUM      =1
			  AND arpshp.CMPCOD      =mst.CMPCOD
			  AND arpshp.ARPCOD      =?
		  ) AS DOCHDRFLG,
		  MST.PLTFLG,
		  SHP.PLTUSEFLG,
		  DTL.PLTUSEFLG PLTUSEFLGDTL
        FROM OPRSHPMST MST
]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>730</QRY:Id>
<QRY:Source Name="operations.shipment.finddeliverylistbreakdownmodecustomermode" Type="NATIVE">
<![CDATA[
		INNER JOIN SHRCUSAGT CUSAGT
        ON MST.CMPCOD                                             = CUSAGT.CMPCOD
        AND MST.CNSCOD                                            = CUSAGT.CUSCOD
        AND CUSAGT.IMPFLG                                         = 'Y'
        AND COALESCE(CUSAGT.STNCOD, ?)                   		  = ?
        AND INSTR(MST.SCCCOD,COALESCE(CUSAGT.SCCCOD, MST.SCCCOD)) > 0
	]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>731</QRY:Id>
<QRY:Source Name="operations.shipment.finddeliverylistbreakdownmodecustomermodeouter" Type="NATIVE">
<![CDATA[
        LEFT OUTER JOIN SHRCUSAGT CUSAGT
        ON MST.CMPCOD                                             = CUSAGT.CMPCOD
        AND MST.CNSCOD                                            = CUSAGT.CUSCOD
        AND CUSAGT.IMPFLG                                         = 'Y'
        AND COALESCE(CUSAGT.STNCOD, SHP.ARPCOD)                   = SHP.ARPCOD
        AND INSTR(MST.SCCCOD,COALESCE(CUSAGT.SCCCOD, MST.SCCCOD)) > 0
	]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>729</QRY:Id>
<QRY:Source Name="operations.shipment.finddeliverylistbreakdownmodeparticipantmode" Type="NATIVE">
<![CDATA[
	INNER JOIN OPRSHPADLCNT  ADLCNT 
      ON MST.CMPCOD     = ADLCNT.CMPCOD
      AND MST.DOCOWRIDR = ADLCNT.DOCOWRIDR
      AND MST.MSTDOCNUM = ADLCNT.MSTDOCNUM
      AND MST.DUPNUM    = ADLCNT.DUPNUM
      AND MST.SEQNUM    = ADLCNT.SEQNUM    
	  AND ADLCNT.CTTCUSCOD =   ?
	  AND ADLCNT.CNTTYP    = ?	  
]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>728</QRY:Id>
<QRY:Source Name="operations.shipment.finddeliverylistbreakdownmodepartone" Type="NATIVE">
<![CDATA[
		  
        LEFT OUTER JOIN OPRARPSHP SHP
        ON MST.MSTDOCNUM  =SHP.MSTDOCNUM
        AND MST.DOCOWRIDR =SHP.DOCOWRIDR
        AND MST.DUPNUM    =SHP.DUPNUM
        AND MST.SEQNUM    =SHP.SEQNUM
        AND MST.CMPCOD    =SHP.CMPCOD
		AND SHP.ARPCOD =?
		 LEFT OUTER JOIN CSTARPSHP CSTSHP
               ON MST.CMPCOD = CSTSHP.CMPCOD
              AND MST.DOCOWRIDR  = CSTSHP.DOCOWRIDR
              AND MST.MSTDOCNUM  = CSTSHP.MSTDOCNUM
              AND MST.DUPNUM     = CSTSHP.DUPNUM
              AND MST.SEQNUM     = CSTSHP.SEQNUM
		LEFT OUTER JOIN OPRSHPDTL DTL
        ON MST.MSTDOCNUM  =DTL.MSTDOCNUM
        AND MST.DOCOWRIDR =DTL.DOCOWRIDR
        AND MST.DUPNUM    =DTL.DUPNUM
        AND MST.SEQNUM    =DTL.SEQNUM
        AND MST.CMPCOD    =DTL.CMPCOD
		LEFT OUTER JOIN CAPBKGDTL BKGDTL
		ON BKGDTL.CMPCOD = MST.CMPCOD
		AND BKGDTL.UBRNUM = MST.UBRNUM
		LEFT OUTER JOIN CAPBKGMST BKGMST
		ON BKGMST.CMPCOD = MST.CMPCOD
		AND BKGMST.UBRNUM = MST.UBRNUM

	]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>720</QRY:Id>
<QRY:Source Name="operations.shipment.finddeliverylistbreakdownmodequerytwo" Type="NATIVE">
	<![CDATA[
	        )Q
      )M
    ) K
  WHERE K.CUSMAXPRI = K.CUSPRI
  ) SUBQRY
LEFT OUTER JOIN OPRULDSHP ULDSHP
ON SUBQRY.MSTDOCNUM  =ULDSHP.MSTDOCNUM
AND SUBQRY.DOCOWRIDR =ULDSHP.DOCOWRIDR
AND SUBQRY.DUPNUM    =ULDSHP.DUPNUM
AND SUBQRY.SEQNUM    =ULDSHP.SEQNUM
AND SUBQRY.ARPCOD    =ULDSHP.ARPCOD
AND SUBQRY.CMPCOD    =ULDSHP.CMPCOD
LEFT OUTER JOIN OPRSHPDLVNOT DLVNOT
ON SUBQRY.MSTDOCNUM  =DLVNOT.MSTDOCNUM
AND SUBQRY.DOCOWRIDR =DLVNOT.DOCOWRIDR
AND SUBQRY.DUPNUM    =DLVNOT.DUPNUM
AND SUBQRY.CMPCOD    =DLVNOT.CMPCOD
AND SUBQRY.SEQNUM    =DLVNOT.SEQNUM
LEFT OUTER JOIN OPRSEGSHP SEGSHP
ON SUBQRY.MSTDOCNUM  =SEGSHP.MSTDOCNUM
AND SUBQRY.DOCOWRIDR =SEGSHP.DOCOWRIDR
AND SUBQRY.DUPNUM    =SEGSHP.DUPNUM
AND SUBQRY.CMPCOD    =SEGSHP.CMPCOD
LEFT OUTER JOIN OPRFLTSEG SEG
      ON SEGSHP.FLTCARIDR  =SEG.FLTCARIDR
      AND SEGSHP.FLTNUM    =SEG.FLTNUM
      AND SEGSHP.FLTSEQNUM =SEG.FLTSEQNUM
      AND SEGSHP.CMPCOD    =SEG.CMPCOD
      AND SEGSHP.SEGSERNUM = SEG.SEGSERNUM
LEFT OUTER JOIN OPRARPIMPFLT IMPFLT
      ON SEG.FLTCARIDR  =IMPFLT.FLTCARIDR
      AND SEG.FLTNUM    =IMPFLT.FLTNUM
      AND SEG.FLTSEQNUM =IMPFLT.FLTSEQNUM
      AND SEG.CMPCOD    =IMPFLT.CMPCOD
AND SUBQRY.ARPCOD    =IMPFLT.ARPCOD
	  AND SEG.POU    =IMPFLT.ARPCOD
LEFT OUTER JOIN OPRSHPDLVDTL DLVDTL
ON SUBQRY.MSTDOCNUM  = DLVDTL.MSTDOCNUM
AND SUBQRY.DOCOWRIDR =DLVDTL.DOCOWRIDR
AND SUBQRY.DUPNUM    =DLVDTL.DUPNUM
AND SUBQRY.SEQNUM    =DLVDTL.SEQNUM
AND SUBQRY.CMPCOD    =DLVDTL.CMPCOD
AND SUBQRY.ARPCOD    =DLVDTL.ARPCOD
LEFT OUTER JOIN OPRSHPDLVCUSSIG BLB
ON DLVDTL.MSTDOCNUM       =BLB.MSTDOCNUM
AND DLVDTL.DOCOWRIDR      =BLB.DOCOWRIDR
AND DLVDTL.DUPNUM         =BLB.DUPNUM
AND DLVDTL.SEQNUM         =BLB.SEQNUM
AND DLVDTL.CMPCOD         =BLB.CMPCOD
AND DLVDTL.ARPCOD         =BLB.ARPCOD
AND DLVDTL.DLVDTLSEQNUM   =BLB.DLVDTLSEQNUM
LEFT OUTER JOIN CAPBKGMST BKGMST
ON SUBQRY.MSTDOCNUM  =BKGMST.MSTDOCNUM
AND SUBQRY.DOCOWRIDR =BKGMST.DOCOWRIDR
AND SUBQRY.DUPNUM    =BKGMST.DUPNUM
AND SUBQRY.CMPCOD    =BKGMST.CMPCOD
AND SUBQRY.SEQNUM    =BKGMST.SEQNUM
LEFT OUTER JOIN FLTOPRLEG LEG
ON SEGSHP.FLTCARIDR  =LEG.FLTCARIDR
AND SEGSHP.FLTNUM    =LEG.FLTNUM
AND SEGSHP.FLTSEQNUM =LEG.FLTSEQNUM
AND SEGSHP.CMPCOD    =LEG.CMPCOD
AND SEG.POU    =LEG.LEGDST
WHERE SUBQRY.CMPCOD       = ?
	]]>
</QRY:Source>
</QRY:Definition>


<QRY:Definition>
<QRY:Id>727</QRY:Id>
<QRY:Source Name="operations.shipment.finddeliverylisttranshipmentmode" Type="NATIVE">
	<![CDATA[
SELECT SUBQRY.MSTDOCNUM ,
  SUBQRY.DOCOWRIDR,
  SUBQRY.DUPNUM,
  SUBQRY.STDPCS,
  SUBQRY.STDWGT,
  SUBQRY.SEQNUM,
  SUBQRY.DOCNUM,
  SUBQRY.ORGCOD,
  SUBQRY.DSTCOD,
  SUBQRY.SHPSTA,
  SUBQRY.SHPPFX,
  SUBQRY.AVLPCS,
  SUBQRY.TFROUTPCS,
  SUBQRY.CMPCOD,
  SUBQRY.CONFLG,
  SUBQRY.CNSNAM,
  SUBQRY.ARPCOD,
  SUBQRY.TOTDLVNOTPCS,
  SUBQRY.TOTDLVNOTWGT,
  SUBQRY.TOTDLVPCS,
  SUBQRY.TOTDLVWGT,
  SUBQRY.SECCLRSTA,
  SUBQRY.CUSCLRSTA,
  SUBQRY.RCVPCS,
  SUBQRY.RCVWGT,
  SUBQRY.CUSMAXPRI,
  SUBQRY.CUSPRI,
  SUBQRY.SCCMATVAL,
  SUBQRY.CUSSCCCOD,
  SUBQRY.CUSAGTCOD,
  SUBQRY.CUSCOD,
  DLVNOT.DLVNOTNUM,
  DLVDTL.DLVDAT,
  DLVDTL.DLVWGT,
  DLVDTL.DLVPCS,
  COALESCE(DLVDTL.CNSNAM,DLVDTL.DLVRTO) DLVRTO,
  DLVDTL.DLVDTLSEQNUM,
  BLB.CUSSIGIMG,
  BKGMST.SHPRDYTIM,
  BKGMST.SHPDLVTIM,
    SUBQRY.SCCCOD,
  SUBQRY.DOCHDRFLG,
		 SUBQRY.PLTFLG,
		 SUBQRY.PLTUSEFLG,
		 SUBQRY.PLTUSEFLGDTL
FROM
  (SELECT K.MSTDOCNUM ,
    K.DOCOWRIDR,
    K.DUPNUM,
    K.STDPCS,
    K.STDWGT,
    K.SEQNUM,
    K.DOCNUM,
    K.ORGCOD,
    K.DSTCOD,
    K.SHPSTA,
    K.SHPPFX,
    K.CMPCOD,
    K.CONFLG,
    K.CNSNAM,
    K.ARPCOD,
    K.TOTDLVNOTPCS,
    K.TOTDLVNOTWGT,
    K.TOTDLVPCS,
    K.TOTDLVWGT,
    K.SECCLRSTA,
    K.CUSCLRSTA,
    K.TFROUTPCS,
    K.MFTPCS,
    K.AVLPCS,
    K.RCVPCS,
    K.RCVWGT,
    K.CUSMAXPRI,
    K.CUSPRI,
    K.SCCMATVAL,
    K.CUSSCCCOD,
    K.CUSAGTCOD,
    K.CUSCOD,
	  K.SCCCOD,
	K.DOCHDRFLG,
		  K.PLTFLG,
		  K.PLTUSEFLG,
		  K.PLTUSEFLGDTL
  FROM
    (SELECT M.MSTDOCNUM ,
      M.DOCOWRIDR,
      M.DUPNUM,
      M.STDPCS,
      M.STDWGT,
      M.SEQNUM,
      M.DOCNUM,
      M.ORGCOD,
      M.DSTCOD,
      M.SHPSTA,
      M.SHPPFX,
      M.CMPCOD,
      M.CONFLG,
      M.CNSNAM,
      M.ARPCOD,
      M.TOTDLVNOTPCS,
      M.TOTDLVNOTWGT,
      M.TOTDLVPCS,
      M.TOTDLVWGT,
      M.SECCLRSTA,
      M.CUSCLRSTA,
      M.TFROUTPCS,
      M.AVLPCS,
      M.MFTPCS,
      M.RCVPCS,
      M.RCVWGT,
      MAX(M.CUSPRI) OVER(PARTITION BY M.MSTDOCNUM, M.DOCOWRIDR, M.SEQNUM, M.DUPNUM, M.CMPCOD) CUSMAXPRI,
      M.CUSPRI,
      M.SCCMATVAL,
      M.CUSSCCCOD,
      M.CUSAGTCOD,
      M.CUSCOD,
	    M.SCCCOD,
	  M.DOCHDRFLG,
		  M.PLTFLG,
		  M.PLTUSEFLG,
		  M.PLTUSEFLGDTL
    FROM
      (SELECT Q.MSTDOCNUM ,
        Q.DOCOWRIDR,
        Q.DUPNUM,
        Q.STDPCS,
        Q.STDWGT,
        Q.SEQNUM,
        Q.DOCNUM,
        Q.ORGCOD,
        Q.DSTCOD,
        Q.SHPSTA,
        Q.SHPPFX,
        Q.CMPCOD,
        Q.CONFLG,
        Q.CNSNAM,
        Q.ARPCOD,
        Q.TOTDLVNOTPCS,
        Q.TOTDLVNOTWGT,
        Q.TOTDLVPCS,
        Q.TOTDLVWGT,
        Q.SECCLRSTA,
        Q.CUSCLRSTA,
        Q.TFROUTPCS,
        Q.AVLPCS,
        Q.MFTPCS,
        Q.RCVPCS,
        Q.RCVWGT,
        CASE
          WHEN Q.SCCMATVAL > 0
          AND Q.CUSSCCCOD IS NOT NULL
          THEN 2
          WHEN Q.CUSSCCCOD IS NULL
          THEN 0
          ELSE -1
        END CUSPRI,
        Q.SCCMATVAL,
        Q.CUSSCCCOD,
        Q.CUSAGTCOD,
        Q.CUSCOD,
		  Q.SCCCOD,
		  Q.DOCHDRFLG,
		  Q.PLTFLG,
		  Q.PLTUSEFLG,
		  Q.PLTUSEFLGDTL
      FROM
        (SELECT MST.MSTDOCNUM ,
          MST.DOCOWRIDR,
          MST.DUPNUM,
          MST.STDPCS,
          MST.STDWGT,
          MST.SEQNUM,
          MST.DOCNUM,
          MST.ORGCOD,
          MST.DSTCOD,
          MST.SHPSTA,
          MST.SHPPFX,
          MST.CMPCOD,
          MST.CONFLG,
          MST.CNSNAM,
          SHP.ARPCOD,
          SHP.TOTDLVNOTPCS,
          SHP.TOTDLVNOTWGT,
          SHP.TOTDLVPCS,
          SHP.TOTDLVWGT,
          SHP.SECCLRSTA,
          SHP.CUSCLRSTA,
          SHP.TFROUTPCS,
          SHP.AVLPCS,
          SHP.MFTPCS,
          ( CASE 
            WHEN SHP.DCSFLG = 'Y' OR SHP.DCSREQFLG = 'Y'
            THEN (SHP.ACPPCS+SHP.DCSPCS)
            ELSE (SHP.ACPPCS + SHP.RCVPCS)
            END) RCVPCS,
         ( CASE 
            WHEN SHP.DCSFLG = 'Y' OR SHP.DCSREQFLG = 'Y'
            THEN (SHP.ACPWGT +SHP.DCSWGT)
            ELSE (SHP.ACPWGT + SHP.RCVWGT)
            END) RCVWGT,
          INSTR(?
          || CUSAGT.SCCCOD
          || ?, ?
          || MST.SCCCOD
          || ?) SCCMATVAL,
          CUSAGT.SCCCOD CUSSCCCOD,
          CUSAGT.AGTCOD CUSAGTCOD,
          CUSAGT.CUSCOD,
          SHP.ACPDAT,
		  MST.SCCCOD,
		   (SELECT DISTINCT arpshp.DOCHDRFLG
                FROM OPRARPSHP arpshp
                WHERE arpshp.MSTDOCNUM =mst.MSTDOCNUM
                AND arpshp.DOCOWRIDR   =mst.DOCOWRIDR
                AND arpshp.DUPNUM      =mst.DUPNUM
                AND arpshp.SEQNUM      =1
                AND arpshp.CMPCOD      =mst.CMPCOD
				AND arpshp.ARPCOD =?
		  ) AS DOCHDRFLG,
		  MST.PLTFLG,
		  SHP.PLTUSEFLG,
		  DTL.PLTUSEFLG PLTUSEFLGDTL
        FROM OPRSHPMST MST
]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>732</QRY:Id>
<QRY:Source Name="operations.shipment.finddeliverylisttranshipmentmodecustomermode" Type="NATIVE">
<![CDATA[
		INNER JOIN SHRCUSAGT CUSAGT
        ON MST.CMPCOD                                               = CUSAGT.CMPCOD
        AND MST.CNSCOD                                              = CUSAGT.CUSCOD
        AND CUSAGT.IMPFLG                                           = 'Y'
        AND COALESCE(CUSAGT.STNCOD, ?)                              = ?
        AND INSTR( MST.SCCCOD, COALESCE(CUSAGT.SCCCOD, MST.SCCCOD)) > 0
	]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>733</QRY:Id>
<QRY:Source Name="operations.shipment.finddeliverylisttranshipmentmodecustomermodeouter" Type="NATIVE">
<![CDATA[
        LEFT OUTER JOIN SHRCUSAGT CUSAGT
        ON MST.CMPCOD                                               = CUSAGT.CMPCOD
        AND MST.CNSCOD                                              = CUSAGT.CUSCOD
        AND CUSAGT.IMPFLG                                           = 'Y'
        AND COALESCE(CUSAGT.STNCOD, SHP.ARPCOD)                     = SHP.ARPCOD
        AND INSTR( MST.SCCCOD, COALESCE(CUSAGT.SCCCOD, MST.SCCCOD)) > 0
	]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>734</QRY:Id>
<QRY:Source Name="operations.shipment.finddeliverylisttranshipmentmodeparticipantmode" Type="NATIVE">
<![CDATA[
	  INNER JOIN OPRSHPADLCNT  ADLCNT 
      ON MST.CMPCOD     = ADLCNT.CMPCOD
      AND MST.DOCOWRIDR = ADLCNT.DOCOWRIDR
      AND MST.MSTDOCNUM = ADLCNT.MSTDOCNUM
      AND MST.DUPNUM    = ADLCNT.DUPNUM
      AND MST.SEQNUM    = ADLCNT.SEQNUM 
	  AND ADLCNT.CTTCUSCOD =   ?
	  AND ADLCNT.CNTTYP    = ?
]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>735</QRY:Id>
<QRY:Source Name="operations.shipment.finddeliverylisttranshipmentmodepartone" Type="NATIVE">
<![CDATA[
		LEFT OUTER JOIN OPRARPSHP SHP
        ON MST.MSTDOCNUM  =SHP.MSTDOCNUM
        AND MST.DOCOWRIDR =SHP.DOCOWRIDR
        AND MST.DUPNUM    =SHP.DUPNUM
        AND MST.SEQNUM    =SHP.SEQNUM
        AND MST.CMPCOD    =SHP.CMPCOD
		LEFT OUTER JOIN OPRSHPDTL DTL
        ON MST.MSTDOCNUM  =DTL.MSTDOCNUM
        AND MST.DOCOWRIDR =DTL.DOCOWRIDR
        AND MST.DUPNUM    =DTL.DUPNUM
        AND MST.SEQNUM    =DTL.SEQNUM
        AND MST.CMPCOD    =DTL.CMPCOD
		LEFT OUTER JOIN CAPBKGDTL BKGDTL
		ON BKGDTL.CMPCOD = MST.CMPCOD
		AND BKGDTL.UBRNUM = MST.UBRNUM
		LEFT OUTER JOIN CAPBKGMST BKGMST
		ON BKGMST.CMPCOD = MST.CMPCOD
		AND BKGMST.UBRNUM = MST.UBRNUM

	]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>720</QRY:Id>
<QRY:Source Name="operations.shipment.finddeliverylisttranshipmentmodequerytwo" Type="NATIVE">
	<![CDATA[
	 )Q
      )M
    ) K
  WHERE K.CUSMAXPRI = K.CUSPRI
  ) SUBQRY
LEFT OUTER JOIN OPRSHPDLVNOT DLVNOT
ON SUBQRY.MSTDOCNUM  =DLVNOT.MSTDOCNUM
AND SUBQRY.DOCOWRIDR =DLVNOT.DOCOWRIDR
AND SUBQRY.DUPNUM    =DLVNOT.DUPNUM
AND SUBQRY.CMPCOD    =DLVNOT.CMPCOD
AND SUBQRY.SEQNUM    =DLVNOT.SEQNUM
LEFT OUTER JOIN OPRSHPDLVDTL DLVDTL
ON SUBQRY.MSTDOCNUM  = DLVDTL.MSTDOCNUM
AND SUBQRY.DOCOWRIDR =DLVDTL.DOCOWRIDR
AND SUBQRY.DUPNUM    =DLVDTL.DUPNUM
AND SUBQRY.SEQNUM    =DLVDTL.SEQNUM
AND SUBQRY.CMPCOD    =DLVDTL.CMPCOD
AND SUBQRY.ARPCOD    =DLVDTL.ARPCOD
LEFT OUTER JOIN OPRSHPDLVCUSSIG BLB
ON DLVDTL.MSTDOCNUM     =BLB.MSTDOCNUM
AND DLVDTL.DOCOWRIDR    =BLB.DOCOWRIDR
AND DLVDTL.DUPNUM       =BLB.DUPNUM
AND DLVDTL.SEQNUM       =BLB.SEQNUM
AND DLVDTL.CMPCOD       =BLB.CMPCOD
AND DLVDTL.ARPCOD       =BLB.ARPCOD
AND DLVDTL.DLVDTLSEQNUM =BLB.DLVDTLSEQNUM
LEFT OUTER JOIN CAPBKGMST BKGMST
ON SUBQRY.MSTDOCNUM  =BKGMST.MSTDOCNUM
AND SUBQRY.DOCOWRIDR =BKGMST.DOCOWRIDR
AND SUBQRY.DUPNUM    =BKGMST.DUPNUM
AND SUBQRY.CMPCOD    =BKGMST.CMPCOD
AND SUBQRY.SEQNUM    =BKGMST.SEQNUM
WHERE SUBQRY.CMPCOD       = ?
	]]>
</QRY:Source>
</QRY:Definition>

<!--Modified for ICRD-98540 by A-5165 ends-->
<QRY:Definition>
<QRY:Id>28</QRY:Id>
<QRY:Source Name="operations.shipment.findAWBDeliveryDetails" Type="NATIVE">
	<![CDATA[

SELECT MST.CMPCOD,MST.DOCOWRIDR,MST.MSTDOCNUM,MST.DOCNUM,
	   MST.DUPNUM,MST.SEQNUM,MST.CONFLG,MST.SHPPFX,
	   MST.ORGCOD,MST.DSTCOD,MST.STDPCS,MST.STDWGT,MST.PLTFLG,
	   MST.CNSCOD,MST.CNSNAM,MST.CNSADRONE,
	   DTL.HSEDLVFLG,DTL.TOTDLVNOTPCS,DTL.TOTDLVNOTWGT,
	   DTL.TOTDLVPCS,DTL.TOTDLVWGT,DTL.PLTUSEFLG,DTL.CHGCLDFLG,
	   ARP.RCVPCS,ARP.RCVWGT,
	   ARP.AVLPCS,ARP.AVLWGT,
	   ARP.SECCLRREQFLG,ARP.CUSCLRREQFLG,
	   ARP.SECCLRSTA,ARP.CUSCLRSTA,ARP.ARPCOD,
       ARP.LSTUPDTIM LSTUPDTIM,ARP.LSTUPDUSR LSTUPDUSR,
       DTL.LSTUPDTIM DTLUPDTIM,DTL.LSTUPDUSR DTLUPDUSR,MSTACC.SRVCRGCLS,MSTACC.TOTCCF
FROM OPRSHPMST  MST,OPRSHPDTL DTL,OPRARPSHP ARP,OPRSHPMSTACC MSTACC
WHERE  MST.MSTDOCNUM=DTL.MSTDOCNUM(+) AND
	   MST.DOCOWRIDR=DTL.DOCOWRIDR(+) AND
	   MST.DUPNUM=DTL.DUPNUM(+) AND
	   MST.SEQNUM=DTL.SEQNUM(+) AND
	   MST.CMPCOD=DTL.CMPCOD(+) AND
	   MST.MSTDOCNUM=ARP.MSTDOCNUM(+) AND
	   MST.DOCOWRIDR=ARP.DOCOWRIDR(+) AND
	   MST.DUPNUM=ARP.DUPNUM(+) AND
	   MST.SEQNUM=ARP.SEQNUM(+) AND
	   MST.CMPCOD=ARP.CMPCOD(+) 
            AND MSTACC.CMPCOD = MST.CMPCOD
       AND MSTACC.MSTDOCNUM = MST.MSTDOCNUM
   AND MSTACC.DOCOWRIDR = MST.DOCOWRIDR
   AND MSTACC.DUPNUM = MST.DUPNUM
   AND MSTACC.SEQNUM = MST.SEQNUM
  
	AND MST.MSTDOCNUM=? AND MST.DOCOWRIDR=?
	   AND MST.DUPNUM=? AND MST.SEQNUM=?
	   AND ARP.ARPCOD(+) = ? AND MST.CMPCOD=?



	]]>
</QRY:Source>
</QRY:Definition>


<QRY:Definition>
<QRY:Id>29</QRY:Id>
<QRY:Source Name="operations.shipment.findSingleShipmentHouses" Type="NATIVE">
	<![CDATA[
SELECT MST.CMPCOD,MST.DOCOWRIDR,MST.MSTDOCNUM,
       MST.DUPNUM,MST.SEQNUM,MST.STDPCS,MST.STDWGT,MST.SHPDES,
       HSE.HSEPTH,MST.DOCNUM,HSE.PARSEQNUM
FROM OPRSHPMST  MST,OPRSHPHSE HSE
WHERE  MST.CMPCOD=HSE.CMPCOD AND
       MST.DOCOWRIDR=HSE.DOCOWRIDR AND
       MST.MSTDOCNUM=HSE.MSTDOCNUM AND
       MST.DUPNUM=HSE.DUPNUM AND
       MST.SEQNUM=HSE.SEQNUM AND        MST.MSTDOCNUM=? AND
       MST.DOCOWRIDR=? AND
       MST.DUPNUM=? AND
       MST.CMPCOD=? AND
       MST.CONFLG='N' AND HSE.SEQNUM > 1


	]]>
</QRY:Source>
</QRY:Definition>


<QRY:Definition>
<QRY:Id>28</QRY:Id>
<QRY:Source Name="operations.shipment.findreceiveddetails" Type="NATIVE">
	<![CDATA[
SELECT ARP.RCVPCS,ARP.RCVWGT
FROM OPRARPSHP ARP
WHERE ARP.MSTDOCNUM=? AND
	  ARP.DOCOWRIDR=? AND ARP.DUPNUM=?
	  AND ARP.SEQNUM=? AND ARP.ARPCOD = ? AND
	  ARP.CMPCOD=?


	]]>
</QRY:Source>
</QRY:Definition>



<QRY:Definition>
<QRY:Id>30</QRY:Id>
<QRY:Source Name="operations.shipment.finddeliveryinformation" Type="NATIVE">
	<![CDATA[
SELECT MST.MSTDOCNUM,MST.DOCOWRIDR,
	  MST.DUPNUM,MST.SEQNUM,MST.SHPPFX,MST.DOCNUM,
	  MST.CMPCOD,DTL.TOTDLVPCS,DTL.TOTDLVWGT,
	   DTL.TOTDLVNOTPCS,DTL.TOTDLVNOTWGT,
	   DTL.LSTUPDTIM LSTUPDTIM, DTL.LSTUPDUSR LSTUPDSUR
FROM OPRSHPDTL DTL,OPRSHPMST  MST
WHERE MST.CMPCOD=DTL.CMPCOD AND
	  MST.DOCOWRIDR=DTL.DOCOWRIDR AND
	  MST.MSTDOCNUM=DTL.MSTDOCNUM AND
	  MST.DUPNUM=DTL.DUPNUM AND
	  MST.SEQNUM=DTL.SEQNUM AND

	   DTL.MSTDOCNUM=? AND
     DTL.DOCOWRIDR=? AND
     DTL.DUPNUM=? AND
     DTL.SEQNUM=? AND
     DTL.CMPCOD=?


	]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>31</QRY:Id>
<QRY:Source Name="operations.shipment.findparentshipment" Type="NATIVE">
	<![CDATA[
SELECT 	HSE.CMPCOD,HSE.DOCOWRIDR,
	HSE.MSTDOCNUM,HSE.DUPNUM,
	HSE.PARSEQNUM,SHPMST.STDPCS, SHPMST.STDWGT, SHPMST.RDYCRGFLG,SHPMST.SCCCOD
FROM 	OPRSHPHSE HSE
INNER JOIN OPRSHPMST SHPMST
	ON HSE.CMPCOD     = SHPMST.CMPCOD
	AND HSE.DOCOWRIDR = SHPMST.DOCOWRIDR
	AND HSE.MSTDOCNUM = SHPMST.MSTDOCNUM
	AND HSE.DUPNUM    = SHPMST.DUPNUM
	AND HSE.PARSEQNUM = SHPMST.SEQNUM 
WHERE 	HSE.MSTDOCNUM = ? AND
		HSE.DOCOWRIDR = ? AND
		HSE.DUPNUM=? AND
		HSE.SEQNUM = ? AND
		HSE.CMPCOD = ?

	]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>32</QRY:Id>
<QRY:Source Name="operations.shipment.findnotificationdetails" Type="NATIVE">
	<![CDATA[
         SELECT SHPNFN.MSTDOCNUM,SHPNFN.DOCOWRIDR,SHPNFN.DUPNUM,SHPNFN.SEQNUM,SHPNFN.SERNUM,SHPNFN.FLTNUM,SHPNFN.FLTDAT,SHPNFN.FLTCARIDR,
			SHPNFN.NFNMOD,SHPNFN.NFYCOD,SHPNFN.NFNTXT,SHPNFN.NFNPRTTYP,SHPNFN.NFNADR,SHPNFN.NFNDAT,SHPNFN.NFNSTA,SHPNFN.NFNPCS,SHPNFN.NFNWGT,
			SHPNFN.SCCCOD,SHPNFN.ORGSERNUM,SHPNFN.FLTCARCOD,MST.SHPPFX
         FROM OPRSHPNFN SHPNFN, OPRSHPMST  MST
         WHERE SHPNFN.MSTDOCNUM = MST.MSTDOCNUM
			AND SHPNFN.DOCOWRIDR = MST.DOCOWRIDR
			AND SHPNFN.DUPNUM = MST.DUPNUM
			AND SHPNFN.SEQNUM = MST.SEQNUM
			AND SHPNFN.CMPCOD = MST.CMPCOD
			AND SHPNFN.CMPCOD=? 

	]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>33</QRY:Id>
<QRY:Source Name="operations.shipment.findtelephonicnotificationdetails" Type="NATIVE">
	<![CDATA[
         SELECT SHPNFN.MSTDOCNUM,SHPNFN.DOCOWRIDR,SHPNFN.DUPNUM,SHPNFN.SEQNUM,SHPNFN.SERNUM,SHPNFN.FLTNUM,SHPNFN.FLTDAT,SHPNFN.TELNFYPER,
			SHPNFN.NFNDAT,SHPNFN.TELNFNSTA,SHPNFN.NFNPCS,SHPNFN.NFNWGT,SHPNFN.SCCCOD,SHPNFN.CNSCOD,SHPNFN.CNSNAM,SHPNFN.NFYCOD,SHPNFN.NFYTELNUM,
			SHPNFN.FLTCARCOD,MST.SHPPFX,SHPNFN.RMK,SHPNFN.NFYNAM
         FROM OPRSHPNFN SHPNFN, OPRSHPMST  MST
		 WHERE SHPNFN.MSTDOCNUM = MST.MSTDOCNUM
			AND SHPNFN.DOCOWRIDR = MST.DOCOWRIDR
			AND SHPNFN.DUPNUM = MST.DUPNUM
			AND SHPNFN.SEQNUM = MST.SEQNUM
			AND SHPNFN.CMPCOD = MST.CMPCOD
			AND SHPNFN.CMPCOD=? 
			AND  SHPNFN.NFNMOD='T'

	]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>34</QRY:Id>
<QRY:Source Name="operations.shipment.findshipmentatairportdetails" Type="NATIVE">
	<![CDATA[
	SELECT
		ULDSHP.CMPCOD ULDSHPCMPCOD, ULDSHP.ARPCOD ULDSHPARPCOD, ULDSHP.DOCOWRIDR ULDSHPDOCOWRIDR,
		ULDSHP.MSTDOCNUM ULDSHPMSTDOCNUM, ULDSHP.DUPNUM ULDSHPDUPNUM, ULDSHP.SEQNUM ULDSHPSEQNUM,
		ULDSHP.ULDNUM ULDSHPULDNUM, ULDSHP.NUMPCS ULDSHPNUMPCS,ULDSHP.WGT ULDSHPWGT, ULDSHP.VOL ULDSHPVOL,

		ARPSHP.DOCRCVFLG,
		ARPSHP.CMPCOD ARPSHPCMPCOD, ARPSHP.DOCOWRIDR ARPSHPDOCOWRIDR,ARPSHP.DCSPCS,ARPSHP.DCSWGT,
		ARPSHP.MSTDOCNUM ARPSHPMSTDOCNUM, ARPSHP.DUPNUM ARPSHPDUPNUM, ARPSHP.SEQNUM ARPSHPSEQNUM,
		ARPSHP.ARPCOD ARPSHPARPCOD,ARPSHP.AVLPCS ARPSHPAVLPCS,ARPSHP.MFTPCS ARPSHPMFTPCS,
		ARPSHP.MFTWGT ARPSHPMFTWGT, ARPSHP.MFTVOL ARPSHPMFTVOL, ARPSHP.RCVPCS ARPSHPRCVPCS,
		ARPSHP.RCVWGT ARPSHPRCVWGT,ARPSHP.AVLVOL ARPSHPAVLVOL, ARPSHP.AVLWGT ARPSHPAVLWGT,ARPSHP.AVLVOL, ARPSHP.AVLWGT, ARPSHP.CONBDNFLG,
		ARPSHP.DCSREQFLG, ARPSHP.DCSFLG, ARPSHP.TOTDLVNOTPCS, ARPSHP.TOTDLVPCS,ARPSHP.PLTUSEFLG
		FROM
		OPRARPSHP ARPSHP,OPRULDSHP ULDSHP
		WHERE
		ARPSHP.MSTDOCNUM=ULDSHP.MSTDOCNUM(+) AND
		ARPSHP.DOCOWRIDR=ULDSHP.DOCOWRIDR(+) AND
		ARPSHP.DUPNUM=ULDSHP.DUPNUM(+) AND
		ARPSHP.SEQNUM=ULDSHP.SEQNUM(+) AND
		ARPSHP.ARPCOD=ULDSHP.ARPCOD(+) AND
		ARPSHP.CMPCOD=ULDSHP.CMPCOD(+) AND
		ARPSHP.CMPCOD=? AND
		ARPSHP.DOCOWRIDR=? AND
		ARPSHP.MSTDOCNUM=? AND
		ARPSHP.DUPNUM=? AND
		ARPSHP.SEQNUM=?

	]]>
</QRY:Source>
</QRY:Definition>


<QRY:Definition>
<QRY:Id>35</QRY:Id>
<QRY:Source Name="operations.shipment.finddeliverydetails" Type="NATIVE">
	<![CDATA[
SELECT DLV.CMPCOD, DLV.DOCOWRIDR, DLV.MSTDOCNUM, DLV.DUPNUM, DLV.SEQNUM,
       DLV.DLVDTLSEQNUM, DLV.DLVDTLSEQNUM, DLV.CNSADD, DLV.CNSCOD, DLV.CNSNAM,
       DLV.DLVPCS, DLV.DLVWGT, DLV.DLVDAT, DLV.CNSMALIDR, DLV.CNSTELNUM,
       DLV.RMK, OAS.BOE,DLV.LSTUPDTIM,DLV.LSTUPDUSR,MSTACC.TOTCCF
  FROM OPRSHPDLVDTL DLV, OPRARPSHP OAS,OPRSHPMSTACC MSTACC
 WHERE OAS.MSTDOCNUM = DLV.MSTDOCNUM
   AND OAS.DOCOWRIDR = DLV.DOCOWRIDR
   AND OAS.DUPNUM = DLV.DUPNUM
   AND OAS.SEQNUM = DLV.SEQNUM
   AND OAS.CMPCOD = DLV.CMPCOD
   AND OAS.ARPCOD = DLV.ARPCOD
   
   AND MSTACC.CMPCOD = DLV.CMPCOD
   AND MSTACC.MSTDOCNUM = DLV.MSTDOCNUM
   AND MSTACC.DOCOWRIDR = DLV.DOCOWRIDR
   AND MSTACC.DUPNUM = DLV.DUPNUM
   AND MSTACC.SEQNUM = DLV.SEQNUM
  
   AND OAS.DOCOWRIDR = ?
   AND OAS.MSTDOCNUM = ?
   AND OAS.DUPNUM=?
   AND OAS.SEQNUM = ?
   AND OAS.CMPCOD = ?


	]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>36</QRY:Id>
<QRY:Source Name="operations.shipment.findshipmentdetails.for.awb" Type="NATIVE">
	<![CDATA[
      SELECT MST.SCCCOD, MST.CNSNAM, MST.NFYNAM, MST.CNSCOD, MST.NFYCOD, SHP.RCVPCS,
             SHP.RCVWGT
        FROM OPRSHPMST  MST, OPRARPSHP SHP
       WHERE MST.MSTDOCNUM = SHP.MSTDOCNUM
         AND MST.DOCOWRIDR = SHP.DOCOWRIDR
         AND MST.DUPNUM = SHP.DUPNUM
         AND MST.SEQNUM = SHP.SEQNUM
         AND MST.CMPCOD = SHP.CMPCOD
         AND MST.MSTDOCNUM = ?
         AND MST.DUPNUM = ?
         AND MST.SEQNUM = ?
         AND MST.DOCOWRIDR = ?
   AND MST.CMPCOD = ?

	]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>37</QRY:Id>
<QRY:Source Name="operations.shipment.findshipmentdetails.for.flight" Type="NATIVE">
	<![CDATA[
   SELECT MST.SCCCOD, MST.CNSNAM, MST.NFYNAM, MST.CNSCOD, MST.NFYCOD,
          SEGSHP.RCVPCS, SEGSHP.RCVWGT
     FROM OPRSHPMST  MST, OPRSEGSHP SEGSHP, OPRARPIMPFLT IMPFLT
    WHERE MST.MSTDOCNUM = SEGSHP.MSTDOCNUM
      AND MST.DOCOWRIDR = SEGSHP.DOCOWRIDR
      AND MST.DUPNUM = SEGSHP.DUPNUM
      AND MST.SEQNUM = SEGSHP.SEQNUM
      AND MST.CMPCOD = SEGSHP.CMPCOD
      AND SEGSHP.FLTCARIDR = IMPFLT.FLTCARIDR
      AND SEGSHP.FLTNUM = IMPFLT.FLTNUM
      AND SEGSHP.FLTSEQNUM = IMPFLT.FLTSEQNUM
      AND SEGSHP.CMPCOD = IMPFLT.CMPCOD
      AND MST.MSTDOCNUM = ?
      AND MST.DUPNUM = ?
      AND MST.SEQNUM = ?
      AND MST.DOCOWRIDR = ?
      AND MST.CMPCOD = ?
      AND SEGSHP.FLTNUM = ?
      AND SEGSHP.FLTSEQNUM = ?
      AND SEGSHP.FLTCARIDR = ?
      AND IMPFLT.FLTDAT = ?
	]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>38</QRY:Id>
<QRY:Source Name="operations.shipment.hasdeliveredallpieces" Type="NATIVE">
	<![CDATA[
     SELECT SHP.RCVPCS,DTL.TOTDLVPCS
     FROM OPRARPSHP SHP,OPRSHPDTL DTL
     WHERE SHP.MSTDOCNUM=DTL.MSTDOCNUM(+) AND
           SHP.DOCOWRIDR=DTL.DOCOWRIDR(+) AND
	       SHP.DUPNUM=DTL.DUPNUM(+) AND
	       SHP.SEQNUM=DTL.SEQNUM(+) AND
	       SHP.CMPCOD=DTL.CMPCOD(+) AND
	       SHP.CMPCOD= ?     AND
	       SHP.ARPCOD= ?     AND
	       SHP.MSTDOCNUM= ?  AND
               SHP.SEQNUM=  ?    AND
	       SHP.DOCOWRIDR=?   AND
	       SHP.DUPNUM=  ?

	]]>
</QRY:Source>
</QRY:Definition>


<QRY:Definition>
<QRY:Id>39</QRY:Id>
<QRY:Source Name="operations.shipment.findadditionalnotificationdetails" Type="NATIVE">
	<![CDATA[
    SELECT MST.MSTDOCNUM MSTMSTDOCNUM, MST.DOCOWRIDR MSTDOCOWRIDR,
           MST.DUPNUM MSTDUPNUM, MST.SEQNUM MSTSEQNUM, MST.CMPCOD MSTCMPCOD,
           MST.CNSADRONE MSTCNSADRONE, MST.CNSCOD MSTCNSCOD, MST.CNSNAM MSTCNSNAM,
           CNT.CNSTELNUM MSTCNSTELNUM, CNT.NFYADRONE MSTNFYADRONE,
           MST.NFYCOD MSTNFYCOD, MST.NFYNAM MSTNFYNAM, CNT.NFYTELNUM MSTNFYTELNUM,
           MST.SHPADRONE MSTSHPADRONE, MST.SHPCOD MSTSHPCOD, MST.SHPNAM MSTSHPNAM,
           CNT.SHPTELNUM MSTSHPTELNUM, MST.SCCCOD MSTSCCCOD, MST.SHPPFX MSTSHPPFX,
           NFY.MSTDOCNUM NFYMSTDOCNUM, NFY.DOCOWRIDR NFYDOCOWRIDR,
           NFY.DUPNUM NFYDUPNUM, NFY.SEQNUM NFYSEQNUM, NFY.NFYCOD NFYNFYCOD,
           NFY.CMPCOD NFYCMPCOD, NFY.NFYADRONE NFYNFYADRONE, NFY.NFYMOD NFYNFYMOD,
           NFY.NFYNAM NFYNFYNAM, NFY.NFYTELNUM NFYNFYTELNUM
      FROM OPRSHPMST  MST, OPRSHPNFY NFY, OPRSHPMSTCNT CNT
     WHERE MST.MSTDOCNUM = NFY.MSTDOCNUM(+)
       AND MST.DOCOWRIDR = NFY.DOCOWRIDR(+)
       AND MST.DUPNUM = NFY.DUPNUM(+)
       AND MST.SEQNUM = NFY.SEQNUM(+)
       AND MST.CMPCOD = NFY.CMPCOD(+)
       AND MST.MSTDOCNUM = CNT.MSTDOCNUM
       AND MST.DOCOWRIDR = CNT.DOCOWRIDR
       AND MST.DUPNUM = CNT.DUPNUM
       AND MST.SEQNUM = CNT.SEQNUM
       AND MST.CMPCOD = CNT.CMPCOD
       AND MST.MSTDOCNUM = ?
       AND MST.DOCOWRIDR = ?
       AND MST.DUPNUM = ?
       AND MST.SEQNUM = ?
   AND MST.CMPCOD = ?


	]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>40</QRY:Id>
<QRY:Source Name="operation.shipment.findnotificationdetails.not.notified" Type="NATIVE">
	<![CDATA[
SELECT SEGSHP.MSTDOCNUM, SEGSHP.DOCOWRIDR, SEGSHP.DUPNUM, SEGSHP.CMPCOD,
       SEGSHP.SEGSERNUM SERNUM, SEGSHP.SEQNUM, SEGSHP.RCVPCS PCS,
       SEGSHP.RCVWGT WGT, SEGSHP.FLTNUM, MST.SCCCOD, MST.SHPPFX, MST.CNSNAM,
       MST.NFYNAM, IMPFLT.FLTCARCOD, IMPFLT.FLTDAT
  FROM OPRSEGSHP SEGSHP, OPRSHPMST  MST, OPRARPIMPFLT IMPFLT
 WHERE MST.MSTDOCNUM = SEGSHP.MSTDOCNUM(+)
   AND MST.DOCOWRIDR = SEGSHP.DOCOWRIDR(+)
   AND MST.DUPNUM = SEGSHP.DUPNUM(+)
   AND MST.SEQNUM = SEGSHP.SEQNUM(+)
   AND MST.CMPCOD = SEGSHP.CMPCOD(+)
   AND SEGSHP.FLTCARIDR = IMPFLT.FLTCARIDR(+)
   AND SEGSHP.FLTNUM = IMPFLT.FLTNUM(+)
   AND SEGSHP.FLTSEQNUM = IMPFLT.FLTSEQNUM(+)
   AND SEGSHP.CMPCOD = IMPFLT.CMPCOD(+)
   AND SEGSHP.RCVPCS > 0
   AND MST.CMPCOD = ?

   ]]>
</QRY:Source>
</QRY:Definition>

<!-- Modified by A-5290 for ICRD-160908: Added MST.OWRCOD-->
<QRY:Definition>
<QRY:Id>41</QRY:Id>
<QRY:Source Name="operation.shipment.findshipmentsummarydetails" Type="NATIVE">
	<![CDATA[
SELECT MST.CMPCOD,
            MST.OWRCOD,
            MST.DOCOWRIDR,
            MST.SHPPFX,
            MST.MSTDOCNUM,
            MST.DOCNUM,
            MST.DUPNUM,
            MST.AGTCOD,
            pkg_opr_shp.FUN_GET_CLEARINGAGENT(MST.CMPCOD, MST.MSTDOCNUM,MST.DUPNUM,MST.SEQNUM,MST.DOCOWRIDR) CLRAGTCOD,
            MST.AGTNAM,
            MST.SEQNUM,
            MST.PLTFLG,
            MST.STDPCS,
            MST.STDWGT,
            MST.SLCPCS,
            MST.SCCCOD,
            MST.SHPDES,
            MST.ORGCOD,
            MST.GRSVOL,
            MST.DSTCOD,
            MST.PRDNAM,
            MST.PRDPRT,
            DTL.PLTUSEFLG,
            MST.CNSNAM,
            MST.CNSADRONE,
            MST.SHPNAM,
            MST.SHPCOD,
            MST.CNSCOD,
            MST.SHPADRONE,
            MST.SHPSTA,
            MST.EXEFLG,
            ARPSHP.AVLPCS,
            ARPSHP.AVLWGT,
            ARPSHP.AVLVOL,
            MST.GRSVOLUNT,
            MST.STDWGTCOD,
            MST.STDDISWGT,
            ARPSHP.PLTUSEFLG ARPSHPPLTUSEFLG,
            MST.CONFLG,
            MST.HSEFINFLG,
            ARPSHP.ACPPCS,
            ARPSHP.ACPWGT,
           ACC.JRNDAT,
            MST.LSTUPDTIM MSTLSTUPDTIM,
            MST.LSTUPDUSR MSTLSTUPDUSR,
            DTL.LSTUPDTIM DTLLSTUPDTIM,
            DTL.LSTUPDUSR DTLLSTUPDUSR,
            ARPSHP.LSTUPDTIM ARPSHPLSTUPDTIM,
            ARPSHP.LSTUPDUSR ARPSHPLSTUPDUSR,
            MIS.CRSREFONE,
            MST.SRCIND,
            MIS.CRSREFTWO ,
            MST.EXEDAT,
            ARPSHP.RCVPCS,
            ARPSHP.RCVWGT,
            MST.RDYCRGFLG,
            ARPSHP.BDPPCS,
            ARPSHP.BDPWGT,
            ARPSHP.ULDPCS,
            ARPSHP.ULDWGT ,
            MST.DTACPTFLG,
            ARPSHP.DOCRCVFLG,
            ARPSHP.DCSREQFLG,
            (SELECT SUM(NUMPCS)
            FROM OPRULDSHP OUS
            WHERE OUS.CMPCOD  = MST.CMPCOD
            AND OUS.MSTDOCNUM =MST.MSTDOCNUM
            AND OUS.DUPNUM    =MST.DUPNUM
            AND OUS.SEQNUM    =MST.SEQNUM
            AND OUS.DOCOWRIDR = MST.DOCOWRIDR
            AND OUS.ARPCOD    = ARPSHP.ARPCOD
            ) TOTULDPCS,
            (SELECT SUM(WGT)
            FROM OPRULDSHP OUS
            WHERE OUS.CMPCOD  = MST.CMPCOD
            AND OUS.MSTDOCNUM =MST.MSTDOCNUM
            AND OUS.DUPNUM    =MST.DUPNUM
            AND OUS.SEQNUM    =MST.SEQNUM
            AND OUS.DOCOWRIDR = MST.DOCOWRIDR
            AND OUS.ARPCOD    = ARPSHP.ARPCOD
            ) TOTULDWGT,
            MIS.SCICOD,
            MST.DOMFLG,
            ADLCNT.CNTCTY,
            ADLCNT.CNTCTR,
            ADLCNT.CNTPSTCOD,
            ADLCNT.CNTSTT,
            ADLCNT.CNTTELNUM,
            ADLCNT.CNSMALIDR,
            ADLCNT.CNTERINUM,
            ADLCNT.CTTCUSCOD CNTCOD,
            ADLCNT.CTTCUSNAM CNTNAM,
            ADLCNT.CNTADR,
            ADLCNT.CNTTYP,
            NVL(
           (SELECT 'Y'
            FROM OPRSHPDGR DGRDET
            WHERE DGRDET.CMPCOD  = MST.CMPCOD
            AND DGRDET.MSTDOCNUM = MST.MSTDOCNUM
            AND DGRDET.DUPNUM    = MST.DUPNUM
            AND DGRDET.SEQNUM    = MST.SEQNUM
            AND DGRDET.DOCOWRIDR = MST.DOCOWRIDR
            ), 'N') DGRDTLIND,
            NVL(
            (SELECT 'Y'
            FROM shrsccmst scc
            WHERE MST.CMPCOD                                          = scc.CMPCOD
            AND scc.dgrind                                            = 'Y'
            AND Pkg_Frmwrk.Fun_String_Check(MST.SCCCOD,scc.scccod,',')>0
            ),'N') DGRIND,
            SYSPAR.PARVAL,
            Pkg_Frmwrk.Fun_String_Check(MST.SCCCOD,CUSAGT.SCCCOD,',') SCCMATVAL,
            CUSAGT.SCCCOD CUSSCCCOD,
            CUSAGT.AGTCOD CUSAGTCOD,
            CUSAGT.CUSCOD,
            MST.UBRNUM,
            (SELECT FLDDES GRSVOLUNTDES
            FROM SHRONETIM SOT
            WHERE SOT.CMPCOD=MST.CMPCOD
            AND SOT.FLDTYP  ='shared.defaults.volumeUnitCodes'
            AND SOT.FLDVAL  =MST.GRSVOLUNT
            ) STDVOLCODDES,
            (SELECT FLDDES STDWGTCODSES
            FROM SHRONETIM SOT
            WHERE SOT.CMPCOD=MST.CMPCOD
            AND SOT.FLDTYP  ='shared.defaults.weightUnitCodes'
            AND SOT.FLDVAL  =MST.STDWGTCOD
            ) STDWGTCODDES,
            MST.GRSDISVOL,
            DTL.APRFLG,
            DTL.ACPFNLFLG,
            ARPSHP.TOTDLVPCS,
            DTL.DIMCPTSTA,
            SHPDGR.DGDFLG
          FROM OPRSHPMST MST
          INNER JOIN OPRSHPMSTACC ACC
          ON MST.CMPCOD     = ACC.CMPCOD
          AND MST.DOCOWRIDR = ACC.DOCOWRIDR
          AND MST.MSTDOCNUM = ACC.MSTDOCNUM
          AND MST.DUPNUM    = ACC.DUPNUM
          AND MST.SEQNUM    = ACC.SEQNUM
          LEFT OUTER JOIN OPRSHPMSTMIS MIS
          ON MST.CMPCOD     = MIS.CMPCOD
          AND MST.DOCOWRIDR = MIS.DOCOWRIDR
          AND MST.MSTDOCNUM = MIS.MSTDOCNUM
          AND MST.DUPNUM    = MIS.DUPNUM
          AND MST.SEQNUM    = MIS.SEQNUM
          LEFT OUTER JOIN OPRSHPDTL DTL
          ON MST.CMPCOD     = DTL.CMPCOD
          AND MST.DOCOWRIDR = DTL.DOCOWRIDR
          AND MST.MSTDOCNUM = DTL.MSTDOCNUM
          AND MST.DUPNUM    = DTL.DUPNUM
          AND MST.SEQNUM    = DTL.SEQNUM
          LEFT OUTER JOIN OPRARPSHP ARPSHP
          ON MST.CMPCOD     = ARPSHP.CMPCOD
          AND MST.DOCOWRIDR = ARPSHP.DOCOWRIDR
          AND MST.MSTDOCNUM = ARPSHP.MSTDOCNUM
          AND MST.DUPNUM    = ARPSHP.DUPNUM
          AND MST.SEQNUM    = ARPSHP.SEQNUM
          AND ARPSHP.ARPCOD = ?
          LEFT OUTER JOIN SHRSYSPAR SYSPAR
          ON MST.CMPCOD     = SYSPAR.CMPCOD
          AND SYSPAR.PARCOD = 'operation.shipment.clearingagentoftheAWB'
          LEFT OUTER JOIN OPRSHPADLCNT ADLCNT
          ON MST.CMPCOD     = ADLCNT.CMPCOD
          AND MST.DOCOWRIDR = ADLCNT.DOCOWRIDR
         AND MST.MSTDOCNUM = ADLCNT.MSTDOCNUM
          AND MST.DUPNUM    = ADLCNT.DUPNUM
          AND MST.SEQNUM    = ADLCNT.SEQNUM
          LEFT OUTER JOIN OPRSHPDGRMIS SHPDGR
          ON MST.CMPCOD     = SHPDGR.CMPCOD
          AND MST.DOCOWRIDR =SHPDGR.DOCOWRIDR
          AND MST.MSTDOCNUM =SHPDGR.MSTDOCNUM
          AND MST.DUPNUM    =SHPDGR.DUPNUM
          AND MST.SEQNUM    =SHPDGR.SEQNUM
          LEFT OUTER JOIN SHRCUSAGT CUSAGT
          ON MST.CMPCOD                                                                       = CUSAGT.CMPCOD
          AND MST.CNSCOD                                                                      = CUSAGT.CUSCOD
          AND CUSAGT.IMPFLG                                                                   = ?
          AND CUSAGT.STNCOD                                                                   = ?    
          AND Pkg_Frmwrk.Fun_String_Check(MST.SCCCOD,COALESCE(CUSAGT.SCCCOD, MST.SCCCOD),',') > 0
          WHERE MST.CMPCOD                                                                    = ?
          AND MST.DOCOWRIDR                                                                   = ?
          AND MST.MSTDOCNUM                                                                   = ?
          AND MST.DUPNUM                                                                      = ?          
          AND MST.SEQNUM                                                                      = ?    
	]]>
</QRY:Source>
</QRY:Definition>


<QRY:Definition>
<QRY:Id>42</QRY:Id>
<QRY:Source Name="operations.shipment.finduniddetailsforshipment" Type="NATIVE">
	<![CDATA[
		SELECT DGR.CMPCOD,
			  DGR.DOCOWRIDR,
			  DGR.DUPNUM,
			  DGR.MSTDOCNUM,
			  Dgr.Netqty,
			  Dgr.NETQTYUNT,
			  Dgr.Numpkg,
			  Dgr.Pkggrp,
			  DGR.SCCCOD,
			  DGR.SCCCODONE,
			  DGR.SCCCODTWO,
			  Dgr.Pkgins, 
			  Dgr.Pkgtyp,
			  Dgr.Seqnum,
			  Dgr.Sernum,
			  Dgr.Uniidr,
			  Dgr.Proshpnam,
			  Dgr.Rdoactflg,
			  Dgr.Rmc,
			  DGR.PKGGRPRMC,
			  Dgr.Shpcls,
			  Dgr.Subrskone,
			  Dgr.Subrsktwo ,
			  Dgr.Subrskthr ,
			  dgr.NOOFALLPACKS,
			  dgr.NOOFOVRPACKS,
			  dgr.ALLPCKSERNUM,
			  dgr.OVRPCKSERNUM,
			  dgr.ergcod,
			  dgr.PKGGRPDIMHGT,
			  dgr.PKGDIMHGT,
			  dgr.TECNAM,
			  dgr.TPTIND,
			  dgr.CARFLAG,
			  dgr.TOTTPTIND
			FROM OPRSHPDGR DGR
			WHERE DGR.CMPCOD = ?
			AND Dgr.Mstdocnum = ?
			AND Dgr.Docowridr = ?
			AND Dgr.Seqnum = ?
			AND DGR.DUPNUM = ?
			ORDER BY DGR.SERNUM
	]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>43</QRY:Id>
<QRY:Source Name="operations.shipment.findshipmentdetailsforbooking" Type="NATIVE">
	<![CDATA[

		SELECT MST.MSTDOCNUM, MST.CMPCOD MSTCMPCOD, MST.DOCOWRIDR MSTDOCOWRIDR,MST.SRCIND,
						       MST.DUPNUM MSTDUPNUM, MST.SEQNUM MSTSEQNUM, MST.DOCNUM, ACC.JRNDAT,
						       MST.PLTFLG, MST.SHPBNDFLG, MST.DOCTYP, MST.PARSEQNUM, MST.SHPPFX,
						       MST.SHPSTA, MST.SHPTYP, MST.UBRNUM, MST.CONFLG, ACC.IATCOD,MST.RDYCRGFLG,MST.STKHLDCOD,
						       CNT.CNSACCNUM, MST.CNSADRONE, CNT.CNSADRTWO, MST.CNSCOD, CNT.CNSCTR,
						       CNT.CNSCTY, CNT.CNSMALIDR, MST.CNSNAM, CNT.CNSPRTNFNFLG, CNT.CNSPSTCOD,
						       CNT.CNSSTT, CNT.CNSTELNUM, CNT.SHPACCNUM, MST.SHPADRONE, CNT.SHPADRTWO,
						       MST.SHPCOD, CNT.SHPCTR, CNT.SHPCTY, CNT.SHPMALIDR, MST.SHPNAM,
						       CNT.SHPPSTCOD, MST.SHPSTA, CNT.SHPSTT, CNT.SHPTELNUM, MST.AGTCOD,
						       MST.AGTNAM, ACC.CASCOD, MST.SCCCOD, MST.STDDISWGT, MST.STDPCS,
						       MST.STDWGT, MST.STDWGTCOD, MST.HDLINF, MST.SHPDES, MST.ORGCOD,
						       MST.DSTCOD, MIS.SCICOD, MIS.REQRTG, MST.SPTRATIDR,
						       MST.PAYTYP MSTPAYTYP, ACC.DVLCUS, ACC.DVLCAR, MST.CURCOD,
						       MST.EXEUSRCOD, MST.EXESTN, MST.EXEFLG, MST.EXEDAT, ACC.ACCINF,
						       ACC.INSMINAMT, ACC.INSAMT, MST.PRDNAM, MST.PRDPRT, MIS.TRTMOD,
						       ACC.RATCONIDR, ACC.VALCCCHG, ACC.VALPPCHG, ACC.WGTCCCHG,
						       ACC.WGTPPCHG, ACC.TOTDUEAGTCCCHG, ACC.TOTDUEAGTPPCHG,
						       ACC.TOTDUECARCCCHG, ACC.TOTDUECARPPCHG, MST.GRSDISVOL,
						       MST.GRSVOL, MST.GRSVOLUNT, MST.OWRCOD MSTOWRCOD,
						       FLT.FLTDAT FLTFLTDAT, FLT.DUPNUM FLTDUPNUM, FLT.SEGSERNUM FLTSEGSERNUM,
						       FLT.FLTNUM FLTFLTNUM, FLT.DOCOWRIDR FLTDOCOWRIDR, FLT.SEQNUM FLTSEQNUM,
						       FLT.FLTCARIDR FLTFLTCARIDR, FLT.RTGSERNUM FLTRTGSERNUM,
						       FLT.RTESEQNUM FLTRTESEQNUM, FLT.FLTSEQNUM FLTFLTSEQNUM,
						       FLT.MSTDOCNUM FLTMSTDOCNUM, FLT.DSTCOD RTGDSTCOD,
						       FLT.FLTCARCOD FLTFLTCARCOD, FLT.CMPCOD FLTCMPCOD, CHG.CHGHEDIDR,
						       CHG.CHGAMT, CHG.PAYTYP CHGPAYTYP, CHG.DUECARFLG, CHG.DUEAGTFLG,
						       CHG.CHGRMK, CHG.CHGHED, CHG.CMPCOD CHGCMPCOD,
						       CHG.DOCOWRIDR CHGDOCOWRIDR, CHG.MSTDOCNUM CHGMSTDOCNUM,
						       CHG.DUPNUM CHGDUPNUM, CHG.SEQNUM CHGSEQNUM, CHG.CHDCOD,RAT.TAX RATTAX,
								RAT.TAXPCT RATTAXPCT,CHG.TAX CHGTAX,CHG.TAXPCT CHGTAXPCT,
						       RAT.CMPCOD RATCMPCOD, RAT.DOCOWRIDR RATDOCOWRIDR,
						       RAT.MSTDOCNUM RATMSTDOCNUM, RAT.DUPNUM RATDUPNUM, RAT.SEQNUM RATSEQNUM,
						       RAT.RATLINSERNUM RATRATLINSERNUM, RAT.NUMPCS RATNUMPCS, RAT.GRSWGT,
						       RAT.GRSVOL RATGRSVOL, RAT.CMDITMNUM, RAT.CMDITMNAM,
						       RAT.IATRATCLS, RAT.ARLRATCLS, RAT.ACTRATCLS,
						       RAT.IATRAT, RAT.ARLRAT, RAT.CHGWGT, RAT.RATDES, RAT.ARLRATLINIDR,
						       RAT.IATRATLINIDR, RAT.CRTREF,RAT.IATTRFNAM,RAT.ARLTRFNAM,
						       RAT.SCCCOD RATSCCCOD, RAT.OVRFLWFLG,
						       RAT.IATCOD RATIATCOD, RAT.IATCHG, RAT.NETCHG, RAT.DSCPCT,
						       RAT.ALNBSECHG, RAT.ALNCHG, RAT.IATBSECHG, RAT.GRSDISWGT,
						       RAT.GRSWGTCOD, RAT.ARLTRFRATSERNUM ARLTRFSERNUM,RAT.IATTRFRATSERNUM IATTRFSERNUM,RAT.ADJWGT,
						       DIM.CMPCOD DIMCMPCOD, DIM.DOCOWRIDR DIMDOCOWRIDR,
						       DIM.MSTDOCNUM DIMMSTDOCNUM, DIM.DUPNUM DIMDUPNUM, DIM.SEQNUM DIMSEQNUM,
						       DIM.RATLINSERNUM, DIM.DIMSERNUM, DIM.PCSLEN, DIM.PCSHGT, DIM.PCSWID,
						       DIM.PCSVOL, DIM.NUMPCS, DIM.WGT DIMWGT, DIM.DISWGT DIMDISWGT, DIM.TILTBL,
						       DIM.WGTCOD DIMWGTCOD, OTH.CMPCOD OTHCMPCOD, OTH.DOCOWRIDR OTHDOCOWRIDR,
						       OTH.MSTDOCNUM OTHMSTDOCNUM, OTH.DUPNUM OTHDUPNUM, OTH.SEQNUM OTHSEQNUM,
						       OTH.SRVCOD OTHOTHSRVINF,dtl.TOTACPPCS,mst.DTACPTFLG,ACC.SPTRAT, ACC.SPTRATREQDAT, ACC.SPTRATAPRDAT,
							    ACC.SPTRATSTA, ACC.RATCONREQDAT, ACC.RATCONAPRDAT, ACC.RATCONSTA,ACC.UNQREFONE, ACC.UNQREFTWO, ACC.HGRWGTBRK,
								ACC.UNQREFTHR, ACC.UNQREFFOR, ACC.UNQREFFIV,RAT.IATULDTYP,RAT.NUMULD,MST.LSTUPDTIM LSTUPDTIM,MIS.DOCSUBTYP,MIS.JNVPAR,
								RAT.ALLINNRATFLG,RAT.ALLINNATR, RAT.ADDARLRATLINIDS ,RAT.MINCHGAPDFLG, RAT.TRKOALRATFLG,RAT.ARLRATTYP,
								CNT.SHPCFTNUM, CNT.SHPCFTTYP,ULD.CMPCOD ULDCMPCOD,ULD.DOCOWRIDR ULDDOCOWRIDR,ULD.MSTDOCNUM ULDMSTDOCNUM,ULD.DUPNUM ULDDUPNUM,ULD.SEQNUM ULDSEQNUM,ULD.RATLINSERNUM ULDRATLINSERNUM,
								ULD.SERNUM ULDSERNUM, ULD.ULDNUM ULDNUM,ULD.SLCPCS ULDSLCPCS
						  FROM OPRSHPMST MST,
						       OPRSHPRTG FLT,
						       OPRSHPCHGDTL CHG,
						       OPRSHPRATDTL RAT,
						       OPRSHPDIMDTL DIM,
						       OPRSHPSRV OTH,
						       OPRSHPMSTACC ACC,
						       OPRSHPMSTMIS MIS,
						       OPRSHPMSTCNT CNT,
							   oprshpdtl dtl,
							   OPRSHPRATULD ULD
						 WHERE MST.CMPCOD = dtl.CMPCOD(+)
						   AND MST.DOCOWRIDR = dtl.DOCOWRIDR(+)
						   AND MST.MSTDOCNUM = dtl.MSTDOCNUM(+)
						   AND MST.DUPNUM = dtl.DUPNUM(+)
						   AND MST.SEQNUM = dtl.SEQNUM(+)

						   and MST.CMPCOD = FLT.CMPCOD(+)
						   AND MST.DOCOWRIDR = FLT.DOCOWRIDR(+)
						   AND MST.MSTDOCNUM = FLT.MSTDOCNUM(+)
						   AND MST.DUPNUM = FLT.DUPNUM(+)
						   AND MST.SEQNUM = FLT.SEQNUM(+)
						   AND MST.CMPCOD = CHG.CMPCOD(+)
						   AND MST.DOCOWRIDR = CHG.DOCOWRIDR(+)
						   AND MST.MSTDOCNUM = CHG.MSTDOCNUM(+)
						   AND MST.DUPNUM = CHG.DUPNUM(+)
						   AND MST.SEQNUM = CHG.SEQNUM(+)
						   AND MST.CMPCOD = OTH.CMPCOD(+)
						   AND MST.DOCOWRIDR = OTH.DOCOWRIDR(+)
						   AND MST.MSTDOCNUM = OTH.MSTDOCNUM(+)
						   AND MST.DUPNUM = OTH.DUPNUM(+)
						   AND MST.SEQNUM = OTH.SEQNUM(+)
						   AND MST.CMPCOD = RAT.CMPCOD(+)
						   AND MST.DOCOWRIDR = ACC.DOCOWRIDR
						   AND MST.MSTDOCNUM = ACC.MSTDOCNUM
						   AND MST.DUPNUM = ACC.DUPNUM
						   AND MST.SEQNUM = ACC.SEQNUM
						   AND MST.CMPCOD = ACC.CMPCOD
						   AND MST.DOCOWRIDR = MIS.DOCOWRIDR
						   AND MST.MSTDOCNUM = MIS.MSTDOCNUM
						   AND MST.DUPNUM = MIS.DUPNUM
						   AND MST.SEQNUM = MIS.SEQNUM
						   AND MST.CMPCOD = MIS.CMPCOD
						   AND MST.DOCOWRIDR = CNT.DOCOWRIDR
						   AND MST.MSTDOCNUM = CNT.MSTDOCNUM
						   AND MST.DUPNUM = CNT.DUPNUM
						   AND MST.SEQNUM = CNT.SEQNUM
						   AND MST.CMPCOD = CNT.CMPCOD
						   AND MST.DOCOWRIDR = RAT.DOCOWRIDR(+)
						   AND MST.MSTDOCNUM = RAT.MSTDOCNUM(+)
						   AND MST.DUPNUM = RAT.DUPNUM(+)
						   AND MST.SEQNUM = RAT.SEQNUM(+)
						   AND RAT.CMPCOD = DIM.CMPCOD(+)
						   AND RAT.DOCOWRIDR = DIM.DOCOWRIDR(+)
						   AND RAT.MSTDOCNUM = DIM.MSTDOCNUM(+)
						   AND RAT.DUPNUM = DIM.DUPNUM(+)
						   AND RAT.SEQNUM = DIM.SEQNUM(+)
						   AND RAT.RATLINSERNUM = DIM.RATLINSERNUM(+)
						   AND RAT.CMPCOD      =ULD.CMPCOD(+)
						   AND RAT.DOCOWRIDR   =ULD.DOCOWRIDR(+)
						   AND RAT.MSTDOCNUM   =ULD.MSTDOCNUM(+)
						   AND RAT.DUPNUM      =ULD.DUPNUM(+)
						   AND RAT.SEQNUM      =ULD.SEQNUM(+)
						   AND RAT.RATLINSERNUM=ULD.RATLINSERNUM(+) 
						   AND MST.CMPCOD = ?
						   AND MST.DOCOWRIDR = ?
						   AND MST.MSTDOCNUM = ?
						   AND MST.DUPNUM = ?
		   			 AND MST.SEQNUM = ?
	]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>44</QRY:Id>
<QRY:Source Name="operations.shipment.findlyinglistdetails" Type="NATIVE">
	<![CDATA[
		SELECT
			ARP.CMPCOD, ARP.DOCOWRIDR DOWOWRIDR,ARP.MSTDOCNUM MSTDOCNUM, ARP.DUPNUM DUPNUM,ARP.SEQNUM SEQNUM,
			ARP.AVLPCS AVLPCS ,ARP.AVLWGT AVLWGT,ARP.AVLVOL AVLVOL,
			SEGSHP.MFTPCS MFTPCS,
			SEGSHP.MFTWGT MFTWGT,
			SEGSHP.MFTVOL MFTVOL,
			RAT.CMDITMNAM CMDCOD,coalesce(RAT.ARLRAT,0)ARLRAT,DTL.ACPDAT ACPDAT, MST.SHPPFX SHPPFX, MST.AGTCOD AGTCOD,
			MST.ORGCOD ORGCOD, MST.DSTCOD DSTCOD, MST.UBRNUM UBRNUM, MST.LSTUPDTIM SHPLSTUPDTIM
			
			FROM OPRARPSHP ARP
				 INNER JOIN OPRSHPMST  MST ON
					 ARP.CMPCOD = MST.CMPCOD
					 AND ARP.DOCOWRIDR = MST.DOCOWRIDR
					 AND ARP.MSTDOCNUM = MST.MSTDOCNUM
					 AND ARP.DUPNUM = MST.DUPNUM
					 AND ARP.SEQNUM = MST.SEQNUM
				 INNER JOIN OPRSHPDTL DTL ON
					 ARP.CMPCOD = DTL.CMPCOD
					 AND ARP.DOCOWRIDR = DTL.DOCOWRIDR
					 AND ARP.MSTDOCNUM = DTL.MSTDOCNUM
					 AND ARP.DUPNUM = DTL.DUPNUM
					 AND ARP.SEQNUM = DTL.SEQNUM					
				 INNER JOIN OPRSHPRATDTL RAT ON
					 MST.CMPCOD = RAT.CMPCOD
					 AND MST.DOCOWRIDR = RAT.DOCOWRIDR
					 AND MST.MSTDOCNUM = RAT.MSTDOCNUM
					 AND MST.DUPNUM = RAT.DUPNUM
					 AND MST.SEQNUM = RAT.SEQNUM
					 AND MST.UBRNUM is NULL				
				 LEFT OUTER JOIN OPRSEGSHP SEGSHP ON
					 MST.CMPCOD = SEGSHP.CMPCOD
					 AND MST.DOCOWRIDR = SEGSHP.DOCOWRIDR
					 AND MST.MSTDOCNUM = SEGSHP.MSTDOCNUM
					 AND MST.DUPNUM = SEGSHP.DUPNUM
					 AND MST.SEQNUM = SEGSHP.SEQNUM
					 
				WHERE
					 MST.EXEFLG = 'Y'
					 AND (CASE WHEN ARP.AVLPCS >= 0 THEN 10 ELSE 100 END = 10)
					 AND ARP.CMPCOD = ?
					 AND ARP.ARPCOD = ?
					 AND MST.DSTCOD <> ?
	]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>45</QRY:Id>
<QRY:Source Name="operations.shipment.findBookingsForPrecarriage" Type="NATIVE">
	<![CDATA[
SELECT  BKGMST.CMPCOD AS CMPCOD,
		BKGMST.DOCOWRIDR AS DOCOWRIDR,
		BKGMST.MSTDOCNUM AS MSTDOCNUM,
		BKGMST.CUSNAM AS CUSNAM,
		BKGMST.DUPNUM AS DUPNUM,
		BKGMST.SEQNUM AS SEQNUM,
		BKGFLTDTL.FLTNUM AS FLTNUM,
		BKGFLTDTL.FLTDAT AS FLTDAT,
		BKGFLTDTL.FLTORG AS FLTORG,
		BKGFLTDTL.FLTDST AS FLTDST,
		BKGFLTDTL.NUMPCS AS NUMPCS,
		BKGFLTDTL.WGT AS WGT,
		BKGFLTDTL.VOL AS VOL,
		PREFLT.SERNUM AS SERNUM,
		PREFLT.PRECARPTY AS PRECARPTY,
		BKGMST.SHPPFX AS THRNUMCOD,
		BKGMST.OWRCOD AS TWOAPHCOD
FROM  CAPBKGFLTDTL BKGFLTDTL,CAPBKGMST BKGMST, OPRSHPPREFLT PREFLT,OPRSHPDTL SHPDTL
WHERE
	  		BKGMST.UBRNUM = BKGFLTDTL.UBRNUM
	  	AND BKGMST.CMPCOD = BKGFLTDTL.CMPCOD
		AND BKGMST.CMPCOD = PREFLT.CMPCOD(+)
		AND BKGMST.DOCOWRIDR = PREFLT.DOCOWRIDR(+)
		AND BKGMST.MSTDOCNUM = PREFLT.MSTDOCNUM(+)
		AND BKGMST.DUPNUM = PREFLT.DUPNUM(+)
		AND BKGMST.SEQNUM = PREFLT.SEQNUM(+)
		AND SHPDTL.CMPCOD = BKGMST.CMPCOD
		AND SHPDTL.DOCOWRIDR = BKGMST.DOCOWRIDR
		AND SHPDTL.MSTDOCNUM = BKGMST.MSTDOCNUM
		AND SHPDTL.DUPNUM = BKGMST.DUPNUM
		AND SHPDTL.SEQNUM = BKGMST.SEQNUM
		AND BKGFLTDTL.CMPCOD = ?
		AND PREFLT.CMPCOD(+) = ?
		AND BKGFLTDTL.FLTORG = ?
		AND BKGFLTDTL.FLTDST = ?
		AND PREFLT.FLTCARIDR(+) = ?
		AND PREFLT.FLTNUM(+) = ?
		AND PREFLT.FLTSEQNUM(+) = ?
		AND PREFLT.POL(+) = ?
		AND PREFLT.POU(+) = ?
		AND NOT (BKGFLTDTL.FLTCARIDR = ? AND
		BKGFLTDTL.FLTNUM = ?
		AND BKGFLTDTL.FLTSEQNUM = ?)
	]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>46</QRY:Id>
<QRY:Source Name="operations.shipment.findShipmentsAtAirport" Type="NATIVE">
	<![CDATA[
SELECT ARPSHP.CMPCOD AS CMPCOD,
	   ARPSHP.DOCOWRIDR AS DOCOWRIDR,
	   ARPSHP.MSTDOCNUM AS MSTDOCNUM,
       ARPSHP.DUPNUM AS DUPNUM,
	   ARPSHP.SEQNUM AS SEQNUM,
	   ARPSHP.AVLPCS AS AVLPCS,
	   ARPSHP.AVLVOL AS AVLVOL,
	   ARPSHP.AVLWGT AS AVLWGT,
	   PREFLT.PRECARPTY AS PRECARPTY,
	   PREFLT.SERNUM AS SERNUM,
    MST.SHPPFX AS THRNUMCOD,
    MST.OWRCOD AS TWOAPHCOD
FROM  OPRARPSHP ARPSHP,OPRSHPPREFLT PREFLT,OPRSHPMST MST
WHERE
    ARPSHP.MSTDOCNUM = PREFLT.MSTDOCNUM(+) AND
	ARPSHP.DOCOWRIDR = PREFLT.DOCOWRIDR(+) AND
	ARPSHP.DUPNUM = PREFLT.DUPNUM(+) AND
	ARPSHP.SEQNUM = PREFLT.SEQNUM(+) AND
	ARPSHP.CMPCOD = PREFLT.CMPCOD(+) AND
 MST.MSTDOCNUM = ARPSHP.MSTDOCNUM AND
 MST.DOCOWRIDR = ARPSHP.DOCOWRIDR AND
 MST.DUPNUM = ARPSHP.DUPNUM AND
 MST.SEQNUM = ARPSHP.SEQNUM AND
 MST.CMPCOD = ARPSHP.CMPCOD
 AND ARPSHP.ARPCOD = ''
 AND PREFLT.FLTCARIDR(+) = ''
 AND PREFLT.FLTNUM(+) = ''
 AND PREFLT.FLTSEQNUM(+) = ''
	]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>47</QRY:Id>
<QRY:Source Name="operations.shipment.findShipmentsUldAtAirport" Type="NATIVE">
	<![CDATA[
SELECT ULDSHP.CMPCOD AS CMPCOD,
	    ULDSHP.DOCOWRIDR AS DOCOWRIDR,
		ULDSHP.MSTDOCNUM AS MSTDOCNUM,
		ULDSHP.DUPNUM AS DUPNUM,
		ULDSHP.SEQNUM AS SEQNUM,
		PREFLT.SERNUM AS SERNUM,
		ULDSHP.ULDNUM AS ULDNUM,
		ULDSHP.WGT AS WGT,
		ULDSHP.VOL AS VOL,
		ULDSHP.NUMPCS AS NUMPCS,
		PREFLT.PRECARPTY AS PRECARPTY,
  MST.SHPPFX AS THRNUMCOD,
  MST.OWRCOD AS TWOAPHCOD
FROM  OPRULDSHP ULDSHP,OPRSHPPREFLT PREFLT,OPRSHPMST MST
WHERE
	ULDSHP.CMPCOD = PREFLT.CMPCOD(+) AND
	ULDSHP.DOCOWRIDR = PREFLT.DOCOWRIDR(+) AND
	ULDSHP.MSTDOCNUM = PREFLT.MSTDOCNUM(+) AND
	ULDSHP.DUPNUM = PREFLT.DUPNUM(+) AND
	ULDSHP.SEQNUM = PREFLT.SEQNUM(+) AND
 MST.CMPCOD = ULDSHP.CMPCOD AND
 MST.DOCOWRIDR = ULDSHP.DOCOWRIDR AND
 MST.MSTDOCNUM = ULDSHP.MSTDOCNUM AND
 MST.DUPNUM = ULDSHP.DUPNUM AND
 MST.SEQNUM = ULDSHP.SEQNUM
	AND ULDSHP.ARPCOD = ?
	AND PREFLT.FLTCARIDR(+) = ?
	AND PREFLT.FLTNUM(+) = ?
	AND PREFLT.FLTSEQNUM(+) = ?

	]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>48</QRY:Id>
<QRY:Source Name="operations.shipment.findallhouses" Type="NATIVE">
	<![CDATA[
		SELECT MST.MSTDOCNUM, MST.DOCOWRIDR,
		MST.DUPNUM, MST.SEQNUM, MST.CMPCOD
		FROM OPRSHPMST  MST
		WHERE
		MST.CMPCOD=? AND
		MST.DOCOWRIDR=? AND
		MST.MSTDOCNUM=? AND
		MST.DUPNUM=?
	]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>50</QRY:Id>
<QRY:Source Name="operations.shipment.findflightdiscrepancy" Type="NATIVE">
	<![CDATA[
		SELECT DIS.CMPCOD DISCMPCOD, DIS.DOCOWRIDR DISDOCOWRIDR,
		       DIS.MSTDOCNUM DISMSTDOCNUM, DIS.DUPNUM DISDUPNUM, DIS.SEQNUM DISSEQNUM,
		       DIS.ARPCOD DISARPCOD, DIS.DISCOD DISDISCOD, DIS.DISSEQNUM DISDISSEQNUM,
		       DIS.DOCNUM DISDOCNUM, DIS.CRTTIM DISCRTTIM, DIS.FLTCARCOD DISFLTCARCOD,
		       DIS.FLTCARIDR DISFLTCARIDR, DIS.FLTDAT DISFLTDAT, DIS.FLTNUM DISFLTNUM,
		       DIS.FLTSEQNUM DISFLTSEQNUM, DIS.SHPTYP DISSHPTYP, DIS.DISSTA DISDISSTA,
		       DIS.TOTDISPCS DISTOTDISPCS, DIS.TOTDISWGT DISTOTDISWGT,
		       DIS.TOTRSLPCS DISTOTRSLPCS, DIS.TOTRSLWGT DISTOTRSLWGT,
		       MST.CMPCOD MSTCMPCOD, MST.DOCOWRIDR MSTDOCOWRIDR, MST.SHPPFX MSTSHPPFX,
		       MST.MSTDOCNUM MSTMSTDOCNUM, MST.DUPNUM MSTDUPNUM, MST.SEQNUM MSTSEQNUM,
		       MST.UBRNUM MSTUBRNUM, MST.STDPCS MSTSTDPCS, MST.STDWGT MSTSTDWGT,
		       MST.SCCCOD MSTSCCCOD, MST.ORGCOD MSTORGCOD, MST.DSTCOD MSTDSTCOD,
		       MST.SHPDES MSTSHPDES, SEG.DOCOWRIDR SEGDOCOWRIDR,
		       SEG.MSTDOCNUM SEGMSTDOCNUM, SEG.DUPNUM SEGDUPNUM, SEG.SEQNUM SEGSEQNUM,
		       SEG.FLTNUM SEGFLTNUM, SEG.FLTSEQNUM SEGFLTSEQNUM,
		       SEG.SEGSERNUM SEGSEGSERNUM, SEG.FLTCARIDR SEGFLTCARIDR,
		       SEG.CMPCOD SEGCMPCOD, SEG.MFTPCS SEGMFTPCS, SEG.MFTWGT SEGMFTWGT,
		       SEG.MFTVOL SEGMFTVOL, SEG.RCVPCS SEGRCVPCS, SEG.RCVWGT SEGRCVWGT,
		       SEG.RCVVOL SEGRCVVOL
		  FROM OPRSHPDIS DIS, OPRSEGSHP SEG, OPRSHPMST  MST
		 WHERE DIS.MSTDOCNUM = MST.MSTDOCNUM(+)
		   AND DIS.DOCOWRIDR = MST.DOCOWRIDR(+)
		   AND DIS.DUPNUM = MST.DUPNUM(+)
		   AND DIS.SEQNUM = MST.SEQNUM(+)
		   AND DIS.CMPCOD = MST.CMPCOD(+)
		   AND DIS.MSTDOCNUM = SEG.MSTDOCNUM(+)
		   AND DIS.DOCOWRIDR = SEG.DOCOWRIDR(+)
		   AND DIS.DUPNUM = SEG.DUPNUM(+)
		   AND DIS.SEQNUM = SEG.SEQNUM(+)
		   AND DIS.CMPCOD = SEG.CMPCOD(+)
		   AND DIS.FLTNUM = SEG.FLTNUM(+)
		   AND DIS.FLTSEQNUM = SEG.FLTSEQNUM(+)
		   AND DIS.FLTCARIDR = SEG.FLTCARIDR(+)
		   AND DIS.CMPCOD = ?
		   AND DIS.FLTNUM = ?
		   AND DIS.FLTSEQNUM = ?
		   AND DIS.FLTCARIDR = ?
   		   AND DIS.ARPCOD = ?
  ]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>51</QRY:Id>
<QRY:Source Name="operations.shipment.isawbmanifestedfromairport" Type="NATIVE">
	<![CDATA[
		SELECT SHP.CMPCOD,SHP.MSTDOCNUM, SHP.MFTPCS FROM
		OPRSEGSHP SHP,OPRFLTSEG FLT
		WHERE  SHP.FLTCARIDR=FLT.FLTCARIDR AND
		       SHP.FLTNUM=FLT.FLTNUM AND
			   SHP.FLTSEQNUM=FLT.FLTSEQNUM AND
			   SHP.SEGSERNUM=FLT.SEGSERNUM AND
			   SHP.DOCOWRIDR=?  AND
			   SHP.MSTDOCNUM=? AND
			   SHP.DUPNUM=? AND
			   SHP.SEQNUM=? AND
			   SHP.CMPCOD=? AND
			   FLT.FLTCARIDR=? AND
			   FLT.FLTNUM=? AND
			   FLT.FLTSEQNUM=? AND
	                   FLT.POU=?
	]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>52</QRY:Id>
<QRY:Source Name="operations.shipment.finddamagediscrepancy" Type="NATIVE">
	<![CDATA[
		SELECT DMG.DUPNUM DMGDUPNUM, DMG.SEQNUM DMGSEQNUM, DMG.MSTDOCNUM DMGMSTDOCNUM,
			       DMG.DOCOWRIDR DMGDOCOWRIDR, DMG.ARPCOD DMGARPCOD,
			       DMG.DISSEQNUM DMGDISSEQNUM, DMG.CMPCOD DMGCMPCOD,
			       DMG.FLTCARCOD DMGFLTCARCOD, DMG.FLTCARIDR DMGFLTCARIDR,
			       DMG.FLTNUM DMGFLTNUM, DMG.FLTDAT DMGFLTDAT, DMG.FLTSEQNUM DMGFLTSEQNUM,
			       DMG.DMGCOD DMGDMGCOD, DMG.DISDAT DMGDISDAT, DMG.IMGPTH, DMG.RMK DMGRMK,
			       DMG.DISSTA DMGDISSTA, MST.SHPPFX, MST.STDPCS, MST.STDWGT,MST.SCCCOD
			  FROM OPRDMGDIS DMG, OPRSHPMST  MST
			 WHERE DMG.DUPNUM = MST.DUPNUM
			   AND DMG.SEQNUM = MST.SEQNUM
			   AND DMG.MSTDOCNUM = MST.MSTDOCNUM
			   AND DMG.DOCOWRIDR = MST.DOCOWRIDR
			   AND DMG.CMPCOD = MST.CMPCOD
			   AND DMG.CMPCOD = ?
			   AND DMG.FLTNUM = ?
			   AND DMG.FLTSEQNUM = ?
			   AND DMG.FLTCARIDR = ?
   		   AND DMG.ARPCOD = ?
	]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>53</QRY:Id>
<QRY:Source Name="operations.shipment.findfswrdiscrepancy" Type="NATIVE">
	<![CDATA[
		SELECT FNDSHP.FLTCARCOD FNDSHPFLTCARCOD, FNDSHP.FLTCARIDR FNDSHPFLTCARIDR,
		       FNDSHP.FLTDAT FNDSHPFLTDAT, FNDSHP.FLTNUM FNDSHPFLTNUM,
		       FNDSHP.FLTSEQNUM FNDSHPFLTSEQNUM, FNDSHP.FNDSHPNUM FNDSHPFSNUM,
		       FNDSHP.TOTDISPCS FNDSHPTOTDISPCS, FNDSHP.TOTDISWGT FNDSHPTOTDISWGT,
		       FNDSHP.TOTRSLPCS FNDSHPTOTRSLPCS, FNDSHP.TOTRSLWGT FNDSHPTOTRSLWGT,
		       FNDSHP.ARPCOD FNDSHPARPCOD, FNDSHP.DISDAT FNDSHPDISDAT,FNDSHP.CMPCOD
		       ,FNDSHP.FNDSHPSTA
		  FROM OPRFNDSHP FNDSHP
		 WHERE FNDSHP.CMPCOD = ?
		   AND FNDSHP.FLTNUM(+) = ?
		   AND FNDSHP.FLTSEQNUM(+) = ?
  		   AND FNDSHP.FLTCARIDR(+) = ?
  		   AND FNDSHP.ARPCOD = ?
	]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>54</QRY:Id>
<QRY:Source Name="operations.shipment.findfoundshipments" Type="NATIVE">
	<![CDATA[
			SELECT
					MST.CMPCOD MSTCMPCOD, MST.ARPCOD MSTARPCOD, MST.FLTCARCOD MSTFLTCARCOD,
					MST.FLTCARIDR MSTFLTCARIDR, MST.FLTNUM MSTFLTNUM, MST.FLTSEQNUM MSTFLTSEQNUM,
					MST.FNDSHPNUM MSTFNDSHPNUM, MST.FLTDAT MSTFLTDAT,	MST.TOTDISPCS MSTTOTDISPCS,
					MST.TOTDISWGT MSTTOTDISWGT, MST.TOTRSLPCS MSTTOTRSLPCS, MST.TOTRSLWGT MSTTOTRSLWGT,
					MST.FNDSHPSTA MSTFNDSHPSTA, MST.DISDAT MSTDISDAT,MST.LSTUPDTIM,MST.LSTUPDUSR,
					BLB.FNDSHPIMG MSTFNDSHPIMG,
					DTL.FNDSHPNUM DTLFNDSHPNUM, DTL.FNDSHPSERNUM DTLFNDSHPSERNUM,
					DTL.ORGCOD DTLORGCOD, DTL.DSTCOD DTLDSTCOD, DTL.ULDNUM DTLULDNUM,
					DTL.PCS DTLPCS, DTL.WGT DTLWGT, DTL.SCC DTLSCC, DTL.SHPDES DTLSHPDES,
					DTL.PKGDTL DTLPKGDTL, DTL.RMK DTLRMK,
					DIM.PCSLEN DIMPCSLEN, DIM.PCSHGT DIMPCSHGT, DIM.PCSWID DIMPCSWID,
					DIM.PCS DIMPCS, DIM.WGT DIMWGT, DIM.PCSVOL DIMPCSVOL,	DIM.DIMSERNUM DIMDIMSERNUM,
					RES.OWRIDR RESOWRIDR, RES.MSTDOCNUM RESMSTDOCNUM, RES.DUPNUM RESDUPNUM, RES.SEQNUM RESSEQNUM,
					RES.ARLIDR RESARLIDR, RES.FLTNUM RESFLTNUM,
					RES.FLTSEQNUM RESFLTSEQNUM, RES.FLTDAT RESFLTDAT, RES.ULDNUM RESULDNUM,
					RES.RESPCS RESRESPCS, RES.RESWGT RESRESWGT, RES.RESRMK RESRESRMK, RES.SHPPFX RESSHPPFX,
					( CASE ARL.APHCODUSE
						WHEN 2
					THEN ARL.TWOAPHCOD
					    ELSE ARL.THRAPHCOD
					  END
				) FLTCARCOD
			FROM
					OPRFNDSHP MST,
					OPRFNDSHPDTL DTL,
					OPRFNDSHPDIM DIM,
					OPRFNDSHPRES RES,
					SHRARLMST ARL,
					OPRFNDSHPBLB BLB
			WHERE
					MST.CMPCOD = DTL.CMPCOD(+)
			AND 	MST.ARPCOD = DTL.ARPCOD(+)
			AND 	MST.FNDSHPNUM = DTL.FNDSHPNUM(+)
			AND 	MST.CMPCOD = BLB.CMPCOD(+)
			AND 	MST.ARPCOD = BLB.ARPCOD(+)
			AND 	MST.FNDSHPNUM = BLB.FNDSHPNUM(+)
			AND 	DTL.CMPCOD = DIM.CMPCOD(+)
			AND 	DTL.ARPCOD = DIM.ARPCOD(+)
			AND 	DTL.FNDSHPNUM = DIM.FNDSHPNUM(+)
			AND 	DTL.FNDSHPSERNUM = DIM.FNDSHPSERNUM(+)
			AND  	MST.CMPCOD = RES.CMPCOD(+)
			AND  	MST.ARPCOD = RES.ARPCOD(+)
			AND 	MST.FNDSHPNUM = RES.FNDSHPNUM(+)
			AND		RES.CMPCOD = ARL.CMPCOD(+)
			AND 	RES.ARLIDR = ARL.ARLIDR(+)
			AND  	MST.CMPCOD = ?
			AND  	MST.ARPCOD = ?
			AND 	MST.FNDSHPNUM = ?
	]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>55</QRY:Id>
<QRY:Source Name="operations.shipment.isawbaccepted" Type="NATIVE">
	<![CDATA[
		SELECT SHP.MSTDOCNUM FROM
		OPRSHPDTL SHP WHERE
		SHP.CMPCOD = ? AND
		SHP.DOCOWRIDR = ? AND
		SHP.MSTDOCNUM = ? AND
		SHP.SEQNUM = ? AND
		SHP.DUPNUM = ?
	]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>55</QRY:Id>
<QRY:Source Name="operations.shipment.finddamagediscrepancyforawb" Type="NATIVE">
	<![CDATA[
	SELECT DMG.DUPNUM DMGDUPNUM, DMG.SEQNUM DMGSEQNUM, DMG.MSTDOCNUM DMGMSTDOCNUM,
		       DMG.DOCOWRIDR DMGDOCOWRIDR, DMG.ARPCOD DMGARPCOD,
		       DMG.DISSEQNUM DMGDISSEQNUM, DMG.CMPCOD DMGCMPCOD,
		       DMG.FLTCARCOD DMGFLTCARCOD, DMG.FLTCARIDR DMGFLTCARIDR,
		       DMG.FLTNUM DMGFLTNUM, DMG.FLTDAT DMGFLTDAT, DMG.FLTSEQNUM DMGFLTSEQNUM,
		       DMG.DMGCOD DMGDMGCOD, DMG.DISDAT DMGDISDAT, DMG.IMGPTH, DMG.RMK DMGRMK,
		       DMG.DISSTA DMGDISSTA, MST.SHPPFX,MST.SCCCOD,MST.STDPCS,MST.STDWGT
		  FROM OPRDMGDIS DMG, OPRSHPMST  MST
		 WHERE DMG.DUPNUM = MST.DUPNUM(+)
		   AND DMG.SEQNUM = MST.SEQNUM(+)
		   AND DMG.MSTDOCNUM = MST.MSTDOCNUM(+)
		   AND DMG.DOCOWRIDR = MST.DOCOWRIDR(+)
		   AND DMG.CMPCOD = MST.CMPCOD(+)
		   AND DMG.DUPNUM = ?
		   AND DMG.SEQNUM = ?
		   AND DMG.MSTDOCNUM = ?
		   AND DMG.DOCOWRIDR = ?
	   	   AND DMG.CMPCOD = ?
   ]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>56</QRY:Id>
<QRY:Source Name="operations.shipment.findawbdiscrepancy" Type="NATIVE">
	<![CDATA[
		SELECT MST.CMPCOD, MST.DOCOWRIDR, MST.MSTDOCNUM,MST.STDPCS,
						       MST.SEQNUM, MST.DUPNUM, MST.SHPPFX,MST.STDWGT,
						       MST.SHPTYP, MST.SCCCOD, MST.SHPDES,MST.PRDNAM,MST.ORGCOD,MST.DSTCOD DST,
						       DIS.ARPCOD, DIS.MSTDOCNUM DISMSTDOCNUM,
						       DIS.DISCOD, DIS.DOCNUM, DIS.CRTTIM,
						       DIS.CLSDAT, DIS.DISSTA, DIS.DISRMK,
						       0 DISSEQNUM, NULL FLTDISDISCOD,
						       NULL FLTDISCRTTIM, NULL FLTDISARP,
						       DIS.DISPCS, DIS.DISWGT, NULL FLTDISCLSDAT,NULL FLTDISRMK,
						       NULL FLTDISSTA, NULL DMGCOD, NULL DMGDISSRCIND, NULL CDSSTA, NULL DMGARP,
						       0 DMGSEQNUM, NULL DMGDISDAT,
						       NULL DMGDISSTA, NULL DMGRMK, 0 DMGPCS,
						       0 MFTPCS, 0 MFTWGT, 0 RCVPCS, 0 RCVWGT,
						       DIS.FLTCARIDR, DIS.FLTCARCOD DISFLTCARCOD,
						       DIS.FLTNUM DISFLTNUM, DIS.FLTDAT DISFLTDAT,
						       NULL FLTDISFLTCARCOD, NULL FLTDISFLTNUM,
						       NULL FLTDISFLTDAT, 0 FLTDISFLTSEQNUM,
						       DIS.ARPCOD DISARPCOD, NULL FLTDISARPCOD,
						       NULL DMGARPCOD, NULL IMGPTH,NULL IMG,
    NULL FILNAM,
    NULL FNDSHPNUM, NULL UPLDTIM,
   NULL UPLDUSR,
    NULL UPLDSTN,
	NULL IMGSEQNUM,
	ARPSHP.PLTUSEFLG PLTUSEFLG,
	SHPDTL.PLTUSEFLG DTLPLTFLG,
	0 FLTDISFLTCARIDR
						  FROM OPRSHPMST MST,
						       OPRSHPDIS DIS,
						       OPRARPSHP ARPSHP,
							   OPRSHPDTL SHPDTL
						 WHERE MST.CMPCOD = DIS.CMPCOD
						   AND MST.DOCOWRIDR = DIS.DOCOWRIDR
						   AND MST.MSTDOCNUM = DIS.MSTDOCNUM
						   AND MST.SEQNUM = DIS.SEQNUM
						   AND MST.DUPNUM = DIS.DUPNUM
						   AND MST.CMPCOD = ARPSHP.CMPCOD(+)
						   AND MST.DOCOWRIDR = ARPSHP.DOCOWRIDR(+)
						   AND MST.MSTDOCNUM = ARPSHP.MSTDOCNUM(+)
						   AND MST.SEQNUM = ARPSHP.SEQNUM(+)
				   AND MST.DUPNUM = ARPSHP.DUPNUM(+)
				    AND MST.CMPCOD = SHPDTL.CMPCOD(+)
					AND MST.MSTDOCNUM = SHPDTL.MSTDOCNUM(+)
					AND MST.DOCOWRIDR = SHPDTL.DOCOWRIDR(+)
					AND MST.SEQNUM = SHPDTL.SEQNUM(+)
					AND MST.DUPNUM = SHPDTL.DUPNUM(+)
			  	   AND MST.CMPCOD = ?
				   AND MST.DOCOWRIDR = ?
				   AND MST.MSTDOCNUM = ?
				   AND MST.DUPNUM = ?
		   AND MST.SEQNUM = ?
	]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>57</QRY:Id>
<QRY:Source Name="operations.shipment.blacklistrange" Type="NATIVE">
	<![CDATA[
	SELECT IDX.SHPSTA, IDX.MSTDOCNUM, IDX.DOCOWRIDR, IDX.DUPNUM, IDX.SEQNUM, IDX.CMPCOD
	  FROM OPRSHPIDX IDX
	 WHERE IDX.DOCOWRIDR = ?
	 AND IDX.CMPCOD=?
 	 AND LPAD(IDX.MSTDOCNUM, 7) >= ?
 	 AND LPAD(IDX.MSTDOCNUM, 7) <= ?

   ]]>
</QRY:Source>
</QRY:Definition>
 <QRY:Definition>
 <QRY:Id>58</QRY:Id>
 <QRY:Source Name="operations.shipment.finddiscrepancylist" Type="NATIVE">
 	<![CDATA[
 SELECT  MST.CMPCOD CMPCOD,MST.MSTDOCNUM MSTDOCNUM,MST.DOCOWRIDR DOCOWRIDR,
 			   MST.DUPNUM DUPNUM,MST.SEQNUM SEQNUM,DIS.ARPCOD ARPCOD,
 			   MST.SHPPFX SHPPFX,MST.SCCCOD SCCCOD,
 			   MST.STDPCS STDPCS,FLTDIS.FLTNUM FLTNUM,FLTDIS.FLTCARIDR FLTCARIDR,FLTDIS.FLTSEQNUM FLTSEQNUM,
 			   FLTDIS.DISCOD DISCOD,FLTDIS.DISPCS TOTDISPCS,FLTDIS.DISWGT TOTDISWGT,'' RMK,
 			   FLTDIS.DISSTA DISSTA,FLTDIS.FLTDAT FLTDAT,FLTDIS.DISSEQNUM DISSEQNUM,0 TOTRSLPCS,
 			   0 TOTRSLWGT,
 			   SEG.MFTPCS MFTPCS,SEG.RCVPCS RCVPCS,'' FNDSHPNUM,DIS.CRTTIM DISDAT,
 			   DIS.FLTCARCOD FLTCARCOD,0 DMGDISSEQNUM,SEG.MSTDOCNUM SEGMSTDOCNUM,
 			   SEG.DOCOWRIDR SEGOWRIDR,SEG.DUPNUM SEGDUPNUM,
 			   SEG.SEQNUM SEGSEQNUM,SEG.CMPCOD SEGCMPCOD,SEG.FLTNUM SEGFLTNUM,SEG.FLTSEQNUM SEGFLTSEQNUM
 			   ,SEG.FLTCARIDR SEGFLTCARIDR,SEG.SEGSERNUM SEGSERNUM
 		 FROM      OPRSHPMST  MST,OPRSHPDIS DIS,OPRSEGSHP SEG,OPRSHPFLTDIS FLTDIS
 		 WHERE     MST.CMPCOD=DIS.CMPCOD(+) AND
 			   MST.DOCOWRIDR=DIS.DOCOWRIDR(+) AND
 			   MST.MSTDOCNUM=DIS.MSTDOCNUM(+) AND
 			   MST.DUPNUM=DIS.DUPNUM(+) AND
 			   MST.SEQNUM=DIS.SEQNUM(+) AND

 			   DIS.MSTDOCNUM = SEG.MSTDOCNUM(+) AND
 			   DIS.DOCOWRIDR = SEG.DOCOWRIDR(+)   AND
 			   DIS.DUPNUM = SEG.DUPNUM(+)   AND
 			   DIS.SEQNUM = SEG.SEQNUM(+) AND
 			   DIS.CMPCOD = SEG.CMPCOD(+) AND
 			   DIS.FLTNUM = SEG.FLTNUM(+) AND
 			   DIS.FLTSEQNUM = SEG.FLTSEQNUM(+) AND
 	           DIS.FLTCARIDR = SEG.FLTCARIDR(+) AND
 	           DIS.CMPCOD = FLTDIS.CMPCOD(+) AND
			   DIS.DOCOWRIDR = FLTDIS.DOCOWRIDR(+) AND
			   DIS.MSTDOCNUM = FLTDIS.MSTDOCNUM(+) AND
			   DIS.DUPNUM = FLTDIS.DUPNUM(+) AND
			   DIS.SEQNUM = FLTDIS.SEQNUM(+) AND
			   DIS.FLTNUM = FLTDIS.FLTNUM(+) AND
			   DIS.FLTSEQNUM = FLTDIS.FLTSEQNUM(+) AND
			   DIS.FLTCARIDR = FLTDIS.FLTCARIDR(+)AND


 	]]>
 </QRY:Source>
</QRY:Definition>

<QRY:Definition>
 <QRY:Id>59</QRY:Id>
 <QRY:Source Name="operations.shipment.findproductforshipment" Type="NATIVE">
 	<![CDATA[
 		SELECT MST.PRDCOD
		  FROM OPRSHPMST  MST
		 WHERE MST.MSTDOCNUM = ?
		   AND MST.DOCOWRIDR = ?
		   AND MST.DUPNUM = ?
		   AND MST.SEQNUM = ?
   		   AND MST.CMPCOD = ?
 	]]>
 </QRY:Source>
</QRY:Definition>

<QRY:Definition>
 <QRY:Id>60</QRY:Id>
 <QRY:Source Name="operations.shipment.findshipmentdetailsforconstructraterequest" Type="NATIVE">
 	<![CDATA[
		SELECT MST.CMPCOD, MST.DOCOWRIDR, MST.DUPNUM, MST.SEQNUM, MST.MSTDOCNUM,
				       MST.SHPPFX, MST.UBRNUM, MST.AGTCOD, MST.AGTNAM, MST.SHPCOD, MST.CNSNAM,
				       MST.ORGCOD, MST.DSTCOD, mst.PRDNAM, MIS.TRTMOD, mst.PRDPRT, MST.SCCCOD,
				       mst.PRDCOD, ACC.JRNDAT, RAT.RATDES, RAT.CMDITMNAM, RAT.IATCOD,
				       RAT.SCCCOD SCC, RAT.NUMPCS, RAT.GRSWGT,
				       RAT.GRSVOL, RAT.CHGWGT, RAT.DSCPCT, RAT.NETCHG, RAT.RATLINSERNUM
				  FROM OPRSHPMST MST, OPRSHPRATDTL RAT, OPRSHPMSTACC ACC,
				       OPRSHPMSTMIS MIS
				 WHERE MST.CMPCOD = RAT.CMPCOD
				   AND MST.MSTDOCNUM = RAT.MSTDOCNUM
				   AND MST.DOCOWRIDR = RAT.DOCOWRIDR
				   AND MST.DUPNUM = RAT.DUPNUM
				   AND MST.SEQNUM = RAT.SEQNUM
				   AND MST.CMPCOD = ACC.CMPCOD
				   AND MST.MSTDOCNUM = ACC.MSTDOCNUM
				   AND MST.DOCOWRIDR = ACC.DOCOWRIDR
				   AND MST.DUPNUM = ACC.DUPNUM
				   AND MST.SEQNUM = ACC.SEQNUM
				   AND MST.CMPCOD = MIS.CMPCOD
				   AND MST.MSTDOCNUM = MIS.MSTDOCNUM
				   AND MST.DOCOWRIDR = MIS.DOCOWRIDR
				   AND MST.DUPNUM = MIS.DUPNUM
		   AND MST.SEQNUM = MIS.SEQNUM and
 	]]>
 </QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>61</QRY:Id>
<QRY:Source Name="operations.shipment.findresolutiondetails" Type="NATIVE">
<![CDATA[
			SELECT
					RSLTYP, STNCOD, RSLPCS, RSLWGT, RMK, RSLSERNUM
			FROM
					OPRDISRSL DISRSL
			WHERE
					DISRSL.CMPCOD = ?
			AND	DISRSL.ARPCOD = ?
			AND	DISRSL.DOCOWRIDR = ?
			AND	DISRSL.MSTDOCNUM = ?
			AND	DISRSL.DUPNUM = ?
			AND	DISRSL.SEQNUM = ?
			AND	DISRSL.FLTCARIDR = ?
			AND	DISRSL.FLTSEQNUM = ?
			AND	DISRSL.FLTNUM = ?
			AND	DISRSL.DISCOD = ?
			AND	DISRSL.DISSEQNUM = ?
]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>62</QRY:Id>
<QRY:Source Name="operations.shipment.productperformancedetails" Type="NATIVE">
	<![CDATA[
	SELECT MST.PRDCOD PRDCOD, MST.PRDNAM PRDNAM, MST.SCCCOD SCCCOD,
	       MIS.TRTMOD TRTMOD, PRD.PRDDES PRDDES, MST.PRDPRT PRDPRT,
	       SUM (RATDTL.NETCHG) TOTREV, MST.STDWGT STDWGT, MST.DSTCOD DSTCOD,
	       MST.ORGCOD ORGCOD
	  FROM OPRSHPMST MST,
	       OPRSHPRATDTL RATDTL,
	       CAPBKGMST BKGMST,
	       PRDMST PRD,
	       OPRSHPMSTMIS MIS
	 WHERE MST.CMPCOD = RATDTL.CMPCOD
	   AND MST.DOCOWRIDR = RATDTL.DOCOWRIDR
	   AND MST.MSTDOCNUM = RATDTL.MSTDOCNUM
	   AND MST.SEQNUM = RATDTL.SEQNUM
	   AND MST.DUPNUM = RATDTL.DUPNUM
	   AND MST.CMPCOD = MIS.CMPCOD
	   AND MST.DOCOWRIDR = MIS.DOCOWRIDR
	   AND MST.MSTDOCNUM = MIS.MSTDOCNUM
	   AND MST.SEQNUM = MIS.SEQNUM
	   AND MST.DUPNUM = MIS.DUPNUM
	   AND MST.STDPCS =
	          (SELECT SUM (SEGSHP.MFTPCS)
	             FROM OPRSEGSHP SEGSHP
	            WHERE SEGSHP.CMPCOD = MST.CMPCOD
	              AND SEGSHP.DOCOWRIDR = MST.DOCOWRIDR
	              AND SEGSHP.MSTDOCNUM = MST.DOCNUM
	              AND SEGSHP.SEQNUM = MST.SEQNUM
	              AND SEGSHP.DUPNUM = MST.DUPNUM)
	   AND MST.CMPCOD = ?
	   AND MST.CMPCOD = BKGMST.CMPCOD
	   AND MST.DOCOWRIDR = BKGMST.DOCOWRIDR
	   AND MST.MSTDOCNUM = BKGMST.MSTDOCNUM
	   AND MST.SEQNUM = BKGMST.SEQNUM
	   AND MST.DUPNUM = BKGMST.DUPNUM
	   AND MST.CMPCOD = PRD.CMPCOD
	   AND MST.PRDCOD = PRD.PRDCOD
   AND BKGMST.BKGDAT BETWEEN ? AND ?
   ]]>
</QRY:Source>
</QRY:Definition>


<QRY:Definition>
<QRY:Id>63</QRY:Id>
<QRY:Source Name="operations.shipment.revenuedocumentreport" Type="NATIVE">
	<![CDATA[
		SELECT MST.MSTDOCNUM MSTMSTDOCNUM, MST.DOCOWRIDR MSTDOCOWRIDR,
		       MST.DUPNUM MSTDUPNUM, MST.DUPNUM MSTDUPNUM, MST.CMPCOD MSTCMPCOD,
		       MST.AGTCOD MSTAGTCOD, MST.AGTNAM MSTAGTNAM, MST.SHPCOD MSTSHPCOD,
		       MST.SHPNAM MSTSHPNAM, MST.SHPDES MSTSHPDES, MST.EXEDAT, BKG.BKGDAT,
		       MST.UBRNUM, IDX.SHPSTA IDXSHPSTA, MST.EXEFLG,MST.STKHLDCOD,MST.SRCIND,
		       (SELECT MAX (DLVDTL.DLVDAT)
			  FROM OPRSHPDLVDTL DLVDTL
			 WHERE MST.MSTDOCNUM = DLVDTL.MSTDOCNUM
			   AND MST.DOCOWRIDR = DLVDTL.DOCOWRIDR
			   AND MST.DUPNUM = DLVDTL.DUPNUM
			   AND MST.SEQNUM = DLVDTL.SEQNUM
			   AND MST.CMPCOD = DLVDTL.CMPCOD) DLVDAT
		  FROM OPRSHPMST  MST, CAPBKGMST BKG, OPRSHPIDX IDX
		 WHERE MST.MSTDOCNUM = IDX.MSTDOCNUM
		   AND MST.DOCOWRIDR = IDX.DOCOWRIDR
		   AND MST.DUPNUM = IDX.DUPNUM
		   AND MST.SEQNUM = IDX.SEQNUM
		   AND MST.CMPCOD = IDX.CMPCOD
		   AND MST.CMPCOD = BKG.CMPCOD(+)
	   AND MST.UBRNUM = BKG.UBRNUM(+) AND
   ]]>
</QRY:Source>
</QRY:Definition>


<QRY:Definition>
 <QRY:Id>60</QRY:Id>
 <QRY:Source Name="operations.shipment.viewdn" Type="NATIVE">
 	<![CDATA[
 		SELECT	DN.DLVNOTNUM,DN.DLVNOTPCS,DN.DLVNOTWGT,DN.DNTISSDAT,DN.RMK,
		MST.MSTDOCNUM,MST.SHPPFX,
		MST.DOCNUM,MST.PAYTYP,RATDTL.SCCCOD,MST.SHPDES,
		(SELECT  SUM (DNCHG.CHGAMT)
			   FROM OPRDLVNOTCHG DNCHG
				  WHERE DNCHG.CMPCOD = DN.cmpcod
						AND DNCHG.ARPCOD = DN.arpcod
						AND DNCHG.DLVNOTNUM = DN.dlvnotnum) CHGAMT
		FROM 	OPRSHPMST  MST,OPRSHPDLVNOT DN,OPRSHPRATDTL RATDTL
		WHERE   MST.CMPCOD = DN.CMPCOD AND
				MST.MSTDOCNUM = DN.MSTDOCNUM AND
				MST.DUPNUM = DN.DUPNUM AND
				MST.SEQNUM = DN.SEQNUM AND
				MST.DOCOWRIDR = DN.DOCOWRIDR AND
				MST.MSTDOCNUM = RATDTL.MSTDOCNUM AND
				MST.DOCOWRIDR = RATDTL.DOCOWRIDR AND
				MST.DUPNUM = RATDTL.DUPNUM AND
				MST.SEQNUM = RATDTL.SEQNUM AND
				MST.CMPCOD = RATDTL.CMPCOD AND
				DN.CMPCOD = ? AND
				DN.ARPCOD = ? AND
				DN.DLVNOTNUM = ?


 	]]>
 </QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>65</QRY:Id>
<QRY:Source Name="operations.shipment.findPrecarriageUld" Type="NATIVE">
	<![CDATA[
				SELECT   opruldSHP.uldnum AS uldnum, COUNT (opruldSHP.MSTdocnum) awbcnt,
						         SUM (opruldSHP.wgt) uldwgt, SUM (opruldSHP.vol) uldvol,
						         MAX (opruldpreflt.precarpty) AS precarpty,
						         capbkgfltdtl.fltnum AS fltnum, capbkgfltdtl.fltcarcod AS fltcarcod,
						         capbkgfltdtl.fltdat AS fltdat, capbkgMST.cusnam AS cusnam,
							 CAPBKGMST.ORGCOD AS ORGCOD,
							 CAPBKGMST.DSTCOD AS DSTCOD
						    FROM opruldSHP,
						         capbkgdtl,
						         capbkgfltdtl,
						         fltoprleg,
						         opruldpreflt,
						         capbkgMST
						   WHERE opruldSHP.CMPCOD = capbkgdtl.CMPCOD
						     AND opruldSHP.uldnum = capbkgdtl.uldnum
						     AND capbkgdtl.CMPCOD = capbkgfltdtl.CMPCOD
						     AND capbkgdtl.ubrnum = capbkgfltdtl.ubrnum
						     AND capbkgfltdtl.CMPCOD = capbkgMST.CMPCOD
						     AND capbkgfltdtl.ubrnum = capbkgMST.ubrnum
						     AND capbkgfltdtl.CMPCOD = fltoprleg.CMPCOD
						     AND capbkgfltdtl.fltcaridr = fltoprleg.fltcaridr
						     AND capbkgfltdtl.fltnum = fltoprleg.fltnum
						     AND capbkgfltdtl.fltseqnum = fltoprleg.fltseqnum
						     AND capbkgfltdtl.fltorg = fltoprleg.legorg
						     AND capbkgfltdtl.fltorg = opruldSHP.arpcod
						     AND opruldSHP.CMPCOD = opruldpreflt.CMPCOD(+)
						     AND opruldSHP.uldnum = opruldpreflt.uldnum(+)
						     AND FLTOPRLEG.STA BETWEEN ? AND  ? + ? AND
						         OPRULDSHP.ARPCOD = ? AND


				                       OPRULDPREFLT.FLTNUM(+) = ? AND
						       OPRULDPREFLT.FLTSEQNUM(+) = ?  AND
					               OPRULDPREFLT.FLTCARIDR(+) = ? AND
					               OPRULDPREFLT.SEGSERNUM(+) = ?

						 AND NOT
						    (
						        capbkgfltdtl.fltnum = ?
						    AND capbkgfltdtl.fltseqnum = ?
						    AND capbkgfltdtl.fltcaridr = ?
						    AND capbkgfltdtl.SEGSERNUM = ?
									  )
   ]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
 <QRY:Id>66</QRY:Id>
 <QRY:Source Name="operations.shipmen.viewarrivalnotification" Type="NATIVE">
 	<![CDATA[
						SELECT ARP.RCVPCS, ARP.RCVWGT, MST.MSTDOCNUM, MST.SHPPFX, MST.CNSADRONE,
						       MST.SHPDES, MST.SHPADRONE, STN.STNNAM, STN.CTYCOD, CNT.CNTVAL,CNT.CNTTYP
						  FROM OPRSHPMST MST, OPRARPSHP ARP, SHRSTNMST STN, SHRSTNCNT CNT
						 WHERE MST.MSTDOCNUM = ARP.MSTDOCNUM
						 AND MST.DOCOWRIDR = ARP.DOCOWRIDR
						 AND MST.DUPNUM = ARP.DUPNUM
						AND MST.SEQNUM = ARP.SEQNUM
						AND MST.CMPCOD = ARP.CMPCOD
						AND ARP.ARPCOD = STN.STNCOD(+)
						AND ARP.CMPCOD = STN.CMPCOD(+)
						AND STN.STNCOD = CNT.STNCOD(+)
						AND STN.CMPCOD = CNT.CMPCOD(+)
						AND MST.MSTDOCNUM = ? AND
						MST.SHPPFX = ? AND
						MST.DUPNUM = ? AND
						MST.SEQNUM = ? AND
						MST.CMPCOD = ? AND
						ARP.ARPCOD(+) = ?

	]]>
 </QRY:Source>
</QRY:Definition>

<QRY:Definition>
 <QRY:Id>67</QRY:Id>
 <QRY:Source Name="operations.shipment.findattachedawbs" Type="NATIVE">
 	<![CDATA[
				SELECT
						DOCOWRIDR, DUPNUM, SEQNUM, MSTDOCNUM,
						CMPCOD, ARPCOD, FNDSHPNUM,
						PCS, WGT, ULDNUM, SHPPFX, RMK,
						FLTSEQNUM, FLTNUM, FLTDAT, FLTCARIDR, FLTCARCOD,LSTUPDTIM
				FROM
						OPRATCAWB ATCAWB
				WHERE
						ATCAWB.CMPCOD = ?
				AND	ATCAWB.ARPCOD = ?
				AND	ATCAWB.FNDSHPNUM = ?
				AND	ATCAWB.DOCOWRIDR = ?
				AND	ATCAWB.MSTDOCNUM = ?
				AND	ATCAWB.DUPNUM = ?
				AND	ATCAWB.SEQNUM = ?
 	]]>
 </QRY:Source>
</QRY:Definition>


<QRY:Definition>
<QRY:Id>68</QRY:Id>
 <QRY:Source Name="operations.shipment.findPosPerformanceYearly" Type="NATIVE">
 	<![CDATA[

	   SELECT SUM(SEG.MFTWGT) AS MFTWGT,TO_CHAR(LEG.STD,'YYYY') AS STD
	   FROM
	OPRSEGSHP SEG,FLTOPRLEG LEG
	  WHERE
	SEG.FLTCARIDR=LEG.FLTCARIDR AND
	SEG.FLTNUM=LEG.FLTNUM AND
	SEG.CMPCOD=LEG.CMPCOD AND
	SEG.FLTSEQNUM=LEG.FLTSEQNUM AND
	LEG.LEGORG=? AND
	LEG.STD>=? AND
	LEG.STD<=?
	GROUP BY TO_CHAR(LEG.STD,'YYYY')
 	]]>
 </QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>69</QRY:Id>
 <QRY:Source Name="operations.shipment.findPosPerformanceMonthly" Type="NATIVE">
 	<![CDATA[

	 SELECT SUM(SEG.MFTWGT) AS MFTWGT,
	  TO_CHAR(LEG.STD,'MM')AS STDM,
	  TO_CHAR(LEG.STD,'YYYY') AS STDY
	  FROM OPRSEGSHP SEG,FLTOPRLEG LEG
	  WHERE SEG.FLTCARIDR=LEG.FLTCARIDR
	 AND SEG.FLTNUM=LEG.FLTNUM AND
	 SEG.CMPCOD=LEG.CMPCOD AND
	SEG.FLTSEQNUM=LEG.FLTSEQNUM AND
	LEG.LEGORG=? AND
	LEG.STD>=? AND
	LEG.STD<=?
	GROUP BY TO_CHAR(LEG.STD,'MM'),
	TO_CHAR(LEG.STD,'YYYY')

 	]]>
 </QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>70</QRY:Id>
<QRY:Source Name="operations.shipment.finddamagediscrepacies" Type="NATIVE">
	<![CDATA[
	SELECT DMG.ARPCOD DMGARPCOD, DMG.FLTNUM DMGFLTNUM, DMG.DISDAT DMGDISDAT,
	       DMG.DISSTA DMGDISSTA, DMG.DOCOWRIDR DMGDOCOWRIDR,DMG.DMGCOD DMGDMGCOD,
	       DMG.MSTDOCNUM DMGMSTDOCNUM, DMG.DUPNUM DMGDUPNUM, DMG.SEQNUM DMGSEQNUM,
		   DMG.DISSEQNUM DMGDISSEQNUM, MST.SCCCOD MSTSCCCOD, MST.PRDNAM MSTPRDNAM,
		   MST.UBRNUM MSTUBRNUM,MST.STDPCS,DMG.CMPCOD DMGCMPCOD
	FROM OPRDMGDIS DMG, OPRSHPMST  MST
	 WHERE MST.CMPCOD = DMG.CMPCOD
	   AND MST.DOCOWRIDR = DMG.DOCOWRIDR
	   AND MST.MSTDOCNUM = DMG.MSTDOCNUM
	   AND MST.DUPNUM = DMG.DUPNUM
	   AND MST.SEQNUM = DMG.SEQNUM
	   AND DMG.CMPCOD = ?

	]]>
</QRY:Source>
</QRY:Definition>


<QRY:Definition>
<QRY:Id>71</QRY:Id>
<QRY:Source Name="operations.shipment.findfswrdiscrepancies" Type="NATIVE">
	<![CDATA[
			SELECT
					FND.ARPCOD FNDARPCOD, FND.FLTCARCOD FNDFLTCARCOD, FND.FLTNUM FNDFLTNUM,
					FND.DISDAT FNDDISDAT,
					FND.FNDSHPSTA FNDFNDSHPSTA, FND.FNDSHPNUM FNDFNDSHPNUM,
					FND.TOTDISPCS FNDTOTDISPCS, FND.TOTDISWGT FNDTOTDISWGT,
					FND.TOTRSLPCS FNDTOTRSLPCS, FND.TOTRSLWGT FNDTOTRSLWGT
			FROM
					OPRFNDSHP FND
			WHERE
					FND.CMPCOD = ?
			AND	FND.DISDAT BETWEEN ? AND ?
	]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>72</QRY:Id>
<QRY:Source Name="operations.shipment.findshipmentdiscrepancies" Type="NATIVE">
	<![CDATA[
			SELECT
					DIS.ARPCOD SHPARPCOD, DIS.FLTNUM SHPFLTNUM, DIS.FLTCARCOD SHPFLTCARCOD,
					DIS.FLTDAT,DIS.CRTTIM SHPCRTTIM,
					DIS.DISCOD SHPDISCOD, DIS.DISSTA SHPDISSTA,
					DIS.DOCOWRIDR SHPDOCOWRIDR, DIS.MSTDOCNUM SHPMSTDOCNUM,
					FLTDIS.DISPCS SHPTOTDISPCS, FLTDIS.DISWGT SHPTOTDISWGT,
					MST.SCCCOD MSTSCCCOD, MST.PRDNAM MSTPRDNAM, MST.UBRNUM MSTUBRNUM,
					SUM(SEG.MFTPCS) AS SUMMFTPCS,SUM(SEG.MFTWGT) AS SUMMFTWGT,
					SUM(SEG.RCVPCS) AS SUMRCVPCS,SUM(SEG.RCVWGT) AS SUMRCVWGT
			FROM
					OPRSHPDIS DIS,
					OPRSHPMST  MST,
					OPRFLTSEG FLTSEG,
					OPRSEGSHP SEG,
					OPRSHPFLTDIS FLTDIS
			WHERE
				MST.CMPCOD = DIS.CMPCOD
			AND	MST.DOCOWRIDR = DIS.DOCOWRIDR
			AND	MST.MSTDOCNUM = DIS.MSTDOCNUM
			AND MST.DUPNUM = DIS.DUPNUM
			AND MST.SEQNUM = DIS.SEQNUM
			AND FLTSEG.CMPCOD = DIS.CMPCOD
		    AND FLTSEG.FLTNUM = DIS.FLTNUM
		    AND FLTSEG.FLTCARIDR = DIS.FLTCARIDR
		    AND FLTSEG.FLTSEQNUM = DIS.FLTSEQNUM
		    AND FLTSEG.POU = DIS.ARPCOD
		    AND SEG.CMPCOD = DIS.CMPCOD
		    AND SEG.DOCOWRIDR = DIS.DOCOWRIDR
		    AND SEG.MSTDOCNUM = DIS.MSTDOCNUM
		    AND SEG.DUPNUM = DIS.DUPNUM
		    AND SEG.SEQNUM = DIS.SEQNUM
		    AND SEG.FLTNUM = DIS.FLTNUM
		    AND SEG.FLTSEQNUM = DIS.FLTSEQNUM
		    AND SEG.FLTCARIDR = DIS.FLTCARIDR
	   	    AND SEG.SEGSERNUM = FLTSEG.SEGSERNUM
		    AND FLTDIS.CMPCOD = DIS.CMPCOD
		    AND FLTDIS.ARPCOD = DIS.ARPCOD
		    AND FLTDIS.DOCOWRIDR = DIS.DOCOWRIDR
		    AND FLTDIS.MSTDOCNUM = DIS.MSTDOCNUM
		    AND FLTDIS.SEQNUM = DIS.SEQNUM
		    AND FLTDIS.DUPNUM	= DIS.DUPNUM
			AND	DIS.CMPCOD = ?
			AND DIS.CRTTIM BETWEEN ? AND ?
	]]>
</QRY:Source>
</QRY:Definition>


<QRY:Definition>
<QRY:Id>73</QRY:Id>
<QRY:Source Name="operations.shipment.findPrecarriageShipments" Type="NATIVE">
	<![CDATA[
		SELECT  arpshp.MSTDOCNUM AS MSTDOCNUM, arpshp.AVLPCS AS AVLPCS,
       			arpshp.AVLVOL AS AVLVOL, arpshp.AVLWGT AS AVLWGT,
       			preflt.PRECARPTY AS PRECARPTY, fltdtl.FLTNUM AS FLTNUM,
       			fltdtl.FLTCARCOD AS FLTCARCOD, fltdtl.FLTDAT AS FLTDAT,
       			bkgmst.CUSNAM AS CUSNAM,
       			arpshp.DOCOWRIDR AS DOCOWRIDR,
      			arpshp.DUPNUM AS DUPNUM,
      			arpshp.SEQNUM AS SEQNUM,
      			bkgmst.ORGCOD AS ORGCOD,
      			bkgmst.DSTCOD AS DSTCOD,
      			ratdtl.CMDITMNAM AS COMCOD,
      			shpmst.STDPCS AS STDPCS,
     			shpmst.SCCCOD AS SCCCOD,
	  			fltdtl.FLTORG AS FLTORG,
      			fltdtl.FLTDST AS FLTDST ,
		        shpmst.STDWGT AS STDWGT,
      			shpmst.PLTFLG AS PLTFLG,
      			shpmst.GRSVOL AS GRSVOL,
      			shpmst.SHPPFX AS SHPPFX
		FROM 	OPRARPSHP arpshp, OPRSHPMST  shpmst,OPRSHPRATDTL ratdtl,CAPBKGFLTDTL fltdtl,
		  		OPRSHPPREFLT preflt, FLTOPRLEG leg, CAPBKGMST bkgmst
		WHERE   arpshp.MSTDOCNUM = shpmst.MSTDOCNUM
			AND arpshp.DOCOWRIDR = shpmst.DOCOWRIDR
			AND arpshp.DUPNUM = shpmst.DUPNUM
			AND arpshp.SEQNUM = shpmst.SEQNUM
			AND arpshp.CMPCOD = shpmst.CMPCOD

			AND ratdtl.MSTDOCNUM = shpmst.MSTDOCNUM
			AND ratdtl.DOCOWRIDR = shpmst.DOCOWRIDR
			AND ratdtl.DUPNUM = shpmst.DUPNUM
			AND ratdtl.SEQNUM = shpmst.SEQNUM
			AND ratdtl.CMPCOD = shpmst.CMPCOD

			AND bkgmst.MSTDOCNUM(+) = shpmst.MSTDOCNUM
			AND bkgmst.DOCOWRIDR(+) = shpmst.DOCOWRIDR
			AND bkgmst.DUPNUM(+) = shpmst.DUPNUM
			AND bkgmst.SEQNUM(+) = shpmst.SEQNUM
			AND bkgmst.CMPCOD(+) = shpmst.CMPCOD

			AND shpmst.CMPCOD = fltdtl.CMPCOD(+)
			AND shpmst.UBRNUM = fltdtl.UBRNUM(+)

			AND arpshp.CMPCOD = preflt.CMPCOD(+)
			AND arpshp.DOCOWRIDR = preflt.DOCOWRIDR(+)
			AND arpshp.DUPNUM = preflt.DUPNUM(+)
			AND arpshp.MSTDOCNUM = preflt.MSTDOCNUM(+)
			AND arpshp.SEQNUM = preflt.SEQNUM(+)


		AND fltdtl.FLTCARIDR(+) = ?
		AND fltdtl.FLTNUM(+) = ?
		AND fltdtl.FLTSEQNUM(+) = ?
		AND fltdtl.FLTORG(+) = ?

		AND preflt.FLTNUM(+) = ?
		AND preflt.FLTSEQNUM(+) = ?
		AND preflt.FLTCARIDR(+) = ?
		AND preflt.SEGSERNUM(+) = ?

		AND arpshp.ARPCOD = ?

		AND leg.FLTNUM = ?
		AND leg.FLTSEQNUM = ?
		AND leg.FLTCARIDR = ?
		AND leg.LEGORG = ?
		AND leg.STA BETWEEN ? AND  ? + ?

	]]>
</QRY:Source>
</QRY:Definition>


	<QRY:Definition>
	 <QRY:Id>74</QRY:Id>
	 <QRY:Source Name="operations.shipment.findawbexecutedstatus" Type="NATIVE">
	 	<![CDATA[
	 		SELECT SHPSTA FROM OPRSHPMST  MST WHERE
			        MST.CMPCOD = ? AND
			        MST.DOCOWRIDR = ? AND
				MST.MSTDOCNUM = ? AND
				MST.SEQNUM = ? AND
	  	 		MST.DUPNUM = ?
	 	]]>
	 </QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	 <QRY:Id>75</QRY:Id>
	 <QRY:Source Name="operations.shipment.findStationPerformanceYearly" Type="NATIVE">
	 	<![CDATA[

	   	SELECT SUM(SEG.MFTWGT) AS MFTWGT,
	   	SUM(SEG.MFTVOL) AS MFTVOL,
	   	TO_CHAR(LEG.STD,'YYYY') AS STD,
	   	SEG.FLTCARIDR,SEG.FLTNUM
	   FROM OPRSEGSHP SEG,FLTOPRLEG LEG
	   WHERE SEG.FLTCARIDR=LEG.FLTCARIDR AND
		SEG.FLTNUM=LEG.FLTNUM AND
		SEG.CMPCOD=LEG.CMPCOD AND
		SEG.FLTSEQNUM=LEG.FLTSEQNUM AND
		LEG.LEGORG= ?AND
		LEG.STD>=? AND
		LEG.STD<=?
		GROUP BY TO_CHAR(LEG.STD,'YYYY'),
		SEG.FLTNUM,SEG.FLTCARIDR
	 	]]>
	 </QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	 <QRY:Id>76</QRY:Id>
	 <QRY:Source Name="operations.shipment.findStationPerformanceMonthly" Type="NATIVE">
	 	<![CDATA[
 	SELECT SUM(SEG.MFTWGT) AS MFTWGT,
 	SUM(SEG.MFTVOL) AS MFTVOL,
	TO_CHAR(LEG.STD,'MM')AS STDM,
  	TO_CHAR(LEG.STD,'YYYY') AS STDY,
  	SEG.FLTCARIDR, SEG.FLTNUM
  	FROM OPRSEGSHP SEG,FLTOPRLEG LEG
	  WHERE SEG.FLTCARIDR=LEG.FLTCARIDR
 	AND SEG.FLTNUM=LEG.FLTNUM AND
 	SEG.CMPCOD=LEG.CMPCOD AND
	SEG.FLTSEQNUM=LEG.FLTSEQNUM AND
	LEG.LEGORG=?AND
	LEG.STD>=? AND
	LEG.STD<=?
	GROUP BY TO_CHAR(LEG.STD,'MM'),
	TO_CHAR(LEG.STD,'YYYY'),
	SEG.FLTCARIDR,SEG.FLTNUM
	 	]]>
	 </QRY:Source>
	</QRY:Definition>




<QRY:Definition>
<QRY:Id>77</QRY:Id>
<QRY:Source Name="operations.shipment.findshipmentcommodity" Type="NATIVE">
	<![CDATA[
	SELECT	CMDITMNAM
	FROM	OPRSHPRATDTL
	WHERE	SEQNUM = ? AND
		DUPNUM = ? AND
		MSTDOCNUM = ? AND
		DOCOWRIDR = ? AND
		CMPCOD = ?

   ]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>78</QRY:Id>
<QRY:Source Name="operations.shipment.finddisruptionlistbooking" Type="NATIVE">
	<![CDATA[

	SELECT MST.DUPNUM DUPNUM, MST.MSTDOCNUM MSTDOCNUM, MST.DOCOWRIDR DOCOWRIDR,
	       MST.CMPCOD CMPCOD, MST.SEQNUM SEQNUM,
	       MST.SHPPFX SHPPFX, MST.ORGCOD ORGCOD, MST.DSTCOD DSTCOD, ARPSHP.ARPCOD ARPCOD,
	       BKGFLT.FLTORG FLTORG,BKGFLT.FLTDST FLTDST, ARPSHP.AVLPCS AVLPCS, ARPSHP.AVLWGT AVLWGT,
	       ARPSHP.AVLVOL,SUM(BKGFLT.CFRPCS) MFTPCS,SUM(BKGFLT.CFRWGT) MFTWGT,SUM(BKGFLT.CFRVOL) MFTVOL,
	       BKGFLT.FLTCARCOD FLTCARCOD, MST.UBRNUM UBRNUM, BKGFLT.FLTCARIDR FLTCARIDR,
	       BKGFLT.FLTNUM FLTNUM, BKGFLT.FLTSEQNUM FLTSEQNUM, BKGFLT.FLTDAT FLTDAT, BKGFLT.SEGSERNUM SEGSERNUM
	FROM CAPBKGMST BKG,
	     FLTOPRLEG LEG,
	     OPRARPSHP ARPSHP,
	     CAPBKGFLTDTL BKGFLT,
	     OPRSHPMST  MST
	WHERE 	 MST.DUPNUM = ARPSHP.DUPNUM
	 	 AND MST.MSTDOCNUM = ARPSHP.MSTDOCNUM
		 AND MST.DOCOWRIDR = ARPSHP.DOCOWRIDR
		 AND MST.CMPCOD = ARPSHP.CMPCOD
		 AND MST.SEQNUM = ARPSHP.SEQNUM
		 AND ARPSHP.DUPNUM = BKG.DUPNUM
		 AND ARPSHP.MSTDOCNUM = BKG.MSTDOCNUM
		 AND ARPSHP.DOCOWRIDR = BKG.DOCOWRIDR
		 AND ARPSHP.CMPCOD = BKG.CMPCOD
		 AND ARPSHP.SEQNUM = BKG.SEQNUM
		 AND BKG.CMPCOD = BKGFLT.CMPCOD
		 AND BKG.UBRNUM = BKGFLT.UBRNUM
		 AND BKGFLT.CMPCOD = LEG.CMPCOD
		 AND BKGFLT.FLTNUM = LEG.FLTNUM
		 AND BKGFLT.FLTSEQNUM = LEG.FLTSEQNUM
		 AND BKGFLT.FLTCARIDR = LEG.FLTCARIDR
		 AND BKGFLT.FLTORG = ARPSHP.ARPCOD
		 AND LEG.ATD IS NOT NULL
		 AND ARPSHP.AVLPCS>0
   ]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>134</QRY:Id>
<QRY:Source Name="operations.shipment.finddisruptionlistshipment" Type="NATIVE">
	<![CDATA[

	SELECT 	MST.DUPNUM DUPNUM, MST.MSTDOCNUM MSTDOCNUM, MST.DOCOWRIDR DOCOWRIDR,
		MST.CMPCOD CMPCOD, MST.SEQNUM SEQNUM,MST.SHPPFX SHPPFX, MST.ORGCOD ORGCOD,
		MST.DSTCOD DSTCOD, ARPSHP.ARPCOD ARPCOD, BKGFLT.FLTORG FLTORG,
		BKGFLT.FLTDST FLTDST, ARPSHP.AVLPCS AVLPCS, ARPSHP.AVLWGT AVLWGT,
		ARPSHP.AVLVOL AVLVOL, SUM(SHP.MFTPCS) MFTPCS,SUM(SHP.MFTWGT) MFTWGT,
		SUM(SHP.MFTVOL) MFTVOL,BKGFLT.FLTCARCOD FLTCARCOD, MST.UBRNUM UBRNUM,
		BKGFLT.FLTCARIDR FLTCARIDR,BKGFLT.FLTNUM FLTNUM, BKGFLT.FLTSEQNUM FLTSEQNUM,
		BKGFLT.FLTDAT FLTDAT, BKGFLT.SEGSERNUM SEGSERNUM
	FROM 	CAPBKGMST BKG,
		FLTOPRLEG LEG,
		OPRARPSHP ARPSHP,
		CAPBKGFLTDTL BKGFLT,
		OPRSHPMST  MST,
		OPRSEGSHP SHP
	WHERE 	MST.DUPNUM = ARPSHP.DUPNUM
		AND MST.MSTDOCNUM = ARPSHP.MSTDOCNUM
		AND MST.DOCOWRIDR = ARPSHP.DOCOWRIDR
		AND MST.CMPCOD = ARPSHP.CMPCOD
		AND MST.SEQNUM = ARPSHP.SEQNUM
		AND SHP.DUPNUM = ARPSHP.DUPNUM
		AND SHP.MSTDOCNUM = ARPSHP.MSTDOCNUM
		AND SHP.DOCOWRIDR = ARPSHP.DOCOWRIDR
		AND SHP.CMPCOD = ARPSHP.CMPCOD
		AND SHP.SEQNUM = ARPSHP.SEQNUM
		AND ARPSHP.DUPNUM = BKG.DUPNUM
		AND ARPSHP.MSTDOCNUM = BKG.MSTDOCNUM
		AND ARPSHP.DOCOWRIDR = BKG.DOCOWRIDR
		AND ARPSHP.CMPCOD = BKG.CMPCOD
		AND ARPSHP.SEQNUM = BKG.SEQNUM
		AND BKG.CMPCOD = BKGFLT.CMPCOD
		AND BKG.UBRNUM = BKGFLT.UBRNUM
		AND BKGFLT.CMPCOD = LEG.CMPCOD
		AND BKGFLT.FLTNUM = LEG.FLTNUM
		AND BKGFLT.FLTSEQNUM = LEG.FLTSEQNUM
		AND BKGFLT.FLTCARIDR = LEG.FLTCARIDR
		AND BKGFLT.FLTORG = ARPSHP.ARPCOD
		AND LEG.ATD IS NOT NULL
		AND ARPSHP.AVLPCS>0
   ]]>
</QRY:Source>
</QRY:Definition>


	 <QRY:Definition>
	 <QRY:Id>78</QRY:Id>
	 <QRY:Source Name="operations.shipment.findClearanceListingDetails" Type="NATIVE">
	 	<![CDATA[
	SELECT SHPMST.CMPCOD,SHPMST.SHPPFX,SHPBLK.DOCOWRIDR,SHPBLK.SEQNUM,SHPBLK.DUPNUM,SHPBLK.MSTDOCNUM,
	SHPBLK.DOCNUM,SHPBLK.BLKSTA,SHPBLK.BLKAUT,SHPBLK.BLKSTRDAT,SHPBLK.RELDAT,SHPBLK.BLKEXPDAT,
	SHPBLK.ARPCOD,SHPMST.ORGCOD,SHPMST.DSTCOD,SHPMST.SCCCOD,SHPMST.SHPDES,SHPBLK.BLKRMK
	, ROWNUM AS RANK
	FROM OPRSHPMST  SHPMST,OPRSHPBLK SHPBLK
		WHERE
	SHPMST.CMPCOD=SHPBLK.CMPCOD AND
	SHPMST.SEQNUM=SHPBLK.SEQNUM AND
	SHPMST.DUPNUM=SHPBLK.DUPNUM AND
	SHPMST.DOCOWRIDR=SHPBLK.DOCOWRIDR AND
	SHPMST.MSTDOCNUM=SHPBLK.MSTDOCNUM
	AND SHPBLK.CMPCOD=?
	 	]]>
	 </QRY:Source>
	</QRY:Definition>

	 <QRY:Definition>
	 <QRY:Id>79</QRY:Id>
	 <QRY:Source Name="operations.shipment.findshipmentblockdetails" Type="NATIVE">
	 	<![CDATA[
		SELECT BLK.TRKNUM,BLK.ARPCOD,MST.CMPCOD,MST.DOCOWRIDR,MST.MSTDOCNUM,MST.DUPNUM,
			MST.SEQNUM,MST.DOCNUM,BLK.SERNUM,BLK.BLKAUT,BLK.BLKSTRDAT,BLK.BLKSERNUM,
			BLK.BLKEXPDAT,BLK.BLKSTA,BLK.BLKUSR,BLK.BLKRMK,BLK.LSTUPDTIM,BLK.LSTUPDUSR,BLK.AUTNAM,
			MST.ORGCOD,MST.DSTCOD,MST.SCCCOD,MST.STDPCS,MST.CONFLG, MST.STDWGT,MST.STDWGTCOD,MST.SHPDES,BLK.BLKTXNCOD,BLK.RELDAT 
		FROM OPRSHPMST  MST,
		(SELECT B.CMPCOD,B.DOCOWRIDR,B.MSTDOCNUM,B.DUPNUM,B.SEQNUM,B.SERNUM,
			B.ARPCOD,B.BLKAUT,B.BLKSTRDAT,B.BLKEXPDAT,B.BLKSTA,B.BLKUSR,
			B.BLKRMK,B.LSTUPDTIM,B.LSTUPDUSR,A.AUTNAM,B.TRKNUM,B.BLKTXNCOD,B.BLKSERNUM,B.RELDAT
		FROM OPRSHPBLK B,OPRBLKAUT A
		WHERE  A.CMPCOD = B.CMPCOD
				AND A.AUTCOD = B.BLKAUT)BLK

		WHERE MST.CMPCOD=BLK.CMPCOD(+) AND
			MST.DOCOWRIDR=BLK.DOCOWRIDR(+) AND
			MST.MSTDOCNUM=BLK.MSTDOCNUM(+) AND
			MST.DUPNUM=BLK.DUPNUM(+) AND
			MST.SEQNUM = BLK.SEQNUM(+) AND
			MST.MSTDOCNUM = ? AND
			MST.DOCOWRIDR = ? AND
			MST.DUPNUM = ? AND
			MST.SEQNUM = ? AND
			MST.CMPCOD = ?
		]]>
	 </QRY:Source>
	</QRY:Definition>

	 <QRY:Definition>
	 <QRY:Id>80</QRY:Id>
	 <QRY:Source Name="operations.shipment.findauthoritiesprivilegesbasedonaction" Type="NATIVE">
	 	<![CDATA[
	 	SELECT AUT.CMPCOD,AUT.AUTCOD,AUT.AUTNAM,PRV.BLKACT,PRV.PRVCOD
		FROM OPRBLKPRV PRV,OPRBLKAUT AUT
		WHERE AUT.AUTCOD = PRV.AUTCOD
		and AUT.cmpcod = PRV.cmpcod
		AND AUT.CMPCOD=? 
		AND PRV.BLKACT=?
	 	]]>
	 </QRY:Source>
	</QRY:Definition>

	 <QRY:Definition>
	 <QRY:Id>81</QRY:Id>
	 <QRY:Source Name="operations.shipment.findshipmentpreblockdetails" Type="NATIVE">
	 	<![CDATA[
		SELECT SHPPREBLK.CMPCOD,SHPPREBLK.ARPCOD,SHPPREBLK.MSTDOCNUM,SHPPREBLK.DOCOWRIDR,SHPPREBLK.SEQNUM,
		SHPPREBLK.SERNUM,SHPPREBLK.BLKUSR,SHPPREBLK.BLKAUT,BLKAUT.AUTNAM,SHPPREBLK.BLKSTRDAT,SHPPREBLK.BLKEXPDAT,SHPPREBLK.BLKSTA,
		SHPPREBLK.RELDAT,SHPPREBLK.LSTUPDTIM,SHPPREBLK.LSTUPDUSR,SHPPREBLK.BLKRMK
		FROM OPRSHPPREBLK SHPPREBLK,OPRBLKAUT BLKAUT
		WHERE
		SHPPREBLK.CMPCOD=BLKAUT.CMPCOD AND
		SHPPREBLK.BLKAUT=BLKAUT.AUTCOD AND
		SHPPREBLK.CMPCOD = ? AND
		SHPPREBLK.SEQNUM = ? AND
		SHPPREBLK.DOCOWRIDR = ? AND
		SHPPREBLK.MSTDOCNUM = ?
	 	]]>
	 </QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	 <QRY:Id>82</QRY:Id>
	 <QRY:Source Name="operations.shipment.findduplicateblockexist" Type="NATIVE">
	 	<![CDATA[
		SELECT BLKAUT
		FROM OPRSHPBLK
		WHERE CMPCOD=? AND
 		      DOCOWRIDR=? AND
 		      MSTDOCNUM=? AND
 		      DUPNUM=? AND
 		      SEQNUM=? AND
 		      DOCNUM=? AND
 		      BLKAUT=? AND
		     (BLKEXPDAT IS NULL OR BLKEXPDAT > ?) AND
 		      BLKSTA='B'
	 	]]>
	 </QRY:Source>
	</QRY:Definition>

	 <QRY:Definition>
	 <QRY:Id>83</QRY:Id>
	 <QRY:Source Name="operations.shipment.findduplicatepreblockexist" Type="NATIVE">
	 	<![CDATA[
		SELECT BLKAUT
		FROM OPRSHPPREBLK
		WHERE CMPCOD=? AND
 		      DOCOWRIDR=? AND
 		      MSTDOCNUM=? AND
 		      SEQNUM=? AND
 		      BLKAUT=? AND
 		      BLKSTA='B'
	 	]]>
	 </QRY:Source>
	</QRY:Definition>

	 <QRY:Definition>
	 <QRY:Id>84</QRY:Id>
	 <QRY:Source Name="operations.shipment.findtransactionblocklevels" Type="NATIVE">
	 	<![CDATA[
		SELECT CMPCOD,TXNCOD,SERNUM,ARPCOD,REFONE,REFTWO,REFTHR,
			REFFOR,REFFIV,LSTUPDUSR,LSTUPDTIM
		FROM OPRTXNBLKLVL
		WHERE  CMPCOD=? AND
		 	TXNCOD=?
	 	]]>
	 </QRY:Source>
	</QRY:Definition>



	 <QRY:Definition>
	 <QRY:Id>85</QRY:Id>
	 <QRY:Source Name="operations.shipment.findshipmentdimensiondetials" Type="NATIVE">
	 	<![CDATA[
		SELECT CMPCOD, MSTDOCNUM, DOCOWRIDR, DUPNUM, SEQNUM,
		       DIMSERNUM, DISWGT, LSTUPDTIM, LSTUPDUSR, NUMPCS,
		       PCSHGT, PCSLEN, PCSVOL, PCSWID, WGT, WGTCOD, ARPCOD, TILTBL, RMK, DIMSRC, DISVOL, VOLUNT
		FROM OPRSHPDIMACP
		WHERE CMPCOD = ? AND
		      ARPCOD = ? AND
		      DOCOWRIDR = ? AND
		      MSTDOCNUM = ? AND
		      DUPNUM = ? AND
		      SEQNUM = ?
	 	]]>
	 </QRY:Source>
	</QRY:Definition>


	 <QRY:Definition>
	 <QRY:Id>86</QRY:Id>
	 <QRY:Source Name="operations.shipment.findctouldacceptancedetails" Type="NATIVE">
	 	<![CDATA[
			SELECT
				A.CMPCOD, A.ULDNUM, A.SERNUM ULDSERNUM,
				A.POU, A.WHSCOD,A.LOCCOD,
				A.GRSWGT, A.GRSDISWGT, A.GRSWGTCOD, A.TARWGT, A.TARDISWGT, A.TARWGTCOD,
				A.FLTCARIDR, A.FLTNUM, A.FLTSEQNUM, A.SEGSERNUM, A.FLTDAT,
				A.LSTUPDUSR, A.LSTUPDTIM, A.RATTYP, A.ACPUSR, A.ACPDAT,
				B.MSTDOCNUM, B.DOCOWRIDR, B.DUPNUM, B.SEQNUM,
				B.ULDWGTCOD, B.ACPVOLCOD, B.ACPPCS, B.ULDWGT, B.ULDDISWGT, B.ACPVOL, B.ACPDISVOL, B.ULDCTR ULDCTR,
				B.SCCCOD ULDACPSCCCOD , B.CMDITMNAM ULDACPCMDITMNAM , B.SHPDES  ULDACPSHPDES , B.SHPRMK  ULDACPSHPRMK ,
				MST.SHPPFX, MST.UBRNUM, MST.STDPCS, MST.STDWGT,
				MST.ORGCOD, MST.DSTCOD, MST.OWRCOD,MST.CONFLG,
				A.LSTUPDTIM ACPLSTUPDTIM, A.LSTUPDUSR ACPLSTUPDUSR,
				B.LSTUPDTIM ACPDTLLSTUPDTIM, B.LSTUPDUSR ACPDTLLSTUPDUSR,
				MST.LSTUPDTIM MSTLSTUPDTIM, MST.LSTUPDUSR MSTLSTUPDUSR,ARPULD.ULDBKGIDR,ARPULD.BKGTYP,ARPULD.BUPFLG,A.ARPCOD ACPARPCOD
			  FROM
				OPRULDACP A,
				OPRULDACPDTL B,
				OPRSHPMST MST,
				OPRARPULD ARPULD
			 WHERE
			    	A.CMPCOD = B.CMPCOD
			AND 	A.ULDNUM = B.ULDNUM
			AND 	A.ARPCOD = B.ARPCOD
			AND 	A.SERNUM = B.ULDSERNUM
			AND     A.CMPCOD = ARPULD.CMPCOD(+)
			AND 	A.ULDNUM = ARPULD.ULDNUM(+)
			AND 	A.ARPCOD = ARPULD.ARPCOD(+)
			AND 	B.CMPCOD = MST.CMPCOD
			AND 	B.MSTDOCNUM = MST.MSTDOCNUM
			AND 	B.DOCOWRIDR = MST.DOCOWRIDR
			AND 	B.DUPNUM = MST.DUPNUM
			AND 	B.SEQNUM = MST.SEQNUM
 			AND 	B.CMPCOD = ?
 	 ]]>
	 </QRY:Source>
	</QRY:Definition>


	 <QRY:Definition>
	 <QRY:Id>87</QRY:Id>
	 <QRY:Source Name="operations.shipment.findctoshipmentacceptancedetails" Type="NATIVE">
	 	<![CDATA[
		SELECT MSTDOCNUM, DOCOWRIDR, DUPNUM, SEQNUM, ACPIDR,
			CMPCOD, WHSCOD, LOCCOD, ACPPCS, ACPWGT, ACPVOL,
			CMDITMNAM, LSTUPDUSR, LSTUPDTIM, ACPWGTCOD, ACPVOLCOD,
			ACPDISWGT, ACPDISVOL,OVRFLWFLG, OVRFLWULDNUM, SCCCOD,
			SHPDES, SHPRMK, WHSCOD, LOCCOD, STUCOD,
			LSTUPDTIM, LSTUPDUSR,ARPCOD
		FROM OPRSHPACPDTL
		WHERE CMPCOD = ? AND
		      ARPCOD = ? AND
		      DOCOWRIDR = ? AND
		      MSTDOCNUM = ? AND
		      DUPNUM = ? AND
		      SEQNUM = ?
	 	]]>
	 </QRY:Source>
	</QRY:Definition>



	<QRY:Definition>
	<QRY:Id>88</QRY:Id>
	<QRY:Source Name="operations.shipment.findctoshipmentdetails" Type="NATIVE">
		<![CDATA[
						SELECT ARP.ARPCOD,
						  OPR.ACPWHSCOD,
						  MST.CMPCOD,
						  MST.DOCOWRIDR,
						  MST.MSTDOCNUM,
						  MST.DUPNUM,
						  MST.SEQNUM,
						  ORGCOD,
						  DSTCOD,
						  SCCCOD,
						  STDPCS,
						  MST.SHPPFX,
						  MST.PRDCOD,
						  MST.PRDNAM,
						  MST.PRDPRT,
						  MST.UBRNUM,
						  STDWGT,
						  STDWGTCOD,
						  SHPDES,
						  OPR.ACPRMK,
						  TOTACPPCS,
						  TOTACPWGT,
						  TOTACPVOL,
						  STDDISWGT,
						  SHPSTA,
						  PLTFLG,
						  EXEFLG,
						  MST.GRSVOL,
						  MST.GRSDISVOL,
						  MST.GRSVOLUNT,
						  MST.SHPCOD,
						  MST.SHPNAM,
						  MST.AGTCOD, 
						  MST.AGTNAM, 
						  MST.DOMFLG,
						  MST.PLTFLG,
						  OPR.PLTUSEFLG,
						  ARP.PLTUSEFLG ARPPLTUSEFLG,
						  MST.LSTUPDTIM MSTLSTUPDTIM,
						  MST.LSTUPDUSR MSTLSTUPDUSR,
						  OPR.LSTUPDTIM OPRLSTUPDTIM,
						  OPR.LSTUPDUSR OPRLSTUPDUSR,
						  OPR.DRPOFFDAT,
						  OPR.ACPDAT,
						  ARP.LSTUPDTIM ARPLSTUPDTIM,
						  ARP.LSTUPDUSR ARPLSTUPDUSR,
						  ARP.AVLPCS ARPAVLPCS,
						  OPR.CHKPCS,
						  MST.HDLINF,
						  OPR.APRFLG,
						  OPR.ACPFNLFLG,
						  MST.RDYCRGFLG,
						  MST.DTACPTFLG,
						  MST.CONFLG,
						  OPR.TOTDLVWGT,
						  ARP.INBCARCOD,
						  ARP.INBCARTRKIND,
						   ARP.INBFLTNUM, 
						  ARP.INBFLTDAT,
						  ARP.CTMREFNUM,
						  SRN.TOTSRNPCS,
						  ARP.BNDIDR,
						  MST.CPTDAT, CNT.SHPCFTNUM SHPCFTNUM, CNT.SHPCFTTYP SHPCFTTYP, CNT.SHPCSFNUM SHPCSFNUM, 
						  ARP.TMPSTGFLG,(select SCICOD from OPRSHPMSTMIS MIS
            where MIS .CMPCOD = MST.CMPCOD            
							AND MIS.DOCOWRIDR = MST.DOCOWRIDR 
							AND MIS.MSTDOCNUM = MST.MSTDOCNUM
							AND MIS.DUPNUM = MST.DUPNUM  
							AND MIS.SEQNUM = MST.SEQNUM   
						  )SCICOD,
						  (SELECT FLDDES GRSVOLUNTDES
						  FROM SHRONETIM SOT
						  WHERE SOT.CMPCOD=MST.CMPCOD
						  AND SOT.FLDTYP ='shared.defaults.volumeUnitCodes' 
						  AND SOT.FLDVAL =MST.GRSVOLUNT
						  ) GRSVOLUNTDES,
						  (SELECT FLDDES STDWGTCODSES
						  FROM SHRONETIM SOT
						  WHERE SOT.CMPCOD=MST.CMPCOD
						  AND SOT.FLDTYP ='shared.defaults.weightUnitCodes' 
						  AND SOT.FLDVAL =MST.STDWGTCOD
						  ) STDWGTCODSES,
						  ARP.TRNSHPFLG,
						  ARP.OUBCARCOD,OPR.CHKVOL,OPR.CHKWGT,
						  OPR.DIMCPTSTA
						FROM OPRSHPMST MST,OPRSHPMSTCNT CNT,
						  OPRSHPDTL OPR,
						  OPRARPSHP ARP,
						  (SELECT SRN.CMPCOD,
							SRN.DOCOWRIDR,
							SRN.MSTDOCNUM,
							SRN.DUPNUM,
							SRN.SEQNUM,
							SUM(SRN.dlvpcs) TOTSRNPCS
						  FROM oprshpsrn SRN
						  GROUP BY SRN.CMPCOD,
							SRN.DOCOWRIDR,
							SRN.MSTDOCNUM,
							SRN.DUPNUM,
							SRN.SEQNUM
						  ) SRN
						WHERE MST.CMPCOD = OPR.CMPCOD(+) 
						AND MST.DOCOWRIDR = OPR.DOCOWRIDR(+)
						AND MST.MSTDOCNUM = OPR.MSTDOCNUM(+)
						AND MST.DUPNUM = OPR.DUPNUM(+) 
						AND MST.SEQNUM = OPR.SEQNUM(+) 
						 AND MST.CMPCOD = CNT.CMPCOD(+)
		                 AND MST.DOCOWRIDR = CNT.DOCOWRIDR(+)
		                 AND MST.MSTDOCNUM = CNT.MSTDOCNUM(+)
		                 AND MST.DUPNUM = CNT.DUPNUM(+)
		                 AND MST.SEQNUM = CNT.SEQNUM(+)
						AND OPR.CMPCOD = ARP.CMPCOD(+) 
						AND OPR.DOCOWRIDR = ARP.DOCOWRIDR(+)
						AND OPR.MSTDOCNUM = ARP.MSTDOCNUM(+)
						AND OPR.DUPNUM = ARP.DUPNUM(+) 
						AND OPR.SEQNUM = ARP.SEQNUM(+) 
						AND MST.CMPCOD = SRN.CMPCOD(+) 
						AND MST.DOCOWRIDR = SRN.DOCOWRIDR(+)
						AND MST.MSTDOCNUM = SRN.MSTDOCNUM(+)
						AND MST.DUPNUM = SRN.DUPNUM(+) 
						AND MST.SEQNUM = SRN.SEQNUM(+) 
   						AND MST.CMPCOD=?
						AND MST.DOCOWRIDR=?
						AND MST.MSTDOCNUM=?
						AND MST.DUPNUM=?
						AND MST.SEQNUM =?
						AND ARP.ARPCOD(+) = ?


	]]>
	</QRY:Source>
	</QRY:Definition>


	<QRY:Definition>
	<QRY:Id>89</QRY:Id>
	<QRY:Source Name="operations.shipment.cto.findshipmentformanifestvalidation" Type="NATIVE">
		<![CDATA[
		SELECT ARPSHP.ARPCOD, ARLSHP.AVLPCS, ARPSHP.MFTPCS, ARPSHP.MFTWGT,
		       ARPSHP.MFTVOL, ARPSHP.DNTUSEFLG, ARPSHP.RCVPCS, ARPSHP.RCVWGT,
		       ARPSHP.RCVVOL, ARLSHP.AVLWGT, ARPSHP.AVLVOL, ARPSHP.DOCRCVFLG,
		       ARPSHP.ABDPCS, ARPSHP.ABDWGT, ARPSHP.TOTDLVNOTPCS, ARPSHP.TOTDLVNOTWGT,
		       ARPSHP.TOTDLVPCS, ARPSHP.TOTDLVWGT
		  FROM OPRARPSHP ARPSHP, OPRARPARLSHP ARLSHP
		 WHERE ARPSHP.DOCOWRIDR = ARLSHP.DOCOWRIDR
		 AND ARPSHP.MSTDOCNUM = ARLSHP.MSTDOCNUM
		   AND ARPSHP.DUPNUM = ARLSHP.DUPNUM
		   AND ARPSHP.SEQNUM = ARLSHP.SEQNUM
		   AND ARPSHP.CMPCOD = ARLSHP.CMPCOD
		   AND ARPSHP.ARPCOD = ARLSHP.ARPCOD
		   AND ARPSHP.MSTDOCNUM = ?
		   AND ARPSHP.DOCOWRIDR = ?
		   AND ARPSHP.DUPNUM = ?
		   AND ARPSHP.SEQNUM = ?
		   AND ARPSHP.ARPCOD = ?
		   AND ARPSHP.CMPCOD = ?
		   AND ARLSHP.OWNCARIDR = ?

   ]]>
	</QRY:Source>
	</QRY:Definition>

		 <QRY:Definition>
	 <QRY:Id>90</QRY:Id>
	 <QRY:Source Name="operations.shipment.checkforpreblock" Type="NATIVE">
	 	<![CDATA[
		SELECT SHPPREBLK.CMPCOD,SHPPREBLK.ARPCOD,SHPPREBLK.MSTDOCNUM,SHPPREBLK.DOCOWRIDR,SHPPREBLK.SEQNUM,
		SHPPREBLK.SERNUM,SHPPREBLK.BLKUSR,SHPPREBLK.BLKAUT,BLKAUT.AUTNAM,SHPPREBLK.BLKSTRDAT,SHPPREBLK.BLKEXPDAT,
		SHPPREBLK.BLKSTA,SHPPREBLK.RELDAT,SHPPREBLK.LSTUPDTIM,SHPPREBLK.LSTUPDUSR,SHPPREBLK.BLKRMK
		FROM OPRSHPPREBLK SHPPREBLK,OPRBLKAUT BLKAUT
		WHERE
		SHPPREBLK.CMPCOD=BLKAUT.CMPCOD AND
		SHPPREBLK.BLKAUT=BLKAUT.AUTCOD AND
		SHPPREBLK.CMPCOD = ? AND
		SHPPREBLK.SEQNUM = ? AND
		SHPPREBLK.DOCOWRIDR = ? AND
		SHPPREBLK.MSTDOCNUM = ? AND
		(SHPPREBLK.BLKEXPDAT IS NULL OR SHPPREBLK.BLKEXPDAT > ?) AND
		SHPPREBLK.BLKSTA='B'

	 	]]>
	 </QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	 <QRY:Id>91</QRY:Id>
	 <QRY:Source Name="operations.shipment.findshipperreturnnotedetails" Type="NATIVE">
	 	<![CDATA[
		SELECT SHPMST.DOCOWRIDR,SHPMST.MSTDOCNUM,SHPMST.DUPNUM ,SHPMST.SEQNUM,SHPMST.CMPCOD,SHPMST.SHPPFX,
			SHPMST.SHPNAM,SHPMST.STDPCS,SHPMST.STDWGT,SHPMST.GRSVOL,SHPMST.DSTCOD,SHPMST.PRDNAM,SHPMST.SCCCOD,SHPMST.SHPDES,
			SHPSRN.SRNNUM,SHPSRN.SRNPCS,SHPSRN.ARPCOD,SHPSRN.ISSDAT,SHPSRN.SRNISSUSR,SHPSRN.SRNSTA,SHPSRN.EXPDAT,
			SHPSRN.RSNCOD,SHPSRN.RMK,SHPSRN.PAYADVNUM,SHPSRN.PAYADVISSDAT,
			ARPSHPMST.ACPPCS,ARPSHPMST.ACPWGT,ARPSHPMST.TOTSRNPCS,ARPSHPMST.AVLPCS,ARPSHPMST.TOTDLVPCS,SHPSRN.DLVPCS,ARPSHPMST.LSTUPDTIM ARPSHPTIM,SHPDTL.LSTUPDTIM SHPDTLTIM,SHPSRN.LSTUPDTIM SRNTIM,
			SHPMST.PLTFLG, ARPSHPMST.PLTUSEFLG ARPPLTUSEFLG,SHPDTL.PLTUSEFLG SHPLTUSEFLG
			FROM OPRSHPMST  SHPMST,OPRSHPSRN SHPSRN,OPRARPSHP ARPSHPMST, OPRSHPDTL SHPDTL
			WHERE
		  SHPMST.CMPCOD=SHPSRN.CMPCOD AND
		  SHPMST.SEQNUM=SHPSRN.SEQNUM AND
		  SHPMST.DUPNUM=SHPSRN.DUPNUM AND
		  SHPMST.DOCOWRIDR=SHPSRN.DOCOWRIDR AND
		  SHPMST.MSTDOCNUM=SHPSRN.MSTDOCNUM AND
		  SHPMST.CMPCOD  =  SHPDTL.CMPCOD
			AND SHPMST.SEQNUM    = SHPDTL.SEQNUM
			AND SHPMST.DUPNUM    = SHPDTL.DUPNUM
			AND SHPMST.DOCOWRIDR = SHPDTL.DOCOWRIDR
			AND SHPMST.MSTDOCNUM = SHPDTL.MSTDOCNUM AND
		   SHPDTL.CMPCOD  =  ARPSHPMST.CMPCOD
			AND SHPDTL.SEQNUM    = ARPSHPMST.SEQNUM
			AND SHPDTL.DUPNUM    = ARPSHPMST.DUPNUM
			AND SHPDTL.DOCOWRIDR = ARPSHPMST.DOCOWRIDR
			AND SHPDTL.MSTDOCNUM = ARPSHPMST.MSTDOCNUM AND
		SHPSRN.CMPCOD=? AND
		SHPSRN.SRNNUM=? and
		ARPSHPMST.ARPCOD = ?
	 	]]>
	 </QRY:Source>
	</QRY:Definition>

	 <QRY:Definition>
	 <QRY:Id>92</QRY:Id>
	 <QRY:Source Name="operations.shipment.checkforblock" Type="NATIVE">
	 	<![CDATA[
		SELECT  BLK.TRKNUM,BLK.ARPCOD,MST.CMPCOD,MST.DOCOWRIDR,MST.MSTDOCNUM,MST.DUPNUM,
			MST.SEQNUM,MST.DOCNUM,BLK.SERNUM,BLK.BLKAUT,BLK.BLKSTRDAT,BLK.BLKTXNCOD,
			BLK.BLKEXPDAT,BLK.BLKSTA,BLK.BLKUSR,BLK.BLKRMK,BLK.LSTUPDTIM,BLK.LSTUPDUSR,BLK.AUTNAM,
			MST.ORGCOD,MST.DSTCOD,MST.SCCCOD,MST.STDPCS,MST.CONFLG, MST.STDWGT,MST.STDWGTCOD,MST.SHPDES
		FROM OPRSHPMST  MST,
		(SELECT B.CMPCOD,B.DOCOWRIDR,B.MSTDOCNUM,B.DUPNUM,B.SEQNUM,B.SERNUM,
			B.ARPCOD,B.BLKAUT,B.BLKSTRDAT,B.BLKEXPDAT,B.BLKSTA,B.BLKUSR,
			B.BLKRMK,B.LSTUPDTIM,B.LSTUPDUSR,A.AUTNAM,B.TRKNUM,B.BLKTXNCOD
		FROM OPRSHPBLK B,OPRBLKAUT A
		WHERE  A.AUTCOD = B.BLKAUT)BLK

		WHERE MST.CMPCOD=BLK.CMPCOD(+) AND
			MST.DOCOWRIDR=BLK.DOCOWRIDR(+) AND
			MST.MSTDOCNUM=BLK.MSTDOCNUM(+) AND
			MST.DUPNUM=BLK.DUPNUM(+) AND
			MST.SEQNUM = BLK.SEQNUM(+) AND
			MST.MSTDOCNUM = ? AND
			MST.DOCOWRIDR = ? AND
			MST.DUPNUM = ? AND
			MST.SEQNUM = ? AND
			MST.CMPCOD = ? AND
			(BLK.BLKEXPDAT IS NULL OR BLK.BLKEXPDAT > ?) AND
			BLK.BLKSTA (+) ='B'
		]]>
	 </QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	 <QRY:Id>93</QRY:Id>
	 <QRY:Source Name="operations.shipment.findshipmentdetailsforshipperreturn" Type="NATIVE">
	 	<![CDATA[
		SELECT 	SHPMST.DOCOWRIDR,SHPMST.MSTDOCNUM,SHPMST.DUPNUM ,SHPMST.SEQNUM,SHPMST.CMPCOD,SHPMST.SHPPFX,
						SHPMST.SHPNAM,SHPMST.STDPCS,SHPMST.STDWGT,SHPMST.GRSVOL,
						SHPMST.DSTCOD,SHPMST.PRDNAM,SHPMST.SCCCOD,SHPMST.SHPDES,
						ARPSHPMST.ACPPCS,ARPSHPMST.TOTSRNPCS,ARPSHPMST.AVLPCS,ARPSHPMST.TOTDLVPCS,ARPSHPMST.LSTUPDTIM,
						ARPSHPMST.ACPWGT, ARPSHPMST.TMPSTGFLG ,ARPSHPMST.AVLWGT,
						SHPMST.PLTFLG, ARPSHPMST.PLTUSEFLG ARPPLTUSEFLG ,SHPDTL.PLTUSEFLG SHPLTUSEFLG
		FROM OPRSHPMST  SHPMST,OPRARPSHP ARPSHPMST,OPRSHPDTL SHPDTL
		WHERE
			  SHPMST.CMPCOD =SHPDTL.CMPCOD(+) AND
			  SHPMST.SEQNUM =  SHPDTL.SEQNUM(+) AND
			  SHPMST.DUPNUM = SHPDTL.DUPNUM(+) AND
			  SHPMST.DOCOWRIDR  = SHPDTL.DOCOWRIDR(+) AND
			  SHPMST.MSTDOCNUM  = SHPDTL.MSTDOCNUM(+) AND 
			  SHPMST.CMPCOD =ARPSHPMST.CMPCOD(+) AND
			  SHPMST.SEQNUM =  ARPSHPMST.SEQNUM(+) AND
			  SHPMST.DUPNUM = ARPSHPMST.DUPNUM(+) AND
			  SHPMST.DOCOWRIDR  = ARPSHPMST.DOCOWRIDR(+) AND
			  SHPMST.MSTDOCNUM  = ARPSHPMST.MSTDOCNUM(+)
			  AND
			  ARPSHPMST.ARPCOD = ? AND
			  SHPMST.CMPCOD = ? AND
			  SHPMST.SEQNUM = ? AND
			  SHPMST.DUPNUM = ? AND
			  SHPMST.DOCOWRIDR = ? AND
			  SHPMST.MSTDOCNUM=?
	 	]]>
	 </QRY:Source>
	</QRY:Definition>

	 <QRY:Definition>
	 <QRY:Id>94</QRY:Id>
	 <QRY:Source Name="operations.shipment.findctoacceptancehistorydetails" Type="NATIVE">
	 	<![CDATA[
		SELECT MSTDOCNUM, DOCOWRIDR, DUPNUM, SEQNUM, SERNUM,
			CMPCOD, ACPSTRTIM, ACPENDTIM, ACPUSR, ARPCOD
		FROM OPRSHPACPHIS
		WHERE CMPCOD = ? AND
		      ARPCOD = ? AND
		      DOCOWRIDR = ? AND
		      MSTDOCNUM = ? AND
		      DUPNUM = ? AND
		      SEQNUM = ?
 	 	]]>
	 </QRY:Source>
	</QRY:Definition>
	<!--Modified  findctodeliverydetails query by A-5186 for ICRD-28090-->
	 <QRY:Definition>
	 <QRY:Id>95</QRY:Id>
	 <QRY:Source Name="operations.shipment.findctodeliverydetails" Type="NATIVE">
	 	<![CDATA[
	 	SELECT MST.MSTDOCNUM,MST.SEQNUM,MST.DUPNUM,MST.DOCOWRIDR,MST.CMPCOD,MST.STDPCS,
		 MST.STDWGT, MST.ORGCOD, MST.DSTCOD, MST.SCCCOD, MST.SHPDES,MST.PAYTYP,
				MST.SHPPFX,DLV.PAYADVNUM, DLV.DLVSTF, DLV.PAYADVISSDAT, DLV.DLVNOTPCS,
		       DLV.DLVNOTWGT, DLV.RMK, DLV.DLVNOTSTA, DLV.DLVCUSCOD, DLV.DLVCUSNAM,
		       DLV.DLVNOTNUM,DLV.DOCNUM,DLV.DLVPCS,DLV.ARPCOD,DLV.PAYADVEXPDAT,DLV.PCKWHSCOD,DLV.PCKLSTREFNUM,
		        ARP.TOTDLVNOTPCS,ARP.TOTDLVNOTWGT, ARP.TOTDLVPCS,
		       ARP.TOTDLVWGT, 
				CASE WHEN ARP.DCSPCS>0 THEN ARP.DCSPCS ELSE ARP.RCVPCS END RCVPCS,
				CASE WHEN ARP.DCSWGT>0 THEN ARP.DCSWGT ELSE ARP.RCVWGT END RCVWGT, 
			   ARP.DOCHDRFLG,MST.CONFLG,
		       ARP.HDRTOO,ARP.ULDPCS,ARP.ULDWGT,ARP.HDRTIM,ARP.HDRRMK,DTL.PLTUSEFLG,MST.PLTFLG,
			   ARP.LSTUPDTIM ARPUPDTIM,ARP.LSTUPDUSR ARPUPDUSR,DLV.LSTUPDTIM DLVUPDTIM,
			   DLV.LSTUPDUSR DLVUPDUSR,DTL.LSTUPDTIM DTLUPDTIM,DTL.LSTUPDUSR DTLUPDUSR,
			   DLV.PCKWHSCOD,DLV.PCKLSTREFNUM,ARP.BOE ,DLV.AGTCRDNUM,ACC.TOTCCF,ACC.SRVCRGCLS,MST.CHGCOD,DLV.DLVCUSNAM CNSNAM,DLV.DLVCUSCOD CNSCOD,
			   LOC.WHSCOD,LOC.LOCCOD,LOC.STUCOD,LOC.LOCPCS,LOC.DLVNOTPCS LOCDNPCS, DLV.CNSIDRTYP, DLV.CNSIDR,NOTULD.ULDNUM, COALESCE(MIS.SCICOD,MISMST.SCICOD) SCICOD,
       (SELECT RTRIM(XMLAGG(XMLELEMENT(E, COLLST.DLVIDR
          || ',')).EXTRACT('//text()'), ',') ENAMES
				  FROM (SELECT
						MSTDOCNUM,DOCOWRIDR,DUPNUM,SEQNUM,CMPCOD,DLVIDR,ULDNUM
						FROM OPRCOLLSTSHP GROUP BY
							MSTDOCNUM,DOCOWRIDR,DUPNUM,SEQNUM,CMPCOD,DLVIDR,ULDNUM) COLLSTSHP,
          OPRCOLLST COLLST
				  WHERE COLLSTSHP.CMPCOD  = MST.CMPCOD
				  AND COLLSTSHP.DOCOWRIDR = MST.DOCOWRIDR
				  AND COLLSTSHP.MSTDOCNUM = MST.MSTDOCNUM
				  AND COLLSTSHP.SEQNUM    = MST.SEQNUM
				  AND COLLSTSHP.DUPNUM    = MST.DUPNUM
          AND COLLSTSHP.CMPCOD = COLLST.CMPCOD
          AND COLLSTSHP.DLVIDR = COLLST.DLVIDR
		    AND NVL(NOTULD.ULDNUM,'BULK') = COLLSTSHP.ULDNUM
				  AND COLLST.COLLSTSTA    = 'ACT'
				  AND COLLST.EXPDAT >= ? 
				  )ACTGRPIDR,
		(SELECT DLVGAT
				  FROM (SELECT
						MSTDOCNUM,DOCOWRIDR,DUPNUM,SEQNUM,COLLST.CMPCOD,MAX(COLLST.DLVGAT) DLVGAT
						FROM OPRCOLLSTSHP COLLSTSHP,OPRCOLLST COLLST 
            WHERE COLLSTSHP.CMPCOD   = COLLST.CMPCOD
        AND COLLSTSHP.DLVIDR = COLLST.DLVIDR
        AND COLLST.COLLSTSTA = 'ACT'
        GROUP BY MSTDOCNUM,DOCOWRIDR,DUPNUM,SEQNUM,COLLST.CMPCOD  HAVING COUNT(DISTINCT COLLST.DLVIDR) = 1) COLLSTSHP
				  WHERE COLLSTSHP.CMPCOD  = MST.CMPCOD
				  AND COLLSTSHP.DOCOWRIDR = MST.DOCOWRIDR
				  AND COLLSTSHP.MSTDOCNUM = MST.MSTDOCNUM
				  AND COLLSTSHP.SEQNUM    = MST.SEQNUM
				  AND COLLSTSHP.DUPNUM    = MST.DUPNUM
				  ) DLVGAT,		  
         
			   LOC.WHSCOD,LOC.LOCCOD,LOC.STUCOD,LOC.LOCPCS,LOC.DLVNOTPCS LOCDNPCS, DLV.CNSIDRTYP, DLV.CNSIDR, COALESCE(MIS.SCICOD,MISMST.SCICOD) SCICOD,
			   DTL.CHGCLDFLG,DLVNOTFLT.FLTCARIDR,DLVNOTFLT.FLTNUM,DLVNOTFLT.FLTSEQNUM,DLV.ADLINFONE,DLV.ADDINFTWO,DLV.ADDINFTHR,LEG.STA FLTDAT,
			   (CASE ARL.APHCODUSE WHEN 2
				THEN ARL.TWOAPHCOD
				ELSE ARL.THRAPHCOD
				END) FLTCARCOD
			  FROM OPRSHPMST  MST, OPRARPSHP ARP, OPRSHPDLVNOT DLV,OPRSHPDTL DTL,
			  OPRSHPMSTACC ACC,OPRSHPDLVNOTLOC LOC, OPRSHPMSTMIS MIS,OPRSHPMSTMIS MISMST,OPRSHPDLVNOTULD NOTULD,
			  OPRSHPDLVNOTFLT DLVNOTFLT,FLTOPRLEG LEG,SHRARLMST ARL
			 WHERE MST.MSTDOCNUM = ARP.MSTDOCNUM
			   AND MST.DOCOWRIDR = ARP.DOCOWRIDR
			   AND MST.DUPNUM = ARP.DUPNUM
			   AND MST.SEQNUM = ARP.SEQNUM
			   AND MST.CMPCOD = ARP.CMPCOD
			   AND MST.MSTDOCNUM = DTL.MSTDOCNUM
			   AND MST.DOCOWRIDR = DTL.DOCOWRIDR
			   AND MST.DUPNUM = DTL.DUPNUM
			   AND MST.SEQNUM = DTL.SEQNUM
			   AND MST.CMPCOD = DTL.CMPCOD
			   AND DLV.ARPCOD = ARP.ARPCOD
			   AND DLV.CMPCOD = ARP.CMPCOD
			   AND DLV.DOCOWRIDR = ARP.DOCOWRIDR
			   AND DLV.MSTDOCNUM = ARP.MSTDOCNUM
			   AND DLV.SEQNUM = ARP.SEQNUM
			   AND DLV.DUPNUM = ARP.DUPNUM
               AND MST.MSTDOCNUM = ACC.MSTDOCNUM(+)
	 		   AND MST.DUPNUM = ACC.DUPNUM(+)
			   AND MST.SEQNUM = ACC.SEQNUM(+)
			   AND MST.CMPCOD = ACC.CMPCOD(+)
			   AND MST.DOCOWRIDR = ACC.DOCOWRIDR(+)
			   AND DLV.ARPCOD = LOC.ARPCOD(+)
			   AND DLV.DLVNOTNUM = LOC.DLVNOTNUM(+)
			   AND DLV.CMPCOD = NOTULD.CMPCOD(+)
			   AND DLV.ARPCOD = NOTULD.ARPCOD(+)
			   AND DLV.DLVNOTNUM = NOTULD.DLVNOTNUM(+)
			   AND DLV.CMPCOD = LOC.CMPCOD(+)
			   AND (NOTULD.ULDNUM IS NULL OR NOTULD.ULDNUM = LOC.STUCOD)
			   AND MST.CMPCOD    = MIS.CMPCOD(+)
			   AND MST.MSTDOCNUM = MIS.MSTDOCNUM(+)
			   AND MST.DOCOWRIDR = MIS.DOCOWRIDR(+)
			   AND MST.SEQNUM    = MIS.SEQNUM(+)
			   AND MST.DUPNUM    = MIS.DUPNUM(+)
			   AND MST.CMPCOD    = MISMST.CMPCOD(+)
			   AND MST.MSTDOCNUM = MISMST.MSTDOCNUM(+)
			   AND MST.DOCOWRIDR = MISMST.DOCOWRIDR(+)
			   AND MST.DUPNUM    = MISMST.DUPNUM(+)
			   AND MST.PARSEQNUM = MISMST.SEQNUM(+)
			   AND (COALESCE(ARP.DCSREQFLG,'N')  = 'N' OR MST.CONFLG ='N')
			   AND DLV.CMPCOD    = DLVNOTFLT.CMPCOD(+)
			   AND DLV.DLVNOTNUM = DLVNOTFLT.DLVNOTNUM(+)
			   AND DLV.ARPCOD    = DLVNOTFLT.ARPCOD(+)
			   AND DLVNOTFLT.FLTNUM = LEG.FLTNUM(+)
			   AND DLVNOTFLT.FLTCARIDR = LEG.FLTCARIDR(+)
			   AND DLVNOTFLT.FLTSEQNUM = LEG.FLTSEQNUM(+)
			   AND DLVNOTFLT.CMPCOD    = LEG.CMPCOD(+)			   
			   AND DLVNOTFLT.CMPCOD    =ARL.CMPCOD(+)
			   AND DLVNOTFLT.FLTCARIDR =ARL.ARLIDR(+)			   
			   AND DLV.DLVNOTNUM = ?
			   AND DLV.CMPCOD = ?
			   AND DLV.ARPCOD = ?
 	 	]]>
	 </QRY:Source>
	</QRY:Definition>

	 <QRY:Definition>
	 <QRY:Id>96</QRY:Id>
	 <QRY:Source Name="operations.shipment.findShipmentDetailsForCTODelivery" Type="NATIVE">
	 	<![CDATA[
	 	SELECT MST.MSTDOCNUM,MST.SEQNUM,MST.DUPNUM,MST.DOCOWRIDR,MST.CMPCOD,ARP.ARPCOD,MST.STDPCS,MST.STDWGT, MST.ORGCOD, MST.DOCNUM,MST.SHPPFX,MST.DSTCOD,MST.SCCCOD,MST.SHPDES,ARP.TOTDLVNOTPCS,ARP.TOTDLVNOTWGT,
ARP.TOTDLVPCS,ARP.TOTDLVWGT,ARP.HDRTOO, ARP.HDRTIM,ARP.HDRRMK,
CASE WHEN ARP.DCSPCS>0 THEN ARP.DCSPCS ELSE ARP.RCVPCS END RCVPCS,
CASE WHEN ARP.DCSWGT>0 THEN ARP.DCSWGT ELSE ARP.RCVWGT END RCVWGT, 
ARP.DOCHDRFLG,ARP.ULDPCS,ARP.ULDWGT,ARP.LSTUPDTIM ARPUPDTIM,ARP.LSTUPDUSR ARPUPDUSR,ACC.TOTCCF,ACC.SRVCRGCLS,MST.CNSNAM,MST.CNSCOD,
ARP.ACPPCS, ARP.TOTSRNPCS,ARP.ACPWGT,DTL.CHGCLDFLG 
FROM OPRSHPMST MST,OPRARPSHP ARP, OPRSHPMSTACC ACC, OPRSHPDTL DTL
		WHERE MST.MSTDOCNUM=ARP.MSTDOCNUM(+)
		AND MST.DOCOWRIDR=ARP.DOCOWRIDR(+)
		AND MST.DUPNUM=ARP.DUPNUM(+)
		AND MST.SEQNUM=ARP.SEQNUM(+)
		AND MST.CMPCOD=ARP.CMPCOD(+)
                AND MST.MSTDOCNUM = ACC.MSTDOCNUM(+)
AND MST.DUPNUM = ACC.DUPNUM(+)
AND MST.SEQNUM = ACC.SEQNUM(+)
AND MST.CMPCOD = ACC.CMPCOD(+)
AND MST.DOCOWRIDR = ACC.DOCOWRIDR(+)
AND MST.CMPCOD       = DTL.CMPCOD(+)
AND MST.MSTDOCNUM    = DTL.MSTDOCNUM(+)
AND MST.DOCOWRIDR    = DTL.DOCOWRIDR(+)
AND MST.SEQNUM       = DTL.SEQNUM(+)
AND MST.DUPNUM       = DTL.DUPNUM(+)
		AND MST.CMPCOD=?
		AND ARP.ARPCOD(+)=?
		AND MST.MSTDOCNUM=?
		AND MST.SEQNUM=?
		AND MST.DOCOWRIDR=?
		AND MST.DUPNUM=?
 	 	]]>
	 </QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>97</QRY:Id>
   	<QRY:Source Name="operations.shipment.findtransactionblockleveldetails" Type="NATIVE">
		<![CDATA[
		SELECT CMPCOD,BLKAUT,BLKTXN,CHKTYP,CSMMSG,LSTUPDTIM,LSTUPDUSR FROM OPRTXNBLKLVL WHERE CMPCOD= ?
		]]>
  	</QRY:Source>
  	</QRY:Definition>

  		<QRY:Definition>
	<QRY:Id>97</QRY:Id>
   	<QRY:Source Name="operations.shipment.findautoblocks" Type="NATIVE">
		<![CDATA[
		 SELECT BLKTYP FROM OPRAUTBLKMST WHERE CMPCOD = ? AND BLKTYP IN
		]]>
  	</QRY:Source>
  	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>97</QRY:Id>
   	<QRY:Source Name="operations.shipment.cto.checktransactionblock" Type="NATIVE">
		<![CDATA[
		SELECT LVL.CMPCOD,
		LVL.BLKAUT,
		AUT.AUTNAM BLKAUTNAM,
		LVL.BLKTXN,LVL.CSMMSG,
		LVL.CHKTYP,MST.SHPPFX,  case when BLK.seqnum > 1 then MST.DOCNUM else null END DOCNUM
		FROM OPRTXNBLKLVL LVL INNER JOIN OPRSHPBLK BLK ON 
		BLK.BLKAUT = LVL.BLKAUT AND
		BLK.CMPCOD = LVL.CMPCOD
		INNER JOIN OPRBLKAUT AUT
		ON AUT.AUTCOD  = LVL.BLKAUT
		AND AUT.CMPCOD = LVL.CMPCOD
		INNER JOIN OPRSHPMST MST 
		ON BLK.MSTDOCNUM =MST.mstdocnum 
		and BLK.SEQNUM=mst.seqnum 
		and BLK.DUPNUM=mst.dupnum
		and BLK.DOCOWRIDR =mst.docowridr 
		and BLK.CMPCOD=mst.cmpcod
		AND BLK.BLKSTA    ='B'
		AND BLK.MSTDOCNUM =? 
		and (    BLK.SEQNUM=? 
			  OR BLK.SEQNUM=(select parseqnum from oprshpmst mst 
					where MST.mstdocnum =  BLK.MSTDOCNUM 
					and mst.seqnum = ?
					and mst.dupnum = BLK.DUPNUM
					and  mst.docowridr = BLK.DOCOWRIDR
					and mst.cmpcod = BLK.CMPCOD) 
			 )
		AND BLK.DUPNUM=? 
		AND BLK.DOCOWRIDR =?
		AND BLK.CMPCOD=? 
		AND( BLK.ARPCOD =? 
		OR BLK.ARPCOD is null) 
		
		

		]]>
  	</QRY:Source>
  	</QRY:Definition>

 	<QRY:Definition>
	 <QRY:Id>98</QRY:Id>
	 <QRY:Source Name="operations.shipment.validatedocumentrange" Type="NATIVE">
	 	<![CDATA[
				SELECT
					   SHPIDX.MSTDOCNUM
				FROM
					   OPRSHPIDX SHPIDX,
					   SHRSYSPAR PAR,
					   SHRARLMST ARL
				WHERE
					   SHPIDX.CMPCOD = ARL.CMPCOD
				AND	   SHPIDX.DOCOWRIDR = ARL.ARLIDR
				AND	   SHPIDX.CMPCOD = PAR.CMPCOD
				AND PAR.PARCOD = 'stock.defaults.documentprocessedtime'
				AND SHPIDX.SHPTYP = 'S'
				AND SHPIDX.CMPCOD= ?
				AND SHPIDX.DOCOWRIDR= ?
				AND ( SHPIDX.PRGSTA IS NULL OR SHPIDX.PRGSTA = 'N' )
				AND ADD_MONTHS(NVL(SHPIDX.LSTUPDTIM,SYSDATE),12*(TO_NUMBER(PARVAL)))> SYSDATE
				AND	  SHPIDX.MSTDOCNUM BETWEEN
								  ? || TO_CHAR( MOD(TO_NUMBER(?),ARL.AWBCHKDGT))
							AND	  ? || TO_CHAR( MOD(TO_NUMBER(?),ARL.AWBCHKDGT))
 	 	]]>
	 </QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	 <QRY:Id>99</QRY:Id>
	 <QRY:Source Name="operations.shipment.findCTOFSEnquiryDetails" Type="NATIVE">
	 	<![CDATA[
	 	SELECT MST.CMPCOD, MST.ARPCOD, MST.FLTCARCOD,MST.FLTNUM, MST.FNDSHPNUM, MST.FLTDAT, MST.FNDSHPSTA,MST.TOTDISPCS,MST.CPTDAT,MST.TOTRSLPCS,
			    DTL.FNDSHPSERNUM,DTL.ORGCOD, DTL.DSTCOD, DTL.SCC, RES.MSTDOCNUM, RES.SHPPFX, RES.RESPCS
		FROM OPRFNDSHP MST,OPRFNDSHPDTL DTL,OPRFNDSHPRES RES
		WHERE 	MST.CMPCOD = DTL.CMPCOD AND
				MST.ARPCOD = DTL.ARPCOD AND
		 		MST.FNDSHPNUM = DTL.FNDSHPNUM AND
				MST.CMPCOD = RES.CMPCOD(+) AND
				MST.ARPCOD = RES.ARPCOD(+) AND
		 		MST.FNDSHPNUM = RES.FNDSHPNUM(+) AND
		MST.CMPCOD = ?
	 	]]>
	 </QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>100</QRY:Id>
	<QRY:Source Name="operations.shipment.findUldAtAirport" Type="NATIVE">
		<![CDATA[
		SELECT CMPCOD,ARPCOD,ULDNUM,TARWGT,GRSWGT,NETWGT,POU,ACTWGT,INTFLG
		 FROM OPRARPULD WHERE CMPCOD = ?AND ARPCOD=?AND ULDNUM = ?
	]]>
	</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>101</QRY:Id>
	<QRY:Source Name="operations.shipment.finddnenquirydetails" Type="NATIVE">
		<![CDATA[
		SELECT DISTINCT
		  	DLV.DLVNOTNUM,DLV.DNTISSDAT,DLV.DOCOWRIDR,DLV.MSTDOCNUM,DLV.DLVPCS,DLV.DLVWGT,
		  	DLV.DLVNOTPCS,DLV.DLVNOTWGT,DLV.DLVNOTSTA,DLV.PAYADVEXPDAT,
		  	DLV.PAYADVNUM,DLV.DLVCUSCOD DLVCUSNAM,DLV.DLVSTF,DLV.RMK,MST.SHPPFX,ACC.TOTCCF,ACC.SRVCRGCLS,
		  	MST.DUPNUM,MST.SEQNUM,MST.DOCNUM,DLV.LSTUPDTIM DLVLSTUPDTIM, 
			MST.LSTUPDTIM MSTLSTUPDTIM, ARP.LSTUPDTIM ARPLSTUPDTIM,DLV.ARPCOD,DLV.CMPCOD, DLVULD.ULDNUM,DLVNOTLOC.LOCCOD,
			DLVNOTFLT.FLTCARIDR,DLVNOTFLT.FLTNUM,DLVNOTFLT.FLTSEQNUM,DLV.ADLINFONE,DLV.ADDINFTWO,DLV.ADDINFTHR,LEG.STA FLTDAT,DLV.PAYADVISSDAT,
			(CASE ARL.APHCODUSE WHEN 2
			THEN ARL.TWOAPHCOD
			ELSE ARL.THRAPHCOD
			END) FLTCARCOD,
			 (SELECT MAX(CHDATR.ATRVAL)
			FROM CSHSRVCHDATR CHDATR
			WHERE DLV.PAYADVNUM=CHDATR.PAYADVNUM(+)
			AND DLV.CMPCOD     = CHDATR.CMPCOD(+)
			AND CHDATR.ATRCOD ='ACW'
			) ACTCHGWGT,
			
			(select CASE 
			WHEN (SHPMST.PLTFLG = 'Y' AND ARPSHP.PLTUSEFLG = 'Y' AND SHPDTL.PLTUSEFLG ='Y') 
			THEN 'Y' 
			ELSE 'N'
			END pltflg
			FROM OPRSHPMST SHPMST 
			INNER JOIN OPRARPSHP ARPSHP 
			  ON SHPMST.CMPCOD = ARPSHP.CMPCOD 
			  AND SHPMST.DOCOWRIDR = ARPSHP.DOCOWRIDR 
			  AND SHPMST.MSTDOCNUM = ARPSHP.MSTDOCNUM 
			  AND SHPMST.DUPNUM = ARPSHP.DUPNUM 
			  AND SHPMST.SEQNUM = ARPSHP.SEQNUM
			INNER JOIN OPRSHPDTL SHPDTL
			  ON SHPMST.CMPCOD     = SHPDTL.CMPCOD
			  AND SHPMST.DOCOWRIDR =SHPDTL.DOCOWRIDR
			  AND SHPMST.MSTDOCNUM =SHPDTL.MSTDOCNUM
			  AND SHPMST.DUPNUM    =SHPDTL.DUPNUM
			  AND SHPMST.SEQNUM    =SHPDTL.SEQNUM
			WHERE SHPMST.SEQNUM =1
			AND SHPMST.CMPCOD = MST.CMPCOD
			AND SHPMST.DOCOWRIDR = MST.DOCOWRIDR
			AND SHPMST.MSTDOCNUM = MST.MSTDOCNUM
			AND SHPMST.DUPNUM = MST.DUPNUM
			AND ARPSHP.ARPCOD = DLV.ARPCOD) PLTUSEFLG
		FROM
		 	OPRSHPDLVNOT DLV,OPRSHPMST  MST, OPRARPSHP ARP, OPRSHPMSTACC ACC, OPRSHPDLVNOTULD DLVULD, OPRSHPDLVNOTLOC DLVNOTLOC, 
			OPRSHPDLVNOTFLT DLVNOTFLT,FLTOPRLEG LEG,SHRARLMST ARL
		WHERE
		  	    DLV.CMPCOD=MST.CMPCOD  
		  	AND DLV.DOCOWRIDR=MST.DOCOWRIDR 
		  	AND DLV.MSTDOCNUM=MST.MSTDOCNUM 
		  	AND DLV.DUPNUM=MST.DUPNUM
	  		AND DLV.SEQNUM =MST.SEQNUM	  		
			AND DLV.ARPCOD = ARP.ARPCOD
			AND DLV.CMPCOD = ARP.CMPCOD
            		AND DLV.DOCOWRIDR = ARP.DOCOWRIDR
            		AND DLV.MSTDOCNUM = ARP.MSTDOCNUM
            		AND DLV.DUPNUM = ARP.DUPNUM
            		AND DLV.SEQNUM = ARP.SEQNUM	
            		AND MST.CMPCOD = ACC.CMPCOD(+)
		        AND MST.DOCOWRIDR = ACC.DOCOWRIDR(+)
		  	AND MST.MSTDOCNUM = ACC.MSTDOCNUM(+)
		  	AND MST.DUPNUM = ACC.DUPNUM(+)
		        AND MST.SEQNUM = ACC.SEQNUM(+)  			
			AND DLV.CMPCOD = DLVULD.CMPCOD(+) 
			AND DLV.ARPCOD = DLVULD.ARPCOD(+) 
			AND DLV.DLVNOTNUM = DLVULD.DLVNOTNUM(+) 
			  AND DLV.DOCOWRIDR = DLVNOTLOC.DOCOWRIDR(+)
			  AND DLV.MSTDOCNUM = DLVNOTLOC.MSTDOCNUM(+)
			  AND DLV.DUPNUM    = DLVNOTLOC.DUPNUM(+)
			  AND DLV.SEQNUM    = DLVNOTLOC.SEQNUM(+)
			  AND DLV.CMPCOD    = DLVNOTFLT.CMPCOD(+)
			  AND DLV.DLVNOTNUM = DLVNOTFLT.DLVNOTNUM(+)
			  AND DLV.ARPCOD    = DLVNOTFLT.ARPCOD(+)
			  AND DLVNOTFLT.FLTNUM    = LEG.FLTNUM(+)
			  AND DLVNOTFLT.FLTCARIDR = LEG.FLTCARIDR(+)
			  AND DLVNOTFLT.FLTSEQNUM = LEG.FLTSEQNUM(+)
			  AND DLVNOTFLT.CMPCOD    = LEG.CMPCOD(+)			  
			  AND DLVNOTFLT.CMPCOD =ARL.CMPCOD(+)
			  AND DLVNOTFLT.FLTCARIDR =ARL.ARLIDR(+)			  
		  	AND DLV.CMPCOD = ?
		  	AND DLV.ARPCOD = ?
		]]>
	</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>102</QRY:Id>
	<QRY:Source Name="operations.shipment.findDNPiecesToBeDelivered" Type="NATIVE">
		<![CDATA[SELECT SHP.MSTDOCNUM DOCNUM,SHP.TOTDLVNOTPCS - SHP.TOTDLVPCS DLVNOTPCS,
		SHP.TOTDLVNOTWGT-SHP.TOTDLVWGT DLVNOTWGT FROM OPRARPSHP SHP
		WHERE
		SHP.ARPCOD=?
		AND SHP.CMPCOD=?
		AND SHP.MSTDOCNUM=?
		AND SHP.DOCOWRIDR=?
		AND SHP.SEQNUM=?
		AND SHP.DUPNUM=?
		]]>
	</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>360</QRY:Id>
	<QRY:Source Name="operations.shipment.firstprequeryfindDNDetailsForPayment" Type="NATIVE">
	<![CDATA[
   WITH SHPBDNDTL AS (
   SELECT Q.CMPCOD,
   Q.SHPPFX,
   Q.DOCOWRIDR,
   Q.MSTDOCNUM,
   Q.DOCNUM,
   Q.DUPNUM,
   Q.SEQNUM,
   Q.FLTCARIDR,
   Q.FLTNUM,
   Q.FLTSEQNUM,
   Q.LEGSERNUM,
   Q.ULDNUM,
   Q.RATCUSCOD,
   MIN(Q.STRTIM) OVER(PARTITION BY Q.MSTDOCNUM, Q.DOCOWRIDR, Q.SEQNUM, Q.DUPNUM, Q.CMPCOD) BRKSTRTIM,
   MAX(Q.STRTIM) OVER(PARTITION BY Q.MSTDOCNUM, Q.DOCOWRIDR, Q.SEQNUM, Q.DUPNUM, Q.CMPCOD) BRKENDTIM
   FROM
   (SELECT MST.CMPCOD,
   MST.SHPPFX,
   MST.DOCOWRIDR,
   MST.MSTDOCNUM,
   MST.DOCNUM,
   MST.OWRCOD,
   MST.DUPNUM,
   MST.SEQNUM,
   BDNDTL.FLTCARIDR,
   BDNDTL.FLTNUM,
   BDNDTL.FLTSEQNUM,
   BDNDTL.LEGSERNUM,
   BDNDTL.ULDNUM,
   his.strtim,
   MST.RATCUSCOD
 FROM OPRSHPMST MST,
   OPRSHPBDNDTL BDNDTL,
   OPRSHPDLVNOT DLV,
   OPRULDBDNHIS HIS
WHERE
   MST.CMPCOD = BDNDTL.CMPCOD(+)
   AND MST.MSTDOCNUM = BDNDTL.MSTDOCNUM(+)
   AND MST.DOCOWRIDR = BDNDTL.DOCOWRIDR(+)
   AND MST.SEQNUM = BDNDTL.SEQNUM(+)
   AND MST.DUPNUM = BDNDTL.DUPNUM(+)
   AND BDNDTL.ARPCOD(+) = ?
 AND BDNDTL.CMPCOD = HIS.CMPCOD
   AND BDNDTL.ULDNUM = HIS.ULDNUM
   AND BDNDTL.FLTNUM = HIS.FLTNUM
   AND BDNDTL.FLTSEQNUM = HIS.FLTSEQNUM
   AND BDNDTL.FLTCARIDR = HIS.FLTCARIDR
   AND BDNDTL.LEGSERNUM = HIS.LEGSERNUM
   AND MST.CMPCOD = DLV.CMPCOD(+)
   AND MST.MSTDOCNUM = DLV.MSTDOCNUM(+)
   AND MST.DOCOWRIDR = DLV.DOCOWRIDR(+)
   AND MST.SEQNUM = DLV.SEQNUM(+)
   AND MST.DUPNUM = DLV.DUPNUM(+)
   AND DLV.ARPCOD(+) = ?
	]]>
	</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>361</QRY:Id>
	<QRY:Source Name="operations.shipment.secondprequeryfindDNDetailsForPayment" Type="NATIVE">
	<![CDATA[
   UNION 
   SELECT MST.CMPCOD,
   MST.SHPPFX,
   MST.DOCOWRIDR,
   MST.MSTDOCNUM,
   MST.DOCNUM,
   MST.OWRCOD,
   MST.DUPNUM,
   MST.SEQNUM,
   BDNDTL.FLTCARIDR,
   BDNDTL.FLTNUM,
   BDNDTL.FLTSEQNUM,
   BDNDTL.LEGSERNUM,
   BDNDTL.ULDNUM,
   his.strtim,
   MST.RATCUSCOD
 FROM OPRSHPMST MST,
   OPRSHPBDNDTL BDNDTL,
   OPRSHPDLVNOT DLV,
   OPRULDBDNHIS HIS
WHERE
       MST.CMPCOD = BDNDTL.CMPCOD(+)
   AND MST.MSTDOCNUM = BDNDTL.MSTDOCNUM(+)
   AND MST.DOCOWRIDR = BDNDTL.DOCOWRIDR(+)
   AND 1 = BDNDTL.SEQNUM(+)
   AND MST.DUPNUM = BDNDTL.DUPNUM(+)
   AND BDNDTL.ARPCOD(+) = ?
  AND BDNDTL.ULDNUM = HIS.ULDNUM
   AND BDNDTL.FLTNUM = HIS.FLTNUM
   AND BDNDTL.FLTSEQNUM = HIS.FLTSEQNUM
   AND BDNDTL.FLTCARIDR = HIS.FLTCARIDR
   AND BDNDTL.LEGSERNUM = HIS.LEGSERNUM
   AND MST.CMPCOD = DLV.CMPCOD(+)
   AND MST.MSTDOCNUM = DLV.MSTDOCNUM(+)
   AND MST.DOCOWRIDR = DLV.DOCOWRIDR(+)
   AND MST.SEQNUM = DLV.SEQNUM(+)
   AND MST.DUPNUM = DLV.DUPNUM(+)
   AND DLV.ARPCOD(+) = ?
	]]>
	</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>103</QRY:Id>
	<QRY:Source Name="operations.shipment.findDNDetailsForPayment" Type="NATIVE">
		<![CDATA[
  )Q 
 )

SELECT DISTINCT 
  MST.CMPCOD,
  MST.SHPPFX, 
  MST.DOCOWRIDR, 
  MST.MSTDOCNUM, 
   MST.DOCNUM,
   MST.OWRCOD,
   MST.DUPNUM,
   MST.SEQNUM,
  MST.ORGCOD, 
  MST.DSTCOD, 
   MST.AGTCOD,
   MST.PRDCOD,
  MST.PRDNAM, 
  MST.SCCCOD, 
  MST.PAYTYP, 
  MST.DOMFLG,
  MST.CNSNAM MSTCNSNAM,
  MST.CNSCOD,
  MST.SHPCOD,  
  MST.SHPNAM,
   MST.STDPCS,
   MST.STDWGT,
   MST.GRSVOL,
   MST.CHGCOD,
   MST.SRCIND,
   MST.CONFLG,
   MST.OWRCOD,
   MST.RATCUSCOD,
  MSTAWB.ORGCOD MAWBORGCOD,
  MSTAWB.DSTCOD MAWBDSTCOD,
   ACC.SRVCRGCLS,
  CASE WHEN ACC.TOTCCF>0 THEN ACC.TOTCCF ELSE MAWBACC.TOTCCF END TOTCCF, 
  CASE WHEN ACC.UNQREFONE IS NOT NULL THEN ACC.UNQREFONE ELSE MAWBACC.UNQREFONE END UNQREFONE,
  DTL.CHGCLDFLG, 
   RAT.CMDITMNAM,
   RAT.CHGWGT,
   RAT.GRSWGT,
   ARP.ARPCOD,
  ARP.RCVPCS, 
  ARP.RCVWGT, 
  ARP.TOTDLVPCS, 
  ARP.TOTDLVWGT, 
  ARP.TOTDLVNOTPCS, 
  ARP.TOTDLVNOTWGT, 
   ARP.MFTVOL,
   ARP.AVLVOL,
   ARP.DCSREQFLG,
  DLV.DLVNOTNUM, 
  RAT.SCCCOD RATSCCCODE,
  DLV.DLVNOTSTA, 
  DLV.DLVSTF, 
  DLV.PAYADVNUM, 
  DLV.PAYADVISSDAT, 
  DLV.PAYADVEXPDAT, 
  DLV.DLVPCS, 
  DLV.DLVWGT, 
  DLV.DLVNOTPCS, 
  DLV.DLVNOTWGT, 
  DLV.DLVCUSCOD CNSCOD, 
  DLV.DNTISSDAT, 
  DLV.LSTUPDTIM,
			LOC.WHSCOD WHSCOD,
            LOC.LOCCOD LOCCOD,
            LOC.STUCOD STUCOD,
            LOC.LOCPCS LOCPCS,
            LOC.DLVNOTPCS DLVNOTPCSLOC, 
   SHPBDNDTL.ULDNUM,
  
   (SELECT DECODE(ARL.APHCODUSE,2,ARL.TWOAPHCOD,ARL.THRAPHCOD)
     FROM SHRARLACTMST ARL
     WHERE ARL.CMPCOD = SEGSHP.CMPCOD 
    AND ARL.ARLIDR = SEGSHP.FLTCARIDR
   ) INBFLTCARCOD,
		   (SELECT MAX(MIN(TXNDAT)) DAT
           FROM OPRSHPHIS HIS
  WHERE HIS.CMPCOD = MST.CMPCOD 
  AND HIS.MSTDOCNUM = MST.MSTDOCNUM 
  AND HIS.DOCOWRIDR = MST.DOCOWRIDR 
  AND HIS.DUPNUM = MST.DUPNUM 
  AND HIS.ARPCOD = ARP.ARPCOD 
           AND HIS.TXNCOD    ='NFD'
           GROUP BY HIS.TXNREFTWO ,
           HIS.TXNREFTHR ,
           HIS.TXNREFFOR,
           HIS.TXNREFFIV
         ) NFDTIM ,
                 (SELECT MIN(TXNDAT) DAT
    FROM OPRSHPHIS HIS
    WHERE HIS.CMPCOD  = MST.CMPCOD
    AND HIS.MSTDOCNUM = MST.MSTDOCNUM
    AND HIS.DOCOWRIDR = MST.DOCOWRIDR
    AND HIS.DUPNUM    = MST.DUPNUM
      AND HIS.ARPCOD    = ARP.ARPCOD
    AND HIS.TXNCOD    ='RCF'
  ) BRKSTRTIM ,
  (SELECT MAX(TXNDAT) DAT
    FROM OPRSHPHIS HIS
    WHERE HIS.CMPCOD  = MST.CMPCOD
    AND HIS.MSTDOCNUM = MST.MSTDOCNUM
    AND HIS.DOCOWRIDR = MST.DOCOWRIDR
    AND HIS.DUPNUM    = MST.DUPNUM
    AND HIS.ARPCOD    = ARP.ARPCOD
    AND HIS.TXNCOD    ='RCF')BRKENDTIM,
   
                 (SELECT MIN(STRTIM) 
		 	FROM OPRIMPFLTHIS IMPFLTHIS,
    OPRFLTSEG FLTSEG 
			WHERE IMPFLTHIS.CMPCOD = FLTSEG.CMPCOD
			  AND IMPFLTHIS.FLTCARIDR = FLTSEG.FLTCARIDR
			  AND IMPFLTHIS.FLTNUM = FLTSEG.FLTNUM
			  AND IMPFLTHIS.FLTSEQNUM = FLTSEG.FLTSEQNUM
			  AND IMPFLTHIS.ARPCOD = FLTSEG.POU
			  AND FLTSEG.CMPCOD = SEGSHP.CMPCOD
			  AND FLTSEG.FLTCARIDR = SEGSHP.FLTCARIDR
			  AND FLTSEG.FLTNUM = SEGSHP.FLTNUM
			  AND FLTSEG.FLTSEQNUM = SEGSHP.FLTSEQNUM
			  AND FLTSEG.SEGSERNUM = SEGSHP.SEGSERNUM
  AND FLTSEG.POU = ? 
  AND IMPFLTHIS.TXNCOD ='ARR' 
  ) SHPARRTIM, 
   
   DLV.ADDINFTHR DCLTIM,
   
                          DECODE(MST.SEQNUM,'1',
  (SELECT COUNT(MANUPD) 
  FROM OPRSHPMSTMIS MIS 
                          WHERE MIS.CMPCOD = MST.CMPCOD
                            AND MIS.MSTDOCNUM = MST.MSTDOCNUM
                            AND MIS.DOCOWRIDR = MST.DOCOWRIDR                            
                            AND MIS.DUPNUM = MST.DUPNUM 
                            AND MIS.SEQNUM <> 1
     AND MANUPD ='Y'),
     
  (SELECT COUNT(MANUPD) 
  FROM OPRSHPMSTMIS MIS 
                          WHERE MIS.CMPCOD = MST.CMPCOD
                            AND MIS.MSTDOCNUM = MST.MSTDOCNUM
                            AND MIS.DOCOWRIDR = MST.DOCOWRIDR                            
                            AND MIS.DUPNUM = MST.DUPNUM 
                            AND MIS.SEQNUM =MST.SEQNUM
  AND MANUPD ='Y' 
     )
   ) MANUPDCNT,
  (
  CASE
  WHEN LOC.LOCCOD IS NOT NULL THEN
    (SELECT ZONCOD
    FROM WHSLOCMST LOCMST
  WHERE LOC.CMPCOD = LOCMST.CMPCOD
  AND LOC.ARPCOD = LOCMST.ARPCOD
  AND LOC.WHSCOD = LOCMST.WHSCOD
    AND LOC.LOCCOD   = LOCMST.LOCCOD
    )
  ELSE
    (
    (SELECT RTRIM ( XMLAGG ( XMLELEMENT (LOCMST,LOCMST.ZONCOD
      || ',' ) ) .EXTRACT ( '//text()' ), ',' ) ZONECODE
      FROM WHSOPRSHPLOC SHPLOC
      INNER JOIN WHSLOCMST LOCMST
      ON SHPLOC.CMPCOD    = LOCMST.CMPCOD
      AND SHPLOC.ARPCOD   = LOCMST.ARPCOD
      AND SHPLOC.WHSCOD   = LOCMST.WHSCOD
      AND SHPLOC.LOCCOD   = LOCMST.LOCCOD
      WHERE SHPLOC.CMPCOD = MST.CMPCOD
        AND SHPLOC.MSTDOCNUM = MST.MSTDOCNUM
        AND SHPLOC.DOCOWRIDR = MST.DOCOWRIDR
        AND SHPLOC.SEQNUM = MST.SEQNUM
        AND SHPLOC.DUPNUM = MST.DUPNUM
        AND SHPLOC.ARPCOD = ARP.ARPCOD
    ) )
  END) ZONCOD,
  ADLCNT.CNTTYP,
  ADLCNT.CTTCUSCOD,ADLCNT.CTTCUSNAM,
  MSTMIS.SHPBNDFLG,
  DLVNOTFLT.FLTCARIDR,
  DLVNOTFLT.FLTNUM,
  DLVNOTFLT.FLTSEQNUM,
  DLVNOTFLT.SEGSERNUM,
  (SELECT MIN(TXNDAT) DAT
  FROM OPRSHPHIS HIS
  WHERE HIS.CMPCOD  = MST.CMPCOD
  AND HIS.MSTDOCNUM = MST.MSTDOCNUM
  AND HIS.DOCOWRIDR = MST.DOCOWRIDR
  AND HIS.DUPNUM    = MST.DUPNUM
  AND HIS.ARPCOD    = ARP.ARPCOD
  AND HIS.TXNCOD    ='RCF'
  AND HIS.TXNREFTWO = DLVNOTFLT.FLTCARIDR
  AND HIS.TXNREFTHR = DLVNOTFLT.FLTNUM
  AND HIS.TXNREFFIV = DLVNOTFLT.FLTSEQNUM
  ) FLTBRKSTRTIM,
    MST.STDWGTCOD STDWGTCOD,
	RAT.RATLINSERNUM 
           FROM OPRARPSHP ARP,
                OPRSHPMST MST,
                OPRSHPDLVNOT DLV,
                OPRSHPDTL DTL,
                OPRSHPMSTACC ACC,
				OPRSHPMSTACC MAWBACC,
                OPRSHPRATDTL RAT,
				OPRSEGSHP SEGSHP,
                OPRSHPDLVNOTLOC LOC,
				OPRSHPMST MSTAWB,
				OPRSHPADLCNT ADLCNT,				
				OPRSHPMSTMIS MSTMIS,				
   
   OPRSHPBDNDTL SHPBDNDTL,
    OPRSHPDLVNOTFLT DLVNOTFLT
          WHERE MST.CMPCOD = ARP.CMPCOD(+)
            AND MST.MSTDOCNUM = ARP.MSTDOCNUM(+)
            AND MST.DOCOWRIDR = ARP.DOCOWRIDR(+)
            AND MST.SEQNUM = ARP.SEQNUM(+)
            AND MST.DUPNUM = ARP.DUPNUM(+)
AND ARP.ARPCOD(+) = ? 
AND MST.CMPCOD = DLV.CMPCOD(+) 
AND MST.MSTDOCNUM = DLV.MSTDOCNUM(+) 
AND MST.DOCOWRIDR = DLV.DOCOWRIDR(+) 
AND MST.SEQNUM = DLV.SEQNUM(+) 
AND MST.DUPNUM = DLV.DUPNUM(+) 
            AND MST.CMPCOD = ACC.CMPCOD
            AND MST.MSTDOCNUM = ACC.MSTDOCNUM
            AND MST.DOCOWRIDR = ACC.DOCOWRIDR
            AND MST.SEQNUM = ACC.SEQNUM
            AND MST.DUPNUM = ACC.DUPNUM
            AND MST.CMPCOD = DTL.CMPCOD(+)
            AND MST.MSTDOCNUM = DTL.MSTDOCNUM(+)
            AND MST.DOCOWRIDR = DTL.DOCOWRIDR(+)
            AND MST.SEQNUM = DTL.SEQNUM(+)
            AND MST.DUPNUM = DTL.DUPNUM(+)
            AND MST.CMPCOD = RAT.CMPCOD(+)
            AND MST.MSTDOCNUM = RAT.MSTDOCNUM(+)
            AND MST.DOCOWRIDR = RAT.DOCOWRIDR(+)
            AND MST.SEQNUM = RAT.SEQNUM(+)
            AND MST.DUPNUM = RAT.DUPNUM(+)

AND MST.CMPCOD    = SEGSHP.CMPCOD(+)
AND MST.MSTDOCNUM = SEGSHP.MSTDOCNUM(+)
AND MST.DOCOWRIDR = SEGSHP.DOCOWRIDR(+)
AND MST.SEQNUM    = SEGSHP.SEQNUM(+)
AND MST.DUPNUM    = SEGSHP.DUPNUM(+)

AND SEGSHP.CMPCOD = SHPBDNDTL.CMPCOD(+)
 AND SEGSHP.MSTDOCNUM = SHPBDNDTL.MSTDOCNUM(+)
 AND SEGSHP.DOCOWRIDR = SHPBDNDTL.DOCOWRIDR(+)
 AND SEGSHP.SEQNUM = SHPBDNDTL.SEQNUM(+)
 AND SEGSHP.DUPNUM = SHPBDNDTL.DUPNUM(+)
 AND SEGSHP.FLTNUM = SHPBDNDTL.FLTNUM(+)
 AND SEGSHP.FLTSEQNUM = SHPBDNDTL.FLTSEQNUM(+)
 AND SEGSHP.FLTCARIDR = SHPBDNDTL.FLTCARIDR(+)
 
			AND MSTAWB.CMPCOD    = MST.CMPCOD
			AND MSTAWB.MSTDOCNUM = MST.MSTDOCNUM
			AND MSTAWB.DOCOWRIDR = MST.DOCOWRIDR
			AND MSTAWB.SEQNUM    = 1
			AND MSTAWB.DUPNUM    = MST.DUPNUM
AND MAWBACC.CMPCOD       = ACC.CMPCOD
AND MAWBACC.MSTDOCNUM    = ACC.MSTDOCNUM
AND MAWBACC.DOCOWRIDR    = ACC.DOCOWRIDR
AND MAWBACC.SEQNUM       = 1
AND MAWBACC.DUPNUM       = ACC.DUPNUM
AND DLV.CMPCOD = LOC.CMPCOD(+) 
 AND DLV.DLVNOTNUM = LOC.DLVNOTNUM(+)
 AND DLV.ARPCOD       = LOC.ARPCOD(+)
AND MST.CMPCOD    = ADLCNT.CMPCOD(+)
AND MST.MSTDOCNUM = ADLCNT.MSTDOCNUM(+)
AND MST.DOCOWRIDR = ADLCNT.DOCOWRIDR(+)
AND MST.SEQNUM    = ADLCNT.SEQNUM(+)
AND MST.DUPNUM    = ADLCNT.DUPNUM(+)
AND MSTAWB.CMPCOD       = MSTMIS.CMPCOD(+)
AND MSTAWB.MSTDOCNUM    = MSTMIS.MSTDOCNUM(+)
AND MSTAWB.DOCOWRIDR    = MSTMIS.DOCOWRIDR(+)
AND MSTAWB.SEQNUM       = MSTMIS.SEQNUM(+)
AND MSTAWB.DUPNUM       = MSTMIS.DUPNUM(+)
AND DLV.ARPCOD(+) = ? 
AND DLVNOTFLT.CMPCOD(+)    = DLV.CMPCOD
AND DLVNOTFLT.ARPCOD(+)    = DLV.ARPCOD
AND DLVNOTFLT.DLVNOTNUM(+) = DLV.DLVNOTNUM 

			]]>
	</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>104</QRY:Id>
	<QRY:Source Name="operations.shipment.findCTOAcceptanceEnquiryDetails" Type="NATIVE">
		<![CDATA[
			SELECT
				SHPMST.CMPCOD, SHPMST.SHPPFX, SHPMST.MSTDOCNUM, SHPMST.UBRNUM, SHPMST.STDPCS,
				SHPMST.STDWGT, SHPMST.SCCCOD, SHPMST.SHPDES, SHPMST.ORGCOD,
				SHPMST.DSTCOD, SHPMST.OWRCOD, SHPMST.SHPNAM,SHPMST.SHPCOD,
				SHPDTL.DOCOWRIDR,  SHPDTL.DUPNUM, SHPDTL.SEQNUM,
			        SHPDTL.TOTACPPCS, SHPDTL.TOTACPWGT,SHPDTL.TOTACPVOL,SHPDTL.APRFLG,SHPDTL.ACPUSR, SHPDTL.ACPDAT,
			        SHPDTL.ACPARPCOD, SHPDTL.ACPRMK
			       
			FROM
				OPRSHPMST  SHPMST, OPRSHPDTL SHPDTL
			WHERE
				SHPMST.CMPCOD = SHPDTL.CMPCOD
			AND	SHPMST.DOCOWRIDR =SHPDTL.DOCOWRIDR(+)
			AND	SHPMST.MSTDOCNUM =SHPDTL.MSTDOCNUM(+)
			AND	SHPMST.DUPNUM =SHPDTL.DUPNUM(+)
			AND	SHPMST.SEQNUM =SHPDTL.SEQNUM(+)
			AND	SHPMST.CMPCOD=?

		]]>
	</QRY:Source>
</QRY:Definition>



	<QRY:Definition>
	<QRY:Id>105</QRY:Id>
	<QRY:Source Name="operations.shipment.findshipmentdetailsforuldacceptance" Type="NATIVE">
		<![CDATA[
			SELECT MST.CMPCOD, MST.DOCOWRIDR, MST.SHPPFX, MST.MSTDOCNUM, MST.DUPNUM,
			       MST.SEQNUM, MST.OWRCOD, MST.UBRNUM, MST.ORGCOD,
			       MST.STDPCS, MST.STDWGT, MST.DSTCOD,
			       MST.STDDISWGT, MST.STDWGTCOD, MST.GRSVOL, MST.SCCCOD, MST.SHPDES,
			       DTL.TOTACPPCS, DTL.TOTACPWGT, DTL.TOTACPVOL,DTL.PLTUSEFLG PLTUSEFLG,MST.PLTFLG PLTFLG
			  FROM
			     OPRSHPMST  MST
			  LEFT OUTER JOIN
			     OPRSHPDTL DTL ON
				MST.CMPCOD = DTL.CMPCOD
			    AND MST.MSTDOCNUM = DTL.MSTDOCNUM
			    AND MST.DOCOWRIDR = DTL.DOCOWRIDR
			    AND MST.DUPNUM = DTL.DUPNUM
			    AND MST.SEQNUM = DTL.SEQNUM
			 WHERE MST.CMPCOD = ?
			   AND MST.MSTDOCNUM = ?
			   AND MST.SEQNUM = ?
			   AND MST.DUPNUM = ?
			   AND MST.DOCOWRIDR =?
		]]>
	</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>106</QRY:Id>
	<QRY:Source Name="operations.shipment.findULDAcceptanceEnquiryDetails" Type="NATIVE">
		<![CDATA[
			SELECT MST.CMPCOD,MST.ARPCOD, MST.ULDNUM,MST.SERNUM, MST.GRSWGT, MST.TARWGT, MST.RATTYP, MST.ACPUSR,MST.ACPDAT,
				   SHPMST.UBRNUM, SHPMST.SHPPFX,SHPMST.MSTDOCNUM,SHPMST.STDPCS, SHPMST.STDWGT,SHPMST.SCCCOD,
				   SHPMST.SHPDES, SHPMST.ORGCOD, SHPMST.DSTCOD,SHPMST.OWRCOD, SHPMST.SHPNAM,SHPMST.SHPCOD,SHPMST.SEQNUM,SHPMST.DOCOWRIDR,SHPMST.DUPNUM,
			       ACPDTL.ACPPCS,ACPDTL.ULDWGT, ACPDTL.ULDSERNUM
			        , dense_rank() over (order by  MST.CMPCOD, MST.ULDNUM, MST.SERNUM) AS RANK
					  FROM OPRULDACP MST, OPRSHPMST  SHPMST, OPRULDACPDTL ACPDTL
					  WHERE MST.CMPCOD = ACPDTL.CMPCOD
				   AND MST.ARPCOD = ACPDTL.ARPCOD
				   AND MST.ULDNUM = ACPDTL.ULDNUM
				   AND MST.SERNUM = ACPDTL.ULDSERNUM
				   AND SHPMST.CMPCOD = ACPDTL.CMPCOD(+)
				   AND SHPMST.DOCOWRIDR = ACPDTL.DOCOWRIDR(+)
				   AND SHPMST.MSTDOCNUM = ACPDTL.MSTDOCNUM(+)
				   AND SHPMST.DUPNUM = ACPDTL.DUPNUM(+)
				   AND SHPMST.SEQNUM = ACPDTL.SEQNUM(+)
				   AND MST.CMPCOD = ?

		]]>
	</QRY:Source>
</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>107</QRY:Id>
	<QRY:Source Name="operations.shipment.finddnsforshipments" Type="NATIVE">
		<![CDATA[
			SELECT DLV.DLVNOTNUM,DLV.MSTDOCNUM,DLV.DLVNOTPCS,DLV.DLVNOTWGT,DLV.DLVNOTSTA  FROM OPRSHPDLVNOT DLV
			WHERE DLV.MSTDOCNUM=?
			AND DLV.DOCOWRIDR=?
			AND DLV.SEQNUM=?
			AND DLV.DUPNUM=?
			AND DLV.CMPCOD=?
			AND DLV.ARPCOD=?
		]]>
	</QRY:Source>
</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>108</QRY:Id>
	<QRY:Source Name="operations.shipment.findshipmentdetailsforimportpayment" Type="NATIVE">
		<![CDATA[
			SELECT MST.CMPCOD,
  MST.DOCOWRIDR,
  MST.MSTDOCNUM,
  MST.DOCNUM,
  MST.SHPPFX,
  MST.DUPNUM,
  MST.SEQNUM,
  MST.ORGCOD,
  MST.DSTCOD,
  COALESCE(MST.CURCOD,MSTAWB.CURCOD,(SELECT PARVAL 
  FROM SHRSTNPAR 
  WHERE CMPCOD = MSTAWB.CMPCOD 
  AND STNCOD   = MSTAWB.ORGCOD 
  AND PARCOD  IN ('shared.station.basecurrency' )))CURCOD,
  MST.AGTCOD,
  MST.SHPCOD,
  MST.OWRCOD,
  MST.CNSCOD,
  MST.CNSNAM MSTCNSNAM,
  MST.PRDCOD,
  MST.PRDNAM,
  MST.PAYTYP MSTPAYTYP,
  MST.CHGCOD,
  MST.SHPSTA,
  MST.EXEDAT,
  MST.EXESTN,
  MST.EXEFLG,
  MST.STDPCS,
  MST.STDWGT,
  MST.GRSVOL,
  MST.SCCCOD,
  MST.DOMFLG,
  MST.DTACPTSRC,
  MSTAWB.ORGCOD MAWBORGCOD,
  MSTAWB.DSTCOD MAWBDSTCOD,
  ARP.MFTPCS,
  ARP.MFTWGT,
  ARP.AVLPCS,
  ARP.AVLWGT,
  ARP.MFTVOL,
  ARP.AVLVOL,
  ARP.RCVPCS,
  ARP.RCVWGT,
  ARP.DCSPCS,
  ARP.DCSWGT,
  DTL.TOTACPPCS,
  DTL.TOTACPWGT,
  DTL.TOTDLVPCS,
  (SELECT CHGCLDFLG
    FROM OPRSHPDTL DTL
    WHERE MST.CMPCOD     = DTL.CMPCOD(+)
    AND MST.MSTDOCNUM    = DTL.MSTDOCNUM(+)
    AND MST.DOCOWRIDR    = DTL.DOCOWRIDR(+)
    AND MST.DUPNUM       = DTL.DUPNUM(+)
    AND DTL.CHGCLDFLG    = 'Y'
  ) CHGCLDFLG,
  DTL.CTOCHGCOLFLG,
  CHG.CHGHEDIDR,
  CHG.CHGHED,
  CHG.CHDCOD,
  CHG.CHGAMT,
  CHG.PAYTYP,
  CHG.DUECARFLG,
  CHG.DUEAGTFLG,
  RAT.RATLINSERNUM ,
  RAT.CMDITMNAM,
  RAT.SCCCOD RATSCCCODE,
  RAT.TAX RATTAX,
  RAT.CHGWGT,
  RAT.GRSWGT,
  RAT.IATCHG RATIATACHG,
  RAT.NETCHG,
  ACC.TOTCCF,
  (CASE WHEN MST.PAYTYP='CC' then ACC.WGTCCCHG + ACC.VALCCCHG 
  ELSE ACC.WGTPPCHG + ACC.VALPPCHG 
  END)TOTCHG,
  ACC.VALCCCHG,
  ACC.VALPPCHG,
  ACC.UNQREFONE,
  MIS.SCICOD,
  ARP.DCSREQFLG,
  ARP.CONBDNFLG,
  MST.SHPNAM,
  CUS.CUSCOD,
  CUS.CUSNAM,
  AGT.OWNFLG,
  SEGSHP.FLTCARIDR, 
  SEGSHP.FLTNUM, 
  SEGSHP.FLTSEQNUM, 
				(SELECT DECODE(ARL.APHCODUSE,2,ARL.TWOAPHCOD,ARL.THRAPHCOD)
                 FROM SHRARLACTMST ARL
                 WHERE ARL.CMPCOD = SEGSHP.CMPCOD
  AND ARL.ARLIDR = SEGSHP.FLTCARIDR 
  ) INBFLTCARCOD,
  ADLCNT.CNTTYP,
  ADLCNT.CTTCUSCOD,ADLCNT.CTTCUSNAM ,
   (SELECT MIN(TXNDAT) DAT
    FROM OPRSHPHIS HIS
    WHERE HIS.CMPCOD  = MST.CMPCOD
    AND HIS.MSTDOCNUM = MST.MSTDOCNUM
    AND HIS.DOCOWRIDR = MST.DOCOWRIDR
    AND HIS.DUPNUM    = MST.DUPNUM
	AND HIS.ARPCOD    = MST.DSTCOD
    AND HIS.TXNCOD    ='RCF'
  ) BRKSTRTIM ,
(SELECT MAX(TXNDAT) DAT
    FROM OPRSHPHIS HIS
    WHERE HIS.CMPCOD  = MST.CMPCOD
    AND HIS.MSTDOCNUM = MST.MSTDOCNUM
    AND HIS.DOCOWRIDR = MST.DOCOWRIDR
    AND HIS.DUPNUM    = MST.DUPNUM
	AND HIS.ARPCOD    = MST.DSTCOD
    AND HIS.TXNCOD    ='RCF'
  ) BRKENDTIM,
  (SELECT MIN(STRTIM)
  FROM OPRIMPFLTHIS IMPFLTHIS,
    OPRFLTSEG FLTSEG
  WHERE IMPFLTHIS.CMPCOD  = FLTSEG.CMPCOD
  AND IMPFLTHIS.FLTCARIDR = FLTSEG.FLTCARIDR
  AND IMPFLTHIS.FLTNUM    = FLTSEG.FLTNUM
  AND IMPFLTHIS.FLTSEQNUM = FLTSEG.FLTSEQNUM
  AND IMPFLTHIS.ARPCOD    = FLTSEG.POU
  AND FLTSEG.CMPCOD       = SEGSHP.CMPCOD
  AND FLTSEG.FLTCARIDR    = SEGSHP.FLTCARIDR
  AND FLTSEG.FLTNUM       = SEGSHP.FLTNUM
  AND FLTSEG.FLTSEQNUM    = SEGSHP.FLTSEQNUM
  AND FLTSEG.SEGSERNUM    = SEGSHP.SEGSERNUM
  AND FLTSEG.POU          = MST.DSTCOD
  AND IMPFLTHIS.TXNCOD    ='ARR'
  ) SHPARRTIM,
  (SELECT MAX(MIN(TXNDAT)) DAT
  FROM OPRSHPHIS HIS
  WHERE HIS.CMPCOD  = MST.CMPCOD
  AND HIS.MSTDOCNUM = MST.MSTDOCNUM
  AND HIS.DOCOWRIDR = MST.DOCOWRIDR
  AND HIS.DUPNUM    = MST.DUPNUM
  AND HIS.ARPCOD    = MST.DSTCOD
  AND HIS.TXNCOD    ='NFD'
  GROUP BY HIS.TXNREFTWO ,
    HIS.TXNREFTHR ,
    HIS.TXNREFFOR,
    HIS.TXNREFFIV
  ) NFDTIM ,
  MST.CONFLG,
  ARP.ARPCOD,
  ADLCNT.CTTCUSCOD,ADLCNT.CTTCUSNAM,
    DGR.UNIIDR,
  DGR.RDOACTFLG,
  MST.SRCIND,
   MSTMIS.SHPBNDFLG,
   MST.RATCUSCOD,
   MST.STDWGTCOD STDWGTCOD
FROM OPRSHPMST MST

INNER JOIN OPRSHPMST MSTAWB
ON MSTAWB.CMPCOD    = MST.CMPCOD
AND MSTAWB.MSTDOCNUM = MST.MSTDOCNUM
AND MSTAWB.DOCOWRIDR = MST.DOCOWRIDR
AND MSTAWB.SEQNUM    = 1
AND MSTAWB.DUPNUM    = MST.DUPNUM
INNER JOIN OPRSHPMSTACC ACC
ON MST.CMPCOD       = ACC.CMPCOD
AND MST.MSTDOCNUM = ACC.MSTDOCNUM
AND MST.DOCOWRIDR = ACC.DOCOWRIDR
AND MST.SEQNUM    = ACC.SEQNUM
AND MST.DUPNUM    = ACC.DUPNUM
INNER JOIN OPRSHPMSTMIS MSTMIS
ON MSTAWB.CMPCOD    = MSTMIS.CMPCOD
AND MSTAWB.MSTDOCNUM = MSTMIS.MSTDOCNUM
AND MSTAWB.DOCOWRIDR = MSTMIS.DOCOWRIDR
AND MSTAWB.SEQNUM    = MSTMIS.SEQNUM
AND MSTAWB.DUPNUM    = MSTMIS.DUPNUM
AND MSTAWB.CMPCOD    = MST.CMPCOD
AND MSTAWB.MSTDOCNUM = MST.MSTDOCNUM
AND MSTAWB.DOCOWRIDR = MST.DOCOWRIDR
AND MSTAWB.SEQNUM    = 1
AND MSTAWB.DUPNUM    = MST.DUPNUM
LEFT OUTER JOIN OPRARPSHP ARP
ON MST.CMPCOD     = ARP.CMPCOD
AND MST.MSTDOCNUM    = ARP.MSTDOCNUM
AND MST.DOCOWRIDR    = ARP.DOCOWRIDR
AND MST.SEQNUM       = ARP.SEQNUM
AND MST.DUPNUM       = ARP.DUPNUM
AND MST.DSTCOD    = ARP.ARPCOD
LEFT OUTER JOIN OPRSHPDTL DTL
ON MST.CMPCOD       = DTL.CMPCOD
AND MST.MSTDOCNUM    = DTL.MSTDOCNUM
AND MST.DOCOWRIDR    = DTL.DOCOWRIDR
AND MST.SEQNUM       = DTL.SEQNUM
AND MST.DUPNUM       = DTL.DUPNUM

LEFT OUTER JOIN OPRSHPCHGDTL CHG
ON MST.MSTDOCNUM    = CHG.MSTDOCNUM
AND MST.DOCOWRIDR    = CHG.DOCOWRIDR
AND MST.SEQNUM       = CHG.SEQNUM
AND MST.DUPNUM       = CHG.DUPNUM
AND MST.CMPCOD       = CHG.CMPCOD
LEFT OUTER JOIN OPRSHPRATDTL RAT
ON MST.CMPCOD       = RAT.CMPCOD
AND MST.MSTDOCNUM    = RAT.MSTDOCNUM
AND MST.DOCOWRIDR    = RAT.DOCOWRIDR
AND MST.SEQNUM       = RAT.SEQNUM
AND MST.DUPNUM       = RAT.DUPNUM
LEFT OUTER JOIN OPRSHPMSTMIS MIS
ON MST.CMPCOD       = MIS.CMPCOD
AND MST.MSTDOCNUM    = MIS.MSTDOCNUM
AND MST.DOCOWRIDR    = MIS.DOCOWRIDR
AND MST.SEQNUM       = MIS.SEQNUM
AND MST.DUPNUM       = MIS.DUPNUM
LEFT OUTER JOIN OPRSHPADLCNT ADLCNT
ON MST.CMPCOD       = ADLCNT.CMPCOD
AND MST.MSTDOCNUM    = ADLCNT.MSTDOCNUM
AND MST.DOCOWRIDR    = ADLCNT.DOCOWRIDR
AND MST.SEQNUM       = ADLCNT.SEQNUM
AND MST.DUPNUM       = ADLCNT.DUPNUM
LEFT OUTER JOIN OPRSEGSHP SEGSHP
ON MST.MSTDOCNUM    = SEGSHP.MSTDOCNUM
AND MST.DOCOWRIDR    = SEGSHP.DOCOWRIDR
AND MST.SEQNUM       = SEGSHP.SEQNUM 
AND MST.DUPNUM       = SEGSHP.DUPNUM 
AND MST.CMPCOD       = SEGSHP.CMPCOD 
LEFT OUTER JOIN SHRAGTMST AGT
ON MST.CMPCOD       = AGT.CMPCOD
AND MST.AGTCOD       = AGT.AGTCOD
LEFT OUTER JOIN SHRCUSMST CUS
ON AGT.CMPCOD       = CUS.CMPCOD
AND AGT.CUSCOD       = CUS.CUSCOD
LEFT OUTER JOIN OPRSHPDGR DGR
ON MST.CMPCOD       = DGR.CMPCOD
AND MST.MSTDOCNUM    = DGR.MSTDOCNUM
AND MST.DOCOWRIDR    = DGR.DOCOWRIDR
AND MST.SEQNUM       = DGR.SEQNUM
AND MST.DUPNUM       = DGR.DUPNUM
WHERE 

         

		]]>
	</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>109</QRY:Id>
	<QRY:Source Name="operations.shipment.findsrnpaymentdetails" Type="NATIVE">
		<![CDATA[
		SELECT SHPMST.DOCOWRIDR,
  SHPMST.MSTDOCNUM,
  SHPMST.DUPNUM ,
  SHPMST.SEQNUM,
  SHPMST.CMPCOD,
  SHPMST.SHPPFX,
  SHPMST.SHPNAM,
  SHPMST.STDPCS,
  SHPMST.STDWGT,
  SHPMST.GRSVOL,
  SHPMST.ORGCOD,
  SHPMST.DSTCOD,
  SHPMST.PRDNAM AS PRDCOD,
  SHPMST.SCCCOD,
  SHPMST.SHPDES,
  SHPMST.AGTCOD,
  SHPMST.EXEDAT,
  SHPMST.SHPCOD SHPCOD,
  SHPSRN.SRNNUM,
  SHPSRN.SRNPCS,
  SHPSRN.ARPCOD,
  SHPSRN.ISSDAT,
  SHPSRN.SRNISSUSR,
  SHPSRN.SRNSTA,
  SHPSRN.EXPDAT,
  SHPSRN.RSNCOD,
  SHPSRN.RMK,
  SHPSRN.PAYADVNUM,
  SHPSRN.PAYADVISSDAT,
  ARPSHPMST.DCSREQFLG,
  SHPMST.CONFLG,
  SHPMST.DOMFLG,
  NVL(
		(SELECT MIN(TXNDAT) DAT
           FROM OPRSHPHIS HIS
		  WHERE HIS.CMPCOD = SHPMST.CMPCOD
		  AND HIS.MSTDOCNUM = SHPMST.MSTDOCNUM
		  AND HIS.DOCOWRIDR = SHPMST.DOCOWRIDR
		  AND HIS.DUPNUM = SHPMST.DUPNUM
  AND (HIS.TXNCOD   ='RCS'
  OR HIS.TXNCOD     = 'FOH')
		  ),ARPSHPMST.ACPDAT)ACPDAT,
  ARPSHPMST.ACPPCS TOTACPPCS,
  ARPSHPMST.TOTSRNPCS,
		ARPSHPMST.AVLPCS,
  SHPRATDTL.CMDITMNAM,
  SHPRATDTL.CHGWGT,
  ARPSHPMST.MFTVOL,
  ARPSHPMST.AVLVOL,
  ACC.UNQREFONE,
   MIS.SHPBNDFLG,
   SHPMST.STDWGTCOD STDWGTCOD,
   (SELECT MAX(FLTLEG.STD) 
FROM OPRSEGSHP SEGSHP, 
OPRFLTSEG FLTSEG, 
FLTOPRLEG FLTLEG 
WHERE FLTLEG.CMPCOD = FLTSEG.CMPCOD 
AND FLTLEG.FLTCARIDR = FLTSEG.FLTCARIDR 
AND FLTLEG.FLTNUM = FLTSEG.FLTNUM 
AND FLTLEG.FLTSEQNUM = FLTSEG.FLTSEQNUM 
AND FLTLEG.LEGORG = ARPSHPMST.ARPCOD

AND FLTSEG.CMPCOD = SEGSHP.CMPCOD 
AND FLTSEG.FLTCARIDR = SEGSHP.FLTCARIDR 
AND FLTSEG.FLTNUM = SEGSHP.FLTNUM 
AND FLTSEG.FLTSEQNUM = SEGSHP.FLTSEQNUM 
AND FLTSEG.SEGSERNUM = SEGSHP.SEGSERNUM 

AND SEGSHP.CMPCOD = SHPMST.CMPCOD 
AND SEGSHP.DOCOWRIDR = SHPMST.DOCOWRIDR 
AND SEGSHP.MSTDOCNUM = SHPMST.MSTDOCNUM 
AND SEGSHP.SEQNUM = SHPMST.SEQNUM 
AND SEGSHP.DUPNUM = SHPMST.DUPNUM 
AND SEGSHP.MFTPCS>0
) DEPDAT ,
ACPSHPDTL.ACPIDR,
 ACPSHPDTL.SCCCOD SHPSCC,
  ACPSHPDTL.ACPWGT,
  ACPSHPDTL.ACPPCS,
  ACPSHPDTL.ACPWGTCOD
  
FROM OPRSHPMST SHPMST,
  OPRSHPSRN SHPSRN,
  OPRARPSHP ARPSHPMST,
  OPRSHPMSTACC ACC,
  OPRSHPRATDTL SHPRATDTL,
    OPRSEGSHP SEGSHP,
   OPRSHPMSTMISHIS MIS,
OPRSHPACPDTL  ACPSHPDTL
WHERE SHPMST.CMPCOD =SHPSRN.CMPCOD
AND SHPMST.SEQNUM   =SHPSRN.SEQNUM
AND SHPMST.MSTDOCNUM=SHPSRN.MSTDOCNUM
AND SHPMST.DUPNUM   =SHPSRN.DUPNUM
AND SHPMST.DOCOWRIDR=SHPSRN.DOCOWRIDR
AND SHPMST.CMPCOD   =ARPSHPMST.CMPCOD
AND SHPMST.DOCOWRIDR=ARPSHPMST.DOCOWRIDR
AND SHPMST.MSTDOCNUM=ARPSHPMST.MSTDOCNUM
AND SHPMST.DUPNUM   =ARPSHPMST.DUPNUM
AND SHPMST.SEQNUM   =ARPSHPMST.SEQNUM
AND SHPMST.CMPCOD   =ACC.CMPCOD
AND SHPMST.DOCOWRIDR=ACC.DOCOWRIDR
AND SHPMST.MSTDOCNUM=ACC.MSTDOCNUM
AND SHPMST.DUPNUM   =ACC.DUPNUM
AND SHPMST.SEQNUM   =ACC.SEQNUM
AND SHPMST.CMPCOD   =SHPRATDTL.CMPCOD(+)
AND SHPMST.DOCOWRIDR=SHPRATDTL.DOCOWRIDR(+)
AND SHPMST.MSTDOCNUM=SHPRATDTL.MSTDOCNUM(+)
AND SHPMST.SEQNUM   =SHPRATDTL.SEQNUM(+)
AND SHPMST.DUPNUM   =SHPRATDTL.DUPNUM(+)
AND SHPMST.CMPCOD    = MIS.CMPCOD(+)
AND SHPMST.MSTDOCNUM = MIS.MSTDOCNUM(+)
AND SHPMST.DOCOWRIDR = MIS.DOCOWRIDR(+)
AND SHPMST.SEQNUM    = MIS.SEQNUM(+)
AND SHPMST.DUPNUM    = MIS.DUPNUM(+) 
AND SHPMST.MSTDOCNUM = SEGSHP.MSTDOCNUM (+) 
AND SHPMST.DOCOWRIDR = SEGSHP.DOCOWRIDR (+) 
AND SHPMST.SEQNUM = SEGSHP.SEQNUM (+) 
AND SHPMST.DUPNUM = SEGSHP.DUPNUM (+) 
AND SHPMST.CMPCOD = SEGSHP.CMPCOD (+) 

AND SHPMST.CMPCOD  = ACPSHPDTL.CMPCOD(+)
AND SHPMST.MSTDOCNUM = ACPSHPDTL.MSTDOCNUM(+)
AND SHPMST.DOCOWRIDR = ACPSHPDTL.DOCOWRIDR(+)
AND SHPMST.SEQNUM    = ACPSHPDTL.SEQNUM(+)
AND SHPMST.DUPNUM    = ACPSHPDTL.DUPNUM(+)

AND	SHPSRN.CMPCOD=? 
AND	SHPSRN.SRNNUM=?
AND ARPSHPMST.ARPCOD=?

		]]>
	</QRY:Source>
</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>110</QRY:Id>
	<QRY:Source Name="operations.shipment.cto.findctodeliverydetails" Type="NATIVE">
		<![CDATA[
			SELECT MST.CMPCOD MSTCMPCOD, MST.DOCOWRIDR MSTDOCOWRIDR, MST.SHPPFX MSTSHPPFX,
			       MST.MSTDOCNUM MSTMSTDOCNUM, MST.DUPNUM MSTDUPNUM, MST.SEQNUM MSTSEQNUM,
			       MST.CNSCOD, MST.CNSNAM, MST.STDPCS, MST.STDWGT, MST.SCCCOD, MST.SHPDES,
			       MST.ORGCOD, MST.DSTCOD, MST.DOCNUM, ARPSHP.ARPCOD, ARPSHP.AVLPCS,
			       ARPSHP.DNTUSEFLG, 
				   (CASE
					WHEN ARPSHP.DCSPCS>0
					THEN ARPSHP.DCSPCS
					ELSE ARPSHP.RCVPCS
				   END) RCVPCS,
				  (CASE
					WHEN ARPSHP.DCSWGT>0
					THEN ARPSHP.DCSWGT
					ELSE ARPSHP.RCVWGT
				   END) RCVWGT,
				   ARPSHP.AVLWGT,
			       ARPSHP.TOTDLVNOTPCS, ARPSHP.TOTDLVNOTWGT, ARPSHP.TOTDLVPCS,
			       ARPSHP.TOTDLVWGT, ARPSHP.BOE,ARPSHP.DORDLVFLG, DLVNOT.CMPCOD DLVNOTCMPCOD,
			       DLVNOT.ARPCOD DLVNOTARPCOD, DLVNOT.DLVNOTNUM DLVNOTDLVNOTNUM,
			       DLVNOT.DOCOWRIDR DLVNOTDOCOWRIDR, DLVNOT.MSTDOCNUM DLVNOTMSTDOCNUM,
			       DLVNOT.DUPNUM DLVNOTDUPNUM, DLVNOT.SEQNUM DLVNOTSEQNUM,
			       DLVNOT.DLVNOTPCS DLVNOTDLVNOTPCS, DLVNOT.DLVNOTWGT DLVNOTDLVNOTWGT,
			       DLVNOT.DOCNUM DLVNOTDOCNUM, DLVNOT.DLVNOTSTA DLVNOTDLVNOTSTA,NOTULD.ULDNUM ULDNUM,
			       DLVNOT.DLVPCS DLVNOTDLVPCS, DLVNOT.DLVWGT DLVNOTDLVWGT, DTL.PLTUSEFLG,
			       MST.PLTFLG, SRN.CMPCOD SRNCMPCOD, SRN.SRNNUM SRNSRNNUM,
			       SRN.DOCOWRIDR SRNDOCOWRIDR, SRN.MSTDOCNUM SRNMSTDOCNUM,
			       SRN.DUPNUM SRNDUPNUM, SRN.SEQNUM SRNSEQNUM, SRN.ARPCOD SRNARPCOD,
			       SRN.SRNPCS SRNSRNPCS, SRN.SRNSTA SRNSRNSTA, SRN.RSNCOD SRNRSNCOD,
			       SRN.SRNWGT, SRN.DLVPCS SRNDLVPCS, SRN.DLVWGT SRNDLVWGT, SRN.RMK SRNRMK,
			       SRN.PAYADVNUM, SRN.PAYADVISSDAT, ARPSHP.PLTUSEFLG ARPSHPPLTUSEFLG,
			       ARPSHP.LSTUPDTIM ARPUPDTIM,DLVNOT.LSTUPDTIM DLVUPDTIM,ARPMSTDST.CNTCOD,mst.CONFLG,
				   DTL.LSTUPDTIM DTLUPDTIM,SRN.LSTUPDTIM SRNUPDTIM,MSTACC.TOTCCF ,
				   DTL.CHGCLDFLG,
  COALESCE(MIS.SCICOD,MISMST.SCICOD) SCICOD , NOTULD.ULDNUM DLVNOTULDNUM,
					  (SELECT DECODE((COUNT(NOTLOC.LOCCOD) 
					||'~'),'0~',NULL,(COUNT(NOTLOC.LOCCOD) 
					||'~')) 
					|| LISTAGG(NOTLOC.LOCCOD 
					||'(' 
					||SUM(NOTLOC.LOCPCS) 
					||')', ',') WITHIN GROUP ( 
					ORDER BY NOTLOC.LOCCOD) AS LOCDTL 
					  FROM OPRSHPDLVNOTLOC NOTLOC 
					  WHERE NOTLOC.CMPCOD = DLVNOT.CMPCOD 
					  AND NOTLOC.ARPCOD = DLVNOT.ARPCOD 
					  AND NOTLOC.DLVNOTNUM = DLVNOT.DLVNOTNUM 
					  AND NOTLOC.MSTDOCNUM = DLVNOT.MSTDOCNUM 
					  AND NOTLOC.DOCOWRIDR = DLVNOT.DOCOWRIDR 
					  AND NOTLOC.DUPNUM = DLVNOT.DUPNUM 
					  AND NOTLOC.SEQNUM = DLVNOT.SEQNUM 
					  GROUP BY NOTLOC.LOCCOD 
					)LOCDTL 
			  FROM OPRSHPMST  MST,
			       OPRARPSHP ARPSHP,
			       OPRSHPDLVNOT DLVNOT,
			       OPRSEGSHP SEGSHP,
			       OPRSHPDTL DTL,
			       OPRSHPSRN SRN,
				   OPRSHPMSTACC MSTACC,
           OPRSHPMSTMIS MIS,
		   OPRSHPMSTMIS MISMST,
  SHRARPMST ARPMSTORG,
  SHRCTYMST ORGCTY,
  SHRARPMST ARPMSTDST,
  SHRCTYMST DSTCTY,
  SHRUSEARPPAR ARPPAR,
  CSTARPTXNMAP_VW CSTMAP,
  OPRSHPDLVNOTULD NOTULD
			 WHERE MST.MSTDOCNUM = ARPSHP.MSTDOCNUM
			   AND MST.DOCOWRIDR = ARPSHP.DOCOWRIDR
			   AND MST.DUPNUM = ARPSHP.DUPNUM
			   AND MST.SEQNUM = ARPSHP.SEQNUM
			   AND MST.CMPCOD = ARPSHP.CMPCOD
			   AND MST.MSTDOCNUM = DTL.MSTDOCNUM
			   AND MST.DOCOWRIDR = DTL.DOCOWRIDR
			   AND MST.DUPNUM = DTL.DUPNUM
			   AND MST.SEQNUM = DTL.SEQNUM
			   AND MST.CMPCOD = DTL.CMPCOD
         AND MST.Docowridr         = MIS.Docowridr(+)
AND MST.MSTDOCNUM         = MIS.MSTDOCNUM(+)
AND MST.DUPNUM            = MIS.DUPNUM(+)
AND MST.SEQNUM            = MIS.SEQNUM(+)
AND MST.CMPCOD            = MIS.CMPCOD(+)
 AND MST.CMPCOD    = MISMST.CMPCOD(+)
			   AND MST.MSTDOCNUM = MISMST.MSTDOCNUM(+)
			   AND MST.DOCOWRIDR = MISMST.DOCOWRIDR(+)
			   AND MST.DUPNUM    = MISMST.DUPNUM(+)
			   AND MST.PARSEQNUM = MISMST.SEQNUM(+)
			   AND ARPSHP.MSTDOCNUM = DLVNOT.MSTDOCNUM(+)
			   AND ARPSHP.DOCOWRIDR = DLVNOT.DOCOWRIDR(+)
			   AND ARPSHP.DUPNUM = DLVNOT.DUPNUM(+)
			   AND ARPSHP.SEQNUM = DLVNOT.SEQNUM(+)
			   AND ARPSHP.CMPCOD = DLVNOT.CMPCOD(+)
			   AND ARPSHP.ARPCOD = DLVNOT.ARPCOD(+)
			   AND DLVNOT.DLVNOTNUM = NOTULD.DLVNOTNUM(+)
			   AND DLVNOT.CMPCOD = NOTULD.CMPCOD(+)
			   AND DLVNOT.ARPCOD = NOTULD.ARPCOD(+)
			   AND ARPSHP.MSTDOCNUM = SRN.MSTDOCNUM(+)
			   AND ARPSHP.DOCOWRIDR = SRN.DOCOWRIDR(+)
			   AND ARPSHP.DUPNUM = SRN.DUPNUM(+)
			   AND ARPSHP.SEQNUM = SRN.SEQNUM(+)
			   AND ARPSHP.CMPCOD = SRN.CMPCOD(+)
			   AND ARPSHP.ARPCOD = SRN.ARPCOD(+)
			   AND ARPSHP.MSTDOCNUM = SEGSHP.MSTDOCNUM(+)
			   AND ARPSHP.DOCOWRIDR = SEGSHP.DOCOWRIDR(+)
			   AND ARPSHP.DUPNUM = SEGSHP.DUPNUM(+)
			   AND ARPSHP.SEQNUM = SEGSHP.SEQNUM(+)
			   AND ARPSHP.CMPCOD = SEGSHP.CMPCOD(+)
			   AND MSTACC.CMPCOD = MST.CMPCOD
               AND MSTACC.MSTDOCNUM = MST.MSTDOCNUM
               AND MSTACC.DOCOWRIDR = MST.DOCOWRIDR
               AND MSTACC.DUPNUM = MST.DUPNUM
               AND MSTACC.SEQNUM = MST.SEQNUM
               AND MST.CMPCOD            = ARPMSTORG.CMPCOD(+)
AND MST.ORGCOD            = ARPMSTORG.ARPCOD(+)
AND ARPMSTORG.CMPCOD      = ORGCTY.CMPCOD(+)
AND ARPMSTORG.CTYCOD      = ORGCTY.CTYCOD(+)
AND ARPSHP.CMPCOD         = ARPMSTDST.CMPCOD(+)
AND ARPSHP.ARPCOD         = ARPMSTDST.ARPCOD(+)
AND ARPMSTDST.CMPCOD      = DSTCTY.CMPCOD(+)
AND ARPMSTDST.CTYCOD      = DSTCTY.CTYCOD(+)
AND ARPSHP.CMPCOD         = CSTMAP.CMPCOD(+)
AND ARPSHP.ARPCOD         = CSTMAP.ARPCOD(+)
AND ARPSHP.DOCOWRIDR      = CSTMAP.ARLIDR(+)
AND ARPSHP.CMPCOD         = ARPPAR.CMPCOD(+)
AND ARPSHP.ARPCOD         = ARPPAR.ARPCOD(+)
AND ARPPAR.PARCOD(+)	  = ?
			   AND DLVNOT.DLVNOTSTA(+) = 'P'
			   AND (DLVNOT.PAYADVEXPDAT IS NULL OR DLVNOT.PAYADVEXPDAT + ((NVL(ARPPAR.PARVAL,0))/24/60) > ?)
			   AND ARPSHP.CMPCOD = ?
			   AND ARPSHP.ARPCOD = ?
	   	   ]]>
	</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>111</QRY:Id>
<QRY:Source Name="operations.shipment.cto.findgatepassenquirydetails" Type="NATIVE">
	<![CDATA[
		SELECT DISTINCT DLV.DLVDTLSEQNUM,
  DLV.DLVSTF,
  DLV.DLVPCS,
  DLV.DLVWGT,
  DLV.DLVDAT,
  COALESCE(DLV.CNSNAM,DLV.DLVRTO) CNSNAM,
  DLV.VCLNUM,
  DLV.CNSADD,
  DLV.RMK,
  DLV.ARPCOD,
  DLV.DOCOWRIDR,
  DLV.MSTDOCNUM,
  SHPMST.SHPPFX,
  DLV.SEQNUM,
  DLV.DUPNUM,
  DLV.CMPCOD,
  DLV.LSTUPDTIM,
 DLV.LSTUPDUSR,
   SHPMST.DOCNUM,
  SHPMST.ORGCOD,
  SHPMST.SHPDES,
  SHPMST.SCCCOD,
  SHPMST.STDPCS,
  SHPMST.STDWGT,
  SHPMST.CNSNAM,
  (SELECT RTRIM ( XMLAGG ( XMLELEMENT (NOTULD,NOTULD.ULDNUM
    || ',' ) ) .EXTRACT ( '//text()' ), ',' ) ZONECODE
  FROM OPRSHPDLVNOTULD NOTULD
  INNER JOIN OPRSHPDLVNOT DLVNOTMST
  ON DLVNOTMST.CMPCOD     = NOTULD.CMPCOD
  AND DLVNOTMST.ARPCOD    = NOTULD.ARPCOD
  AND DLVNOTMST.DLVNOTNUM = NOTULD.DLVNOTNUM
  WHERE DLVNOTMST.CMPCOD  = SHPMST.CMPCOD
  AND DLVNOTMST.MSTDOCNUM = SHPMST.MSTDOCNUM
  AND DLVNOTMST.DOCOWRIDR = SHPMST.DOCOWRIDR
  AND DLVNOTMST.SEQNUM    = SHPMST.SEQNUM
  AND DLVNOTMST.DUPNUM    = SHPMST.DUPNUM
  )ULDNUM,
  DLVNOTMST.ADLINFONE,
  DLVNOTFLT.FLTNUM,
  DLVNOTMST.DLVNOTNUM,
  OPRLEG.STA FLTDAT,
  OPRLEG.FLTCARIDR,
  DLVNOTMST.DLVNOTPCS,
  CASE WHEN ALRMST.APHCODUSE=3 THEN ALRMST.THRAPHCOD ELSE ALRMST.TWOAPHCOD END CARCOD,
  DLVNOTMST.DLVNOTWGT
      -- DLV.DLVNOTNUM DLVNOTNUMS
    FROM OPRSHPDLVDTL DLV,
      OPRSHPDLVNOT DLVNOTMST,
      OPRSHPDLVNOTULD NOTULD,
      OPRSHPMST SHPMST,
      OPRSHPDLVNOTFLT DLVNOTFLT,
      OPRFLTSEG FLTSEG,
      SHRARLMST ALRMST,
      FLTOPRLEG OPRLEG,
      (SELECT SUBSTR ( STRING_TO_TOKENIZE , DECODE(LEVEL, 1, 1, INSTR(STRING_TO_TOKENIZE, DELIMITER, 1, LEVEL-1)+1) , INSTR(STRING_TO_TOKENIZE, DELIMITER, 1, LEVEL) - DECODE(LEVEL, 1, 1, INSTR(STRING_TO_TOKENIZE, DELIMITER, 1, LEVEL-1)+1) ) DLVNOTNUM,
        CMPCOD,
        SEQNUM,
        DUPNUM,
        DOCOWRIDR,
        MSTDOCNUM,
		ARPCOD
      FROM
        (SELECT DLVNOTNUM
          ||',' AS STRING_TO_TOKENIZE,
          ','   AS DELIMITER,
          CMPCOD,
          SEQNUM,
          DUPNUM,
          DOCOWRIDR,
          MSTDOCNUM,
		  ARPCOD
		FROM OPRSHPDLVDTL DLV
        WHERE DLV.MSTDOCNUM = ?
        AND DLV.DOCOWRIDR   = ?
		AND DLV.SEQNUM = ?
        AND DLV.DUPNUM      = ?
		AND DLV.CMPCOD = ?
		AND (CASE WHEN  0 = ?
		THEN DLV.DLVDTLSEQNUM
		ELSE   ?
		END = DLV.DLVDTLSEQNUM)
        )
        CONNECT BY INSTR(STRING_TO_TOKENIZE, DELIMITER, 1, LEVEL)>0
      )DLVNOT
    WHERE SHPMST.CMPCOD     = DLV.CMPCOD
    AND SHPMST.DUPNUM       = DLV.DUPNUM
    AND SHPMST.MSTDOCNUM    = DLV.MSTDOCNUM
    AND SHPMST.SEQNUM       = DLV.SEQNUM
    AND SHPMST.DOCOWRIDR    = DLV.DOCOWRIDR
    AND SHPMST.CMPCOD       = DLVNOTMST.CMPCOD(+)
    AND SHPMST.DUPNUM       = DLVNOTMST.DUPNUM(+)
    AND SHPMST.MSTDOCNUM    = DLVNOTMST.MSTDOCNUM(+)
    AND SHPMST.SEQNUM       = DLVNOTMST.SEQNUM(+)
    AND SHPMST.DOCOWRIDR    = DLVNOTMST.DOCOWRIDR(+)
    AND DLVNOTMST.CMPCOD    = NOTULD.CMPCOD(+)
    AND DLVNOTMST.ARPCOD    = NOTULD.ARPCOD(+)
    AND DLVNOTMST.DLVNOTNUM = NOTULD.DLVNOTNUM(+)
    AND DLVNOTMST.CMPCOD    = DLVNOTFLT.CMPCOD(+)
    AND DLVNOTMST.DLVNOTNUM = DLVNOTFLT.DLVNOTNUM(+)
    AND DLVNOTMST.ARPCOD    = DLVNOTFLT.ARPCOD(+)
    AND DLVNOTFLT.CMPCOD    = FLTSEG.CMPCOD(+)
    AND DLVNOTFLT.FLTCARIDR = FLTSEG.FLTCARIDR(+)
    AND DLVNOTFLT.FLTNUM    = FLTSEG.FLTNUM(+)
    AND DLVNOTFLT.FLTSEQNUM = FLTSEG.FLTSEQNUM(+)
    AND DLVNOTFLT.SEGSERNUM = FLTSEG.SEGSERNUM(+)
    AND FLTSEG.CMPCOD       = OPRLEG.CMPCOD(+)
    AND FLTSEG.FLTCARIDR    = OPRLEG.FLTCARIDR(+)
    AND FLTSEG.FLTNUM       = OPRLEG.FLTNUM(+)
    AND FLTSEG.FLTSEQNUM    = OPRLEG.FLTSEQNUM(+)
    AND FLTSEG.POL          = OPRLEG.LEGORG(+)
    AND OPRLEG.CMPCOD       = ALRMST.CMPCOD(+)
    AND OPRLEG.FLTCARIDR    = ALRMST.ARLIDR(+)
    
	]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>112</QRY:Id>
<QRY:Source Name="operations.shipment.findshipmentdetailsforclaims" Type="NATIVE">
	<![CDATA[
	SELECT SHPMST.CMPCOD, SHPMST.DOCOWRIDR, SHPMST.SHPPFX, SHPMST.MSTDOCNUM,
	       SHPMST.DUPNUM, SHPMST.SEQNUM, SHPMST.CNSCOD, SHPMST.CNSNAM,
	       SHPMST.DOCNUM, SHPMST.STDPCS, SHPMST.STDWGT, SHPMST.GRSVOL,
	       SHPMST.SHPNAM, SHPMST.SHPCOD, SHPMST.SCCCOD, SHPMST.SHPDES,SHPMST.CNSADRONE,
	       SHPMST.EXEDAT, SHPMST.SHPADRONE,SHPMST.ORGCOD,SHPMST.DSTCOD, ACC.DVLCAR, ACC.TAXCCF, ACC.TAXPPD, ACC.VALCCCHG,
	       ACC.VALPPCHG, ACC.WGTCCCHG, ACC.WGTPPCHG, SHPRATDTL.CMDITMNAM,
	       SHPRATDTL.CHGWGT, ARPSHP.TOTSRNPCS, SHPDTL.TOTDLVPCS, SHPDTL.ACPDAT,
	       SHPDTL.TOTACPPCS, ARPSHP.RCVPCS,FLT.FLTDAT FLTFLTDAT,
	       FLT.DUPNUM FLTDUPNUM, FLT.SEGSERNUM FLTSEGSERNUM, FLT.FLTNUM FLTFLTNUM,
	       FLT.DOCOWRIDR FLTDOCOWRIDR, FLT.SEQNUM FLTSEQNUM,
	       FLT.FLTCARIDR FLTFLTCARIDR, FLT.RTGSERNUM FLTRTGSERNUM,
	       FLT.RTESEQNUM FLTRTESEQNUM, FLT.FLTSEQNUM FLTFLTSEQNUM,
	       FLT.MSTDOCNUM FLTMSTDOCNUM, FLT.DSTCOD RTGDSTCOD,
	       FLT.FLTCARCOD FLTFLTCARCOD, FLT.CMPCOD FLTCMPCOD, FLT.DSTCOD FLTDSTCOD,
	       SHPRATDTL.RATLINSERNUM,ARPSHP.ARPCOD,SHPCNT.CNSADRTWO,SHPCNT.CNSTELNUM,SHPCNT.CNSMALIDR
	  FROM OPRSHPMST SHPMST,
	       OPRSHPRATDTL SHPRATDTL,
	       OPRSHPDTL SHPDTL,
	       OPRARPSHP ARPSHP,
	       OPRSHPMSTACC ACC,OPRSHPRTG FLT,OPRSHPMSTCNT SHPCNT
	 WHERE SHPMST.CMPCOD = SHPRATDTL.CMPCOD(+)
	   AND SHPMST.CMPCOD = SHPDTL.CMPCOD(+)
	   AND SHPMST.CMPCOD = ARPSHP.CMPCOD(+)
	   AND SHPMST.CMPCOD = ACC.CMPCOD(+)
	   AND SHPMST.SEQNUM = SHPRATDTL.SEQNUM(+)
	   AND SHPMST.SEQNUM = SHPDTL.SEQNUM(+)
	   AND SHPMST.SEQNUM = ARPSHP.SEQNUM(+)
	   AND SHPMST.SEQNUM = ACC.SEQNUM(+)
	   AND SHPMST.DUPNUM = SHPRATDTL.DUPNUM(+)
	   AND SHPMST.DUPNUM = SHPDTL.DUPNUM(+)
	   AND SHPMST.DUPNUM = ARPSHP.DUPNUM(+)
	   AND SHPMST.DUPNUM = ACC.DUPNUM(+)
	   AND SHPMST.DOCOWRIDR = SHPRATDTL.DOCOWRIDR(+)
	   AND SHPMST.DOCOWRIDR = SHPDTL.DOCOWRIDR(+)
	   AND SHPMST.DOCOWRIDR = ARPSHP.DOCOWRIDR(+)
	   AND SHPMST.DOCOWRIDR = ACC.DOCOWRIDR(+)
	   AND SHPMST.MSTDOCNUM = SHPRATDTL.MSTDOCNUM(+)
	   AND SHPMST.MSTDOCNUM = SHPDTL.MSTDOCNUM(+)
	   AND SHPMST.MSTDOCNUM = ARPSHP.MSTDOCNUM(+)
	   AND SHPMST.MSTDOCNUM = ACC.MSTDOCNUM(+)

	   AND SHPMST.CMPCOD = FLT.CMPCOD(+)
	   AND SHPMST.SEQNUM = FLT.SEQNUM(+)
	   AND SHPMST.DUPNUM = FLT.DUPNUM(+)
	   AND SHPMST.DOCOWRIDR = FLT.DOCOWRIDR(+)
   	   AND SHPMST.MSTDOCNUM = FLT.MSTDOCNUM(+)

		   AND SHPMST.CMPCOD = SHPCNT.CMPCOD(+)
		   AND SHPMST.SEQNUM = SHPCNT.SEQNUM(+)
		   AND SHPMST.DUPNUM = SHPCNT.DUPNUM(+)
		   AND SHPMST.DOCOWRIDR = SHPCNT.DOCOWRIDR(+)
		   AND SHPMST.MSTDOCNUM = SHPCNT.MSTDOCNUM(+)

	   AND SHPMST.CMPCOD = ?
	   AND SHPMST.SEQNUM = ?
	   AND SHPMST.DUPNUM = ?
	   AND SHPMST.DOCOWRIDR = ?
           AND SHPMST.MSTDOCNUM = ?
	]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>113</QRY:Id>
<QRY:Source Name="operations.shipment.findshipmentroutes" Type="NATIVE">
	<![CDATA[
	SELECT DSTCOD
	FROM OPRSHPRTG
	WHERE
	CMPCOD=? AND
	SEQNUM=? AND
	DUPNUM=? AND
	DOCOWRIDR=? AND
	MSTDOCNUM=?
	ORDER BY RTESEQNUM
	]]>
</QRY:Source>
</QRY:Definition>


<QRY:Definition>
 <QRY:Id>114</QRY:Id>
 <QRY:Source Name="operations.shipment.validateProcessedDocuments" Type="NATIVE">
	<![CDATA[
			SELECT
					SHPIDX.MSTDOCNUM
			FROM
					OPRSHPIDX SHPIDX,
					SHRSYSPAR PAR1,
					SHRSYSPAR PAR2,
					SHRARLMST ARL
			WHERE
				 		SHPIDX.CMPCOD = ARL.CMPCOD
					AND SHPIDX.DOCOWRIDR = ARL.ARLIDR
					AND	SHPIDX.CMPCOD = PAR1.CMPCOD
					AND PAR1.PARCOD = 'stock.defaults.documentprocessedtime'
					AND SHPIDX.CMPCOD = PAR2.CMPCOD
					AND PAR2.PARCOD = 'operations.shipment.purgedstatus'
					AND SHPIDX.SHPTYP = 'S'
					AND SHPIDX.CMPCOD= ?
					AND SHPIDX.DOCOWRIDR = ?
					AND SHPIDX.PRGSTA = PAR2.PARVAL
					AND SYSDATE - SHPIDX.LSTUPDTIM >  PAR1.PARVAL *365
					AND	  SHPIDX.MSTDOCNUM BETWEEN
						  ? || TO_CHAR( MOD(TO_NUMBER(?),ARL.AWBCHKDGT))
					AND	  ? || TO_CHAR( MOD(TO_NUMBER(?),ARL.AWBCHKDGT))
	]]>
 </QRY:Source>
</QRY:Definition>

<QRY:Definition>
 <QRY:Id>115</QRY:Id>
 <QRY:Source Name="operations.shipment.findShipmentCharges" Type="NATIVE">
	<![CDATA[
		SELECT SUM(RAT.NETCHG) NETCHG,
		  SUM(RAT.IATCHG) IATCHG,
		  SUM(RAT.ALNCHG) ALNCHG,
		  SUM(TAX) TAX,
		  RAT.TAXPCT TAXPCT,
		  RAT.SHPTAXPCT SHPTAXPCT,
		  MST.CURCOD CURCOD,
		  MST.PAYTYP PAYTYP,
		  ACC.VALPPCHG VALPPCHG,
		  ACC.VALCCCHG VALCCCHG,
		  MST.ORGCOD,
		  MST.DSTCOD,
		  MST.AGTCOD,
		  ACC.TAXPPD TAXPPD,
		  ACC.TAXCCF TAXCCF,
		  MST.RFCFLG,
		  ACC.VALTAX,
		  RAT.TAXBSSVAL,
		  ACC.JRNDAT
		FROM OPRSHPMST MST,
			 OPRSHPRATDTL RAT,
			 OPRSHPMSTACC ACC
		WHERE MST.MSTDOCNUM = RAT.MSTDOCNUM(+)
		  AND MST.DOCOWRIDR = RAT.DOCOWRIDR(+)
		  AND MST.SEQNUM = RAT.SEQNUM(+)
		  AND MST.DUPNUM = RAT.DUPNUM(+)
		  AND MST.CMPCOD = RAT.CMPCOD(+)
		  AND MST.MSTDOCNUM = ACC.MSTDOCNUM(+)
		  AND MST.DOCOWRIDR = ACC.DOCOWRIDR(+)
		  AND MST.SEQNUM = ACC.SEQNUM(+)
		  AND MST.DUPNUM = ACC.DUPNUM(+)
		  AND MST.CMPCOD = ACC.CMPCOD(+)
		  AND MST.CMPCOD = ?
		  AND MST.MSTDOCNUM = ?
		  AND MST.DOCOWRIDR = ?
		  AND MST.SEQNUM = ?
		  AND MST.DUPNUM = ?
		GROUP BY TAXPCT,
		  SHPTAXPCT,
		  CURCOD,
		  PAYTYP,
		  VALPPCHG,
		  VALCCCHG,
		  TAXPPD,
		  TAXCCF,
		  RFCFLG,
		  VALTAX,
		  TAXBSSVAL,
		  ORGCOD,
		  DSTCOD,
		  AGTCOD,
		  JRNDAT

	]]>
 </QRY:Source>
</QRY:Definition>


<QRY:Definition>
 <QRY:Id>117</QRY:Id>
 <QRY:Source Name="operations.shipment.findTransferAdviceHistory" Type="NATIVE">
 	<![CDATA[
				SELECT
						CMPCOD,ARPCOD,DOCOWRIDR,MSTDOCNUM,DUPNUM,SEQNUM,
						SERNUM,INBFLTCARIDR,INBFLTCARCOD,INBFLTNUM,INBFLTDAT,
						INBLEGSERNUM,INBFLTSEQNUM,OUTFLTCARIDR,OUTFLTCARCOD,
						OUTFLTNUM,OUTFLTDAT,OUTLEGSERNUM,OUTFLTSEQNUM,POU,
						TRFPCS,CNSPCS,TXNRMK,ADVRCVTIM,ADVSTA
				FROM
						OPRSHPTRFADV
				WHERE
						CMPCOD = ?
				AND	ARPCOD = ?
				AND	DOCOWRIDR = ?
				AND	MSTDOCNUM = ?
				AND	DUPNUM = ?
				AND	SEQNUM = ?
				ORDER BY ADVRCVTIM
 	]]>
 </QRY:Source>
</QRY:Definition>

<QRY:Definition>
 <QRY:Id>118</QRY:Id>
 <QRY:Source Name="operations.shipment.findApplicableTransferAdvices" Type="NATIVE">
 	<![CDATA[
				SELECT
						CMPCOD,ARPCOD,DOCOWRIDR,MSTDOCNUM,DUPNUM,SEQNUM,
						SERNUM,INBFLTCARIDR,INBFLTCARCOD,INBFLTNUM,INBFLTDAT,
						INBLEGSERNUM,INBFLTSEQNUM,OUTFLTCARIDR,OUTFLTCARCOD,
						OUTFLTNUM,OUTFLTDAT,OUTLEGSERNUM,OUTFLTSEQNUM,POU,
						TRFPCS,CNSPCS,TXNRMK,ADVRCVTIM,ADVSTA,
						CASE WHEN INBFLTNUM IS NULL THEN 0 ELSE 64 END +
						CASE WHEN INBFLTCARCOD IS NULL THEN 0 ELSE 32 END +
 						CASE WHEN MSTDOCNUM IS NULL THEN 0 ELSE 16 END  NUM
				FROM
						OPRSHPTRFADV
				WHERE
						CMPCOD = ?
				AND	ARPCOD = ?
 	]]>
 </QRY:Source>
</QRY:Definition>

<QRY:Definition>
 <QRY:Id>119</QRY:Id>
 <QRY:Source Name="operations.shipment.findShipmentsForPreAdvice" Type="NATIVE">
 	<![CDATA[
			SELECT
				COUNT(*) CURCNT
			FROM
				OPRSHPTRFADV
			WHERE
				CMPCOD = ? AND
				ARPCOD = ? AND
				DOCOWRIDR = ? AND
				MSTDOCNUM = ? AND
				SEQNUM = 0 AND
				DUPNUM = 0
 	]]>
 </QRY:Source>
</QRY:Definition>

	<QRY:Definition>
	 <QRY:Id>120</QRY:Id>
	 <QRY:Source Name="operations.shipment.findctofsdetails" Type="NATIVE">
	 	<![CDATA[
		SELECT MST.CMPCOD, MST.ARPCOD, MST.FNDSHPNUM, MST.FLTCARCOD, MST.FLTCARIDR,
			   MST.FLTNUM AS MSTFLTNUM,MST.FLTSEQNUM AS MSTFLTSEQNUM,
			   MST.FLTDAT AS MSTFLTDAT, MST.LSTUPDTIM, MST.TOTDISPCS, MST.TOTDISWGT,
			   MST.TOTRSLPCS, MST.TOTRSLWGT, MST.FNDSHPSTA, MST.DISDAT, MST.TOTDMGPCS,
			   MST.PCKTYP, MST.ADLMRK, MST.RMK AS MSTRMK, MST.CPTDAT, DMG.DMGCOD, DMG.DMGPCS,
			   DTL.FNDSHPSERNUM, DTL.ORGCOD, DTL.DSTCOD, DTL.ULDNUM AS DTLULDNUM,
			   DTL.PCS, DTL.WGT, DTL.SCC, DTL.SHPDES, DTL.PKGDTL, DTL.RMK AS DTLRMK,DTL.ORGCOD,DTL.DSTCOD,
			   DIM.DIMSERNUM, DIM.PCSHGT, DIM.PCSWID, DIM.PCS AS DIMPCS,
			   DIM.WGT AS DIMWGT, DIM.PCSVOL, DIM.PCSLEN,SHPMST.CNSCOD,SHPMST.CNSNAM,SHPMST.SHPNAM,SHPMST.SHPCOD,
			   BLB.CMPCOD, BLB.ARPCOD, BLB.FNDSHPNUM,BLB.SERNUM,BLB.FNDSHPIMG,BLB.LSTUPDUSR,BLB.LSTUPDTIM LSTUPDTIMBLB,BLB.DOCCONTYP,BLB.CLMDOCNAM
			   FROM OPRFNDSHP MST, OPRFNDSHPDMG DMG,OPRFNDSHPDTL DTL,OPRFNDSHPDIM DIM,OPRSHPMST  SHPMST,OPRFNDSHPBLB BLB
			   WHERE MST.CMPCOD = DMG.CMPCOD(+) AND
			   MST.ARPCOD = DMG.ARPCOD(+) AND
			   MST.FNDSHPNUM = DMG.FNDSHPNUM(+) AND
			   MST.CMPCOD = BLB.CMPCOD(+) AND
			   MST.ARPCOD = BLB.ARPCOD(+) AND
			   MST.FNDSHPNUM = BLB.FNDSHPNUM(+) AND
			   MST.CMPCOD = DTL.CMPCOD AND
			   MST.ARPCOD = DTL.ARPCOD AND
			   MST.FNDSHPNUM = DTL.FNDSHPNUM AND
			   DTL.CMPCOD = DIM.CMPCOD(+) AND
			   DTL.ARPCOD = DIM.ARPCOD(+) AND
			   DTL.FNDSHPNUM = DIM.FNDSHPNUM(+) AND
			   DTL.FNDSHPSERNUM = DIM.FNDSHPSERNUM(+) AND
			   SHPMST.CMPCOD = MST.CMPCOD AND
			   SHPMST.MSTDOCNUM = MST.FNDSHPNUM AND
			   SHPMST.DUPNUM = 1 AND
			   SHPMST.SEQNUM = 1 AND
			   SHPMST.DOCOWRIDR = -1 AND
			   MST.CMPCOD = ?
			   AND MST.FNDSHPNUM = ?
	 	]]>
	 </QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	 <QRY:Id>121</QRY:Id>
	 <QRY:Source Name="operations.shipment.findULDTransferAdvice" Type="NATIVE">
	 	<![CDATA[
					SELECT
						CMPCOD,ARPCOD,ULDNUM,INBFLTCARIDR,INBFLTNUM,
						INBFLTSEQNUM,INBLEGSERNUM,INBFLTCARCOD,INBFLTDAT,
						OUTFLTCARCOD,OUTFLTCARIDR,OUTFLTNUM,OUTFLTDAT,
						OUTFLTSEQNUM,OUTLEGSERNUM,POU,TXNRMK,ADVRCVTIM
					FROM
							OPRULDTRFADV
					WHERE
							CMPCOD = ?
					AND	ARPCOD = ?
					AND	ULDNUM = ?
					AND	INBFLTCARIDR = ?
					AND	INBFLTNUM = ?
					AND INBLEGSERNUM = ?
					AND	INBFLTSEQNUM = ?
	 	]]>
	 </QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	 <QRY:Id>122</QRY:Id>
	 <QRY:Source Name="operations.shipment.findfsresolutiondetails" Type="NATIVE">
	 	<![CDATA[
		SELECT MST.ORGCOD,MST.DSTCOD,MST.STDPCS,MST.STDWGT,RES.OWRIDR,MST.SHPPFX,
			   RES.MSTDOCNUM,RES.SEQNUM, RES.DUPNUM, RES.ARLIDR, MST.PARSEQNUM,
			   RES.FLTNUM AS RESFLTNUM,RES.FLTSEQNUM AS RESFLTSEQNUM,
			   RES.SEGSERNUM, RES.ULDNUM AS RESULDNUM, RES.SHPPFX, MST.CONFLG,
			   RES.DOCNUM, RES.FLTDAT AS RESFLTDAT,RES.RESPCS, RES.RESWGT,
			   DECODE(ARL.APHCODUSE,2,ARL.TWOAPHCOD,ARL.THRAPHCOD)AS ARLCOD
			   FROM OPRSHPMST  MST, OPRFNDSHPRES RES,SHRARLMST ARL
			   WHERE MST.CMPCOD = RES.CMPCOD AND
			   MST.MSTDOCNUM = RES.MSTDOCNUM AND
			   MST.DOCOWRIDR = RES.OWRIDR AND
			   MST.DUPNUM = RES.DUPNUM AND
			   MST.SEQNUM = RES.SEQNUM AND
			   ARL.CMPCOD = RES.CMPCOD AND
			   ARL.ARLIDR = RES.ARLIDR AND
			   RES.CMPCOD = ?
			   AND RES.ARPCOD = ?
			   AND RES.FNDSHPNUM = ?

	 	]]>
	 </QRY:Source>
	</QRY:Definition>


	<QRY:Definition>
	 <QRY:Id>123</QRY:Id>
	 <QRY:Source Name="operations.shipment.findUldTransferHistory" Type="NATIVE">
	 	<![CDATA[
					SELECT
						ULDTRFHIS.CMPCOD,ULDTRFHIS.ARPCOD,ULDTRFHIS.ULDNUM,ULDTRFHIS.SERNUM AS ULDSERNUM,
						ULDTRFHIS.INBFLTCARIDR,ULDTRFHIS.INBFLTCARCOD,ULDTRFHIS.OUTFLTCARIDR,
						ULDTRFHIS.OUTFLTCARCOD,ULDTRFHIS.OUTFLTNUM,ULDTRFHIS.OUTFLTDAT,ULDTRFHIS.OUTLEGSERNUM,
						ULDTRFHIS.OUTFLTSEQNUM,ULDTRFHIS.TRFRMK,ULDTRFHIS.CTMREFNUM,ULDTRFHIS.TXNTIM,
						ULDTRFHIS.USRCOD,SHPULDTRFHIS.SHPPFX,SHPULDTRFHIS.DOCOWRIDR,SHPULDTRFHIS.MSTDOCNUM,SHPULDTRFHIS.DUPNUM,
						SHPULDTRFHIS.SEQNUM,SHPULDTRFHIS.AWBPCS AS TRFPCS,SHPULDTRFHIS.AWBWGT AS TRFWGT,
						MST.SCCCOD,MST.SHPDES,MST.ORGCOD,MST.DSTCOD
					FROM
						OPRULDTRFHIS ULDTRFHIS,OPRSHPULDTRFHIS SHPULDTRFHIS,OPRSHPMST  MST
					WHERE
					  ULDTRFHIS.CMPCOD = SHPULDTRFHIS.CMPCOD AND
					  ULDTRFHIS.ARPCOD = SHPULDTRFHIS.ARPCOD AND
					  ULDTRFHIS.ULDNUM = SHPULDTRFHIS.ULDNUM AND
					  ULDTRFHIS.SERNUM = SHPULDTRFHIS.SERNUM AND
					  MST.CMPCOD = SHPULDTRFHIS.CMPCOD AND
					  MST.DOCOWRIDR = SHPULDTRFHIS.DOCOWRIDR AND
					  MST.MSTDOCNUM = SHPULDTRFHIS.MSTDOCNUM AND
					  MST.DUPNUM = SHPULDTRFHIS.DUPNUM AND
					  MST.SEQNUM = SHPULDTRFHIS.SEQNUM AND
					  ULDTRFHIS.CMPCOD = ? AND
					  ULDTRFHIS.ARPCOD = ?
	 	]]>
	 </QRY:Source>
	</QRY:Definition>


	<QRY:Definition>
	 <QRY:Id>124</QRY:Id>
	 <QRY:Source Name="operations.shipment.findShipmentTransferHistory" Type="NATIVE">
	 	<![CDATA[
				SELECT
					TRFHIS.CMPCOD,TRFHIS.ARPCOD,TRFHIS.SHPPFX,TRFHIS.DOCOWRIDR,TRFHIS.MSTDOCNUM,TRFHIS.DUPNUM,
					TRFHIS.SEQNUM,TRFHIS.SERNUM AS SHPSERNUM,TRFHIS.INBFLTCARIDR,TRFHIS.INBFLTCARCOD,
					TRFHIS.OUTFLTCARIDR,TRFHIS.OUTFLTCARCOD,TRFHIS.OUTFLTNUM,TRFHIS.OUTFLTDAT,
					TRFHIS.OUTLEGSERNUM,TRFHIS.OUTFLTSEQNUM,TRFHIS.TRFPCS,TRFHIS.TRFWGT,TRFHIS.TRFRMK,
					TRFHIS.CTMREFNUM,TRFHIS.TXNTIM,TRFHIS.USRCOD,MST.SCCCOD,MST.SHPDES,MST.ORGCOD,MST.DSTCOD
				FROM
					OPRSHPTRFHIS TRFHIS,OPRSHPMST  MST
				WHERE
					MST.CMPCOD = TRFHIS.CMPCOD AND
					MST.DOCOWRIDR = TRFHIS.DOCOWRIDR AND
					MST.MSTDOCNUM = TRFHIS.MSTDOCNUM AND
					MST.DUPNUM = TRFHIS.DUPNUM AND
					MST.SEQNUM = TRFHIS.SEQNUM AND
					TRFHIS.CMPCOD = ? AND
					TRFHIS.ARPCOD = ?
	 	]]>
	 </QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	 <QRY:Id>125</QRY:Id>
	 <QRY:Source Name="operations.shipment.findshipmentsfortransfer" Type="NATIVE">
	 	<![CDATA[

		SELECT FLTSEG.FLTNUM,FLTSEG.FLTSEQNUM,FLTSEG.SEGSERNUM,FLTSEG.FLTCARIDR,
			   SEGSHP.MFTPCS,SEGSHP.MFTVOL,SEGSHP.MFTWGT,
			   ARPSHP.CMPCOD,ARPSHP.MSTDOCNUM,ARPSHP.DOCOWRIDR,ARPSHP.DUPNUM,ARPSHP.SEQNUM,ARPSHP.ARPCOD,
			   ARPSHP.RCVPCS,ARPSHP.RCVVOL,ARPSHP.RCVWGT,
			   SHPMST.STDPCS,SHPMST.STDWGT,SHPMST.SHPDES,SHPMST.ORGCOD,SHPMST.DSTCOD,
			   SHPMST.SCCCOD,SHPMST.SHPPFX,
			   ARPARLSHP.AVLPCS,ARPARLSHP.AVLWGT,ARPARLSHP.OWNCARIDR,ARPARLSHP.OWNCARCOD,
			   ARPSHP.LSTUPDTIM
		FROM   OPRARPSHP ARPSHP,OPRSHPMST  SHPMST,OPRSEGSHP SEGSHP,OPRFLTSEG FLTSEG,
			   OPRARPARLSHP ARPARLSHP,OPRARPIMPFLT ARPIMPFLT
		WHERE
				ARPSHP.CMPCOD=SHPMST.CMPCOD AND
				ARPSHP.SEQNUM=SHPMST.SEQNUM AND
				ARPSHP.DUPNUM=SHPMST.DUPNUM AND
				ARPSHP.DOCOWRIDR=SHPMST.DOCOWRIDR AND
				ARPSHP.MSTDOCNUM=SHPMST.MSTDOCNUM AND
				ARPSHP.CMPCOD=SEGSHP.CMPCOD AND
				ARPSHP.SEQNUM=SEGSHP.SEQNUM AND
				ARPSHP.DUPNUM=SEGSHP.DUPNUM AND
				ARPSHP.DOCOWRIDR=SEGSHP.DOCOWRIDR AND
				ARPSHP.MSTDOCNUM=SEGSHP.MSTDOCNUM AND
				ARPSHP.CMPCOD=ARPARLSHP.CMPCOD AND
				ARPSHP.ARPCOD=ARPARLSHP.ARPCOD AND
				ARPSHP.SEQNUM=ARPARLSHP.SEQNUM AND
				ARPSHP.DUPNUM=ARPARLSHP.DUPNUM AND
				ARPSHP.DOCOWRIDR=ARPARLSHP.DOCOWRIDR AND
				ARPSHP.MSTDOCNUM=ARPARLSHP.MSTDOCNUM AND
				SEGSHP.CMPCOD=FLTSEG.CMPCOD AND
				SEGSHP.FLTNUM=FLTSEG.FLTNUM AND
				SEGSHP.FLTSEQNUM=FLTSEG.FLTSEQNUM AND
				SEGSHP.SEGSERNUM=FLTSEG.SEGSERNUM AND
				SEGSHP.FLTCARIDR=FLTSEG.FLTCARIDR AND
				FLTSEG.CMPCOD=ARPIMPFLT.CMPCOD AND
				FLTSEG.FLTNUM=ARPIMPFLT.FLTNUM AND
				FLTSEG.FLTSEQNUM=ARPIMPFLT.FLTSEQNUM AND
				FLTSEG.FLTCARIDR=ARPIMPFLT.FLTCARIDR AND
				FLTSEG.POU=ARPIMPFLT.ARPCOD AND
				ARPSHP.ARPCOD = FLTSEG.POU AND
				SHPMST.DSTCOD NOT IN (
				SELECT OWNARP.OWNARPCOD FROM SHRUSEARPOWN OWNARP WHERE
					OWNARP.CMPCOD = ARPSHP.CMPCOD AND
					OWNARP.ARPCOD = ARPSHP.ARPCOD
				) AND
				ARPSHP.ARPCOD != SHPMST.DSTCOD AND
				ARPSHP.SEQNUM = 1 AND
				ARPSHP.CMPCOD = ?

	 	]]>
	 </QRY:Source>
	</QRY:Definition>

		<QRY:Definition>
	 <QRY:Id>126</QRY:Id>
	 <QRY:Source Name="operations.shipment.findshipmentsfortransferfornoflight" Type="NATIVE">
	 	<![CDATA[

			SELECT ARPSHP.CMPCOD,ARPSHP.MSTDOCNUM,ARPSHP.DOCOWRIDR,ARPSHP.DUPNUM,ARPSHP.SEQNUM,ARPSHP.ARPCOD,
				   ARPSHP.RCVPCS,ARPSHP.RCVVOL,ARPSHP.RCVWGT,
				   SHPMST.STDPCS,SHPMST.STDWGT,SHPMST.SHPDES,SHPMST.ORGCOD,SHPMST.DSTCOD,
				   SHPMST.SCCCOD,SHPMST.SHPPFX,
				   ARPARLSHP.AVLPCS,ARPARLSHP.AVLWGT,ARPARLSHP.OWNCARIDR,ARPARLSHP.OWNCARCOD,
			   	   ARPSHP.LSTUPDTIM
			FROM OPRARPSHP ARPSHP,OPRSHPMST  SHPMST,OPRARPARLSHP ARPARLSHP
			WHERE
				ARPSHP.CMPCOD=SHPMST.CMPCOD AND
				ARPSHP.SEQNUM=SHPMST.SEQNUM AND
				ARPSHP.DUPNUM=SHPMST.DUPNUM AND
				ARPSHP.DOCOWRIDR=SHPMST.DOCOWRIDR AND
				ARPSHP.MSTDOCNUM=SHPMST.MSTDOCNUM AND
				ARPSHP.CMPCOD=ARPARLSHP.CMPCOD AND
				ARPSHP.ARPCOD=ARPARLSHP.ARPCOD AND
				ARPSHP.SEQNUM=ARPARLSHP.SEQNUM AND
				ARPSHP.DUPNUM=ARPARLSHP.DUPNUM AND
				ARPSHP.DOCOWRIDR=ARPARLSHP.DOCOWRIDR AND
				ARPSHP.MSTDOCNUM=ARPARLSHP.MSTDOCNUM AND
				SHPMST.DSTCOD NOT IN (
				SELECT OWNARP.OWNARPCOD FROM SHRUSEARPOWN OWNARP WHERE
					OWNARP.CMPCOD = ARPSHP.CMPCOD AND
					OWNARP.ARPCOD = ARPSHP.ARPCOD
				) AND
				ARPSHP.ARPCOD != SHPMST.DSTCOD AND
				ARPSHP.CMPCOD = ?

	 	]]>
	 </QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	 <QRY:Id>127</QRY:Id>
	 <QRY:Source Name="operations.shipment.findShipmentDamage" Type="NATIVE">
	 	<![CDATA[
			SELECT
				CMPCOD, DOCOWRIDR, MSTDOCNUM, DUPNUM, SEQNUM, ARPCOD, DMGCOD
			FROM OPRDMGDIS
			WHERE   CMPCOD = ? AND
				ARPCOD = ? AND
				DMGCOD IS NOT NULL
	 	]]>
	 </QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	 <QRY:Id>128</QRY:Id>
	 <QRY:Source Name="operations.shipment.findBlockedSCCForTransfer" Type="NATIVE">
	 	<![CDATA[
			SELECT
				SCCCOD
			FROM SHRSCCMST
			WHERE CMPCOD = ?
	 	]]>
	 </QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	 <QRY:Id>129</QRY:Id>
	 <QRY:Source Name="operations.shipment.findshipmentswithotbooking" Type="NATIVE">
	 	<![CDATA[
		 SELECT MST.DOCOWRIDR,
  MST.MSTDOCNUM      ,
  MST.SHPPFX         ,
  MST.CMPCOD         ,
  MST.DUPNUM         ,
  MST.SEQNUM         ,
  MST.ORGCOD         ,
  MST.DSTCOD         ,
  MST.SCCCOD         ,
  DTL.ACPPCS         ,
  DTL.ACPWGT         ,
  DTL.ACPVOL         ,
  DTL.WHSCOD         ,
  MST.AGTNAM         ,
  MST.CNSNAM         ,
  DTL.SHPRMK         ,
  SHPDTL.ACPDAT      ,
  SHPDTL.ACPUSR
   FROM OPRSHPMST MST ,
  OPRSHPACPDTL DTL    ,
  OPRSHPDTL SHPDTL    ,
  OPRSHPMSTACC MSTACC


	 	]]>
	 </QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	 <QRY:Id>130</QRY:Id>
	 <QRY:Source Name="operations.shipment.findshipmentsforuldtransfer" Type="NATIVE">
	 	<![CDATA[

		  SELECT ULDSHP.DOCOWRIDR,ULDSHP.MSTDOCNUM,ULDSHP.DUPNUM,ULDSHP.SEQNUM,ULDSHP.NUMPCS,ULDSHP.WGT,
			 ULDSHP.ULDNUM,
			 ARPULD.CMPCOD,ARPULD.ARPCOD,ARPULD.ULDNUM,ARPULD.POU,ARPULD.INBFLTCARCOD,ARPULD.INBFLTCARIDR,
			 ARPULD.INBFLTNUM,ARPULD.INBFLTSEQNUM,ARPULD.INBLEGSERNUM,
			 ARPULD.OUTFLTCARCOD,ARPULD.OUTFLTCARIDR,ARPULD.LSTUPDTIM,
			 SHPMST.SHPPFX,SHPMST.STDPCS,SHPMST.STDWGT,SHPMST.SCCCOD,SHPMST.SHPDES,SHPMST.ORGCOD,SHPMST.DSTCOD,
			 ARPSHP.LSTUPDTIM ARPSHPLSTUPDTIM
		  FROM OPRULDSHP ULDSHP,OPRARPULD ARPULD,OPRSHPMST  SHPMST,OPRARPSHP ARPSHP
		  WHERE
			ULDSHP.CMPCOD = ARPULD.CMPCOD AND
			ULDSHP.ULDNUM = ARPULD.ULDNUM AND
			ULDSHP.ARPCOD = ARPULD.ARPCOD AND
			ULDSHP.CMPCOD = SHPMST.CMPCOD AND
			ULDSHP.SEQNUM = SHPMST.SEQNUM AND
			ULDSHP.DUPNUM = SHPMST.DUPNUM AND
			ULDSHP.DOCOWRIDR = SHPMST.DOCOWRIDR AND
			ULDSHP.MSTDOCNUM = SHPMST.MSTDOCNUM
		   AND ULDSHP.CMPCOD = ARPSHP.CMPCOD
		   AND ULDSHP.SEQNUM = ARPSHP.SEQNUM
		   AND ULDSHP.DUPNUM = ARPSHP.DUPNUM
		   AND ULDSHP.DOCOWRIDR = ARPSHP.DOCOWRIDR
		   AND ULDSHP.MSTDOCNUM = ARPSHP.MSTDOCNUM
		   AND ULDSHP.ARPCOD = ARPSHP.ARPCOD
		   AND (ARPULD.POU NOT IN (
			SELECT OWNARP.OWNARPCOD FROM SHRUSEARPOWN OWNARP WHERE
				OWNARP.CMPCOD = ULDSHP.CMPCOD AND
				OWNARP.ARPCOD = ULDSHP.ARPCOD
			) OR ARPULD.POU IS NULL)AND
			(ULDSHP.ARPCOD != ARPULD.POU OR ARPULD.POU IS NULL) AND
 			ULDSHP.CMPCOD = ?

	 	]]>
	 </QRY:Source>
	</QRY:Definition>



	<QRY:Definition>
	 <QRY:Id>131</QRY:Id>
	 <QRY:Source Name="operations.shipment.cto.isnotificationalreadysend" Type="NATIVE">
	 	<![CDATA[
			SELECT MSTDOCNUM
			  FROM OPRSHPNFN NFN
			 WHERE NFN.SEQNUM = ?
			   AND NFN.DUPNUM = ?
			   AND NFN.MSTDOCNUM = ?
			   AND NFN.DOCOWRIDR = ?
			   AND NFN.CMPCOD = ?
	 	]]>
	 </QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	 <QRY:Id>132</QRY:Id>
	 <QRY:Source Name="operations.shipment.cto.findirpdetails" Type="NATIVE">
	 	<![CDATA[
			SELECT ARPSHP.RCVPCS, ARPSHP.RCVWGT, ARPSHP.TOTDLVPCS, ARPSHP.TOTDLVWGT, ARPSHP.ARRTIM,
  MST.MSTDOCNUM, MST.DOCOWRIDR, MST.DUPNUM, MST.SEQNUM, MST.CMPCOD, MST.SHPPFX,
  MST.CNSCOD, MST.CNSNAM, MST.CNSADRONE, MST.SHPCOD, MST.SHPNAM, MST.SHPADRONE,
  MST.STDPCS, MST.STDWGT, MST.ORGCOD, MST.DSTCOD, MST.EXEUSRCOD, MST.EXESTN, MST.EXEDAT,
  ARPSHP.ARPCOD, MST.SHPDES, 
  ( case when  ARPSHP.DCSFLG='Y' then ARPSHP.DCSPCS-ARPSHP.TOTDLVPCS else ARPSHP.RCVPCS-ARPSHP.TOTDLVPCS end) IRPPCS,
  ( case when  ARPSHP.DCSFLG='Y' then  ARPSHP.DCSWGT-ARPSHP.TOTDLVWGT else  ARPSHP.RCVWGT-ARPSHP.TOTDLVWGT end) IRPWGT, 
  ARPSHP.FRPSTA, MST.DOCNUM,
  ARPSHP.ARPCOD, MST.SHPDES,
  CASE WHEN MST.SEQNUM = 1 THEN ARPSHP.RCVPCS-ARPSHP.TOTDLVPCS ELSE ARPSHP.DCSPCS-ARPSHP.TOTDLVPCS END IRPPCS, 
  CASE WHEN MST.SEQNUM = 1 THEN ARPSHP.RCVWGT-ARPSHP.TOTDLVWGT ELSE ARPSHP.DCSWGT-ARPSHP.TOTDLVWGT END IRPWGT,
  ARPSHP.FRPSTA, MST.DOCNUM
   FROM OPRSHPMST MST
  INNER JOIN OPRARPSHP ARPSHP
   ON MST.MSTDOCNUM = ARPSHP.MSTDOCNUM
			   AND MST.DOCOWRIDR = ARPSHP.DOCOWRIDR
			   AND MST.SEQNUM = ARPSHP.SEQNUM
			   AND MST.SEQNUM = ARPSHP.SEQNUM
			   AND MST.CMPCOD = ARPSHP.CMPCOD
  AND MST.DSTCOD = ARPSHP.ARPCOD
  INNER JOIN SHRSYSPAR SYSPAR
  ON SYSPAR.CMPCOD = ARPSHP.CMPCOD
  AND SYSPAR.PARCOD = ?
  LEFT OUTER JOIN SHRUSEARPPAR ARPPAR
  ON ARPPAR.CMPCOD = ARPSHP.CMPCOD
  AND ARPPAR.ARPCOD = ARPSHP.ARPCOD
  AND ARPPAR.PARCOD = ?
  WHERE ARPSHP.CMPCOD = ?
  
	   ]]>
	 </QRY:Source>
	 
	</QRY:Definition>

	<QRY:Definition>
	 <QRY:Id>133</QRY:Id>
	 <QRY:Source Name="operations.shipment.cto.findirpdetailsforawb" Type="NATIVE">
	 	<![CDATA[
	SELECT IRP.IRPSERNUM, IRP.ARPCOD, IRP.CMPCOD, MST.CNSADRONE, MST.CNSNAM,
	       IRP.EXEDAT, IRP.IRPDAT, IRP.IRPPCS, IRP.IRPWGT, IRP.IRPSTA, IRP.EXESTN,
	       IRP.SHPDES, MST.SHPADRONE, MST.SHPNAM, IRP.DUPNUM, IRP.MSTDOCNUM,
	       IRP.DOCOWRIDR, IRP.SEQNUM, MST.DOCNUM
	  FROM OPRSHPIRP IRP,
		   OPRSHPMST MST
	 WHERE 
	   MST.MSTDOCNUM = IRP.MSTDOCNUM
	   AND MST.DOCOWRIDR = IRP.DOCOWRIDR
	   AND MST.DUPNUM = IRP.DUPNUM
	   AND MST.SEQNUM = IRP.SEQNUM
	   AND MST.CMPCOD = IRP.CMPCOD
	   AND IRP.ARPCOD = ?
	   AND IRP.CMPCOD = ?
	   AND IRP.MSTDOCNUM = ?
	   AND IRP.DOCOWRIDR = ?
	   AND IRP.SEQNUM = ?
	   AND IRP.DUPNUM = ?
	   ]]>
	 </QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	 <QRY:Id>134</QRY:Id>
	 <QRY:Source Name="operations.shipment.cto.findfsurcsdetails" Type="NATIVE">
		<![CDATA[
		SELECT MST.DOMFLG,MST.MSTDOCNUM, MST.DOCOWRIDR, MST.DUPNUM, MST.SEQNUM, MST.CMPCOD, MST.SHPPFX, MST.STDPCS, MST.STDWGT,
	       MST.ORGCOD, MST.DSTCOD, MST.AGTCOD, AGTGRP.GRPNAM AGTGRP, MST.SHPCOD,MST.SHPNAM, CUSMST.CUSGRP SHPGRP,
	       ARPSHP.ACPPCS TOTACPPCS, ARPSHP.ACPWGT TOTACPWGT, ARPSHP.ACPVOL TOTACPVOL,
		   CASE MST.GRSVOLUNT
               WHEN 'B'
                       THEN 'MC'
               WHEN 'I'
                       THEN 'CI'
               WHEN 'C'
                       THEN 'CC'
               WHEN 'F'
                       THEN 'CF'
               ELSE MST.GRSVOLUNT
				END GRSVOLUNT,
				ARPSHP.ARPCOD ACPARPCOD, ARPSHP.ACPDAT, DTL.ACPUSR, SYS.PARVAL WGTCOD, MST.OWRCOD, MIS.STACOD, MIS.MSGSEQNUM, MIS.JNVPAR,
				MIS.MSGTYP, MST.RDYCRGFLG,SHPRTG.DSTCOD RTGCNT,  SHRMST.CNTCOD
			FROM OPRSHPMST MST, OPRARPSHP ARPSHP, OPRSHPDTL DTL, SHRSYSPAR SYS, OPRSHPMSTMIS MIS, SHRCUSMST CUSMST,
	       SHRGENMSTGRPDTL AGTGRP, OPRSHPRTG SHPRTG, SHRARPMST SHRMST
	 WHERE MST.MSTDOCNUM = DTL.MSTDOCNUM
	   AND MST.DOCOWRIDR = DTL.DOCOWRIDR
	   AND MST.DUPNUM = DTL.DUPNUM
	   AND MST.SEQNUM = DTL.SEQNUM
	   AND MST.CMPCOD = DTL.CMPCOD
	   AND MST.MSTDOCNUM = ARPSHP.MSTDOCNUM
	   AND MST.DOCOWRIDR = ARPSHP.DOCOWRIDR
	   AND MST.DUPNUM = ARPSHP.DUPNUM
	   AND MST.SEQNUM = ARPSHP.SEQNUM
	   AND MST.CMPCOD = ARPSHP.CMPCOD
	   AND MST.MSTDOCNUM (+)= MIS.MSTDOCNUM
       AND MST.DOCOWRIDR (+)= MIS.DOCOWRIDR
       AND MST.DUPNUM (+)= MIS.DUPNUM
       AND MST.SEQNUM (+)= MIS.SEQNUM
       AND MST.CMPCOD (+)= MIS.CMPCOD
	   AND MST.CMPCOD = SYS.CMPCOD
	   AND MST.CMPCOD = CUSMST.CMPCOD(+)
	   AND MST.SHPCOD = CUSMST.CUSCOD(+)
	   AND MST.CMPCOD = AGTGRP.CMPCOD(+)
	   AND MST.AGTCOD = AGTGRP.GRPENT(+)
       AND AGTGRP.GRPCATCOD(+) = 'GEN'
			AND MST.MSTDOCNUM 		= SHPRTG.MSTDOCNUM(+)
			AND MST.DOCOWRIDR 		= SHPRTG.DOCOWRIDR(+)
			AND MST.DUPNUM 		 	= SHPRTG.DUPNUM(+)
			AND MST.SEQNUM 		 	= SHPRTG.SEQNUM(+)
			AND MST.CMPCOD 		 	= SHPRTG.CMPCOD(+)
			AND MST.CMPCOD      = SHRMST.CMPCOD(+)
			AND MST.ORGCOD      =  SHRMST.ARPCOD(+)
	   AND MST.MSTDOCNUM = ?
	   AND MST.DOCOWRIDR = ?
	   AND MST.DUPNUM = ?
	   AND MST.SEQNUM = ?
	   AND MST.CMPCOD = ?
	   AND SYS.PARCOD = ?
	   AND ARPSHP.ARPCOD = ?
	  ]]>
	</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	 <QRY:Id>135</QRY:Id>
	 <QRY:Source Name="operations.shipment.cto.findfsutfddetails" Type="NATIVE">
		<![CDATA[
	SELECT MST.DOMFLG,MST.MSTDOCNUM, MST.DOCOWRIDR, MST.DUPNUM, MST.SEQNUM, MST.CMPCOD,
	       MST.SHPPFX, MST.STDPCS, MST.STDWGT, MST.ORGCOD, MST.DSTCOD,CTM.CTMREFNUM,
	       CTM.INBCARCOD, DTL.ACTPCS, DTL.ACTWGT, SYS.PARVAL WGTCOD,CTM.CRNDAT,
	       ARL.TWOAPHCOD CARRCOD,MIS.STACOD,MIS.MSGSEQNUM,MIS.MSGTYP,MIS.JNVPAR,CTM.OUTCARCOD,
		   CTM.ACTTRFDAT,DTL.TRFPCS,DTL.TRFWGT,SHPRTG.DSTCOD RTGCNT,
		   MST.AGTCOD,  SHRMST.CNTCOD
	  FROM OPRSHPMST  MST,
	       OPRMFTCTMSHP DTL,
	       OPRMFTCTM CTM,
	       SHRSYSPAR SYS,
	       SHRARLMST ARL,
   		   OPRSHPMSTMIS MIS,
   		   OPRSHPRTG SHPRTG,
		   SHRARPMST SHRMST
	 WHERE MST.MSTDOCNUM = DTL.MSTDOCNUM
	   AND MST.DOCOWRIDR = DTL.DOCOWRIDR
	   AND MST.DUPNUM = DTL.DUPNUM
	   AND MST.SEQNUM = DTL.SEQNUM
	   AND MST.CMPCOD = DTL.CMPCOD
	   AND MST.MSTDOCNUM (+)= MIS.MSTDOCNUM
       AND MST.DOCOWRIDR (+)= MIS.DOCOWRIDR
       AND MST.DUPNUM (+)= MIS.DUPNUM
       AND MST.SEQNUM (+)= MIS.SEQNUM
       AND MST.CMPCOD (+)= MIS.CMPCOD
       AND MST.MSTDOCNUM 		= SHPRTG.MSTDOCNUM(+)
	   AND MST.DOCOWRIDR 		= SHPRTG.DOCOWRIDR(+)
       AND MST.DUPNUM 		 	= SHPRTG.DUPNUM(+)
       AND MST.SEQNUM 		 	= SHPRTG.SEQNUM(+)
       AND MST.CMPCOD 		 	= SHPRTG.CMPCOD(+)
	   AND MST.CMPCOD = SYS.CMPCOD
	   AND MST.CMPCOD = ARL.CMPCOD
	   AND MST.DOCOWRIDR = ARL.ARLIDR
	   AND MST.CMPCOD = CTM.CMPCOD
	   AND CTM.CTMREFNUM = DTL.CTMREFNUM
	   AND CTM.CTMSERNUM = DTL.CTMSERNUM
	   AND CTM.CMPCOD = DTL.CMPCOD
	    AND MST.CMPCOD      = SHRMST.CMPCOD(+)
		AND MST.ORGCOD      =  SHRMST.ARPCOD(+)
	   AND MST.MSTDOCNUM = ?
	   AND MST.DOCOWRIDR = ?
	   AND MST.DUPNUM = ?
	   AND MST.SEQNUM = ?
	   AND MST.CMPCOD = ?
	   AND SYS.PARCOD = ?
	   order by  CTM.CTMREFNUM DESC
   	]]>
	</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	 <QRY:Id>136</QRY:Id>
	 <QRY:Source Name="operations.shipment.cto.findfsunfddetails" Type="NATIVE">
	<![CDATA[
		SELECT MST.MSTDOCNUM, MST.DOCOWRIDR, MST.DUPNUM, MST.SEQNUM, MST.CMPCOD, MST.SHPPFX, MST.SCCCOD, MST.STDPCS, MST.STDWGT,
		       MST.ORGCOD, MST.DSTCOD, MST.OWRCOD, MST.AGTCOD, AGTGRP.GRPNAM AGTGRP, MST.CNSCOD, CUSMST.CUSGRP CNSGRP,
		       ARPSHP.ARPCOD, SYSDATE NFNDAT, ARPSHP.RCVPCS NFNPCS, ARPSHP.RCVWGT,MST.DOMFLG,
		       MST.CNSNAM NFYNAM, SYS.PARVAL WGTCOD, ARL.TWOAPHCOD CARRCOD, MIS.STACOD, MIS.MSGSEQNUM, MIS.MSGTYP,MIS.JNVPAR, SHPRTG.DSTCOD RTGCNT,SHRMST.CNTCOD
		  FROM OPRSHPMST MST,
		       OPRARPSHP ARPSHP,
		       SHRSYSPAR SYS,
		       SHRARLMST ARL,
		       OPRSHPMSTMIS MIS,
		       SHRCUSMST CUSMST,
		       SHRGENMSTGRPDTL AGTGRP,
		       OPRSHPRTG SHPRTG,
			   SHRARPMST SHRMST
				 WHERE MST.MSTDOCNUM = ARPSHP.MSTDOCNUM
				   AND MST.DOCOWRIDR = ARPSHP.DOCOWRIDR
				   AND MST.DUPNUM = ARPSHP.DUPNUM
				   AND MST.SEQNUM = ARPSHP.SEQNUM
				   AND MST.CMPCOD = ARPSHP.CMPCOD
				   AND MST.DSTCOD = ARPSHP.ARPCOD
	   AND MST.MSTDOCNUM (+)= MIS.MSTDOCNUM
       AND MST.DOCOWRIDR (+)= MIS.DOCOWRIDR
       AND MST.DUPNUM (+)= MIS.DUPNUM
       AND MST.SEQNUM (+)= MIS.SEQNUM
       AND MST.CMPCOD (+)= MIS.CMPCOD
	   AND MST.CMPCOD = SYS.CMPCOD
				   AND MST.CMPCOD = ARL.CMPCOD
				   AND MST.DOCOWRIDR = ARL.ARLIDR
		   AND MST.CMPCOD = CUSMST.CMPCOD(+)
		   AND MST.SHPCOD = CUSMST.CUSCOD(+)
		   AND MST.CMPCOD = AGTGRP.CMPCOD(+)
		   AND MST.AGTCOD = AGTGRP.GRPENT(+)
           AND AGTGRP.GRPCATCOD(+) = 'GEN'
		    AND MST.MSTDOCNUM 		= SHPRTG.MSTDOCNUM(+)
			AND MST.DOCOWRIDR 		= SHPRTG.DOCOWRIDR(+)
			AND MST.DUPNUM 		 	= SHPRTG.DUPNUM(+)
			AND MST.SEQNUM 		 	= SHPRTG.SEQNUM(+)
			AND MST.CMPCOD 		 	= SHPRTG.CMPCOD(+)
			  AND MST.CMPCOD      = SHRMST.CMPCOD(+)
				AND MST.ORGCOD      =  SHRMST.ARPCOD(+)
	   AND MST.MSTDOCNUM = ?
	   AND MST.DOCOWRIDR = ?
	   AND MST.DUPNUM = ?
	   AND MST.SEQNUM = ?
	   AND MST.CMPCOD = ?
			AND ARPSHP.ARPCOD = ?
	   AND SYS.PARCOD = ?
	 ]]>
	</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	 <QRY:Id>137</QRY:Id>
	 <QRY:Source Name="operations.shipment.cto.findfsudlvdetails" Type="NATIVE">
	<![CDATA[
	SELECT MST.DOMFLG,MST.MSTDOCNUM, MST.DOCOWRIDR, MST.DUPNUM, MST.SEQNUM, MST.CMPCOD,
		       MST.SHPPFX, MST.STDPCS, MST.STDWGT, MST.ORGCOD, MST.DSTCOD,
		       DLV.CNSNAM, DLV.DLVPCS, DLV.DLVWGT, DLV.DLVDAT,
		       ARP.ARPCOD, SHPDTL.TOTDLVPCS, SHPDTL.TOTDLVWGT,
		       SYS.PARVAL WGTCOD, ARL.TWOAPHCOD CARRCOD,
		       MIS.STACOD,MIS.MSGSEQNUM,MIS.MSGTYP,MIS.JNVPAR,SHPRTG.DSTCOD RTGCNT,
		       MST.AGTCOD,  SHRMST.CNTCOD
		  FROM OPRSHPMST  MST, OPRSHPDTL SHPDTL ,OPRARPSHP ARP, 
			   OPRSHPDLVDTL DLV ,SHRSYSPAR SYS,SHRARLMST ARL,
		       OPRSHPMSTMIS MIS,OPRSHPRTG SHPRTG,SHRARPMST SHRMST
		 WHERE MST.MSTDOCNUM = ARP.MSTDOCNUM
   			AND MST.DOCOWRIDR = ARP.DOCOWRIDR
   			AND MST.DUPNUM = ARP.DUPNUM
   			AND MST.SEQNUM = ARP.SEQNUM
   			AND MST.CMPCOD = ARP.CMPCOD  
  		 	AND MST.MSTDOCNUM = SHPDTL.MSTDOCNUM
  			AND MST.DOCOWRIDR = SHPDTL.DOCOWRIDR
   			AND MST.DUPNUM = SHPDTL.DUPNUM
   			AND MST.SEQNUM = SHPDTL.SEQNUM
   			AND MST.CMPCOD = SHPDTL.CMPCOD
   			AND MST.CMPCOD = SYS.CMPCOD
   			AND MST.CMPCOD = ARL.CMPCOD
   			AND MST.DOCOWRIDR = ARL.ARLIDR
   			AND ARP.CMPCOD = DLV.CMPCOD
   			AND ARP.ARPCOD = DLV.ARPCOD
   			AND ARP.DOCOWRIDR = DLV.DOCOWRIDR
   			AND ARP.MSTDOCNUM = DLV.MSTDOCNUM 
   			AND ARP.SEQNUM = DLV.SEQNUM
   			AND ARP.DUPNUM = DLV.DUPNUM
   			AND MST.MSTDOCNUM = MIS.MSTDOCNUM(+)
   			AND MST.DOCOWRIDR = MIS.DOCOWRIDR(+)
   			AND MST.DUPNUM = MIS.DUPNUM(+)
   			AND MST.SEQNUM = MIS.SEQNUM(+)
   			AND MST.CMPCOD = MIS.CMPCOD(+)
   			AND MST.MSTDOCNUM 		= SHPRTG.MSTDOCNUM(+)
			AND MST.DOCOWRIDR 		= SHPRTG.DOCOWRIDR(+)
			AND MST.DUPNUM 		 	= SHPRTG.DUPNUM(+)
			AND MST.SEQNUM 		 	= SHPRTG.SEQNUM(+)
			AND MST.CMPCOD 		 	= SHPRTG.CMPCOD(+)
			 AND MST.CMPCOD      = SHRMST.CMPCOD(+)
			AND MST.ORGCOD      =  SHRMST.ARPCOD(+)
			AND MST.MSTDOCNUM = ?
			AND MST.DOCOWRIDR = ?
			AND MST.DUPNUM = ?
			AND MST.SEQNUM = ?
			AND MST.CMPCOD = ?
			AND ARP.ARPCOD=?
			AND SYS.PARCOD = ?
	 
	 ]]>
	</QRY:Source>
	</QRY:Definition>


	<QRY:Definition>
	 <QRY:Id>138</QRY:Id>
	 <QRY:Source Name="operations.shipment.cto.findfsurcfdetails" Type="NATIVE">
	<![CDATA[
		SELECT MST.DOMFLG,MST.MSTDOCNUM, MST.DOCOWRIDR, MST.DUPNUM, MST.SEQNUM, MST.CMPCOD, MST.SHPPFX, MST.STDPCS, MST.STDWGT,
		       MST.ORGCOD, MST.DSTCOD, MST.OWRCOD, MST.AGTCOD, AGTGRP.GRPNAM AGTGRP, MST.CNSCOD, CUSMST.CUSGRP CNSGRP,
		       IMPFLT.FLTNUM, IMPFLT.FLTDAT, IMPFLT.FLTCARCOD, ARP.ARPCOD, ARP.RCVPCS, ARP.RCVWGT, SYS.PARVAL WGTCOD,
		       ARL.TWOAPHCOD CARRCOD, LEG.STA, LEG.ATA,LEG.ETA, LEG.STD, LEG.ATD,LEG.FLTCARIDR,LEG.FLTSEQNUM, MIS.STACOD, MIS.MSGSEQNUM, MIS.MSGTYP, MIS.SCICOD, MIS.JNVPAR, SHPRTG.DSTCOD RTGCNT, MST.SCCCOD, FLTMST.FLTROU,SHRMST.CNTCOD
	    FROM OPRSHPMST  MST,
		 OPRARPSHP ARP,
		 OPRARPIMPFLT IMPFLT,
		 FLTOPRLEG LEG,
		 SHRSYSPAR SYS,
		 SHRARLMST ARL,
		       OPRSHPMSTMIS MIS,
		       SHRCUSMST CUSMST,
		       SHRGENMSTGRPDTL AGTGRP,
		         OPRSHPRTG SHPRTG,
				 FLTOPRMST FLTMST,
				 SHRARPMST SHRMST
	   WHERE MST.MSTDOCNUM = ARP.MSTDOCNUM
	     AND MST.DOCOWRIDR = ARP.DOCOWRIDR
	     AND MST.DUPNUM = ARP.DUPNUM
	     AND MST.SEQNUM = ARP.SEQNUM
	     AND MST.CMPCOD = ARP.CMPCOD
		 AND MST.MSTDOCNUM (+)= MIS.MSTDOCNUM
         AND MST.DOCOWRIDR (+)= MIS.DOCOWRIDR
         AND MST.DUPNUM (+)= MIS.DUPNUM
         AND MST.SEQNUM (+)= MIS.SEQNUM
         AND MST.CMPCOD (+)= MIS.CMPCOD
	     AND MST.CMPCOD = SYS.CMPCOD
	     AND MST.CMPCOD = ARL.CMPCOD
	     AND MST.DOCOWRIDR = ARL.ARLIDR
	     AND IMPFLT.CMPCOD = LEG.CMPCOD
	     AND IMPFLT.ARPCOD = ARP.ARPCOD
	     AND IMPFLT.FLTCARIDR = LEG.FLTCARIDR
	     AND IMPFLT.FLTNUM = LEG.FLTNUM
	     AND IMPFLT.FLTSEQNUM = LEG.FLTSEQNUM
	     AND IMPFLT.LEGSERNUM = LEG.LEGSERNUM
	     AND IMPFLT.ARPCOD = LEG.LEGDST
		 AND FLTMST.FLTNUM       = IMPFLT.FLTNUM
		 AND FLTMST.FLTCARIDR    = IMPFLT.FLTCARIDR
		 AND FLTMST.FLTSEQNUM    = IMPFLT.FLTSEQNUM
		 AND FLTMST.CMPCOD       = IMPFLT.CMPCOD
		   AND MST.CMPCOD = CUSMST.CMPCOD(+)
		   AND MST.SHPCOD = CUSMST.CUSCOD(+)
		   AND MST.CMPCOD = AGTGRP.CMPCOD(+)
		   AND MST.AGTCOD = AGTGRP.GRPENT(+)
           AND AGTGRP.GRPCATCOD(+) = 'GEN'
		   AND MST.MSTDOCNUM 		= SHPRTG.MSTDOCNUM(+)
			AND MST.DOCOWRIDR 		= SHPRTG.DOCOWRIDR(+)
			AND MST.DUPNUM 		 	= SHPRTG.DUPNUM(+)
			AND MST.SEQNUM 		 	= SHPRTG.SEQNUM(+)
			AND MST.CMPCOD 		 	= SHPRTG.CMPCOD(+)
			 AND MST.CMPCOD      = SHRMST.CMPCOD(+)
			AND MST.ORGCOD      =  SHRMST.ARPCOD(+)
	     AND MST.MSTDOCNUM = ?
	     AND MST.DOCOWRIDR = ?
	     AND MST.DUPNUM = ?
	     AND MST.SEQNUM = ?
	     AND MST.CMPCOD = ?
	     AND ARP.ARPCOD = ?
	     AND SYS.PARCOD = ?


	]]>
	</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	 <QRY:Id>139</QRY:Id>
	 <QRY:Source Name="operations.shipment.cto.findfsudisofldetails" Type="NATIVE">
	<![CDATA[
SELECT MST.MSTDOCNUM,
  MST.DOCOWRIDR,
  MST.DUPNUM,
  MST.SEQNUM,
  MST.CMPCOD,
  MST.SHPPFX,
			 CASE
					 WHEN ARL.APHCODUSE = 3
							 THEN ARL.THRAPHCOD
					 ELSE ARL.TWOAPHCOD
  END CARRCOD,
  MST.OWRCOD,
  MST.STDPCS,
  MST.STDWGT,
  MST.ORGCOD,
  MST.DSTCOD,
  MST.AGTCOD,
  AGTGRP.GRPNAM AGTGRP,
  MST.SHPCOD,
  CUSMST.CUSGRP SHPGRP,
  OFL.OFLPCS,
  OFL.OFLWGT,
  OFL.OFLDAT,
  OFL.FLTCARIDR,
  OFL.FLTNUM,
  OFL.OFLRSN,
  OFL.RMK,  
  ONETIM.FLDDES,
  SYS.PARVAL WGTCOD,
  MIS.STACOD,
  MIS.MSGSEQNUM,
  MIS.MSGTYP,
  FLTMST.FLTROU,
   LEG.FLTSEQNUM,
  LEG.FLTCARIDR FLIGHTCARIDR,
  LEG.fltnum LDGFLTNUM,
  LEG.STD,
  COALESCE(EXPFT.FINFLG,'N') FINFLG,
  MST.SCCCOD,
  MIS.SCICOD,
    SHRMST.CNTCOD
		FROM OPRSHPMST MST,
			 OPROFLDTL OFL,
			 SHRSYSPAR SYS,
			 SHRARLMST ARL,
			 OPRSHPMSTMIS MIS,
			 SHRCUSMST CUSMST,
			 FLTOPRMST FLTMST,
  SHRGENMSTGRPDTL AGTGRP,
  OPRARPEXPFLT EXPFT,
  SHRONETIM ONETIM ,
  FLTOPRLEG LEG ,
  SHRARPMST SHRMST
		 WHERE MST.MSTDOCNUM = OFL.MSTDOCNUM
		   AND MST.DOCOWRIDR = OFL.DOCOWRIDR
		   AND MST.DUPNUM = OFL.DUPNUM
		   AND MST.SEQNUM = OFL.SEQNUM
		   AND MST.CMPCOD = OFL.CMPCOD
		   AND MST.MSTDOCNUM (+)= MIS.MSTDOCNUM
           AND MST.DOCOWRIDR (+)= MIS.DOCOWRIDR
           AND MST.DUPNUM (+)= MIS.DUPNUM
           AND MST.SEQNUM (+)= MIS.SEQNUM
           AND MST.CMPCOD (+)= MIS.CMPCOD
		   AND MST.CMPCOD = SYS.CMPCOD
		 AND MST.CMPCOD = CUSMST.CMPCOD(+)
		 AND MST.SHPCOD = CUSMST.CUSCOD(+)
		 AND MST.CMPCOD = AGTGRP.CMPCOD(+)
		 AND MST.AGTCOD = AGTGRP.GRPENT(+)
		 AND AGTGRP.GRPCATCOD(+) = 'GEN'
		 AND OFL.CMPCOD = ARL.CMPCOD
		   AND OFL.FLTCARIDR = ARL.ARLIDR
AND EXPFT.CMPCOD     = OFL.CMPCOD
AND EXPFT.FLTCARIDR  = OFL.FLTCARIDR
AND EXPFT.FLTNUM     = OFL.FLTNUM
AND EXPFT.FLTSEQNUM  = OFL.FLTSEQNUM
		AND FLTMST.CMPCOD     = OFL.CMPCOD
		AND FLTMST.FLTCARIDR  = OFL.FLTCARIDR
		AND FLTMST.FLTNUM     = OFL.FLTNUM
		AND FLTMST.FLTSEQNUM  = OFL.FLTSEQNUM
		AND OFL.CMPCOD = ONETIM.CMPCOD
		AND OFL.OFLRSN = ONETIM.FLDVAL
		AND EXPFT.CMPCOD = LEG.CMPCOD
      AND EXPFT.FLTCARIDR = LEG.FLTCARIDR
	     AND EXPFT.FLTNUM = LEG.FLTNUM
	     AND EXPFT.FLTSEQNUM = LEG.FLTSEQNUM
	     AND EXPFT.LEGSERNUM = LEG.LEGSERNUM
		   AND MST.CMPCOD      = SHRMST.CMPCOD(+)
           AND MST.ORGCOD      =  SHRMST.ARPCOD(+)
		   AND MST.MSTDOCNUM = ?
		   AND MST.DOCOWRIDR = ?
		   AND MST.DUPNUM = ?
		   AND MST.SEQNUM = ?
		   AND MST.CMPCOD = ?
AND EXPFT.ARPCOD     =?  
		   AND SYS.PARCOD = ?
		   AND ONETIM.FLDTYP = ?

	]]>
	</QRY:Source>
	</QRY:Definition>


	<QRY:Definition>
	 <QRY:Id>140</QRY:Id>
	 <QRY:Source Name="operations.shipment.cto.findfsupremandepdetails" Type="NATIVE">
	<![CDATA[
		SELECT   MST.MSTDOCNUM, MST.DOCOWRIDR, MST.DUPNUM, MST.SEQNUM, MST.CMPCOD, MST.SHPPFX, MST.STDPCS, MST.STDWGT, MST.GRSVOL, MST.GRSVOLUNT VOLCOD,
	         MST.ORGCOD, MST.DSTCOD, IMPFLT.FLTNUM, IMPFLT.FLTDAT, IMPFLT.FLTCARCOD, ARP.ARPCOD, ARP.MFTPCS,
	         ARP.MFTWGT, MST.OWRCOD, MST.AGTCOD, AGTGRP.GRPNAM AGTGRP, MST.SHPCOD, CUSMST.CUSGRP SHPGRP, LEGDST.STA,
	         LEGDST.ATA, LEG.STD, LEG.ATD, MIS.STACOD, MIS.MSGSEQNUM, MIS.MSGTYP,OPRMST.FLTROU,LEG.FLTCARIDR,LEG.FLTSEQNUM,SYS.PARVAL WGTCOD,MIS.JNVPAR, 
			 SEGSHP.MFTPCS SEGMFTPCS,SEGSHP.MFTWGT SEGMFTWGT,FLTSEG.POL LEGORG,FLTSEG.POU LEGDST,SEGSHP.BDPPCS,SEGSHP.BDPWGT,MIS.SCICOD,  SHRMST.CNTCOD
	    FROM OPRSHPMST MST,
			 OPRARPSHP ARP,
	         OPRARPEXPFLT IMPFLT,
	         FLTOPRLEG LEG,
			 FLTOPRLEG LEGDST,
	         FLTOPRMST OPRMST,
	         SHRSYSPAR SYS,
	         OPRSHPMSTMIS MIS,
	         SHRCUSMST CUSMST,
	         SHRGENMSTGRPDTL AGTGRP,
			 OPRSEGSHP SEGSHP,
			 OPRFLTSEG FLTSEG,SHRARPMST SHRMST
			 
	   WHERE MST.MSTDOCNUM = ARP.MSTDOCNUM
	     AND MST.DOCOWRIDR = ARP.DOCOWRIDR
	     AND MST.DUPNUM = ARP.DUPNUM
	     AND MST.SEQNUM = ARP.SEQNUM
	     AND MST.CMPCOD = ARP.CMPCOD
	     AND MST.MSTDOCNUM    = SEGSHP.MSTDOCNUM
		 AND MST.DOCOWRIDR    = SEGSHP.DOCOWRIDR
		 AND MST.DUPNUM       = SEGSHP.DUPNUM
		 AND MST.SEQNUM       = SEGSHP.SEQNUM
		 AND MST.CMPCOD       = SEGSHP.CMPCOD
		 AND SEGSHP.FLTCARIDR = FLTSEG.FLTCARIDR
		 AND SEGSHP.FLTNUM    = FLTSEG.FLTNUM
		 AND SEGSHP.FLTSEQNUM = FLTSEG.FLTSEQNUM
		 AND SEGSHP.SEGSERNUM = FLTSEG.SEGSERNUM
		 AND ARP.ARPCOD       = FLTSEG.POL
				                                AND MST.MSTDOCNUM = MIS.MSTDOCNUM (+)
				         AND MST.DOCOWRIDR = MIS.DOCOWRIDR (+)
				         AND MST.DUPNUM = MIS.DUPNUM (+)
				         AND MST.SEQNUM = MIS.SEQNUM (+)
				         AND MST.CMPCOD = MIS.CMPCOD (+)
	     AND MST.CMPCOD = SYS.CMPCOD
	     AND IMPFLT.CMPCOD = LEG.CMPCOD
	     AND IMPFLT.ARPCOD = ARP.ARPCOD
				         AND IMPFLT.FLTCARIDR = FLTSEG.FLTCARIDR
				                     AND IMPFLT.FLTNUM = FLTSEG.FLTNUM
				                     AND IMPFLT.FLTSEQNUM = FLTSEG.FLTSEQNUM             
	     AND IMPFLT.FLTCARIDR = LEG.FLTCARIDR
	     AND IMPFLT.FLTNUM = LEG.FLTNUM
	     AND IMPFLT.FLTSEQNUM = LEG.FLTSEQNUM
	     AND IMPFLT.LEGSERNUM = LEG.LEGSERNUM
	     AND IMPFLT.ARPCOD = LEG.LEGORG
	     AND LEG.FLTSEQNUM = OPRMST.FLTSEQNUM
		 AND LEG.FLTNUM    =OPRMST.FLTNUM
		 AND LEG.FLTCARIDR =OPRMST.FLTCARIDR
		 AND FLTSEG.CMPCOD =LEGDST.CMPCOD
		 AND FLTSEG.FLTSEQNUM = LEGDST.FLTSEQNUM
		 AND FLTSEG.FLTNUM    =LEGDST.FLTNUM
		 AND FLTSEG.FLTCARIDR =LEGDST.FLTCARIDR
		 AND FLTSEG.POU = LEGDST.LEGDST
	     AND MST.CMPCOD = CUSMST.CMPCOD(+)
	     AND MST.SHPCOD = CUSMST.CUSCOD(+)
	     AND MST.CMPCOD = AGTGRP.CMPCOD(+)
	     AND MST.AGTCOD = AGTGRP.GRPENT(+)
		 AND AGTGRP.GRPCATCOD(+) = 'GEN'
		  AND MST.CMPCOD      = SHRMST.CMPCOD(+)
          AND MST.ORGCOD      =  SHRMST.ARPCOD(+)
	     AND MST.MSTDOCNUM = ?
	     AND MST.DOCOWRIDR = ?
	     AND MST.DUPNUM = ?
	     AND MST.SEQNUM = ?
	     AND MST.CMPCOD = ?
	     AND ARP.ARPCOD = ?
    	 AND SYS.PARCOD = ?
		 
	]]>
	</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	 <QRY:Id>141</QRY:Id>
	 <QRY:Source Name="operations.shipment.cto.findirpdetailsforfrp" Type="NATIVE">
	<![CDATA[
	SELECT IRP.IRPSERNUM, IRP.ARPCOD, IRP.CMPCOD, IRP.IRPDAT, IRP.IRPPCS,
	       IRP.IRPWGT, IRP.IRPSTA, IRP.DUPNUM, IRP.MSTDOCNUM, IRP.DOCOWRIDR,
	       IRP.SEQNUM, MST.CNSADRONE, MST.CNSNAM, IRP.EXEDAT, IRP.EXESTN, IRP.SHPDES,
	       MST.SHPADRONE, MST.SHPNAM, CNT.SHPACCNUM, CNT.SHPTELNUM, CNT.SHPSTT,
	       MIS.SHPSIG, MST.SHPPFX, CNT.SHPCTY, CNT.SHPCTR, CNT.CNSACCNUM,
	       CNT.CNSCTR, CNT.CNSCTY, CNT.CNSSTT, CNT.CNSTELNUM, SRV.SRVCOD,
	       MST.ORGCOD, MST.DSTCOD, SYS.PARVAL WGTCOD, ALRMST.TWOAPHCOD CARCOD,CUSMST.CUSGRP CNSGRP
	  FROM OPRSHPIRP IRP,
	       OPRSHPMST MST,
	       OPRSHPSRV SRV,
	       SHRSYSPAR SYS,
	       SHRARLMST ALRMST,
	       OPRARPSHP ARPSHP,
	       OPRSHPMSTCNT CNT,
	       OPRSHPMSTMIS MIS,
		   SHRCUSMST CUSMST
	 WHERE MST.MSTDOCNUM = IRP.MSTDOCNUM
	   AND MST.DOCOWRIDR = IRP.DOCOWRIDR
	   AND MST.DUPNUM = IRP.DUPNUM
	   AND MST.SEQNUM = IRP.SEQNUM
	   AND MST.CMPCOD = IRP.CMPCOD
	   AND MST.MSTDOCNUM = ARPSHP.MSTDOCNUM
	   AND MST.DOCOWRIDR = ARPSHP.DOCOWRIDR
	   AND MST.DUPNUM = ARPSHP.DUPNUM
	   AND MST.SEQNUM = ARPSHP.SEQNUM
	   AND MST.CMPCOD = ARPSHP.CMPCOD
	   AND IRP.ARPCOD = ARPSHP.ARPCOD
	   AND MST.MSTDOCNUM = CNT.MSTDOCNUM
	   AND MST.DOCOWRIDR = CNT.DOCOWRIDR
	   AND MST.DUPNUM = CNT.DUPNUM
	   AND MST.SEQNUM = CNT.SEQNUM
	   AND MST.CMPCOD = CNT.CMPCOD
	   AND MST.MSTDOCNUM = MIS.MSTDOCNUM
	   AND MST.DOCOWRIDR = MIS.DOCOWRIDR
	   AND MST.DUPNUM = MIS.DUPNUM
	   AND MST.SEQNUM = MIS.SEQNUM
	   AND MST.CMPCOD = MIS.CMPCOD
	   AND MST.MSTDOCNUM = SRV.MSTDOCNUM(+)
	   AND MST.DOCOWRIDR = SRV.DOCOWRIDR(+)
	   AND MST.DUPNUM = SRV.DUPNUM(+)
	   AND MST.SEQNUM = SRV.SEQNUM(+)
	   AND MST.CMPCOD = SRV.CMPCOD(+)
	   AND MST.CMPCOD = SYS.CMPCOD(+)
	   AND MST.CMPCOD = CUSMST.CMPCOD(+)
	   AND MST.CNSCOD = CUSMST.CUSCOD(+)
	   AND MST.CMPCOD = ALRMST.CMPCOD
	   AND MST.DOCOWRIDR = ALRMST.ARLIDR
	   AND (ARPSHP.FRPSTA IS NULL OR ARPSHP.FRPSTA <> 'Y')
	   AND MST.MSTDOCNUM = ?
	   AND MST.DOCOWRIDR = ?
	   AND MST.DUPNUM = ?
	   AND MST.SEQNUM = ?
	   AND MST.CMPCOD = ?
	   AND IRP.ARPCOD = ?
	   AND IRP.IRPSERNUM = ?
           AND SYS.PARCOD(+) = ?
  ]]>
	</QRY:Source>
	</QRY:Definition>


	<QRY:Definition>
	 <QRY:Id>142</QRY:Id>
	 <QRY:Source Name="operations.shipment.cto.finddiscrepancyclosuredetails" Type="NATIVE">
	<![CDATA[
	SELECT SEGSHP.FLTNUM, SEGSHP.MSTDOCNUM, SEGSHP.DOCOWRIDR, SEGSHP.FLTSEQNUM,
	       SEGSHP.FLTCARIDR, IMPFLT.LEGSERNUM, DIS.DISSEQNUM, SEGSHP.SEQNUM,
	       SEGSHP.DUPNUM, ARPSHP.ARPCOD, MST.CMPCOD, DIS.DISCOD, DIS.DOCNUM,
	       DIS.CRTTIM, DIS.CLSDAT, IMPFLT.FLTCARCOD, IMPFLT.FLTDAT, DIS.SHPTYP,
	       DIS.DISSTA, DIS.DISPCS, DIS.DISWGT, MST.STDPCS, MST.STDWGT, MST.SHPPFX, MST.SHPDES, MST.SCCCOD, MST.DSTCOD,MST.PRDNAM,
	       SEGSHP.FLTCARIDR SEGSHPFLTCARIDR, SEGSHP.FLTNUM SEGSHPFLTNUM,
	       SEGSHP.FLTSEQNUM SEGSHPFLTSEQNUM, SEGSHP.SEGSERNUM, SEGSHP.MFTPCS,
	       SEGSHP.MFTWGT, SEGSHP.MFTVOL,SEGSHP.RCVPCS, SEGSHP.RCVWGT,SEGSHP.RCVVOL,
	       ARPSHP.ARPCOD ARPSHPARPCOD, SEGSHP.SEGSERNUM,
	       ARPSHP.RCVPCS TOTRCVPCS,
		   DIS.LSTUPDTIM, (SELECT POL FROM OPRFLTSEG WHERE CMPCOD= SEGSHP.CMPCOD
     AND FLTCARIDR=SEGSHP.FLTCARIDR
     AND FLTNUM=SEGSHP.FLTNUM
     AND FLTSEQNUM=SEGSHP.FLTSEQNUM
     AND SEGSERNUM=SEGSHP.SEGSERNUM) POL
	  FROM OPRSHPFLTDIS DIS,
	       OPRSHPMST  MST,
	       OPRARPSHP ARPSHP,
	       OPRSEGSHP SEGSHP,
	       OPRARPIMPFLT IMPFLT
	 WHERE MST.MSTDOCNUM = SEGSHP.MSTDOCNUM
	   AND MST.DOCOWRIDR = SEGSHP.DOCOWRIDR
	   AND MST.DUPNUM = SEGSHP.DUPNUM
	   AND MST.SEQNUM = SEGSHP.SEQNUM
	   AND MST.CMPCOD = SEGSHP.CMPCOD
	   AND MST.MSTDOCNUM = ARPSHP.MSTDOCNUM
	   AND MST.DOCOWRIDR = ARPSHP.DOCOWRIDR
	   AND MST.DUPNUM = ARPSHP.DUPNUM
	   AND MST.SEQNUM = ARPSHP.SEQNUM
	   AND MST.CMPCOD = ARPSHP.CMPCOD
	   AND SEGSHP.MSTDOCNUM = DIS.MSTDOCNUM(+)
	   AND SEGSHP.DOCOWRIDR = DIS.DOCOWRIDR(+)
	   AND SEGSHP.DUPNUM = DIS.DUPNUM(+)
	   AND SEGSHP.SEQNUM = DIS.SEQNUM(+)
	   AND SEGSHP.CMPCOD = DIS.CMPCOD(+)
	   AND SEGSHP.FLTNUM = DIS.FLTNUM(+)
	   AND SEGSHP.FLTSEQNUM = DIS.FLTSEQNUM(+)
	   AND SEGSHP.FLTCARIDR = DIS.FLTCARIDR(+)
	   AND SEGSHP.CMPCOD = IMPFLT.CMPCOD
	   AND SEGSHP.FLTNUM = IMPFLT.FLTNUM
	   AND SEGSHP.FLTSEQNUM = IMPFLT.FLTSEQNUM
	   AND SEGSHP.FLTCARIDR = IMPFLT.FLTCARIDR
	   AND IMPFLT.ARPCOD = ARPSHP.ARPCOD

	  ]]>
	</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	 <QRY:Id>143</QRY:Id>
	 <QRY:Source Name="operations.shipment.cto.findtransactionforfsu" Type="NATIVE">
	<![CDATA[
	SELECT NFY.LSTUPDTIM NFYLSTUPDTIM, CTMSHP.LSTUPDTIM CTMSHPLSTUPDTIM,
	       OFL.LSTUPDTIM OFLLSTUPDTIM, SEGSHP.LSTUPDTIM SEGSHPLSTUPDTIM
	  FROM OPRSHPNFY NFY,
	       OPRMFTCTMSHP CTMSHP,
	       OPROFLDTL OFL,
	       OPRSEGSHP SEGSHP,
	       OPRSHPMST  MST
	 WHERE MST.MSTDOCNUM = OFL.MSTDOCNUM(+)
	   AND MST.DOCOWRIDR = OFL.DOCOWRIDR(+)
	   AND MST.DUPNUM = OFL.DUPNUM(+)
	   AND MST.SEQNUM = OFL.SEQNUM(+)
	   AND MST.CMPCOD = OFL.CMPCOD(+)
	   AND NFY.MSTDOCNUM = OFL.MSTDOCNUM(+)
	   AND NFY.DOCOWRIDR = OFL.DOCOWRIDR(+)
	   AND NFY.DUPNUM = OFL.DUPNUM(+)
	   AND NFY.SEQNUM = OFL.SEQNUM(+)
	   AND NFY.CMPCOD = OFL.CMPCOD(+)
	   AND NFY.MSTDOCNUM = CTMSHP.MSTDOCNUM(+)
	   AND NFY.DOCOWRIDR = CTMSHP.DOCOWRIDR(+)
	   AND NFY.DUPNUM = CTMSHP.DUPNUM(+)
	   AND NFY.SEQNUM = CTMSHP.SEQNUM(+)
	   AND NFY.CMPCOD = CTMSHP.CMPCOD(+)
	   AND NFY.MSTDOCNUM = SEGSHP.MSTDOCNUM(+)
	   AND NFY.DOCOWRIDR = SEGSHP.DOCOWRIDR(+)
	   AND NFY.DUPNUM = SEGSHP.DUPNUM(+)
	   AND NFY.SEQNUM = SEGSHP.SEQNUM(+)
	   AND NFY.CMPCOD = SEGSHP.CMPCOD(+)
	   AND MST.MSTDOCNUM = ?
	   AND MST.DOCOWRIDR = ?
	   AND MST.DUPNUM = ?
	   AND MST.SEQNUM = ?
	   AND MST.CMPCOD = ?

   ]]>
	</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
		<QRY:Id>144</QRY:Id>
		<QRY:Source Name="operations.shipment.cto.findlatestairportdetails" Type="NATIVE">
		<![CDATA[
		SELECT ARPSHP.ARPCOD, ARLSHP.AVLPCS, ARPSHP.MFTPCS, ARPSHP.MFTWGT,
		       ARPSHP.MFTVOL, ARPSHP.DNTUSEFLG, ARPSHP.RCVPCS, ARPSHP.RCVWGT,
		       ARPSHP.RCVVOL, ARLSHP.AVLWGT, ARPSHP.AVLVOL, ARPSHP.DOCRCVFLG,
		       ARPSHP.ABDPCS, ARPSHP.ABDWGT, ARPSHP.TOTDLVNOTPCS, ARPSHP.TOTDLVNOTWGT,
		       ARPSHP.TOTDLVPCS, ARPSHP.TOTDLVWGT
		  FROM OPRARPSHP ARPSHP, OPRARPARLSHP ARLSHP
		 WHERE ARPSHP.DOCOWRIDR = ARLSHP.DOCOWRIDR
		 AND ARPSHP.MSTDOCNUM = ARLSHP.MSTDOCNUM
		   AND ARPSHP.DUPNUM = ARLSHP.DUPNUM
		   AND ARPSHP.SEQNUM = ARLSHP.SEQNUM
		   AND ARPSHP.CMPCOD = ARLSHP.CMPCOD
		   AND ARPSHP.ARPCOD = ARLSHP.ARPCOD
		   AND ARPSHP.CMPCOD = ?
		   AND ARPSHP.DOCOWRIDR = ?
		   AND ARPSHP.MSTDOCNUM = ?
		   AND ARPSHP.DUPNUM = ?
		   AND ARPSHP.SEQNUM = ?


	   ]]>
		</QRY:Source>
	</QRY:Definition>

			 <QRY:Definition>
		 <QRY:Id>145</QRY:Id>
		 <QRY:Source Name="operations.shipment.findshipmentsfortransferreduceduld" Type="NATIVE">
		 	<![CDATA[

			SELECT ARPULD.CMPCOD,ARPULD.ARPCOD,
				   ULDSHP.MSTDOCNUM,ULDSHP.DOCOWRIDR,ULDSHP.SEQNUM,ULDSHP.DUPNUM,ULDSHP.NUMPCS,ULDSHP.ULDNUM,
				   ARPULD.INBFLTCARCOD,ARPULD.INBFLTCARIDR,ARPULD.INBFLTNUM,
				   ARPULD.INBFLTSEQNUM,ARPULD.INBLEGSERNUM,ARPULD.OUTFLTCARIDR,ARPULD.OUTFLTCARCOD
			FROM
			OPRARPULD ARPULD,OPRULDSHP ULDSHP
			WHERE
			ARPULD.ARPCOD=ULDSHP.ARPCOD AND
			ARPULD.CMPCOD=ULDSHP.CMPCOD AND
			ARPULD.ULDNUM=ULDSHP.ULDNUM AND
			ULDSHP.CMPCOD=? AND
			ULDSHP.ARPCOD=? AND
			ULDSHP.SEQNUM=? AND
			ULDSHP.DUPNUM=? AND
			ULDSHP.DOCOWRIDR=? AND
			ULDSHP.MSTDOCNUM=?

		 	]]>
		 </QRY:Source>
	</QRY:Definition>



		<QRY:Definition>
	 <QRY:Id>146</QRY:Id>
	 <QRY:Source Name="operations.shipment.listTracer" Type="NATIVE">
		<![CDATA[
		SELECT DIS.FLTNUM, DIS.MSTDOCNUM, DIS.DOCOWRIDR, MST.SHPPFX,DIS.FLTSEQNUM,
					   DIS.FLTCARIDR,DIS.LEGSERNUM, DIS.DISSEQNUM, DIS.SEQNUM, DIS.DUPNUM,DIS.DOCNUM,
					   DIS.ARPCOD,DIS.DISCOD, DIS.CRTTIM, DIS.FLTCARCOD,DIS.DISPCS,MST.CONFLG,MST.STDWGTCOD,
					   DIS.DISWGT,DIS.FLTDAT, DIS.DISSTA, MST.SHPDES,MST.STDPCS,MST.STDWGT,
					   MST.SHPNAM,MST.CNSNAM,MST.SHPADRONE, CNT.SHPADRTWO,MST.DSTCOD,DIS.LSTUPDTIM,
					   CNT.SHPCTY, CNT.SHPSTT, CNT.SHPCTR, CNT.SHPPSTCOD,FLTSEG.SEGSERNUM,
					   MST.CNSADRONE, CNT.CNSADRTWO, CNT.CNSCTY, CNT.CNSSTT, CNT.CNSCTR,CNT.CNSPSTCOD,
					   FLTSEG.POL,SUM(SEG.RCVPCS) AS SUMRCVPCS,SUM(SEG.RCVWGT) AS SUMRCVWGT,FLT.FLTROU,MST.ORGCOD,MST.DSTCOD 
         FROM OPRSHPFLTDIS DIS, SHRARLARPPAR ARP, OPRSHPMST MST,OPRFLTSEG FLTSEG,OPRSEGSHP SEG, 
				 FLTOPRMST FLT,OPRSHPMSTCNT CNT
				 WHERE DIS.CMPCOD = ARP.CMPCOD
				   AND DIS.FLTCARIDR = ARP.ARLIDR
				   AND DIS.ARPCOD = ARP.ARPCOD
                AND ARP.PARCOD ='shared.airline.tracingperiod'
				   AND DIS.CMPCOD = MST.CMPCOD
				   AND DIS.DOCOWRIDR = MST.DOCOWRIDR
				   AND DIS.MSTDOCNUM = MST.MSTDOCNUM
				   AND DIS.DUPNUM = MST.DUPNUM
				   AND DIS.SEQNUM = MST.SEQNUM

				    AND DIS.CMPCOD = CNT.CMPCOD
				   AND DIS.DOCOWRIDR = CNT.DOCOWRIDR
				   AND DIS.MSTDOCNUM = CNT.MSTDOCNUM
				   AND DIS.DUPNUM = CNT.DUPNUM
				   AND DIS.SEQNUM = CNT.SEQNUM

				   AND DIS.CMPCOD = FLTSEG.CMPCOD
				   AND DIS.FLTCARIDR = FLTSEG.FLTCARIDR
				   AND DIS.FLTNUM = FLTSEG.FLTNUM
				   AND DIS.FLTSEQNUM = FLTSEG.FLTSEQNUM
				   AND DIS.ARPCOD = FLTSEG.POU
				   AND DIS.CMPCOD = SEG.CMPCOD
				   AND DIS.DOCOWRIDR = SEG.DOCOWRIDR
				   AND DIS.MSTDOCNUM = SEG.MSTDOCNUM
				   AND DIS.DUPNUM = SEG.DUPNUM
				   AND DIS.SEQNUM = SEG.SEQNUM
				   AND DIS.FLTNUM = SEG.FLTNUM
				   AND DIS.FLTSEQNUM = SEG.FLTSEQNUM
				   AND DIS.FLTCARIDR = SEG.FLTCARIDR
				   AND FLTSEG.SEGSERNUM = SEG.SEGSERNUM
				   AND DIS.CMPCOD = FLT.CMPCOD
				   AND DIS.FLTNUM = FLT.FLTNUM
				   AND DIS.FLTSEQNUM = FLT.FLTSEQNUM
				   AND DIS.FLTCARIDR = FLT.FLTCARIDR
				   AND   DIS.CRTTIM
				       + (CASE
                   WHEN (TO_NUMBER(ARP.PARVAL) > 0) 
                     THEN TO_NUMBER(ARP.PARVAL)
					     ELSE (SELECT TO_NUMBER (PARVAL)
						     FROM SHRSYSPAR
						    WHERE PARCOD = ?)
					  END
					 ) < SYSDATE
				   AND DIS.TRCFLG <> 'Y'
				   AND DIS.CMPCOD = ?
				   AND DIS.ARPCOD = ?
				   AND DIS.DISCOD = ?
		   AND DIS.CRTTIM < ?
		   	  ]]>
	</QRY:Source>
	</QRY:Definition>



	<QRY:Definition>
	<QRY:Id>147</QRY:Id>
	<QRY:Source Name="operations.shipment.findawbs" Type="NATIVE">
		<![CDATA[

	          SELECT MST.CMPCOD,MST.DOCOWRIDR,MST.SHPPFX,MST.MSTDOCNUM,MST.DUPNUM,MST.SEQNUM ,MST.UBRNUM,MST.ORGCOD,MST.DSTCOD,MST.AGTCOD,MST.STDPCS,MST.STDWGTCOD,MST.STDDISWGT,MST.SHPSTA,IDX.SHPSTA SHPIDXSTA,MST.CURCOD,
		  		         MST.SPTRATIDR,MST.SHPNAM,MST.CNSNAM,ACC.SPTRATSTA,ACC.SPTRATAPRDAT,ACC.SPTRAT,ACC.RATCONAPRDAT,RAT.RATLINSERNUM,RAT.NETCHG,
		  		  	   RAT.IATTRFNAM, RAT.ARLTRFNAM,
		  		  	   RAT.IATTRFSERNUM, RAT.ARLTRFSERNUM,
		  		  	   RAT.ARLTRFRATSERNUM, RAT.IATTRFRATSERNUM,
		  		  	   RAT.ARLRATLINIDR, RAT.IATRATLINIDR,
					   RAT.ADDARLRATLINIDS, RAT.TRKOALRATFLG,
		  		  	   DTL.TOTACPPCS,DTL.TOTACPWGT
		  		      FROM  OPRSHPMST  MST , OPRSHPRATDTL RAT,OPRSHPDTL DTL,OPRSHPMSTACC ACC,OPRSHPIDX IDX

		  		       WHERE MST.CMPCOD = IDX.CMPCOD
					     AND MST.DOCOWRIDR = IDX.DOCOWRIDR
					     AND MST.MSTDOCNUM = IDX.MSTDOCNUM
					     AND MST.DUPNUM = IDX.DUPNUM
					     AND MST.SEQNUM = IDX.SEQNUM          
					    AND MST.CMPCOD=RAT.CMPCOD(+) AND
		  					MST.DOCOWRIDR=RAT.DOCOWRIDR(+) AND
		  					MST.MSTDOCNUM = RAT.MSTDOCNUM(+) AND
		  					MST.DUPNUM = RAT.DUPNUM(+) AND
		  					MST.SEQNUM=RAT.SEQNUM(+) AND

		  					 MST.CMPCOD=ACC.CMPCOD(+) AND
		  					MST.DOCOWRIDR=ACC.DOCOWRIDR(+) AND
		  					MST.MSTDOCNUM = ACC.MSTDOCNUM(+) AND
		  					MST.DUPNUM = ACC.DUPNUM(+) AND
		  					MST.SEQNUM=ACC.SEQNUM(+) AND

		  		  	                MST.CMPCOD=DTL.CMPCOD(+) AND
		  		                        MST.DOCOWRIDR=DTL.DOCOWRIDR(+) AND
		  		                        MST.MSTDOCNUM = DTL.MSTDOCNUM(+) AND
		  		                        MST.DUPNUM = DTL.DUPNUM(+) AND
		  		                        MST.SEQNUM=DTL.SEQNUM(+) AND

		                        MST.CMPCOD=?
	]]>
	</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>148</QRY:Id>
	<QRY:Source Name="operations.shipment.cto.findpartshipmentdetails" Type="NATIVE">
		<![CDATA[

		SELECT
    SUM(RCVPCS) RCVPCS, MST.STDPCS, MST.STDWGT,MST.STDWGTCOD,MST.MSTDOCNUM, MST.SHPDES, MST.SHPNAM,
    MST.SHPADRONE, MST.CNSNAM,MST.CNSADRONE, FLT.FLTCARCOD, FLT.LEGSERNUM, FLT.ARPCOD, FLTMST.FLTNUM,
    FLTMST.FLTCARIDR,FLTMST.FLTDAT,FLTMST.FLTSEQNUM, FLTMST.FLTROU, NVL(LEG.ATA,LEG.STA) PRTARRDAT
     FROM
    OPRSHPMST MST, OPRSEGSHP SHP, OPRFLTSEG SEG, OPRARPIMPFLT FLT, FLTOPRMST FLTMST, FLTOPRLEG LEG
    WHERE
    MST.DOCOWRIDR     = SHP.DOCOWRIDR(+)
    AND MST.MSTDOCNUM = SHP.MSTDOCNUM(+)
    AND MST.SEQNUM    = SHP.SEQNUM(+)
    AND MST.DUPNUM    = SHP.DUPNUM(+)
    AND SHP.FLTCARIDR = SEG.FLTCARIDR(+)
    AND SHP.CMPCOD    = SEG.CMPCOD(+)
    AND SHP.FLTNUM    = SEG.FLTNUM(+)
    AND SHP.FLTSEQNUM = SEG.FLTSEQNUM(+)
    AND SHP.SEGSERNUM = SEG.SEGSERNUM(+)
    AND SEG.CMPCOD    = LEG.CMPCOD(+)
    AND SEG.FLTNUM    = LEG.FLTNUM(+)
    AND SEG.FLTCARIDR = LEG.FLTCARIDR(+)
    AND SEG.FLTSEQNUM = LEG.FLTSEQNUM(+)
	AND SEG.CMPCOD    = FLTMST.CMPCOD(+)
    AND SEG.FLTNUM    = FLTMST.FLTNUM(+)
    AND SEG.FLTSEQNUM = FLTMST.FLTSEQNUM(+)
    AND SEG.FLTCARIDR = FLTMST.FLTCARIDR(+)
    AND LEG.FLTCARIDR = FLT.FLTCARIDR(+)
    AND LEG.CMPCOD    = FLT.CMPCOD(+)
    AND LEG.FLTNUM    = FLT.FLTNUM(+)
    AND LEG.FLTSEQNUM = FLT.FLTSEQNUM(+)
    AND LEG.LEGDST    = FLT.ARPCOD(+)
    AND LEG.LEGSERNUM = FLT.LEGSERNUM(+)
    AND MST.CMPCOD    = ?
    AND MST.DOCOWRIDR = ?
    AND MST.MSTDOCNUM = ?
    AND MST.SEQNUM    = ?
    AND MST.DUPNUM    = ?
    AND FLT.ARPCOD(+) = ?
 GROUP BY
    MST.STDPCS,MST.STDWGT,MST.STDWGTCOD,MST.MSTDOCNUM,FLT.FLTCARCOD,FLT.ARPCOD, FLT.LEGSERNUM,
    MST.SHPDES,MST.SHPNAM,MST.SHPADRONE,MST.CNSNAM,MST.CNSADRONE, FLTMST.FLTNUM,FLTMST.FLTCARIDR,
    FLTMST.FLTDAT,FLTMST.FLTSEQNUM,FLTMST.FLTROU,LEG.ATA,LEG.STA
 ORDER BY
    FLTMST.FLTDAT DESC


		]]>
	</QRY:Source>
</QRY:Definition>

<QRY:Definition>
	<QRY:Id>149</QRY:Id>
	<QRY:Source Name="operations.shipment.cto.findirpenquirydetails" Type="NATIVE">
		<![CDATA[
		SELECT MST.DOCNUM, MST.PAYTYP, IRP.IRPSERNUM, IRP.CMPCOD,
		       IRP.ARPCOD, MST.CNSADRONE, MST.CNSNAM,
		       IRP.EXEDAT, IRP.IRPDAT, IRP.IRPPCS,
		       IRP.IRPWGT, IRP.EXESTN, MST.SHPADRONE,
		       IRP.DUPNUM, IRP.IRPSTA, IRP.SHPDES,
		       MST.SHPNAM, IRP.SHPPFX, IRP.SEQNUM,
		       IRP.MSTDOCNUM, IRP.DOCOWRIDR, MST.MSTDOCNUM, MST.CNSCOD
		  FROM OPRSHPIRP IRP, OPRSHPMST MST
		 WHERE IRP.CMPCOD = MST.CMPCOD
		   AND IRP.DOCOWRIDR = MST.DOCOWRIDR
		   AND IRP.DUPNUM = MST.DUPNUM
		   AND IRP.SEQNUM = MST.SEQNUM
		   AND IRP.MSTDOCNUM = MST.MSTDOCNUM
		   AND IRP.CMPCOD = ?
		   AND IRP.ARPCOD = ?
		]]>
	</QRY:Source>
</QRY:Definition>


	<QRY:Definition>
	<QRY:Id>150</QRY:Id>
	 <QRY:Source Name="operations.shipment.findfinalizedflight" Type="NATIVE">
		 	<![CDATA[

		SELECT CLSFLG
		  FROM OPRARPIMPFLT
		 WHERE FLTCARIDR = ?
		       AND FLTNUM = ?
		       AND FLTSEQNUM = ?
		       AND ARPCOD = ?
		       AND CMPCOD = ?

		]]>
	 </QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>151</QRY:Id>
	 <QRY:Source Name="operations.shipment.findflightdiscrepancyforfinalized" Type="NATIVE">
		 	<![CDATA[
			SELECT MST.CMPCOD,
  IMPFLT.ARPCOD,
  (
  CASE
    WHEN MST.PARSEQNUM > 0
    THEN ''
    ELSE MST.SHPPFX
  END) SHPPFX,
			MST.DOCOWRIDR,
  (
  CASE
    WHEN MST.PARSEQNUM > 0
    THEN MST.MSTDOCNUM
      ||'/'
      ||MST.DOCNUM
    ELSE MST.MSTDOCNUM
END) MSTDOCNUM,
			MST.DOCNUM DOCNUM,
  MST.SEQNUM,
  MST.DUPNUM,
  MST.ORGCOD,
  MST.DSTCOD,
  IMPFLT.FLTCARIDR,
  IMPFLT.FLTNUM,
  IMPFLT.FLTSEQNUM,
  IMPFLT.LEGSERNUM,
  IMPFLT.FLTCHGNAM,
  FLTDIS.RMK FLTDISRMK,
  FLTDIS.DISSEQNUM,
							FLTDIS.DISCOD, 
  FLTDIS.CLSDAT,
  FLTDIS.CRTTIM,
  IMPFLT.FLTCARCOD,
  FLTDIS.MSTDOCNUM FLTDISMSTDOCNUM,
  FLTDIS.DISPCS,
  FLTDIS.DISWGT,
  FLTDIS.DISSTA,
  NULL DMGPCS,
  NULL DMGCOD,
  NULL DMGDISDAT,
  NULL DMGRMK,
  NULL DMGSEQNUM,
  NULL DMGDISSTA,
  NULL FNDSHPNUM,
  NULL FSTOTDISPCS,
  NULL FSTOTDISWGT,
  NULL FSTOTRSLPCS,
  NULL FSDISDAT,
  NULL FSTOTRSLWGT,
  NULL FNDSHPSTA,
  NULL FSDMGCOD,
  NULL FSORGCOD,
  NULL FSDSTCOD,
  LEG.ATA,
  FLT.FLTROU,
  FLT.FLTDAT,
  MST.SHPDES,
		       MST.SCCCOD, 
  NULL AWBDIS,
  NULL AWBCRTTIM,
  NULL SHPTYP,
  NULL AWBDISSTA,
  NULL AWBDISRMK,
  NULL AWBMSTDOCNUM,
  MST.STDPCS         AS SUMSTDPCS,
  MST.STDWGT         AS SUMSTDWGT,
  SUM(ULDSHP.MFTPCS) AS SUMMFTPCS,
  SUM(ULDSHP.MFTWGT) AS SUMMFTWGT,
  SUM(ULDSHP.RCVPCS) AS SUMRCVPCS,
  SUM(ULDSHP.RCVWGT) AS SUMRCVWGT,
  Impflt.Fltoprsta,
  NULL Imgpth ,
  NULL CDSSTA,
  0 IMGSEQNUM,
  MST.ORGCOD,
  MST.DSTCOD,
  NULL FNDSHPRMK,
  ARPSHP.PLTUSEFLG,
  MST.PLTFLG PLTFLG,
  SHPDTL.PLTUSEFLG DTLPLTFLG
FROM OPRSEGULDSHP ULDSHP,
  OPRFLTSEG FLTSEG,
  OPRARPIMPFLT IMPFLT,
  OPRSHPFLTDIS FLTDIS,
  OPRSHPMST MST,
  FLTOPRMST FLT,
  FLTOPRLEG LEG,
  OPRARPSHP ARPSHP,
  OPRSHPDTL SHPDTL
		 WHERE ULDSHP.CMPCOD = FLTSEG.CMPCOD
		   AND ULDSHP.FLTNUM = FLTSEG.FLTNUM
		   AND ULDSHP.FLTSEQNUM = FLTSEG.FLTSEQNUM
		   AND ULDSHP.FLTCARIDR = FLTSEG.FLTCARIDR
AND ULDSHP.SEGSERNUM    = FLTSEG.SEGSERNUM
		   AND FLTSEG.CMPCOD = IMPFLT.CMPCOD
AND FLTSEG.FLTNUM       = IMPFLT.FLTNUM
		   AND FLTSEG.FLTSEQNUM = IMPFLT.FLTSEQNUM
		   AND FLTSEG.FLTCARIDR = IMPFLT.FLTCARIDR
		   AND FLTSEG.POU = IMPFLT.ARPCOD
		   AND IMPFLT.CMPCOD = FLT.CMPCOD
		   AND IMPFLT.FLTCARIDR = FLT.FLTCARIDR
		   AND IMPFLT.FLTNUM = FLT.FLTNUM
		   AND IMPFLT.FLTSEQNUM = FLT.FLTSEQNUM
		   AND IMPFLT.CMPCOD = LEG.CMPCOD
		   AND IMPFLT.FLTCARIDR = LEG.FLTCARIDR
		   AND IMPFLT.FLTNUM = LEG.FLTNUM
AND IMPFLT.FLTSEQNUM    = LEG.FLTSEQNUM
		   AND IMPFLT.LEGSERNUM = LEG.LEGSERNUM
		   AND ULDSHP.CMPCOD = MST.CMPCOD
AND ULDSHP.DOCOWRIDR    = MST.DOCOWRIDR
		   AND ULDSHP.MSTDOCNUM = MST.MSTDOCNUM
AND ULDSHP.DUPNUM       = MST.DUPNUM
		   AND ULDSHP.SEQNUM = MST.SEQNUM
		   AND ULDSHP.CMPCOD = FLTDIS.CMPCOD(+)
AND ULDSHP.FLTNUM       = FLTDIS.FLTNUM(+)
		   AND ULDSHP.FLTSEQNUM = FLTDIS.FLTSEQNUM(+)
		   AND ULDSHP.FLTCARIDR = FLTDIS.FLTCARIDR(+)
		   AND FLTDIS.LEGSERNUM(+) = ?
		   AND ULDSHP.CMPCOD = FLTDIS.CMPCOD(+)
		   AND ULDSHP.DOCOWRIDR = FLTDIS.DOCOWRIDR(+)
AND ULDSHP.MSTDOCNUM    = FLTDIS.MSTDOCNUM(+)
		   AND ULDSHP.DUPNUM = FLTDIS.DUPNUM(+)
AND ULDSHP.SEQNUM       = FLTDIS.SEQNUM(+)
		   AND MST.CMPCOD          = ARPSHP.CMPCOD(+)
		   AND MST.MSTDOCNUM       = ARPSHP.MSTDOCNUM(+)
		   AND MST.DOCOWRIDR       = ARPSHP.DOCOWRIDR(+)
		   AND MST.SEQNUM          = ARPSHP.SEQNUM(+)
		   AND MST.DUPNUM          = ARPSHP.DUPNUM(+)
		   AND ARPSHP.ARPCOD(+) =?
	AND MST.CMPCOD = SHPDTL.CMPCOD(+)
    AND MST.MSTDOCNUM = SHPDTL.MSTDOCNUM(+)
    AND MST.DOCOWRIDR = SHPDTL.DOCOWRIDR(+)
    AND MST.SEQNUM = SHPDTL.SEQNUM(+)
    AND MST.DUPNUM = SHPDTL.DUPNUM(+)
	
		   AND IMPFLT.FLTCARIDR = ?
		   AND IMPFLT.FLTNUM = ?
		   AND IMPFLT.FLTSEQNUM = ?
		   AND IMPFLT.LEGSERNUM = ?
		   AND IMPFLT.ARPCOD = ?
		   AND IMPFLT.CMPCOD = ?

	   ]]>
	 </QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>152</QRY:Id>
	 <QRY:Source Name="operations.shipment.findflightdiscrepancyfornotfinalized" Type="NATIVE">
				<![CDATA[
			SELECT FLTSEG.CMPCOD,
  FLTSEG.FLTNUM      ,
  FLTSEG.FLTCARIDR   ,
  FLTSEG.FLTSEQNUM   ,
  (
  CASE
WHEN 
MST.PARSEQNUM > 0
    THEN ''
    ELSE MST.SHPPFX
  END) SHPPFX  ,
			   MST.DOCOWRIDR,
  (
  CASE
WHEN 
MST.PARSEQNUM > 0
    THEN MST.MSTDOCNUM
      ||'/'
      ||MST.DOCNUM
    ELSE MST.MSTDOCNUM
END) MSTDOCNUM         
,
  MST.SEQNUM             ,
  MST.DUPNUM             ,
  NULL DISCOD ,
  NULL CRTTIM ,
  NULL CLSDAT 
,
     MST.ORGCOD, 
  MST.DSTCOD,
  MST.STDPCS AS SUMSTDPCS,
  MST.STDWGT      AS SUMSTDWGT,
  NULL DMGCOD 
,
  NULL DMGDISDAT ,
  NULL DMGRMK ,
  NULL DMGDISSTA ,
  NULL DMGPCS ,
  NULL FNDSHPNUM ,
  NULL FSTOTDISPCS,
  
NULL FSTOTDISWGT,
  NULL FSTOTRSLPCS,
  NULL FSTOTRSLWGT,
  NULL FSDMGCOD ,
  NULL FSDISDAT ,
  NULL 
FSORGCOD,
  NULL FSDSTCOD,
  LEG.ATA                     ,
  FLT.FLTROU ,
  FLT.FLTDAT                  
,
  NULL DISSTA ,
  NULL DMGSEQNUM ,
  MST.SHPDES                  ,
  MST.SCCCOD                  ,
  IMPFLT.ARPCOD               ,
  IMPFLT.FLTCARCOD ,
  IMPFLT.FLTOPRSTA,
  IMPFLT.FLTCHGNAM,
  NULL IMGPTH,
(
  CASE
    WHEN DMGSRY.CDSSTA = 'I'
    THEN 'ISSUED'
    ELSE 'PENDING'
  END) CDSSTA,
  NVL(SEGULD.bdncplflg,'N') 
bdncplflg,
  SUM(ULDSHP.MFTPCS) AS SUMMFTPCS,
  SUM(ULDSHP.MFTWGT) AS SUMMFTWGT,
  SUM(ULDSHP.RCVPCS) 
AS SUMRCVPCS,
  SUM(ULDSHP.RCVWGT) AS SUMRCVWGT,
  0 IMGSEQNUM,
  ARPSHP.PLTUSEFLG PLTUSEFLG,
  SHPDTL.PLTUSEFLG DTLPLTFLG,
  MST.PLTFLG PLTFLG
   FROM OPRSEGSHP SEG,
  OPRFLTSEG FLTSEG   
,
  OPRARPIMPFLT IMPFLT,
  OPRSHPMST MST ,
  FLTOPRMST FLT      ,
  FLTOPRLEG LEG,
  OPRDMGSRYDTL DMGSRY,
  
OPRSEGULDSHP ULDSHP,
  OPRSEGULD SEGULD,
    OPRARPSHP ARPSHP,
	OPRSHPDTL SHPDTL
WHERE SEG.CMPCOD     = FLTSEG.CMPCOD
		    	AND SEG.FLTNUM = 
FLTSEG.FLTNUM
				AND SEG.FLTSEQNUM = FLTSEG.FLTSEQNUM
				AND SEG.FLTCARIDR = FLTSEG.FLTCARIDR
				AND 
SEG.SEGSERNUM = FLTSEG.SEGSERNUM
				AND ULDSHP.CMPCOD = FLTSEG.CMPCOD
			   AND ULDSHP.FLTNUM = FLTSEG.FLTNUM
AND 
ULDSHP.FLTSEQNUM = FLTSEG.FLTSEQNUM
			   AND ULDSHP.FLTCARIDR = FLTSEG.FLTCARIDR
			   AND ULDSHP.SEGSERNUM 
= FLTSEG.SEGSERNUM
			   AND ULDSHP.CMPCOD = MST.CMPCOD
				AND ULDSHP.DOCOWRIDR = MST.DOCOWRIDR
				AND ULDSHP.MSTDOCNUM 
= MST.MSTDOCNUM
				AND ULDSHP.DUPNUM = MST.DUPNUM
				AND ULDSHP.SEQNUM = MST.SEQNUM
AND ULDSHP.Fltcaridr =Seguld.Fltcaridr
AND ULDSHP.Fltnum    =Seguld.Fltnum
AND ULDSHP.Fltseqnum =Seguld.Fltseqnum
AND ULDSHP.Segsernum =Seguld.Segsernum
AND ULDSHP.Cmpcod    =Seguld.Cmpcod
AND ULDSHP.Uldnum    =Seguld.Uldnum

AND ULDSHP.Fltnum    =Seguld.Fltnum
AND ULDSHP.Fltseqnum =Seguld.Fltseqnum
AND ULDSHP.Segsernum =Seguld.Segsernum
AND 
ULDSHP.Cmpcod    =Seguld.Cmpcod
AND ULDSHP.Uldnum    =Seguld.Uldnum
AND FLTSEG.CMPCOD    = IMPFLT.CMPCOD
			   	AND FLTSEG.FLTNUM = IMPFLT.FLTNUM
				AND FLTSEG.FLTSEQNUM = IMPFLT.FLTSEQNUM
AND FLTSEG.FLTCARIDR = 
IMPFLT.FLTCARIDR
				AND FLTSEG.POU = IMPFLT.ARPCOD
			   	AND SEG.CMPCOD = MST.CMPCOD
AND SEG.DOCOWRIDR 
= MST.DOCOWRIDR
				AND SEG.MSTDOCNUM = MST.MSTDOCNUM
				AND SEG.DUPNUM = MST.DUPNUM
AND SEG.SEQNUM 
= MST.SEQNUM
				AND IMPFLT.CMPCOD = FLT.CMPCOD
				AND IMPFLT.FLTCARIDR = FLT.FLTCARIDR
AND IMPFLT.FLTNUM 
= FLT.FLTNUM
				AND IMPFLT.FLTSEQNUM = FLT.FLTSEQNUM
				AND IMPFLT.CMPCOD = LEG.CMPCOD
AND IMPFLT.FLTCARIDR 
= LEG.FLTCARIDR
				AND IMPFLT.FLTNUM = LEG.FLTNUM
				AND IMPFLT.FLTSEQNUM = LEG.FLTSEQNUM
AND IMPFLT.LEGSERNUM 
= LEG.LEGSERNUM
AND SEG.DOCOWRIDR = DMGSRY.DOCOWRIDR(+)
AND SEG.MSTDOCNUM = DMGSRY.MSTDOCNUM(+)
AND SEG.DUPNUM    
= DMGSRY.DUPNUM(+)
AND SEG.SEQNUM    = DMGSRY.SEQNUM(+)

				AND MST.MSTDOCNUM       = ARPSHP.MSTDOCNUM(+)
				AND MST.DOCOWRIDR       = ARPSHP.DOCOWRIDR(+)
				AND MST.SEQNUM          = ARPSHP.SEQNUM(+)
				AND MST.DUPNUM          = ARPSHP.DUPNUM(+)
  AND MST.CMPCOD    = SHPDTL.CMPCOD(+)
  AND MST.MSTDOCNUM = SHPDTL.MSTDOCNUM(+)
  AND MST.DOCOWRIDR = SHPDTL.DOCOWRIDR(+)
  AND MST.SEQNUM    = SHPDTL.SEQNUM(+)
  AND MST.DUPNUM    = SHPDTL.DUPNUM(+)
				
				and ARPSHP.ARPCOD (+)   =?
				AND DMGSRY.ARPCOD(+) = ?							
			    AND 
IMPFLT.FLTCARIDR = ?
				AND IMPFLT.FLTNUM = ?
				AND IMPFLT.FLTSEQNUM = ?
				AND IMPFLT.LEGSERNUM = ?
				AND IMPFLT.ARPCOD = ?
				AND IMPFLT.CMPCOD = ?


		]]>
	 </QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>299</QRY:Id>
	 <QRY:Source Name="operations.shipment.findflightdiscrepancyfornotfinalized_part2" Type="NATIVE">
				<![CDATA[
			SELECT IMPFLT.CMPCOD,
  IMPFLT.FLTNUM ,
  IMPFLT.FLTCARIDR ,
  IMPFLT.FLTSEQNUM ,
  (
  CASE
    WHEN MST.PARSEQNUM > 0
    THEN ''
    ELSE MST.SHPPFX
  END) SHPPFX  ,
  MST.DOCOWRIDR,
  (
  CASE
    WHEN MST.PARSEQNUM > 0
    THEN MST.MSTDOCNUM
      ||'/'
      ||MST.DOCNUM
    ELSE MST.MSTDOCNUM
  END) MSTDOCNUM         ,
  MST.SEQNUM             ,
  MST.DUPNUM             ,
  NULL DISCOD ,
  NULL CRTTIM ,
  NULL CLSDAT ,
  MST.ORGCOD,
  MST.DSTCOD,
  MST.STDPCS AS SUMSTDPCS,
  MST.STDWGT AS SUMSTDWGT,
  DMG.DMGCOD ,
  DMG.DISDAT DMGDISDAT ,
  DMG.RMK DMGRMK ,
  DMG.DISSTA DMGDISSTA ,
  DMG.DMGPCS ,
  NULL FNDSHPNUM ,
  NULL FSTOTDISPCS,
  NULL FSTOTDISWGT,
  NULL FSTOTRSLPCS,
  NULL FSTOTRSLWGT,
  NULL FSDMGCOD ,
  NULL FSDISDAT ,
  NULL FSORGCOD,
  NULL FSDSTCOD,
  NULL ATA ,
  NULL FLTROU ,
  NULL FLTDAT ,
  NULL DISSTA ,
  DMG.DISSEQNUM DMGSEQNUM ,
  MST.SHPDES ,
  MST.SCCCOD ,
  IMPFLT.ARPCOD ,
  IMPFLT.FLTCARCOD ,
  IMPFLT.FLTOPRSTA,
  IMPFLT.FLTCHGNAM,
  NULL IMGPTH,
  (
  CASE
    WHEN DMGSRY.CDSSTA = 'I'
    THEN 'ISSUED'
    ELSE 'PENDING'
  END) CDSSTA,
  NULL bdncplflg,
  0 SUMMFTPCS,
  0 SUMMFTWGT,
  0 SUMRCVPCS,
  0 SUMRCVWGT,
  DISBLB.IMGSEQNUM,
  NULL PLTUSEFLG,
 NULL DTLPLTFLG,
  MST.PLTFLG PLTFLG
FROM OPRARPIMPFLT IMPFLT,
  OPRSHPMST MST,
  OPRDMGDIS DMG,
  OPRDMGSRYDTL DMGSRY,
  OPRDMGDISBLB DISBLB
WHERE MST.CMPCOD        = DMG.CMPCOD
AND MST.DOCOWRIDR       = DMG.DOCOWRIDR
AND MST.MSTDOCNUM       = DMG.MSTDOCNUM
AND MST.DUPNUM          = DMG.DUPNUM
AND MST.SEQNUM          = DMG.SEQNUM
AND DMGSRY.CMPCOD(+)    = DMG.CMPCOD
AND DMGSRY.DOCOWRIDR(+) = DMG.DOCOWRIDR
AND DMGSRY.MSTDOCNUM(+) = DMG.MSTDOCNUM
AND DMGSRY.SEQNUM(+)    = DMG.SEQNUM
AND DMGSRY.DUPNUM(+)    = DMG.DUPNUM
AND DMGSRY.DISSEQNUM(+) = DMG.DISSEQNUM
AND DMGSRY.ARPCOD(+)    = ?
AND IMPFLT.CMPCOD       = DMG.CMPCOD
AND IMPFLT.FLTNUM       = DMG.FLTNUM
AND IMPFLT.FLTSEQNUM    = DMG.FLTSEQNUM
AND IMPFLT.FLTCARIDR    = DMG.FLTCARIDR
AND IMPFLT.ARPCOD       = DMG.ARPCOD
AND DMG.CMPCOD          = DISBLB.CMPCOD(+)
AND DMG.DOCOWRIDR       = DISBLB.DOCOWRIDR(+)
AND DMG.MSTDOCNUM       = DISBLB.MSTDOCNUM(+)
AND DMG.SEQNUM          = DISBLB.SEQNUM(+)
AND DMG.DUPNUM          = DISBLB.DUPNUM(+)
AND DMG.ARPCOD          = DISBLB.ARPCOD(+)
AND DMG.DISSEQNUM       = DISBLB.DISSEQNUM(+)
AND IMPFLT.FLTCARIDR    = ?
AND IMPFLT.FLTNUM       = ?
AND IMPFLT.FLTSEQNUM    = ?
AND IMPFLT.LEGSERNUM    = ?
AND IMPFLT.ARPCOD       = ?
AND IMPFLT.CMPCOD       = ?
AND DMG.DMGCOD(+)      <> ?
		]]>
	 </QRY:Source>
	</QRY:Definition>
	
	
	

	<QRY:Definition>
		<QRY:Id>152</QRY:Id>
		 <QRY:Source Name="operations.shipment.cto.deliveryreturns" Type="NATIVE">
	<![CDATA[
		SELECT MST.CMPCOD, MST.DOCOWRIDR, MST.SHPPFX, MST.MSTDOCNUM, MST.DUPNUM,
		       MST.SEQNUM, MST.STDPCS, MST.STDWGT, MST.SCCCOD, MST.SHPDES, MST.ORGCOD,
		       MST.DSTCOD, DLVNOT.ARPCOD, DLVNOT.DLVNOTNUM, DLVNOT.DLVNOTPCS,
		       DLVNOT.DLVNOTWGT, DLVNOT.DLVNOTSTA, DLVNOT.DLVPCS, DLVNOT.DLVWGT,
		       MST.PLTFLG, DTL.PLTUSEFLG, DTL.TOTDLVNOTPCS, DTL.TOTDLVNOTWGT,
		       DTL.TOTDLVPCS, DTL.TOTDLVWGT, ARP.DNTUSEFLG,
		       DLVNOT.LSTUPDTIM DLVNOTLSTUPDTIM,
	   		   DTL.LSTUPDTIM SHPLSTUPDTIM,ARP.LSTUPDTIM ARPLSTUPDTIM,DLVULD.ULDNUM,
			   DLVULD.DLVPCS ULDDLVPCS,DLVULD.DLVWGT ULDDLVWGT,ARP.PLTUSEFLG ARPPLTUSEFLG
		  FROM OPRSHPMST MST, OPRSHPDLVNOT DLVNOT, OPRSHPDTL DTL, OPRARPSHP ARP,
		  OPRSHPDLVNOTULD DLVULD
		 WHERE MST.MSTDOCNUM = ARP.MSTDOCNUM(+)
		   AND MST.DOCOWRIDR = ARP.DOCOWRIDR(+)
		   AND MST.DUPNUM = ARP.DUPNUM(+)
		   AND MST.SEQNUM = ARP.SEQNUM(+)
		   AND MST.CMPCOD = ARP.CMPCOD(+)
		   AND ARP.MSTDOCNUM = DLVNOT.MSTDOCNUM(+)
		   AND ARP.DOCOWRIDR = DLVNOT.DOCOWRIDR(+)
		   AND ARP.DUPNUM = DLVNOT.DUPNUM(+)
		   AND ARP.SEQNUM = DLVNOT.SEQNUM(+)
		   AND ARP.CMPCOD = DLVNOT.CMPCOD(+)
		   AND ARP.ARPCOD = DLVNOT.ARPCOD(+)
		   AND MST.MSTDOCNUM = DTL.MSTDOCNUM(+)
		   AND MST.DOCOWRIDR = DTL.DOCOWRIDR(+)
		   AND MST.DUPNUM = DTL.DUPNUM(+)
		   AND MST.SEQNUM = DTL.SEQNUM(+)
		   AND MST.CMPCOD = DTL.CMPCOD(+)
		   AND DLVNOT.CMPCOD    = DLVULD.CMPCOD(+) 
		   AND DLVNOT.ARPCOD    = DLVULD.ARPCOD(+) 
		   AND DLVNOT.DLVNOTNUM = DLVULD.DLVNOTNUM(+)
		   AND MST.MSTDOCNUM = ?
		   AND MST.DOCOWRIDR = ?
		   AND MST.DUPNUM = ?
		   AND MST.SEQNUM = ?
		   AND MST.CMPCOD = ?
		   AND ARP.ARPCOD(+) = ?
   		   ]]>
		 </QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
		<QRY:Id>153</QRY:Id>
		 <QRY:Source Name="operaions.shipment.findShipmentDetailsForFAD" Type="NATIVE">
	<![CDATA[
		SELECT MST.ORGCOD,MST.DSTCOD,MST.SHPPFX,MST.MSTDOCNUM,MST.DOCOWRIDR,MST.CMPCOD,MST.STDWGT,SEGSHP.FLTCARIDR,
		SEGSHP.FLTNUM,SHPDIS.DISCOD SHPDISCOD,FLTDIS.DISCOD FLTDISCOD,FLTDIS.FLTCARCOD,SHPDIS.FLTCARCOD SHPCARCOD,
		DMGDIS.DMGCOD,DMGDIS.DMGPCS,DMGDIS.FLTCARCOD DMGCARCOD,
		SEG.POU,LEG.STD,LEG.LeGORG,LEG.LEGDST,SEGSHP.RCVPCS,SEGSHP.RCVWGT,MST.STDPCS,MST.STDWGTCOD,OTH.OTHSRVINF,
		CASE WHEN APHCODUSE=3 THEN THRAPHCOD ELSE TWOAPHCOD END CARCOD
		FROM OPRSHPMST  MST,OPRSEGSHP SEGSHP,OPRSHPDIS SHPDIS,OPRDMGDIS DMGDIS,
		FLTOPRLEG LEG, OPRSHPFLTDIS FLTDIS,OPRFLTSEG SEG,OPRSHPOTHSRV OTH,SHRARLMST ARLMST

		WHERE
		SEGSHP.CMPCOD = MST.CMPCOD
		 AND SEGSHP.DOCOWRIDR = MST.DOCOWRIDR
		 AND SEGSHP.MSTDOCNUM = MST.MSTDOCNUM
		 AND SEGSHP.SEQNUM = MST.SEQNUM
		 AND SEGSHP.DUPNUM = MST.DUPNUM
		 AND SEGSHP.CMPCOD = SEG.CMPCOD
		 AND SEG.FLTCARIDR = SEG.FLTCARIDR
		 AND SEGSHP.FLTNUM = SEG.FLTNUM
		 AND SEGSHP.SEGSERNUM = SEG.SEGSERNUM
		 AND SEGSHP.FLTSEQNUM = SEG.FLTSEQNUM
		 AND SEGSHP.CMPCOD = LEG.CMPCOD
		 AND SEGSHP.FLTCARIDR = LEG.FLTCARIDR
		 AND SEGSHP.FLTNUM = LEG.FLTNUM
		 AND SEGSHP.FLTSEQNUM=LEG.FLTSEQNUM
		 AND SEGSHP.CMPCOD = SHPDIS.CMPCOD(+)
		 AND SHPDIS.ARPCOD(+) =?
		 AND SEGSHP.MSTDOCNUM = SHPDIS.MSTDOCNUM(+)
		 AND SEGSHP.DOCOWRIDR = SHPDIS.DOCOWRIDR(+)
		 AND SEGSHP.SEQNUM = SHPDIS.SEQNUM(+)
		 AND SEGSHP.DUPNUM = SHPDIS.DUPNUM(+)
		 AND SEGSHP.CMPCOD = FLTDIS.CMPCOD(+)
		 AND FLTDIS.ARPCOD(+) =?
		 AND SEGSHP.DOCOWRIDR = FLTDIS.DOCOWRIDR(+)
		 AND SEGSHP.MSTDOCNUM = FLTDIS.MSTDOCNUM(+)
		 AND SEGSHP.SEQNUM = FLTDIS.SEQNUM(+)
		 AND SEGSHP.DUPNUM = FLTDIS.DUPNUM(+)
		 AND SEGSHP.FLTCARIDR = FLTDIS.FLTCARIDR(+)
		 AND SEGSHP.FLTNUM = FLTDIS.FLTNUM(+)
		 AND SEGSHP.FLTSEQNUM = FLTDIS.FLTSEQNUM(+)
		 AND DMGDIS.ARPCOD(+) =?
		 AND SEGSHP.DOCOWRIDR = DMGDIS.DOCOWRIDR(+)
		 AND SEGSHP.MSTDOCNUM = DMGDIS.MSTDOCNUM(+)
		 AND SEGSHP.SEQNUM = DMGDIS.SEQNUM(+)
		 AND SEGSHP.DUPNUM = DMGDIS.DUPNUM(+)
		 AND SEGSHP.FLTCARIDR = DMGDIS.FLTCARIDR(+)
		 AND SEGSHP.FLTNUM = DMGDIS.FLTNUM(+)
		 AND SEGSHP.FLTSEQNUM = DMGDIS.FLTSEQNUM(+)
		 AND MST.CMPCOD=OTH.CMPCOD(+)
		 AND MST.MSTDOCNUM= OTH.MSTDOCNUM(+)
		 AND MST.MSTDOCNUM=OTH.MSTDOCNUM(+)
		 AND MST.DUPNUM=OTH.DUPNUM(+)
		 AND MST.SEQNUM=OTH.SEQNUM(+)
		 AND FLTDIS.CLSDAT(+) IS NULL AND  SHPDIS.CLSDAT(+) IS NULL
		 AND ARLMST.ARLIDR=SEGSHP.FLTCARIDR
		 AND ARLMST.CMPCOD=SEGSHP.CMPCOD
		 AND FLTDIS.FADFLG(+)='Y'
		 AND SEGSHP.CMPCOD=?
		 AND SEG.POU=?
		 AND SEGSHP.MSTDOCNUM=?
		 AND SEGSHP.DOCOWRIDR=?
		 AND SEGSHP.SEQNUM=?
		 AND SEGSHP.DUPNUM=?
		 AND SEGSHP.FLTCARIDR =?
		 AND SEGSHP.FLTNUM = ?
		 AND SEGSHP.FLTSEQNUM =?
  		AND LEG.LEGSERNUM = ?
		]]>
		 </QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>154</QRY:Id>
	<QRY:Source Name="operaions.shipment.findShipmentDetailsForFDL" Type="NATIVE">
	<![CDATA[
	   SELECT MST.ORGCOD,
  MST.DSTCOD,
  MST.MSTDOCNUM,
  MST.DOCNUM,
  MST.STDWGT,
  SEGSHP.FLTCARIDR,
  SEGSHP.FLTNUM,
  MST.SHPPFX,
  FLTDIS.DISPCS,
  SHPDIS.DISCOD SHPDISCOD,
  FLTDIS.DISCOD FLTDISCOD,
  NULL DMGDISCOD,
  FLTDIS.RMK FLTDISRMK,
  NULL DMGDISRMK,
  (SELECT SUM(DMGPCS)
  FROM OPRDMGDIS DMGDIS
  WHERE DMGDIS.CMPCOD  = SEGSHP.CMPCOD
  AND DMGDIS.ARPCOD    = SEG.POU
  AND DMGDIS.FLTCARIDR = SEGSHP.FLTCARIDR
  AND DMGDIS.FLTNUM    = SEGSHP.FLTNUM
  AND DMGDIS.FLTSEQNUM = SEGSHP.FLTSEQNUM
  AND DMGDIS.DOCOWRIDR = SEGSHP.DOCOWRIDR
  AND DMGDIS.MSTDOCNUM = SEGSHP.MSTDOCNUM
  AND DMGDIS.SEQNUM    = SEGSHP.SEQNUM
  AND DMGDIS.DUPNUM    = SEGSHP.DUPNUM
  ) DMGPCS,
  SEG.POU,
  LEG.STA,
  LEG.LEGORG,
  LEG.LEGDST,
  SEGSHP.RCVWGT,
  MST.STDWGTCOD,
  SEGSHP.RCVPCS ,
  MST.STDPCS,
  OTH.OTHSRVINF,
  CASE
    WHEN APHCODUSE=3
    THEN THRAPHCOD
    ELSE TWOAPHCOD
  END CARCOD
FROM OPRSHPMST MST,
  OPRSEGSHP SEGSHP,
  OPRSHPDIS SHPDIS,
  FLTOPRLEG LEG,
  OPRSHPFLTDIS FLTDIS,
  OPRFLTSEG SEG,
  OPRSHPOTHSRV OTH,
  SHRARLMST ARLMST
WHERE SEGSHP.CMPCOD   = MST.CMPCOD
AND SEGSHP.DOCOWRIDR  = MST.DOCOWRIDR
AND SEGSHP.MSTDOCNUM  = MST.MSTDOCNUM
AND SEGSHP.SEQNUM     = MST.SEQNUM
AND SEGSHP.DUPNUM     = MST.DUPNUM
AND SEGSHP.CMPCOD     = SEG.CMPCOD
AND SEGSHP.FLTCARIDR     = SEG.FLTCARIDR
AND SEGSHP.FLTNUM     = SEG.FLTNUM
AND SEGSHP.SEGSERNUM  = SEG.SEGSERNUM
AND SEGSHP.FLTSEQNUM  = SEG.FLTSEQNUM
AND SEGSHP.CMPCOD     = LEG.CMPCOD
AND SEGSHP.FLTCARIDR  = LEG.FLTCARIDR
AND SEGSHP.FLTNUM     = LEG.FLTNUM
AND SEGSHP.FLTSEQNUM  =LEG.FLTSEQNUM
AND SEGSHP.CMPCOD     = SHPDIS.CMPCOD(+)
AND SHPDIS.ARPCOD(+)  = ?
AND SEGSHP.MSTDOCNUM  = SHPDIS.MSTDOCNUM(+)
AND SEGSHP.DOCOWRIDR  = SHPDIS.DOCOWRIDR(+)
AND SEGSHP.SEQNUM     = SHPDIS.SEQNUM(+)
AND SEGSHP.DUPNUM     = SHPDIS.DUPNUM(+)
AND SEGSHP.CMPCOD     = FLTDIS.CMPCOD(+)
AND FLTDIS.ARPCOD(+)  = ?
AND SEGSHP.DOCOWRIDR  = FLTDIS.DOCOWRIDR(+)
AND SEGSHP.MSTDOCNUM  = FLTDIS.MSTDOCNUM(+)
AND SEGSHP.SEQNUM     = FLTDIS.SEQNUM(+)
AND SEGSHP.DUPNUM     = FLTDIS.DUPNUM(+)
AND SEGSHP.FLTCARIDR  = FLTDIS.FLTCARIDR(+)
AND SEGSHP.FLTNUM     = FLTDIS.FLTNUM(+)
AND SEGSHP.FLTSEQNUM  = FLTDIS.FLTSEQNUM(+)
AND MST.CMPCOD        =OTH.CMPCOD(+)
AND MST.MSTDOCNUM     = OTH.MSTDOCNUM(+)
AND MST.MSTDOCNUM     =OTH.MSTDOCNUM(+)
AND MST.DUPNUM        =OTH.DUPNUM(+)
AND MST.SEQNUM        =OTH.SEQNUM(+)
AND FLTDIS.CLSDAT(+) IS NULL
AND SHPDIS.CLSDAT(+) IS NULL
AND (FLTDIS.DISCOD   IS NOT NULL
OR SHPDIS.DISCOD     IS NOT NULL)
AND ARLMST.CMPCOD     =SEGSHP.CMPCOD
AND ARLMST.ARLIDR     =SEGSHP.FLTCARIDR
AND FLTDIS.FDLFLG(+)  ='Y'
AND SEGSHP.CMPCOD     = ?
AND SEG.POU           = ?
AND SEGSHP.FLTCARIDR  = ?
AND SEGSHP.FLTNUM     = ?
AND SEGSHP.FLTSEQNUM  = ?
AND LEG.LEGSERNUM     = ?
UNION

SELECT MST.ORGCOD,
  MST.DSTCOD,
  MST.MSTDOCNUM,
  MST.DOCNUM,
  MST.STDWGT,
  SEGSHP.FLTCARIDR,
  SEGSHP.FLTNUM,
  MST.SHPPFX,
  DMG.DMGPCS,
  NULL SHPDISCOD,
  NULL FLTDISCOD,
  DMG.DMGCOD DMGDISCOD,
  NULL FLTDISRMK,
  DMG.RMK DMGDISRMK,
  (SELECT SUM(DMGPCS)
  FROM OPRDMGDIS DMGDIS
  WHERE DMGDIS.CMPCOD  = SEGSHP.CMPCOD
  AND DMGDIS.ARPCOD    = SEG.POU
  AND DMGDIS.FLTCARIDR = SEGSHP.FLTCARIDR
  AND DMGDIS.FLTNUM    = SEGSHP.FLTNUM
  AND DMGDIS.FLTSEQNUM = SEGSHP.FLTSEQNUM
  AND DMGDIS.DOCOWRIDR = SEGSHP.DOCOWRIDR
  AND DMGDIS.MSTDOCNUM = SEGSHP.MSTDOCNUM
  AND DMGDIS.SEQNUM    = SEGSHP.SEQNUM
  AND DMGDIS.DUPNUM    = SEGSHP.DUPNUM
  ) DMGPCS,
  SEG.POU,
  LEG.STA,
  LEG.LEGORG,
  LEG.LEGDST,
  SEGSHP.RCVWGT,
  MST.STDWGTCOD,
  SEGSHP.RCVPCS ,
  MST.STDPCS,
  OTH.OTHSRVINF,
  CASE
    WHEN APHCODUSE=3
    THEN THRAPHCOD
    ELSE TWOAPHCOD
  END CARCOD
FROM OPRSHPMST MST,
  OPRSEGSHP SEGSHP,
OPRDMGDIS DMG,
  FLTOPRLEG LEG,
  OPRFLTSEG SEG,
  OPRSHPOTHSRV OTH,
  SHRARLMST ARLMST
WHERE SEGSHP.CMPCOD   = MST.CMPCOD
AND SEGSHP.DOCOWRIDR  = MST.DOCOWRIDR
AND SEGSHP.MSTDOCNUM  = MST.MSTDOCNUM
AND SEGSHP.SEQNUM     = MST.SEQNUM
AND SEGSHP.DUPNUM     = MST.DUPNUM
AND SEGSHP.CMPCOD     = SEG.CMPCOD
AND SEGSHP.FLTCARIDR     = SEG.FLTCARIDR
AND SEGSHP.FLTNUM     = SEG.FLTNUM
AND SEGSHP.SEGSERNUM  = SEG.SEGSERNUM
AND SEGSHP.FLTSEQNUM  = SEG.FLTSEQNUM
AND SEGSHP.CMPCOD     = LEG.CMPCOD
AND SEGSHP.FLTCARIDR  = LEG.FLTCARIDR
AND SEGSHP.FLTNUM     = LEG.FLTNUM
AND SEGSHP.FLTSEQNUM  =LEG.FLTSEQNUM
AND SEGSHP.CMPCOD     = DMG.CMPCOD(+)
AND DMG.ARPCOD(+)  = ?
AND SEGSHP.MSTDOCNUM  = DMG.MSTDOCNUM(+)
AND SEGSHP.DOCOWRIDR  = DMG.DOCOWRIDR(+)
AND SEGSHP.SEQNUM     = DMG.SEQNUM(+)
AND SEGSHP.DUPNUM     = DMG.DUPNUM(+)
AND SEGSHP.CMPCOD     = DMG.CMPCOD(+)
AND SEGSHP.FLTCARIDR     = DMG.FLTCARIDR(+)
AND SEGSHP.FLTNUM     = DMG.FLTNUM(+)
AND SEGSHP.FLTSEQNUM  = DMG.FLTSEQNUM(+)
AND MST.CMPCOD        =OTH.CMPCOD(+)
AND MST.MSTDOCNUM     = OTH.MSTDOCNUM(+)
AND MST.MSTDOCNUM     =OTH.MSTDOCNUM(+)
AND MST.DUPNUM        =OTH.DUPNUM(+)
AND MST.SEQNUM        =OTH.SEQNUM(+)
AND DMG.CLSDAT(+) IS NULL
AND DMG.DMGCOD     IS NOT NULL
AND ARLMST.CMPCOD     =SEGSHP.CMPCOD
AND ARLMST.ARLIDR     =SEGSHP.FLTCARIDR
AND SEGSHP.CMPCOD     = ?
AND SEG.POU           = ?
AND SEGSHP.FLTCARIDR  = ?
AND SEGSHP.FLTNUM     = ?
AND SEGSHP.FLTSEQNUM  = ?
AND LEG.LEGSERNUM     = ?
			]]>
		 </QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
		<QRY:Id>155</QRY:Id>
		 <QRY:Source Name="operations.shipment.discrepancy.findtracingdetails" Type="NATIVE">
		<![CDATA[
			SELECT
			   SHP.CMPCOD, FLT.ARPCOD,
			   FLT.FLTCARCOD, SHP.FLTCARIDR,  SHP.FLTNUM, FLT.FLTDAT,
			   COALESCE(LEG.ATA, LEG.STA) ARRTIM, SHP.FLTSEQNUM, SHP.SEGSERNUM,
			   SHP.SHPPFX, SHP.DOCOWRIDR, SHP.MSTDOCNUM, SHP.DUPNUM, SHP.SEQNUM, MST.ORGCOD, SEG.POL, MST.DSTCOD, MST.SCCCOD,
		       SUM(SHP.MFTPCS) MFTPCS ,SUM(MST.STDPCS) STDPCS , SUM(MST.STDWGT) STDWGT,  SUM(SHP.RCVPCS) RCVPCS, SUM(SHP.RCVWGT),
			   FND.FNDSHPNUM, FND.TOTDISPCS, FND.TOTDISWGT
			FROM
				 OPRSEGSHP SHP, OPRARPIMPFLT FLT,
				 FLTOPRLEG LEG, OPRFLTSEG SEG,
				 OPRFNDSHP FND, OPRSHPMST  MST
			WHERE
				 SHP.CMPCOD = MST.CMPCOD
				 AND SHP.MSTDOCNUM = MST.MSTDOCNUM
				 AND SHP.DOCOWRIDR = MST.DOCOWRIDR
				 AND SHP.DUPNUM = MST.DUPNUM
				 AND SHP.SEQNUM = MST.SEQNUM
				 AND SHP.CMPCOD = FLT.CMPCOD
				 AND SHP.FLTCARIDR = FLT.FLTCARIDR
				 AND SHP.FLTNUM = FLT.FLTNUM
				 AND SHP.FLTSEQNUM = FLT.FLTSEQNUM
				 AND SHP.CMPCOD = LEG.CMPCOD
				 AND SHP.FLTCARIDR = LEG.FLTCARIDR
				 AND SHP.FLTNUM = LEG.FLTNUM
				 AND SHP.FLTSEQNUM = LEG.FLTSEQNUM
				 AND FLT.LEGSERNUM = LEG.LEGSERNUM
				 AND SHP.CMPCOD = SEG.CMPCOD
				 AND SHP.FLTCARIDR = SEG.FLTCARIDR
				 AND SHP.FLTNUM = SEG.FLTNUM
				 AND SHP.FLTSEQNUM = SEG.FLTSEQNUM
				 AND SHP.SEGSERNUM = SEG.SEGSERNUM
				 AND SHP.CMPCOD = FND.CMPCOD (+)
				 AND SHP.FLTCARIDR = FND.FLTCARIDR (+)
				 AND SHP.FLTNUM = FND.FLTNUM (+)
				 AND SHP.FLTSEQNUM = FND.FLTSEQNUM (+)
				 AND SHP.CMPCOD = ?
				 AND FLT.ARPCOD = ?
				 AND SEG.POU = ?
			]]>
		 </QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>156</QRY:Id>
	<QRY:Source Name="operations.shipment.cto.findforcecloseawbdetails" Type="NATIVE">
		<![CDATA[
		SELECT
			      MST.CMPCOD,MST.DOCOWRIDR,MST.MSTDOCNUM,
                        MST.SEQNUM,MST.DUPNUM,MST.SHPPFX,
                        MST.STDPCS,MST.STDWGT,MST.SHPDES,MST.FRCCLSRMK,MST.FRCCLSFLG,
                        MST.SHPNAM,MST.CNSNAM, ARPSHP.TOTDLVPCS,ARPSHP.ARPCOD,
						(CASE WHEN ORGCOD = ARPSHP.ARPCOD THEN ARPSHP.MFTPCS ELSE
							ORGARPSHP.MFTPCS END )  MFTPCS,
                        (CASE WHEN ORGCOD = ARPSHP.ARPCOD THEN
                        	ARPSHP.AVLPCS+ARPSHP.BDPPCS-ARPSHP.MFTPCS ELSE ARPSHP.RCVPCS  END ) ACTPCS ,
                        SHPDIS.DISCOD DOCDISCOD,FLTDIS.DISCOD OPRDISCOD,
                        (SELECT COUNT(*) FROM OPRSHPMST  HOU WHERE
                        HOU.CMPCOD = MST.CMPCOD
                        AND HOU.DOCOWRIDR = MST.DOCOWRIDR
                        AND HOU.MSTDOCNUM = MST.MSTDOCNUM
                        AND HOU.DUPNUM = MST.DUPNUM
                        AND HOU.SEQNUM > 1
                        AND HOU.PARSEQNUM > 0 ) HOUCNT,
                        MST.LSTUPDTIM
                        FROM OPRARPSHP ARPSHP, OPRSHPMST  MST,
                        OPRSHPFLTDIS FLTDIS , OPRSHPDIS SHPDIS,OPRARPSHP ORGARPSHP
                        WHERE
                        ARPSHP.CMPCOD = MST.CMPCOD
                        AND ARPSHP.DOCOWRIDR = MST.DOCOWRIDR
                        AND ARPSHP.MSTDOCNUM = MST.MSTDOCNUM
                        AND ARPSHP.SEQNUM = MST.SEQNUM
                        AND ARPSHP.DUPNUM = MST.DUPNUM
                        AND MST.CMPCOD = ORGARPSHP.CMPCOD(+)
                        AND MST.DOCOWRIDR = ORGARPSHP.DOCOWRIDR(+)
                        AND MST.MSTDOCNUM = ORGARPSHP.MSTDOCNUM(+)
                        AND MST.SEQNUM = ORGARPSHP.SEQNUM(+)
                        AND MST.DUPNUM = ORGARPSHP.DUPNUM(+)
			AND MST.ORGCOD =   ORGARPSHP.ARPCOD(+)
                        AND ARPSHP.CMPCOD = SHPDIS.CMPCOD(+)
                        AND ARPSHP.ARPCOD = SHPDIS.ARPCOD(+)
                        AND ARPSHP.DOCOWRIDR = SHPDIS.DOCOWRIDR(+)
                        AND ARPSHP.MSTDOCNUM = SHPDIS.MSTDOCNUM(+)
                        AND ARPSHP.SEQNUM = SHPDIS.SEQNUM(+)
                        AND ARPSHP.DUPNUM = SHPDIS.DUPNUM(+)
                        AND ARPSHP.CMPCOD = FLTDIS.CMPCOD(+)
                        AND ARPSHP.ARPCOD = FLTDIS.ARPCOD(+)
                        AND ARPSHP.DOCOWRIDR = FLTDIS.DOCOWRIDR(+)
                        AND ARPSHP.MSTDOCNUM = FLTDIS.MSTDOCNUM(+)
                        AND ARPSHP.SEQNUM = FLTDIS.SEQNUM(+)
                        AND ARPSHP.DUPNUM = FLTDIS.DUPNUM(+)
                        AND SHPDIS.CLSDAT(+) IS NULL
                        AND FLTDIS.CLSDAT(+) IS NULL
                        AND ARPSHP.CMPCOD = ?
                        AND ARPSHP.ARPCOD = ?
                        AND ARPSHP.DOCOWRIDR = ?
                        AND ARPSHP.MSTDOCNUM = ?
                        AND ARPSHP.SEQNUM = ?
                        AND ARPSHP.DUPNUM = ?
		]]>
	</QRY:Source>
</QRY:Definition>

<QRY:Definition>
	<QRY:Id>157</QRY:Id>
	<QRY:Source Name="operations.shipment.cto.finddocumentandpcsdiscrepancy" Type="NATIVE">
		<![CDATA[
	SELECT FLTDIS.FLTNUM FLTDISFLTNUM, FLTDIS.MSTDOCNUM FLTDISMSTDOCNUM,
	       FLTDIS.DOCOWRIDR FLTDISDOCOWRIDR, FLTDIS.FLTSEQNUM FLTDISFLTSEQNUM,
	       FLTDIS.FLTCARIDR FLTDISFLTCARIDR, FLTDIS.LEGSERNUM FLTDISLEGSERNUM,
	       FLTDIS.DISSEQNUM FLTDISDISSEQNUM, FLTDIS.SEQNUM FLTDISSEQNUM,
	       FLTDIS.DUPNUM FLTDISDUPNUM, FLTDIS.ARPCOD FLTDISARPCOD,
	       FLTDIS.CMPCOD FLTDISCMPCOD, FLTDIS.DISCOD FLTDISDISCOD,
	       FLTDIS.DISSTA FLTDISDISSTA, FLTDIS.FDLFLG FLTDISFDLFLG,
	       FLTDIS.FADFLG FLTDISFADFLG, FLTDIS.REMFLG FLTDISREMFLG,
	       FLTDIS.TRCFLG FLTDISTRCFLG, SHPDIS.FLTNUM SHPDISFLTNUM,
	       SHPDIS.MSTDOCNUM SHPDISMSTDOCNUM, SHPDIS.DOCOWRIDR SHPDISDOCOWRIDR,
	       SHPDIS.FLTSEQNUM SHPDISFLTSEQNUM, SHPDIS.FLTCARIDR SHPDISFLTCARIDR,
	       SHPDIS.LEGSERNUM SHPDISLEGSERNUM, SHPDIS.SEQNUM SHPDISSEQNUM,
	       SHPDIS.DUPNUM SHPDISDUPNUM, SHPDIS.ARPCOD SHPDISARPCOD,
	       SHPDIS.CMPCOD SHPDISCMPCOD, SHPDIS.DISCOD SHPDISDISCOD,
	       SHPDIS.DISSTA SHPDISDISSTA, SHPDIS.FDLFLG SHPDISFDLFLG,
	       SHPDIS.FADFLG SHPDISFADFLG, SHPDIS.REMFLG SHPDISREMFLG
	  FROM OPRSHPFLTDIS FLTDIS, OPRARPSHP ARPSHP, OPRSHPDIS SHPDIS
	 WHERE ARPSHP.MSTDOCNUM = FLTDIS.MSTDOCNUM(+)
	   AND ARPSHP.DOCOWRIDR = FLTDIS.DOCOWRIDR(+)
	   AND ARPSHP.DUPNUM = FLTDIS.DUPNUM(+)
	   AND ARPSHP.SEQNUM = FLTDIS.SEQNUM(+)
	   AND ARPSHP.CMPCOD = FLTDIS.CMPCOD(+)
	   AND ARPSHP.ARPCOD = FLTDIS.ARPCOD(+)
	   AND ARPSHP.MSTDOCNUM = SHPDIS.MSTDOCNUM(+)
	   AND ARPSHP.DOCOWRIDR = SHPDIS.DOCOWRIDR(+)
	   AND ARPSHP.DUPNUM = SHPDIS.DUPNUM(+)
	   AND ARPSHP.SEQNUM = SHPDIS.SEQNUM(+)
	   AND ARPSHP.CMPCOD = SHPDIS.CMPCOD(+)
	   AND ARPSHP.ARPCOD = SHPDIS.ARPCOD(+)
	   AND (FLTDIS.DISCOD IS NOT NULL OR FLTDIS.DISCOD IS NOT NULL)
	   AND ARPSHP.MSTDOCNUM = ?
	   AND ARPSHP.DOCOWRIDR = ?
	   AND ARPSHP.DUPNUM = ?
	   AND ARPSHP.SEQNUM = ?
	   AND ARPSHP.CMPCOD = ?
	   AND ARPSHP.ARPCOD = ?
   ]]>
</QRY:Source>
</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>158</QRY:Id>
	<QRY:Source Name="operaions.shipment.findShipmentDetailsForFSUDIS" Type="NATIVE">
		<![CDATA[
		SELECT MST.SHPPFX, MST.MSTDOCNUM, MST.ORGCOD, MST.DSTCOD, MST.STDWGT, SEGSHP.FLTNUM,
			SHPDIS.FLTCARCOD SHPCARCOD, FLTDIS.FLTCARCOD, MST.STDWGTCOD, MST.STDPCS, SHPDIS.DISCOD SHPDISCOD,
			FLTDIS.DISCOD FLTDISCOD, SEG.POU, SEGSHP.RCVWGT, SEGSHP.RCVPCS, SHPDIS.CRTTIM SHPCRTTIM,
			FLTDIS.CRTTIM FLTCRTTIM, FLTDIS.DISPCS, FLTDIS.DISWGT, MST.AGTCOD, AGTGRP.GRPNAM AGTGRP, MST.CNSCOD,
			CUSMST.CUSGRP CNSGRP, MST.OWRCOD
		FROM OPRSHPMST MST,
			OPRSEGSHP SEGSHP,
			OPRSHPDIS SHPDIS,
			OPRARPIMPFLT IMPFLT,
			OPRFLTSEG SEG,
			OPRSHPFLTDIS FLTDIS,
			SHRCUSMST CUSMST,
			SHRGENMSTGRPDTL AGTGRP
		WHERE SEGSHP.CMPCOD = MST.CMPCOD
			AND SEGSHP.DOCOWRIDR = MST.DOCOWRIDR
			AND SEGSHP.MSTDOCNUM = MST.MSTDOCNUM
			AND SEGSHP.SEQNUM = MST.SEQNUM
			AND SEGSHP.DUPNUM = MST.DUPNUM
			AND SEGSHP.CMPCOD = SEG.CMPCOD
			AND SEG.FLTCARIDR = SEG.FLTCARIDR
			AND SEGSHP.FLTNUM = SEG.FLTNUM
			AND SEGSHP.SEGSERNUM = SEG.SEGSERNUM
			AND SEGSHP.FLTSEQNUM = SEG.FLTSEQNUM
			AND SEGSHP.CMPCOD = SHPDIS.CMPCOD(+)
			AND SHPDIS.ARPCOD(+) = ?
			AND SEGSHP.MSTDOCNUM = SHPDIS.MSTDOCNUM(+)
			AND SEGSHP.DOCOWRIDR = SHPDIS.DOCOWRIDR(+)
			AND SEGSHP.SEQNUM = SHPDIS.SEQNUM(+)
			AND SEGSHP.DUPNUM = SHPDIS.DUPNUM(+)
			AND SEGSHP.CMPCOD = FLTDIS.CMPCOD(+)
			AND FLTDIS.ARPCOD(+) = ?
			AND SEGSHP.DOCOWRIDR = FLTDIS.DOCOWRIDR(+)
			AND SEGSHP.MSTDOCNUM = FLTDIS.MSTDOCNUM(+)
			AND SEGSHP.SEQNUM = FLTDIS.SEQNUM(+)
			AND SEGSHP.DUPNUM = FLTDIS.DUPNUM(+)
			AND SEGSHP.FLTCARIDR = FLTDIS.FLTCARIDR(+)
			AND SEGSHP.FLTNUM = FLTDIS.FLTNUM(+)
			AND SEGSHP.FLTSEQNUM = FLTDIS.FLTSEQNUM(+)
			AND SEGSHP.CMPCOD = IMPFLT.CMPCOD
			AND SEGSHP.FLTCARIDR = IMPFLT.FLTCARIDR
			AND SEGSHP.FLTNUM = IMPFLT.FLTNUM
			AND SEGSHP.FLTSEQNUM = IMPFLT.FLTSEQNUM
			AND MST.CMPCOD = CUSMST.CMPCOD(+)
			AND MST.SHPCOD = CUSMST.CUSCOD(+)
			AND MST.CMPCOD = AGTGRP.CMPCOD(+)
			AND MST.AGTCOD = AGTGRP.GRPENT(+)
			AND AGTGRP.GRPCATCOD(+) = 'GEN'
			AND SEG.POU = IMPFLT.ARPCOD
			AND FLTDIS.CLSDAT(+) IS NULL
			AND SHPDIS.CLSDAT(+) IS NULL
			AND (   FLTDIS.DISCOD IS NOT NULL
				OR SHPDIS.DISCOD IS NOT NULL)
			AND MST.CMPCOD = ?
			AND IMPFLT.ARPCOD = ?
			AND MST.DOCOWRIDR = ?
			AND MST.MSTDOCNUM = ?
			AND MST.DUPNUM = ?
			AND MST.SEQNUM = ?
			AND IMPFLT.FLTCARIDR = ?
			AND IMPFLT.FLTNUM = ?
			AND IMPFLT.FLTSEQNUM = ?
			AND IMPFLT.LEGSERNUM = ?


   ]]>
</QRY:Source>
</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>159</QRY:Id>
	<QRY:Source Name="operaions.shipment.findShipmentDetailsForFDC" Type="NATIVE">
		<![CDATA[
		    SELECT
		    MST.SHPPFX,MST.MSTDOCNUM,MST.ORGCOD,MST.DSTCOD,MST.STDPCS,MST.STDWGT,
		   MST.STDWGTCOD WGTCOD,SEGSHP.FLTNUM,SEGSHP.RCVWGT,SEGSHP.RCVPCS,SEG.POU,OTH.OTHSRVINF,IMPFLT.FLTDAT,
		   CASE WHEN APHCODUSE=3 THEN THRAPHCOD ELSE TWOAPHCOD END CARCOD
		   FROM OPRSHPMST  MST,OPRSEGSHP SEGSHP,OPRARPIMPFLT IMPFLT,OPRFLTSEG SEG,OPRSHPOTHSRV OTH,SHRARLMST ARLMST
		   WHERE
	    	 SEGSHP.CMPCOD = MST.CMPCOD
			 AND SEGSHP.DOCOWRIDR = MST.DOCOWRIDR
			 AND SEGSHP.MSTDOCNUM = MST.MSTDOCNUM
			 AND SEGSHP.SEQNUM = MST.SEQNUM
			 AND SEGSHP.DUPNUM = MST.DUPNUM
			 AND SEGSHP.CMPCOD = SEG.CMPCOD
			 AND SEG.FLTCARIDR = SEG.FLTCARIDR
			 AND SEGSHP.FLTNUM = SEG.FLTNUM
			 AND SEGSHP.SEGSERNUM = SEG.SEGSERNUM
			 AND SEGSHP.FLTSEQNUM = SEG.FLTSEQNUM
			 AND SEGSHP.CMPCOD=IMPFLT.CMPCOD
		 	 AND SEGSHP.FLTCARIDR = IMPFLT.FLTCARIDR
		 	 AND SEGSHP.FLTNUM = IMPFLT.FLTNUM
		 	 AND SEGSHP.FLTSEQNUM = IMPFLT.FLTSEQNUM
			 AND SEG.POU=IMPFLT.ARPCOD
			 AND MST.CMPCOD=OTH.CMPCOD(+)
			 AND MST.MSTDOCNUM= OTH.MSTDOCNUM(+)
			 AND MST.MSTDOCNUM=OTH.MSTDOCNUM(+)
			 AND MST.DUPNUM=OTH.DUPNUM(+)
			 AND MST.SEQNUM=OTH.SEQNUM(+)
			 AND ARLMST.ARLIDR=SEGSHP.FLTCARIDR
			 AND ARLMST.CMPCOD=SEGSHP.CMPCOD
			 AND MST.CMPCOD=?
     		AND IMPFLT.ARPCOD=?
			AND MST.MSTDOCNUM=?
			AND MST.DOCOWRIDR=?
			AND MST.SEQNUM=?
			AND MST.DUPNUM=?
		 	AND IMPFLT.FLTCARIDR=?
		 	AND IMPFLT.FLTNUM = ?
		 	AND IMPFLT.FLTSEQNUM = ?
			AND IMPFLT.LEGSERNUM = ?
  	 ]]>
 	</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>160</QRY:Id>
	<QRY:Source Name="operations.shipment.cto.finddocumentdiscrepancy" Type="NATIVE">
	<![CDATA[
		select DIS.ARPCOD,DIS.DOCOWRIDR,DIS.MSTDOCNUM,DIS.SEQNUM,DIS.DUPNUM,DIS.DISCOD,DIS.DOCNUM,DIS.DISSTA,
				DIS.FLTCARCOD, DIS.FLTCARIDR, DIS.FLTDAT, DIS.FLTNUM, DIS.FLTSEQNUM, DIS.LEGSERNUM,DIS.DISRMK,DIS.LSTUPDTIM,
				DIS.DISPCS, DIS.DISWGT,MST.STDPCS,MST.STDWGT,MST.SCCCOD,MST.PRDNAM , DIS.DISTYP 
				 from OPRSHPMST MST 
		LEFT OUTER JOIN OPRSHPDIS DIS
		ON	DIS.CMPCOD = MST.CMPCOD
			AND DIS.DOCOWRIDR= MST.DOCOWRIDR
			AND DIS.MSTDOCNUM = MST.MSTDOCNUM
			AND DIS.SEQNUM = MST.SEQNUM
			AND DIS.DUPNUM = MST.DUPNUM
			AND DIS.DISTYP = ?
			AND DIS.ARPCOD = ?
		where	MST.CMPCOD = ?
		AND MST.DOCOWRIDR = ?
		AND MST.MSTDOCNUM = ?
		AND MST.SEQNUM    = ?
		AND MST.DUPNUM    = ?
  	]]>
 	</QRY:Source>
	</QRY:Definition>


	<QRY:Definition>
	<QRY:Id>161</QRY:Id>
	<QRY:Source Name="operations.shipment.finddisruptionchanged" Type="NATIVE">
		<![CDATA[

			SELECT MST.DUPNUM DUPNUM, MST.MSTDOCNUM MSTDOCNUM, MST.DOCOWRIDR DOCOWRIDR,
				MST.CMPCOD CMPCOD, MST.SEQNUM SEQNUM,MST.SHPPFX SHPPFX, MST.ORGCOD ORGCOD,
				MST.DSTCOD DSTCOD, ARPSHP.ARPCOD ARPCOD, BKGFLT.FLTORG FLTORG,
				BKGFLT.FLTDST FLTDST, ARPSHP.AVLPCS AVLPCS, ARPSHP.AVLWGT AVLWGT,
				ARPSHP.AVLVOL AVLVOL, SUM(SHP.MFTPCS) MFTPCS,SUM(SHP.MFTWGT) MFTWGT,
				SUM(SHP.MFTVOL) MFTVOL,BKGFLT.FLTCARCOD FLTCARCOD, MST.UBRNUM UBRNUM,
				BKGFLT.FLTCARIDR FLTCARIDR,BKGFLT.FLTNUM FLTNUM, BKGFLT.FLTSEQNUM FLTSEQNUM,
				BKGFLT.FLTDAT FLTDAT, BKGFLT.SEGSERNUM SEGSERNUM,LEG.ATD ATD

			FROM 	CAPBKGMST BKG,
				FLTOPRLEG LEG,
				OPRARPSHP ARPSHP,
				CAPBKGFLTDTL BKGFLT,
				OPRSHPMST  MST,
				OPRSEGSHP SHP
			WHERE 	MST.DUPNUM = ARPSHP.DUPNUM
				AND MST.MSTDOCNUM = ARPSHP.MSTDOCNUM
				AND MST.DOCOWRIDR = ARPSHP.DOCOWRIDR
				AND MST.CMPCOD = ARPSHP.CMPCOD
				AND MST.SEQNUM = ARPSHP.SEQNUM
				AND SHP.DUPNUM = ARPSHP.DUPNUM
				AND SHP.MSTDOCNUM = ARPSHP.MSTDOCNUM
				AND SHP.DOCOWRIDR = ARPSHP.DOCOWRIDR
				AND SHP.CMPCOD = ARPSHP.CMPCOD
				AND SHP.SEQNUM = ARPSHP.SEQNUM
				AND ARPSHP.DUPNUM = BKG.DUPNUM
				AND ARPSHP.MSTDOCNUM = BKG.MSTDOCNUM
				AND ARPSHP.DOCOWRIDR = BKG.DOCOWRIDR
				AND ARPSHP.CMPCOD = BKG.CMPCOD
				AND ARPSHP.SEQNUM = BKG.SEQNUM
				AND BKG.CMPCOD = BKGFLT.CMPCOD
				AND BKG.UBRNUM = BKGFLT.UBRNUM
				AND BKGFLT.CMPCOD = LEG.CMPCOD
				AND BKGFLT.FLTNUM = LEG.FLTNUM
				AND BKGFLT.FLTSEQNUM = LEG.FLTSEQNUM
				AND BKGFLT.FLTCARIDR = LEG.FLTCARIDR
				AND BKGFLT.FLTORG = ARPSHP.ARPCOD
				AND SHP.CMPCOD = LEG.CMPCOD
				AND SHP.FLTNUM = LEG.FLTNUM
				AND SHP.FLTSEQNUM = LEG.FLTSEQNUM
				AND SHP.FLTCARIDR = LEG.FLTCARIDR
				AND LEG.ATD IS NOT NULL
				AND ARPSHP.AVLPCS>0
		]]>
	</QRY:Source>
	</QRY:Definition>


	<QRY:Definition>
		<QRY:Id>161</QRY:Id>
		<QRY:Source Name="operations.shipment.cto.findopendiscrepancies" Type="NATIVE">
		<![CDATA[

		SELECT DIS.MSTDOCNUM DISMSTDOCNUM , FLTDIS.MSTDOCNUM FLTDISMSTDOCNUM
			  FROM OPRSHPDIS DIS, OPRSHPFLTDIS FLTDIS, OPRSEGSHP SEGSHP, OPRFLTSEG FLTSEG
			 WHERE FLTSEG.FLTNUM = SEGSHP.FLTNUM(+)
			   AND FLTSEG.FLTSEQNUM = SEGSHP.FLTSEQNUM(+)
			   AND FLTSEG.FLTCARIDR = SEGSHP.FLTCARIDR(+)
			   AND FLTSEG.SEGSERNUM = SEGSHP.SEGSERNUM(+)
			   AND FLTSEG.CMPCOD = SEGSHP.CMPCOD(+)
			   AND SEGSHP.CMPCOD = DIS.CMPCOD(+)
			   AND SEGSHP.DOCOWRIDR = DIS.DOCOWRIDR(+)
			   AND SEGSHP.MSTDOCNUM = DIS.MSTDOCNUM(+)
			   AND SEGSHP.SEQNUM = DIS.SEQNUM(+)
			   AND SEGSHP.DUPNUM = DIS.DUPNUM(+)
			   AND SEGSHP.CMPCOD = FLTDIS.CMPCOD(+)
			   AND SEGSHP.DOCOWRIDR = FLTDIS.DOCOWRIDR(+)
			   AND SEGSHP.MSTDOCNUM = FLTDIS.MSTDOCNUM(+)
			   AND SEGSHP.SEQNUM = FLTDIS.SEQNUM(+)
			   AND SEGSHP.DUPNUM = FLTDIS.DUPNUM(+)
			   AND SEGSHP.FLTNUM = FLTDIS.FLTNUM(+)
			   AND SEGSHP.FLTSEQNUM = FLTDIS.FLTSEQNUM(+)
			   AND SEGSHP.FLTCARIDR = FLTDIS.FLTCARIDR(+)
			   AND DIS.CLSDAT(+) IS NULL
			   AND FLTDIS.CLSDAT(+) IS NULL
			   AND (DIS.MSTDOCNUM IS NOT NULL OR FLTDIS.MSTDOCNUM IS NOT NULL)
			   AND FLTSEG.CMPCOD = ?
			   AND FLTSEG.POU = ? and
			   FLTSEG.FLTNUM = ?
			   AND FLTSEG.FLTSEQNUM = ?
			   AND FLTSEG.FLTCARIDR = ?


   ]]>
	 	</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>161</QRY:Id>
	<QRY:Source Name="operations.shipment.cto.findopenawbdiscrepancy" Type="NATIVE">
	<![CDATA[

	SELECT DIS.MSTDOCNUM DISMSTDOCNUM , FLTDIS.MSTDOCNUM FLTDISMSTDOCNUM
		  FROM OPRSHPDIS DIS, OPRSHPFLTDIS FLTDIS,
		  OPRSHPMST  MST
		 WHERE
		    MST.DOCOWRIDR = DIS.DOCOWRIDR(+)
		   AND MST.MSTDOCNUM = DIS.MSTDOCNUM(+)
		   AND MST.SEQNUM = DIS.SEQNUM(+)
		   AND MST.DUPNUM = DIS.DUPNUM(+)
		   AND MST.CMPCOD = DIS.CMPCOD(+)

		   AND MST.CMPCOD = FLTDIS.CMPCOD(+)
		   AND MST.DOCOWRIDR = FLTDIS.DOCOWRIDR(+)
		   AND MST.MSTDOCNUM = FLTDIS.MSTDOCNUM(+)
		   AND MST.SEQNUM = FLTDIS.SEQNUM(+)
		   AND MST.DUPNUM = FLTDIS.DUPNUM(+)

		   AND DIS.CLSDAT(+) IS NULL
		   AND FLTDIS.CLSDAT(+) IS NULL
		   AND (DIS.MSTDOCNUM IS NOT NULL OR FLTDIS.MSTDOCNUM IS NOT NULL)
		   AND MST.CMPCOD = ?
		   AND MST.DOCOWRIDR =?
		   AND MST.MSTDOCNUM = ?
		   AND MST.SEQNUM = ?
		   AND MST.DUPNUM =?
		   ]]>
	</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
		<QRY:Id>161</QRY:Id>
		<QRY:Source Name="operaions.shipment.findFoundShipmentDetailsForFDL" Type="NATIVE">
		<![CDATA[
		SELECT MST.ORGCOD,MST.DSTCOD,MST.MSTDOCNUM,MST.DOCNUM,MST.SHPPFX,
			FNDSHP.FLTCARIDR,FNDSHP.FLTNUM,SEG.POU,LEG.STA,LEG.LEGORG,LEG.LEGDST,
			FNDSHP.TOTDISWGT,MST.STDWGTCOD,
			FNDSHP.TOTDISPCS,FNDSHP.RMK,FNDSHP.ADLMRK,
			CASE WHEN APHCODUSE=3 THEN THRAPHCOD ELSE TWOAPHCOD END CARCOD,FNDSHPNUM
			FROM OPRSHPMST  MST,
			FLTOPRLEG LEG,OPRFLTSEG SEG,SHRARLMST ARLMST,OPRFNDSHP FNDSHP
		WHERE
			FNDSHP.FLTCARIDR = SEG.FLTCARIDR
			AND FNDSHP.FLTNUM = SEG.FLTNUM
			AND FNDSHP.FLTSEQNUM = SEG.FLTSEQNUM
			AND FNDSHP.CMPCOD = LEG.CMPCOD
			AND FNDSHP.FLTCARIDR = LEG.FLTCARIDR
			AND FNDSHP.FLTNUM = LEG.FLTNUM
			AND FNDSHP.FLTSEQNUM=LEG.FLTSEQNUM
			AND ARLMST.CMPCOD=MST.CMPCOD
			AND ARLMST.ARLIDR=FNDSHP.FLTCARIDR
			AND FNDSHP.ARPCOD=SEG.POU
			AND FNDSHP.CMPCOD=MST.CMPCOD
			AND MST.MSTDOCNUM= FNDSHP.FNDSHPNUM
			AND MST.DOCOWRIDR=-1
			AND MST.DUPNUM=1
			AND MST.SEQNUM=1
			AND MST.CMPCOD=?
			AND SEG.POU=?
			AND FNDSHP.FLTCARIDR= ?
			AND FNDSHP.FLTNUM = ?
			AND FNDSHP.FLTSEQNUM = ?
			AND LEG.LEGSERNUM =?

	]]>
	</QRY:Source>
	</QRY:Definition>


	<QRY:Definition>
		<QRY:Id>162</QRY:Id>
		<QRY:Source Name="operaions.shipment.findFoundShipmentDetailsForFAD" Type="NATIVE">
		<![CDATA[
		SELECT MST.ORGCOD,MST.DSTCOD,MST.MSTDOCNUM,MST.DOCNUM,MST.SHPPFX,
			FNDSHP.FLTCARIDR,FNDSHP.FLTNUM,SEG.POU,LEG.STD,LEG.LEGORG,LEG.LEGDST,
			FNDSHP.TOTDISWGT,MST.STDWGTCOD,
			FNDSHP.TOTDISPCS-FNDSHP.TOTRSLPCS FNDPCS,FNDSHP.TOTDISPCS,FNDSHP.TOTDISWGT,FNDSHP.RMK,FNDSHP.ADLMRK,
			CASE WHEN APHCODUSE=3 THEN THRAPHCOD ELSE TWOAPHCOD END CARCOD,FNDSHPNUM
			FROM OPRSHPMST  MST,
			FLTOPRLEG LEG,OPRFLTSEG SEG,SHRARLMST ARLMST,OPRFNDSHP FNDSHP
		WHERE
			FNDSHP.FLTCARIDR = SEG.FLTCARIDR
			AND FNDSHP.FLTNUM = SEG.FLTNUM
			AND FNDSHP.FLTSEQNUM = SEG.FLTSEQNUM
			AND FNDSHP.CMPCOD = LEG.CMPCOD
			AND FNDSHP.FLTCARIDR = LEG.FLTCARIDR
			AND FNDSHP.FLTNUM = LEG.FLTNUM
			AND FNDSHP.FLTSEQNUM=LEG.FLTSEQNUM
			AND ARLMST.CMPCOD=MST.CMPCOD
			AND ARLMST.ARLIDR=FNDSHP.FLTCARIDR
			AND FNDSHP.ARPCOD=SEG.POU
			AND FNDSHP.CMPCOD=MST.CMPCOD
			AND MST.MSTDOCNUM= FNDSHP.FNDSHPNUM
			AND MST.DOCOWRIDR=-1
			AND MST.DUPNUM=1
			AND MST.SEQNUM=1
			AND MST.CMPCOD=?
			AND SEG.POU=?
			AND FNDSHP.FNDSHPNUM=?
			AND FNDSHP.FLTCARIDR= ?
			AND FNDSHP.FLTNUM = ?
			AND FNDSHP.FLTSEQNUM = ?
			AND LEG.LEGSERNUM =?
	]]>
	</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>163</QRY:Id>
		<QRY:Source Name="operations.shipment.finddiscrepancylist.fltdis" Type="NATIVE">
		<![CDATA[
			SELECT NULL RESDOCNUM,NULL RESSHPPFX,NULL RESFLTNUM,NULL RESARLIDR,NULL RESFLTDAT,( CASE WHEN MST.PARSEQNUM > 0 THEN MST.MSTDOCNUM||'/'||MST.DOCNUM ELSE MST.MSTDOCNUM END) MSTDOCNUM,
			MST.DOCOWRIDR, MST.DUPNUM, MST.SEQNUM, MST.CMPCOD,
			( CASE WHEN MST.PARSEQNUM > 0 THEN '' ELSE MST.SHPPFX END) SHPPFX,
			MST.STDPCS,MST.STDWGT,DIS.ARPCOD, DIS.FLTCARIDR FLTCARIDR,
			DIS.FLTNUM FLTNUM, DIS.FLTSEQNUM FLTSEQNUM,DIS.FLTCARCOD FLTCARCOD,
			DIS.LEGSERNUM LEGSERNUM,DIS.FLTDAT FLTDAT,
			DIS.DISCOD DISCOD, DIS.CRTTIM CRTTIM,DIS.CLSDAT CLSDAT, DIS.DISSTA DISSTA,
			 DIS.RMK DISRMK, DIS.DISPCS DISPCS, DIS.DISWGT DISWGT,
			SEGSHP.MFTPCS,SEGSHP.RCVPCS,
		    SEGSHP.MFTWGT, MST.SCCCOD ,MST.CNSCOD,MST.ORGCOD,MST.DSTCOD, MST.PLTFLG, ARPSHP.PLTUSEFLG PLTUSEFLG, SHPDTL.PLTUSEFLG DTLPLTFLG
			FROM  OPRSHPMST  MST, OPRSHPFLTDIS DIS, OPRFLTSEG FLTSEG ,
			OPRSEGSHP SEGSHP ,OPRARPSHP ARPSHP, OPRSHPDTL SHPDTL
			WHERE DIS.CMPCOD = MST.CMPCOD
			AND DIS.DOCOWRIDR = MST.DOCOWRIDR
			AND DIS.MSTDOCNUM = MST.MSTDOCNUM
			AND DIS.SEQNUM = MST.SEQNUM
			AND DIS.DUPNUM = MST.DUPNUM
			AND DIS.CMPCOD = FLTSEG.CMPCOD
			AND DIS.FLTCARIDR = FLTSEG.FLTCARIDR
			AND DIS.FLTNUM = FLTSEG.FLTNUM
			AND DIS.FLTSEQNUM = FLTSEG.FLTSEQNUM
			AND DIS.ARPCOD = FLTSEG.POU
			AND FLTSEG.CMPCOD = SEGSHP.CMPCOD
			AND FLTSEG.FLTCARIDR = SEGSHP.FLTCARIDR
			AND FLTSEG.FLTNUM = SEGSHP.FLTNUM
			AND FLTSEG.FLTSEQNUM = SEGSHP.FLTSEQNUM
			AND FLTSEG.SEGSERNUM = SEGSHP.SEGSERNUM
			AND DIS.DOCOWRIDR = SEGSHP.DOCOWRIDR
			AND DIS.MSTDOCNUM = SEGSHP.MSTDOCNUM
			AND DIS.SEQNUM = SEGSHP.SEQNUM
			AND DIS.DUPNUM = SEGSHP.DUPNUM
			AND DIS.CMPCOD = ARPSHP.CMPCOD
			AND DIS.DOCOWRIDR = ARPSHP.DOCOWRIDR
			AND DIS.MSTDOCNUM = ARPSHP.MSTDOCNUM
			AND DIS.SEQNUM = ARPSHP.SEQNUM
			AND DIS.DUPNUM = ARPSHP.DUPNUM
			AND DIS.ARPCOD = ARPSHP.ARPCOD
			AND DIS.CMPCOD = SHPDTL.CMPCOD
			AND DIS.DOCOWRIDR = SHPDTL.DOCOWRIDR
			AND DIS.MSTDOCNUM = SHPDTL.MSTDOCNUM
			AND DIS.SEQNUM = SHPDTL.SEQNUM
			AND DIS.DUPNUM = SHPDTL.DUPNUM
			AND DIS.CMPCOD = ?
	]]>
	</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
		<QRY:Id>164</QRY:Id>
		<QRY:Source Name="operations.shipment.finddiscrepancylist.shpdis" Type="NATIVE">
		<![CDATA[
		SELECT NULL RESDOCNUM,NULL RESSHPPFX,NULL RESFLTNUM,NULL RESARLIDR,NULL RESFLTDAT,( CASE WHEN MST.PARSEQNUM > 0 THEN MST.MSTDOCNUM||'/'||MST.DOCNUM ELSE MST.MSTDOCNUM END) MSTDOCNUM,
		       MST.DOCOWRIDR, MST.DUPNUM, MST.SEQNUM, MST.CMPCOD,
		       ( CASE WHEN MST.PARSEQNUM > 0 THEN '' ELSE MST.SHPPFX END) SHPPFX,
		       MST.STDPCS,MST.STDWGT,DIS.ARPCOD, DIS.FLTCARIDR FLTCARIDR,
		       DIS.FLTNUM FLTNUM, DIS.FLTSEQNUM FLTSEQNUM,DIS.FLTCARCOD FLTCARCOD,
		       DIS.LEGSERNUM LEGSERNUM,DIS.FLTDAT FLTDAT,DIS.DISCOD DISCOD,
		       DIS.CRTTIM CRTTIM,DIS.CLSDAT CLSDAT, DIS.DISSTA DISSTA,DIS.DISRMK DISRMK,
		       DIS.DISPCS, DIS.DISWGT,0 MFTPCS,0 RCVPCS, ARPSHP.MFTWGT,
		       MST.SCCCOD ,MST.CNSCOD,MST.ORGCOD,MST.DSTCOD, MST.PLTFLG, ARPSHP.PLTUSEFLG PLTUSEFLG, NULL DTLPLTFLG
		FROM OPRSHPMST  MST, OPRSHPDIS DIS, OPRARPSHP ARPSHP
		WHERE DIS.CMPCOD = MST.CMPCOD
		   AND DIS.DOCOWRIDR = MST.DOCOWRIDR
		   AND DIS.MSTDOCNUM = MST.MSTDOCNUM
		   AND DIS.SEQNUM = MST.SEQNUM
		   AND DIS.DUPNUM = MST.DUPNUM
		   AND DIS.CMPCOD = ARPSHP.CMPCOD(+)
		   AND DIS.DOCOWRIDR = ARPSHP.DOCOWRIDR(+)
		   AND DIS.MSTDOCNUM = ARPSHP.MSTDOCNUM(+)
		   AND DIS.SEQNUM = ARPSHP.SEQNUM(+)
		   AND DIS.DUPNUM = ARPSHP.DUPNUM(+)
		   AND DIS.ARPCOD = ARPSHP.ARPCOD(+)
		   AND DIS.CMPCOD = ?
	]]>
	</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
		<QRY:Id>164</QRY:Id>
		<QRY:Source Name="operations.shipment.finddiscrepancylist.dmgdis" Type="NATIVE">
		<![CDATA[
		SELECT * from(SELECT
        (
        CASE
          WHEN MST.PARSEQNUM > 0
          THEN MST.MSTDOCNUM
            ||'/'
            ||MST.DOCNUM
          ELSE MST.MSTDOCNUM
        END) MSTDOCNUM,
        MST.DOCOWRIDR,
        MST.DUPNUM,
        MST.SEQNUM,
        MST.CMPCOD,
        (
        CASE
          WHEN MST.PARSEQNUM > 0
          THEN ''
          ELSE MST.SHPPFX
        END) SHPPFX,
        DIS.ARPCOD,
        DIS.FLTCARIDR FLTCARIDR,
        DIS.FLTNUM FLTNUM,
        DIS.FLTSEQNUM FLTSEQNUM,
        DIS.FLTCARCOD FLTCARCOD,
        DIS.DISSEQNUM,
        DIS.FLTDAT FLTDAT,
        DIS.DISDAT CRTTIM,
        DIS.CLSDAT CLSDAT,
        DIS.DISSTA DISSTA,
        DIS.RMK DISRMK,
        DIS.DMGPCS DISPCS,
        0,
        ARPSHP.MFTPCS,
        ARPSHP.RCVPCS,
        NULL FSDMG,
        0 FSDMGPCS,
        ARPSHP.MFTWGT,
        MST.SCCCOD ,
        (
        CASE
          WHEN (SELECT COUNT(*)
            FROM OPRDMGDISBLB
            WHERE oprdmgdisblb.MSTDOCNUM=DIS.MSTDOCNUM
            AND oprdmgdisblb.SEQNUM     =DIS.SEQNUM
            AND oprdmgdisblb.DUPNUM     =DIS.DUPNUM
            AND oprdmgdisblb.DOCOWRIDR  =DIS.DOCOWRIDR
            AND oprdmgdisblb.CMPCOD     =DIS.CMPCOD
            AND oprdmgdisblb.ARPCOD     =DIS.ARPCOD
            AND oprdmgdisblb.disseqnum  = DIS.disseqnum ) > 0
          THEN 'Y'
          ELSE 'N'
        END) IMGAVL,
        MST.CNSCOD,
        (
        CASE
          WHEN DMG.CDSSTA = 'I'
          THEN 'ISSUED'
          ELSE 'PENDING'
        END) CDSSTA,
		  DIS.DISDAT,
         DIS.DMGCOD DISCOD,
		  MST.ORGCOD,
          MST.DSTCOD,
		   MST.PLTFLG
      FROM OPRSHPMST MST,
        OPRDMGDIS DIS,
        OPRARPSHP ARPSHP,
        OPRDMGSRYDTL DMG
		WHERE DIS.CMPCOD = MST.CMPCOD
		   AND DIS.DOCOWRIDR = MST.DOCOWRIDR
		   AND DIS.MSTDOCNUM = MST.MSTDOCNUM
		   AND DIS.SEQNUM = MST.SEQNUM
		   AND DIS.DUPNUM = MST.DUPNUM
		   AND DIS.CMPCOD = ARPSHP.CMPCOD(+)
		   AND DIS.DOCOWRIDR = ARPSHP.DOCOWRIDR(+)
		   AND DIS.MSTDOCNUM = ARPSHP.MSTDOCNUM(+)
		   AND DIS.SEQNUM = ARPSHP.SEQNUM(+)
		   AND DIS.DUPNUM = ARPSHP.DUPNUM(+)
		   AND DIS.ARPCOD = ARPSHP.ARPCOD(+)
		   AND DMG.CMPCOD = DIS.CMPCOD
		   AND DMG.DOCOWRIDR = DIS.DOCOWRIDR
		   AND DMG.MSTDOCNUM = DIS.MSTDOCNUM
		   AND DMG.SEQNUM = DIS.SEQNUM
		   AND DMG.DISSEQNUM = DIS.DISSEQNUM
		   AND DMG.DUPNUM = DIS.DUPNUM
		   AND DMG.ARPCOD = DIS.ARPCOD
   UNION 
     SELECT 
        MST.MSTDOCNUM,
        MST.DOCOWRIDR,
        MST.DUPNUM,
        MST.SEQNUM,
        MST.CMPCOD,
        NULL ,
        DIS.ARPCOD,
        DIS.FLTCARIDR FLTCARIDR,
        DIS.FLTNUM FLTNUM,
        DIS.FLTSEQNUM FLTSEQNUM,
        DIS.FLTCARCOD FLTCARCOD,
        0.DISSEQNUM,
        DIS.FLTDAT FLTDAT,
        DIS.DISDAT CRTTIM,
        NULL CLSDAT,
        DIS.FNDSHPSTA DISSTA,
        NULL  DISRMK,
        DIS.TOTDISPCS DISPCS,
        DIS.TOTDISWGT DISWGT,
        0 MFTPCS,
        0 RCVPCS,
        FNDSHPDMG.DMGCOD FSDMG,
        FNDSHPDMG.DMGPCS FSDMGPCS,
        0 MFTWGT,
        NULL SCCCOD ,
        NULL IMGVAL,
        NULL CNSCOD,
        NULL CDSSTA,
		DIS.DISDAT,
        NULL DISCOD,
		MST.ORGCOD,
        MST.DSTCOD,
		MST.PLTFLG  
      FROM OPRSHPMST MST,
        OPRFNDSHP DIS,
        OPRFNDSHPDMG FNDSHPDMG
      WHERE DIS.CMPCOD        = MST.CMPCOD
      AND DIS.FNDSHPNUM       = MST.MSTDOCNUM
      AND DIS.FNDSHPNUM       = FNDSHPDMG.FNDSHPNUM
      AND DIS.CMPCOD          = FNDSHPDMG.CMPCOD) A
		   WHERE A.CMPCOD = ?
	]]>
	</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
		<QRY:Id>164</QRY:Id>
		<QRY:Source Name="operations.shipment.finddiscrepancylist.fsdis" Type="NATIVE">
		<![CDATA[
		SELECT  fndres.mstdocnum RESDOCNUM,fndres.shppfx RESSHPPFX,fndres.fltnum RESFLTNUM,fndres.ARLIDR RESARLIDR,fndres.fltdat RESFLTDAT,
		MST.MSTDOCNUM, 
		MST.DOCOWRIDR, MST.DUPNUM, MST.SEQNUM, MST.CMPCOD,
		       NULL , 0 STDPCS, 0 STDWGT,DIS.ARPCOD, DIS.FLTCARIDR FLTCARIDR,
		       DIS.FLTNUM FLTNUM, DIS.FLTSEQNUM FLTSEQNUM,DIS.FLTCARCOD FLTCARCOD,
		       0 LEGSERNUM,DIS.FLTDAT FLTDAT,'FDSH' DISCOD, DIS.DISDAT CRTTIM,
		       NULL  CLSDAT, DIS.FNDSHPSTA DISSTA,DTL.RMK DISRMK,DIS.TOTDISPCS DISPCS,
		       DIS.TOTDISWGT DISWGT,0 MFTPCS,0 RCVPCS,
		      0 MFTWGT,DTL.SCC SCCCOD ,NULL CNSCOD,DTL.ORGCOD,DTL.DSTCOD, 
			   CASE WHEN FNDRES.MSTDOCNUM IS NOT NULL THEN (SELECT PLTFLG FROM OPRSHPMST WHERE
    OPRSHPMST.MSTDOCNUM= fndres.MSTDOCNUM 
       AND OPRSHPMST.CMPCOD= fndres.CMPCOD 
       AND OPRSHPMST.SEQNUM= fndres.SEQNUM 
       AND OPRSHPMST.DUPNUM= fndres.DUPNUM 
       AND OPRSHPMST.DOCOWRIDR= fndres.OWRIDR 
        )
        ELSE MST.PLTFLG END PLTFLG, NULL PLTUSEFLG, NULL DTLPLTFLG
		FROM OPRSHPMST  MST, OPRFNDSHP DIS, OPRFNDSHPRES fndres, OPRFNDSHPDTL DTL
		WHERE DIS.CMPCOD = MST.CMPCOD
		   AND DIS.FNDSHPNUM = MST.MSTDOCNUM
		   and MST.mstdocnum=fndres.FNDSHPNUM(+)
		   AND DIS.CMPCOD       = DTL.CMPCOD(+)
		   AND DIS.FNDSHPNUM      = DTL.FNDSHPNUM(+)
		   AND DIS.ARPCOD         = DTL.ARPCOD(+)
		   AND DTL.FNDSHPSERNUM(+) = 1
		   AND DIS.CMPCOD = ?
	]]>
	</QRY:Source>
	</QRY:Definition>


	<QRY:Definition>
			<QRY:Id>165</QRY:Id>
			<QRY:Source Name="operations.shipment.findawbenquirydetails" Type="NATIVE">
			<![CDATA[

                  SELECT SHP.STDPCS STDPCS,
					  SHP.STDWGT STDWGT,
					  SHP.SHPNAM SHPNAM,
					  SHP.SHPCOD SHPCOD,
					  SHP.SHPADRONE SHPADRONE,
					  SHP.CNSNAM CNSNAM,
					  SHP.CNSCOD CNSCOD,
					  SHP.CNSADRONE CNSADRONE,
					  SHP.SHPDES SHPDES,
					  MIS.REQRTG REQRTG,
					  ACC.WGTCCCHG WGTCCCHG,
					  ACC.WGTPPCHG WGTPPCHG,
					  ACC.VALPPCHG VALPPCHG,
					  ACC.VALCCCHG VALCCCHG,
					  ACC.TOTDUEAGTCCCHG TOTDUEAGTCCCHG,
					  ACC.TOTDUECARCCCHG TOTDUECARCCCHG,
					  ACC.TAXCCF TAXCCF,
					  ACC.TAXPPD TAXPPD,
					  ACC.TOTPPD TOTPPD,
					  ACC.TOTCCF TOTCCF,
					  ACC.TOTDUEAGTPPCHG TOTDUEAGTPPCHG,
					  ACC.TOTDUECARPPCHG TOTDUECARPPCHG,
					  ACC.CMSCCF CMSCCF,
					  ACC.CMSPPD CMSPPD,
					  ACC.IATCOD IATCOD,
					  SHP.PAYTYP PAYTYP,
					  SHP.UBRNUM UBRNUM,
					  SHP.AGTCOD AGTCOD,
					  SHP.AGTNAM AGTNAM,
					  SHP.CURCOD CURCOD,
					  ACC.JRNDAT JRNDAT,
					  ACC.CASCOD CASCOD,
					  SHP.SHPSTA SHPSTA,
					  SHP.SCCCOD SCCCOD,
					  SHP.ORGCOD ORGCOD,
					  SHP.DSTCOD DSTCOD,
					  ACC.INSAMT INSAMT,
					  ACC.RATCONIDR RATCONIDR,
					  SHP.SPTRATIDR SPTRATIDR,
					  ARP.ACPPCS TOTACPPCS,
					  ARP.ACPWGT TOTACPWGT,
					  DTL.TOTDLVPCS TOTDLVPCS,
					  DTL.TOTDLVWGT TOTDLVWGT,
					  ARP.TOTSRNPCS TOTSRNPCS,
					  DTL.ACPRMK ACPRMK,
					  ARP.RCVPCS RCVPCS,
					  ARP.RCVWGT RCVWGT,
					  ARP.MFTPCS MFTPCS,
					  ARP.AVLPCS,
					  ARP.AVLWGT,
					  ARP.MFTWGT MFTWGT,
					  ARP.ARPCOD ARPCOD,
					  RTG.DSTCOD RTGDSTCOD,
					  RTG.FLTCARIDR RTFLTCARIDR,
					  RTG.RTGSERNUM RTGSERNUM,
					  MIS.SCICOD SCICODE,
					  ARP.TFROUTPCS,
					  ARP.TFROUTWGT,
					  BKG.BKGSRC,SHP.RDYCRGFLG,
					SHP.SRCIND , (select count(1) from OPRSHPNOT NTE where 
						SHP.CMPCOD = NTE.CMPCOD
					   AND SHP.MSTDOCNUM = NTE.MSTDOCNUM
					   AND SHP.DOCOWRIDR = NTE.DOCOWRIDR
					   AND SHP.DUPNUM = NTE.DUPNUM
					   ) SHPNOTCNT,
					   OCI.CNTCOD OCICNTCOD,
					   OCI.INFIDF OCIINFIDF,
					   OCI.CUSINFIDF OCICUSINFIDF,
					   OCI.CUSINF OCICUSINF,
					   OCI.SRCIND OCISRCIND,
					   OCI.SERNUM OCISERNUM,
					   (SELECT CSTAUTDES FROM CSTMST WHERE CMPCOD = CUSINF.CMPCOD
            				    AND CSTAUTCOD = CUSINF.CSTAUTCOD)  CSTAUTCOD,
					   CUSINF.PARTYP PARTYP,
					   CUSINF.PARVAL PARVAL,
					   CUSINF.SERNUM CUSINFSERNUM,
					    (SELECT RTRIM(XMLAGG( 
						XMLELEMENT(A, COALESCE( SHPBLK.ARPCOD,'ALL') ||',') 
						).EXTRACT('//text()'), ',') SHPBLKARPCOD 
						FROM oprshpblk SHPBLK 
						WHERE SHPBLK.CMPCOD = SHP.CMPCOD 
					   AND SHPBLK.DOCOWRIDR = SHP.DOCOWRIDR 
					   AND SHPBLK.MSTDOCNUM = SHP.MSTDOCNUM 
					   AND SHPBLK.DUPNUM = SHP.DUPNUM 
					   AND SHPBLK.SEQNUM = SHP.SEQNUM 
					   AND SHPBLK.blksta = 'B'
					   ) as SHPBLKARPCOD,
					   BKG.SHPRDYTIM,
					   BKG.SHPDLVTIM,
					   SHPDIM.RATLINSERNUM, SHPDIM.DIMSERNUM,SHPDIM.PCSLEN,
					   SHPDIM.PCSHGT,SHPDIM.PCSWID,SHPDIM.PCSVOL,
					   SHPDIM.NUMPCS,SHPDIM.DISWGT,SHPDIM.WGT,SHPDIM.WGTCOD,SHP.EXEFLG,DTL.APRFLG
					FROM OPRSHPMST SHP,
					  OPRARPSHP ARP,
					  OPRSHPDTL DTL,
					  OPRSHPRTG RTG,
					  OPRSHPMSTACC ACC,
					  OPRSHPMSTMIS MIS,
					  CAPBKGMST BKG,
					  OPRSHPCSTINF CUSINF,
					  OPRSHPOCI OCI,
					  OPRSHPDIMDTL SHPDIM
					WHERE SHP.MSTDOCNUM = ARP.MSTDOCNUM(+)
					AND SHP.DOCOWRIDR   = ARP.DOCOWRIDR(+)
					AND SHP.DUPNUM      = ARP.DUPNUM(+)
					AND SHP.SEQNUM      = ARP.SEQNUM(+)
					AND SHP.CMPCOD      = ARP.CMPCOD(+)
					AND SHP.MSTDOCNUM   = ACC.MSTDOCNUM(+)
					AND SHP.DOCOWRIDR   = ACC.DOCOWRIDR(+)
					AND SHP.DUPNUM      = ACC.DUPNUM(+)
					AND SHP.SEQNUM      = ACC.SEQNUM(+)
					AND SHP.CMPCOD      = ACC.CMPCOD(+)
					AND SHP.MSTDOCNUM   = MIS.MSTDOCNUM(+)
					AND SHP.DOCOWRIDR   = MIS.DOCOWRIDR(+)
					AND SHP.DUPNUM      = MIS.DUPNUM(+)
					AND SHP.SEQNUM      = MIS.SEQNUM(+)
					AND SHP.CMPCOD      = MIS.CMPCOD(+)
					AND SHP.MSTDOCNUM   = DTL.MSTDOCNUM(+)
					AND SHP.DOCOWRIDR   = DTL.DOCOWRIDR(+)
					AND SHP.DUPNUM      = DTL.DUPNUM(+)
					AND SHP.SEQNUM      = DTL.SEQNUM(+)
					AND SHP.CMPCOD      = DTL.CMPCOD(+)
					AND SHP.MSTDOCNUM   = RTG.MSTDOCNUM(+)
					AND SHP.DOCOWRIDR   = RTG.DOCOWRIDR(+)
					AND SHP.DUPNUM      = RTG.DUPNUM(+)
					AND SHP.SEQNUM      = RTG.SEQNUM(+)
					AND SHP.CMPCOD      = RTG.CMPCOD(+)
					AND SHP.MSTDOCNUM   = BKG.MSTDOCNUM(+)
					AND SHP.DOCOWRIDR   = BKG.DOCOWRIDR(+)
					AND SHP.DUPNUM      = BKG.DUPNUM(+)
					AND SHP.SEQNUM      = BKG.SEQNUM(+)
					AND SHP.CMPCOD      = BKG.CMPCOD(+)
					AND SHP.MSTDOCNUM   = CUSINF.MSTDOCNUM(+)
					AND SHP.DOCOWRIDR   = CUSINF.DOCOWRIDR(+)
					AND SHP.DUPNUM      = CUSINF.DUPNUM(+)
					AND SHP.SEQNUM      = CUSINF.SEQNUM(+)
					AND SHP.CMPCOD      = CUSINF.CMPCOD(+)
					AND SHP.MSTDOCNUM   = OCI.MSTDOCNUM(+)
					AND SHP.DOCOWRIDR   = OCI.DOCOWRIDR(+)
					AND SHP.DUPNUM      = OCI.DUPNUM(+)
					AND SHP.SEQNUM      = OCI.SEQNUM(+)
					AND SHP.CMPCOD      = OCI.CMPCOD(+)
					AND SHP.MSTDOCNUM = SHPDIM.MSTDOCNUM(+)
					AND SHP.DOCOWRIDR = SHPDIM.DOCOWRIDR(+)
					AND SHP.DUPNUM = SHPDIM.DUPNUM(+)
					AND SHP.SEQNUM = SHPDIM.SEQNUM(+)
					AND SHP.CMPCOD = SHPDIM.CMPCOD(+)
					AND SHP.MSTDOCNUM   = ?
					AND SHP.DOCOWRIDR   = ?
					AND SHP.DUPNUM      = ?
					AND SHP.SEQNUM      = ?
					AND SHP.CMPCOD      = ?
					

		]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>166</QRY:Id>
	<QRY:Source Name="operations.shipment.findlatestflightforawb" Type="NATIVE">
	<![CDATA[
			SELECT
				 FLT.FLTCARIDR,FLT.FLTNUM,FLT.FLTSEQNUM,FLT.LEGSERNUM,FLT.FLTCARCOD,FLT.FLTDAT,
				 CLSFLG
			FROM
				 OPRSEGSHP SHP, OPRARPIMPFLT FLT,
				 FLTOPRLEG LEG, OPRFLTSEG SEG
			WHERE
				 SHP.CMPCOD = FLT.CMPCOD
				 AND SHP.FLTCARIDR = FLT.FLTCARIDR
				 AND SHP.FLTNUM = FLT.FLTNUM
				 AND SHP.FLTSEQNUM = FLT.FLTSEQNUM
				 AND SHP.CMPCOD = LEG.CMPCOD
				 AND SHP.FLTCARIDR = LEG.FLTCARIDR
				 AND SHP.FLTNUM = LEG.FLTNUM
				 AND SHP.FLTSEQNUM = LEG.FLTSEQNUM
				 AND FLT.LEGSERNUM = LEG.LEGSERNUM
				 AND SHP.CMPCOD = SEG.CMPCOD
				 AND SHP.FLTCARIDR = SEG.FLTCARIDR
				 AND SHP.FLTNUM = SEG.FLTNUM
				 AND SHP.FLTSEQNUM = SEG.FLTSEQNUM
				 AND SHP.SEGSERNUM = SEG.SEGSERNUM
				 AND FLT.ARPCOD = SEG.POU
				 AND SHP.CMPCOD = ?
				 AND SHP.DOCOWRIDR = ?
				 AND SHP.MSTDOCNUM = ?
				 AND SHP.SEQNUM = ?
				 AND SHP.DUPNUM = ?
				 ORDER BY NVL(LEG.ATA ,LEG.STA)  DESC
	]]>
	</QRY:Source>
	</QRY:Definition>


<QRY:Definition>
	<QRY:Id>167</QRY:Id>
	<QRY:Source Name="operations.shipment.findratingdetailsforenquiry" Type="NATIVE">
	<![CDATA[

SELECT RAT.CHGWGT,
	   RAT.CMDITMNAM,
	   RAT.CMDITMNUM,
	   RAT.DSCPCT,
	   RAT.GRSWGT,
	   RAT.IATCHG,
	   RAT.IATRAT,
	   RAT.NETCHG,
       RAT.IATRATCLS,
       RAT.ARLRATCLS,
       RAT.ACTRATCLS,
	   RAT.RATDES,
	   RAT.SCCCOD,
	   RAT.RATLINSERNUM,
		RAT.SRVCOD
  FROM OPRSHPRATDTL RAT
 WHERE RAT.MSTDOCNUM = ?
     AND RAT.DOCOWRIDR = ?
     AND RAT.DUPNUM = ?
     AND RAT.SEQNUM = ?
     AND RAT.CMPCOD = ?


	]]>
	</QRY:Source>
</QRY:Definition>

<QRY:Definition>
	<QRY:Id>168</QRY:Id>
	<QRY:Source Name="operations.shipment.findchargedetailsforenquiry" Type="NATIVE">
	<![CDATA[

SELECT CHG.PAYTYP,
	   CHG.DUECARFLG,
	   CHG.DUEAGTFLG,
	   CHG.CHGHED,
	   CHG.CHDCOD,
	   CHG.CHGHEDIDR,
	   CHG.CHGAMT
  FROM OPRSHPCHGDTL CHG
	  WHERE CHG.MSTDOCNUM = ?
		AND CHG.DOCOWRIDR = ?
	    AND CHG.DUPNUM = ?
	    AND CHG.SEQNUM = ?
	    AND CHG.CMPCOD = ?


	]]>
	</QRY:Source>
</QRY:Definition>

<QRY:Definition>
	<QRY:Id>169</QRY:Id>
	<QRY:Source Name="operations.shipment.findacceptancedetailsforenquiryone" Type="NATIVE">
	<![CDATA[


	SELECT ACPDTL.CMPCOD, NULL AS ULDNUM, ACPDTL.WHSCOD, ACPDTL.LOCCOD,
	       ACPDTL.ACPPCS, ACPDTL.ACPWGT, ACPDTL.STUCOD, ACPDTL.ARPCOD, 
	       ARPSHP.ACPPCS TOTACPPCS, ARPSHP.ACPWGT TOTACPWGT
	  FROM OPRSHPACPDTL ACPDTL, OPRSHPDTL DTL, OPRARPSHP ARPSHP
	 WHERE DTL.CMPCOD = ACPDTL.CMPCOD
	   AND DTL.DOCOWRIDR = ACPDTL.DOCOWRIDR
	   AND DTL.MSTDOCNUM = ACPDTL.MSTDOCNUM
	   AND DTL.DUPNUM = ACPDTL.DUPNUM
	   AND DTL.SEQNUM = ACPDTL.SEQNUM
	   AND ACPDTL.CMPCOD = ARPSHP.CMPCOD
	   AND ACPDTL.ARPCOD = ARPSHP.ARPCOD
	   AND ACPDTL.DOCOWRIDR = ARPSHP.DOCOWRIDR
	   AND ACPDTL.MSTDOCNUM = ARPSHP.MSTDOCNUM
	   AND ACPDTL.DUPNUM = ARPSHP.DUPNUM
   	   AND ACPDTL.SEQNUM = ARPSHP.SEQNUM
	   AND DTL.CMPCOD = ?	   
	   AND DTL.DOCOWRIDR = ?
	   AND DTL.MSTDOCNUM = ?
	   AND DTL.DUPNUM = ?
	   AND DTL.SEQNUM = ?
	]]>
	</QRY:Source>
</QRY:Definition>

<QRY:Definition>
	<QRY:Id>170</QRY:Id>
	<QRY:Source Name="operations.shipment.findshpreturndetailsforenquiry" Type="NATIVE">
	<![CDATA[

	SELECT
			SRN.CMPCOD, SRN.SRNNUM, SRN.SRNPCS, SRN.ISSDAT,
			SRN.ARPCOD, SRN.SRNSTA, SRN.RSNCOD, SRN.DLVPCS,SRN.SRNWGT
  	  FROM
  	  		OPRSHPSRN SRN
	 WHERE
       		SRN.CMPCOD = ?
			AND SRN.DOCOWRIDR = ?
			AND SRN.MSTDOCNUM = ?
			AND SRN.DUPNUM = ?
			AND SRN.SEQNUM = ?

	]]>
	</QRY:Source>
</QRY:Definition>

<QRY:Definition>
	<QRY:Id>171</QRY:Id>
	<QRY:Source Name="operations.shipment.findshipmentauditdetailsforenquiry" Type="NATIVE">
	<![CDATA[

	SELECT
			SHPAUD.CMPCOD, SHPAUD.ADLINF, SHPAUD.AUDRMK,
			SHPAUD.ACTCOD,
		    SHPAUD.UPDTXNTIMUTC, SHPAUD.UPDUSR, SHPAUD.STNCOD,
			SHPAUD.UPDTXNTIM,SHPAUD.TRGPNT
			FROM OPRSHPAUD SHPAUD LEFT OUTER JOIN
			SHRAUDTXNCFG CFG
			ON SHPAUD.CMPCOD    = CFG.CMPCOD
			AND SHPAUD.ACTCOD    = CFG.TXNCOD
	 WHERE
       		SHPAUD.CMPCOD = ?
			AND SHPAUD.DOCOWRIDR = ?
			AND SHPAUD.MSTDOCNUM = ?
			AND SHPAUD.DUPNUM = ?
			
			
	]]>
	</QRY:Source>
</QRY:Definition>

<QRY:Definition>
	<QRY:Id>172</QRY:Id>
	<QRY:Source Name="operations.shipment.finddiscrepancydetailsforflightenquiry" Type="NATIVE">
			<![CDATA[

SELECT COUNT (DISTINCT FLTDIS.MSTDOCNUM
               || '`'
               || DIS.MSTDOCNUM
               || '`'
               || FLTDIS.DOCOWRIDR
               || '`'
               || DIS.DOCOWRIDR
               || '`'
               || FLTDIS.DUPNUM
               || '`'
               || DIS.DUPNUM
               || '`'
               || FLTDIS.SEQNUM
               || '`'
               || DIS.SEQNUM
             ) SHPCNT
  FROM OPRSHPFLTDIS FLTDIS FULL OUTER JOIN  OPRSHPDIS DIS
    ON FLTDIS.FLTNUM = DIS.FLTNUM
   AND FLTDIS.FLTCARIDR = DIS.FLTCARIDR
   AND FLTDIS.FLTSEQNUM = DIS.FLTSEQNUM
   AND FLTDIS.CMPCOD = DIS.CMPCOD
   WHERE FLTDIS.FLTSEQNUM = ?
   AND FLTDIS.FLTNUM = ?
   AND FLTDIS.FLTCARIDR = ?
   AND FLTDIS.CMPCOD = ?


			]]>
	</QRY:Source>
</QRY:Definition>


<QRY:Definition>
	<QRY:Id>173</QRY:Id>
	<QRY:Source Name="operations.shipment.finddamagedetailsforflightenquiry" Type="NATIVE">
			<![CDATA[

SELECT COUNT (DISTINCT DMG.MSTDOCNUM
               || '`'
               || DMG.DOCOWRIDR
               || '`'
               || DMG.DUPNUM
               || '`'
               || DMG.SEQNUM
             ) DMGCNT
  FROM OPRDMGDIS DMG
 WHERE DMG.FLTSEQNUM = ?
   AND DMG.FLTNUM = ?
   AND DMG.FLTCARIDR = ?
   AND DMG.CMPCOD = ?


			]]>
	</QRY:Source>
</QRY:Definition>

<!--Modified @ JPY by A-1927 on 02-Feb-2007 for NCA Bug Fix starts-->
<!--Modified @ by A-5111 on 24-Aug-2012 for Bug Id:icrd-4632 Fix starts-->
<QRY:Definition>
	<QRY:Id>163</QRY:Id>
	<QRY:Source Name="operaions.shipment.findDisruptionListForMonitoring" Type="NATIVE">
	<![CDATA[
			SELECT BKGFLT.CMPCOD,MST.DUPNUM DUPNUM, MST.MSTDOCNUM MSTDOCNUM,
				 MST.DOCOWRIDR DOCOWRIDR, MST.SEQNUM SEQNUM,
				 MST.SHPPFX SHPPFX, MST.ORGCOD ORGCOD, MST.DSTCOD DSTCOD,
				 BKGFLT.FLTORG FLTORG, BKGFLT.FLTDST FLTDST, BKGFLT.CFRPCS,
				 BKGFLT.QUEPCS, SHP.MFTPCS, BKGFLT.CFRWGT, BKGFLT.QUEWGT,
				 SHP.MFTWGT, BKGFLT.CFRVOL, BKGFLT.QUEVOL, SHP.MFTVOL,
				 BKGFLT.FLTCARCOD FLTCARCOD, MST.UBRNUM UBRNUM,
				 BKGFLT.FLTCARIDR FLTCARIDR, BKGFLT.FLTNUM FLTNUM,
				 BKGFLT.FLTSEQNUM FLTSEQNUM, BKGFLT.FLTDAT FLTDAT,LEG.ACRTYP ACRTYP,LEG.TALNUM TALNUM,FLTOPRMST.FLTROU FLTROU,
				 BKGFLT.SERNUM,BKGFLT.SEGSERNUM SEGSERNUM, OFL.OFLRSN OFLRSN,
				 OFL.TXNSERNUM TXNSERNUM, ULDSHP.ULDNUM, ULDSHP.NUMPCS,
				 ULDSHP.WGT, ULDSHP.VOL, MST.STDPCS, MST.STDWGT,
				 MST.GRSVOL STDVOL, DTL.COMCOD,RAT.ARLRAT, BKG.LSTUPDTIM,MST.LSTUPDTIM SHPLSTUPDTIM,BKGFLT.LSTUPDTIM BKGFLTLSTUPDTIM
				FROM CAPBKGFLTDTL BKGFLT
					 INNER JOIN OPRSHPMST MST ON
						BKGFLT.MSTDOCNUM = MST.MSTDOCNUM
						AND BKGFLT.DOCOWRIDR = MST.DOCOWRIDR
						AND BKGFLT.DUPNUM = MST.DUPNUM
						AND BKGFLT.SEQNUM = MST.SEQNUM
						AND BKGFLT.CMPCOD = MST.CMPCOD
						AND BKGFLT.UBRNUM = MST.UBRNUM
					 INNER JOIN CAPBKGDTL DTL ON
						BKGFLT.CMPCOD = DTL.CMPCOD
						AND BKGFLT.UBRNUM = DTL.UBRNUM
					 INNER JOIN FLTOPRLEG LEG ON
						BKGFLT.CMPCOD = LEG.CMPCOD
						AND BKGFLT.FLTNUM = LEG.FLTNUM
						AND BKGFLT.FLTSEQNUM = LEG.FLTSEQNUM
						AND BKGFLT.FLTCARIDR = LEG.FLTCARIDR
						AND BKGFLT.FLTORG = LEG.LEGORG
					INNER JOIN FLTOPRMST FLTOPRMST ON
						BKGFLT.CMPCOD = FLTOPRMST.CMPCOD
						AND BKGFLT.FLTNUM = FLTOPRMST.FLTNUM
						AND BKGFLT.FLTSEQNUM = FLTOPRMST.FLTSEQNUM
						AND BKGFLT.FLTCARIDR = FLTOPRMST.FLTCARIDR
					    INNER JOIN OPRARPSHP ARPSHP
                        ON MST.MSTDOCNUM =ARPSHP.MSTDOCNUM
                        AND MST.DOCOWRIDR=ARPSHP.DOCOWRIDR
                        AND MST.DUPNUM   =ARPSHP.DUPNUM
                        AND MST.SEQNUM   =ARPSHP.SEQNUM
                        AND MST.CMPCOD   =ARPSHP.CMPCOD
					INNER JOIN OPRARPEXPFLT EXPFLT
						 ON LEG.CMPCOD = EXPFLT.CMPCOD
						AND LEG.FLTNUM     = EXPFLT.FLTNUM
						AND LEG.FLTSEQNUM  = EXPFLT.FLTSEQNUM
						AND LEG.FLTCARIDR  = EXPFLT.FLTCARIDR
						AND LEG.LEGSERNUM  = EXPFLT.LEGSERNUM
					 LEFT OUTER JOIN OPRSEGSHP SHP ON
						BKGFLT.MSTDOCNUM = SHP.MSTDOCNUM
						AND BKGFLT.DOCOWRIDR = SHP.DOCOWRIDR
						AND BKGFLT.DUPNUM = SHP.DUPNUM
						AND BKGFLT.SEQNUM = SHP.SEQNUM
						AND BKGFLT.CMPCOD = SHP.CMPCOD
						AND BKGFLT.FLTNUM = SHP.FLTNUM
						AND BKGFLT.FLTSEQNUM = SHP.FLTSEQNUM
						AND BKGFLT.FLTCARIDR = SHP.FLTCARIDR
						AND BKGFLT.SEGSERNUM = SHP.SEGSERNUM
					  LEFT OUTER JOIN OPRULDSHP ULDSHP ON
						MST.MSTDOCNUM = ULDSHP.MSTDOCNUM
						AND MST.DOCOWRIDR = ULDSHP.DOCOWRIDR
						AND MST.DUPNUM = ULDSHP.DUPNUM
						AND MST.SEQNUM = ULDSHP.SEQNUM
						AND MST.CMPCOD = ULDSHP.CMPCOD
					  LEFT OUTER JOIN OPROFLDTL OFL ON
						BKGFLT.DUPNUM = OFL.DUPNUM
						AND BKGFLT.MSTDOCNUM = OFL.MSTDOCNUM
						AND BKGFLT.DOCOWRIDR = OFL.DOCOWRIDR
						AND BKGFLT.CMPCOD = OFL.CMPCOD
						AND BKGFLT.SEQNUM = OFL.SEQNUM
						AND BKGFLT.FLTCARIDR = OFL.FLTCARIDR
						AND BKGFLT.FLTNUM = OFL.FLTNUM
						AND BKGFLT.FLTSEQNUM = OFL.FLTSEQNUM
						AND BKGFLT.SEGSERNUM = OFL.SEGSERNUM
					  LEFT OUTER JOIN OPRSHPRATDTL RAT ON
						 MST.CMPCOD = RAT.CMPCOD
						 AND MST.DOCOWRIDR = RAT.DOCOWRIDR
						 AND MST.MSTDOCNUM = RAT.MSTDOCNUM
						 AND MST.DUPNUM = RAT.DUPNUM
						 AND MST.SEQNUM = RAT.SEQNUM
					INNER JOIN CAPBKGMST BKG ON
						BKGFLT.CMPCOD = BKG.CMPCOD
						AND BKGFLT.UBRNUM = BKG.UBRNUM
					

	 ]]>
</QRY:Source>
</QRY:Definition>
<!--Modified @ by A-5111 on 24-Aug-2012 for Bug Id:icrd-4632 Fix ends-->
<!--Modified @ JPY by A-1927 on 02-Feb-2007 for NCA Bug Fix ends-->
<QRY:Definition>
<QRY:Id>164</QRY:Id>
<QRY:Source Name="operations.shipment.findAutoBlockDetails" Type="NATIVE">
	<![CDATA[
		SELECT AUTMST.CMPCOD CMPCOD,AUTMST.BLKTYP BLKTYP,AUTMST.TXNCOD TXNCOD,AUTMST.SERNUM SERNUM,AUTMST.TXNPOR TXNPOR,
				AUTMST.TXNPORTYP TXNPORTYP,AUTMST.BLKSTR BLKSTR,AUTMST.VALCLSNAM VALCLSNAM,AUTMST.LSTUPDTIM LSTUPDTIM,
				AUTMST.LSTUPDUSR LSTUPDUSR,
				AUTPAR.PARCOD BLKPARCOD,AUTPAR.PARVAL BLKPARVAL,AUTPAR.EXCFLG BLKEXCFLG,
				AUTPAR.LSTUPDTIM PARLSTUPDTIM,AUTPAR.LSTUPDUSR PARLSTUPDUSR,
				RELMST.TXNCOD RELTXNCOD,RELMST.SERNUM RELSERNUM,RELMST.BLKSERNUM BLKSERNUM,RELMST.BLKRELSTR BLKRELSTR,
				RELMST.VALCLSNAM RELVALCLSNAM,RELMST.LSTUPDTIM RELLSTUPDTIM,RELMST.LSTUPDUSR RELLSTUPDUSR,
				RELPAR.PARCOD RELPARCOD,RELPAR.PARVAL RELPARVAL,RELPAR.EXCFLG RELEXCFLG,
				RELPAR.LSTUPDTIM RELPARLSTUPDTIM,RELPAR.LSTUPDUSR RELPARLSTUPDUSR
					
		FROM OPRAUTBLKMST AUTMST 
			 LEFT OUTER JOIN OPRAUTBLKPAR AUTPAR ON
				AUTMST.CMPCOD = AUTPAR.CMPCOD AND
				AUTMST.BLKTYP = AUTPAR.BLKTYP AND
				AUTMST.SERNUM = AUTPAR.SERNUM
			 INNER JOIN OPRBLKRELMST RELMST ON	
				AUTMST.CMPCOD = RELMST.CMPCOD AND
				AUTMST.BLKTYP = RELMST.BLKTYP AND
				AUTMST.SERNUM = RELMST.BLKSERNUM
			 LEFT OUTER JOIN OPRBLKRELPAR RELPAR ON
				RELMST.CMPCOD = RELPAR.CMPCOD AND
				RELMST.BLKTYP = RELPAR.BLKTYP AND
				RELMST.SERNUM = RELPAR.SERNUM
		WHERE 
				AUTMST.CMPCOD = ?
	]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
	<QRY:Id>174</QRY:Id>
	<QRY:Source Name="operations.shipment.findawbenquirydetailsforhht" Type="NATIVE">
	<![CDATA[

	SELECT (
		  CASE
		    WHEN EXPFLT.FLTNUM IS NOT NULL
		    THEN EXPSEGULDSHP.ULDNUM
		  END) EXPULDNUM,
		  (
		  CASE
		    WHEN EXPFLT.FLTNUM IS NOT NULL
		    THEN EXPSEGULDSHP.MFTPCS
		  END) EXPMFTPCS,
		  (
		  CASE
		    WHEN EXPFLT.FLTNUM IS NOT NULL
		    THEN EXPSEGULDSHP.MFTWGT
		  END) EXPMFTWGT,
		  (
		  CASE
		    WHEN IMPFLT.FLTNUM IS NOT NULL
		    THEN IMPSEGULDSHP.ULDNUM
		  END) IMPULDNUM,
		  (
		  CASE
		    WHEN IMPFLT.FLTNUM IS NOT NULL
		    THEN IMPSEGULDSHP.MFTPCS
		  END) IMPMFTPCS,
		  (
		  CASE
		    WHEN IMPFLT.FLTNUM IS NOT NULL
		    THEN IMPSEGULDSHP.MFTWGT
		  END) IMPMFTWGT,
		SHPMST.MSTDOCNUM,
		   SHPMST.STDPCS STDPCS,
		   SHPMST.STDWGTCOD STDWGTCOD,
		   SHPMST.STDWGT STDWGT,
		   SHPMST.SHPDES SHPDES,
		   SHPMST.CNSNAM CNSNAM,
		   SHPMST.ORGCOD ORGCOD,
		   SHPMST.DSTCOD DSTCOD,
		   SHPMST.SCCCOD SCCCOD,
		   SHPMST.SHPNAM SHPNAM,
		   IMPFLTSEG.FLTCARIDR IMPFLTCARIDR,
		   IMPFLTSEG.FLTNUM IMPFLTNUM,
		   IMPFLTSEG.FLTSEQNUM IMPFLTSEQNUM,
		   IMPFLTSEG.SEGSERNUM IMPFLTSEGSERNUM,
	       	   EXPFLTSEG.FLTCARIDR EXPFLTCARIDR,
		   EXPFLTSEG.FLTNUM EXPFLTNUM,
		   EXPFLTSEG.FLTSEQNUM EXPFLTSEQNUM,
		   EXPFLTSEG.SEGSERNUM EXPFLTSEGSERNUM,
		  EXPFLTSEG.POL EXPFLTSEGPOL,
		  EXPFLTSEG.POU EXPFLTSEGPOU,
		   ARPSHP.RCVPCS RCVPCS,
		   ARPSHP.RCVWGT RCVWGT,
		   ARPSHP.ACPPCS ACPPCS,
		   ARPSHP.ACPWGT ACPWGT,
		   IMPSEGSHP.OFLPCS OFLPCS,
		   IMPSEGSHP.OFLWGT OFLWGT,
		   ARPSHP.MFTPCS MFTPCS,
		   ARPSHP.MFTWGT MFTWGT,
		   ARPSHP.TOTDLVPCS TOTDLVPCS,
		   ARPSHP.TOTDLVWGT TOTDLVWGT,
		   ARPSHP.AVLPCS AVLPCS,
		   ARPSHP.AVLWGT AVLWGT,
		   ARPSHP.ARPCOD ARPCOD,
ARPSHP.BDPPCS,
ARPSHP.TFROUTPCS, 
		   (SELECT STA
				FROM FLTOPRLEG
		  WHERE FLTOPRLEG.FLTNUM  = IMPFLTSEG.FLTNUM
		  AND FLTOPRLEG.FLTCARIDR = IMPFLTSEG.FLTCARIDR
		  AND FLTOPRLEG.CMPCOD    = IMPFLTSEG.CMPCOD
		  AND FLTOPRLEG.FLTSEQNUM = IMPFLTSEG.FLTSEQNUM
		  AND FLTOPRLEG.LEGDST    = IMPFLTSEG.POU
		  ) IMPFLTDAT,
		  (SELECT FLTOWN
		  FROM FLTOPRMST
		  WHERE FLTOPRMST.FLTNUM  = IMPFLTSEG.FLTNUM
				 AND FLTOPRMST.FLTCARIDR = IMPFLTSEG.FLTCARIDR
				 AND FLTOPRMST.CMPCOD = IMPFLTSEG.CMPCOD
		  AND FLTOPRMST.FLTSEQNUM = IMPFLTSEG.FLTSEQNUM
		  ) IMPFLTOWN,
		   (SELECT STD
				FROM FLTOPRLEG
				WHERE FLTOPRLEG.FLTNUM  = EXPFLTSEG.FLTNUM
				AND FLTOPRLEG.FLTCARIDR = EXPFLTSEG.FLTCARIDR
				AND FLTOPRLEG.CMPCOD    = EXPFLTSEG.CMPCOD
				AND FLTOPRLEG.FLTSEQNUM = EXPFLTSEG.FLTSEQNUM
		  AND FLTOPRLEG.LEGORG    = EXPFLTSEG.POL
		  ) EXPFLTDAT,
		  (SELECT FLTOWN
		  FROM FLTOPRMST
		  WHERE FLTOPRMST.FLTNUM  = EXPFLTSEG.FLTNUM
				 AND FLTOPRMST.FLTCARIDR = EXPFLTSEG.FLTCARIDR
				 AND FLTOPRMST.CMPCOD = EXPFLTSEG.CMPCOD
		  AND FLTOPRMST.FLTSEQNUM = EXPFLTSEG.FLTSEQNUM
		  ) EXPFLTOWN,
		  BLK.BLKAUT,
		  BKG.UBRNUM ,
		  BKG.FLTNUM BKGFLTNUM,
		  BKG.FLTCARCOD BKGFLTCARCOD ,
		  BKG.FLTDAT BKGFLTDAT,
		  BKG.FLTORG BKGFLTORG,
		  BKG.FLTDST BKGFLTDST,
		  BKG.FLTCARIDR BKGFLTCARIDR,
		  BKG.FLTSEQNUM BKGFLTSEQNUM,
		  BKG.NUMPCS BKGNUMPCS,
		  BKG.WGT BKGWGT,
		  BKG.FLTBKGSTA FLTBKGSTA,
		    BKGFLTLEG.ATA,
		  BKGFLTLEG.STA,
		  BKGFLTLEG.ETA,
		  BKGFLTLEG.ATD,
		  BKGFLTLEG.STD,
		  BKGFLTLEG.ETD
	  FROM  OPRSHPMST  SHPMST
LEFT OUTER JOIN OPRARPSHP ARPSHP 
	  			 ON SHPMST.CMPCOD = ARPSHP.CMPCOD
	  			 AND  SHPMST.DOCOWRIDR = ARPSHP.DOCOWRIDR
	  			 AND  SHPMST.MSTDOCNUM = ARPSHP.MSTDOCNUM
	  			 AND  SHPMST.SEQNUM = ARPSHP.SEQNUM
		AND SHPMST.DUPNUM    = ARPSHP.DUPNUM
		AND ARPSHP.ARPCOD = ?
    LEFT OUTER JOIN OPRSHPBLK BLK 
           ON SHPMST.CMPCOD = BLK.CMPCOD 
AND SHPMST.DOCOWRIDR = BLK.DOCOWRIDR 
AND SHPMST.MSTDOCNUM = BLK.MSTDOCNUM 
AND SHPMST.SEQNUM = BLK.SEQNUM 
AND SHPMST.DUPNUM = Blk.DUPNUM 
		AND BLK.ARPCOD       = ?
           AND BLK.BLKSTA = 'B' 
	  LEFT OUTER JOIN OPRSEGSHP IMPSEGSHP
	  			ON SHPMST.CMPCOD = IMPSEGSHP.CMPCOD
	  			AND  SHPMST.DOCOWRIDR = IMPSEGSHP.DOCOWRIDR
	  			AND  SHPMST.MSTDOCNUM = IMPSEGSHP.MSTDOCNUM
	  			AND  SHPMST.SEQNUM = IMPSEGSHP.SEQNUM
	  			AND  SHPMST.DUPNUM = IMPSEGSHP.DUPNUM
	  LEFT OUTER JOIN OPRSEGSHP EXPSEGSHP
	  			 ON SHPMST.CMPCOD = EXPSEGSHP.CMPCOD
	  			 AND  SHPMST.DOCOWRIDR = EXPSEGSHP.DOCOWRIDR
	  			 AND  SHPMST.MSTDOCNUM = EXPSEGSHP.MSTDOCNUM
	  			 AND  SHPMST.SEQNUM = EXPSEGSHP.SEQNUM
	  			 AND  SHPMST.DUPNUM = EXPSEGSHP.DUPNUM
	  LEFT OUTER JOIN OPRFLTSEG IMPFLTSEG
	  			 ON IMPSEGSHP.CMPCOD = IMPFLTSEG.CMPCOD
	  			 AND  IMPSEGSHP.FLTCARIDR = IMPFLTSEG.FLTCARIDR
	  			 AND  IMPSEGSHP.FLTNUM = IMPFLTSEG.FLTNUM
	  			 AND  IMPSEGSHP.FLTSEQNUM = IMPFLTSEG.FLTSEQNUM
	  			 AND  IMPSEGSHP.SEGSERNUM = IMPFLTSEG.SEGSERNUM
	  			 AND  IMPFLTSEG.POU = ARPSHP.ARPCOD
	  LEFT OUTER JOIN OPRFLTSEG EXPFLTSEG
	  			 ON EXPSEGSHP.CMPCOD = EXPFLTSEG.CMPCOD
	  			 AND  EXPSEGSHP.FLTCARIDR = EXPFLTSEG.FLTCARIDR
	  			 AND  EXPSEGSHP.FLTNUM = EXPFLTSEG.FLTNUM
	  			 AND  EXPSEGSHP.FLTSEQNUM = EXPFLTSEG.FLTSEQNUM
	  			 AND  EXPSEGSHP.SEGSERNUM = EXPFLTSEG.SEGSERNUM
	  			 AND  EXPFLTSEG.POL = ARPSHP.ARPCOD
				 LEFT OUTER JOIN OPRARPEXPFLT EXPFLT
	  			 ON EXPFLTSEG.CMPCOD = EXPFLT.CMPCOD
	  			 AND  EXPFLTSEG.FLTCARIDR = EXPFLT.FLTCARIDR
	  			 AND  EXPFLTSEG.FLTNUM = EXPFLT.FLTNUM
	  			 AND  EXPFLTSEG.FLTSEQNUM = EXPFLT.FLTSEQNUM
	  			 AND  EXPFLTSEG.POL = EXPFLT.ARPCOD           
	  LEFT OUTER JOIN OPRARPIMPFLT IMPFLT
	  			 ON IMPFLTSEG.CMPCOD = IMPFLT.CMPCOD
	  			 AND  IMPFLTSEG.FLTCARIDR = IMPFLT.FLTCARIDR
	  			 AND  IMPFLTSEG.FLTNUM = IMPFLT.FLTNUM
	  			 AND  IMPFLTSEG.FLTSEQNUM = IMPFLT.FLTSEQNUM
	  			 AND  IMPFLTSEG.POU = IMPFLT.ARPCOD     
	 LEFT OUTER JOIN OPRSEGULDSHP IMPSEGULDSHP
	  			 ON   IMPSEGSHP.CMPCOD = IMPSEGULDSHP.CMPCOD
	  			 AND  IMPSEGSHP.FLTCARIDR = IMPSEGULDSHP.FLTCARIDR
	  			 AND  IMPSEGSHP.FLTNUM = IMPSEGULDSHP.FLTNUM
	  			 AND  IMPSEGSHP.FLTSEQNUM = IMPSEGULDSHP.FLTSEQNUM
	  			 AND  IMPSEGSHP.SEGSERNUM = IMPSEGULDSHP.SEGSERNUM
           AND  IMPSEGSHP.DOCOWRIDR = IMPSEGULDSHP.DOCOWRIDR
	  			 AND  IMPSEGSHP.MSTDOCNUM = IMPSEGULDSHP.MSTDOCNUM
	  			 AND  IMPSEGSHP.SEQNUM = IMPSEGULDSHP.SEQNUM
	  			 AND  IMPSEGSHP.DUPNUM = IMPSEGULDSHP.DUPNUM           
	 LEFT OUTER JOIN OPRSEGULDSHP EXPSEGULDSHP
	  			 ON   EXPSEGSHP.CMPCOD = EXPSEGULDSHP.CMPCOD
	  			 AND  EXPSEGSHP.FLTCARIDR = EXPSEGULDSHP.FLTCARIDR
	  			 AND  EXPSEGSHP.FLTNUM = EXPSEGULDSHP.FLTNUM
	  			 AND  EXPSEGSHP.FLTSEQNUM = EXPSEGULDSHP.FLTSEQNUM
	  			 AND  EXPSEGSHP.SEGSERNUM = EXPSEGULDSHP.SEGSERNUM
           AND  EXPSEGSHP.DOCOWRIDR = EXPSEGULDSHP.DOCOWRIDR
           AND  EXPSEGSHP.MSTDOCNUM = EXPSEGULDSHP.MSTDOCNUM
	  			 AND  EXPSEGSHP.SEQNUM = EXPSEGULDSHP.SEQNUM
	  			 AND  EXPSEGSHP.DUPNUM = EXPSEGULDSHP.DUPNUM
		LEFT OUTER JOIN CAPBKGFLTDTL BKG
		ON BKG.CMPCOD        = SHPMST.CMPCOD
		AND BKG.UBRNUM       = SHPMST.UBRNUM
		AND BKG.MSTDOCNUM    = SHPMST.MSTDOCNUM
		AND BKG.SEQNUM       = SHPMST.SEQNUM
		AND BKG.DUPNUM       = SHPMST.DUPNUM		
		LEFT OUTER JOIN FLTOPRLEG BKGFLTLEG
		ON BKGFLTLEG.FLTNUM = BKG.FLTNUM   
		AND BKGFLTLEG.FLTCARIDR = BKG.FLTCARIDR
		AND BKGFLTLEG.FLTSEQNUM = BKG.FLTSEQNUM
		AND BKGFLTLEG.LEGORG = BKG.FLTORG
		AND BKGFLTLEG.CMPCOD = BKG.CMPCOD
		
		  WHERE SHPMST.CMPCOD = ?		  
		  AND SHPMST.DOCOWRIDR = ?
		  AND SHPMST.DOCNUM = ?
		  AND SHPMST.SEQNUM =  ?
		  AND SHPMST.DUPNUM =  ?
	]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
	<QRY:Id>174</QRY:Id>
	<QRY:Source Name="operations.shipment.findimcompletehouses" Type="NATIVE">
	<![CDATA[
			SELECT MST.CMPCOD AS CMPCOD, MST.MSTDOCNUM AS MSTDOCNUM,
				   MST.SHPPFX AS SHPPFX,MST.DOCNUM AS DOCNUM,MST.SEQNUM SEQNUM,
			       MST.DUPNUM AS DUPNUM,MST.ORGCOD AS ORG, MST.DSTCOD AS DEST, MST.SHPDES AS DES,
			       MST.CNSNAM AS CNSNAM, MST.CNSADRONE AS CNSADR, MST.SHPNAM AS SHPNAM,
			       MST.SHPADRONE AS SHPADR,MST.DOCOWRIDR AS OWNIDR,FLT.POU AS POU,
			       MST.STDPCS, MST.STDWGT
			  FROM OPRSHPMST  MST ,OPRSEGSHP SEG,OPRFLTSEG FLT
			 WHERE  MST.CMPCOD = SEG.CMPCOD(+)
			   AND MST.MSTDOCNUM = SEG.MSTDOCNUM(+)
			   AND MST.DOCOWRIDR = SEG.DOCOWRIDR(+)
			   AND SEG.CMPCOD=FLT.CMPCOD
			   AND SEG.FLTCARIDR = FLT.FLTCARIDR
			   AND SEG.FLTSEQNUM = FLT.FLTSEQNUM
			   AND SEG.SEGSERNUM = FLT.SEGSERNUM
			   AND SEG.FLTNUM = FLT.FLTNUM
			   AND MST.CMPCOD = ?
			   AND SEG.FLTNUM = ?
			  AND SEG.FLTSEQNUM = ?
			  AND SEG.FLTCARIDR = ?
		]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
	<QRY:Id>175</QRY:Id>
	<QRY:Source Name="operations.shipment.findshipmentnotes" Type="NATIVE">
	<![CDATA[

	SELECT NOTE.DOCOWRIDR NOTEDOCOWRIDR, NOTE.DUPNUM NOTEDUPNUM,
	       NOTE.MSTDOCNUM NOTEMSTDOCNUM, NOTE.SEQNUM NOTESEQNUM,
	       NOTE.CMPCOD NOTECMPCOD,NOTE.APPTXN, NOTE.RMK NOTERMK, NOTE.TXNCOD, NOTE.USRCOD,
	       NOTE.TXNTIM, NOTE.STNCOD, NOTE.SERNUM NOTESERNUM,NOTE.TXNFLG,NOTE.DOCNUM, NOTE.LSTUPDTIM, NOTE.LSTUPDUSR
	  FROM OPRSHPNOT NOTE
	 WHERE NOTE.CMPCOD = ?




		]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
	<QRY:Id>176</QRY:Id>
	<QRY:Source Name="operations.shipment.findmissinghawbs" Type="NATIVE">
	<![CDATA[
SELECT MST.CMPCOD AS CMPCOD, MST.MSTDOCNUM AS MSTDOCNUM, MST.DOCNUM AS DOCNUM,
       MST.ORGCOD AS ORG, MST.DSTCOD AS DEST, MST.SHPDES AS DES, MST.SHPPFX AS SHPPFX,
       MST.DUPNUM AS DUPNUM, MST.SEQNUM AS SEQNUM, MST.CONFLG AS CONFLG,
       MST.STDPCS AS STDPCS, MST.DOCOWRIDR AS OWNIDR, FLT.POU AS POU
  FROM OPRSHPMST  MST, OPRSEGSHP SEG, OPRFLTSEG FLT
 WHERE MST.CMPCOD = SEG.CMPCOD(+)
   AND MST.MSTDOCNUM = SEG.MSTDOCNUM(+)
   AND MST.DOCOWRIDR = SEG.DOCOWRIDR(+)
   AND MST.DUPNUM = SEG.DUPNUM(+)
      AND SEG.CMPCOD=FLT.CMPCOD
   AND SEG.FLTCARIDR = FLT.FLTCARIDR
   AND SEG.FLTSEQNUM = FLT.FLTSEQNUM
   AND SEG.SEGSERNUM = FLT.SEGSERNUM
   AND SEG.FLTNUM = FLT.FLTNUM

   AND MST.CMPCOD = ?
   AND SEG.FLTNUM = ?
   AND SEG.FLTSEQNUM = ?
   AND SEG.FLTCARIDR = ?

	]]>
</QRY:Source>
</QRY:Definition>


<QRY:Definition>
  <QRY:Id>177</QRY:Id>
  <QRY:Source Name="operations.shipment.findfsashipmentdetails" Type="NATIVE">
  <![CDATA[
  SELECT MST.CMPCOD, MST.DOCOWRIDR, SHPPFX, MST.MSTDOCNUM, MST.DUPNUM,
         MST.SEQNUM, CNSCOD, CNSNAM, SHPCOD, SHPNAM, STDPCS, STDWGT, ORGCOD,
         DSTCOD, ARPCOD, AVLPCS, MFTPCS, MFTWGT, CUSCLRSTA, RCVPCS, RCVWGT,
         AVLWGT, DOCRCVFLG, HDRTOO, HDRTIM, HDRRMK, TOTDLVPCS, TOTDLVWGT,
         TRNSITPCS, TRNSITWGT, TFRINPCS, TFRINWGT, TFROUTPCS, TFROUTWGT, ACPPCS,
         ACPWGT, SYSPAR.PARVAL
    FROM OPRSHPMST  MST, OPRARPSHP ARPSHP, SHRSYSPAR SYSPAR
   WHERE MST.CMPCOD = ARPSHP.CMPCOD
     AND MST.MSTDOCNUM = ARPSHP.MSTDOCNUM
     AND MST.DOCOWRIDR = ARPSHP.DOCOWRIDR
     AND MST.DUPNUM = ARPSHP.DUPNUM
     AND MST.SEQNUM = ARPSHP.SEQNUM
     AND MST.CMPCOD = SYSPAR.CMPCOD
     AND ARPSHP.AVLPCS+ARPSHP.TRNSITPCS+ARPSHP.TOTDLVPCS+ARPSHP.TFROUTPCS>0
     AND MST.CMPCOD = ?
     AND MST.MSTDOCNUM = ?
     AND MST.DOCOWRIDR = ?
     AND MST.DUPNUM = ?
     AND MST.SEQNUM = ?
     AND SYSPAR.PARCOD = ?
   ]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
	<QRY:Id>178</QRY:Id>
	<QRY:Source Name="operations.shipment.findshipmentpiecesfromwarehouse" Type="NATIVE">
	<![CDATA[
	SELECT SHPPCS.MSTDOCNUM, SHPPCS.DOCOWRIDR, SHPPCS.DUPNUM, SHPPCS.SEQNUM, SHPPCS.TXNHISIDR,
	       SHPPCS.GRPIDR PCSIDR, OPRSHP.PCSWGT,SHPPCS.CMPCOD, SHPPCS.ARPCOD, SHPPCS.TXNCOD, SHPPCS.TXNREFONE,
	       SHPPCS.TXNREFTWO, SHPPCS.TXNREFTHR, SHPPCS.TXNREFFOR, SHPPCS.TXNREFFIV,
	       SHPPCS.TXNREFSIX, SHPPCS.TXNREFSEV, SHPPCS.TXNREFEGT, SHPPCS.TXNREFNIN,
	       SHPPCS.TXNREFTEN, DTL.PCSIDR DTLPCSIDR, DTL.WHSCOD, DTL.LOCCOD,
	       DTL.STUCOD, DTL.PCSDES,DTL.ARPCOD DTLARPCOD
	  FROM OPRSHPTXNPCSGRPHIS SHPPCS, WHSPCSDTL DTL ,OPRSHPPCSGRP OPRSHP
	 WHERE SHPPCS.MSTDOCNUM = DTL.MSTDOCNUM(+)
	   AND SHPPCS.DOCOWRIDR = DTL.DOCOWRIDR(+)
	   AND SHPPCS.DUPNUM = DTL.DUPNUM(+)
	   AND SHPPCS.SEQNUM = DTL.SEQNUM(+)
	   AND SHPPCS.GRPIDR = DTL.PCSIDR(+)
	   AND SHPPCS.CMPCOD = DTL.CMPCOD(+)
	   AND SHPPCS.MSTDOCNUM = OPRSHP.MSTDOCNUM
	   AND SHPPCS.DOCOWRIDR = OPRSHP.DOCOWRIDR
	   AND SHPPCS.DUPNUM = OPRSHP.DUPNUM
	   AND SHPPCS.SEQNUM = OPRSHP.SEQNUM
	   AND SHPPCS.GRPIDR = OPRSHP.GRPIDR
	   AND SHPPCS.CMPCOD = OPRSHP.CMPCOD
	   AND SHPPCS.TXNCOD=?
	   AND SHPPCS.CMPCOD=?
	   AND SHPPCS.DOCOWRIDR = ?
	   AND SHPPCS.MSTDOCNUM = ?
	   AND SHPPCS.DUPNUM = ?
	   AND SHPPCS.SEQNUM = ?
   ]]>
</QRY:Source>
</QRY:Definition>


<QRY:Definition>
	<QRY:Id>179</QRY:Id>
	<QRY:Source Name="operations.shipment.findfsuawddetails" Type="NATIVE">
	<![CDATA[
		SELECT MST.DOMFLG,MST.MSTDOCNUM, MST.DOCOWRIDR, MST.DUPNUM, MST.SEQNUM, MST.CMPCOD, MST.SHPPFX, MST.STDPCS, MST.STDWGT,
		       MST.ORGCOD, MST.DSTCOD, MST.OWRCOD, MST.AGTCOD, AGTGRP.GRPNAM AGTGRP, MST.CNSCOD, CUSMST.CUSGRP CNSGRP,
		       ARP.AVLPCS, ARP.AVLWGT, ARP.HDRTIM, ARP.ARPCOD, SYS.PARVAL WGTCOD, ARL.TWOAPHCOD CARRCOD, SHPRTG.DSTCOD RTGCNT,MIS.JNVPAR,  SHRMST.CNTCOD
		  FROM OPRSHPMST MST,
		       OPRSHPDTL SHPDTL,
		       OPRARPSHP ARP,
		       SHRSYSPAR SYS,
		       SHRARLMST ARL,
		       SHRCUSMST CUSMST,
		       SHRGENMSTGRPDTL AGTGRP,
		       OPRSHPRTG SHPRTG,
			   OPRSHPMSTMIS MIS,
			   SHRARPMST SHRMST
		 WHERE MST.MSTDOCNUM = ARP.MSTDOCNUM
		   AND MST.DOCOWRIDR = ARP.DOCOWRIDR
		   AND MST.DUPNUM = ARP.DUPNUM
		   AND MST.SEQNUM = ARP.SEQNUM
		   AND MST.CMPCOD = ARP.CMPCOD
		   AND MST.MSTDOCNUM = SHPDTL.MSTDOCNUM
		   AND MST.DOCOWRIDR = SHPDTL.DOCOWRIDR
		   AND MST.DUPNUM = SHPDTL.DUPNUM
		   AND MST.SEQNUM = SHPDTL.SEQNUM
		   AND MST.CMPCOD = SHPDTL.CMPCOD
		   AND MST.CMPCOD = SYS.CMPCOD
		   AND MST.CMPCOD = ARL.CMPCOD
		   AND MST.DOCOWRIDR = ARL.ARLIDR
		   AND MST.CMPCOD = CUSMST.CMPCOD(+)
		   AND MST.SHPCOD = CUSMST.CUSCOD(+)
		   AND MST.CMPCOD = AGTGRP.CMPCOD(+)
		   AND MST.AGTCOD = AGTGRP.GRPENT(+)
           AND AGTGRP.GRPCATCOD(+) = 'GEN'
		   AND MST.MSTDOCNUM 		= SHPRTG.MSTDOCNUM(+)
			AND MST.DOCOWRIDR 		= SHPRTG.DOCOWRIDR(+)
			AND MST.DUPNUM 		 	= SHPRTG.DUPNUM(+)
			AND MST.SEQNUM 		 	= SHPRTG.SEQNUM(+)
			AND MST.CMPCOD 		 	= SHPRTG.CMPCOD(+)
			 AND MST.MSTDOCNUM =MIS.MSTDOCNUM(+)
				AND MST.DOCOWRIDR   =MIS.DOCOWRIDR(+)
				AND MST.DUPNUM      =MIS.DUPNUM(+)
				AND MST.SEQNUM      =MIS.SEQNUM(+)
				AND MST.CMPCOD      =MIS.CMPCOD(+)
				  AND MST.CMPCOD      = SHRMST.CMPCOD(+)
				AND MST.ORGCOD      =  SHRMST.ARPCOD(+)
		   AND MST.MSTDOCNUM = ?
		   AND MST.DOCOWRIDR = ?
		   AND MST.DUPNUM = ?
		   AND MST.SEQNUM = ?
		   AND MST.CMPCOD = ?
		   AND ARP.ARPCOD=?
    	   AND SYS.PARCOD = ?


    	   ]]>
</QRY:Source>
</QRY:Definition>


<QRY:Definition>
	<QRY:Id>180</QRY:Id>
	<QRY:Source Name="operations.shipment.findfsuccddetails" Type="NATIVE">
	<![CDATA[
	SELECT MST.MSTDOCNUM, MST.DOCOWRIDR, MST.DUPNUM, MST.SEQNUM, MST.CMPCOD,
		       MST.SHPPFX, MST.STDPCS, MST.STDWGT, MST.ORGCOD, MST.DSTCOD,
		        ARP.AVLPCS, ARP.AVLWGT, ARP.LSTUPDTIM HDRTIM,
		       ARP.ARPCOD,
		       SYS.PARVAL WGTCOD, ARL.TWOAPHCOD CARRCOD
		  FROM OPRSHPMST  MST, OPRSHPDTL SHPDTL ,OPRARPSHP ARP, SHRSYSPAR SYS,SHRARLMST ARL
		 WHERE MST.MSTDOCNUM = ARP.MSTDOCNUM
		   AND MST.DOCOWRIDR = ARP.DOCOWRIDR
		   AND MST.DUPNUM = ARP.DUPNUM
		   AND MST.SEQNUM = ARP.SEQNUM
		   AND MST.CMPCOD = ARP.CMPCOD
		   AND MST.MSTDOCNUM = SHPDTL.MSTDOCNUM
		   AND MST.DOCOWRIDR = SHPDTL.DOCOWRIDR
		   AND MST.DUPNUM = SHPDTL.DUPNUM
		   AND MST.SEQNUM = SHPDTL.SEQNUM
		   AND MST.CMPCOD = SHPDTL.CMPCOD
		   AND MST.CMPCOD = SYS.CMPCOD
		   AND MST.CMPCOD = ARL.CMPCOD
		   AND MST.DOCOWRIDR = ARL.ARLIDR
		   AND MST.MSTDOCNUM = ?
		   AND MST.DOCOWRIDR = ?
		   AND MST.DUPNUM = ?
		   AND MST.SEQNUM = ?
		   AND MST.CMPCOD = ?
		   AND ARP.ARPCOD=?
    	   	   AND SYS.PARCOD = ?

    	   ]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>181</QRY:Id>
	<QRY:Source Name="operations.shipment.isratelineused" Type="NATIVE">
	<![CDATA[
SELECT 	CMPCOD FROM OPRSHPRATDTL
WHERE CMPCOD = ? AND
	( ARLRATLINIDR = ? OR IATRATLINIDR = ? )AND
	( IATTRFNAM = ? OR ARLTRFNAM = ? ) AND
	( IATTRFSERNUM = ? OR ARLTRFSERNUM = ? ) AND
	( IATTRFRATSERNUM = ? OR ARLTRFRATSERNUM = ? )
   ]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>182</QRY:Id>
<QRY:Source Name="operations.shipment.findratelineshipments" Type="NATIVE">
	<![CDATA[
SELECT CMPCOD,MSTDOCNUM,DOCOWRIDR,DUPNUM,SEQNUM FROM OPRSHPRATDTL
	WHERE CMPCOD = ? AND
	(ARLRATLINIDR = ? OR IATRATLINIDR = ? ) AND
	( IATTRFNAM = ? OR ARLTRFNAM = ? )  AND
	( IATTRFSERNUM = ? OR ARLTRFSERNUM = ?  ) AND
	( IATTRFRATSERNUM = ? OR ARLTRFRATSERNUM = ? )
   ]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
	<QRY:Id>183</QRY:Id>
	<QRY:Source Name="operations.shipment.findslacreports" Type="NATIVE">
	<![CDATA[
	SELECT MST.CMPCOD AS CMPCOD, MST.MSTDOCNUM AS MSTDOCNUM, MST.DOCNUM AS DOCNUM,
	       MST.DUPNUM AS DUPNUM, MST.SEQNUM AS SEQNUM,MST.ORGCOD AS ORG,MST.SHPPFX AS SHPPFX, MST.DSTCOD AS DEST,
	       MST.CNSNAM AS CNSNAM, MST.SHPNAM AS SHPNAM, MST.DOCOWRIDR AS OWNIDR,
	       FLT.POU AS POU, MST.SLCPCS AS SLCPCS,MST.SHPDES AS DES, MST.STDPCS AS STDPCS,
	       MST.STDWGT AS STDWGT, HSE.PCS AS ACPPCS, HSE.WGT AS ACPWGT
	  FROM OPRSHPMST  MST,
	       OPRSEGSHP SEG,
	       OPRFLTSEG FLT,
	       OPRTXNHSE HSE,
	       OPRARPEXPFLT EXP
	 WHERE MST.CMPCOD = SEG.CMPCOD(+)
	   AND MST.MSTDOCNUM = SEG.MSTDOCNUM(+)
	   AND MST.DOCOWRIDR = SEG.DOCOWRIDR(+)
	   AND MST.DUPNUM = SEG.DUPNUM(+)
	   AND MST.MSTDOCNUM = HSE.MSTDOCNUM(+)
	   AND MST.DOCOWRIDR = HSE.DOCOWRIDR(+)
	   AND MST.DUPNUM = HSE.DUPNUM(+)
	   AND SEG.CMPCOD = FLT.CMPCOD
	   AND SEG.FLTCARIDR = FLT.FLTCARIDR
	   AND SEG.FLTSEQNUM = FLT.FLTSEQNUM
	   AND SEG.SEGSERNUM = FLT.SEGSERNUM
	   AND SEG.FLTNUM = FLT.FLTNUM
	   AND FLT.FLTNUM = EXP.FLTNUM
	   AND FLT.FLTCARIDR = EXP.FLTCARIDR
	   AND FLT.FLTSEQNUM = EXP.FLTSEQNUM
	   AND FLT.POL = EXP.ARPCOD
	   AND MST.SLCPCS > 0
	   AND MST.CMPCOD = ?
	   AND EXP.FLTNUM = ?
	   AND EXP.FLTSEQNUM = ?
	   AND EXP.FLTCARIDR = ?
	   AND EXP.LEGSERNUM = ?
	   AND HSE.TXNCOD (+)= ?
   ]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>182</QRY:Id>
<QRY:Source Name="operations.shipment.findExpectedArrivalInformationForShipmentTracking" Type="NATIVE">
	<![CDATA[
	SELECT FLTSEG.CMPCOD,FLTSEG.FLTCARIDR,FLTSEG.FLTNUM,FLTSEG.FLTSEQNUM,
		   FLTSEG.POU,FLTSEG.POL,
		   SEGSHP.DOCOWRIDR,SEGSHP.MSTDOCNUM,SEGSHP.DUPNUM,SEGSHP.SEQNUM,
		   SEGSHP.MFTPCS-SEGSHP.RCVPCS TRNSITPCS,SEGSHP.MFTWGT-SEGSHP.RCVWGT TRNSITWGT,
		   IMPFLT.FLTCARCOD,IMPFLT.FLTDAT
	FROM OPRSEGSHP SEGSHP,OPRFLTSEG FLTSEG,OPRARPSHP ARPSHP,OPRARPIMPFLT IMPFLT
	WHERE SEGSHP.CMPCOD    = FLTSEG.CMPCOD
	  AND SEGSHP.FLTCARIDR = FLTSEG.FLTCARIDR
	  AND SEGSHP.FLTNUM    = FLTSEG.FLTNUM
	  AND SEGSHP.FLTSEQNUM = FLTSEG.FLTSEQNUM
	  AND SEGSHP.SEGSERNUM = FLTSEG.SEGSERNUM
	  AND FLTSEG.CMPCOD    = ARPSHP.CMPCOD
	  AND FLTSEG.POL       = ARPSHP.ARPCOD
	  AND SEGSHP.MFTPCS-SEGSHP.RCVPCS > 0
	  AND ARPSHP.TRNSITPCS > 0
	  AND SEGSHP.CMPCOD = ?
	  AND SEGSHP.DOCOWRIDR = ?
	  AND SEGSHP.MSTDOCNUM = ?
	  AND SEGSHP.DUPNUM    = ?
	  AND SEGSHP.SEQNUM    = ?
   ]]>
</QRY:Source>
</QRY:Definition>



<QRY:Definition>
<QRY:Id>182</QRY:Id>
<QRY:Source Name="operations.shipment.findShipmentTrackingDetails" Type="NATIVE">
	<![CDATA[
	SELECT MST.CMPCOD, MST.DOCOWRIDR, SHPPFX, MST.MSTDOCNUM, MST.DUPNUM,
	  	       MST.SEQNUM, MST.SHPDES, CNSCOD, CNSNAM, SHPCOD, SHPNAM, STDPCS, STDWGT, ORGCOD,
		       DSTCOD, ARPCOD, AVLPCS, MFTPCS, MFTWGT, CUSCLRSTA, RCVPCS, RCVWGT,
		       AVLWGT, DOCRCVFLG, HDRTOO, HDRTIM, HDRRMK, TOTDLVPCS, TOTDLVWGT,
		       TRNSITPCS, TRNSITWGT, TFRINPCS, TFRINWGT, TFROUTPCS, TFROUTWGT, ACPPCS,
		       ACPWGT, SYSPAR.PARVAL,MST.SHPSTA
		  FROM OPRSHPMST  MST, OPRARPSHP ARPSHP, SHRSYSPAR SYSPAR
		 WHERE MST.CMPCOD = ARPSHP.CMPCOD
		   AND MST.MSTDOCNUM = ARPSHP.MSTDOCNUM
		   AND MST.DOCOWRIDR = ARPSHP.DOCOWRIDR
		   AND MST.DUPNUM = ARPSHP.DUPNUM
		   AND MST.SEQNUM = ARPSHP.SEQNUM
		   AND MST.CMPCOD = SYSPAR.CMPCOD
		   AND MST.CMPCOD = ?
		   AND MST.MSTDOCNUM = ?
		   AND MST.DOCOWRIDR = ?
		   AND MST.DUPNUM = ?
		   AND MST.SEQNUM = ?
	   	   AND SYSPAR.PARCOD = ?
   ]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>182</QRY:Id>
<QRY:Source Name="operations.shipment.findExpectedDepartureDetailsForShipmentTracking" Type="NATIVE">
	<![CDATA[
	SELECT SEGSHP.DOCOWRIDR,SEGSHP.MSTDOCNUM,SEGSHP.DUPNUM,SEGSHP.SEQNUM,
	  		 BKGMST.UBRNUM,
			 FLTDTL.FLTCARIDR,FLTDTL.FLTCARCOD,FLTDTL.FLTNUM,FLTDTL.FLTDAT,
 			 FLTDTL.NUMPCS,FLTDTL.WGT
	  FROM OPRSEGSHP SEGSHP,CAPBKGMST BKGMST,CAPBKGFLTDTL FLTDTL
	  WHERE SEGSHP.CMPCOD    = BKGMST.CMPCOD
	  	AND SEGSHP.DOCOWRIDR = BKGMST.DOCOWRIDR
	        AND SEGSHP.MSTDOCNUM = BKGMST.MSTDOCNUM
		AND SEGSHP.DUPNUM    = BKGMST.DUPNUM
		AND SEGSHP.SEQNUM    = BKGMST.SEQNUM
		AND BKGMST.CMPCOD    = FLTDTL.CMPCOD
		AND BKGMST.UBRNUM    = FLTDTL.UBRNUM
	  	AND SEGSHP.CMPCOD = ?
	        AND SEGSHP.DOCOWRIDR = ?
	        AND SEGSHP.MSTDOCNUM = ?
	        AND SEGSHP.DUPNUM    = ?
    	        AND SEGSHP.SEQNUM    = ?
   ]]>
</QRY:Source>
</QRY:Definition>


<QRY:Definition>
<QRY:Id>182</QRY:Id>
<QRY:Source Name="operations.shipment.findShipmentHistoryDetails" Type="NATIVE">
	<![CDATA[
	SELECT DTL.CMPCOD,DTL.DOCOWRIDR,DTL.MSTDOCNUM,DTL.DUPNUM,DTL.SEQNUM,
	       DTL.TOTACPPCS,DTL.TOTDLVPCS,DTL.TOTACPWGT,DTL.TOTDLVWGT,DTL.DLVDATUTC,DTL.ACPDATUTC,
	       DTL.ACPARPCOD,DTL.DLVARPCOD,
	       HIS.ARPCOD TRFARPCOD,HIS.INBFLTCARIDR,HIS.INBFLTCARCOD,
	       HIS.OUTFLTCARCOD,HIS.OUTFLTCARIDR,HIS.OUTFLTNUM,HIS.OUTFLTDAT,
	       HIS.OUTFLTSEQNUM,HIS.TXNTIM,HIS.TRFPCS,HIS.TRFWGT
	FROM  OPRSHPDTL DTL LEFT OUTER JOIN OPRSHPTRFHIS HIS
	  ON  DTL.CMPCOD    = HIS.CMPCOD
	  AND DTL.DOCOWRIDR = HIS.DOCOWRIDR
	  AND DTL.MSTDOCNUM = HIS.MSTDOCNUM
	  AND DTL.DUPNUM    = HIS.DUPNUM
	  AND DTL.SEQNUM    = HIS.SEQNUM
	WHERE DTL.CMPCOD = ?
	 AND  DTL.DOCOWRIDR = ?
	 AND  DTL.MSTDOCNUM = ?
	 AND  DTL.DUPNUM = ?
 	 AND  DTL.SEQNUM = ?
 ]]>
</QRY:Source>
</QRY:Definition>


<QRY:Definition>
<QRY:Id>182</QRY:Id>
<QRY:Source Name="operations.shipment.findShipmentArrivalDetails" Type="NATIVE">
	<![CDATA[
	SELECT FLTOWN as FLTCARCOD, LEGSERNUM, LEG.FLTSEQNUM, LEG.FLTNUM, LEG.FLTCARIDR,
	       LEG.CMPCOD, LEGORG, LEGDST, STA, STD,FLTMST.FLTDAT,LEG.STAUTC,LEG.STDUTC,
	       SEG.SEGORG,SEG.SEGDST,SEGSHP.MFTPCS,SEGSHP.MFTWGT,SEGSHP.RCVPCS,SEGSHP.RCVWGT
	FROM FLTOPRMST FLTMST, FLTOPRLEG LEG, OPRSEGSHP SEGSHP,FLTOPRSEG SEG
	WHERE FLTMST.FLTNUM = LEG.FLTNUM
	   AND FLTMST.FLTCARIDR = LEG.FLTCARIDR
	   AND FLTMST.CMPCOD = LEG.CMPCOD
	   AND FLTMST.FLTSEQNUM = LEG.FLTSEQNUM
	   AND FLTMST.FLTNUM = SEGSHP.FLTNUM
	   AND FLTMST.FLTCARIDR = SEGSHP.FLTCARIDR
	   AND FLTMST.CMPCOD = SEGSHP.CMPCOD
	   AND FLTMST.FLTSEQNUM = SEGSHP.FLTSEQNUM
	   AND SEGSHP.CMPCOD = SEG.CMPCOD
	   AND SEGSHP.FLTNUM = SEG.FLTNUM
	   AND SEGSHP.FLTCARIDR = SEG.FLTCARIDR
	   AND SEGSHP.FLTSEQNUM = SEG.FLTSEQNUM
	   AND SEGSHP.SEGSERNUM = SEG.SEGSERNUM
	   AND SEGSHP.CMPCOD = ?
	   AND SEGSHP.DOCOWRIDR = ?
	   AND SEGSHP.MSTDOCNUM = ?
	   AND SEGSHP.DUPNUM = ?
	   AND SEGSHP.SEQNUM = ?
 ]]>
</QRY:Source>
</QRY:Definition>


<QRY:Definition>
<QRY:Id>183</QRY:Id>
<QRY:Source Name="operations.shipment.findCTOULDDetailsAtAirport" Type="NATIVE">
	<![CDATA[
			SELECT
							ARPULD.CMPCOD ARPULDCMPCOD, ARPULD.ARPCOD ARPULDARPCOD,
							ARPULD.ULDNUM ARPULDULDNUM,
							ARPULD.GRSWGT ARPULDGRSWGT, ARPULD.NETWGT ARPULDNETWGT,
							ARPULD.TARWGT ARPULDTARWGT, ARPULD.REFSERNUM ARPULDREFSERNUM,
							ARPULD.POU ARPULDPOU,
							ULDSHP.DOCOWRIDR ULDSHPDOCOWRIDR, ULDSHP.MSTDOCNUM ULDSHPMSTDOCNUM,
							ULDSHP.DUPNUM ULDSHPDUPNUM, ULDSHP.SEQNUM ULDSHPSEQNUM,
							ULDSHP.ULDNUM ULDSHPULDNUM, ULDSHP.NUMPCS ULDSHPNUMPCS,
							ULDSHP.WGT ULDSHPWGT, ULDSHP.VOL ULDSHPVOL,
							SHPMST.STDPCS SHPMSTSTDPCS, SHPMST.STDWGT SHPMSTSTDWGT,
							SHPMST.STDDISWGT SHPMSTSTDDISWGT, SHPMST.STDWGTCOD SHPMSTSTDWGTCOD,
							SHPMST.SHPPFX SHPMSTSHPPFX, SHPMST.SCCCOD SHPMSTSCCCOD,
							SHPMST.SHPDES SHPMSTSHPDES, SHPMST.ORGCOD SHPMSTORGCOD,
							SHPMST.DSTCOD SHPMSTDSTCOD, SHPMST.UBRNUM SHPMSTUBRNUM,
							SHPMST.OWRCOD SHPMSTOWRCOD, SHPMST.GRSVOL SHPMSTGRSVOL,
							ULDACP.POU ULDACPPOU,
							ULDACP.SERNUM ULDACPSERNUM, ULDACP.WHSCOD ULDACPWHSCOD,
							ULDACP.LOCCOD ULDACPLOCCOD, ULDACP.GRSWGT ULDACPGRSWGT,
							ULDACP.GRSDISWGT ULDACPGRSDISWGT, ULDACP.GRSWGTCOD ULDACPGRSWGTCOD,
							ULDACP.TARWGT ULDACPTARWGT, ULDACP.TARDISWGT ULDACPTARDISWGT,
							ULDACP.TARWGTCOD ULDACPTARWGTCOD, ULDACP.RATTYP ULDACPRATTYP,
							ULDACPDTL.CMDITMNAM ULDACPDTLCMDITMNAM, ULDACPDTL.SCCCOD ULDACPDTLSCCCOD, ULDACPDTL.ULDCTR ULDCTR,
							ULDACPDTL.SHPDES ULDACPDTLSHPDES, ULDACPDTL.SHPRMK ULDACPDTLSHPRMK,
							ACPDIM.DIMSERNUM ACPDIMDIMSERNUM ,
							ACPDIM.PCSLEN ACPDIMPCSLEN, ACPDIM.PCSHGT ACPDIMPCSHGT,
							ACPDIM.PCSWID ACPDIMPCSWID, ACPDIM.PCSVOL ACPDIMPCSVOL,
							ACPDIM.NUMPCS ACPDIMNUMPCS, ACPDIM.WGT ACPDIMWGT,
							ACPDIM.DISWGT ACPDIMDISWGT, ACPDIM.WGTCOD ACPDIMWGTCOD,
							SHPDTL.TOTACPPCS SHPDTLTOTACPPCS, SHPDTL.TOTACPWGT SHPDTLTOTACPWGT,
							SHPDTL.TOTACPVOL SHPDTLTOTACPVOL,SHPMST.CONFLG,
							(CASE ARLMST.APHCODUSE
							   WHEN 2
							      THEN ARLMST.TWOAPHCOD
							   ELSE ARLMST.THRAPHCOD
							END
						       ) FLTCARCOD
						FROM
							OPRARPULD ARPULD
						    LEFT OUTER JOIN OPRULDSHP ULDSHP ON
						    		ARPULD.CMPCOD = ULDSHP.CMPCOD
						    	AND	ARPULD.ARPCOD = ULDSHP.ARPCOD
						    	AND	ARPULD.ULDNUM =	ULDSHP.ULDNUM
						    LEFT OUTER JOIN OPRULDACP ULDACP ON
						    		ULDSHP.CMPCOD = ULDACP.CMPCOD
						    	AND     ULDSHP.ARPCOD = ULDACP.ARPCOD
						    	AND	ULDSHP.ULDNUM = ULDACP.ULDNUM						    	
						      LEFT OUTER JOIN OPRSHPMST  SHPMST ON
							    		ULDSHP.CMPCOD = SHPMST.CMPCOD
								AND ULDSHP.DOCOWRIDR = SHPMST.DOCOWRIDR
								AND ULDSHP.MSTDOCNUM = SHPMST.MSTDOCNUM
								AND ULDSHP.DUPNUM = SHPMST.DUPNUM
								AND ULDSHP.SEQNUM = SHPMST.SEQNUM
							LEFT OUTER JOIN OPRULDACPDTL  ULDACPDTL ON
								 ULDSHP.CMPCOD = ULDACPDTL.CMPCOD
							    AND  ULDSHP.ARPCOD = ULDACPDTL.ARPCOD
							    AND  ULDSHP.MSTDOCNUM = ULDACPDTL.MSTDOCNUM
							    AND  ULDSHP.DOCOWRIDR = ULDACPDTL.DOCOWRIDR
							    AND  ULDSHP.DUPNUM = ULDACPDTL.DUPNUM
							    AND  ULDSHP.SEQNUM = ULDACPDTL.SEQNUM
							    AND  ULDSHP.ULDNUM = ULDACPDTL.ULDNUM
							 LEFT OUTER JOIN OPRSHPDIMACP ACPDIM ON
									ULDSHP.CMPCOD = ACPDIM.CMPCOD
								AND     ULDSHP.ARPCOD = ACPDIM.ARPCOD
								AND	ULDSHP.DOCOWRIDR = ACPDIM.DOCOWRIDR
								AND	ULDSHP.MSTDOCNUM = ACPDIM.MSTDOCNUM
								AND	ULDSHP.DUPNUM = ACPDIM.DUPNUM
								AND	ULDSHP.SEQNUM = ACPDIM.SEQNUM
							   INNER JOIN SHRARLMST ARLMST ON
							   		ULDACP.CMPCOD = ARLMST.CMPCOD
							   	AND	ULDACP.FLTCARIDR = ARLMST.ARLIDR
							    LEFT OUTER JOIN OPRSHPDTL SHPDTL ON
									SHPMST.CMPCOD = SHPDTL.CMPCOD
								AND SHPMST.DOCOWRIDR = SHPDTL.DOCOWRIDR
								AND SHPMST.MSTDOCNUM = SHPDTL.MSTDOCNUM
								AND SHPMST.DUPNUM = SHPDTL.DUPNUM
								AND SHPMST.SEQNUM = SHPDTL.SEQNUM

						WHERE
							ARPULD.CMPCOD = ?
						   AND	ARPULD.ARPCOD = ?
			   			AND	ARPULD.ULDNUM = ?
	 ]]>
</QRY:Source>
</QRY:Definition>


<QRY:Definition>
<QRY:Id>184</QRY:Id>
<QRY:Source Name="operations.shipment.findDamageImage" Type="NATIVE">
	<![CDATA[
			SELECT
				IMG
			FROM
				OPRDMGDISBLB
			WHERE  CMPCOD = ?
			AND ARPCOD = ?
			AND DOCOWRIDR = ?
			AND MSTDOCNUM = ?
			AND SEQNUM = ?
			AND DUPNUM = ?
			AND DISSEQNUM = ?
	 ]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>185</QRY:Id>
<QRY:Source Name="operations.shipment.findDisruptionListShipmentDetails" Type="NATIVE">
	<![CDATA[
		SELECT ULDSHP.ULDNUM ULDNUM,ULDSHP.NUMPCS PCS,ULDSHP.WGT WGT,ULDSHP.VOL VOL,RAT.ARLRAT,
		SHPMST.ORGCOD ORGCOD,SHPMST.DSTCOD DSTCOD,
		SHPMST.MSTDOCNUM MSTDOCNUM,SHPMST.DOCOWRIDR DOCOWNIDR,SHPMST.DUPNUM DUPNUM,
		SHPMST.SEQNUM SEQNUM,SHPMST.SHPPFX SHPPFX,
		SHPMST.STDPCS STDPCS,SHPMST.STDWGT STDWGT,
		SHPMST.GRSVOL STDVOL,MAX(SHPMST.LSTUPDTIM) SHPLSTUPDTIM,SHPMST.UBRNUM UBRNUM
		FROM
			OPRSHPMST  SHPMST,OPRULDSHP ULDSHP,OPRSHPRATDTL RAT

		WHERE
			 SHPMST.CMPCOD = RAT.CMPCOD
			 AND SHPMST.DOCOWRIDR = RAT.DOCOWRIDR
			 AND SHPMST.MSTDOCNUM = RAT.MSTDOCNUM
			 AND SHPMST.DUPNUM = RAT.DUPNUM
			 AND SHPMST.SEQNUM = RAT.SEQNUM

			AND SHPMST.MSTDOCNUM = ULDSHP.MSTDOCNUM
			AND SHPMST.DOCOWRIDR = ULDSHP.DOCOWRIDR
			AND SHPMST.DUPNUM = ULDSHP.DUPNUM
			AND SHPMST.SEQNUM = ULDSHP.SEQNUM
			AND SHPMST.CMPCOD = ULDSHP.CMPCOD

		AND ULDSHP.ARPCOD = ?
	 ]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>184</QRY:Id>
<QRY:Source Name="operations.shipment.findhousesfortransaction" Type="NATIVE">
	<![CDATA[
	SELECT HSE.CMPCOD, HSE.ARPCOD, HSE.DOCOWRIDR, HSE.MSTDOCNUM, HSE.DUPNUM,
		       HSE.SEQNUM, HSE.TXNCOD, HSE.TXNREFONE, HSE.TXNREFTWO, HSE.TXNREFTHR,
		       HSE.TXNREFFOR, HSE.TXNREFFIV, HSE.TXNREFSIX, HSE.TXNREFNIN, HSE.TXNREFSEV, HSE.DOCNUM, HSE.PCS,
		       HSE.WGT, HSE.SERNUM,MST.SHPDES, MST.STDPCS, MST.STDWGT, MST.SLCPCS,
		       HSE.LSTUPDTIM ,HSE.LSTUPDUSR,  MST.ORGCOD,  MST.DSTCOD, MST.SCCCOD, CNT.CNSCTY, MST.CNSCOD,
			  MST.CNSNAM,
			  MST.SHPCOD,
			  MST.SHPNAM,
			  MST.SHPADRONE,
			  MST.CNSADRONE,
			  CNT.CNSADRTWO,
			  CNT.SHPADRTWO,
			  CNT.CNSSTT,
			  CNT.CNSCTR,
			  CNT.CNSPSTCOD,
			  CNT.SHPCTY,
			  CNT.SHPSTT,
			  CNT.SHPCTR,
			  CNT.SHPPSTCOD,
			    (SELECT RTRIM ( XMLAGG ( XMLELEMENT ( OCI, CUSINF
					|| ',' ) ) .EXTRACT ( '//text()' ), ',' ) CUSINF
				  FROM OPRSHPOCI OCI
				  WHERE OCI.CMPCOD  = MST.CMPCOD
				  AND OCI.DOCOWRIDR = MST.DOCOWRIDR
				  AND OCI.MSTDOCNUM = MST.MSTDOCNUM
				  AND OCI.SEQNUM    = MST.SEQNUM
				  AND OCI.DUPNUM    = MST.DUPNUM
				  AND OCI.CNTCOD    = 'US'
				  AND OCI.INFIDF    = 'EXP'
				  AND OCI.CUSINFIDF = 'M'
				  )CUSINF
		  FROM OPRTXNHSE HSE,OPRSHPMST MST,OPRSHPMSTCNT CNT
		 WHERE
		   HSE.MSTDOCNUM =MST.MSTDOCNUM
		   AND HSE.DUPNUM = MST.DUPNUM
		   AND HSE.DOCOWRIDR = MST.DOCOWRIDR
		   AND HSE.CMPCOD = MST.CMPCOD
		   AND HSE.SEQNUM = MST.SEQNUM
		   AND CNT.DOCOWRIDR  = MST.DOCOWRIDR
			AND CNT.MSTDOCNUM  = MST.MSTDOCNUM
			AND CNT.DUPNUM    = MST.DUPNUM
			AND CNT.SEQNUM     = MST.SEQNUM
			AND CNT.CMPCOD     = MST.CMPCOD
		   AND HSE.MSTDOCNUM = ?
		   AND HSE.DUPNUM = ?
		   AND HSE.DOCOWRIDR = ?
		   AND HSE.CMPCOD = ?
   ]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>185</QRY:Id>
<QRY:Source Name="operations.shipment.findacceptanceflightdetails" Type="NATIVE">
	<![CDATA[
	SELECT FLTCARCOD,FLTNUM,FLTDAT,POU,ULDNUM,PCS,WGT FROM OPRACPFLTDTL
	WHERE CMPCOD=? AND ARPCOD = ? AND MSTDOCNUM=? AND DOCOWRIDR=? AND DUPNUM=?
	AND SEQNUM=?
   ]]>
</QRY:Source>
</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>186</QRY:Id>
	<QRY:Source Name="operations.shipment.findULDAcceptanceDetailsForHHT" Type="NATIVE">
		<![CDATA[
			SELECT
				ULD.CMPCOD ULDCMPCOD, ULD.ULDNUM ULDULDNUM,
				ULD.FLTCARIDR ULDFLTCARIDR, ULD.FLTNUM ULDFLTNUM,
				ULD.FLTSEQNUM ULDFLTSEQNUM, ULD.POL ULDPOL,
			    ULD.POU ULDPOU, ULD.CLSFLG ULDCLSFLG,
			    ULD.LEGSERNUM ULDLEGSERNUM,
				EXPFLT.FLTDAT EXPFLTFLTDAT, EXPFLT.FLTSEQNUM EXPFLTFLTSEQNUM,
				ULDACP.RATTYP ULDACPRATTYP,
				(CASE ARLMST.APHCODUSE
				   WHEN 2
				      THEN ARLMST.TWOAPHCOD
				   ELSE ARLMST.THRAPHCOD
			    END) FLTCARCOD
			  FROM
			  	OPRULDDTL ULD
			LEFT OUTER JOIN OPRULDACP ULDACP ON
			 	  ULD.CMPCOD = ULDACP.CMPCOD
			      AND ULD.ULDNUM = ULDACP.ULDNUM
		       	  LEFT OUTER JOIN OPRARPEXPFLT EXPFLT ON
					     ULD.CMPCOD = EXPFLT.CMPCOD
					AND  ULD.FLTCARIDR = EXPFLT.FLTCARIDR
					AND  ULD.FLTNUM = EXPFLT.FLTNUM
					AND  ULD.FLTSEQNUM = EXPFLT.FLTSEQNUM
					AND  ULD.LEGSERNUM = EXPFLT.LEGSERNUM
					AND  ULD.POL = EXPFLT.ARPCOD
				LEFT OUTER JOIN SHRARLMST ARLMST ON
						  ULD.CMPCOD = ARLMST.CMPCOD
					 AND  ULD.FLTCARIDR = ARLMST.ARLIDR
		 	WHERE
		 		ULD.CMPCOD = ?
			    AND ULD.ULDNUM = ?
		 	    AND (ULD.CLSFLG IS NULL OR ULD.CLSFLG <> 'Y')
		 ]]>
	</QRY:Source>
	</QRY:Definition>


<QRY:Definition>

<QRY:Id>187</QRY:Id>
<QRY:Source Name="operations.shipment.findULDDeliveryDetails" Type="NATIVE">
	<![CDATA[
	SELECT SEGULDSHP.CMPCOD, NOTULD.ULDNUM, SEGULDSHP.DOCOWRIDR,
		       SEGULDSHP.MSTDOCNUM, SEGULDSHP.DUPNUM, SEGULDSHP.SEQNUM,
		       DLVNOT.DLVNOTSTA, DLVNOT.DLVNOTPCS, DLVNOT.DLVNOTWGT, DLVNOT.DLVNOTNUM,
		       ARPSHP.TOTDLVPCS, ARPSHP.TOTDLVWGT, ARPSHP.RCVPCS, ARPSHP.RCVWGT,
		       ARPSHP.ARPCOD, SHPMST.STDPCS, SHPMST.STDWGT, SHPMST.SHPPFX,
		       SHPMST.DOCNUM, SHPMST.PRDCOD, SHPMST.AGTCOD, SHPMST.SCCCOD,
		       SHPDTL.TOTDLVNOTWGT, SHPMST.CNSCOD, SHPMST.DOCNUM, SHPMST.CONFLG,
			   DLVNOT.DLVNOTPCS, DLVNOT.DLVNOTWGT, DLVNOT.DNTISSDAT, DLVNOT.PAYADVNUM,
			   DLVNOT.PAYADVISSDAT, DLVNOT.PAYADVEXPDAT, DLVNOT.DLVNOTSTA,DLVNOT.DLVPCS, DLVNOT.DLVWGT,
			   ARPSHP.LSTUPDTIM ARPLSTUPDTIM,ARPSHP.CONBDNFLG,SHPDTL.LSTUPDTIM SHPLSTUPDTIM,
			  (SELECT DECODE((COUNT(NOTLOC.LOCCOD)
				||'~'),'0~',NULL,(COUNT(NOTLOC.LOCCOD)
				||'~'))
				|| LISTAGG(NOTLOC.LOCCOD
				||'('
				||SUM(NOTLOC.LOCPCS)
				||')', ',') WITHIN GROUP (
			  ORDER BY NOTLOC.LOCCOD) AS LOCDTL
			  FROM OPRSHPDLVNOTLOC NOTLOC
			  WHERE NOTLOC.CMPCOD  = DLVNOT.CMPCOD
			  AND NOTLOC.ARPCOD    = DLVNOT.ARPCOD
			  AND NOTLOC.DLVNOTNUM = DLVNOT.DLVNOTNUM
			  AND NOTLOC.MSTDOCNUM = DLVNOT.MSTDOCNUM
			  AND NOTLOC.DOCOWRIDR = DLVNOT.DOCOWRIDR
			  AND NOTLOC.DUPNUM    = DLVNOT.DUPNUM
			  AND NOTLOC.SEQNUM    = DLVNOT.SEQNUM
			  GROUP BY NOTLOC.LOCCOD
			  )LOCDTL,
			NOTULD.DLVNOTPCS DNPCSINULD,
			NOTULD.DLVNOTWGT DNWGTINULD,
			NOTULD.DLVPCS DLVPCSINULD,
			NOTULD.DLVWGT DLVWGTINULD,
			SEGULDSHP.NUMPCS RCVPCSINULD,
			SEGULDSHP.WGT RCVWGTINULD,
			  SHPMST.PLTFLG,
			  ARPSHP.PLTUSEFLG ARPPLTUSEFLG,
			  SHPDTL.PLTUSEFLG PLTUSEFLG 
		  FROM OPRSHPMST SHPMST INNER JOIN OPRARPSHP ARPSHP ON SHPMST.CMPCOD =
		                                                                 ARPSHP.CMPCOD
		                                                  AND SHPMST.DOCOWRIDR =
		                                                              ARPSHP.DOCOWRIDR
		                                                  AND SHPMST.MSTDOCNUM =
		                                                              ARPSHP.MSTDOCNUM
		                                                  AND SHPMST.DUPNUM =
		                                                                 ARPSHP.DUPNUM
		                                                  AND SHPMST.SEQNUM =
				 														ARPSHP.SEQNUM
				 AND SHPMST.DSTCOD = ARPSHP.ARPCOD
				 LEFT OUTER JOIN OPRSHPDTL SHPDTL
					ON SHPDTL.CMPCOD     = ARPSHP.CMPCOD
					AND SHPDTL.DOCOWRIDR = ARPSHP.DOCOWRIDR
					AND SHPDTL.MSTDOCNUM = ARPSHP.MSTDOCNUM
					AND SHPDTL.DUPNUM    = ARPSHP.DUPNUM
					AND SHPDTL.SEQNUM    = ARPSHP.SEQNUM
				  LEFT OUTER JOIN OPRULDSHP SEGULDSHP ON ARPSHP.CMPCOD =
			      SEGULDSHP.CMPCOD
		       AND ARPSHP.DOCOWRIDR =
			      SEGULDSHP.DOCOWRIDR
		       AND ARPSHP.MSTDOCNUM =
			      SEGULDSHP.MSTDOCNUM
		       AND ARPSHP.DUPNUM =
			      SEGULDSHP.DUPNUM
		       AND ARPSHP.SEQNUM =
			      SEGULDSHP.SEQNUM LEFT OUTER JOIN OPRSHPDLVNOT DLVNOT ON ARPSHP.CMPCOD =
																		DLVNOT.CMPCOD
			 AND ARPSHP.ARPCOD =
				DLVNOT.ARPCOD
			 AND ARPSHP.DOCOWRIDR =
				DLVNOT.DOCOWRIDR
			 AND ARPSHP.MSTDOCNUM =
				DLVNOT.MSTDOCNUM
			 AND ARPSHP.DUPNUM =
				DLVNOT.DUPNUM
			 AND ARPSHP.SEQNUM =
				DLVNOT.SEQNUM 
			LEFT OUTER JOIN OPRSHPDLVNOTULD NOTULD
			ON DLVNOT.CMPCOD     = NOTULD.CMPCOD
			AND DLVNOT.ARPCOD    = NOTULD.ARPCOD
			AND DLVNOT.DLVNOTNUM  = NOTULD.DLVNOTNUM
				LEFT OUTER JOIN OPRSHPDTL SHPDTL ON SHPMST.CMPCOD =
										    SHPDTL.CMPCOD
									     AND SHPMST.DOCOWRIDR =
										    SHPDTL.DOCOWRIDR
									     AND SHPMST.MSTDOCNUM =
										    SHPDTL.MSTDOCNUM
									     AND SHPMST.DUPNUM =
										    SHPDTL.DUPNUM
									     AND SHPMST.SEQNUM = SHPDTL.SEQNUM
 WHERE SHPMST.CMPCOD = ?
   ]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>187</QRY:Id>
<QRY:Source Name="operations.shipment.findShipmentDetailsForCustoms" Type="NATIVE">
	<![CDATA[
		SELECT  MST.CMPCOD, MST.DOCOWRIDR,MST.SHPPFX,MST.MSTDOCNUM,
				MST.DUPNUM, MST.SEQNUM,MST.PLTFLG,MST.STDPCS,MST.DTACPTFLG,
				MST.STDWGT, MST.SCCCOD,MST.SHPDES,MST.ORGCOD, MST.GRSVOL,MST.CURCOD,MST.PAYTYP,
				MST.DSTCOD,mst.PRDNAM,mst.PRDPRT,DTL.PLTUSEFLG,MST.CNSNAM,MST.CNSADRONE,
				MST.SHPNAM,MST.SHPADRONE,MST.SHPSTA,MST.EXEFLG,ARPSHP.AVLPCS, ARPSHP.AVLWGT,
				MST.GRSVOLUNT,MST.STDWGTCOD,ARPSHP.PLTUSEFLG ARPSHPPLTUSEFLG,
				MST.CONFLG,CNT.CNSTELNUM,CNT.CNSCTY,CNT.CNSSTT,CNT.CNSCTR,CNT.CNSPSTCOD,
				CNT.SHPTELNUM,CNT.SHPCTY,CNT.SHPSTT,CNT.SHPCTR,CNT.SHPPSTCOD,
				MIS.SHPISOCNTCOD,MIS.CNEISOCNTCOD,ACC.TOTPPD,ACC.TOTCCF,
				FLT.FLTDAT FLTFLTDAT,
			       FLT.DUPNUM FLTDUPNUM, FLT.SEGSERNUM FLTSEGSERNUM, FLT.FLTNUM FLTFLTNUM,
			       FLT.DOCOWRIDR FLTDOCOWRIDR, FLT.SEQNUM FLTSEQNUM,
			       FLT.FLTCARIDR FLTFLTCARIDR, FLT.RTGSERNUM FLTRTGSERNUM,
			       FLT.RTESEQNUM FLTRTESEQNUM, FLT.FLTSEQNUM FLTFLTSEQNUM,
			       FLT.MSTDOCNUM FLTMSTDOCNUM, FLT.DSTCOD RTGDSTCOD,
			       FLT.FLTCARCOD FLTFLTCARCOD, FLT.CMPCOD FLTCMPCOD, FLT.DSTCOD FLTDSTCOD
			FROM OPRSHPMST  MST,OPRSHPDTL DTL,OPRARPSHP ARPSHP,OPRSHPMSTCNT CNT,
				 OPRSHPMSTMIS MIS,OPRSHPMSTACC ACC,OPRSHPRTG FLT
			WHERE
				MST.CMPCOD=DTL.CMPCOD(+) AND
				MST.DOCOWRIDR=DTL.DOCOWRIDR(+) AND
				MST.MSTDOCNUM=DTL.MSTDOCNUM(+) AND
				MST.DUPNUM=DTL.DUPNUM(+) AND
				MST.SEQNUM=DTL.SEQNUM(+) AND
				MST.CMPCOD=ARPSHP.CMPCOD(+) AND
				MST.DOCOWRIDR=ARPSHP.DOCOWRIDR(+) AND
				MST.MSTDOCNUM=ARPSHP.MSTDOCNUM(+) AND
				MST.DUPNUM=ARPSHP.DUPNUM(+) AND
				MST.SEQNUM=ARPSHP.SEQNUM(+) AND
				MST.CMPCOD=CNT.CMPCOD(+) AND
				MST.DOCOWRIDR=CNT.DOCOWRIDR(+) AND
				MST.MSTDOCNUM=CNT.MSTDOCNUM(+) AND
				MST.DUPNUM=CNT.DUPNUM(+) AND
				MST.SEQNUM=CNT.SEQNUM(+) AND
				MST.CMPCOD=MIS.CMPCOD(+) AND
				MST.DOCOWRIDR=MIS.DOCOWRIDR(+) AND
				MST.MSTDOCNUM=MIS.MSTDOCNUM(+) AND
				MST.DUPNUM=MIS.DUPNUM(+) AND
				MST.SEQNUM=MIS.SEQNUM(+) AND
				MST.CMPCOD=ACC.CMPCOD(+) AND
				MST.DOCOWRIDR=ACC.DOCOWRIDR(+) AND
				MST.MSTDOCNUM=ACC.MSTDOCNUM(+) AND
				MST.DUPNUM=ACC.DUPNUM(+) AND
				MST.SEQNUM=ACC.SEQNUM(+)
				AND MST.CMPCOD = FLT.CMPCOD(+)
				AND MST.DOCOWRIDR = FLT.DOCOWRIDR(+)
				AND MST.MSTDOCNUM = FLT.MSTDOCNUM(+)
				AND MST.DUPNUM = FLT.DUPNUM(+)
				AND MST.SEQNUM = FLT.SEQNUM(+) AND
				MST.CMPCOD=? AND
				MST.DOCOWRIDR=? AND
				MST.MSTDOCNUM=? AND
				MST.DUPNUM=? AND
		MST.SEQNUM=?
   ]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>187</QRY:Id>
<QRY:Source Name="operations.shipment.cto.findgroupdeliveryshpdetails" Type="NATIVE">
	<![CDATA[
	SELECT MST.CMPCOD MSTCMPCOD, MST.DOCOWRIDR MSTDOCOWRIDR, MST.SHPPFX MSTSHPPFX,
	       MST.MSTDOCNUM MSTMSTDOCNUM, MST.DUPNUM MSTDUPNUM, MST.SEQNUM MSTSEQNUM,
	       MST.CNSCOD, MST.CNSNAM, MST.STDPCS, MST.STDWGT, MST.SCCCOD, MST.SHPDES,
	       MST.ORGCOD, MST.DSTCOD, MST.DOCNUM, ARPSHP.ARPCOD, ARPSHP.AVLPCS,
	       ARPSHP.DNTUSEFLG, ARPSHP.RCVPCS, ARPSHP.RCVWGT, ARPSHP.AVLWGT,
	       ARPSHP.TOTDLVNOTPCS, ARPSHP.TOTDLVNOTWGT, ARPSHP.TOTDLVPCS,
	       ARPSHP.TOTDLVWGT, ARPSHP.BOE, DLVNOT.CMPCOD DLVNOTCMPCOD,
	       DLVNOT.ARPCOD DLVNOTARPCOD, DLVNOT.DLVNOTNUM DLVNOTDLVNOTNUM,
	       DLVNOT.DOCOWRIDR DLVNOTDOCOWRIDR, DLVNOT.MSTDOCNUM DLVNOTMSTDOCNUM,
	       DLVNOT.DUPNUM DLVNOTDUPNUM, DLVNOT.SEQNUM DLVNOTSEQNUM,
	       DLVNOT.DLVNOTPCS DLVNOTDLVNOTPCS, DLVNOT.DLVNOTWGT DLVNOTDLVNOTWGT,
	       DLVNOT.DOCNUM DLVNOTDOCNUM, DLVNOT.DLVNOTSTA DLVNOTDLVNOTSTA,
	       DLVNOT.DNTISSDAT, DLVNOT.PAYADVNUM,DLVNOT.PAYADVISSDAT, DLVNOT.PAYADVEXPDAT,
	       DLVNOT.DLVPCS DLVNOTDLVPCS, DLVNOT.DLVWGT DLVNOTDLVWGT, DTL.PLTUSEFLG,
	       MST.PLTFLG, ARPSHP.PLTUSEFLG ARPSHPPLTUSEFLG,MST.CONFLG CONFLG,
	       ARPSHP.LSTUPDTIM ARPLSTUPDTIM,DTL.LSTUPDTIM SHPLSTUPDTIM
	  FROM OPRSHPMST  MST,
	       OPRARPSHP ARPSHP,
	       OPRSHPDLVNOT DLVNOT,
	       OPRSEGSHP SEGSHP,
	       OPRSHPDTL DTL
	 WHERE MST.MSTDOCNUM = ARPSHP.MSTDOCNUM
	   AND MST.DOCOWRIDR = ARPSHP.DOCOWRIDR
	   AND MST.DUPNUM = ARPSHP.DUPNUM
	   AND MST.SEQNUM = ARPSHP.SEQNUM
	   AND MST.CMPCOD = ARPSHP.CMPCOD
	   AND MST.MSTDOCNUM = DTL.MSTDOCNUM
	   AND MST.DOCOWRIDR = DTL.DOCOWRIDR
	   AND MST.DUPNUM = DTL.DUPNUM
	   AND MST.SEQNUM = DTL.SEQNUM
	   AND MST.CMPCOD = DTL.CMPCOD
	   AND ARPSHP.MSTDOCNUM = DLVNOT.MSTDOCNUM(+)
	   AND ARPSHP.DOCOWRIDR = DLVNOT.DOCOWRIDR(+)
	   AND ARPSHP.DUPNUM = DLVNOT.DUPNUM(+)
	   AND ARPSHP.SEQNUM = DLVNOT.SEQNUM(+)
	   AND ARPSHP.CMPCOD = DLVNOT.CMPCOD(+)
	   AND ARPSHP.ARPCOD = DLVNOT.ARPCOD(+)
	   AND ARPSHP.MSTDOCNUM = SEGSHP.MSTDOCNUM(+)
	   AND ARPSHP.DOCOWRIDR = SEGSHP.DOCOWRIDR(+)
	   AND ARPSHP.DUPNUM = SEGSHP.DUPNUM(+)
	   AND ARPSHP.SEQNUM = SEGSHP.SEQNUM(+)
	   AND ARPSHP.CMPCOD = SEGSHP.CMPCOD(+)
	   AND ARPSHP.CMPCOD = ?
	   AND ARPSHP.ARPCOD = ?
   ]]>
</QRY:Source>
</QRY:Definition>
<!--Modified @ TRV by A-1927 on 26-Feb-2007 for NCA Bug Fix starts-->
<!--Modified @ JPY by A-1927 on 12-Feb-2007 for NCA Bug Fix starts-->
<QRY:Definition>
<QRY:Id>188</QRY:Id>
<QRY:Source Name="operaions.shipment.findDisruptionListCountForMonitoring" Type="NATIVE">
<![CDATA[
	SELECT COUNT( DISTINCT
		MST.DOCOWRIDR || MST.MSTDOCNUM || MST.DUPNUM || MST.SEQNUM  ) DISCNT
				FROM CAPBKGFLTDTL BKGFLT
			 INNER JOIN OPRSHPMST MST ON
				BKGFLT.MSTDOCNUM = MST.MSTDOCNUM
				AND BKGFLT.DOCOWRIDR = MST.DOCOWRIDR
				AND BKGFLT.DUPNUM = MST.DUPNUM
				AND BKGFLT.SEQNUM = MST.SEQNUM
				AND BKGFLT.CMPCOD = MST.CMPCOD
				AND BKGFLT.UBRNUM = MST.UBRNUM
			 INNER JOIN CAPBKGDTL DTL ON
				BKGFLT.CMPCOD = DTL.CMPCOD
				AND BKGFLT.UBRNUM = DTL.UBRNUM
			 INNER JOIN FLTOPRLEG LEG ON
				BKGFLT.CMPCOD = LEG.CMPCOD
				AND BKGFLT.FLTNUM = LEG.FLTNUM
				AND BKGFLT.FLTSEQNUM = LEG.FLTSEQNUM
				AND BKGFLT.FLTCARIDR = LEG.FLTCARIDR
				AND BKGFLT.FLTORG = LEG.LEGORG
	        INNER JOIN OPRARPEXPFLT EXPFLT
    			 ON LEG.CMPCOD = EXPFLT.CMPCOD
			   AND LEG.FLTNUM     = EXPFLT.FLTNUM
			   AND LEG.FLTSEQNUM  = EXPFLT.FLTSEQNUM
			   AND LEG.FLTCARIDR  = EXPFLT.FLTCARIDR
			   AND LEG.LEGSERNUM  = EXPFLT.LEGSERNUM
			 LEFT OUTER JOIN OPRSEGSHP SHP ON
				BKGFLT.MSTDOCNUM = SHP.MSTDOCNUM
				AND BKGFLT.DOCOWRIDR = SHP.DOCOWRIDR
				AND BKGFLT.DUPNUM = SHP.DUPNUM
				AND BKGFLT.SEQNUM = SHP.SEQNUM
				AND BKGFLT.CMPCOD = SHP.CMPCOD
				AND BKGFLT.FLTNUM = SHP.FLTNUM
				AND BKGFLT.FLTSEQNUM = SHP.FLTSEQNUM
				AND BKGFLT.FLTCARIDR = SHP.FLTCARIDR
				AND BKGFLT.SEGSERNUM = SHP.SEGSERNUM
			  LEFT OUTER JOIN OPRULDSHP ULDSHP ON
				MST.MSTDOCNUM = ULDSHP.MSTDOCNUM
				AND MST.DOCOWRIDR = ULDSHP.DOCOWRIDR
				AND MST.DUPNUM = ULDSHP.DUPNUM
				AND MST.SEQNUM = ULDSHP.SEQNUM
				AND MST.CMPCOD = ULDSHP.CMPCOD
			  LEFT OUTER JOIN OPROFLDTL OFL ON
				BKGFLT.DUPNUM = OFL.DUPNUM
				AND BKGFLT.MSTDOCNUM = OFL.MSTDOCNUM
				AND BKGFLT.DOCOWRIDR = OFL.DOCOWRIDR
				AND BKGFLT.CMPCOD = OFL.CMPCOD
				AND BKGFLT.SEQNUM = OFL.SEQNUM
				AND BKGFLT.FLTCARIDR = OFL.FLTCARIDR
				AND BKGFLT.FLTNUM = OFL.FLTNUM
				AND BKGFLT.FLTSEQNUM = OFL.FLTSEQNUM
				AND BKGFLT.SEGSERNUM = OFL.SEGSERNUM
			WHERE
				BKGFLT.CMPCOD = ?
				AND BKGFLT.FLTORG = ?
				AND nvl(EXPFLT.FINFLG,'N') <> 'N'
				AND (NVL(BKGFLT.CFRWGT+BKGFLT.QUEWGT,0) - NVL(SHP.MFTWGT,0)) > 0
				AND (NVL(BKGFLT.CFRVOL+BKGFLT.QUEVOL,0) - NVL(SHP.MFTVOL,0)) > 0
 ]]>
</QRY:Source>
</QRY:Definition>
<!--Modified @ TRV by A-1927 on 26-Feb-2007 for NCA Bug Fix ends-->

<QRY:Definition>
	<QRY:Id>189</QRY:Id>
	<QRY:Source Name="operations.shipment.findlyinglistcount" Type="NATIVE">
	<![CDATA[
			SELECT MST.CMPCOD CMPCOD, ARP.DOCOWRIDR DOWOWRIDR,ARP.MSTDOCNUM MSTDOCNUM, ARP.DUPNUM DUPNUM,ARP.SEQNUM SEQNUM,
				   ARP.AVLWGT AVLWGT,SEGSHP.MFTWGT MFTWGT,(FLTDTL.CFRWGT+FLTDTL.QUEWGT) BKDWGT,FLTDTL.FLTBKGSTA FLTBKGSTA
				   FROM OPRARPSHP ARP
					 INNER JOIN OPRSHPMST  MST ON
						 ARP.CMPCOD = MST.CMPCOD
						 AND ARP.DOCOWRIDR = MST.DOCOWRIDR
						 AND ARP.MSTDOCNUM = MST.MSTDOCNUM
						 AND ARP.DUPNUM = MST.DUPNUM
						 AND ARP.SEQNUM = MST.SEQNUM
					 INNER JOIN OPRSHPRATDTL RAT ON
					 	 MST.CMPCOD = RAT.CMPCOD
					 	 AND MST.DOCOWRIDR = RAT.DOCOWRIDR
					 	 AND MST.MSTDOCNUM = RAT.MSTDOCNUM
					 	 AND MST.DUPNUM = RAT.DUPNUM
					 	 AND MST.SEQNUM = RAT.SEQNUM
					 LEFT OUTER JOIN CAPBKGFLTDTL FLTDTL ON
						 MST.CMPCOD = FLTDTL.CMPCOD
						 AND MST.DOCOWRIDR = FLTDTL.DOCOWRIDR
						 AND MST.MSTDOCNUM = FLTDTL.MSTDOCNUM
						 AND MST.DUPNUM = FLTDTL.DUPNUM
						 AND MST.SEQNUM = FLTDTL.SEQNUM
						 AND FLTDTL.FLTORG = ?
					 LEFT OUTER JOIN OPRSEGSHP SEGSHP ON
						 MST.CMPCOD = SEGSHP.CMPCOD
						 AND MST.DOCOWRIDR = SEGSHP.DOCOWRIDR
						 AND MST.MSTDOCNUM = SEGSHP.MSTDOCNUM
						 AND MST.DUPNUM = SEGSHP.DUPNUM
						 AND MST.SEQNUM = SEGSHP.SEQNUM
						 AND FLTDTL.CMPCOD = SEGSHP.CMPCOD
						 AND FLTDTL.FLTCARIDR = SEGSHP.FLTCARIDR
						 AND FLTDTL.FLTNUM = SEGSHP.FLTNUM
						 AND FLTDTL.FLTSEQNUM = SEGSHP.FLTSEQNUM
						 AND FLTDTL.SEGSERNUM = SEGSHP.SEGSERNUM
					 WHERE
						 MST.EXEFLG = 'Y'
						 AND (ARP.AVLPCS >= 0 AND ARP.AVLWGT >= 0 AND ARP.AVLVOL >= 0)
						 AND ARP.CMPCOD = ?
						 AND ARP.ARPCOD = ?
						 

	 ]]>
</QRY:Source>
</QRY:Definition>
<!--Modified @ JPY by A-1927 on 12-Feb-2007 for NCA Bug Fix ends-->

<QRY:Definition>
<QRY:Id>190</QRY:Id>
<QRY:Source Name="operations.shipment.findshipmentdeclarationdetails" Type="NATIVE">
	<![CDATA[
	SELECT DCL.CMPCOD DCLCMPCOD, DCL.DOCOWRIDR DCLDOCOWRIDR,
	       DCL.MSTDOCNUM DCLMSTDOCNUM, DCL.DUPNUM DCLDUPNUM, DCL.SEQNUM DCLSEQNUM,
	       DCL.SHPDCLCOD, DCL.SHPDES DCLSHPDES, DCL.RMK DCLRMK
	  FROM OPRSHPMST MST, OPRSHPDCL DCL
	 WHERE MST.CMPCOD = DCL.CMPCOD
	   AND MST.DOCOWRIDR = DCL.DOCOWRIDR
	   AND MST.MSTDOCNUM = DCL.MSTDOCNUM
	   AND MST.DUPNUM = DCL.DUPNUM
	   AND MST.SEQNUM = DCL.SEQNUM
	   AND MST.CMPCOD = ?
	   AND MST.DOCOWRIDR = ?
	   AND MST.MSTDOCNUM = ?
	   AND MST.DUPNUM = ?
   	   AND MST.SEQNUM = ?
   ]]>
</QRY:Source>
</QRY:Definition>



<QRY:Definition>
	<QRY:Id>191</QRY:Id>
	<QRY:Source Name="operations.shipment.finddetailsforawbsforloadingpriorty" Type="NATIVE">
			<![CDATA[

				SELECT (ACC.TOTCCF + ACC.TOTPPD) REVENUE, MST.PRDCOD
				FROM OPRSHPMSTACC ACC,OPRSHPMST MST
				WHERE
					  ACC.CMPCOD = MST.CMPCOD
					  AND ACC.DOCOWRIDR = MST.DOCOWRIDR
					  AND ACC.DUPNUM = MST.DUPNUM
					  AND ACC.SEQNUM = MST.SEQNUM
					  AND ACC.MSTDOCNUM = MST.MSTDOCNUM

					  AND ACC.CMPCOD=?
					  AND ACC.MSTDOCNUM = ?
					  AND ACC.DOCOWRIDR = ?
					  AND ACC.SEQNUM =?
					  AND ACC.DUPNUM = ?




			]]>
	</QRY:Source>
</QRY:Definition>

<QRY:Definition>
	<QRY:Id>192</QRY:Id>
	<QRY:Source Name="operations.shipment.finddetailsforuldsforloadingpriorty" Type="NATIVE">
			<![CDATA[



				SELECT (MST.TOTCCF + MST.TOTPPD) REVENUE
				FROM OPRSHPMSTACC MST,OPRSEGULDSHP ULD
				WHERE

					  ULD.CMPCOD = MST.CMPCOD
					  AND ULD.DOCOWRIDR = MST.DOCOWRIDR
					  AND ULD.DUPNUM = MST.DUPNUM
					  AND ULD.SEQNUM = MST.SEQNUM
					  AND ULD.MSTDOCNUM = MST.MSTDOCNUM

					  AND ULD.CMPCOD = ?
					  AND ULD.ULDNUM = ?
					  AND ULD.FLTCARIDR=?
					  AND ULD.FLTNUM = ?
					  AND ULD.FLTSEQNUM = ?
					  AND ULD.SEGSERNUM = ?







			]]>
	</QRY:Source>
</QRY:Definition>


<QRY:Definition>
<QRY:Id>191</QRY:Id>
<QRY:Source Name="operations.shipment.finduldinflight" Type="NATIVE">
	<![CDATA[
	SELECT ULD.CMPCOD, ULD.FLTCARIDR, ULD.FLTNUM, ULD.FLTSEQNUM, ULD.SEGSERNUM,
	       ULD.ULDNUM, SEG.POL, SEG.POU,exp.LEGSERNUM,EXP.FLTCARCOD
	  FROM OPRSEGULD ULD, OPRFLTSEG SEG,OPRARPEXPFLT EXP
	 WHERE SEG.FLTCARIDR = ULD.FLTCARIDR
	   AND SEG.FLTNUM = ULD.FLTNUM
	   AND SEG.FLTSEQNUM = ULD.FLTSEQNUM
	   AND SEG.SEGSERNUM = ULD.SEGSERNUM
	   AND SEG.CMPCOD = ULD.CMPCOD and
	   SEG.FLTCARIDR = EXP.FLTCARIDR
	   AND SEG.FLTNUM = EXP.FLTNUM
	   AND SEG.FLTSEQNUM = EXP.FLTSEQNUM
	   AND SEG.POL = EXP.ARPCOD
	   AND SEG.CMPCOD = EXP.CMPCOD
	   AND NVL(ULD.ULDSTA,'O') != 'C'
	   AND ULD.CMPCOD = ?
   	   AND ULD.ULDNUM = ?
   	   AND EXP.ARPCOD=?
   ]]>
</QRY:Source>
</QRY:Definition>


<QRY:Definition>
<QRY:Id>191</QRY:Id>
<QRY:Source Name="operations.shipment.findawbsforuld" Type="NATIVE">
	<![CDATA[
	SELECT ULDSHP.CMPCOD, ULDSHP.ARPCOD, ULDSHP.DOCOWRIDR, ULDSHP.MSTDOCNUM,
	       ULDSHP.DUPNUM, ULDSHP.SEQNUM, ULDSHP.ULDNUM, ULDSHP.NUMPCS, ULDSHP.WGT,
	       ULDSHP.VOL, MST.STDPCS, MST.STDWGT
	  FROM OPRULDSHP ULDSHP, OPRSHPMST MST
	 WHERE MST.MSTDOCNUM = ULDSHP.MSTDOCNUM
	   AND MST.DOCOWRIDR = ULDSHP.DOCOWRIDR
	   AND MST.DUPNUM = ULDSHP.DUPNUM
	   AND MST.SEQNUM = ULDSHP.SEQNUM
	   AND MST.CMPCOD = ULDSHP.CMPCOD
	   AND ULDSHP.CMPCOD = ?
	   AND ULDSHP.ULDNUM = ?
   	   AND ULDSHP.ARPCOD = ?
   ]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>192</QRY:Id>
<QRY:Source Name="operations.shipment.findchecklistparameters" Type="NATIVE">
	<![CDATA[
	SELECT MST.SCCCOD, RATDTL.CMDITMNAM, DGR.UNIIDR, DGR.PKGGRP,
	       DGR.PKGINS, DGR.PKGTYP
	  FROM OPRSHPMST MST, OPRSHPRATDTL RATDTL, OPRSHPDGR DGR
	 WHERE MST.CMPCOD = RATDTL.CMPCOD(+)
	   AND MST.DOCOWRIDR = RATDTL.DOCOWRIDR(+)
	   AND MST.MSTDOCNUM = RATDTL.MSTDOCNUM(+)
	   AND MST.DUPNUM = RATDTL.DUPNUM(+)
	   AND MST.SEQNUM = RATDTL.SEQNUM(+)
	   AND MST.CMPCOD = DGR.CMPCOD(+)
	   AND MST.DOCOWRIDR = DGR.DOCOWRIDR(+)
	   AND MST.MSTDOCNUM = DGR.MSTDOCNUM(+)
	   AND MST.DUPNUM = DGR.DUPNUM(+)
	   AND MST.SEQNUM = DGR.SEQNUM(+)
	   AND MST.CMPCOD = ?
	   AND MST.DOCOWRIDR = ?
	   AND MST.MSTDOCNUM = ?
	   AND MST.DUPNUM = ?
	   AND MST.SEQNUM = ?
   ]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>193</QRY:Id>
<QRY:Source Name="operations.shipment.listShipmentHandlingHistory" Type="NATIVE">
	<![CDATA[
	SELECT HIS.CMPCOD,
  HIS.DOCOWRIDR,
  HIS.MSTDOCNUM,
  HIS.DUPNUM,
  HIS.SEQNUM,
  HIS.SERNUM,
  HIS.ARPCOD,
  HIS.TXNCOD,
  HIS.TXNDAT,
  HIS.TXNDATUTC,
  HIS.TXNDES,
  HIS.TXNPCS,
  HIS.TXNWGT,
  HIS.TXNVOL,
  MST.STDPCS,
  MST.STDWGT,  
  MST.GRSVOL,
  MST.DSTCOD,
  MST.ORGCOD,
  MST.SHPDES,
  MST.PRDCOD,
  MST.PRDNAM,
  MST.SCCCOD,
  HIS.TXNREFONE,
  HIS.TXNREFTWO,
  HIS.TXNREFTHR,
  HIS.TXNREFFOR,
  HIS.TXNREFFIV,
  HIS.TXNREFSIX,
  HIS.TXNREFSEV,
  HIS.SRCIND,
  HIS.LSTUPDTIM,
  HIS.LSTUPDUSR,
  HIS.TXNREFFIFTEN,
  MST.RDYCRGFLG,

HIS.TXNREFEGT,
HIS.TXNREFEIN,
HIS.TXNREFELV,
HIS.TXNREFNIN,
HIS.TXNREFNUM,
HIS.TXNREFTEN,
HIS.TXNREFTLV,
HIS.TXNREFTTN,
HIS.TXNREFFTN,
MST.VERNUM
FROM OPRSHPHIS HIS,
  OPRSHPMSTHIS MST
WHERE MST.VERNUM=(SELECT MAX(VERNUM) FROM OPRSHPMSTHIS
        WHERE OPRSHPMSTHIS.CMPCOD    = HIS.CMPCOD
          AND OPRSHPMSTHIS.DOCOWRIDR = HIS.DOCOWRIDR
          AND OPRSHPMSTHIS.MSTDOCNUM = HIS.MSTDOCNUM          
          AND OPRSHPMSTHIS.DUPNUM    = HIS.DUPNUM
          AND OPRSHPMSTHIS.SEQNUM    = HIS.SEQNUM)
AND HIS.CMPCOD    = MST.CMPCOD
AND HIS.DOCOWRIDR = MST.DOCOWRIDR
AND HIS.MSTDOCNUM = MST.MSTDOCNUM
AND HIS.DUPNUM    = MST.DUPNUM
AND HIS.SEQNUM    = MST.SEQNUM
	
   ]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>194</QRY:Id>
<QRY:Source Name="operations.shipment.finddetailsfortracking" Type="NATIVE">
	<![CDATA[
	  SELECT MST.CMPCOD, MST.DOCOWRIDR, MST.MSTDOCNUM, MST.DUPNUM, MST.SEQNUM,
         MST.SHPPFX, MST.OWRCOD, MST.ORGCOD, MST.DSTCOD, MST.CNSNAM,
         MST.SHPNAM, MST.AGTNAM, MST.SHPSTA AWBSTA,onetim.FLDDES SHPSTA, MST.STDPCS, MST.STDWGT, MST.SHPDES,
 	 	 DTL.TOTACPPCS, DTL.TOTACPWGT, DTL.ACPARPCOD, DTL.ACPDAT,
         DTL.TOTDLVPCS, DTL.TOTDLVWGT, ARPSHP.TOTSRNPCS, DTL.ACPUSR, DTL.DLVDATUTC,
 	 	 RTG.FLTCARCOD, RTG.FLTNUM, RTG.DSTCOD RTGDSTCOD, RTG.RTGSERNUM,
         ARPSHP.ARPCOD, ARPSHP.AVLPCS, ARPSHP.TRNSITPCS, ARPSHP.TOTDLVPCS
 	 	 ARPSHPTOTDLVPCS, ARPSHP.BDPPCS, ARPSHP.MFTPCS, ARPSHP.AVLWGT,
 	 	 ARPSHP.TRNSITWGT, ARPSHP.TOTDLVWGT ARPSHPTOTDLVWGT, ARPSHP.BDPWGT, ARPSHP.MFTWGT
    FROM OPRSHPMST MST, OPRSHPDTL DTL, OPRARPSHP ARPSHP, OPRSHPRTG RTG,shronetim onetim
   WHERE MST.CMPCOD = DTL.CMPCOD
     AND MST.DOCOWRIDR = DTL.DOCOWRIDR
     AND MST.MSTDOCNUM = DTL.MSTDOCNUM
     AND MST.DUPNUM = DTL.DUPNUM
     AND MST.SEQNUM = DTL.SEQNUM
     AND MST.CMPCOD = ARPSHP.CMPCOD
     AND MST.DOCOWRIDR = ARPSHP.DOCOWRIDR
     AND MST.MSTDOCNUM = ARPSHP.MSTDOCNUM
     AND MST.DUPNUM = ARPSHP.DUPNUM
     AND MST.SEQNUM = ARPSHP.SEQNUM
     AND MST.CMPCOD = RTG.CMPCOD(+)
     AND MST.DOCOWRIDR = RTG.DOCOWRIDR(+)
     AND MST.MSTDOCNUM = RTG.MSTDOCNUM(+)
     AND MST.DUPNUM = RTG.DUPNUM(+)
     AND MST.SEQNUM = RTG.SEQNUM(+)
	 and MST.CMPCOD = onetim.CMPCOD(+)
	 and MST.SHPSTA = onetim.FLDVAL(+)
	 and onetim.FLDTYP(+)='operations.shipment.shipmentstatus'

     AND MST.CMPCOD = ?
     AND MST.DOCOWRIDR = ?
     AND MST.MSTDOCNUM = ?
     AND MST.DUPNUM = ?
     AND MST.SEQNUM = ?
ORDER BY MST.CMPCOD,
         MST.DOCOWRIDR,
         MST.MSTDOCNUM,
         MST.DUPNUM,
         MST.SEQNUM,
         RTGDSTCOD,
         RTG.FLTCARCOD,
		 RTG.RTGSERNUM
   ]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>195</QRY:Id>
<QRY:Source Name="operations.shipment.findsegmentandtransitdeatils" Type="NATIVE">
	<![CDATA[
	     SELECT ARPSHP.DOCOWRIDR, ARPSHP.MSTDOCNUM, ARPSHP.DUPNUM, ARPSHP.SEQNUM,
   		  ARPSHP.ARPCOD, ARPSHP.MFTPCS, ARPSHP.BDPPCS, ARPSHP.MFTWGT, ARPSHP.MFTVOL,
          ARPSHP.RCVPCS, ARPSHP.RCVWGT, ARPSHP.RCVVOL, ARPSHP.AVLWGT,
          ARPSHP.AVLVOL, ARPSHP.TRNSITPCS, ARPSHP.TRNSITWGT,
		  SEG.POL SEGORG, SEG.POU SEGDST,
		  SEGSHP.MFTPCS PCSCARIED, SEGSHP.MFTWGT WGTCARIED,EXPFLT.FLTCARCOD,
		  LEG.FLTNUM, LEG.LEGORG, LEG.LEGDST,
		  LEG.STA, LEG.ETA, LEG.ATA,
		  LEG.STD, LEG.ETD, LEG.ATD
     FROM OPRARPSHP ARPSHP, OPRSEGSHP SEGSHP, FLTOPRLEG LEG, OPRFLTSEG SEG, OPRARPEXPFLT EXPFLT
    WHERE ARPSHP.CMPCOD = SEGSHP.CMPCOD
      AND ARPSHP.DOCOWRIDR = SEGSHP.DOCOWRIDR
      AND ARPSHP.MSTDOCNUM = SEGSHP.MSTDOCNUM
      AND ARPSHP.DUPNUM = SEGSHP.DUPNUM
      AND ARPSHP.SEQNUM = SEGSHP.SEQNUM
      AND SEGSHP.CMPCOD = SEG.CMPCOD
      AND SEGSHP.FLTNUM = SEG.FLTNUM
      AND SEGSHP.FLTCARIDR = SEG.FLTCARIDR
      AND SEGSHP.SEGSERNUM = SEG.SEGSERNUM
      AND SEGSHP.FLTSEQNUM = SEG.FLTSEQNUM
      AND ARPSHP.ARPCOD = SEG.POL
      AND LEG.CMPCOD = SEG.CMPCOD
      AND LEG.FLTNUM = SEG.FLTNUM
      AND LEG.FLTCARIDR = SEG.FLTCARIDR
      AND LEG.FLTSEQNUM = SEG.FLTSEQNUM
      AND LEG.LEGORG = SEG.POL
      AND LEG.CMPCOD = EXPFLT.CMPCOD
      AND LEG.FLTNUM = EXPFLT.FLTNUM
      AND LEG.FLTCARIDR = EXPFLT.FLTCARIDR
      AND LEG.FLTSEQNUM = EXPFLT.FLTSEQNUM
	  AND LEG.LEGORG = EXPFLT.ARPCOD
      AND ARPSHP.TRNSITPCS > 0
      AND ARPSHP.CMPCOD = ?
      AND ARPSHP.DOCOWRIDR = ?
      AND ARPSHP.MSTDOCNUM = ?
      AND ARPSHP.DUPNUM = ?
      AND ARPSHP.SEQNUM = ?
ORDER BY ARPSHP.DOCOWRIDR, ARPSHP.MSTDOCNUM, ARPSHP.DUPNUM, ARPSHP.SEQNUM, ARPSHP.ARPCOD
   ]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>202</QRY:Id>
<QRY:Source Name="operations.shipment.findoperationalshipmentforflight" Type="OBJECT">
	<![CDATA[
	SELECT operationalShipment from
	com.ibsplc.icargo.business.operations.shipment.OperationalShipment as operationalShipment ,
	com.ibsplc.icargo.business.operations.flthandling.OperationalShipmentForSegment as shipmentForSegment
	WHERE
		operationalShipment.operationalShipmentPk.masterDocumentNumber=shipmentForSegment.operationalShipmentForSegmentPK.masterDocumentNumber AND
		operationalShipment.operationalShipmentPk.ownerId=shipmentForSegment.operationalShipmentForSegmentPK.ownerId AND
		operationalShipment.operationalShipmentPk.sequenceNumber=shipmentForSegment.operationalShipmentForSegmentPK.sequenceNumber AND
		operationalShipment.operationalShipmentPk.duplicateNumber=shipmentForSegment.operationalShipmentForSegmentPK.duplicateNumber AND
		operationalShipment.operationalShipmentPk.companyCode=shipmentForSegment.operationalShipmentForSegmentPK.companyCode AND

		shipmentForSegment.operationalShipmentForSegmentPK.flightNumber=? AND
		shipmentForSegment.operationalShipmentForSegmentPK.flightSequenceNumber=? AND
		shipmentForSegment.operationalShipmentForSegmentPK.carrierId=? AND
		shipmentForSegment.operationalShipmentForSegmentPK.companyCode=?



]]>
</QRY:Source>
</QRY:Definition>


<QRY:Definition>
<QRY:Id>203</QRY:Id>
<QRY:Source Name="operations.shipment.findoperationaluldshipmentforflight" Type="OBJECT">
	<![CDATA[
	SELECT operationalShipment from
	com.ibsplc.icargo.business.operations.shipment.OperationalShipment as operationalShipment ,
	com.ibsplc.icargo.business.operations.flthandling.OperationalShipmentInUldForSegment as shipmentForSegment
	WHERE
		operationalShipment.operationalShipmentPk.masterDocumentNumber=shipmentForSegment.operationalShipmentInUldForSegmentPK.masterDocumentNumber AND
		operationalShipment.operationalShipmentPk.ownerId=shipmentForSegment.operationalShipmentInUldForSegmentPK.ownerId AND
		operationalShipment.operationalShipmentPk.sequenceNumber=shipmentForSegment.operationalShipmentInUldForSegmentPK.sequenceNumber AND
		operationalShipment.operationalShipmentPk.duplicateNumber=shipmentForSegment.operationalShipmentInUldForSegmentPK.duplicateNumber AND
		operationalShipment.operationalShipmentPk.companyCode=shipmentForSegment.operationalShipmentInUldForSegmentPK.companyCode AND

		shipmentForSegment.operationalShipmentInUldForSegmentPK.flightNumber=? AND
		shipmentForSegment.operationalShipmentInUldForSegmentPK.flightSequenceNumber=? AND
		shipmentForSegment.operationalShipmentInUldForSegmentPK.carrierId=? AND
		shipmentForSegment.operationalShipmentInUldForSegmentPK.uldNumber = ? AND
		shipmentForSegment.operationalShipmentInUldForSegmentPK.companyCode=?


]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>204</QRY:Id>
<QRY:Source Name="operations.shipment.findShipmentdetailsforFHL" Type="NATIVE">
	<![CDATA[
	SELECT SHPMST.CMPCOD, SHPMST.DOCOWRIDR, SHPMST.MSTDOCNUM, SHPMST.DUPNUM,SHPMST.DOCNUM,
		       SHPMST.SEQNUM, SHPMST.SHPPFX, SHPMST.OWRCOD, SHPMST.STDPCS, SHPMST.STDWGT,SHPMST.HDLINF,
		       SHPMST.STDWGTCOD, SHPMST.STDDISWGT, SHPMST.SHPDES, SHPMST.ORGCOD,
		       SHPMST.DSTCOD, SHPMST.CNSCOD, SHPMST.CNSNAM, SHPMST.SHPCOD, SHPMST.SLCPCS,
		       SHPMST.SHPNAM, SHPMST.AGTCOD, SHPMST.AGTNAM, SHPMST.CURCOD, SHPMST.PAYTYP,
			   (SELECT CHGDTL.PAYTYP FROM OPRSHPCHGDTL CHGDTL
				WHERE CHGDTL.CMPCOD     = SHPMST.CMPCOD
				AND CHGDTL.DOCOWRIDR    = SHPMST.DOCOWRIDR
				AND CHGDTL.MSTDOCNUM    = SHPMST.MSTDOCNUM
				AND CHGDTL.DUPNUM       = SHPMST.DUPNUM
				AND CHGDTL.SEQNUM       = SHPMST.SEQNUM
				AND ROWNUM < 2) PAYTYPOTH,
			   CNT.CNSTELNUM, CNT.CNSMALIDR, CNT.CNSADRTWO, CNT.CNSCTY, CNT.CNSSTT, CNT.CNSCTR,
		       CNT.CNSPSTCOD, CNT.CNSPRTNFNFLG, CNT.SHPTELNUM, CNT.SHPMALIDR,
		       CNT.SHPADRTWO, CNT.SHPCTY, CNT.SHPSTT, CNT.SHPCTR, CNT.SHPPSTCOD,
		       CNT.CNSACCNUM, CNT.SHPACCNUM, CNT.SHPREFNUM,SHPMST.SCCCOD,SHPMST.SHPDES,
		       SHPMST.SHPADRONE,SHPMST.CNSADRONE,OCI.SEQNUM OCISEQNUM,OCI.INFIDF,
		       OCI.CNTCOD , OCI.CUSINFIDF , OCI.CUSINF,CNT.CNSERINUM,CNT.SHPERINUM,AGTGRP.GRPNAM AGTGRP,
			   MSTACC.DVLCAR,MSTACC.DVLCUS,MSTACC.INSAMT,RAT.HRMCMDCOD, MIS.SCICOD SCICOD,MIS.JNVPAR
			FROM OPRSHPMST SHPMST, OPRSHPMSTCNT CNT,OPRSHPOCI OCI,SHRGENMSTGRPDTL AGTGRP, OPRSHPMSTACC MSTACC, OPRSHPRATDTL RAT, OPRSHPMSTMIS MIS
		  
		 WHERE SHPMST.CMPCOD = CNT.CMPCOD
		   AND SHPMST.DOCOWRIDR = CNT.DOCOWRIDR
		   AND SHPMST.MSTDOCNUM = CNT.MSTDOCNUM
		   AND SHPMST.DUPNUM = CNT.DUPNUM
		   AND SHPMST.SEQNUM = CNT.SEQNUM
	    	AND SHPMST.CMPCOD = OCI.CMPCOD(+)
		   AND SHPMST.DOCOWRIDR = OCI.DOCOWRIDR(+)
		   AND SHPMST.MSTDOCNUM = OCI.MSTDOCNUM(+)
		   AND SHPMST.DUPNUM = OCI.DUPNUM(+)
		   AND SHPMST.SEQNUM = OCI.SEQNUM(+)
			AND SHPMST.CMPCOD = MSTACC.CMPCOD(+)
			AND SHPMST.DOCOWRIDR = MSTACC.DOCOWRIDR(+)
			AND SHPMST.MSTDOCNUM = MSTACC.MSTDOCNUM(+)
			AND SHPMST.DUPNUM = MSTACC.DUPNUM(+)
			AND SHPMST.SEQNUM = MSTACC.SEQNUM(+)
       	   	AND OCI.SEQNUM(+) > 1
       	   	AND SHPMST.CMPCOD = AGTGRP.CMPCOD(+)
	   		AND SHPMST.AGTCOD = AGTGRP.GRPENT(+)       	   	
			AND AGTGRP.GRPCATCOD(+) = 'GEN'	
           AND SHPMST.DOCOWRIDR = RAT.DOCOWRIDR(+)
		   AND SHPMST.MSTDOCNUM = RAT.MSTDOCNUM(+)
		   AND SHPMST.DUPNUM    = RAT.DUPNUM(+)
		   AND SHPMST.CMPCOD    = RAT.CMPCOD(+)
		   AND SHPMST.SEQNUM    = RAT.SEQNUM(+)     	   	
			AND SHPMST.CMPCOD  = MIS.CMPCOD(+)         
			AND SHPMST.DOCOWRIDR = MIS.DOCOWRIDR(+)
			AND SHPMST.MSTDOCNUM = MIS.MSTDOCNUM(+) 
			AND SHPMST.DUPNUM = MIS.DUPNUM(+)
			AND SHPMST.SEQNUM = MIS.SEQNUM(+)
		   AND SHPMST.CMPCOD = ?
		   AND SHPMST.DOCOWRIDR = ?
		   AND SHPMST.MSTDOCNUM = ?
		   AND SHPMST.DUPNUM = ?
	   	  

   ]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>207</QRY:Id>
<QRY:Source Name="operations.shipment.findoperationalshipmentforaudit" Type="NATIVE">
	<![CDATA[
		SELECT SHPAUD.CMPCOD,
		SHPAUD.MSTDOCNUM,
SHPAUD.DOCOWRIDR,
SHPAUD.SEQNUM,
SHPAUD.DUPNUM,
  SHPAUD.ADLINF,
  SHPAUD.AUDRMK,
  SHPAUD.SERNUM,
  SHPAUD.STNCOD,
		SHPAUD.TRGPNT,
  SHPAUD.DOCNUM,
  SHPAUD.ACTCOD,
  SHPAUD.UPDTXNTIM,
  SHPAUD.UPDUSR,
  CFG.TXNHISFLG
	FROM OPRSHPAUD SHPAUD
	LEFT OUTER JOIN  SHRAUDTXNCFG CFG ON 
	SHPAUD.CMPCOD      = CFG.CMPCOD
AND SHPAUD.ACTCOD    = CFG.TXNCOD
	WHERE SHPAUD.UPDTXNTIMUTC >= ?
			   AND  SHPAUD.UPDTXNTIMUTC <= ?
		

]]>
</QRY:Source>
</QRY:Definition>


<QRY:Definition>
<QRY:Id>208</QRY:Id>
<QRY:Source Name="operations.shipment.findAWBLabelDetails_part_one" Type="NATIVE">
	<![CDATA[
SELECT FINRST.*, (LOCPCS-SUMLBLPCS) REMLOCPCS 
FROM 
(SELECT RST.*, (SELECT COALESCE(SUM(PCS),0)
  FROM OPRAWBLBL
  WHERE CMPCOD = RST.CMPCOD
  AND LBLREFFIV = RST.ARPCOD
  AND DOCOWRIDR = RST.DOCOWRIDR
  AND MSTDOCNUM = RST.MSTDOCNUM
  AND DUPNUM = RST.DUPNUM
  AND SEQNUM = RST.SEQNUM
  AND COALESCE(LBLREFSEV,DEFSTUNAM) = RST.STUCOD
  AND LBLREFEGT = RST.WHSCOD
  AND LBLREFNIN = RST.LOCCOD
  AND COALESCE(LBLSTA,'A')='A'
  ) SUMLBLPCS 
FROM (SELECT SHPLOC.CMPCOD, SHPLOC.ARPCOD, SHPLOC.DOCOWRIDR, SHPLOC.MSTDOCNUM, SHPLOC.DUPNUM, SHPLOC.SEQNUM, 
  SHPLOC.WHSCOD, SHPLOC.LOCCOD, SHPLOC.STUCOD, SHPLOC.SHPPFX, SHPLOC.LOCPCS, SHPLOC.LOCWGT, AWBLBL.LBLIDR, 
  AWBLBL.PCS, AWBLBL.WGT, AWBLBL.LBLREFONE, AWBLBL.LBLREFFOR, AWBLBL.LBLREFFIV, AWBLBL.LBLREFSIX, 
  AWBLBL.LBLREFSEV LBLSTUCOD, AWBLBL.LBLREFEGT LBLWHSCOD, AWBLBL.LBLREFNIN LBLLOCCOD, AWBLBL.SERNUM, AWBLBL.LBLSTA,AWBLBL.LSTUPDTIM, 
  ZONTYP.AUTZONTYP, SHPMST.DOCNUM, SHPMST.STDPCS, SHPMST.STDWGT, SHPMST.STDWGTCOD, SHPMST.ORGCOD, SHPMST.DSTCOD, 
  SHPMST.UBRNUM, SHPMST.SCCCOD, SHPMST.PRDCOD, SHPMST.PRDPRT, BKGFLT.FLTCARCOD,BKGFLT.DISWGTUNT, FLTLEG.FLTCARIDR, FLTLEG.FLTNUM, 
  FLTLEG.FLTSEQNUM, FLTLEG.STD, FLTLEG.ATD, BKGMST.TOTNUMPCS BKDPCS, BKGMST.TOTWGT BKDWGT, BKGMST.TOTVOL BKDVOL, 
  ARPSHP.AVLPCS, ARPSHP.RCVPCS,ARPSHP.DCSPCS,ARPSHP.DCSWGT,ARPSHP.DCSFLG, ARPSHP.RCVWGT, MSTARPSHP.RCVPCS MSTRCVPCS, MSTARPSHP.RCVWGT MSTRCVWGT, MSTARPSHP.DCSPCS MSTDCSPCS,MSTARPSHP.DCSWGT MSTDCSWGT,MSTARPSHP.DCSFLG MSTDCSFLG,MSTSHPMST.STDPCS MSTSTDPCS,
  MSTSHPMST.STDWGT MSTSTDWGT, MSTSHPMST.STDWGTCOD MSTSTDWGTCOD, MSTSHPMST.ORGCOD MSTORGCOD, MSTSHPMST.DSTCOD MSTDSTCOD, 
  DENSE_RANK() OVER(ORDER BY (FLTLEG.STD)) RNK, 
  (SELECT PARVAL FROM SHRSYSPAR WHERE CMPCOD = SHPLOC.CMPCOD 
      AND PARCOD = 'warehouse.defaults.defaultStorageUnit' ) DEFSTUNAM,
  (SELECT SHPDLVTIM FROM CAPBKGMST WHERE 
        CMPCOD = MSTSHPMST.CMPCOD
        AND MSTDOCNUM = MSTSHPMST.MSTDOCNUM				
        AND DUPNUM = MSTSHPMST.DUPNUM 
        AND SEQNUM = MSTSHPMST.SEQNUM  
        AND UBRNUM = MSTSHPMST.UBRNUM
        AND DOCOWRIDR = MSTSHPMST.DOCOWRIDR
   ) SHPDLVTIM,
	(SELECT PARVAL
	  FROM WHSZONATRDTL
	  WHERE CMPCOD = LOCMST.CMPCOD
	  AND ARPCOD   = LOCMST.ARPCOD
	  AND WHSCOD   = LOCMST.WHSCOD
	  AND ZONCOD   = LOCMST.ZONCOD
	  AND PARCOD   = 'RSTMANREL'
	) RLCRSTZON
FROM OPRSHPMST SHPMST 
INNER JOIN WHSOPRSHPLOC SHPLOC 
ON SHPMST.CMPCOD = SHPLOC.CMPCOD 
AND SHPMST.DOCOWRIDR = SHPLOC.DOCOWRIDR 
AND SHPMST.MSTDOCNUM = SHPLOC.MSTDOCNUM 
AND SHPMST.DUPNUM = SHPLOC.DUPNUM 
AND SHPMST.SEQNUM = SHPLOC.SEQNUM 
INNER JOIN OPRSHPMST MSTSHPMST
ON MSTSHPMST.CMPCOD = SHPMST.CMPCOD
AND MSTSHPMST.DOCOWRIDR = SHPMST.DOCOWRIDR
AND MSTSHPMST.MSTDOCNUM = SHPMST.MSTDOCNUM
AND MSTSHPMST.DUPNUM = SHPMST.DUPNUM
AND MSTSHPMST.SEQNUM = 1
INNER JOIN OPRARPSHP ARPSHP ON
ARPSHP.CMPCOD = SHPLOC.CMPCOD
AND ARPSHP.ARPCOD = SHPLOC.ARPCOD
AND ARPSHP.DOCOWRIDR = SHPLOC.DOCOWRIDR
AND ARPSHP.MSTDOCNUM = SHPLOC.MSTDOCNUM
AND ARPSHP.DUPNUM = SHPLOC.DUPNUM
AND ARPSHP.SEQNUM = SHPLOC.SEQNUM
INNER JOIN OPRARPSHP MSTARPSHP ON
MSTARPSHP.CMPCOD = ARPSHP.CMPCOD
AND MSTARPSHP.ARPCOD = ARPSHP.ARPCOD
AND MSTARPSHP.DOCOWRIDR = ARPSHP.DOCOWRIDR
AND MSTARPSHP.MSTDOCNUM = ARPSHP.MSTDOCNUM
AND MSTARPSHP.DUPNUM = ARPSHP.DUPNUM
AND MSTARPSHP.SEQNUM = 1
INNER JOIN SHRSYSPAR SYSPAR ON  
SYSPAR.CMPCOD = SHPLOC.CMPCOD
AND SYSPAR.PARCOD   = 'warehouse.defaults.defaultStorageUnit'
INNER JOIN WHSLOCMST LOCMST 
ON LOCMST.CMPCOD = SHPLOC.CMPCOD 
AND LOCMST.ARPCOD = SHPLOC.ARPCOD 
AND LOCMST.WHSCOD = SHPLOC.WHSCOD 
AND LOCMST.LOCCOD = SHPLOC.LOCCOD 
INNER JOIN WHSZONMST ZONMST 
ON ZONMST.CMPCOD = LOCMST.CMPCOD 
AND ZONMST.ARPCOD = LOCMST.ARPCOD 
AND ZONMST.WHSCOD = LOCMST.WHSCOD 
AND ZONMST.ZONCOD = LOCMST.ZONCOD 
LEFT OUTER JOIN WHSZONTYPMST ZONTYP 
ON ZONTYP.CMPCOD = ZONMST.CMPCOD 
AND ZONTYP.ARPCOD = ZONMST.ARPCOD 
AND ZONTYP.ZONTYP = ZONMST.ZONTYP 
LEFT OUTER JOIN OPRAWBLBL AWBLBL 
ON AWBLBL.CMPCOD = SHPLOC.CMPCOD 
AND AWBLBL.LBLREFFIV = SHPLOC.ARPCOD 
AND AWBLBL.DOCOWRIDR = SHPLOC.DOCOWRIDR 
AND AWBLBL.MSTDOCNUM = SHPLOC.MSTDOCNUM 
AND AWBLBL.DUPNUM = SHPLOC.DUPNUM 
AND AWBLBL.SEQNUM = SHPLOC.SEQNUM
AND LBLREFEGT = SHPLOC.WHSCOD 
AND LBLREFNIN = SHPLOC.LOCCOD 
AND COALESCE(LBLREFSEV,PARVAL) = SHPLOC.STUCOD
	 ]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>356</QRY:Id>
<QRY:Source Name="operations.shipment.findAWBLabelDetails_part_two" Type="NATIVE">
	<![CDATA[
LEFT OUTER JOIN CAPBKGMST BKGMST ON 
MSTSHPMST.CMPCOD = BKGMST.CMPCOD 
AND MSTSHPMST.UBRNUM = BKGMST.UBRNUM 
AND BKGSTA IN ('C','Q') 
LEFT OUTER JOIN CAPBKGFLTDTL BKGFLT ON 
BKGMST.CMPCOD = BKGFLT.CMPCOD 
AND SHPLOC.ARPCOD = BKGFLT.FLTORG 
AND BKGMST.UBRNUM = BKGFLT.UBRNUM 
AND BKGFLT.FLTBKGSTA IN ('C','Q') 
LEFT OUTER JOIN FLTOPRLEG FLTLEG ON 
FLTLEG.CMPCOD = BKGFLT.CMPCOD 
AND FLTLEG.LEGORG = BKGFLT.FLTORG 
AND FLTLEG.FLTNUM = BKGFLT.FLTNUM 
AND FLTLEG.FLTCARIDR = BKGFLT.FLTCARIDR 
AND FLTLEG.FLTSEQNUM = BKGFLT.FLTSEQNUM 
WHERE SHPLOC.CMPCOD = ? 
AND SHPLOC.ARPCOD = ? 
AND CASE
      WHEN SHPLOC.TXNPCS>0      
      THEN SHPLOC.LOCPCS-SHPLOC.TXNPCS
      ELSE SHPLOC.LOCPCS
      END
      >0
	 ]]>
</QRY:Source>
</QRY:Definition>
<!--A-5165 for ICRD-98242-->
<QRY:Definition>
<QRY:Id>209</QRY:Id>
<QRY:Source Name="operations.shipment.finduldsforuldenquiry" Type="NATIVE">
	<![CDATA[
	
 SELECT ULDDTL.CMPCOD,
  ULDDTL.ULDNUM,
  ULDDTL.ARPCOD CURARP,
  ULDDTL.FLTCARCOD,
  ULDDTL.FLTCARIDR,
  ULDDTL.FLTNUM,
  ULDDTL.FLTSEQNUM,
  ULDDTL.FLTDAT,
  ULDDTL.POL,
  ULDDTL.POU,
  ULDDTL.ULDCTR,
  ULDDTL.ULDBKGIDR,
  ULDDTL.ULDDST,
  ULDDTL.ACTWGT,
  ULDDTL.THRUNT,
  ULDDTL.BDPWGT,
  ULDDTL.BDPPCS,
  SHPMST.DOCOWRIDR,
  SHPMST.SHPPFX,
  SHPMST.MSTDOCNUM,
  SHPMST.SEQNUM,
  SHPMST.DUPNUM,
  SHPMST.STDPCS,
  SHPMST.STDWGT,
  SHPMST.SCCCOD,
  SHPMST.SHPDES,
  SHPMIS.SCICOD,
  SHPMST.ORGCOD,
  SHPMST.DSTCOD,
  BKGFLT.FLTNUM BKGFLTNUM,
  BKGFLT.FLTCARCOD BKGFLTCARCOD,
  BKGFLT.FLTSEQNUM BKGFLTSEQNUM,
  BKGFLT.FLTDAT BKGFLTDAT,
  STUMST.ARPCOD WHSCURSTN,
  STUMST.CURLOCCOD,
  STUMST.LSTCINTIM,
  LOCMST.ZONCOD,
  CASE
    WHEN ULDDTL.FLTSEQNUM>0
    THEN ULDTHRRTG.THRCARCOD
    ELSE ARPTHRRTG.THRCARCOD
  END THRCARCOD,
  CASE
    WHEN ULDDTL.FLTSEQNUM>0
    THEN ULDTHRRTG.THRCARIDR
    ELSE ARPTHRRTG.THRCARIDR
  END THRCARIDR,
  CASE
    WHEN ULDDTL.FLTSEQNUM>0
    THEN ULDTHRRTG.THRFLTNUM
    ELSE ARPTHRRTG.THRFLTNUM
  END THRFLTNUM,
  CASE
    WHEN ULDDTL.FLTSEQNUM>0
    THEN ULDTHRRTG.SERNUM
    ELSE ARPTHRRTG.SERNUM
  END THRSERNUM,
  CASE
    WHEN ULDDTL.FLTSEQNUM>0
    THEN ULDTHRRTG.THRFLTDAT
    ELSE ARPTHRRTG.THRFLTDAT
  END THRFLTDAT,
  CASE
    WHEN ULDDTL.FLTSEQNUM>0
    THEN FLTLEG.LEGDST
    ELSE ARPTHRRTG.ARPCOD
  END THRDSTCOD
FROM
  (SELECT ULD.cmpcod ,
    EXPFLT.ARPCOD,
    ULD.uldnum ,
    ULD.POL,
    ULD.POU,
    ULDSHP.docowridr ,
    ULDSHP.mstdocnum ,
    ULDSHP.dupnum ,
    ULDSHP.seqnum ,
    ULDSHP.BDPWGT,
    ULDSHP.BDPPCS,
    EXPFLT.FLTCARCOD,
    ULD.fltnum ,
    ULD.fltseqnum ,
    ULD.fltcaridr,
    FLTMST.FLTDAT,
    EXPFLT.LEGSERNUM,
    SEGULD.ULDCTR,
    SEGULD.ULDBKGIDR,
    SEGULD.ULDDST,
    SEGULD.ACTWGT,
    SEGULD.THRUNT,
    SEGULD.SEGSERNUM
  FROM OPRULDDTL ULD ,
    OPRSEGULD SEGULD,
    OPRSEGULDSHP ULDSHP ,
    OPRARPEXPFLT EXPFLT,
	FLTOPRMST FLTMST
  WHERE ULD.fltnum     = SEGULD.fltnum
  AND ULD.fltseqnum    = SEGULD.fltseqnum
  AND ULD.fltcaridr    = SEGULD.fltcaridr
  AND ULD.cmpcod       = SEGULD.cmpcod
  AND ULD.uldnum       = SEGULD.uldnum
  AND SEGULD.fltnum    = ULDSHP.fltnum(+)
  AND SEGULD.fltseqnum = ULDSHP.fltseqnum(+)
  AND SEGULD.fltcaridr = ULDSHP.fltcaridr(+)
  AND SEGULD.cmpcod    = ULDSHP.cmpcod(+)
  AND SEGULD.uldnum    = ULDSHP.uldnum(+)
  AND SEGULD.SEGSERNUM = ULDSHP.SEGSERNUM(+)
  AND ULD.fltnum       =EXPFLT.fltnum
  AND ULD.fltseqnum    = EXPFLT.fltseqnum
  AND ULD.fltcaridr    =EXPFLT.fltcaridr
  AND ULD.cmpcod       =EXPFLT.cmpcod
  AND EXPFLT.cmpcod    =   FLTMST.cmpcod   
  AND EXPFLT.fltnum    =   FLTMST.fltnum
  AND EXPFLT.fltcaridr =   FLTMST.fltcaridr
  AND EXPFLT.fltseqnum =   FLTMST.fltseqnum
  AND (ULD.clsflg     IS NULL
  OR ULD.clsflg       <> 'Y')
  AND ULD.CMPCOD       = ?
  AND ULD.uldnum       = ?
 
  UNION
  SELECT ULD.cmpcod ,
    ULDSHP.ARPCOD,
    ULD.uldnum ,
    ULD.POL,
    ULD.POU,
    ULDSHP.docowridr ,
    ULDSHP.mstdocnum ,
    ULDSHP.dupnum ,
    ULDSHP.seqnum ,
    ULDSHP.WGT BDPWGHT,
    ULDSHP.NUMPCS BDPPCS,
    '' FLTCARCOD,
    '' fltnum ,
    0 fltseqnum ,
    0 fltcaridr,
    NULL FLTDAT,
    0 LEGSERNUM,
    ARPULD.ULDCTR,
    ARPULD.ULDBKGIDR,
    ARPULD.ULDDST,
    ARPULD.ACTWGT,
    ARPULD.THRUNT,
    0 SEGSERNUM
  FROM OPRULDDTL ULD ,
    OPRARPULD ARPULD,
    OPRULDSHP ULDSHP
  WHERE ULD.uldnum  = ARPULD.uldnum
  AND ULD.cmpcod    = ARPULD.cmpcod
  AND ARPULD.uldnum = ULDSHP.uldnum(+)
  AND ARPULD.cmpcod = ULDSHP.cmpcod(+)
  AND ARPULD.arpcod = ULDSHP.arpcod(+)
  AND ULD.CMPCOD    = ?
  AND ULD.uldnum    = ?
  AND( ULD.fltseqnum    = 0 and nvl(clsflg,'Y')='Y')
  ) ULDDTL ,
  OPRSHPMST SHPMST ,
  CAPBKGFLTDTL BKGFLT ,
  WHSSTUMST STUMST ,
  WHSLOCMST LOCMST,
  OPRSHPMSTMIS SHPMIS,
  OPRULDTHRRTG ULDTHRRTG,
  OPRARPTHRRTG ARPTHRRTG,
  FLTOPRLEG fltleg
WHERE ULDDTL.mstdocnum = SHPMST.mstdocnum(+)
AND ULDDTL.dupnum      = SHPMST.dupnum(+)
AND ULDDTL.seqnum      = SHPMST.seqnum(+)
AND ULDDTL.docowridr   = SHPMST.docowridr(+)
AND ULDDTL.cmpcod      = SHPMST.cmpcod(+)
AND SHPMST.mstdocnum   = BKGFLT.mstdocnum(+)
AND SHPMST.dupnum      = BKGFLT.dupnum(+)
AND SHPMST.seqnum      = BKGFLT.seqnum(+)
AND SHPMST.docowridr   = BKGFLT.docowridr(+)
AND SHPMST.cmpcod      = BKGFLT.cmpcod(+)
AND SHPMST.mstdocnum   = SHPMIS.mstdocnum(+)
AND SHPMST.dupnum      = SHPMIS.dupnum(+)
AND SHPMST.seqnum      = SHPMIS.seqnum(+)
AND SHPMST.docowridr   = SHPMIS.docowridr(+)
AND SHPMST.cmpcod      = SHPMIS.cmpcod(+)
AND ULDDTL.uldnum      = STUMST.STUCOD(+)
AND ULDDTL.ARPCOD      = STUMST.ARPCOD(+)
AND ULDDTL.cmpcod      = STUMST.cmpcod(+)
AND STUMST.whscod      = LOCMST.whscod(+)
AND STUMST.CURLOCCOD   = LOCMST.loccod(+)
AND STUMST.cmpcod      = LOCMST.cmpcod(+)
AND ULDDTL.fltnum      = ULDTHRRTG.fltnum(+)
AND ULDDTL.fltseqnum   = ULDTHRRTG.fltseqnum(+)
AND ULDDTL.fltcaridr   = ULDTHRRTG.fltcaridr(+)
AND ULDDTL.cmpcod      = ULDTHRRTG.cmpcod(+)
AND ULDDTL.uldnum      = ULDTHRRTG.uldnum(+)
AND ULDDTL.SEGSERNUM   = ULDTHRRTG.SEGSERNUM(+)
AND ULDDTL.uldnum      = ARPTHRRTG.uldnum(+)
AND ULDDTL.ARPCOD      = ARPTHRRTG.ARPCOD(+)
AND ULDDTL.cmpcod      = ARPTHRRTG.cmpcod(+)
AND ULDDTL.ARPCOD       = fltleg.LEGORG(+)
AND ULDDTL.fltnum      =fltleg.fltnum(+)
AND ULDDTL.legsernum     =fltleg.LEGSERNUM(+)
AND ULDDTL.fltseqnum    = fltleg.fltseqnum(+)
AND ULDDTL.fltcaridr    =fltleg.fltcaridr(+)
AND ULDDTL.cmpcod       =fltleg.cmpcod (+)	
AND ( NVL(BKGFLT.FLTBKGSTA(+),'C') not in ('X','R'))

   ]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>210</QRY:Id>
<QRY:Source Name="operations.shipment.findshipmentsforuldenquiry" Type="NATIVE">
	<![CDATA[
  SELECT MST.SHPPFX, MST.MSTDOCNUM, MST.SEQNUM, MST.DUPNUM, MST.DOCOWRIDR,
       MST.STDPCS, MST.STDWGT, SEGSHP.BDPWGT, SEGSHP.BDPPCS, MST.SCCCOD,
       MST.SHPDES, BKGFLT.FLTNUM, BKGFLT.FLTCARCOD, BKGFLT.FLTDAT,SEGULD.ULDNUM,
       FLTSEG.POU, BKGFLT.FLTORG, MST.ORGCOD, MST.DSTCOD
  FROM OPRSEGULD SEGULD,
       OPRSEGULDSHP SEGSHP,
       OPRSHPMST MST,
       CAPBKGFLTDTL BKGFLT,
       OPRFLTSEG FLTSEG
 WHERE SEGULD.FLTNUM = SEGSHP.FLTNUM
   AND SEGULD.FLTSEQNUM = SEGSHP.FLTSEQNUM
   AND SEGULD.FLTCARIDR = SEGSHP.FLTCARIDR
   AND SEGULD.CMPCOD = SEGSHP.CMPCOD
   AND SEGULD.ULDNUM = SEGSHP.ULDNUM
   AND MST.MSTDOCNUM = SEGSHP.MSTDOCNUM
   AND MST.SEQNUM = SEGSHP.SEQNUM
   AND MST.DUPNUM = SEGSHP.DUPNUM
   AND MST.DOCOWRIDR = SEGSHP.DOCOWRIDR
   AND MST.CMPCOD = SEGSHP.CMPCOD
   AND MST.MSTDOCNUM = BKGFLT.MSTDOCNUM(+)
   AND MST.SEQNUM = BKGFLT.SEQNUM(+)
   AND MST.DUPNUM = BKGFLT.DUPNUM(+)
   AND MST.DOCOWRIDR = BKGFLT.DOCOWRIDR(+)
   AND MST.CMPCOD = BKGFLT.CMPCOD(+)
   AND MST.UBRNUM = BKGFLT.UBRNUM(+)
   AND SEGULD.FLTNUM = FLTSEG.FLTNUM
   AND SEGULD.FLTSEQNUM = FLTSEG.FLTSEQNUM
   AND SEGULD.FLTCARIDR = FLTSEG.FLTCARIDR
   AND SEGULD.CMPCOD = FLTSEG.CMPCOD
   AND SEGULD.SEGSERNUM = FLTSEG.SEGSERNUM
   AND (SEGULD.ULDSTA is NULL  OR SEGULD.ULDSTA <> 'C')
   AND SEGULD.CMPCOD =?
   AND SEGULD.ULDNUM = ?

   UNION

   SELECT MST.SHPPFX, MST.MSTDOCNUM, MST.SEQNUM, MST.DUPNUM, MST.DOCOWRIDR,
          MST.STDPCS, MST.STDWGT, SEGSHP.WGT BDPWGT, SEGSHP.NUMPCS BDPPCS, MST.SCCCOD,
          MST.SHPDES, BKGFLT.FLTNUM, BKGFLT.FLTCARCOD, BKGFLT.FLTDAT,SEGULD.ULDNUM,
          SEGULD.ARPCOD, BKGFLT.FLTORG, MST.ORGCOD, MST.DSTCOD
     FROM OPRARPULD SEGULD,
          OPRULDSHP SEGSHP,
          OPRSHPMST MST,
          CAPBKGFLTDTL BKGFLT
    WHERE SEGULD.ULDNUM = SEGSHP.ULDNUM AND
    SEGULD.ARPCOD = SEGSHP.ARPCOD AND
    SEGULD.CMPCOD = SEGSHP.CMPCOD AND
       MST.MSTDOCNUM = SEGSHP.MSTDOCNUM
      AND MST.SEQNUM = SEGSHP.SEQNUM
      AND MST.DUPNUM = SEGSHP.DUPNUM
      AND MST.DOCOWRIDR = SEGSHP.DOCOWRIDR
      AND MST.CMPCOD = SEGSHP.CMPCOD
      AND SEGSHP.MSTDOCNUM = BKGFLT.MSTDOCNUM(+)
      AND SEGSHP.SEQNUM = BKGFLT.SEQNUM(+)
      AND SEGSHP.DUPNUM = BKGFLT.DUPNUM(+)
      AND SEGSHP.DOCOWRIDR = BKGFLT.DOCOWRIDR(+)
      AND SEGSHP.CMPCOD = BKGFLT.CMPCOD(+)
      AND SEGSHP.ARPCOD = BKGFLT.FLTORG(+)
	  AND SEGULD.CMPCOD = ?
      AND SEGULD.ULDNUM = ?

   ]]>
</QRY:Source>
</QRY:Definition>



<QRY:Definition>
<QRY:Id>211</QRY:Id>
<QRY:Source Name="operations.shipment.checkc2kcompatiblity" Type="NATIVE">
	<![CDATA[
  SELECT MST.CMPCOD FROM OPRC2KMST MST WHERE WHERE MST.CMPCOD=?

  ]]>
</QRY:Source>
</QRY:Definition>



<QRY:Definition>
<QRY:Id>212</QRY:Id>
<QRY:Source Name="operations.shipment.findPreOnLoadCheckDetailsForULD" Type="NATIVE">
	<![CDATA[
		  SELECT ULD.CMPCOD ULDCMPCOD, ULD.ULDNUM ULDULDNUM,FLT.FLTNUM,FLT.FLTSEQNUM, FLT.FLTDAT,FLT.ARPCOD,BLDCHKDTL.POCSTA,
			BLDCHKDTL.POCRSN,BLDCHKDTL.SERNUM BLDCHKDTLSERNUM,BLDCHKDTL.LSTUPDTIM
			FROM OPRULDDTL ULD,OPRSEGULD SEGULD,OPRARPEXPFLT FLT,OPRULDBLDCHKDTL BLDCHKDTL 
			WHERE SEGULD.CMPCOD = FLT.CMPCOD 
			AND SEGULD.FLTNUM = FLT.FLTNUM 
			AND SEGULD.FLTCARIDR = FLT.FLTCARIDR 
			AND SEGULD.FLTSEQNUM = FLT.FLTSEQNUM     
			AND SEGULD.ULDNUM = ULD.ULDNUM 
			AND SEGULD.CMPCOD = ULD.CMPCOD
			AND (ULD.CLSFLG IS NULL OR ULD.CLSFLG <> 'Y') 
			AND((SEGULD.RCVFLG is NULL or SEGULD.RCVFLG = 'N')) 
			AND BLDCHKDTL.CMPCOD(+) = ULD.CMPCOD 
			AND BLDCHKDTL.ARPCOD (+) = ULD.POL 
			AND BLDCHKDTL.ULDNUM (+) = ULD.ULDNUM 
			AND BLDCHKDTL.FLTNUM (+) = ULD.FLTNUM 
			AND BLDCHKDTL.FLTSEQNUM (+) = ULD.FLTSEQNUM 
			AND BLDCHKDTL.FLTCARIDR (+) = ULD.FLTCARIDR 
			AND ULD.CMPCOD = ?
			AND FLT.ARPCOD = ?
			AND ULD.ULDNUM = ? 
	 ]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>210</QRY:Id>
<QRY:Source Name="operations.shipment.findshipmenttrackingnumbers" Type="NATIVE">
	<![CDATA[
		SELECT MSTDOCNUM, DOCOWRIDR, DUPNUM, SEQNUM, TXNPCSGRP.GRPIDR PCSIDR, CMPCOD, LSTUPDTIM,
		       LSTUPDUSR, TRKPCS, TRKWGT, TXNCOD, TXNREFEGT, TXNREFFIV, TXNREFFOR,
		       TXNREFNIN, TXNREFONE, TXNREFSEV, TXNREFSIX, TXNREFTEN, TXNREFTHR,
		       TXNREFTWO
		  FROM OPRSHPTXNPCSGRP TXNPCSGRP
		 WHERE CMPCOD = ?

	 ]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>211</QRY:Id>
<QRY:Source Name="operations.shipment.findshipmenttrackingnumberdetails" Type="NATIVE">
	<![CDATA[
		SELECT TRK.MSTDOCNUM, TRK.DOCOWRIDR, TRK.DUPNUM, TRK.SEQNUM, TRK.GRPIDR PCSIDR, TRK.CMPCOD, TRK.LSTUPDTIM,
		       TRK.LSTUPDUSR, TRK.TRKPCS, TRK.TRKWGT, TRK.TXNCOD, TRK.TXNREFEGT, TRK.TXNREFFIV, TRK.TXNREFFOR,
		       TRK.TXNREFNIN, TRK.TXNREFONE, TRK.TXNREFSEV, TRK.TXNREFSIX, TRK.TXNREFTEN, TRK.TXNREFTHR,
		       TRK.TXNREFTWO, MST.DOCNUM, MST.DSTCOD, MST.ORGCOD, MST.OWRCOD, MST.STDPCS, MST.STDWGT,MST.SHPPFX
		 FROM OPRSHPTXNPCSGRP TRK,OPRSHPMST MST
		 WHERE MST.CMPCOD = TRK.CMPCOD
		     AND MST.DOCOWRIDR = TRK.DOCOWRIDR
		     AND MST.MSTDOCNUM = TRK.MSTDOCNUM
		     AND MST.DUPNUM = TRK.DUPNUM
		     AND MST.SEQNUM = TRK.SEQNUM
			 AND MST.CMPCOD = ?

	 ]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>212</QRY:Id>
<QRY:Source Name="operations.shipment.findTrackingNumberAcceptanceDetails" Type="NATIVE">
	<![CDATA[
			SELECT
	   			CMPCOD,DOCOWRIDR,DUPNUM,MSTDOCNUM,SEQNUM,TXNPCSGRP.GRPIDR PCSIDR,TRKPCS,TRKWGT,TXNREFEGT
			FROM
	 			OPRSHPTXNPCSGRP TXNPCSGRP
			WHERE
	  			CMPCOD = ? AND
	  			DOCOWRIDR = ? AND
	  			MSTDOCNUM = ? AND
	  			DUPNUM = ? AND
	  			SEQNUM = ?

	 ]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
	<QRY:Id>213</QRY:Id>
	<QRY:Source Name="operations.shipment.findtrackingnumberacceptanceshipmentdetails" Type="NATIVE">
		<![CDATA[
		SELECT OPR.ACPARPCOD,OPR.ACPWHSCOD,MST.CMPCOD,MST.DOCOWRIDR,MST.MSTDOCNUM,MST.DUPNUM,MST.SEQNUM,
				ORGCOD,DSTCOD,SCCCOD,STDPCS,MST.SHPPFX, MST.UBRNUM,
				STDWGT,STDWGTCOD,SHPDES,OPR.ACPRMK,TOTACPPCS,ARP.TOTSRNPCS,TOTACPWGT,STDDISWGT,
				SHPSTA,EXEFLG,MST.SHPCOD, MST.SHPNAM ,MST.SHPADRONE
				FROM OPRSHPMST  MST,OPRSHPDTL OPR,OPRARPSHP ARP
				WHERE MST.CMPCOD=OPR.CMPCOD(+)
				AND MST.DOCOWRIDR=OPR.DOCOWRIDR(+) AND
						MST.MSTDOCNUM=OPR.MSTDOCNUM(+)
						AND MST.DUPNUM=OPR.DUPNUM(+)
						AND MST.SEQNUM =OPR.SEQNUM(+)
						AND OPR.CMPCOD=ARP.CMPCOD(+)
						AND OPR.DOCOWRIDR=ARP.DOCOWRIDR(+) AND
						OPR.MSTDOCNUM=ARP.MSTDOCNUM(+)
						AND OPR.DUPNUM=ARP.DUPNUM(+)
						AND OPR.SEQNUM =ARP.SEQNUM(+)
						AND OPR.ACPARPCOD =ARP.ARPCOD(+)
						AND MST.CMPCOD=?
						AND MST.DOCOWRIDR=?
						AND MST.MSTDOCNUM=?
						AND MST.DUPNUM=?
						AND MST.SEQNUM =?

	]]>
	</QRY:Source>
	</QRY:Definition>



	<QRY:Definition>
		<QRY:Id>214</QRY:Id>
		<QRY:Source Name="operations.shipment.findprevioustrackingnumbertransactions" Type="NATIVE">
			<![CDATA[
			SELECT CMPCOD,DOCOWRIDR,MSTDOCNUM,
				DUPNUM,SEQNUM,TXNPCSGRPHIS.GRPIDR PCSIDR,TXNCOD,TXNHISIDR,TRKPCS,TRKWGT,TXNREFONE,
				TXNREFTWO,TXNREFTHR,TXNREFFOR,TXNREFFIV,TXNREFSIX,TXNREFSEV,
				TXNREFEGT,TXNREFNIN,TXNREFTEN
				FROM OPRSHPTXNPCSGRPHIS TXNPCSGRPHIS
				WHERE CMPCOD=?

		]]>
		</QRY:Source>
	</QRY:Definition>

<QRY:Definition>
	<QRY:Id>215</QRY:Id>
	<QRY:Source Name="operations.shipment.findtrackingnumbersfromwarehouse" Type="NATIVE">
	<![CDATA[
	SELECT  SHPTRKHIS.MSTDOCNUM, SHPTRKHIS.DOCOWRIDR, SHPTRKHIS.DUPNUM, SHPTRKHIS.SEQNUM, SHPTRKHIS.TXNHISIDR,
		      SHPTRKHIS.CMPCOD, SHPTRKHIS.TXNCOD,SHPTRKHIS.GRPIDR PCSIDR,SHPTRKHIS.TRKPCS,SHPTRKHIS.TRKWGT,SHPTRKHIS.TXNREFONE,SHPTRKHIS.TXNREFTWO, SHPTRKHIS.TXNREFTHR,
			  SHPTRKHIS.TXNREFFOR, SHPTRKHIS.TXNREFFIV,SHPTRKHIS.TXNREFSIX, SHPTRKHIS.TXNREFSEV, SHPTRKHIS.TXNREFEGT,
			  SHPTRKHIS.TXNREFNIN,SHPTRKHIS.TXNREFTEN,DTL.WHSCOD, DTL.LOCCOD,
	          DTL.STUCOD,DTL.ARPCOD DTLARPCOD
		  FROM OPRSHPTXNPCSGRPHIS SHPTRKHIS, WHSSHPTRKNUMDTL DTL
		 WHERE SHPTRKHIS.MSTDOCNUM = DTL.MSTDOCNUM(+)
		   AND SHPTRKHIS.DOCOWRIDR = DTL.DOCOWRIDR(+)
		   AND SHPTRKHIS.DUPNUM = DTL.DUPNUM(+)
		   AND SHPTRKHIS.SEQNUM = DTL.SEQNUM(+)
		   AND SHPTRKHIS.CMPCOD = DTL.CMPCOD(+)
		   AND SHPTRKHIS.GRPIDR = DTL.TRKNUM(+)
		   AND SHPTRKHIS.TXNCOD= ?
		   AND SHPTRKHIS.CMPCOD= ?
		   AND SHPTRKHIS.DOCOWRIDR = ?
		  AND SHPTRKHIS.MSTDOCNUM = ?
		  AND SHPTRKHIS.DUPNUM = ?
		  AND SHPTRKHIS.SEQNUM = ?
   ]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>216</QRY:Id>
	<QRY:Source Name="operations.shipment.findshipmentsforhhtuldtransfer" Type="NATIVE">
		<![CDATA[


		SELECT TRKNUM.GRPIDR PCSIDR, ULDSHP.DOCOWRIDR,
		       ULDSHP.MSTDOCNUM, ULDSHP.DUPNUM,
		       ULDSHP.SEQNUM, ULDSHP.NUMPCS, ULDSHP.WGT,
		       ULDSHP.ULDNUM, ARPULD.CMPCOD,
		       ARPULD.ARPCOD, ARPULD.ULDNUM, ARPULD.POU,
		       ARPULD.INBFLTCARCOD, ARPULD.INBFLTCARIDR,
		       ARPULD.INBFLTNUM, ARPULD.INBFLTSEQNUM,
		       ARPULD.INBLEGSERNUM, ARPULD.OUTFLTCARCOD,
		       ARPULD.OUTFLTCARIDR, SHPMST.SHPPFX,
		       SHPMST.STDPCS, SHPMST.STDWGT,
		       SHPMST.SCCCOD, SHPMST.SHPDES,
		       SHPMST.ORGCOD, SHPMST.DSTCOD,ARPULD.LSTUPDTIM
		  FROM OPRULDSHP ULDSHP,
		       OPRARPULD ARPULD,
		       OPRSHPMST SHPMST,
		       OPRSHPTXNPCSGRP TRKNUM
		 WHERE ULDSHP.CMPCOD = ARPULD.CMPCOD
		   AND ULDSHP.ULDNUM = ARPULD.ULDNUM
		   AND ULDSHP.ARPCOD = ARPULD.ARPCOD
		   AND ULDSHP.CMPCOD = SHPMST.CMPCOD
		   AND ULDSHP.SEQNUM = SHPMST.SEQNUM
		   AND ULDSHP.DUPNUM = SHPMST.DUPNUM
		   AND ULDSHP.DOCOWRIDR = SHPMST.DOCOWRIDR
		   AND ULDSHP.MSTDOCNUM = SHPMST.MSTDOCNUM
		   AND SHPMST.CMPCOD = TRKNUM.CMPCOD
		   AND SHPMST.MSTDOCNUM = TRKNUM.MSTDOCNUM
		   AND SHPMST.DOCOWRIDR = TRKNUM.DOCOWRIDR
		   AND SHPMST.DUPNUM = TRKNUM.DUPNUM
		   AND SHPMST.SEQNUM = TRKNUM.SEQNUM
		   AND (   ARPULD.POU NOT IN (
				   SELECT OWNARP.OWNARPCOD
				     FROM SHRUSEARPOWN OWNARP
				    WHERE OWNARP.CMPCOD =
						     ULDSHP.CMPCOD
				      AND OWNARP.ARPCOD =
						     ULDSHP.ARPCOD)
			OR ARPULD.POU IS NULL
		       )
		   AND (   ULDSHP.ARPCOD != ARPULD.POU
			OR ARPULD.POU IS NULL
		       )
		   AND      ULDSHP.CMPCOD = ?
		 ]]>
	</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>217</QRY:Id>
	<QRY:Source Name="operations.shipment.findshipmentsforhhttransfer" Type="NATIVE">
		<![CDATA[


	SELECT FLTSEG.FLTNUM, FLTSEG.FLTSEQNUM,
	       FLTSEG.SEGSERNUM, FLTSEG.FLTCARIDR,
	       SEGSHP.MFTPCS, SEGSHP.MFTVOL,
	       SEGSHP.MFTWGT, ARPSHP.CMPCOD,
	       ARPSHP.MSTDOCNUM, ARPSHP.DOCOWRIDR,
	       ARPSHP.DUPNUM, ARPSHP.SEQNUM,
	       ARPSHP.ARPCOD, ARPSHP.RCVPCS,
	       ARPSHP.RCVVOL, ARPSHP.RCVWGT,
	       SHPMST.STDPCS, SHPMST.STDWGT,
	       SHPMST.SHPDES, SHPMST.ORGCOD,
	       SHPMST.DSTCOD, SHPMST.SCCCOD,
	       SHPMST.SHPPFX, ARPARLSHP.AVLPCS,
	       ARPARLSHP.AVLWGT, ARPARLSHP.OWNCARIDR,
	       ARPARLSHP.OWNCARCOD, OPRTRK.CMPCOD,
	       OPRTRK.DOCOWRIDR, OPRTRK.MSTDOCNUM,
	       OPRTRK.DUPNUM, OPRTRK.SEQNUM,
	       OPRTRK.GRPIDR PCSIDR, OPRTRK.TXNCOD,
	       OPRTRK.TRKPCS, OPRTRK.TRKWGT,
	       OPRTRK.TXNREFONE, OPRTRK.TXNREFTWO,
	       OPRTRK.TXNREFTHR, OPRTRK.TXNREFFOR,
	       OPRTRK.TXNREFFIV, OPRTRK.TXNREFSIX,
	       OPRTRK.TXNREFSEV, OPRTRK.TXNREFEGT,
	       OPRTRK.TXNREFNIN, OPRTRK.TXNREFTEN
		  FROM OPRARPSHP ARPSHP,
		       OPRSHPMST SHPMST,
		       OPRSEGSHP SEGSHP,
		       OPRFLTSEG FLTSEG,
		       OPRARPARLSHP ARPARLSHP,
		       OPRARPIMPFLT ARPIMPFLT,
		       OPRSHPTXNPCSGRP OPRTRK
		 WHERE ARPSHP.CMPCOD = SHPMST.CMPCOD
		   AND ARPSHP.SEQNUM = SHPMST.SEQNUM
		   AND ARPSHP.DUPNUM = SHPMST.DUPNUM
		   AND ARPSHP.DOCOWRIDR = SHPMST.DOCOWRIDR
		   AND ARPSHP.MSTDOCNUM = SHPMST.MSTDOCNUM
		   AND ARPSHP.CMPCOD = SEGSHP.CMPCOD
		   AND ARPSHP.SEQNUM = SEGSHP.SEQNUM
		   AND ARPSHP.DUPNUM = SEGSHP.DUPNUM
		   AND ARPSHP.DOCOWRIDR = SEGSHP.DOCOWRIDR
		   AND ARPSHP.MSTDOCNUM = SEGSHP.MSTDOCNUM
		   AND ARPSHP.CMPCOD = ARPARLSHP.CMPCOD
		   AND ARPSHP.ARPCOD = ARPARLSHP.ARPCOD
		   AND ARPSHP.SEQNUM = ARPARLSHP.SEQNUM
		   AND ARPSHP.DUPNUM = ARPARLSHP.DUPNUM
		   AND ARPSHP.DOCOWRIDR = ARPARLSHP.DOCOWRIDR
		   AND ARPSHP.MSTDOCNUM = ARPARLSHP.MSTDOCNUM
		   AND SEGSHP.CMPCOD = FLTSEG.CMPCOD
		   AND SEGSHP.FLTNUM = FLTSEG.FLTNUM
		   AND SEGSHP.FLTSEQNUM = FLTSEG.FLTSEQNUM
		   AND SEGSHP.SEGSERNUM = FLTSEG.SEGSERNUM
		   AND SEGSHP.FLTCARIDR = FLTSEG.FLTCARIDR
		   AND FLTSEG.CMPCOD = ARPIMPFLT.CMPCOD
		   AND FLTSEG.FLTNUM = ARPIMPFLT.FLTNUM
		   AND FLTSEG.FLTSEQNUM = ARPIMPFLT.FLTSEQNUM
		   AND FLTSEG.FLTCARIDR = ARPIMPFLT.FLTCARIDR
		   AND FLTSEG.POU = ARPIMPFLT.ARPCOD
		   AND ARPSHP.ARPCOD = FLTSEG.POU
		   AND ARPSHP.CMPCOD = OPRTRK.CMPCOD
		   AND ARPSHP.DOCOWRIDR = OPRTRK.DOCOWRIDR
		   AND SHPMST.DUPNUM = OPRTRK.DUPNUM
		   AND SHPMST.MSTDOCNUM = OPRTRK.MSTDOCNUM
		   AND SHPMST.DSTCOD NOT IN (
			       SELECT OWNARP.OWNARPCOD
				 FROM SHRUSEARPOWN OWNARP
				WHERE OWNARP.CMPCOD =
						     ARPSHP.CMPCOD
				  AND OWNARP.ARPCOD =
						     ARPSHP.ARPCOD)
		   AND ARPSHP.ARPCOD != SHPMST.DSTCOD
		   AND ARPSHP.SEQNUM = 1
		   AND ARPSHP.CMPCOD = ?
		 ]]>
	</QRY:Source>
</QRY:Definition>


<QRY:Definition>
<QRY:Id>218</QRY:Id>
	<QRY:Source Name="operations.shipment.findshipmentsforhhttransferfornoflight" Type="NATIVE">
		<![CDATA[


	SELECT ARPSHP.CMPCOD, ARPSHP.MSTDOCNUM,
	       ARPSHP.DOCOWRIDR, ARPSHP.DUPNUM,
	       ARPSHP.SEQNUM, ARPSHP.ARPCOD,
	       ARPSHP.RCVPCS, ARPSHP.RCVVOL,
	       ARPSHP.RCVWGT, SHPMST.STDPCS,
	       SHPMST.STDWGT, SHPMST.SHPDES,
	       SHPMST.ORGCOD, SHPMST.DSTCOD,
	       SHPMST.SCCCOD, SHPMST.SHPPFX,
	       ARPARLSHP.AVLPCS, ARPARLSHP.AVLWGT,
	       ARPARLSHP.OWNCARIDR, ARPARLSHP.OWNCARCOD,
	       OPRTRK.DOCOWRIDR, OPRTRK.MSTDOCNUM,
	       OPRTRK.DUPNUM, OPRTRK.SEQNUM,
	       OPRTRK.GRPIDR PCSIDR, OPRTRK.TXNCOD,
	       OPRTRK.TRKPCS, OPRTRK.TRKWGT,
	       OPRTRK.TXNREFONE, OPRTRK.TXNREFTWO,
	       OPRTRK.TXNREFTHR, OPRTRK.TXNREFFOR,
	       OPRTRK.TXNREFFIV, OPRTRK.TXNREFSIX,
	       OPRTRK.TXNREFSEV, OPRTRK.TXNREFEGT,
	       OPRTRK.TXNREFNIN, OPRTRK.TXNREFTEN
	  FROM OPRARPSHP ARPSHP,
	       OPRSHPMST SHPMST,
	       OPRARPARLSHP ARPARLSHP,
	       OPRSHPTXNPCSGRP OPRTRK
	 WHERE ARPSHP.CMPCOD = SHPMST.CMPCOD
	   AND ARPSHP.SEQNUM = SHPMST.SEQNUM
	   AND ARPSHP.DUPNUM = SHPMST.DUPNUM
	   AND ARPSHP.DOCOWRIDR = SHPMST.DOCOWRIDR
	   AND ARPSHP.MSTDOCNUM = SHPMST.MSTDOCNUM
	   AND ARPSHP.CMPCOD = ARPARLSHP.CMPCOD
	   AND ARPSHP.ARPCOD = ARPARLSHP.ARPCOD
	   AND ARPSHP.SEQNUM = ARPARLSHP.SEQNUM
	   AND ARPSHP.DUPNUM = ARPARLSHP.DUPNUM
	   AND ARPSHP.DOCOWRIDR = ARPARLSHP.DOCOWRIDR
	   AND ARPSHP.MSTDOCNUM = ARPARLSHP.MSTDOCNUM
	   AND ARPSHP.CMPCOD = OPRTRK.CMPCOD
	   AND ARPSHP.DOCOWRIDR = OPRTRK.DOCOWRIDR
	   AND SHPMST.DUPNUM = OPRTRK.DUPNUM
	   AND SHPMST.MSTDOCNUM = OPRTRK.MSTDOCNUM
	   AND SHPMST.DSTCOD NOT IN (
	               SELECT OWNARP.OWNARPCOD
	                 FROM SHRUSEARPOWN OWNARP
	                WHERE OWNARP.CMPCOD =
	                                     ARPSHP.CMPCOD
	                  AND OWNARP.ARPCOD =
	                                     ARPSHP.ARPCOD)
	   AND ARPSHP.ARPCOD != SHPMST.DSTCOD
   AND ARPSHP.CMPCOD = ?

		 ]]>
	</QRY:Source>
</QRY:Definition>



<QRY:Definition>
<QRY:Id>219</QRY:Id>
<QRY:Source Name="operations.shipment.changeHAWBProcedure" Type="PROCEDURE">
<![CDATA[
	CALL PKG_OPR_SHP.opr_shp_change_doc_num (
					?,
					?,
					?,
					?,
					?,
					?,
					?
				)
   ]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>220</QRY:Id>
<QRY:Source Name="operations.shipment.findawbdiscrepancy_flight" Type="NATIVE">
	<![CDATA[
		SELECT MST.CMPCOD, MST.DOCOWRIDR, MST.MSTDOCNUM,MST.STDPCS,
						       MST.SEQNUM, MST.DUPNUM, MST.SHPPFX,MST.STDWGT,
						       MST.SHPTYP, MST.SCCCOD, MST.SHPDES,MST.PRDNAM,MST.ORGCOD,MST.DSTCOD DST,
						       NULL ARPCOD, NULL DISMSTDOCNUM,
						       NULL DISCOD, NULL DOCNUM, NULL CRTTIM,
						       NULL CLSDAT, NULL DISSTA, NULL DISRMK,
						       FLTDIS.DISSEQNUM,
						       FLTDIS.DISCOD FLTDISDISCOD,
						       FLTDIS.CRTTIM FLTDISCRTTIM,
						       FLTDIS.ARPCOD FLTDISARP, FLTDIS.DISPCS,
						       FLTDIS.DISWGT, FLTDIS.CLSDAT FLTDISCLSDAT,FLTDIS.RMK FLTDISRMK,
						       FLTDIS.DISSTA FLTDISSTA, NULL DMGCOD, NULL DMGDISSRCIND, NULL CDSSTA,
						       NULL DMGARP, 0 DMGSEQNUM, NULL DMGDISDAT,
						       NULL DMGDISSTA, NULL DMGRMK, 0 DMGPCS,
						       SEGSHP.MFTPCS, SEGSHP.MFTWGT,
						       SEGSHP.RCVPCS, SEGSHP.RCVWGT, 0 FLTCARIDR,
						       NULL DISFLTCARCOD, NULL DISFLTNUM,
						       NULL DISFLTDAT,
						       FLTDIS.FLTCARCOD FLTDISFLTCARCOD,
						       FLTDIS.FLTNUM FLTDISFLTNUM,
						       FLTDIS.FLTDAT FLTDISFLTDAT,
						       FLTDIS.FLTSEQNUM FLTDISFLTSEQNUM,
						       NULL DISARPCOD, FLTDIS.ARPCOD FLTDISARPCOD,
						       NULL DMGARPCOD, NULL IMGPTH,NULL IMG,
    NULL FILNAM,
    NULL FNDSHPNUM,  NULL UPLDTIM,
    NULL UPLDUSR,
    NULL UPLDSTN,
	NULL IMGSEQNUM,
	ARPSHP.PLTUSEFLG PLTUSEFLG,
	SHPDTL.PLTUSEFLG DTLPLTFLG,
	FLTDIS.FLTCARIDR FLTDISFLTCARIDR
						  FROM OPRSHPMST MST,
						       OPRSHPFLTDIS FLTDIS,
						       OPRFLTSEG FLTSEG,
						       OPRSEGSHP SEGSHP,
						       OPRARPSHP ARPSHP,
							   OPRSHPDTL SHPDTL
						 WHERE FLTDIS.CMPCOD = MST.CMPCOD
						   AND FLTDIS.DOCOWRIDR = MST.DOCOWRIDR
						   AND FLTDIS.MSTDOCNUM = MST.MSTDOCNUM
						   AND FLTDIS.SEQNUM = MST.SEQNUM
						   AND FLTDIS.DUPNUM = MST.DUPNUM
						   AND FLTDIS.CMPCOD = FLTSEG.CMPCOD
						   AND FLTDIS.FLTCARIDR = FLTSEG.FLTCARIDR
						   AND FLTDIS.FLTNUM = FLTSEG.FLTNUM
						   AND FLTDIS.FLTSEQNUM = FLTSEG.FLTSEQNUM
						   AND FLTDIS.ARPCOD = FLTSEG.POU
						   AND FLTSEG.CMPCOD = SEGSHP.CMPCOD
						   AND FLTSEG.FLTCARIDR = SEGSHP.FLTCARIDR
						   AND FLTSEG.FLTNUM = SEGSHP.FLTNUM
						   AND FLTSEG.FLTSEQNUM = SEGSHP.FLTSEQNUM
						   AND FLTSEG.SEGSERNUM = SEGSHP.SEGSERNUM
						   AND FLTDIS.DOCOWRIDR = SEGSHP.DOCOWRIDR
						   AND FLTDIS.MSTDOCNUM = SEGSHP.MSTDOCNUM
						   AND FLTDIS.SEQNUM = SEGSHP.SEQNUM
						   AND FLTDIS.DUPNUM = SEGSHP.DUPNUM
						   AND FLTDIS.CMPCOD = ARPSHP.CMPCOD(+)
						   AND FLTDIS.DOCOWRIDR = ARPSHP.DOCOWRIDR(+)
						   AND FLTDIS.MSTDOCNUM = ARPSHP.MSTDOCNUM(+)
						   AND FLTDIS.SEQNUM = ARPSHP.SEQNUM(+)
						   AND FLTDIS.DUPNUM = ARPSHP.DUPNUM(+)
				   AND FLTDIS.ARPCOD = ARPSHP.ARPCOD(+)
				   AND MST.CMPCOD = SHPDTL.CMPCOD(+)
					AND MST.MSTDOCNUM = SHPDTL.MSTDOCNUM(+)
					AND MST.DOCOWRIDR = SHPDTL.DOCOWRIDR(+)
					AND MST.SEQNUM = SHPDTL.SEQNUM(+)
					AND MST.DUPNUM = SHPDTL.DUPNUM(+)
				   
			  	   AND MST.CMPCOD = ?
				   AND MST.DOCOWRIDR = ?
				   AND MST.MSTDOCNUM = ?
				   AND MST.DUPNUM = ?
		   AND MST.SEQNUM = ?
	]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>221</QRY:Id>
<QRY:Source Name="operations.shipment.findawbdiscrepancy_damage" Type="NATIVE">
	<![CDATA[

						       SELECT MST.CMPCOD, MST.DOCOWRIDR, MST.MSTDOCNUM,MST.STDPCS,MST.SEQNUM, MST.DUPNUM, MST.SHPPFX,MST.STDWGT,
						       MST.SHPTYP, MST.SCCCOD, MST.SHPDES,MST.PRDNAM,MST.ORGCOD,MST.DSTCOD DST,
						       NULL ARPCOD, NULL DISMSTDOCNUM,
						       NULL DISCOD, NULL DOCNUM, NULL CRTTIM,
						       NULL CLSDAT, NULL DISSTA, NULL DISRMK,
						       0 DISSEQNUM, NULL FLTDISDISCOD,
						       NULL FLTDISCRTTIM, NULL FLTDISARP,
						       0 DISPCS, 0 DISWGT, NULL FLTDISCLSDAT,NULL FLTDISRMK,
						       NULL FLTDISSTA, DMGSRV.DMGCOD, DMG.DMGDISSRCIND, DMGSRV.CDSSTA,
						       DMG.ARPCOD DMGARP, DMG.DISSEQNUM DMGSEQNUM,
						       DMG.DISDAT DMGDISDAT, DMG.DISSTA DMGDISSTA,
						       DMG.RMK DMGRMK, DMG.DMGPCS, 0 MFTPCS,
						       0 MFTWGT, 0 RCVPCS, 0 RCVWGT, 0 FLTCARIDR,
						       NULL DISFLTCARCOD, NULL DISFLTNUM,
						       NULL DISFLTDAT, NULL FLTDISFLTCARCOD,
						       NULL FLTDISFLTNUM, NULL FLTDISFLTDAT,
						       0 FLTDISFLTSEQNUM, NULL DISARPCOD,
						       NULL FLTDISARPCOD, DMG.ARPCOD DMGARPCOD,DMG.IMGPTH, DMGBLB.IMG IMG,
    DMGBLB.FILNAM,
    NULL FNDSHPNUM, DMGBLB.LSTUPDTIM UPLDTIM,
    DMGBLB.LSTUPDUSR UPLDUSR,
    DMGBLB.ARPCOD UPLDSTN,
	DMGBLB.IMGSEQNUM,
	ARPSHP.PLTUSEFLG PLTUSEFLG,
	SHPDTL.PLTUSEFLG DTLPLTFLG,
	0 FLTDISFLTCARIDR
							FROM OPRSHPMST MST,
						       OPRDMGDIS DMG,
						       OPRARPSHP ARPSHP,
							   OPRDMGSRYDTL DMGSRV,OPRDMGDISBLB DMGBLB,
							   OPRSHPDTL SHPDTL
						 WHERE MST.CMPCOD = DMG.CMPCOD
						   AND MST.DOCOWRIDR = DMG.DOCOWRIDR
						   AND MST.MSTDOCNUM = DMG.MSTDOCNUM
						   AND MST.SEQNUM = DMG.SEQNUM
						   AND MST.DUPNUM = DMG.DUPNUM
						   AND MST.CMPCOD = ARPSHP.CMPCOD(+)
						   AND MST.DOCOWRIDR = ARPSHP.DOCOWRIDR(+)
						   AND MST.MSTDOCNUM = ARPSHP.MSTDOCNUM(+)
						   AND MST.SEQNUM = ARPSHP.SEQNUM(+)
						   AND MST.DUPNUM = ARPSHP.DUPNUM(+)
				   
						  AND DMG.CMPCOD      = DMGSRV.CMPCOD(+)
						  AND DMG.DOCOWRIDR    = DMGSRV.DOCOWRIDR(+)
						  AND DMG.MSTDOCNUM    = DMGSRV.MSTDOCNUM(+)
						  AND DMG.SEQNUM       = DMGSRV.SEQNUM(+)
						  AND DMG.DUPNUM       = DMGSRV.DUPNUM(+)
						  AND DMG.DISSEQNUM    = DMGSRV.DISSEQNUM(+)
				   
				     AND DMG.CMPCOD       = DMGBLB.CMPCOD(+)
  AND DMG.DOCOWRIDR    = DMGBLB.DOCOWRIDR(+)
  AND DMG.MSTDOCNUM    = DMGBLB.MSTDOCNUM(+)
  AND DMG.SEQNUM       = DMGBLB.SEQNUM(+)
  AND DMG.DUPNUM       = DMGBLB.DUPNUM(+)
  AND DMG.DISSEQNUM    = DMGBLB.DISSEQNUM(+)
  AND MST.CMPCOD = SHPDTL.CMPCOD(+)
AND MST.MSTDOCNUM = SHPDTL.MSTDOCNUM(+)
AND MST.DOCOWRIDR = SHPDTL.DOCOWRIDR(+)
AND MST.SEQNUM = SHPDTL.SEQNUM(+)
AND MST.DUPNUM = SHPDTL.DUPNUM(+)
  
				   AND MST.CMPCOD = ?
				   AND MST.DOCOWRIDR = ?
				   AND MST.MSTDOCNUM = ?
				   AND MST.DUPNUM = ?
		   AND MST.SEQNUM = ?
	]]>
</QRY:Source>
</QRY:Definition>





<QRY:Definition>
<QRY:Id>221</QRY:Id>
<QRY:Source Name="operations.shipment.chengetrknumpro" Type="PROCEDURE">
<![CDATA[
	CALL PKG_OPR_SHP.opr_shp_change_trk_num (
					?,
					?,
					?,
					?,
					?
				)
   ]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
		<QRY:Id>222</QRY:Id>
		<QRY:Source Name="operations.shipment.findtrackingnumbers" Type="NATIVE">
			<![CDATA[
			SELECT TRK.MSTDOCNUM, TRK.DOCOWRIDR, TRK.DUPNUM, TRK.SEQNUM, TRK.GRPIDR PCSIDR, TRK.CMPCOD, TRK.LSTUPDTIM,
					       TRK.LSTUPDUSR, TRK.TRKPCS, TRK.TRKWGT, TRK.TXNCOD,SHP.MFTPCS, SHP.RCVPCS
					 FROM OPRSHPTXNPCSGRP TRK,OPRARPSHP SHP
					 WHERE SHP.CMPCOD = TRK.CMPCOD
					     AND SHP.DOCOWRIDR = TRK.DOCOWRIDR
					     AND SHP.MSTDOCNUM = TRK.MSTDOCNUM
					     AND SHP.DUPNUM = TRK.DUPNUM
					     AND SHP.SEQNUM = TRK.SEQNUM
						 AND SHP.CMPCOD = ?
						 AND SHP.ARPCOD=?
						 AND SHP.DOCOWRIDR =?
						 AND SHP.MSTDOCNUM=?

		]]>
		</QRY:Source>
</QRY:Definition>


<QRY:Definition>
<QRY:Id>223</QRY:Id>
	<QRY:Source Name="operations.shipment.cto.delivery.findPickListDeliveryDetails" Type="NATIVE">
		<![CDATA[

	SELECT MST.CMPCOD,MST.ARPCOD,MST.WHSCOD,MST.REFNUM,MST.AGTCOD,SHPTRK.DOCOWRIDR,
		   ARPSHP.MSTDOCNUM,ARPSHP.SEQNUM,ARPSHP.DUPNUM,ARPSHP.RCVPCS,ARPSHP.RCVWGT,
			   ARPSHP.BOE,SHPMST.DOCNUM,ARPSHP.AVLPCS,ARPSHP.DNTUSEFLG, ARPSHP.RCVPCS,
			   ARPSHP.RCVWGT, ARPSHP.AVLWGT,ARPSHP.TOTDLVNOTPCS, ARPSHP.TOTDLVNOTWGT,
			   ARPSHP.TOTDLVPCS,ARPSHP.TOTDLVWGT,DLVNOT.DLVNOTNUM,PCKLST.TRKNUM,
			   SHPMST.ORGCOD,SHPMST.DSTCOD,SHPMST.STDPCS,SHPMST.STDWGT,SHPTRK.TXNCOD,
	   	  	 DLVNOT.DLVNOTPCS,DLVNOT.DLVNOTWGT,DLVNOT.DLVNOTSTA,PCKLST.PCKPCS,
				SHPMST.SHPPFX,PCKLST.PCKWGT,PCKLST.LOCCOD,PCKLST.STUCOD,
				MST.LSTUPDTIM MSTUPDTIM,
	      		ARPSHP.LSTUPDTIM ARPSHPUPDTIM,
	       		SHPMST.LSTUPDTIM SHPMSTUPDTIM,
	       		SHPTRK.LSTUPDTIM SHPTRKUPDTIM,
	       		DLVNOT.LSTUPDTIM DLVNOTUPDTIM,
				SHPDTL.LSTUPDTIM SHPDTLUPDTIM
		  FROM WHSPCKLSTMST  MST,
		  WHSTRKNUMPCKLST PCKLST,
		  OPRARPSHP ARPSHP,
		  OPRSHPMST SHPMST,
		  OPRSHPTXNPCSGRP SHPTRK,
			  OPRSHPDLVNOT DLVNOT,
			  OPRSHPDTL SHPDTL

		 WHERE MST.CMPCOD = PCKLST.CMPCOD
	           AND MST.ARPCOD = PCKLST.ARPCOD
		   AND MST.WHSCOD = PCKLST.WHSCOD
		   AND MST.REFNUM = PCKLST.REFNUM

		   AND SHPTRK.CMPCOD = PCKLST.CMPCOD
		   AND SHPTRK.DOCOWRIDR = PCKLST.DOCOWRIDR
		   AND SHPTRK.MSTDOCNUM = PCKLST.MSTDOCNUM
		   AND SHPTRK.DUPNUM = PCKLST.DUPNUM
		   AND SHPTRK.SEQNUM = PCKLST.SEQNUM
		   AND SHPTRK.GRPIDR = PCKLST.TRKNUM

		   AND ARPSHP.CMPCOD = PCKLST.CMPCOD
		   AND ARPSHP.ARPCOD = PCKLST.ARPCOD
		   AND ARPSHP.DOCOWRIDR = PCKLST.DOCOWRIDR
		   AND ARPSHP.MSTDOCNUM = PCKLST.MSTDOCNUM
		   AND ARPSHP.DUPNUM = PCKLST.DUPNUM
		   AND ARPSHP.SEQNUM = PCKLST.SEQNUM

		   AND ARPSHP.CMPCOD = SHPMST.CMPCOD
		   AND ARPSHP.DOCOWRIDR = SHPMST.DOCOWRIDR
		   AND ARPSHP.MSTDOCNUM = SHPMST.MSTDOCNUM
		   AND ARPSHP.DUPNUM = SHPMST.DUPNUM
		   AND ARPSHP.SEQNUM = SHPMST.SEQNUM

			   AND ARPSHP.CMPCOD = SHPDTL.CMPCOD
			   AND ARPSHP.DOCOWRIDR = SHPDTL.DOCOWRIDR
			   AND ARPSHP.MSTDOCNUM = SHPDTL.MSTDOCNUM
			   AND ARPSHP.DUPNUM = SHPDTL.DUPNUM
			   AND ARPSHP.SEQNUM = SHPDTL.SEQNUM

		   AND MST.CMPCOD = DLVNOT.CMPCOD
		   AND MST.ARPCOD = DLVNOT.ARPCOD
		   AND MST.WHSCOD = DLVNOT.PCKWHSCOD
		   AND MST.REFNUM = DLVNOT.PCKLSTREFNUM

		   AND MST.CMPCOD = ?
		   AND MST.ARPCOD = ?
		   AND MST.WHSCOD = ?
		   AND MST.REFNUM = ?

		 ]]>
	</QRY:Source>
</QRY:Definition>


<QRY:Definition>
		<QRY:Id>224</QRY:Id>
		<QRY:Source Name="operations.shipment.findulddetailsfortransfer" Type="NATIVE">
			<![CDATA[
			 SELECT  ARPULD.CMPCOD,ARPULD.ARPCOD,ARPULD.ULDNUM,ARPULD.POU,ARPULD.INBFLTCARCOD,ARPULD.INBFLTCARIDR,
			 ARPULD.INBFLTNUM,ARPULD.INBFLTSEQNUM,ARPULD.INBLEGSERNUM,
			 ARPULD.OUTFLTCARCOD,ARPULD.OUTFLTCARIDR,ARPULD.LSTUPDTIM,ARPULD.THRUNT

		  FROM OPRARPULD ARPULD
		  WHERE
			(ARPULD.POU NOT IN (
			SELECT OWNARP.OWNARPCOD FROM SHRUSEARPOWN OWNARP WHERE
				OWNARP.CMPCOD = ARPULD.CMPCOD AND
				OWNARP.ARPCOD = ARPULD.ARPCOD
			) OR ARPULD.POU IS NULL) AND
 			ARPULD.ULDNUM = ? AND
 			ARPULD.ARPCOD = ? AND
 			ARPULD.CMPCOD = ?

		]]>
		</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>225</QRY:Id>
<QRY:Source Name="operations.shipment.cto.delivery.findPickListDetailsForDN" Type="NATIVE">
	<![CDATA[

	 SELECT PCKLSTMST.AGTCOD,PCKLSTMST.ARPCOD,
	 PCKLSTMST.REFNUM,PCKLSTMST.WHSCOD,PCKLSTMST.PCKRMK,
	 TRKNUMPCKLST.LOCCOD,TRKNUMPCKLST.STUCOD,
	 TRKNUMPCKLST.PCKPCS,TRKNUMPCKLST.TRKNUM,
	 DLVNOTCUS.CNSNAM,DLVNOTCUS.CNSCOD,DLVNOTCUS.DLVNOTNUM

	 FROM
	 WHSPCKLSTMST PCKLSTMST,
	 WHSTRKNUMPCKLST TRKNUMPCKLST,
	 OPRSHPDLVNOTCUS DLVNOTCUS

	 WHERE

	  PCKLSTMST.CMPCOD=TRKNUMPCKLST.CMPCOD AND
	  PCKLSTMST.ARPCOD=TRKNUMPCKLST.ARPCOD AND
	  PCKLSTMST.WHSCOD=TRKNUMPCKLST.WHSCOD AND
	  PCKLSTMST.REFNUM=TRKNUMPCKLST.REFNUM AND
	  PCKLSTMST.ARPCOD=DLVNOTCUS.ARPCOD AND
	  PCKLSTMST.CMPCOD=DLVNOTCUS.CMPCOD AND
	  PCKLSTMST.CMPCOD= ? AND
	  PCKLSTMST.ARPCOD= ? AND
	  PCKLSTMST.WHSCOD= ? AND
	  PCKLSTMST.REFNUM= ? AND
	  DLVNOTCUS.DLVNOTNUM= ?

   	]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>226</QRY:Id>
	<QRY:Source Name="operations.shipment.cto.delivery.findPickListDeliveryDetailsForHHT" Type="NATIVE">
		<![CDATA[

	SELECT MST.CMPCOD,MST.ARPCOD,MST.WHSCOD,MST.REFNUM,MST.AGTCOD,SHPTRK.DOCOWRIDR,
			   ARPSHP.MSTDOCNUM,ARPSHP.SEQNUM,ARPSHP.DUPNUM,PCKLST.TRKNUM,
				MST.LSTUPDTIM MSTUPDTIM,
	      		ARPSHP.LSTUPDTIM ARPSHPUPDTIM,
	       		SHPMST.LSTUPDTIM SHPMSTUPDTIM,
	       		SHPTRK.LSTUPDTIM SHPTRKUPDTIM,
	       		DLVNOT.LSTUPDTIM DLVNOTUPDTIM,
				SHPDTL.LSTUPDTIM SHPDTLUPDTIM

		  FROM WHSPCKLSTMST  MST,
		  WHSTRKNUMPCKLST PCKLST,
		  OPRARPSHP ARPSHP,
		  OPRSHPMST SHPMST,
		  OPRSHPTXNPCSGRP SHPTRK,
			  OPRSHPDLVNOT DLVNOT,
	     	          OPRSHPDTL SHPDTL

		 WHERE MST.CMPCOD = PCKLST.CMPCOD
	           AND MST.ARPCOD = PCKLST.ARPCOD
		   AND MST.WHSCOD = PCKLST.WHSCOD
		   AND MST.REFNUM = PCKLST.REFNUM

		   AND SHPTRK.CMPCOD = PCKLST.CMPCOD
		   AND SHPTRK.DOCOWRIDR = PCKLST.DOCOWRIDR
		   AND SHPTRK.MSTDOCNUM = PCKLST.MSTDOCNUM
		   AND SHPTRK.DUPNUM = PCKLST.DUPNUM
		   AND SHPTRK.SEQNUM = PCKLST.SEQNUM
		   AND SHPTRK.GRPIDR = PCKLST.TRKNUM

		   AND ARPSHP.CMPCOD = PCKLST.CMPCOD
		   AND ARPSHP.ARPCOD = PCKLST.ARPCOD
		   AND ARPSHP.DOCOWRIDR = PCKLST.DOCOWRIDR
		   AND ARPSHP.MSTDOCNUM = PCKLST.MSTDOCNUM
		   AND ARPSHP.DUPNUM = PCKLST.DUPNUM
		   AND ARPSHP.SEQNUM = PCKLST.SEQNUM

		   AND ARPSHP.CMPCOD = SHPMST.CMPCOD
		   AND ARPSHP.DOCOWRIDR = SHPMST.DOCOWRIDR
		   AND ARPSHP.MSTDOCNUM = SHPMST.MSTDOCNUM
		   AND ARPSHP.DUPNUM = SHPMST.DUPNUM
		   AND ARPSHP.SEQNUM = SHPMST.SEQNUM

			   AND ARPSHP.CMPCOD = SHPDTL.CMPCOD
			   AND ARPSHP.DOCOWRIDR = SHPDTL.DOCOWRIDR
			   AND ARPSHP.MSTDOCNUM = SHPDTL.MSTDOCNUM
			   AND ARPSHP.DUPNUM = SHPDTL.DUPNUM
			   AND ARPSHP.SEQNUM = SHPDTL.SEQNUM

		   AND MST.CMPCOD = DLVNOT.CMPCOD
		   AND MST.ARPCOD = DLVNOT.ARPCOD
		   AND MST.WHSCOD = DLVNOT.PCKWHSCOD
		   AND MST.REFNUM = DLVNOT.PCKLSTREFNUM
		   AND MST.CMPCOD = ?
		   AND MST.ARPCOD = ?
		   AND MST.WHSCOD = ?
		   AND MST.REFNUM = ?

		 ]]>
	</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>227</QRY:Id>
	<QRY:Source Name="operations.shipment.cto.delivery.findCollectionSlipDetailsForDN" Type="NATIVE">
	<![CDATA[
		SELECT DLV.DLVNOTNUM,DLV.DOCNUM,DLV.MSTDOCNUM,DLV.ARPCOD,DLV.RMK,
			DLVNOTCUS.CNSNAM,DLVNOTCUS.CNSCOD,ARP.BOE
		FROM  OPRARPSHP ARP, OPRSHPDLVNOT DLV,OPRSHPDLVNOTCUS DLVNOTCUS
		WHERE
			   DLV.ARPCOD = ARP.ARPCOD
			   AND DLV.CMPCOD = ARP.CMPCOD
			   AND DLV.DOCOWRIDR = ARP.DOCOWRIDR
			   AND DLV.MSTDOCNUM = ARP.MSTDOCNUM
			   AND DLV.SEQNUM = ARP.SEQNUM
			   AND DLV.DUPNUM = ARP.DUPNUM
			   AND DLV.ARPCOD=DLVNOTCUS.ARPCOD
               AND DLV.CMPCOD=DLVNOTCUS.CMPCOD
			   AND DLV.DLVNOTNUM=DLVNOTCUS.DLVNOTNUM
			   AND DLV.CMPCOD = ?
			   AND DLV.ARPCOD = ?
			   AND DLV.DLVNOTNUM = ?



		]]>
	</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>228</QRY:Id>
	<QRY:Source Name="operations.shipment.cto.delivery.findDeliverySlipDetails" Type="NATIVE">
	<![CDATA[
		SELECT MST.CMPCOD,MST.ARPCOD,MST.REFNUM,MST.AGTCOD,DLVNOT.RMK,SHPTRK.DOCOWRIDR,
		   ARPSHP.MSTDOCNUM,SHPMST.DOCNUM,ARPSHP.DUPNUM,PCKLST.TRKNUM,PCKLST.PCKPCS ,
		   DLVNOTCUS.CNSCOD,DLVNOTCUS.CNSNAM ,SHPTRK.TXNCOD,SHPMST.STDPCS,SHPMST.STDWGT

		  FROM WHSPCKLSTMST  MST,
		  WHSTRKNUMPCKLST PCKLST,
		  OPRARPSHP ARPSHP,
		  OPRSHPMST SHPMST,
		  OPRSHPTXNPCSGRP SHPTRK,
		  OPRSHPDLVNOT DLVNOT ,
		  OPRSHPDLVNOTCUS DLVNOTCUS

		 WHERE MST.CMPCOD = PCKLST.CMPCOD
	           AND MST.ARPCOD = PCKLST.ARPCOD
		   AND MST.WHSCOD = PCKLST.WHSCOD
		   AND MST.REFNUM = PCKLST.REFNUM

		   AND SHPTRK.CMPCOD = PCKLST.CMPCOD
		   AND SHPTRK.DOCOWRIDR = PCKLST.DOCOWRIDR
		   AND SHPTRK.MSTDOCNUM = PCKLST.MSTDOCNUM
		   AND SHPTRK.DUPNUM = PCKLST.DUPNUM
		   AND SHPTRK.SEQNUM = PCKLST.SEQNUM
		   AND SHPTRK.GRPIDR = PCKLST.TRKNUM

		   AND ARPSHP.CMPCOD = PCKLST.CMPCOD
		   AND ARPSHP.ARPCOD = PCKLST.ARPCOD
		   AND ARPSHP.DOCOWRIDR = PCKLST.DOCOWRIDR
		   AND ARPSHP.MSTDOCNUM = PCKLST.MSTDOCNUM
		   AND ARPSHP.DUPNUM = PCKLST.DUPNUM
		   AND ARPSHP.SEQNUM = PCKLST.SEQNUM

		   AND ARPSHP.CMPCOD = SHPMST.CMPCOD
		   AND ARPSHP.DOCOWRIDR = SHPMST.DOCOWRIDR
		   AND ARPSHP.MSTDOCNUM = SHPMST.MSTDOCNUM
		   AND ARPSHP.DUPNUM = SHPMST.DUPNUM
		   AND ARPSHP.SEQNUM = SHPMST.SEQNUM

		   AND MST.CMPCOD = DLVNOT.CMPCOD
		   AND MST.ARPCOD = DLVNOT.ARPCOD
		   AND MST.WHSCOD = DLVNOT.PCKWHSCOD
		   AND MST.REFNUM = DLVNOT.PCKLSTREFNUM

		   AND DLVNOT.CMPCOD = DLVNOTCUS.CMPCOD
		   AND DLVNOT.ARPCOD = DLVNOTCUS.ARPCOD
		   AND DLVNOT.DLVNOTNUM = DLVNOTCUS.DLVNOTNUM


		   AND MST.CMPCOD = ?
		   AND MST.ARPCOD = ?
		   AND MST.WHSCOD = ?
		   AND MST.REFNUM = ?


		]]>
	</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>229</QRY:Id>
	<QRY:Source Name="operations.shipment.findAWBBarcodeDetails" Type="NATIVE">
	<![CDATA[
			SELECT
MST.CMPCOD MSTCMPCOD,
  MST.ORGCOD,
  RTG.DSTCOD RTGDSTCOD,
  MST.STDPCS,
  MST.STDWGT,
  MST.SHPPFX,
  MST.MSTDOCNUM,
  MST.DOCNUM,
  MST.DUPNUM MSTDUPNUM,
  MST.DOCOWRIDR MSTDOCOWRIDR,
  MST.SEQNUM MSTSEQNUM,
  MST.PARSEQNUM PARSEQNUM,
  rtg.mstdocnum fltmstdocnum,
  rtg.cmpcod fltcmpcod,
  rtg.fltseqnum,
  rtg.docowridr fltdocowridr,
  rtg.rtgsernum fltrtgsernum,
  rtg.rteseqnum fltrteseqnum,
  rtg.fltcaridr fltfltcaridr,
  rtg.fltcarcod fltfltcarcod,
  rtg.fltnum fltfltnum,
  MIS.REQFLTNUM,
  ACC.JRNDAT,
  MST.AGTNAM,
  MIS.REQFLTCARCOD,
  BKGFLTDTL.FLTCARIDR FLTBOKCARIDR,
  BKGFLTDTL.FLTCARCOD FLTBOKCARCOD,
  BKGFLTDTL.FLTDAT FLTBOKFLTDAT,
  BKGFLTDTL.FLTNUM FLTBOKFLTNUM,
  BKGFLTDTL.SEGSERNUM FLTBOKSEGNUM,
  BKGFLTDTL.FLTORG FLTBOKSEGORG,
  BKGFLTDTL.FLTDST FLTBOKSEGDST,
  0 FLTBOKVERNUM,
  BKGFLTDTL.SERNUM FLTBOKSERNUM
FROM OPRSHPMST MST,
  OPRSHPRTG RTG,
  OPRSHPMSTMIS MIS,
  OPRSHPMSTACC ACC,
 CAPBKGFLTDTL BKGFLTDTL
			  WHERE MST.CMPCOD = RTG.CMPCOD(+)
			    AND MST.DOCOWRIDR = RTG.DOCOWRIDR(+)
			    AND MST.MSTDOCNUM = RTG.MSTDOCNUM(+)
			    AND MST.DUPNUM = RTG.DUPNUM(+)
AND mst.seqnum    = rtg.seqnum(+)
 AND MST.CMPCOD = MIS.CMPCOD
 AND MST.DOCOWRIDR = MIS.DOCOWRIDR
 AND MST.MSTDOCNUM = MIS.MSTDOCNUM
AND mst.dupnum    = mis.dupnum
 AND MST.SEQNUM = MIS.SEQNUM
 AND MST.MSTDOCNUM   = ACC.MSTDOCNUM(+)
 AND MST.DOCOWRIDR   = ACC.DOCOWRIDR(+)
 AND MST.DUPNUM      = ACC.DUPNUM(+)
 AND MST.SEQNUM      = ACC.SEQNUM(+)
 AND MST.CMPCOD      = ACC.CMPCOD(+)
AND MST.CMPCOD    =BKGFLTDTL.CMPCOD(+)
AND MST.DOCOWRIDR = BKGFLTDTL.DOCOWRIDR(+)
AND MST.MSTDOCNUM = BKGFLTDTL.MSTDOCNUM(+)
AND mst.dupnum    = BKGFLTDTL.dupnum(+)
AND MST.SEQNUM    = BKGFLTDTL.SEQNUM(+)
AND MST.UBRNUM    = BKGFLTDTL.UBRNUM(+)
				 AND MST.CMPCOD = ?
			     AND MST.DOCOWRIDR = ?
			     AND MST.MSTDOCNUM = ?
			     AND MST.DUPNUM = ?
	    			 AND MST.SEQNUM = ?


		]]>
	</QRY:Source>
</QRY:Definition>


<QRY:Definition>
<QRY:Id>230</QRY:Id>
	<QRY:Source Name="operations.shipment.cto.findirpenquirylocationdetails" Type="NATIVE">

	<![CDATA[
			SELECT mstdocnum, DOCNUM, SUBSTR(MAX(SYS_CONNECT_BY_PATH(LOCCOD, ',' )),2) loccod
   			FROM (SELECT mstdocnum, DOCNUM
               			, LOCCOD,arpcod
               			,     row_number() OVER (PARTITION BY mstdocnum,docnum ORDER BY LOCCOD ) rn
            			FROM WHSOPRSHPLOC
            		WHERE cmpcod = ?
		]]>
	</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>231</QRY:Id>
	<QRY:Source Name="operations.shipment.findulddetails" Type="NATIVE">

	<![CDATA[
			SELECT ULDACP.ULDNUM,ULDACP.WHSCOD,ULDACP.LOCCOD
			  FROM OPRULDACP ULDACP
			 WHERE ULDACP.CMPCOD = ?
			   AND ULDACP.ULDNUM = ?
   			   AND ULDACP.ARPCOD = ?
		]]>
	</QRY:Source>
</QRY:Definition>
	
	<QRY:Definition>
	<QRY:Id>232</QRY:Id>
			 <QRY:Source Name="operations.shipment.findcontactdetails" Type="NATIVE">
				<![CDATA[
		           SELECT MST.CNSCOD, MST.AGTCOD, NFY.NFYCOD
				  FROM OPRSHPMST MST, OPRSHPNFY NFY
				 WHERE MST.CMPCOD = NFY.CMPCOD(+)
					   AND MST.MSTDOCNUM = NFY.MSTDOCNUM(+)
					   AND MST.DUPNUM = NFY.DUPNUM(+)
					   AND MST.SEQNUM = NFY.SEQNUM(+)
					   AND MST.DOCOWRIDR = NFY.DOCOWRIDR(+)
					   AND MST.CMPCOD=?
					   AND MST.MSTDOCNUM=?
					   AND MST.DUPNUM=?
					   AND MST.SEQNUM=?
					   AND MST.DOCOWRIDR=?
	
				]]>
	 </QRY:Source>
</QRY:Definition>

<QRY:Definition>
		<QRY:Id>235</QRY:Id>
		<QRY:Source Name="operations.shipment.findConsignmentAMSDetails" Type="NATIVE">
			<![CDATA[
					SELECT DISTINCT
					SEGSHP.CMPCOD,  SEGSHP.FLTCARIDR,
					SEGSHP.FLTNUM, SEGSHP.FLTSEQNUM, SEGSHP.SEGSERNUM,
					OPRMST.FLTDAT AS FLTDAT, OPRMST.FLTROU,
					ARLMST.TWOAPHCOD, ARLMST.THRAPHCOD, ARLMST.APHCODUSE,
					SEGSHP.MFTPCS, SEGSHP.MFTWGT, SHPMST.SHPPFX, SHPMST.ORGCOD, SHPMST.DSTCOD,SEGSHP.SLCPCS
					FROM OPRSEGSHP SEGSHP INNER JOIN FLTOPRMST OPRMST ON
					SEGSHP.CMPCOD = OPRMST.CMPCOD
					AND SEGSHP.FLTCARIDR = OPRMST.FLTCARIDR
					AND SEGSHP.FLTNUM = OPRMST.FLTNUM
					AND SEGSHP.FLTSEQNUM = OPRMST.FLTSEQNUM
					INNER JOIN FLTOPRSEG FLTSEG ON FLTSEG.CMPCOD = OPRMST.CMPCOD
					AND FLTSEG.FLTCARIDR = OPRMST.FLTCARIDR
					AND FLTSEG.FLTNUM = OPRMST.FLTNUM
			 		AND FLTSEG.FLTSEQNUM = OPRMST.FLTSEQNUM
					INNER JOIN OPRSHPMST SHPMST ON
					SEGSHP.CMPCOD = SHPMST.CMPCOD
					AND SEGSHP.DOCOWRIDR = SHPMST.DOCOWRIDR
					AND SEGSHP.MSTDOCNUM = SHPMST.MSTDOCNUM
					AND SEGSHP.DUPNUM = SHPMST.DUPNUM
					AND SEGSHP.SEQNUM = SHPMST.SEQNUM
					
					INNER JOIN SHRARLMST ARLMST ON
					SEGSHP.CMPCOD = ARLMST.CMPCOD
					AND SEGSHP.FLTCARIDR = ARLMST.ARLIDR
					  WHERE SEGSHP.CMPCOD =?
						AND SEGSHP.DOCOWRIDR = ?
						AND SEGSHP.MSTDOCNUM = ?
						AND SEGSHP.DUPNUM = ?
						AND SEGSHP.SEQNUM = ?
					]]>
		</QRY:Source>
	</QRY:Definition>	
	<QRY:Definition>
		<QRY:Id>236</QRY:Id>
		<QRY:Source Name="operations.shipment.findConsignmentAMSTransferDetails" Type="NATIVE">
			<![CDATA[
					SELECT DISTINCT SEGSHP.CMPCOD,
					  SEGSHP.FLTCARIDR,
					  SEGSHP.FLTNUM,
					  SEGSHP.FLTSEQNUM,
					  SEGSHP.DOCOWRIDR,
					  SHPMST.MSTDOCNUM,
					  SHPMST.DUPNUM,
					  SHPMST.SEQNUM,
					  SHPMST.DOCNUM,
					  OPRMST.FLTCARIDR || '~' || OPRMST.FLTNUM || '~' || OPRMST.FLTSEQNUM AS FLTREFIDN,
					  SHPAMS.DMSINTIDR,
					  SHPAMS.PERPCDARP,
					  SHPAMS.FRMCOD,
					  SHPAMS.INBTRFREFNUM,
					  SHPAMS.BNDPRMIDR,
					  
					  SHPAMS.BNDCARIDR,
					  SHPAMS.ONWCAR,
					  SHPAMS.DATARRPERPCDARP,
					  SHPAMS.DSTARP,
					  SHPAMS.AMDCOD,
					  SHPAMS.AMDRMK,
					  SHPAMS.FDA,
					  COALESCE(SHPAMS.PRTINDREF,   AMSSHP.PRTINDREF,   -1) PRTINDREF
					FROM OPRSEGSHP SEGSHP
					INNER JOIN FLTOPRMST OPRMST ON SEGSHP.CMPCOD = OPRMST.CMPCOD
					 AND SEGSHP.FLTCARIDR = OPRMST.FLTCARIDR
					 AND SEGSHP.FLTNUM = OPRMST.FLTNUM
					 AND SEGSHP.FLTSEQNUM = OPRMST.FLTSEQNUM
					 INNER JOIN FLTOPRSEG FLTSEG ON FLTSEG.CMPCOD = OPRMST.CMPCOD
					 AND FLTSEG.FLTCARIDR = OPRMST.FLTCARIDR
					 AND FLTSEG.FLTNUM = OPRMST.FLTNUM
			 		 AND FLTSEG.FLTSEQNUM = OPRMST.FLTSEQNUM
					 INNER JOIN OPRSHPMST SHPMST ON SEGSHP.CMPCOD = SHPMST.CMPCOD
					 AND SEGSHP.DOCOWRIDR = SHPMST.DOCOWRIDR
					 AND SEGSHP.MSTDOCNUM = SHPMST.MSTDOCNUM
					 AND SEGSHP.DUPNUM = SHPMST.DUPNUM
					 AND SEGSHP.SEQNUM = SHPMST.SEQNUM
					
					LEFT OUTER JOIN OPRSHPAMSDTL SHPAMS ON SHPMST.CMPCOD = SHPAMS.CMPCOD
					 AND SHPMST.DOCOWRIDR = SHPAMS.DOCOWRIDR
					 AND SHPMST.MSTDOCNUM = SHPAMS.MSTDOCNUM
					 AND SHPMST.DUPNUM = SHPAMS.DUPNUM
					 AND SHPMST.SEQNUM = SHPAMS.SEQNUM
					 AND OPRMST.FLTCARIDR = SHPAMS.FLTCARIDR
					 AND OPRMST.FLTNUM = SHPAMS.FLTNUM
					 AND OPRMST.FLTSEQNUM = SHPAMS.FLTSEQNUM LEFT
					OUTER JOIN CSTARPSHP CSTSHP ON SHPMST.CMPCOD = CSTSHP.CMPCOD
					 AND SHPMST.DOCOWRIDR = CSTSHP.DOCOWRIDR
					 AND SHPMST.MSTDOCNUM = CSTSHP.MSTDOCNUM
					 AND SHPMST.DUPNUM = CSTSHP.DUPNUM
					 AND SHPMST.SEQNUM = CSTSHP.SEQNUM LEFT
					OUTER JOIN CSTAMSARPSHP AMSSHP ON CSTSHP.CMPCOD = AMSSHP.CMPCOD
					 AND CSTSHP.DOCOWRIDR = AMSSHP.DOCOWRIDR
					 AND CSTSHP.MSTDOCNUM = AMSSHP.MSTDOCNUM
					 AND CSTSHP.DUPNUM = AMSSHP.DUPNUM
					 AND CSTSHP.SEQNUM = AMSSHP.SEQNUM
					 AND CSTSHP.ARPCOD = AMSSHP.ARPCOD
					 AND CSTSHP.PRTNUM = AMSSHP.PRTNUM
 					AND OPRMST.FLTCARIDR || '~' || OPRMST.FLTNUM || '~' || OPRMST.FLTSEQNUM = CSTSHP.FLTREFIDN
					WHERE SEGSHP.CMPCOD = ?
						AND SEGSHP.FLTCARIDR = ?
						AND SEGSHP.FLTNUM = ?
						AND SEGSHP.FLTSEQNUM = ?
						AND SEGSHP.DOCOWRIDR = ?
						AND SEGSHP.DUPNUM = ?
						AND SEGSHP.SEQNUM = ?
						AND SEGSHP.MSTDOCNUM = ?
						AND COALESCE(SHPAMS.PRTINDREF,   AMSSHP.PRTINDREF,   -1) > -1
					]]>

		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>237</QRY:Id>
		<QRY:Source Name="operations.shipment.findConsignmentAMSHouseDetails" Type="NATIVE">
						<![CDATA[
					SELECT DISTINCT TXNHSE.CMPCOD,
				  	TXNHSE.TXNREFONE,
					  TXNHSE.TXNREFTWO,
					  TXNHSE.TXNREFTHR,
					  TXNHSE.SERNUM,
					  TXNHSE.PCS AS MFTPCS,
					  TXNHSE.WGT AS MFTWGT,
					  TXNHSE.TXNREFSIX,
					  TXNHSE.TXNREFNIN,
					  OPRMST.FLTDAT AS
					FLTDAT,
					  TXNHSE.DOCNUM,
					  OPRMST.FLTROU,
					  ARLMST.TWOAPHCOD,
					  ARLMST.THRAPHCOD,
					  ARLMST.APHCODUSE,
					  SHPMST.SHPPFX,
					  SHPMST.ORGCOD,
					  SHPMST.DSTCOD
					FROM OPRTXNHSE TXNHSE
					INNER JOIN FLTOPRMST OPRMST ON TXNHSE.CMPCOD = OPRMST.CMPCOD
					 AND TXNHSE.TXNREFTWO = OPRMST.FLTCARIDR
					 AND TXNHSE.TXNREFTHR = OPRMST.FLTNUM
					 AND TXNHSE.TXNREFFIV = OPRMST.FLTSEQNUM
					 INNER JOIN FLTOPRSEG FLTSEG ON FLTSEG.CMPCOD = OPRMST.CMPCOD
					 AND FLTSEG.FLTCARIDR = OPRMST.FLTCARIDR
					 AND FLTSEG.FLTNUM = OPRMST.FLTNUM
			 		 AND FLTSEG.FLTSEQNUM = OPRMST.FLTSEQNUM
					INNER JOIN OPRSHPMST SHPMST ON TXNHSE.CMPCOD = SHPMST.CMPCOD
					 AND TXNHSE.DOCOWRIDR = SHPMST.DOCOWRIDR
					 AND TXNHSE.MSTDOCNUM = SHPMST.MSTDOCNUM
					 AND TXNHSE.DUPNUM = SHPMST.DUPNUM
					 AND TXNHSE.SEQNUM = SHPMST.SEQNUM
					 
					INNER JOIN SHRARLMST ARLMST ON TXNHSE.CMPCOD = ARLMST.CMPCOD
					 AND TXNHSE.TXNREFTWO = ARLMST.ARLIDR
					WHERE TXNHSE.CMPCOD = ?
					 AND TXNHSE.DOCOWRIDR = ?
					 AND TXNHSE.MSTDOCNUM = ?
					 AND TXNHSE.DUPNUM = ?
					 AND TXNHSE.SEQNUM = ?
					 AND TXNHSE.TXNCOD = ?
					ORDER BY TXNREFTWO,
					  FLTDAT
					]]>
			
		</QRY:Source>
	</QRY:Definition>		
 <QRY:Definition>
	 	<QRY:Id>240</QRY:Id>
	 	<QRY:Source Name="operations.shipment.shipmentsforctm" Type="NATIVE">
			<![CDATA[
					SELECT MST.SHPPFX,MST.MSTDOCNUM,MST.DOCNUM,MST.OWRCOD,MST.DUPNUM,MST.SEQNUM,
					   MST.STDWGTCOD STDWGTCOD,MST.STDWGT STDWGT,MST.GRSVOLUNT STDVOLUNT,MST.GRSVOL STDVOL,
					   MST.STDPCS STDPCS,MST.ORGCOD ORGCOD,MST.SHPDES SHPDCL,MST.SCCCOD SCCCOD,MST.DSTCOD DSTCOD,
					   MST.STDDISWGT DISSTDWGT,MST.GRSDISVOL DISSTDVOL,MST.CONFLG,MST.DOCOWRIDR,MST.PLTFLG,
					   ARLSHP.AVLPCS,ARLSHP.AVLWGT,DTL.PLTUSEFLG,
					   SHPRTG.DSTCOD RTGDSTCOD,
				       SHPRTG.FLTCARCOD, SHPRTG.RTESEQNUM,SEGSHP.RCVPCS, SEGSHP.RCVWGT, SEGSHP.RCVVOL,SEGSHP.FLTNUM,
				       ARLMST.FULDATCAP,MST.EXEFLG
					  FROM OPRARPARLSHP ARLSHP,
						   OPRSHPRTG SHPRTG,
						  OPRSHPMST MST,
					      OPRARPSHP ARPSHP,
						  OPRSHPDTL DTL,
						  OPRARPEXPFLT EXPFLT,
						  OPRFLTSEG FLTSEG,
						  OPRSEGSHP SEGSHP,
						  SHRARLMST ARLMST
					 WHERE ARLSHP.CMPCOD = SHPRTG.CMPCOD
					   AND ARLSHP.MSTDOCNUM = SHPRTG.MSTDOCNUM
					   AND ARLSHP.DOCOWRIDR = SHPRTG.DOCOWRIDR
					   AND ARLSHP.DUPNUM = SHPRTG.DUPNUM
					   AND ARLSHP.SEQNUM = SHPRTG.SEQNUM

					   AND ARLSHP.CMPCOD = MST.CMPCOD
					   AND ARLSHP.MSTDOCNUM = MST.MSTDOCNUM
					   AND ARLSHP.DOCOWRIDR = MST.DOCOWRIDR
					   AND ARLSHP.DUPNUM = MST.DUPNUM
					   AND ARLSHP.SEQNUM = MST.SEQNUM

					   AND ARLSHP.CMPCOD = ARPSHP.CMPCOD
					   AND ARLSHP.MSTDOCNUM = ARPSHP.MSTDOCNUM
					   AND ARLSHP.DOCOWRIDR = ARPSHP.DOCOWRIDR
					   AND ARLSHP.DUPNUM = ARPSHP.DUPNUM
					   AND ARLSHP.SEQNUM = ARPSHP.SEQNUM
					   AND ARLSHP.ARPCOD = ARPSHP.ARPCOD

				   AND ARLSHP.CMPCOD = DTL.CMPCOD(+)
					   AND ARLSHP.MSTDOCNUM = DTL.MSTDOCNUM(+)
					   AND ARLSHP.DOCOWRIDR = DTL.DOCOWRIDR(+)
					   AND ARLSHP.DUPNUM = DTL.DUPNUM(+)
					   AND ARLSHP.SEQNUM = DTL.SEQNUM(+)

					   AND ARPSHP.CMPCOD = SEGSHP.CMPCOD(+)
					   AND ARPSHP.MSTDOCNUM = SEGSHP.MSTDOCNUM(+)
					   AND ARPSHP.DOCOWRIDR = SEGSHP.DOCOWRIDR(+)
					   AND ARPSHP.DUPNUM = SEGSHP.DUPNUM(+)
					   AND ARPSHP.SEQNUM = SEGSHP.SEQNUM(+)


					   AND SEGSHP.FLTNUM = FLTSEG.FLTNUM(+)
					   AND SEGSHP.FLTSEQNUM = FLTSEG.FLTSEQNUM(+)
					   AND SEGSHP.SEGSERNUM = FLTSEG.SEGSERNUM(+)
					   AND SEGSHP.FLTCARIDR = FLTSEG.FLTCARIDR(+)

					   AND FLTSEG.CMPCOD = EXPFLT.CMPCOD(+)
					   AND FLTSEG.FLTCARIDR = EXPFLT.FLTCARIDR(+)
					   AND FLTSEG.FLTSEQNUM = EXPFLT.FLTSEQNUM(+)
					   AND FLTSEG.FLTNUM = EXPFLT.FLTNUM(+)
					   AND FLTSEG.POL=EXPFLT.ARPCOD(+)
					   AND ARLMST.CMPCOD = MST.CMPCOD
					   AND ARLMST.ARLIDR = MST.DOCOWRIDR

					   AND ARLSHP.AVLPCS > 0
					   AND ARLSHP.CMPCOD = ?
					   AND ARLSHP.ARPCOD = ?
					   AND ARLSHP.OWNCARCOD = ?
					   AND SHPRTG.FLTCARCOD = ?
					   AND SHPRTG.RTESEQNUM =
						       NVL ((SELECT RTG.RTESEQNUM + 1
								   FROM OPRSHPRTG RTG
								  WHERE ARLSHP.MSTDOCNUM =
										RTG.MSTDOCNUM
								      AND ARLSHP.DOCOWRIDR =
										RTG.DOCOWRIDR
								      AND ARLSHP.DUPNUM  =
										RTG.DUPNUM
								      AND ARLSHP.SEQNUM =
										RTG.SEQNUM
								      AND ARLSHP.CMPCOD =
										RTG.CMPCOD
								      AND ARLSHP.ARPCOD =
										RTG.DSTCOD
								AND ARLSHP.CMPCOD = ARPSHP.CMPCOD
					   			AND ARLSHP.MSTDOCNUM = ARPSHP.MSTDOCNUM
			     				        AND ARLSHP.DOCOWRIDR = ARPSHP.DOCOWRIDR
					                        AND ARLSHP.DUPNUM = ARPSHP.DUPNUM
					                        AND ARLSHP.SEQNUM = ARPSHP.SEQNUM
					                        AND ARLSHP.ARPCOD = ARPSHP.ARPCOD										
										), 1 )

			]]>
	 	</QRY:Source>
	</QRY:Definition>
<QRY:Definition>
	<QRY:Id>234</QRY:Id>
	<QRY:Source Name="operations.shipment.cto.findFsuDetailsForManifest" Type="NATIVE">
		<![CDATA[
			
			SELECT MST.MSTDOCNUM, MST.DOCOWRIDR, MST.DUPNUM,
			       MST.SEQNUM, MST.CMPCOD, MST.SHPPFX,
			       MST.STDPCS, MST.STDWGT, MST.ORGCOD,
			       MST.DSTCOD, EXPFLT.FLTNUM, EXPFLT.FLTDAT,
			       EXPFLT.FLTCARCOD, ARP.ARPCOD, ARP.MFTPCS,
			       ARP.MFTWGT, SYS.PARVAL WGTCOD,
			       ARL.TWOAPHCOD CARRCOD, LEG.STA, LEG.ATA,
			       LEG.STD, LEG.ATD, LEG.LEGDST, LEG.LEGORG
			  FROM OPRSHPMST MST,
			       OPRARPSHP ARP,
			       OPRARPEXPFLT EXPFLT,
			       OPRFLTSEG FLTSEG,
			       OPRSEGSHP SEGSHP,
			       FLTOPRLEG LEG,
			       SHRSYSPAR SYS,
			       SHRARLMST ARL
			 WHERE EXPFLT.CMPCOD = LEG.CMPCOD
			   AND EXPFLT.ARPCOD = ARP.ARPCOD
			   AND EXPFLT.FLTCARIDR = LEG.FLTCARIDR
			   AND EXPFLT.FLTNUM = LEG.FLTNUM
			   AND EXPFLT.FLTSEQNUM = LEG.FLTSEQNUM
			   AND EXPFLT.LEGSERNUM = LEG.LEGSERNUM
			   AND EXPFLT.ARPCOD = LEG.LEGORG
			   AND EXPFLT.CMPCOD = FLTSEG.CMPCOD
			   AND EXPFLT.FLTCARIDR = FLTSEG.FLTCARIDR
			   AND EXPFLT.FLTNUM = FLTSEG.FLTNUM
			   AND EXPFLT.FLTSEQNUM = FLTSEG.FLTSEQNUM
			   AND EXPFLT.ARPCOD = FLTSEG.POL
			   AND FLTSEG.CMPCOD = SEGSHP.CMPCOD
			   AND FLTSEG.FLTCARIDR = SEGSHP.FLTCARIDR
			   AND FLTSEG.FLTNUM = SEGSHP.FLTNUM
			   AND FLTSEG.FLTSEQNUM = SEGSHP.FLTSEQNUM
			   AND FLTSEG.SEGSERNUM = SEGSHP.SEGSERNUM
			   AND SEGSHP.CMPCOD = MST.CMPCOD
			   AND SEGSHP.DOCOWRIDR = MST.DOCOWRIDR
			   AND SEGSHP.MSTDOCNUM = MST.MSTDOCNUM
			   AND SEGSHP.DUPNUM = MST.DUPNUM
			   AND SEGSHP.SEQNUM = MST.SEQNUM
			   AND MST.CMPCOD = ARP.CMPCOD
			   AND MST.MSTDOCNUM = ARP.MSTDOCNUM
			   AND MST.DOCOWRIDR = ARP.DOCOWRIDR
			   AND MST.DUPNUM = ARP.DUPNUM
			   AND MST.SEQNUM = ARP.SEQNUM
			   AND MST.CMPCOD = SYS.CMPCOD
			   AND MST.CMPCOD = ARL.CMPCOD
			   AND MST.DOCOWRIDR = ARL.ARLIDR
			   AND MST.CMPCOD = ?
			   AND ARP.ARPCOD = ?
			   AND EXPFLT.FLTCARIDR = ?
			   AND EXPFLT.FLTNUM = ?
			   AND EXPFLT.FLTSEQNUM = ?
			   AND EXPFLT.LEGSERNUM = ?
			   AND SYS.PARCOD = ?
			   
		]]>
	</QRY:Source>
	</QRY:Definition>

<QRY:Definition>
	<QRY:Id>234</QRY:Id>
	<QRY:Source Name="operations.shipment.networkperformancereport" Type="NATIVE">
		<![CDATA[
	 	   
			   SELECT AGTMST.AGTCOD,
		   AGTMST.STNCOD,
		   RATDTL.NUMPCS,
		   RATDTL.CHGWGT,
		   RATDTL.NETCHG,
		   ACCMST.SRVCRGCLS
		   FROM OPRSHPMST SHPMST,
			   OPRSHPMSTACC ACCMST,
			   OPRSHPRATDTL RATDTL,
			   SHRAGTMST AGTMST,
			    SHRCUSMST CUSMST
		   WHERE SHPMST.CMPCOD = RATDTL.CMPCOD
			  AND SHPMST.DOCOWRIDR = RATDTL.DOCOWRIDR
			  AND SHPMST.MSTDOCNUM = RATDTL.MSTDOCNUM
			  AND SHPMST.DUPNUM = RATDTL.DUPNUM
			  AND SHPMST.SEQNUM = RATDTL.SEQNUM
			  AND SHPMST.CMPCOD = ACCMST.CMPCOD
			  AND SHPMST.DOCOWRIDR = ACCMST.DOCOWRIDR
			  AND SHPMST.MSTDOCNUM = ACCMST.MSTDOCNUM
			  AND SHPMST.DUPNUM = ACCMST.DUPNUM
			  AND SHPMST.SEQNUM = ACCMST.SEQNUM
			  AND AGTMST.CMPCOD = SHPMST.CMPCOD
			  AND AGTMST.AGTCOD = SHPMST.AGTCOD
			  AND AGTMST.CMPCOD = CUSMST.CMPCOD(+)
			  AND AGTMST.CUSCOD = CUSMST.CUSCOD(+)
			  AND SHPMST.CMPCOD = ?
			  AND SHPMST.EXEDAT >= ?
			  AND SHPMST.EXEDAT <= ?
			  AND (ACCMST.SRVCRGCLS <> ? OR ACCMST.SRVCRGCLS IS NULL)
			  AND EXISTS
			   (SELECT SEGSHP.MSTDOCNUM
			    FROM OPRARPEXPFLT EXPFLT, OPRFLTSEG FLTSEG, OPRSEGSHP SEGSHP
			    WHERE EXPFLT.CMPCOD = FLTSEG.CMPCOD
			    AND EXPFLT.FLTCARIDR = FLTSEG.FLTCARIDR
			    AND EXPFLT.FLTNUM = FLTSEG.FLTNUM
			    AND EXPFLT.FLTSEQNUM = FLTSEG.FLTSEQNUM   
			    AND FLTSEG.CMPCOD = SEGSHP.CMPCOD
			    AND FLTSEG.FLTCARIDR = SEGSHP.FLTCARIDR
			    AND FLTSEG.FLTNUM = SEGSHP.FLTNUM
			    AND FLTSEG.FLTSEQNUM = SEGSHP.FLTSEQNUM
			    AND SEGSHP.CMPCOD = SHPMST.CMPCOD  
			    AND SEGSHP.DOCOWRIDR = SHPMST.DOCOWRIDR  
			    AND SEGSHP.DUPNUM = SHPMST.DUPNUM  
			    AND SEGSHP.SEQNUM = SHPMST.SEQNUM  
			    AND SEGSHP.MSTDOCNUM = SHPMST.MSTDOCNUM
			    AND SEGSHP.MFTPCS > 0
			    AND (EXPFLT.FINFLG = 'F' OR EXPFLT.FINFLG = 'R'))    
		]]>
	</QRY:Source>
	</QRY:Definition>
	
	 

<QRY:Definition>
	<QRY:Id>235</QRY:Id>
	<QRY:Source Name="operations.shipment.findshipmentdetailsforfwb" Type="NATIVE">
	<![CDATA[
			SELECT MST.DOCNUM,
			  MST.SEQNUM,
			  MST.DUPNUM,
			  MST.CMPCOD,
			  MST.DOCOWRIDR,
			  FLTBOK.CARCOD FLTBOKCARCOD,
			  FLTBOK.FLTNUM FLTBOKFLTNUM,
			  FLTBOK.FLTDAT FLTBOKFLTDAT,
			  FLTBOK.SERNUM FLTBOKSERNUM,
			  SHPCNT.SERNUM SHPCNTSERNUM,
			  SHPCNT.CNTIDR SHPCNTCNTIDR,
			  SHPCNT.CNTTYP SHPCNTCNTTYP,
			  SHPCNT.CNTVAL SHPCNTCNTVAL,
			  SSR.SPLSRVREQ SSRSPLSRVREQ,
			  ACCDTL.ACCINF ACCDTLACCINF,
			  ACCDTL.ACCINFIDR ACCDTLACCINFIDR,
		      ACCDTL.SERNUM ACCDTLSERNUM,
			  OTHSRV.OTHSRVINF OTHSRVOTHSRVINF,
			  MSTMIS.SHPSIG MSTMISSHPSIG,
			  MSTMIS.SNDCTY MSTMISSNDCTY,
			  MSTMIS.SNDDSG MSTMISSNDDSG,
			  MSTMIS.SNDCMPDSG MSTMISSNDCMPDSG,
			  MSTMIS.SNDFILREF MSTMISSNDFILREF,
			  MSTMIS.PPTIDR MSTMISPPTIDR,
			  MSTMIS.PPTCOD MSTMISPPTCOD,
			  MSTMIS.PPTCTY MSTMISPPTCTY,
			  MSTMIS.SCICOD MSTMISSCICOD,
			  MSTMIS.AGTREF MSTMISAGTREF,
			  MSTMIS.NOMHDLPTYPLC MSTMISNOMHDLPTYPLC,
			  MSTMIS.NOMHDLPTY MSTMISNOMHDLPTY,
			  SHPMSTCNT.SHPREFNUM SHPMSTCNTSHPREFNUM,
			  MSTMIS.SHPINFONE MSTMISSHPINFONE,
			  MSTMIS.SHPINFTWO MSTMISSHPINFTWO,
		      MSTMIS.SHPDESCOD SHPDESCOD,
			  MSTMIS.CHGCOD MSTMISCHGCOD,
		      MSTMIS.OTHPCIND OTHPCIND,
		      MSTMIS.COLCHRIDN COLCHRIDN,
			  MSTMIS.PPDCHRIDN PPDCHRIDN,
		      MSTMIS.MIPWGTCOD MIPWGTCOD,
			  MSTMIS.MIPSENFILREF MIPSENFILREF,
			  MSTACC.DSTCNVRAT MSTACCDSTCNVRAT,
			  MSTACC.DSTCCFCHG MSTACCDSTCCFCHG,
			  MSTACC.TOTDSTCCFCHG MSTACCTOTDSTCCFCHG,
			  MSTACC.DSTCHG MSTACCDSTCHG,
			  MSTACC.DSTCURCOD MSTACCDSTCURCOD,
			  MSTACC.CMSAMT MSTACCCMSAMT,
			  MSTACC.CMSPCT MSTACCCMSPCT,
			  MSTACC.CMSCASIND MSTACCCMSCASIND,
			  MSTACC.SALINCAMT MSTACCSALINCAMT,
		      MSTACC.SALINCCASIND MSTACCSALINCCASIND,
			  MSTACC.AGTACCNUM MSTACCAGTACCNUM,
			  MSTACC.MIPDESCURCOD MIPDESCURCOD,
			  OTHPPT.SERNUM OTHPPTSERNUM,
			  OTHPPT.PPTNAM OTHPPTPPTNAM,
			  OTHPPT.OFFCTY OTHPPTOFFCTY,
			  OTHPPT.OFFDSG OTHPPTOFFDSG,
			  OTHPPT.CMPDSG OTHPPTCMPDSG,
			  OTHPPT.OFFFILREF OTHPPTOFFFILREF,
			  OTHPPT.PPTIDR OTHPPTPPTIDR,
			  OTHPPT.PPTCOD OTHPPTPPTCOD,
			  OTHPPT.PPTCTY OTHPPTPPTCTY,
			  CUSDTL.SERNUM SERNUM,
			  CUSDTL.CNTCOD CUSCTYCOD,
			  CUSDTL.INFIDF INFIDN,
			  CUSDTL.CUSINF CUSINF,
			  CUSDTL.CUSINFIDF CUSINFIDN 
			FROM OPRSHPMST MST,
			  OPRSHPFLTBOK FLTBOK,
			  OPRSHPCNT SHPCNT,
			  OPRSHPMSTCNT SHPMSTCNT,
			  OPRSHPSPLSRVREQ SSR,
			  OPRSHPACCDTL ACCDTL,
			  OPRSHPOTHSRV OTHSRV,
			  OPRSHPMSTMIS MSTMIS,
			  OPRSHPMSTACC MSTACC,
			  OPRSHPOTHPPT OTHPPT,
			  OPRSHPOCI CUSDTL 
			WHERE MST.CMPCOD = FLTBOK.CMPCOD(+)
			 AND MST.DOCOWRIDR = FLTBOK.DOCOWRIDR(+)
			 AND MST.MSTDOCNUM = FLTBOK.MSTDOCNUM(+)
			 AND MST.DUPNUM = FLTBOK.DUPNUM(+)
			 AND MST.SEQNUM = FLTBOK.SEQNUM(+)
			 AND MST.CMPCOD = SHPCNT.CMPCOD(+)
			 AND MST.DOCOWRIDR = SHPCNT.DOCOWRIDR(+)
			 AND MST.MSTDOCNUM = SHPCNT.MSTDOCNUM(+)
			 AND MST.DUPNUM = SHPCNT.DUPNUM(+)
			 AND MST.SEQNUM = SHPCNT.SEQNUM(+)
			 AND MST.CMPCOD = SHPMSTCNT.CMPCOD(+)
			 AND MST.DOCOWRIDR = SHPMSTCNT.DOCOWRIDR(+)
			 AND MST.MSTDOCNUM = SHPMSTCNT.MSTDOCNUM(+)
			 AND MST.DUPNUM = SHPMSTCNT.DUPNUM(+)
			 AND MST.SEQNUM = SHPMSTCNT.SEQNUM(+)
			 AND MST.CMPCOD = SSR.CMPCOD(+)
			 AND MST.DOCOWRIDR = SSR.DOCOWRIDR(+)
			 AND MST.MSTDOCNUM = SSR.MSTDOCNUM(+)
			 AND MST.DUPNUM = SSR.DUPNUM(+)
			 AND MST.SEQNUM = SSR.SEQNUM(+)
			 AND MST.CMPCOD = ACCDTL.CMPCOD(+)
			 AND MST.DOCOWRIDR = ACCDTL.DOCOWRIDR(+)
			 AND MST.MSTDOCNUM = ACCDTL.MSTDOCNUM(+)
			 AND MST.DUPNUM = ACCDTL.DUPNUM(+)
			 AND MST.SEQNUM = ACCDTL.SEQNUM(+)
			 AND MST.CMPCOD = OTHSRV.CMPCOD(+)
			 AND MST.DOCOWRIDR = OTHSRV.DOCOWRIDR(+)
			 AND MST.MSTDOCNUM = OTHSRV.MSTDOCNUM(+)
			 AND MST.DUPNUM = OTHSRV.DUPNUM(+)
			 AND MST.SEQNUM = OTHSRV.SEQNUM(+)
			 AND MST.CMPCOD = MSTMIS.CMPCOD(+)
			 AND MST.DOCOWRIDR = MSTMIS.DOCOWRIDR(+)
			 AND MST.MSTDOCNUM = MSTMIS.MSTDOCNUM(+)
			 AND MST.DUPNUM = MSTMIS.DUPNUM(+)
			 AND MST.SEQNUM = MSTMIS.SEQNUM(+)
			 AND MST.CMPCOD = MSTACC.CMPCOD(+)
			 AND MST.DOCOWRIDR = MSTACC.DOCOWRIDR(+)
			 AND MST.MSTDOCNUM = MSTACC.MSTDOCNUM(+)
			 AND MST.DUPNUM = MSTACC.DUPNUM(+)
			 AND MST.SEQNUM = MSTACC.SEQNUM(+)
			 AND MST.CMPCOD = OTHPPT.CMPCOD(+)
			 AND MST.DOCOWRIDR = OTHPPT.DOCOWRIDR(+)
			 AND MST.MSTDOCNUM = OTHPPT.MSTDOCNUM(+)
			 AND MST.DUPNUM = OTHPPT.DUPNUM(+)
			 AND MST.SEQNUM = OTHPPT.SEQNUM(+)
			 AND MST.CMPCOD = CUSDTL.CMPCOD(+)
			 AND MST.DOCOWRIDR = CUSDTL.DOCOWRIDR(+)
			 AND MST.MSTDOCNUM = CUSDTL.MSTDOCNUM(+)
			 AND MST.DUPNUM = CUSDTL.DUPNUM(+)
			 AND MST.SEQNUM = CUSDTL.SEQNUM(+)
			 AND MST.CMPCOD = ?
			 AND MST.DOCOWRIDR = ?
			 AND MST.MSTDOCNUM = ?
			 AND MST.DUPNUM = ?
			 AND MST.SEQNUM = ?
		]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
		<QRY:Id>244</QRY:Id>
		<QRY:Source Name="operations.shipment.findHAWBContactDetails" Type="NATIVE">
		<![CDATA[
			SELECT MST.MSTDOCNUM, MST.CMPCOD MSTCMPCOD,
			MST.DOCOWRIDR MSTDOCOWRIDR,MST.DUPNUM MSTDUPNUM, MST.SEQNUM MSTSEQNUM,
			MST.DOCNUM, MST.PLTFLG,MST.SHPBNDFLG, MST.DOCTYP, MST.PARSEQNUM,
			MST.RFCFLG, MST.CRAIMPFLG,MST.SHPPFX,MST.SHPSTA, MST.SHPTYP, MST.UBRNUM,
			MST.CONFLG, MST.DOCOWRIDR,MST.SHPCOD,MST.SHPNAM,MST.SHPADRONE, CNT.SHPADRTWO, 
			CNT.SHPCTR, CNT.SHPCTY, CNT.SHPMALIDR,CNT.SHPPSTCOD, MST.SHPSTA,
			MST.ORGCOD MSTORGCOD,MST.DSTCOD MSTDSTCOD,
			CNT.SHPSTT, CNT.SHPTELNUM, MST.CNSADRONE,MST.CNSNAM,CNT.CNSACCNUM, 
			CNT.CNSADRTWO, MST.CNSCOD, CNT.CNSCTR,CNT.CNSCTY, CNT.CNSMALIDR, 
			CNT.CNSPRTNFNFLG, CNT.CNSPSTCOD,CNT.CNSSTT, CNT.CNSTELNUM,
			NFY.DOCOWRIDR NFYDOCOWRIDR,
			NFY.MSTDOCNUM NFYMSTDOCNUM,NFY.DUPNUM NFYDUPNUM, NFY.SEQNUM NFYSEQNUM,
			NFY.NFYCOD NFYNFYCOD, NFY.NFYNAM NFYNFYNAM,
			NFY.NFYTELNUM NFYNFYTELNUM,NFY.NFYMALIDR NFYNFYMALIDR,
			NFY.NFYADRONE NFYNFYADRONE,NFY.NFYADRTWO NFYNFYADRTWO,
			NFY.NFYCTY NFYNFYCTY, NFY.NFYSTT NFYNFYSTT,
			NFY.NFYCTR NFYNFYCTR,NFY.NFYPSTCOD NFYNFYPSTCOD,
			NFY.PRTNFNFLG NFYPRTNFNFLG,NFY.NFYMOD NFYNFYMOD,
			NFY.NFYTELNUM NFYNFYTELNUM,NFY.NFYCTY NFYNFYCTY,
			NFY.NFYACCNUM NFYNFYACCNUM,NFY.PCTTYP NFYPCTTYP,NFY.CMPCOD NFYCMPCOD,
			FLT.FLTDAT FLTFLTDAT, FLT.DUPNUM FLTDUPNUM,
		    FLT.SEGSERNUM FLTSEGSERNUM,
		    FLT.FLTNUM FLTFLTNUM,
		    FLT.DOCOWRIDR FLTDOCOWRIDR,
		    FLT.SEQNUM FLTSEQNUM,
		    FLT.FLTCARIDR FLTFLTCARIDR,
		    FLT.RTGSERNUM FLTRTGSERNUM,
		    FLT.RTESEQNUM FLTRTESEQNUM,
		    FLT.FLTSEQNUM FLTFLTSEQNUM,
		    FLT.MSTDOCNUM FLTMSTDOCNUM,
		    FLT.DSTCOD RTGDSTCOD,
		    FLT.FLTCARCOD FLTFLTCARCOD,
		    FLT.CMPCOD FLTCMPCOD, FLT.DSTCOD FLTDSTCOD,
			HSE.HSEPTH
			FROM 
			OPRSHPMST MST,
			OPRSHPMSTCNT CNT,
			OPRSHPNFY NFY,
			OPRSHPRTG FLT,
			OPRSHPHSE HSE
			WHERE
			MST.CMPCOD = NFY.CMPCOD(+) AND MST.DOCOWRIDR = NFY.DOCOWRIDR(+) AND MST.MSTDOCNUM = NFY.MSTDOCNUM(+)
			AND MST.DUPNUM = NFY.DUPNUM(+) AND MST.SEQNUM = NFY.SEQNUM(+) 
			AND MST.CMPCOD = CNT.CMPCOD
			AND MST.DOCOWRIDR = CNT.DOCOWRIDR
			AND MST.MSTDOCNUM = CNT.MSTDOCNUM
			AND MST.DUPNUM = CNT.DUPNUM
			AND MST.SEQNUM = CNT.SEQNUM
			AND MST.CMPCOD = FLT.CMPCOD(+)
		    AND MST.DOCOWRIDR = FLT.DOCOWRIDR(+)
		    AND MST.MSTDOCNUM = FLT.MSTDOCNUM(+)
		    AND MST.DUPNUM = FLT.DUPNUM(+)
		    AND MST.SEQNUM = FLT.SEQNUM(+)
            AND MST.DOCOWRIDR = HSE.DOCOWRIDR
			AND MST.MSTDOCNUM = HSE.MSTDOCNUM
			AND MST.DUPNUM = HSE.DUPNUM
			AND MST.SEQNUM = HSE.SEQNUM
			AND MST.CMPCOD = HSE.CMPCOD
			AND MST.CMPCOD = ?
			AND MST.DOCOWRIDR = ?
			AND MST.MSTDOCNUM = ?
			AND MST.DUPNUM = ?
			AND MST.SEQNUM = ?
		]]>
		</QRY:Source>
	</QRY:Definition>
<QRY:Definition>
	 	<QRY:Id>239</QRY:Id>
	 	<QRY:Source Name="operations.shipment.findOtherCharges" Type="NATIVE">
			<![CDATA[
					SELECT MST.MSTDOCNUM, MST.SEQNUM, MST.DOCOWRIDR,
						   MST.DUPNUM, NVL(MST.CURCOD,(SELECT PARVAL
						    FROM SHRSTNPAR
							WHERE CMPCOD = MST.CMPCOD
							AND STNCOD   = MST.ORGCOD
							AND PARCOD  IN ('shared.station.basecurrency' )))CURCOD,
						   MST.PAYTYP MSTPAYTYP, CHG.CHGHEDIDR,
					       CHG.CHGHED, CHG.CHDCOD, CHG.CHGAMT,
					       CHG.PAYTYP, CHG.DUECARFLG, CHG.DUEAGTFLG,
					       CHG.TAXPCT CHGTAXPCT,MST.RFCFLG, CHG.TAX,CHG.MSTDOCNUM CHGMSTDOCNUM,
						   CHG.CHGRMK,CHG.CMPCOD CHGCMPCOD,CHG.CHDGRSAMT CHGCHDGRSAMT,  
						   CHG.PAYMOD CHGPAYMOD,CHG.MNLUPDFLG CHGMNLUPDFLG,CHG.ETYSUBCOD CHGETYSUBCOD,
						   CHG.CUSTYP CHGCUSTYP, CHG.CUSCOD CHGCUSCOD						   
						  FROM OPRSHPCHGDTL CHG, OPRSHPMST MST
				  
					WHERE  MST.MSTDOCNUM = CHG.MSTDOCNUM(+)
						   AND MST.DOCOWRIDR = CHG.DOCOWRIDR(+)
						   AND MST.SEQNUM = CHG.SEQNUM(+)
						   AND MST.DUPNUM = CHG.DUPNUM(+)
						   AND MST.CMPCOD = CHG.CMPCOD(+)
						   AND MST.CMPCOD =?
						   AND MST.MSTDOCNUM =?
						   AND MST.DOCOWRIDR =?
					       AND MST.SEQNUM =?
						   AND MST.DUPNUM =?

			]]>
		 </QRY:Source>
	</QRY:Definition>	
<QRY:Definition>
	<QRY:Id>236</QRY:Id>
		<QRY:Source Name="operations.shipment.findHouseDetailsForMIP" Type="NATIVE">
			<![CDATA[
				
				SELECT SHPMST.CMPCOD,SHPMST.SHPPFX,
  				SHPMST.MSTDOCNUM,
				  SHPMST.DUPNUM,
				  SHPMST.SEQNUM,
				  SHPMST.DOCNUM,
				  SHPMST.ORGCOD,
				  SHPMST.DSTCOD,
				  SHPMST.STDPCS,
				  SHPMST.STDWGT,
				  SHPMST.SHPDES,
				  SHPMST.SLCPCS,
				  SHPMST.STDWGTCOD,				  
				  SHPMST.SHPNAM,
				  SHPMST.SHPADRONE,
				  SHPMST.CNSADRONE,
				  SHPMST.CNSNAM,
				  SHPMST.CURCOD,
				  MSTCNT.CNSADRTWO,
				  MSTCNT.CNSCTY,
				  MSTCNT.CNSSTT,
				  MSTCNT.CNSCTR,
				  MSTCNT.CNSPSTCOD,
				  MSTCNT.SHPADRTWO,
				  MSTCNT.SHPCTY,
				  MSTCNT.SHPSTT,
				  MSTCNT.SHPCTR,
				  MSTCNT.SHPPSTCOD,
				  SHPCNT.CNTIDR,
				  SHPCNT.CNTVAL,
				  SHPMIS.SHPINFONE,
				SHPMIS.SHPDESCOD,
				SHPCNT.CNTTYP,
				SHPMIS.ADLSHPDES
				FROM OPRSHPMST SHPMST,
				  OPRSHPMSTCNT MSTCNT,
				  OPRSHPCNT SHPCNT,
				OPRSHPMSTMIS SHPMIS
				WHERE SHPMST.CMPCOD = SHPCNT.CMPCOD(+)
				 AND SHPMST.DOCOWRIDR = SHPCNT.DOCOWRIDR(+)
				 AND SHPMST.MSTDOCNUM = SHPCNT.MSTDOCNUM(+)
				 AND SHPMST.DUPNUM = SHPCNT.DUPNUM(+)
				 AND SHPMST.SEQNUM = SHPCNT.SEQNUM(+)
				
				 AND SHPMST.CMPCOD = MSTCNT.CMPCOD(+)
				 AND SHPMST.DOCOWRIDR = MSTCNT.DOCOWRIDR(+)
				 AND SHPMST.MSTDOCNUM = MSTCNT.MSTDOCNUM(+)
				 AND SHPMST.DUPNUM = MSTCNT.DUPNUM(+)
				 AND SHPMST.SEQNUM = MSTCNT.SEQNUM(+)
				
				 AND SHPMST.CMPCOD = SHPMIS.CMPCOD(+)
				 AND SHPMST.DOCOWRIDR = SHPMIS.DOCOWRIDR(+)
				 AND SHPMST.MSTDOCNUM = SHPMIS.MSTDOCNUM(+)
				 AND SHPMST.DUPNUM = SHPMIS.DUPNUM(+)
				 AND SHPMST.SEQNUM = SHPMIS.SEQNUM(+)
				
				 AND SHPMST.CMPCOD = ?
				 AND SHPMST.DOCOWRIDR = ?
				 AND SHPMST.MSTDOCNUM = ?


			]]>
	</QRY:Source>
</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>241</QRY:Id>
			<QRY:Source Name="operations.shipment.findOperationsShipmentHistoryDetails" Type="NATIVE">
			<![CDATA[
			
				SELECT 
				MST.AGTNAM AGTNAM,
				MST.AGTCOD AGTCOD,
				MST.ORGCOD ORGCOD,
				MST.DSTCOD DSTCOD,
				MST.SHPSTA SHPSTA,
				MST.CPTDAT CPTDAT,
				MST.STDPCS STDPCS,
				MST.STDWGT STDWGT,
				HIS.ACTCOD ACTCOD,
				HIS.OLDAWBDTL OLDAWBDTL,
				HIS.NEWAWBDTL NEWAWBDTL,
				HIS.AUDRMK AUDRMK,
				HIS.STNCOD STNCOD,
				HIS.LSTUPDUSR LSTUPDUSR,
				HIS.LSTUPDTIM LSTUPDTIM,
				HIS.UPDTXNTIMUTC UPDTXNTIMUTC,
				HIS.CMPCOD HISCMPCOD,
				HIS.MSTDOCNUM HISMSTDOCNUM,
				HIS.DOCOWRIDR HISDOCOWRIDR,
				HIS.DUPNUM HISDUPNUM,
				HIS.SEQNUM HISSEQNUM,
				HIS.SERNUM HISSERNUM,
				FLT.RTGSERNUM RTGSERNUM,
				FLT.DSTCOD RTGDSTCOD,
				FLT.DOCOWRIDR DOCOWRIDR,
				FLT.MSTDOCNUM MSTDOCNUM,
				FLT.DUPNUM DUPNUM,
				FLT.SEQNUM SEQNUM,
				FLT.CMPCOD CMPCOD
				FROM 
				OPRSHPMST MST, OPRAWBHIS HIS ,OPRSHPRTG FLT
				WHERE 
				HIS.CMPCOD = MST.CMPCOD(+)
				AND HIS.MSTDOCNUM = MST.MSTDOCNUM(+)
				AND HIS.DOCOWRIDR = MST.DOCOWRIDR(+)
				AND HIS.DUPNUM = MST.DUPNUM(+)
				AND HIS.SEQNUM = MST.SEQNUM(+)
				AND HIS.CMPCOD = FLT.CMPCOD(+)
				AND HIS.DOCOWRIDR = FLT.DOCOWRIDR(+)
				AND HIS.MSTDOCNUM = FLT.MSTDOCNUM(+)
				AND HIS.DUPNUM = FLT.DUPNUM(+)
				AND HIS.SEQNUM = FLT.SEQNUM(+)		
				AND HIS.CMPCOD = ?
				
			]]>
		</QRY:Source>
	</QRY:Definition>

<QRY:Definition>
		
	 	<QRY:Id>244</QRY:Id>
	 	<QRY:Source Name="operations.shipment.findtracingdamagedetails" Type="NATIVE">
			<![CDATA[
					 SELECT  MST.CMPCOD,  MST.DOCOWRIDR,MST.MSTDOCNUM,MST.STDPCS,MST.SEQNUM, 
						 MST.DUPNUM,MST.SHPPFX,MST.STDWGT,MST.SHPTYP,MST.SCCCOD,MST.SHPDES,MST.PRDNAM,MST.ORGCOD,MST.DSTCOD DST,DMG.ARPCOD ARPCOD,
						 NULL DISMSTDOCNUM,NULL DISCOD,NULL DOCNUM, DMG.LSTUPDTIM CRTTIM,NULL CLSDAT,NULL DISSTA,
						 NULL DISRMK,0 DISSEQNUM, NULL FLTDISDISCOD,NULL FLTDISCRTTIM,NULL FLTDISARP,0 DISPCS, 
						 0 DISWGT,NULL FLTDISCLSDAT,NULL FLTDISRMK, NULL FLTDISSTA,DMGDTL.DMGCOD,NULL DMGDISSRCIND, NULL CDSSTA, DMG.ARPCOD DMGARP,DMG.RPTSERNUM DMGSEQNUM,
						 DMG.LSTUPDTIM DMGDISDAT, 'O' DMGDISSTA,DMG.DMGRMK DMGRMK,DMGDTL.DMGPCS,0 MFTPCS, 0 MFTWGT,0 RCVPCS,  
						 0 RCVWGT,  0 FLTCARIDR,NULL DISFLTCARCOD, NULL DISFLTNUM,NULL DISFLTDAT,NULL FLTDISFLTCARCOD,
						 NULL FLTDISFLTNUM, NULL FLTDISFLTDAT,0 FLTDISFLTSEQNUM,NULL DISARPCOD,NULL FLTDISARPCOD, DMG.ARPCOD DMGARPCOD, NULL IMGPTH ,NULL IMG,
    NULL FILNAM,
    NULL FNDSHPNUM, NULL UPLDTIM,
    NULL UPLDUSR,
    NULL UPLDSTN,
	NULL IMGSEQNUM,
	ARPSHP.PLTUSEFLG PLTUSEFLG,
	SHPDTL.PLTUSEFLG DTLPLTFLG,
	0 FLTDISFLTCARIDR
					 FROM OPRSHPMST MST, TRCDMGREP DMG, 
						TRCDMGREPDTL DMGDTL,OPRARPSHP ARPSHP,
						OPRSHPDTL SHPDTL						
					 WHERE MST.CMPCOD = DMG.CMPCOD 
						AND MST.DOCOWRIDR = DMG.DOCOWRIDR 
						AND MST.MSTDOCNUM = DMG.MSTDOCNUM
						AND MST.SEQNUM = DMG.SEQNUM 
						AND MST.DUPNUM = DMG.DUPNUM 
						AND MST.CMPCOD = ARPSHP.CMPCOD 
						AND MST.DOCOWRIDR = ARPSHP.DOCOWRIDR 
						AND MST.MSTDOCNUM = ARPSHP.MSTDOCNUM 
						AND MST.SEQNUM = ARPSHP.SEQNUM 
						AND MST.DUPNUM = ARPSHP.DUPNUM 
						AND DMG.CMPCOD = DMGDTL.CMPCOD 
						AND DMG.DOCOWRIDR = DMGDTL.DOCOWRIDR 
						AND DMG.MSTDOCNUM = DMGDTL.MSTDOCNUM 
						AND DMG.SEQNUM = DMGDTL.SEQNUM 
						AND DMG.DUPNUM = DMGDTL.DUPNUM 
						AND DMG.RPTSERNUM = DMGDTL.RPTSERNUM 
						AND MST.CMPCOD = SHPDTL.CMPCOD(+)
						AND MST.MSTDOCNUM = SHPDTL.MSTDOCNUM(+)
						AND MST.DOCOWRIDR = SHPDTL.DOCOWRIDR(+)
						AND MST.SEQNUM = SHPDTL.SEQNUM(+)
						AND MST.DUPNUM = SHPDTL.DUPNUM(+)
						AND MST.CMPCOD = ? 
						AND MST.DOCOWRIDR = ? 
						AND MST.MSTDOCNUM = ? 
						AND MST.DUPNUM = ? 
						AND MST.SEQNUM = ?
						]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>244</QRY:Id>
		<QRY:Source Name="operations.shipment.findtransactionhousesformanifest" Type="NATIVE">
				<![CDATA[
					SELECT
					  SUM(PCS) PCS,
					SUM(WGT) WGT,
					    HSE.MSTDOCNUM,
					  HSE.DUPNUM,
					  HSE.DOCOWRIDR,
					  HSE.CMPCOD,
					  HSE.SEQNUM,
					  HSE.DOCNUM,
					  MST.STDPCS,
					  HSE.TXNCOD,
								  MST1.STDPCS MSTSTDPCS,
								  MST1.STDWGT MSTSTDWGT,
								  OPRLEG.TALNUM,
								  MST.SHPPFX,
								  MST.DOCNUM HAWB,
								  HSE.TXNREFONE,
								  HSE.TXNREFTWO,
								  HSE.TXNREFTHR,
								  HSE.TXNREFFOR,
								  HSE.TXNREFFIV,
								  HSE.TXNREFSIX,
					  OPRLEG.LEGORG,
					  oprleg.legdst,
					  MST.STDWGT
					FROM
					  OPRTXNHSE HSE,
					  OPRSHPMST MST,
								  OPRSHPMST MST1,
					  FLTOPRLEG OPRLEG
					    WHERE
					  HSE.MSTDOCNUM      = MST.MSTDOCNUM
					AND HSE.DUPNUM       = MST.DUPNUM
					AND HSE.DOCOWRIDR    = MST.DOCOWRIDR
					AND HSE.CMPCOD       = MST.CMPCOD
					AND HSE.SEQNUM       = MST.SEQNUM
								AND MST1.CMPCOD      = MST.CMPCOD
								AND MST1.DOCOWRIDR   = MST.DOCOWRIDR
								AND MST1.MSTDOCNUM   = MST.MSTDOCNUM
								AND MST1.DUPNUM      = MST.DUPNUM
								AND MST1.SEQNUM      = 1

					AND HSE.TXNREFTHR    = OPRLEG.FLTNUM
					AND HSE.TXNREFFIV    = OPRLEG.FLTSEQNUM
					AND HSE.TXNREFTWO    = OPRLEG.FLTCARIDR
					AND HSE.CMPCOD       = OPRLEG.CMPCOD

				]]>
		</QRY:Source>
	</QRY:Definition>
	
	<QRY:Definition>
    <QRY:Id>245</QRY:Id>
    <QRY:Source Name="operations.shipment.findshipmentsforctoforhht" Type="NATIVE">
      <![CDATA[
            SELECT MST.DOCOWRIDR,MST.DUPNUM ,MST.SEQNUM,MST.CMPCOD,
		IDX.SHPPFX,MST.MSTDOCNUM,MST.DOCTYP,MST.DOCNUM,
		MST.CPTDAT,MST.CNSCOD,MST.ORGCOD,MST.STDDISWGT,MST.STDPCS,MST.STDWGT,
		MST.DSTCOD,MST.SHPSTA,MST.UBRNUM,MST.SHPTYP,MST.CONFLG,IDX.OWRCOD,MST.PARSEQNUM,
		MST.LSTUPDUSR, MST.LSTUPDTIM, IMM.DOCNUM IMMMST,(SELECT DST.DSTCOD
		     FROM OPRSHPMST DST
		    WHERE DST.DOCOWRIDR = MST.DOCOWRIDR
		  AND DST.CMPCOD        = MST.CMPCOD
		  AND DST.DUPNUM        = MST.DUPNUM
		  AND DST.MSTDOCNUM     = MST.MSTDOCNUM
		  AND DST.PARSEQNUM     =0
		  ) PARDSTCOD
		FROM OPRSHPIDX IDX,OPRSHPMST  MST, SHRSYSPAR PAR, OPRSHPMST IMM
		WHERE
		MST.DOCOWRIDR = IDX.DOCOWRIDR AND
		MST.CMPCOD = IDX.CMPCOD AND
		MST.DUPNUM = IDX.DUPNUM AND
		MST.MSTDOCNUM = IDX.MSTDOCNUM AND
		MST.DOCOWRIDR = IMM.DOCOWRIDR (+) AND
		MST.CMPCOD = IMM.CMPCOD (+) AND
		MST.DUPNUM = IMM.DUPNUM (+) AND
		MST.MSTDOCNUM = IMM.MSTDOCNUM (+) AND
		MST.PARSEQNUM = IMM.SEQNUM (+) AND
		MST.CMPCOD = ? AND ? = (CASE WHEN MST.PARSEQNUM = 0
		THEN MST.SHPPFX ||MST.DOCNUM ELSE MST.DOCNUM END) AND
		MST.CMPCOD = PAR.CMPCOD AND
		PAR.PARCOD = ? AND
		((MST.CPTDAT > (SYSDATE - PAR.PARVAL) AND
            MST.CPTDAT <= (SYSDATE + PAR.PARVAL)) OR MST.PARSEQNUM = 0)
          ]]>
    </QRY:Source>
  </QRY:Definition>
  
  <QRY:Definition>
	    <QRY:Id>246</QRY:Id>
	    <QRY:Source Name="operations.shipment.findshipmentsforctosimulation" Type="NATIVE">
	      <![CDATA[
				SELECT MST.DOCOWRIDR,MST.DUPNUM ,MST.SEQNUM,MST.CMPCOD,
				IDX.SHPPFX,MST.MSTDOCNUM,MST.DOCTYP,MST.DOCNUM,
				MST.CPTDAT,MST.CNSCOD,MST.ORGCOD,MST.STDDISWGT,MST.STDPCS,MST.STDWGT,
				MST.DSTCOD,MST.SHPSTA,MST.UBRNUM,MST.SHPTYP,MST.CONFLG,IDX.OWRCOD,MST.PARSEQNUM,
				MST.LSTUPDUSR, MST.LSTUPDTIM,DLV.DLVDAT,OPRLEG.ATA ARRTIM
				FROM OPRSHPIDX IDX,OPRSHPMST  MST,OPRARPSHP ARV,OPRSHPDLVDTL DLV,OPRSEGSELSHP SEGSELSHP,FLTOPRLEG OPRLEG
				WHERE
				MST.DOCOWRIDR = IDX.DOCOWRIDR AND
				MST.CMPCOD = IDX.CMPCOD AND
				MST.DUPNUM = IDX.DUPNUM AND
				MST.MSTDOCNUM = IDX.MSTDOCNUM AND
                MST.DOCOWRIDR = SEGSELSHP.DOCOWRIDR AND
				MST.CMPCOD = SEGSELSHP.CMPCOD AND
				MST.DUPNUM = SEGSELSHP.DUPNUM AND
				MST.MSTDOCNUM = SEGSELSHP.MSTDOCNUM AND
                SEGSELSHP.FLTNUM=OPRLEG.FLTNUM AND
                SEGSELSHP.FLTCARIDR=OPRLEG.FLTCARIDR AND
                SEGSELSHP.FLTSEQNUM=OPRLEG.FLTSEQNUM AND
				ARV.DOCOWRIDR = DLV.DOCOWRIDR (+) AND
				ARV.CMPCOD = DLV.CMPCOD (+) AND
				ARV.DUPNUM = DLV.DUPNUM (+) AND
				ARV.MSTDOCNUM = DLV.MSTDOCNUM (+) AND
				MST.DOCOWRIDR = ARV.DOCOWRIDR AND
				MST.CMPCOD = ARV.CMPCOD AND
				MST.DUPNUM = ARV.DUPNUM AND
				MST.MSTDOCNUM = ARV.MSTDOCNUM AND
			    ARV.ARPCOD = DLV.ARPCOD (+) AND
	            ARV.ARPCOD = 'HND' AND
	            MST.CMPCOD = ? AND ? = (CASE WHEN MST.PARSEQNUM = 0
	            THEN MST.SHPPFX ||MST.DOCNUM ELSE MST.DOCNUM END)
	          ]]>
	    </QRY:Source>
  </QRY:Definition>
  
  <QRY:Definition>
  		<QRY:Id>245</QRY:Id>
  		<QRY:Source Name="operations.shipment.jto.findDeliveryProgressDetails" Type="NATIVE">
  			<![CDATA[
  				  SELECT
  				    CMPCOD,
  				    SHPPFX,
  				    DOCOWRIDR,
  				    MSTDOCNUM,
  				    DOCNUM,
  				    GRPIMPNUM,
  				    FWDCOD,
  				    COUNT( DISTINCT STUCOD )OVER( PARTITION BY CMPCOD, DOCOWRIDR, MSTDOCNUM, DUPNUM, SEQNUM ) TOTSKD,
  				    TOTDLVPCS DLVPCS,
  				    AVLPCS,
  				    TOTDLVWGT DLVWGT,
  				    STUCOD SKDIDR,
  				    TRKDOCNUM,
  				    LOCCOD,
  				    DOSTATUS,
  				    OUTTIM,
  				    MSGINBTIM,
  				    RELOCTIM,
  				    TRKOUTTIM,
  				    LODTIM,
  				    ENDTIM,
  				    STATUS,
  				    STA,
  					    ACPSLPNO,
  						MINTXNTIM,
  						LODTIMMIN
  				   FROM
  				    (
  				         SELECT
  				            SHPMST.CMPCOD,
  				            SHPMST.SHPPFX,
  				            SHPMST.DOCOWRIDR,
  				            SHPMST.MSTDOCNUM,
  				            SHPMST.DUPNUM,
  				            SHPMST.SEQNUM,
  				            SHPMST.DOCNUM,
  				            COLINS.GRPIMPNUM,
  				            SELSHP.FWDCOD,
  				            ARPSHP.TOTDLVPCS,
  				            ARPSHP.AVLPCS,
  				            ARPSHP.TOTDLVWGT,
  				            WHSOPR.STUCOD,
  				            ACPSLP.STGARA TRKDOCNUM,
  				            WHSOPR.LOCCOD,
  				            CASE
  				                WHEN COLINS.REGTYP = 'R' OR COLINS.REGTYP = 'C'
  				                THEN 'R'
  				                ELSE 'N'
  				            END DOSTATUS,
  				            ARPCOL.OUTTIM,
  				            MSGPRC.CRETIM MSGINBTIM,
  							(
  								 SELECT
  									 MIN( TXNHIS.TXNTIM ) TXNTIM
  								   FROM
  									WHSOPRSHPTXNHIS TXNHIS
  								  WHERE
  									TXNHIS.TXNCOD     = 'RELOC'
  								AND TXNHIS.DSTLOCCOD IN (SELECT ACPSLP.STGARA FROM OPRACPSLPSHP ACPSLP
  									WHERE
  									ACPSLP.CMPCOD    = TXNHIS.CMPCOD
  									AND ACPSLP.DOCOWRIDR = TXNHIS.DOCOWRIDR
  									AND ACPSLP.MSTDOCNUM = TXNHIS.MSTDOCNUM
  									AND ACPSLP.DUPNUM    = TXNHIS.DUPNUM
  									AND ACPSLP.SEQNUM    = TXNHIS.SEQNUM)
  									AND TXNHIS.CMPCOD    = WHSOPR.CMPCOD
  									AND TXNHIS.DOCOWRIDR = WHSOPR.DOCOWRIDR
  									AND TXNHIS.MSTDOCNUM = WHSOPR.MSTDOCNUM
  									AND TXNHIS.DUPNUM    = WHSOPR.DUPNUM
  									AND TXNHIS.SEQNUM    = WHSOPR.SEQNUM
  									AND TXNHIS.DSTSTUCOD  = WHSOPR.STUCOD
  									AND TXNHIS.DSTWHSCOD = WHSOPR.WHSCOD
  							   GROUP BY
  									TXNHIS.CMPCOD,
  									TXNHIS.DOCOWRIDR,
  									TXNHIS.MSTDOCNUM,
  									TXNHIS.DUPNUM,
  									TXNHIS.SEQNUM,
  									TXNHIS.DSTWHSCOD,
  									TXNHIS.DSTSTUCOD
  							) RELOCTIM,
  				            ACPSLP.TRKOUTTIM,
  				            ACPSKD.LODTIM,
  				            ACPSLP.ENDTIM,
  				            CASE
  				                WHEN ARPSHP.AVLPCS > 0
  				                THEN 'P'
  				                ELSE 'D'
  				            END STATUS,
  				            FLTLEG.STA,
  					            SHPINS.DELIDR ACPSLPNO,
  					            (
  					                 SELECT
  					                     MIN( TXNHIS.TXNTIM ) TXNTIM
  					                   FROM
  					                    WHSOPRSHPTXNHIS TXNHIS
  					                  WHERE
  					                    TXNHIS.TXNCOD     = 'RELOC'
  					                AND TXNHIS.DSTLOCCOD IN (SELECT ACPSLP.STGARA FROM OPRACPSLPSHP ACPSLP
  										WHERE
  										ACPSLP.CMPCOD    = TXNHIS.CMPCOD
  										AND ACPSLP.DOCOWRIDR = TXNHIS.DOCOWRIDR
  										AND ACPSLP.MSTDOCNUM = TXNHIS.MSTDOCNUM
  										AND ACPSLP.DUPNUM    = TXNHIS.DUPNUM
  										AND ACPSLP.SEQNUM    = TXNHIS.SEQNUM)
  										AND TXNHIS.CMPCOD    = SHPMST.CMPCOD
  										AND TXNHIS.DOCOWRIDR = SHPMST.DOCOWRIDR
  										AND TXNHIS.MSTDOCNUM = SHPMST.MSTDOCNUM
  										AND TXNHIS.DUPNUM    = SHPMST.DUPNUM
  										AND TXNHIS.SEQNUM    = SHPMST.SEQNUM
  					               GROUP BY
  					                    TXNHIS.CMPCOD,
  					                    TXNHIS.DOCOWRIDR,
  					                    TXNHIS.MSTDOCNUM,
  					                    TXNHIS.DUPNUM,
  					                    TXNHIS.SEQNUM
  					            )
  					             MINTXNTIM,
  								MINLODTIM.LODTIM LODTIMMIN
  				           FROM
  				            OPRSHPMST SHPMST,
  				            OPRSEGSHP SEGSHP,
  				            OPRFLTSEG FLTSEG,
  				            FLTOPRLEG FLTLEG,
  				            OPRSEGSELSHP SELSHP,
  				            OPRARPSHP ARPSHP,
  				            OPRACPSLPSHP ACPSLP,
  				            WHSOPRSHPLOC WHSOPR,
  				            OPRARPCOLSHP ARPCOL,
  				            OPRCOLINSMST COLINS,
  				            OPRSHPCOLINS SHPINS,
  				            WRKFLOMSGPRC MSGPRC,
  				            OPRSKDDTL SKDDTL,
                              OPRACPSLPDLVSKD ACPSKD,
  				            (
  				                 SELECT
  				                    CMPCOD,
  				                    WRKFLONAM,
  				                    MSGTYP,
  				                    AWBNUM,
  				                    MSTDOCNUM,
  				                    SHPPFX,
  				                    MIN( SEQNUM ) SEQNUM
  				                   FROM
  				                    (
  				                         SELECT
  				                            CMPCOD,
  				                            WRKFLONAM,
  				                            SEQNUM,
  				                            MSGTYP,
  				                            MAX(
  				                                CASE
  				                                    WHEN PARCOD = 'AWBNUM'
  				                                    THEN PARVAL
  				                                    ELSE NULL
  				                                END ) AWBNUM,
  				                            MAX(
  				                                CASE
  				                                    WHEN PARCOD = 'MSTDOCNUM'
  				                                    THEN PARVAL
  				                                    ELSE NULL
  				                                END ) MSTDOCNUM,
  				                            MAX(
  				                                CASE
  				                                    WHEN PARCOD = 'SHPPFX'
  				                                    THEN PARVAL
  				                                    ELSE NULL
  				                                END ) SHPPFX
  				                           FROM
  				                            (
  				                                 SELECT
  				                                    CMPCOD,
  				                                    WRKFLONAM,
  				                                    SEQNUM,
  				                                    MSGTYP,
  				                                    PARVAL,
  				                                    PARCOD
  				                                   FROM
  				                                    WRKFLOMSGPRCENTREF
  				                                  WHERE
  				                                    WRKFLONAM = 'DLV'
  				                            )
  				                       GROUP BY
  				                            CMPCOD,
  				                            WRKFLONAM,
  				                            SEQNUM,
  				                            MSGTYP
  				                    )
  				               GROUP BY
  				                    CMPCOD,
  				                    WRKFLONAM,
  				                    MSGTYP,
  				                    AWBNUM,
  				                    MSTDOCNUM,
  				                    SHPPFX
  				            )
  				            ENTREF,
  					            (
  					                 SELECT
  					                    CMPCOD,
  					                    DOCOWRIDR,
  					                    MSTDOCNUM,
  					                    DUPNUM,
  					                    SEQNUM,
  										ARPCOD,
  					                    MIN( LODTIM ) LODTIM
  					                   FROM
  					                    OPRACPSLPDLVSKD
  					               GROUP BY
  					                    CMPCOD,
  					                    DOCOWRIDR,
  					                    MSTDOCNUM,
  					                    DUPNUM,
  					                    SEQNUM,
  										ARPCOD
  					            )
  					            MINLODTIM
  				          WHERE
  				            SHPMST.CMPCOD    = SEGSHP.CMPCOD
  				        AND SHPMST.DOCOWRIDR = SEGSHP.DOCOWRIDR
  				        AND SHPMST.MSTDOCNUM = SEGSHP.MSTDOCNUM
  				        AND SHPMST.DUPNUM    = SEGSHP.DUPNUM
  				        AND SHPMST.SEQNUM    = SEGSHP.SEQNUM
  				        AND SEGSHP.CMPCOD    = FLTSEG.CMPCOD
  				        AND SEGSHP.FLTCARIDR = FLTSEG.FLTCARIDR
  				        AND SEGSHP.FLTNUM    = FLTSEG.FLTNUM
  				        AND SEGSHP.FLTSEQNUM = FLTSEG.FLTSEQNUM
  				        AND SEGSHP.SEGSERNUM = FLTSEG.SEGSERNUM
  				        AND FLTSEG.CMPCOD    = FLTLEG.CMPCOD
  				        AND FLTSEG.FLTCARIDR = FLTLEG.FLTCARIDR
  				        AND FLTSEG.FLTNUM    = FLTLEG.FLTNUM
  				        AND FLTSEG.FLTSEQNUM = FLTLEG.FLTSEQNUM
  				        AND FLTSEG.POU       = FLTLEG.LEGDST
  				        AND SEGSHP.CMPCOD    = SELSHP.CMPCOD
  				        AND SEGSHP.DOCOWRIDR = SELSHP.DOCOWRIDR
  				        AND SEGSHP.MSTDOCNUM = SELSHP.MSTDOCNUM
  				        AND SEGSHP.DUPNUM    = SELSHP.DUPNUM
  				        AND SEGSHP.SEQNUM    = SELSHP.SEQNUM
  				        AND SEGSHP.FLTCARIDR = SELSHP.FLTCARIDR
  				        AND SEGSHP.FLTNUM    = SELSHP.FLTNUM
  				        AND SEGSHP.FLTSEQNUM = SELSHP.FLTSEQNUM
  				        AND SEGSHP.SEGSERNUM = SELSHP.SEGSERNUM
  				        AND SHPMST.CMPCOD    = ARPSHP.CMPCOD
  				        AND SHPMST.DOCOWRIDR = ARPSHP.DOCOWRIDR
  				        AND SHPMST.MSTDOCNUM = ARPSHP.MSTDOCNUM
  				        AND SHPMST.DUPNUM    = ARPSHP.DUPNUM
  				        AND SHPMST.SEQNUM    = ARPSHP.SEQNUM
  				        AND ARPSHP.ARPCOD    = ?
  				        AND ARPSHP.CMPCOD    = ARPCOL.CMPCOD
  					AND ARPSHP.DOCOWRIDR = ARPCOL.DOCOWRIDR
  					AND ARPSHP.MSTDOCNUM = ARPCOL.MSTDOCNUM
  					AND ARPSHP.DUPNUM    = ARPCOL.DUPNUM
  					AND ARPSHP.SEQNUM    = ARPCOL.SEQNUM
  					AND ARPSHP.ARPCOD    = ARPCOL.ARPCOD
  				        AND ARPCOL.OUTFLG    = 'S'
  				        AND ARPSHP.CMPCOD    = ACPSLP.CMPCOD(+)
  				        AND ARPSHP.DOCOWRIDR = ACPSLP.DOCOWRIDR(+)
  				        AND ARPSHP.MSTDOCNUM = ACPSLP.MSTDOCNUM(+)
  				        AND ARPSHP.DUPNUM    = ACPSLP.DUPNUM(+)
  				        AND ARPSHP.SEQNUM    = ACPSLP.SEQNUM(+)
  				        AND ARPSHP.ARPCOD    = ACPSLP.ARPCOD(+)
  				        AND ARPSHP.CMPCOD    = WHSOPR.CMPCOD(+)
  				        AND ARPSHP.DOCOWRIDR = WHSOPR.DOCOWRIDR(+)
  				        AND ARPSHP.MSTDOCNUM = WHSOPR.MSTDOCNUM(+)
  				        AND ARPSHP.DUPNUM    = WHSOPR.DUPNUM(+)
  				        AND ARPSHP.SEQNUM    = WHSOPR.SEQNUM(+)
  				        AND ARPSHP.ARPCOD    = WHSOPR.ARPCOD(+)
  				        AND WHSOPR.WHSCOD(+) = ?
  				        AND WHSOPR.CMPCOD    = SKDDTL.CMPCOD(+)
  				        AND WHSOPR.ARPCOD    = SKDDTL.ARPCOD(+)
  				        AND WHSOPR.STUCOD    = SKDDTL.SKDIDR(+)
  				        AND ARPSHP.CMPCOD    = SHPINS.CMPCOD(+)
  				        AND ARPSHP.DOCOWRIDR = SHPINS.DOCOWRIDR(+)
  				        AND ARPSHP.MSTDOCNUM = SHPINS.MSTDOCNUM(+)
  				        AND ARPSHP.DUPNUM    = SHPINS.DUPNUM(+)
  				        AND ARPSHP.SEQNUM    = SHPINS.SEQNUM(+)
  				        AND ARPSHP.ARPCOD    = SHPINS.ARPCOD(+)
  				        AND SHPINS.CMPCOD    = COLINS.CMPCOD(+)
  				        AND SHPINS.ARPCOD    = COLINS.ARPCOD(+)
  				        AND SHPINS.DELIDR    = COLINS.DELIDR(+)
  				        AND SHPMST.CMPCOD    = ENTREF.CMPCOD(+)
  				        AND NVL(SHPMST.SHPPFX,'null')    = ENTREF.SHPPFX(+)
  				        AND SHPMST.MSTDOCNUM = ENTREF.MSTDOCNUM(+)
  				        AND
  				            CASE
  				                WHEN SHPMST.PARSEQNUM = 0
  				                THEN NVL(SHPMST.SHPPFX,'null') 
  				                    ||'-'
  				                    ||SHPMST.MSTDOCNUM
  				                ELSE SHPMST.DOCNUM
  				            END              = ENTREF.AWBNUM(+)
  				        AND ENTREF.CMPCOD    = MSGPRC.CMPCOD(+)
  				        AND ENTREF.WRKFLONAM = MSGPRC.WRKFLONAM(+)
  				        AND ENTREF.MSGTYP    = MSGPRC.MSGTYP(+)
  				        AND ENTREF.SEQNUM    = MSGPRC.SEQNUM(+)
                          AND SKDDTL.CMPCOD    = ACPSKD.CMPCOD(+)
  				        AND SKDDTL.ARPCOD    = ACPSKD.ARPCOD(+)
  				        AND SKDDTL.SKDIDR    = ACPSKD.SKDIDR(+)
  							AND ARPSHP.CMPCOD    = MINLODTIM.CMPCOD(+)
  					        AND ARPSHP.DOCOWRIDR = MINLODTIM.DOCOWRIDR(+)
  					        AND ARPSHP.MSTDOCNUM = MINLODTIM.MSTDOCNUM(+)
  					        AND ARPSHP.DUPNUM    = MINLODTIM.DUPNUM(+)
  					        AND ARPSHP.SEQNUM    = MINLODTIM.SEQNUM(+)
  					        AND ARPSHP.ARPCOD    = MINLODTIM.ARPCOD(+)
  				    )
  				  WHERE
  				    CMPCOD = ?				]]>
  		</QRY:Source>
  	</QRY:Definition>
  	
  	<QRY:Definition>
    <QRY:Id>246</QRY:Id>
    <QRY:Source Name="operations.shipment.jto.findldrdetails" Type="NATIVE">
      <![CDATA[

       SELECT
         LDRDTL.CMPCOD, LDRDTL.LDRNUM, LDRDTL.ITNFLG,  LDRSHP.DOCNUM, LDRSHP.SHPSERNUM, LDRSHP.LDRPCS, LDRSHP.LDRWGT, LDRSHP.NCSPCS, LDRSHP.NCSWGT, LDRSHP.RMK,
             ARPSHP.MSTAWBCHKFLG, LDRSHP.DSTCOD, MST.CMPCOD MSTCMPCOD, MST.SHPPFX, LDRSHP.MSTDOCNUM, LDRSHP.DOCOWRIDR, LDRSHP.SEQNUM,LDRSHP.DUPNUM,
             SCC.SCCCOD, SCC.SCCPRY,MST.CONFLG, TRKSHPACP.MSTDOCNUM SHPACPAWB, TRKULDACP.MSTDOCNUM ULDACPAWB,ARPSHP.ACPPCS,LDRDTL.SRC,LDRSHP.SCCCOD LDRSCC,
			 LDRDTL.LSTUPDUSR,LDRDTL.LSTUPDTIM,LDRSHP.ACPPCS LDRACPPCS,LDRSHP.LSTUPDUSR SHPLSTUPDUSR,LDRSHP.LSTUPDTIM SHPLSTUPDTIM

      FROM  OPRSHPMST MST,
          OPRLDRDTL LDRDTL,
        OPRLDRSHP LDRSHP,
              OPRARPSHP ARPSHP,
              OPRSHPSCC SCC, (SELECT SHP.MSTDOCNUM, SHP.DOCOWRIDR, SHP.DUPNUM, SHP.SEQNUM, SHP.CMPCOD
 FROM OPRLDRDTL DTL, OPRLDRSHP SHP, OPRTRKSHPACP SHPACP
 WHERE DTL.LDRNUM = SHP.LDRNUM
 	AND DTL.CMPCOD = SHP.CMPCOD
 	AND SHP.CMPCOD = SHPACP.CMPCOD
 	AND SHP.DUPNUM = SHPACP.DUPNUM
 	AND SHP.SEQNUM = SHPACP.SEQNUM
 	AND SHP.DOCOWRIDR = SHPACP.DOCOWRIDR
 	AND SHP.MSTDOCNUM = SHPACP.MSTDOCNUM
 	AND SHPACP.TOTACPPCS > 0) TRKSHPACP,
 	(SELECT SHP.CMPCOD, SHP.MSTDOCNUM, SHP.SEQNUM, SHP.DUPNUM, SHP.DOCOWRIDR, DTL.ULDNUM
 FROM OPRLDRDTL DTL, OPRLDRSHP SHP, OPRTRKULDACP ULDACP
 WHERE DTL.CMPCOD = SHP.CMPCOD
 	AND DTL.LDRNUM = SHP.LDRNUM
 	AND DTL.CMPCOD = ULDACP.CMPCOD
 	AND DTL.ULDNUM = ULDACP.ULDNUM) TRKULDACP

       WHERE LDRDTL.LDRNUM = LDRSHP.LDRNUM
         AND LDRDTL.CMPCOD =  LDRSHP.CMPCOD
         AND LDRSHP.CMPCOD = MST.CMPCOD(+)
	        AND LDRSHP.DOCOWRIDR = MST.DOCOWRIDR(+)
	        AND LDRSHP.MSTDOCNUM = MST.MSTDOCNUM(+)
	        AND LDRSHP.DUPNUM = MST.DUPNUM(+)
	          AND LDRSHP.SEQNUM = MST.SEQNUM(+)

	        AND LDRSHP.CMPCOD = SCC.CMPCOD(+)
	        AND LDRSHP.DOCOWRIDR = SCC.DOCOWRIDR(+)
	        AND LDRSHP.MSTDOCNUM = SCC.MSTDOCNUM(+)
	        AND LDRSHP.DUPNUM = SCC.DUPNUM(+)
       AND LDRSHP.SEQNUM = SCC.SEQNUM(+)

       AND LDRSHP.CMPCOD = ARPSHP.CMPCOD(+)
       AND LDRSHP.DOCOWRIDR = ARPSHP.DOCOWRIDR(+)
       AND LDRSHP.MSTDOCNUM = ARPSHP.MSTDOCNUM(+)
       AND LDRSHP.DUPNUM = ARPSHP.DUPNUM(+)
       AND LDRSHP.SEQNUM = ARPSHP.SEQNUM(+)

       AND LDRSHP.MSTDOCNUM = TRKSHPACP.MSTDOCNUM(+)
       AND LDRSHP.DUPNUM = TRKSHPACP.DUPNUM(+)
       AND LDRSHP.SEQNUM = TRKSHPACP.SEQNUM(+)
       AND LDRSHP.DOCOWRIDR = TRKSHPACP.DOCOWRIDR(+)
       AND LDRSHP.CMPCOD = TRKSHPACP.CMPCOD(+)

       AND LDRSHP.MSTDOCNUM = TRKULDACP.MSTDOCNUM(+)
		 AND LDRSHP.DUPNUM = TRKULDACP.DUPNUM(+)
		 AND LDRSHP.SEQNUM = TRKULDACP.SEQNUM(+)
		 AND LDRSHP.DOCOWRIDR = TRKULDACP.DOCOWRIDR(+)
       AND LDRSHP.CMPCOD = TRKULDACP.CMPCOD(+)

         AND LDRDTL.CMPCOD = ?
       AND LDRDTL.LDRNUM = ?

       ORDER BY  LDRDTL.LDRNUM, LDRSHP.MSTDOCNUM, LDRSHP.SEQNUM


      ]]>
    </QRY:Source>
  </QRY:Definition>
  
   <QRY:Definition>
    <QRY:Id>247</QRY:Id>
    <QRY:Source Name="operations.shipment.jto.delivery.findldrenquirydetails" Type="NATIVE">
      <![CDATA[
          SELECT TRK.ACPIDR, LDR.LDRNUM, LDR.ITNFLG, ACPTRK.TRKNUM, LDR.FRMWHS, LDR.DSTWHS,
				  DRVDTL.DRVNAM, DRVDTL.DRVLIC, LDR.ACPTIM, LDR.ACPUSR,LDR.BILBIISTA
			FROM OPRLDRDTL LDR , OPRTRKLDR TRK ,OPRACPTRKDTL ACPTRK , OPRACPTRKDRVDTL DRVDTL
			WHERE LDR.LDRNUM = TRK.LDRNUM(+)
			AND TRK.CMPCOD = ACPTRK.CMPCOD (+)
			AND TRK.ACPIDR = ACPTRK.ACPIDR (+)
			 AND TRK.ACPIDR = DRVDTL.ACPIDR(+)

      ]]>
    </QRY:Source>
  </QRY:Definition>
  
  <QRY:Definition>
  <QRY:Id>248</QRY:Id>
  <QRY:Source Name="operations.shipment.jto.validateldr" Type="NATIVE">
    <![CDATA[
         SELECT LDR.LDRNUM,
          LDR.CMPCOD      ,
          LDR.BILBIISTA   ,
          LDR.DSTWHS      ,
          LDR.FRMWHS      ,
          LDR.ITNFLG      ,
          LDR.PRT         ,
          LDR.RCVTIM      ,
          LDR.ULDNUM      ,
          LDR.ULDPCS
           FROM OPRLDRDTL LDR
          WHERE LDR.LDRNUM = ?
        AND LDR.CMPCOD     = ?
      ]]>
  </QRY:Source>
 </QRY:Definition>
  
  <QRY:Definition>
			<QRY:Id>249</QRY:Id>
			<QRY:Source Name="operations.shipment.jto.findldrdetailsforbii" Type="NATIVE">
				<![CDATA[
					SELECT LDRDTL.CMPCOD, LDRDTL.LDRNUM , LDRSHP.DOCNUM ,LDRSHP.SHPSERNUM ,MST.CONFLG,
  						MST.SHPPFX  ,MST.MSTDOCNUM ,MST.DOCOWRIDR ,MST.SEQNUM  ,MST.DUPNUM,LDRSHP.NCSPCS,LDRSHP.NCSWGT FROM OPRSHPMST MST,
  						OPRLDRDTL LDRDTL   ,OPRLDRSHP LDRSHP  WHERE LDRDTL.LDRNUM = LDRSHP.LDRNUM
						AND LDRDTL.CMPCOD     = LDRSHP.CMPCOD
						AND MST.CMPCOD        = LDRSHP.CMPCOD
						AND MST.DOCOWRIDR     = LDRSHP.DOCOWRIDR
						AND MST.MSTDOCNUM     = LDRSHP.MSTDOCNUM
						AND MST.DUPNUM        = LDRSHP.DUPNUM
						AND MST.SEQNUM        = LDRSHP.SEQNUM
						AND NVL(LDRSHP.BIISTA, 'N' ) <> 'S'
						AND NVL(LDRSHP.BIISTA, 'N' ) <> 'Y'
						AND LDRDTL.CMPCOD     = ?
						AND LDRDTL.LDRNUM     = ?
						ORDER BY LDRDTL.LDRNUM
					]]>
			</QRY:Source>
		</QRY:Definition>
  
	<QRY:Definition>
			<QRY:Id>250</QRY:Id>
			<QRY:Source Name="operations.shipment.jto.findcompletelyacceptedldrs" Type="NATIVE">
				<![CDATA[
					     SELECT LDRSHP.LDRNUM,
							  LDRSHP.CMPCOD      ,


                   LDRSHP.MSTDOCNUM                                                                                                                                                                                ,
                   LDRSHP.DOCOWRIDR                                                                                                                                                                                ,
                   LDRSHP.DUPNUM                                                                                                                                                                                   ,
                   LDRSHP.SEQNUM                                                                                                                                                                                   ,
							  LDRSHP.ACPPCS      ,
							  LDRSHP.LDRPCS      ,
							  ARPSHP.MSTAWBCHKFLG,
							  SHPMST.CONFLG      ,
							  LDRDTL.ACPTIM      ,
							  LDRDTL.ACPUSR,LDRDTL.BILBIISTA,LDRDTL.SRC
							   FROM OPRTRKLDR TRKLDR,
							  OPRLDRDTL LDRDTL      ,
                   OPRLDRSHP LDRSHP                        ,
                     OPRARPSHP ARPSHP                                                                                                                                                                                                                                                                                                                                                                                              ,
                     OPRSHPMST SHPMST
							  WHERE TRKLDR.CMPCOD = LDRDTL.CMPCOD
							AND TRKLDR.LDRNUM     = LDRDTL.LDRNUM
							AND LDRDTL.CMPCOD     = LDRSHP.CMPCOD
     AND LDRDTL.LDRNUM                   = LDRSHP.LDRNUM
     AND LDRSHP.CMPCOD                   = ARPSHP.CMPCOD
     AND LDRSHP.MSTDOCNUM                = ARPSHP.MSTDOCNUM
     AND LDRSHP.DUPNUM                   = ARPSHP.DUPNUM
							AND LDRSHP.DOCOWRIDR  = ARPSHP.DOCOWRIDR
     AND LDRSHP.CMPCOD               = SHPMST.CMPCOD
    AND LDRSHP.MSTDOCNUM  = SHPMST.MSTDOCNUM
    AND LDRSHP.DUPNUM     = SHPMST.DUPNUM
    AND LDRSHP.SEQNUM     = SHPMST.SEQNUM
							AND LDRSHP.DOCOWRIDR  = SHPMST.DOCOWRIDR
							AND TRKLDR.CMPCOD     = ?
							AND TRKLDR.ACPIDR     = ?
							AND ARPSHP.ARPCOD     = ?
	AND LDRDTL.ULDNUM    IS NULL



					]]>
		</QRY:Source>
	</QRY:Definition>
	
	<QRY:Definition>
			<QRY:Id>251</QRY:Id>
			<QRY:Source Name="operations.shipment.jto.findcompletelyacceptedldrdetails" Type="NATIVE">
				<![CDATA[
					   SELECT *
				         FROM
				        (SELECT SHPMST.ORGCOD    ,
				       SHPMST.DSTCOD          ,
				       SHPMST.SHPPFX          ,
				       SHPMST.MSTDOCNUM       ,
				       SHPMST.STDPCS          ,
				       SHPMST.STDWGT          ,
				       SHPMST.STDWGTCOD       ,
				       SHPMST.SHPNAM          ,
				       SHPMST.CMPCOD          ,
				       SHPMST.DOCOWRIDR       ,
				       SHPMST.DUPNUM          ,
				       ARPSHP.ACPPCS          ,
				       ARPSHP.ACPWGT          ,
				       TRKSHP.TOTACPPCS TRKPCS,
				       TRKSHP.TOTACPWGT TRKWGT,
				       TRKSHP.ACPIDR          ,
				       SHPMST.SEQNUM          ,
				       SHPMST.EXEFLG
				        FROM OPRARPSHP ARPSHP,
				       OPRTRKSHPACP TRKSHP   ,
				       OPRSHPMST SHPMST
				       WHERE SHPMST.MSTDOCNUM = ARPSHP.MSTDOCNUM
				        AND SHPMST.SEQNUM        = ARPSHP.SEQNUM
				        AND SHPMST.DOCOWRIDR     = ARPSHP.DOCOWRIDR
				        AND SHPMST.DUPNUM        = ARPSHP.DUPNUM
				        AND SHPMST.CMPCOD        = ARPSHP.CMPCOD
				        AND ARPSHP.MSTDOCNUM     = TRKSHP.MSTDOCNUM
				        AND ARPSHP.SEQNUM        = TRKSHP.SEQNUM
				        AND ARPSHP.DOCOWRIDR     = TRKSHP.DOCOWRIDR
				        AND ARPSHP.DUPNUM        = TRKSHP.DUPNUM
				        AND ARPSHP.CMPCOD        = TRKSHP.CMPCOD
				        AND ARPSHP.ARPCOD        = TRKSHP.ARPCOD

				       UNION

				          SELECT SHPMST.ORGCOD ,
							  SHPMST.DSTCOD       ,
							  SHPMST.SHPPFX       ,
							  SHPMST.MSTDOCNUM    ,
							  SHPMST.STDPCS       ,
							  SHPMST.STDWGT       ,
							  SHPMST.STDWGTCOD    ,
							  SHPMST.SHPNAM       ,
							  SHPMST.CMPCOD       ,
							  SHPMST.DOCOWRIDR    ,
							  SHPMST.DUPNUM       ,
							  ARPSHP.ACPPCS       ,
							  ARPSHP.ACPWGT       ,
						  SUM(LDRSHP.LDRPCS) TRKPCS,
						  SUM(LDRSHP.LDRWGT) TRKWGT,
						  TRKLDR.ACPIDR,
							  SHPMST.SEQNUM       ,
							  SHPMST.EXEFLG
							   FROM OPRARPSHP ARPSHP,
							  OPRSHPMST SHPMST      ,
							  OPRLDRSHP LDRSHP      ,
							  OPRTRKLDR TRKLDR
							  WHERE SHPMST.MSTDOCNUM = ARPSHP.MSTDOCNUM
							AND SHPMST.SEQNUM        = ARPSHP.SEQNUM
							AND SHPMST.DOCOWRIDR     = ARPSHP.DOCOWRIDR
							AND SHPMST.DUPNUM        = ARPSHP.DUPNUM
							AND SHPMST.CMPCOD        = ARPSHP.CMPCOD
						 AND ARPSHP.CMPCOD = LDRSHP.CMPCOD
						 AND ARPSHP.MSTDOCNUM = LDRSHP.MSTDOCNUM
						 AND ARPSHP.DOCOWRIDR = LDRSHP.DOCOWRIDR
						 AND ARPSHP.DUPNUM = LDRSHP.DUPNUM
						 AND ARPSHP.SEQNUM = LDRSHP.SEQNUM
							AND LDRSHP.CMPCOD        = TRKLDR.CMPCOD
							AND LDRSHP.LDRNUM        = TRKLDR.LDRNUM
					     AND EXISTS
					       (SELECT ULDSHP.CMPCOD
					          FROM OPRTRKULDACP ULDACP,
					         OPRULDSHP ULDSHP
							WHERE ULDACP.CMPCOD = ULDSHP.CMPCOD
							AND ULDACP.ULDNUM = ULDSHP.ULDNUM
					       AND LDRSHP.MSTDOCNUM  = ULDSHP.MSTDOCNUM
					       AND LDRSHP.SEQNUM     = ULDSHP.SEQNUM
					       AND LDRSHP.DOCOWRIDR  = ULDSHP.DOCOWRIDR
					       AND LDRSHP.DUPNUM     = ULDSHP.DUPNUM
					       AND LDRSHP.CMPCOD     = ULDSHP.CMPCOD

					         UNION

					        SELECT ULDSHP.CMPCOD
					          FROM OPRTRKULDACP ULDACP,
					         OPRSEGULDSHP ULDSHP
					         WHERE ULDACP.CMPCOD = ULDSHP.CMPCOD
							AND LDRSHP.MSTDOCNUM = ULDSHP.MSTDOCNUM
							AND LDRSHP.SEQNUM = ULDSHP.SEQNUM
							AND LDRSHP.DOCOWRIDR = ULDSHP.DOCOWRIDR
							AND LDRSHP.DUPNUM = ULDSHP.DUPNUM
							AND LDRSHP.CMPCOD = ULDSHP.CMPCOD
						)
					    GROUP BY SHPMST.ORGCOD,
						   SHPMST.DSTCOD,
						   SHPMST.SHPPFX,
						   SHPMST.MSTDOCNUM,
						   SHPMST.STDPCS,
						   SHPMST.STDWGT,
						   SHPMST.STDWGTCOD,
						   SHPMST.SHPNAM,
						   SHPMST.CMPCOD,
						   SHPMST.DOCOWRIDR,
						   SHPMST.DUPNUM,
						   ARPSHP.ACPPCS,
						   ARPSHP.ACPWGT,
						   SHPMST.SEQNUM,
						   SHPMST.EXEFLG,
						   TRKLDR.ACPIDR
				        )Z
				        WHERE Z.SEQNUM = 1
				      AND Z.EXEFLG     = 'Y'
				      AND Z.ACPIDR     = ?
					]]>
			</QRY:Source>
		</QRY:Definition>
	
	<QRY:Definition>
				<QRY:Id>252</QRY:Id>
				<QRY:Source Name="operations.shipment.jto.findcompletelyacceptedldrdetailsforawb" Type="NATIVE">
					<![CDATA[
						 
						  SELECT ORGCOD      ,
						   DSTCOD            ,
						   SHPPFX            ,
						   MSTDOCNUM         ,
						   STDPCS            ,
						   STDWGT            ,
						   STDWGTCOD         ,
						   SEQNUM            ,
						   SHPNAM            ,
						   CMPCOD            ,
						   DOCOWRIDR         ,
						   DUPNUM            ,
						   SHPSTA            ,
						   PCS ACPPCS        ,
						   WGT ACPWGT        ,
						   SUM(TOTPCS) TRKPCS,
						   SUM(TOTWGT) TRKWGT
						    FROM
						   (SELECT SHPMST.ORGCOD    ,
						     SHPMST.DSTCOD          ,
						     SHPMST.SHPPFX          ,
						     SHPMST.MSTDOCNUM       ,
						     SHPMST.STDPCS          ,
						     SHPMST.STDWGT          ,
						     SHPMST.STDWGTCOD       ,
						     SHPMST.SEQNUM          ,
						     SHPMST.SHPNAM          ,
						     SHPMST.CMPCOD          ,
						     SHPMST.DOCOWRIDR       ,
						     SHPMST.DUPNUM          ,
						     SHPMST.SHPSTA          ,
						     ARPSHP.ACPPCS PCS      ,
						     ARPSHP.ACPWGT WGT      ,
						     TRKSHP.TOTACPPCS TOTPCS,
						     TRKSHP.TOTACPWGT TOTWGT
						      FROM OPRARPSHP ARPSHP,
						     OPRTRKSHPACP TRKSHP   ,
						     OPRSHPMST SHPMST
						     WHERE SHPMST.MSTDOCNUM = ARPSHP.MSTDOCNUM
						   AND SHPMST.SEQNUM        = ARPSHP.SEQNUM
						   AND SHPMST.DOCOWRIDR     = ARPSHP.DOCOWRIDR
						   AND SHPMST.DUPNUM        = ARPSHP.DUPNUM
						   AND SHPMST.CMPCOD        = ARPSHP.CMPCOD
						   AND ARPSHP.MSTDOCNUM     = TRKSHP.MSTDOCNUM
						   AND ARPSHP.SEQNUM        = TRKSHP.SEQNUM
						   AND ARPSHP.DOCOWRIDR     = TRKSHP.DOCOWRIDR
						   AND ARPSHP.DUPNUM        = TRKSHP.DUPNUM
						   AND ARPSHP.CMPCOD        = TRKSHP.CMPCOD
						   AND ARPSHP.ARPCOD        = TRKSHP.ARPCOD
						     
						     UNION
						    
						    SELECT SHPMST.ORGCOD ,
						     SHPMST.DSTCOD       ,
						     SHPMST.SHPPFX       ,
						     SHPMST.MSTDOCNUM    ,
						     SHPMST.STDPCS       ,
						     SHPMST.STDWGT       ,
						     SHPMST.STDWGTCOD    ,
						     SHPMST.SEQNUM       ,
						     SHPMST.SHPNAM       ,
						     SHPMST.CMPCOD       ,
						     SHPMST.DOCOWRIDR    ,
						     SHPMST.DUPNUM       ,
						     SHPMST.SHPSTA       ,
						     ARPSHP.ACPPCS       ,
						     ARPSHP.ACPWGT       ,
						     ARPSHP.ACPPCS TRKPCS,
						     ARPSHP.ACPWGT TRKWGT
						      FROM OPRARPSHP ARPSHP     ,   
						     OPRSHPMST SHPMST           ,
						     OPRTRKULDACP ULDACP        ,
						     (SELECT OPRULDSHP.MSTDOCNUM,
						       OPRULDSHP.DOCOWRIDR      ,
						       OPRULDSHP.SEQNUM         ,
						       OPRULDSHP.DUPNUM         ,
						       OPRULDSHP.CMPCOD
						        FROM OPRULDSHP
						       
						       UNION
						      
						      SELECT OPRSEGULDSHP.MSTDOCNUM,
						       OPRSEGULDSHP.DOCOWRIDR      ,
						       OPRSEGULDSHP.SEQNUM         ,
						       OPRSEGULDSHP.DUPNUM         ,
						       OPRSEGULDSHP.CMPCOD
						        FROM OPRSEGULDSHP
						     )ULDVAL
						     WHERE SHPMST.MSTDOCNUM = ULDVAL.MSTDOCNUM
						   AND SHPMST.SEQNUM        = ULDVAL.SEQNUM
						   AND SHPMST.DOCOWRIDR     = ULDVAL.DOCOWRIDR
						   AND SHPMST.DUPNUM        = ULDVAL.DUPNUM
						   AND SHPMST.CMPCOD        = ULDVAL.CMPCOD
						   AND ARPSHP.MSTDOCNUM     = ULDVAL.MSTDOCNUM
						   AND ARPSHP.SEQNUM        = ULDVAL.SEQNUM
						   AND ARPSHP.DOCOWRIDR     = ULDVAL.DOCOWRIDR
						   AND ARPSHP.DUPNUM        = ULDVAL.DUPNUM
						   AND ARPSHP.CMPCOD        = ULDVAL.CMPCOD
						   AND ARPSHP.CMPCOD        = ULDACP.CMPCOD
						   )Z
						   WHERE Z.MSTDOCNUM = ?
						 AND Z.CMPCOD        = ?
						 AND Z.SEQNUM        = ?
						 AND Z.DOCOWRIDR     = ?
						 AND Z.DUPNUM        = ?
						 GROUP BY ORGCOD ,
						   DSTCOD        ,
						   SHPPFX        ,
						   MSTDOCNUM     ,
						   STDPCS        ,
						   STDWGT        ,
						   STDWGTCOD     ,
						   SEQNUM        ,
						   SHPNAM        ,
						   CMPCOD        ,
						   DOCOWRIDR     ,
						   DUPNUM        ,
						   SHPSTA        ,
						   PCS           ,
  						   WGT
						  
						]]>
				</QRY:Source>
		</QRY:Definition>
		
		 <QRY:Definition>
    <QRY:Id>253</QRY:Id>
    <QRY:Source Name="operations.shipment.jto.findldrshipmentdetailsforLDR" Type="NATIVE">
      <![CDATA[

  				 SELECT  LDRSHP.CMPCOD   ,
				  LDRSHP.LDRNUM   ,
				  LDRSHP.SHPSERNUM,
				  LDRSHP.SEQNUM   ,
				  LDRSHP.MSTDOCNUM,
				  LDRSHP.DOCOWRIDR,
				  LDRSHP.DUPNUM   ,
				  LDRSHP.LDRPCS   ,
				  LDRSHP.LDRWGT   ,
				  LDRSHP.NCSPCS   ,
				  LDRSHP.NCSWGT   ,
				  LDRSHP.RMK      ,
				  LDRSHP.DOCNUM   ,
				  LDRSHP.BIISTA   ,
				  LDRSHP.BILSTA   	,
				  LDRSHP.DSTCOD		,
	  			   LDRSHP.SCCCOD
				 FROM OPRLDRSHP LDRSHP
				  WHERE LDRSHP.CMPCOD    = ?
      ]]>
    </QRY:Source>
  </QRY:Definition>
  
  <QRY:Definition>
      <QRY:Id>254</QRY:Id>
      <QRY:Source Name="operations.shipment.jto.findacceptancetruckkdetails" Type="NATIVE">
        <![CDATA[
	       SELECT DTL.ACPIDR,DTL.CMPCOD,DTL.ETYPAS,DTL.TRKNUM, DTL.PRPVST, LDR.LDRFLT,
		 LDR.LDRNUM,LDR.URGFLG, DTL.INDFLG,
		 DTL.LSTUPDTIM, DTL.LSTUPDUSR,LDR.ACPFLG, DRVDTL.DRVNAM, DRVDTL.DRVLIC, DRVDTL.SEQNUM
	         FROM OPRTRKLDR LDR, OPRACPTRKDTL DTL, OPRACPTRKDRVDTL DRVDTL
		 WHERE LDR.ACPIDR(+) = DTL.ACPIDR
		 AND LDR.CMPCOD(+) = DTL.CMPCOD
		 AND DTL.ACPIDR = DRVDTL.ACPIDR(+)
		 AND DTL.CMPCOD = DRVDTL.CMPCOD(+)
		 AND DTL.CMPCOD = ?
		 AND DTL.ACPIDR = ?
		 AND DTL.ARPCOD = ?
        ]]>
      </QRY:Source>
    </QRY:Definition>
    
    <QRY:Definition>
    <QRY:Id>255</QRY:Id>
    <QRY:Source Name="operations.shipment.jto.findtruckacceptancedetailsshipments" Type="NATIVE">
      <![CDATA[
            SELECT TRKDTL.ACPIDR ,LDRDTL.ULDNUM DTLULDNUM,
	      TRKDTL.PRPVST       ,ULDACP.ULDNUM ACPULDNUM,ULDACP.ULDRMK,
	      TRKDTL.ARPCOD       ,LDRSHP.LDRNUM,ULDACP.ACPIDR ULDACPIDR,
	      LDRSHP.CMPCOD       ,SHPMST.CONFLG,
	      SHPACP.TOTACPPCS    ,
	      SHPACP.TOTACPWGT    ,
	      LDRSHP.MSTDOCNUM    ,SHPMST.SHPPFX,
	      SHPMST.SEQNUM       ,
	      LDRSHP.DOCNUM       ,SHPMST.DSTCOD DST,
	      LDRSHP.DOCOWRIDR    ,SHPMST.STDPCS,SHPMST.STDWGT,
	      LDRSHP.DUPNUM       ,
	      SCC.SCCCOD          , SHPMST.SCCCOD MSTSCC,
	      SCC.SCCPRY          ,
	      ARPSHP.ETDPCS 	,
	      ARPSHP.MSTAWBCHKFLG ,
	      LDRSHP.RMK          , SHPACP.RMK ACPRMK, SHPACP.LSTUPDTIM, SHPACP.LSTUPDUSR,
	      LDRSHP.LDRPCS       ,
	      SHPMST.SRCIND       ,
	      SHPMST.PARSEQNUM    ,
	      SHPMST.SHPDES       ,
	      LDRSHP.LDRWGT       ,
	      LDRSHP.NCSPCS       ,
	      LDRSHP.NCSWGT, ETDFLT.FBLPCS, ETDFLT.ETDFLTFLG,
              ACPDTL.ACPIDR ACPDTLIDR,
              ACPDTL.ACPPCS ACPDTLPCS,
              ACPDTL.ACPWGT ACPDTLWGT,
              ACPDTL.ACPVOL ACPDTLVOL,
              ACPDTL.ACPDISWGT
	       FROM OPRACPTRKDTL TRKDTL,
	      OPRTRKLDR TRKLDR         ,
	      OPRLDRSHP LDRSHP         ,
	      OPRTRKULDACP ULDACP      ,
	      OPRSHPMST SHPMST         ,
	      OPRSHPSCC SCC            ,
		   OPRTRKSHPACP SHPACP      ,
	      OPRARPSHP ARPSHP  ,
	      OPRLDRDTL LDRDTL, (
	      SELECT 	  	LODPLN.MSTDOCNUM,
	    			LODPLN.DOCOWRIDR      ,
	    			LODPLN.DUPNUM         ,
	    			LODPLN.SEQNUM         ,
	    			SUM( LODPLN.BKGPCS )  FBLPCS,
	    			SUM(
	    			CASE
	    				WHEN TSAFLT.CMPCOD IS NOT NULL
	    				THEN 1
	    				ELSE 0
	    			END ) ETDFLTFLG
	    FROM 		OPRLODPLNBKGSUM LODPLN JOIN FLTOPRMST FLTMST
	    			ON( LODPLN.FLTNUM = FLTMST.FLTNUM
	    				AND LODPLN.FLTCARIDR   = FLTMST.FLTCARIDR
	    				AND LODPLN.FLTSEQNUM   = FLTMST.FLTSEQNUM
	    				AND LODPLN.CMPCOD      = FLTMST.CMPCOD )
	    		JOIN SHRSYSPAR SYSPAR
	    			ON(
	    				SYSPAR.CMPCOD = FLTMST.CMPCOD
	    				AND SYSPAR.PARCOD = 'flight.schedule.calendardateoffset' )
	    		LEFT OUTER JOIN OPRTSAFLT TSAFLT
	    			ON( TSAFLT.FLTCARIDR  = FLTMST.FLTCARIDR
	    				AND TSAFLT.FLTNUM = FLTMST.FLTNUM
	    				AND TSAFLT.CMPCOD = FLTMST.CMPCOD
	    				AND TSAFLT.FLTFRQ  LIKE '%'
	    				  || TO_CHAR( FLTMST.FLTDAT - SYSPAR.PARVAL, 'D' )
	    				  ||'%'
	    				AND FLTMST.FLTDAT BETWEEN nvl( TSAFLT.STRDAT,FLTMST.FLTDAT )  AND nvl( TSAFLT.ENDDAT,FLTMST.FLTDAT )  )
	    GROUP BY	  LODPLN.MSTDOCNUM,
	    		  LODPLN.DOCOWRIDR       ,
	    		  LODPLN.DUPNUM          ,
	    		  LODPLN.SEQNUM
	      ) ETDFLT,
        OPRSHPACPDTL ACPDTL

	      WHERE TRKDTL.CMPCOD = TRKLDR.CMPCOD
	    AND TRKDTL.ACPIDR     = TRKLDR.ACPIDR

	    AND TRKLDR.CMPCOD     = LDRDTL.CMPCOD
	    AND TRKLDR.LDRNUM     = LDRDTL.LDRNUM

	    AND LDRDTL.CMPCOD     = LDRSHP.CMPCOD
	    AND LDRDTL.LDRNUM     = LDRSHP.LDRNUM

	    AND LDRDTL.CMPCOD     = ULDACP.CMPCOD(+)
	    AND LDRDTL.ULDNUM     = ULDACP.ULDNUM(+)

	    AND LDRSHP.CMPCOD     = SHPACP.CMPCOD(+)
	    AND LDRSHP.DOCOWRIDR  = SHPACP.DOCOWRIDR(+)
	    AND LDRSHP.DUPNUM     = SHPACP.DUPNUM(+)
	    AND LDRSHP.MSTDOCNUM  = SHPACP.MSTDOCNUM(+)
	    AND LDRSHP.SEQNUM     = SHPACP.SEQNUM(+)

	    AND LDRSHP.CMPCOD     = SHPMST.CMPCOD(+)
	    AND LDRSHP.MSTDOCNUM  = SHPMST.MSTDOCNUM(+)
	    AND LDRSHP.SEQNUM     = SHPMST.SEQNUM(+)
	    AND LDRSHP.DUPNUM     = SHPMST.DUPNUM(+)
	    AND LDRSHP.DOCOWRIDR  = SHPMST.DOCOWRIDR(+)

      AND LDRSHP.CMPCOD     = ACPDTL.CMPCOD(+)
	    AND LDRSHP.DOCOWRIDR  = ACPDTL.DOCOWRIDR(+)
	    AND LDRSHP.DUPNUM     = ACPDTL.DUPNUM(+)
	    AND LDRSHP.MSTDOCNUM  = ACPDTL.MSTDOCNUM(+)
	    AND LDRSHP.SEQNUM     = ACPDTL.SEQNUM(+)

	    AND LDRSHP.MSTDOCNUM  = ETDFLT.MSTDOCNUM(+)
	    AND LDRSHP.SEQNUM     = ETDFLT.SEQNUM(+)
	    AND LDRSHP.DUPNUM     = ETDFLT.DUPNUM(+)
	    AND LDRSHP.DOCOWRIDR  = ETDFLT.DOCOWRIDR(+)

	    AND LDRSHP.CMPCOD     = ARPSHP.CMPCOD(+)
	    AND LDRSHP.MSTDOCNUM  = ARPSHP.MSTDOCNUM(+)
	    AND LDRSHP.SEQNUM     = ARPSHP.SEQNUM(+)
	    AND LDRSHP.DUPNUM     = ARPSHP.DUPNUM(+)
	    AND LDRSHP.DOCOWRIDR  = ARPSHP.DOCOWRIDR(+)
	    AND LDRSHP.CMPCOD     = SCC.CMPCOD(+)
	    AND LDRSHP.MSTDOCNUM  = SCC.MSTDOCNUM(+)
	    AND LDRSHP.SEQNUM     = SCC.SEQNUM(+)
	    AND LDRSHP.DUPNUM     = SCC.DUPNUM(+)
	    AND LDRSHP.DOCOWRIDR  = SCC.DOCOWRIDR(+)
	    AND SHPACP.ACPIDR(+)  =	?
		AND ULDACP.ACPIDR(+) = ?
	    AND TRKDTL.ACPIDR     =?
	    AND TRKDTL.CMPCOD     = ?
	    AND TRKDTL.ARPCOD     = ?
		  AND LDRDTL.ULDNUM IS NULL
	    ORDER BY LDRSHP.MSTDOCNUM,
  	    LDRSHP.SEQNUM

          ]]>
    </QRY:Source>
  </QRY:Definition>
  
  <QRY:Definition>
    <QRY:Id>256</QRY:Id>
    <QRY:Source Name="operations.shipment.jto.findtruckacceptancedetailsulds" Type="NATIVE">
      <![CDATA[
            SELECT TRKDTL.ACPIDR ,LDRDTL.ULDNUM DTLULDNUM,
	      TRKDTL.PRPVST       ,ULDACP.ULDNUM ACPULDNUM,ULDACP.ULDRMK,
	      TRKDTL.ARPCOD       ,LDRSHP.LDRNUM,ULDACP.ACPIDR ULDACPIDR,
	      LDRSHP.CMPCOD       ,SHPMST.CONFLG,
	      SHPACP.TOTACPPCS    ,
	      SHPACP.TOTACPWGT    ,
	      LDRSHP.MSTDOCNUM    ,SHPMST.SHPPFX,
	      SHPMST.SEQNUM       ,
	      LDRSHP.DOCNUM       ,SHPMST.DSTCOD DST,
	      LDRSHP.DOCOWRIDR    ,SHPMST.STDPCS,SHPMST.STDWGT,
	      LDRSHP.DUPNUM       ,
	      SHPMST.SCCCOD MSTSCC,	      
	      ARPSHP.ETDPCS 	,
	      ARPSHP.MSTAWBCHKFLG ,
	      LDRSHP.RMK          , SHPACP.RMK ACPRMK, SHPACP.LSTUPDTIM, SHPACP.LSTUPDUSR,
	      LDRSHP.LDRPCS       ,
	      SHPMST.SRCIND       ,
	      SHPMST.PARSEQNUM    ,
	      SHPMST.SHPDES       ,
	      LDRSHP.LDRWGT       ,
	      LDRSHP.NCSPCS       ,
	      LDRSHP.NCSWGT, ETDFLT.FBLPCS, ETDFLT.ETDFLTFLG,
              ACPDTL.ACPIDR ACPDTLIDR,
              ACPDTL.ACPPCS ACPDTLPCS,
              ACPDTL.ACPWGT ACPDTLWGT,
              ACPDTL.ACPVOL ACPDTLVOL,
              ACPDTL.ACPDISWGT
	       FROM OPRACPTRKDTL TRKDTL,
	      OPRTRKLDR TRKLDR         ,
	      OPRLDRSHP LDRSHP         ,
	      OPRTRKULDACP ULDACP      ,
	      OPRSHPMST SHPMST         ,
		   OPRTRKSHPACP SHPACP      ,
	      OPRARPSHP ARPSHP  ,
	      OPRLDRDTL LDRDTL, (
	      SELECT 	  	LODPLN.MSTDOCNUM,
	    			LODPLN.DOCOWRIDR      ,
	    			LODPLN.DUPNUM         ,
	    			LODPLN.SEQNUM         ,
	    			SUM( LODPLN.BKGPCS )  FBLPCS,
	    			SUM(
	    			CASE
	    				WHEN TSAFLT.CMPCOD IS NOT NULL
	    				THEN 1
	    				ELSE 0
	    			END ) ETDFLTFLG
	    FROM 		OPRLODPLNBKGSUM LODPLN JOIN FLTOPRMST FLTMST
	    			ON( LODPLN.FLTNUM = FLTMST.FLTNUM
	    				AND LODPLN.FLTCARIDR   = FLTMST.FLTCARIDR
	    				AND LODPLN.FLTSEQNUM   = FLTMST.FLTSEQNUM
	    				AND LODPLN.CMPCOD      = FLTMST.CMPCOD )
	    		JOIN SHRSYSPAR SYSPAR
	    			ON(
	    				SYSPAR.CMPCOD = FLTMST.CMPCOD
	    				AND SYSPAR.PARCOD = 'flight.schedule.calendardateoffset' )
	    		LEFT OUTER JOIN OPRTSAFLT TSAFLT
	    			ON( TSAFLT.FLTCARIDR  = FLTMST.FLTCARIDR
	    				AND TSAFLT.FLTNUM = FLTMST.FLTNUM
	    				AND TSAFLT.CMPCOD = FLTMST.CMPCOD
	    				AND TSAFLT.FLTFRQ  LIKE '%'
	    				  || TO_CHAR( FLTMST.FLTDAT - SYSPAR.PARVAL, 'D' )
	    				  ||'%'
	    				AND FLTMST.FLTDAT BETWEEN nvl( TSAFLT.STRDAT,FLTMST.FLTDAT )  AND nvl( TSAFLT.ENDDAT,FLTMST.FLTDAT )  )
	    GROUP BY	  LODPLN.MSTDOCNUM,
	    		  LODPLN.DOCOWRIDR       ,
	    		  LODPLN.DUPNUM          ,
	    		  LODPLN.SEQNUM
	      ) ETDFLT,
        OPRSHPACPDTL ACPDTL

	      WHERE TRKDTL.CMPCOD = TRKLDR.CMPCOD
	    AND TRKDTL.ACPIDR     = TRKLDR.ACPIDR

	    AND TRKLDR.CMPCOD     = LDRDTL.CMPCOD
	    AND TRKLDR.LDRNUM     = LDRDTL.LDRNUM

	    AND LDRDTL.CMPCOD     = LDRSHP.CMPCOD
	    AND LDRDTL.LDRNUM     = LDRSHP.LDRNUM

	    AND LDRDTL.CMPCOD     = ULDACP.CMPCOD(+)
	    AND LDRDTL.ULDNUM     = ULDACP.ULDNUM(+)

	    AND LDRSHP.CMPCOD     = SHPACP.CMPCOD(+)
	    AND LDRSHP.DOCOWRIDR  = SHPACP.DOCOWRIDR(+)
	    AND LDRSHP.DUPNUM     = SHPACP.DUPNUM(+)
	    AND LDRSHP.MSTDOCNUM  = SHPACP.MSTDOCNUM(+)
	    AND LDRSHP.SEQNUM     = SHPACP.SEQNUM(+)

	    AND LDRSHP.CMPCOD     = SHPMST.CMPCOD(+)
	    AND LDRSHP.MSTDOCNUM  = SHPMST.MSTDOCNUM(+)
	    AND LDRSHP.SEQNUM     = SHPMST.SEQNUM(+)
	    AND LDRSHP.DUPNUM     = SHPMST.DUPNUM(+)
	    AND LDRSHP.DOCOWRIDR  = SHPMST.DOCOWRIDR(+)

      AND LDRSHP.CMPCOD     = ACPDTL.CMPCOD(+)
	    AND LDRSHP.DOCOWRIDR  = ACPDTL.DOCOWRIDR(+)
	    AND LDRSHP.DUPNUM     = ACPDTL.DUPNUM(+)
	    AND LDRSHP.MSTDOCNUM  = ACPDTL.MSTDOCNUM(+)
	    AND LDRSHP.SEQNUM     = ACPDTL.SEQNUM(+)

	    AND LDRSHP.MSTDOCNUM  = ETDFLT.MSTDOCNUM(+)
	    AND LDRSHP.SEQNUM     = ETDFLT.SEQNUM(+)
	    AND LDRSHP.DUPNUM     = ETDFLT.DUPNUM(+)
	    AND LDRSHP.DOCOWRIDR  = ETDFLT.DOCOWRIDR(+)

	    AND LDRSHP.CMPCOD     = ARPSHP.CMPCOD(+)
	    AND LDRSHP.MSTDOCNUM  = ARPSHP.MSTDOCNUM(+)
	    AND LDRSHP.SEQNUM     = ARPSHP.SEQNUM(+)
	    AND LDRSHP.DUPNUM     = ARPSHP.DUPNUM(+)
	    AND LDRSHP.DOCOWRIDR  = ARPSHP.DOCOWRIDR(+)
	    AND SHPACP.ACPIDR(+)  =	?
		AND ULDACP.ACPIDR(+) = ?
	    AND TRKDTL.ACPIDR     =?
	    AND TRKDTL.CMPCOD     = ?
	    AND TRKDTL.ARPCOD     = ?
		  AND LDRDTL.ULDNUM IS NOT NULL
	    ORDER BY LDRDTL.ULDNUM

          ]]>
    </QRY:Source>
  </QRY:Definition>
  
   <QRY:Definition>
	<QRY:Id>257</QRY:Id>
	<QRY:Source Name="operations.shipment.jto.findtruckldrdetails" Type="NATIVE">
	  <![CDATA[
	   SELECT LDRSHP.CMPCOD ,
		  LDRSHP.LDRNUM       ,
		  LDRSHP.MSTDOCNUM    ,
		  LDRSHP.SEQNUM       ,
		  LDRSHP.DUPNUM       ,
		  LDRSHP.DOCOWRIDR    ,
		  LDRSHP.DOCNUM       ,
		  LDRSHP.LDRPCS       ,
		  LDRSHP.LDRWGT       ,
		  LDRSHP.ACPPCS       ,
		  LDRSHP.NCSPCS       ,
		  LDRSHP.NCSWGT       ,
		  LDRSHP.RMK          ,
		  LDRSHP.SHPSERNUM    ,
		  LDRSHP.DSTCOD       ,
		  LDRSHP.SCCCOD       ,
		  LDRSHP.BILSTA       ,
		  LDRSHP.BIISTA       ,
		  ARPSHP.MSTAWBCHKFLG ,
		  SHPMST.CONFLG
		   FROM OPRTRKLDR TRKLDR ,
		  OPRLDRDTL LDRDTL       ,
		  OPRLDRSHP LDRSHP       ,
		  OPRARPSHP ARPSHP       ,
		  OPRSHPMST SHPMST
		  WHERE TRKLDR.CMPCOD =LDRDTL.CMPCOD
		AND TRKLDR.LDRNUM     = LDRDTL.LDRNUM
		AND LDRDTL.CMPCOD     =LDRSHP.CMPCOD
		AND LDRDTL.LDRNUM     =LDRSHP.LDRNUM
		AND LDRSHP.CMPCOD     = ARPSHP.CMPCOD(+)
		AND LDRSHP.MSTDOCNUM  = ARPSHP.MSTDOCNUM(+)
		AND LDRSHP.DUPNUM     = ARPSHP.DUPNUM(+)
		AND LDRSHP.DOCOWRIDR  = ARPSHP.DOCOWRIDR(+)
		AND LDRSHP.CMPCOD     = SHPMST.CMPCOD
		AND LDRSHP.MSTDOCNUM  = SHPMST.MSTDOCNUM
		AND LDRSHP.DUPNUM     = SHPMST.DUPNUM
		AND LDRSHP.SEQNUM     = SHPMST.SEQNUM
		AND LDRSHP.DOCOWRIDR  = SHPMST.DOCOWRIDR
		AND ARPSHP.ARPCOD(+)    = ?
		AND TRKLDR.ACPIDR     = ?
		AND TRKLDR.CMPCOD = ?
                AND LDRDTL.ULDNUM IS NULL
		ORDER BY LDRSHP.LDRNUM ,
		  LDRSHP.CMPCOD        ,
		  LDRSHP.MSTDOCNUM     ,
		  LDRSHP.DOCOWRIDR     ,
		  LDRSHP.DUPNUM        ,
		  LDRSHP.SEQNUM
        	  ]]>
            </QRY:Source>
  </QRY:Definition>
  <QRY:Definition>
		<QRY:Id>258</QRY:Id>
		<QRY:Source Name="operations.shipment.jto.truckacceptance.findacceptancereceiptdetails" Type="NATIVE">
			<![CDATA[
						 SELECT shpacp.acpidr, shpacp.rmk,
  								trkldr.ldrnum,uldacp.uldnum acpuldnum,
								  trkdtl.acpusr,
								  trkdtl.acptim,
								  ldrdtl.frmwhs,
								  ldrdtl.dstwhs,
								  ldrdtl.prt,
								  ldrdtl.rcvtim,
								  trkdtl.trknum,
								  trkdtl.acpsta,
								  shpmst.scccod mstscccod,
								  ldrdtl.uldnum,
								  ldrshp.mstdocnum,
								  ldrshp.cmpcod,
								  ldrshp.docnum,
								  ldrshp.dupnum,
								  ldrshp.seqnum,
								  ldrshp.docowridr,
								  ldrshp.ldrpcs,
								  ldrshp.ldrwgt,
								  shpacp.totacppcs,
								  shpacp.totacpwgt,
								  shpmst.dstcod,
								  shpmst.shppfx,
								  dmgdis.dmgcod,dmgdis.casnum,dmgdis.rmk dmgrmk,
								  trkd.drvnam,
								  trkdtl.arpcod,
								  uldacp.uldrmk,
								  arpshp.mstawbchkflg,
								  shpmst.conflg
								FROM opracptrkdtl trkdtl,
								  oprtrkldr trkldr,
								  oprldrdtl ldrdtl,
								  oprldrshp ldrshp,
								  oprtrkshpacp shpacp,
								  oprshpmst shpmst,
								  oprdmgdis dmgdis,
								  oprtrkuldacp uldacp,
								  oprarpshp arpshp  ,
								  (SELECT cmpcod ,
									acpidr       ,
									arpcod       ,
									LTRIM( SYS_CONNECT_BY_PATH( drvnam, ' , ' ), ' , ' ) drvnam
									 FROM
									(SELECT cmpcod,
									  acpidr      ,
									  arpcod      ,
									  drvnam      ,
									  ROW_NUMBER( ) OVER( PARTITION BY cmpcod, acpidr, arpcod  ORDER BY drvnam ) RNM
									   FROM
									  (SELECT cmpcod,
										acpidr      ,
										arpcod      ,
										drvnam
										 FROM opracptrkdrvdtl
									  )
									)
									WHERE CONNECT_BY_ISLEAF = 1 CONNECT BY PRIOR cmpcod =cmpcod
									and PRIOR acpidr =acpidr
									and PRIOR arpcod =arpcod

								  AND PRIOR RNM = RNM - 1 START
								  WITH RNM      = 1
								  ) trkd
								WHERE trkdtl.cmpcod = trkldr.cmpcod
								 AND trkdtl.acpidr = trkldr.acpidr
								 AND trkldr.cmpcod = ldrdtl.cmpcod
								 AND trkldr.ldrnum = ldrdtl.ldrnum
								 AND ldrdtl.cmpcod = ldrshp.cmpcod
								 AND ldrdtl.ldrnum = ldrshp.ldrnum
								 AND ldrshp.cmpcod = shpacp.cmpcod(+)
								 AND ldrshp.mstdocnum = shpacp.mstdocnum(+)
								 AND ldrshp.docowridr = shpacp.docowridr(+)
								 AND ldrshp.seqnum = shpacp.seqnum(+)
								 AND ldrshp.dupnum = shpacp.dupnum(+)
								 AND ldrshp.mstdocnum = shpmst.mstdocnum
								 AND ldrshp.cmpcod = shpmst.cmpcod
								 AND ldrshp.seqnum = shpmst.seqnum
								 AND ldrshp.dupnum = shpmst.dupnum
								 AND ldrshp.docowridr = shpmst.docowridr
								 AND shpmst.cmpcod = dmgdis.cmpcod(+)
								 AND shpmst.mstdocnum = dmgdis.mstdocnum(+)
								 AND shpmst.seqnum = dmgdis.seqnum(+)
								 AND shpmst.dupnum = dmgdis.dupnum(+)
								 AND shpmst.docowridr = dmgdis.docowridr(+)
								 AND trkdtl.cmpcod    = trkd.cmpcod(+)
								 AND trkdtl.acpidr    = trkd.acpidr(+)
								 AND trkdtl.arpcod    = trkd.arpcod(+)
								 AND ldrdtl.uldnum = uldacp.uldnum(+)
         						 AND ldrdtl.cmpcod = uldacp.cmpcod(+)
								 AND ldrshp.cmpcod     = arpshp.cmpcod(+)
        						 AND ldrshp.mstdocnum  = arpshp.mstdocnum(+)
								 AND ldrshp.seqnum     = arpshp.seqnum(+)
								 AND ldrshp.dupnum     = arpshp.dupnum(+)
								 AND ldrshp.docowridr  = arpshp.docowridr(+)
								 AND trkdtl.cmpcod = ?
								 AND trkdtl.arpcod = ?
								 AND trkdtl.acpidr = ?
								 AND shpacp.arpcod(+) = ?
								 AND shpacp.acpidr(+) = ?
								ORDER BY ldrshp.ldrnum,ldrshp.mstdocnum,ldrshp.docowridr,
                                    					ldrshp.dupnum,ldrshp.seqnum



					]]>
		</QRY:Source>
	</QRY:Definition>
  
	<QRY:Definition>
  	<QRY:Id>259</QRY:Id>
  	<QRY:Source Name="operations.shipment.jto.isldrcompletelyacceptedintruck" Type="NATIVE">
  	  <![CDATA[
  	    SELECT /* SUM(LDRSHP.ACPPCS) , SUM(LDRSHP.LDRPCS), */
  		  CASE
  			WHEN SUM(LDRSHP.ACPPCS) = SUM(LDRSHP.LDRPCS)
  			THEN 'Y'
  			ELSE 'N'
  		  END SNTBILFLG
  		   FROM OPRLDRDTL LDRDTL,
  		  OPRLDRSHP LDRSHP      ,
  		  OPRTRKLDR TRKLDR      ,
  		  OPRARPSHP ARPSHP      ,
  		  OPRSHPMST SHPMST
  		  WHERE TRKLDR.CMPCOD =LDRDTL.CMPCOD
  		AND TRKLDR.LDRNUM     = LDRDTL.LDRNUM
  		AND LDRDTL.CMPCOD     = LDRSHP.CMPCOD
  		AND LDRDTL.LDRNUM     = LDRSHP.LDRNUM
  		AND LDRSHP.CMPCOD     = SHPMST.CMPCOD
  		AND LDRSHP.MSTDOCNUM  = SHPMST.MSTDOCNUM
  		AND LDRSHP.DOCOWRIDR  = SHPMST.DOCOWRIDR
  		AND LDRSHP.DUPNUM     = SHPMST.DUPNUM
  		AND LDRSHP.SEQNUM     = SHPMST.SEQNUM
  		AND SHPMST.CMPCOD     = ARPSHP.CMPCOD (+)
  		AND SHPMST.MSTDOCNUM  = ARPSHP.MSTDOCNUM(+)
  		AND SHPMST.DOCOWRIDR  = ARPSHP.DOCOWRIDR(+)
  		AND SHPMST.DUPNUM     = ARPSHP.DUPNUM(+)
  		AND LDRSHP.CMPCOD
  		  ||'-'
  		  ||LDRSHP.MSTDOCNUM
  		  ||'-'
  		  ||LDRSHP.DOCOWRIDR
  		  ||'-'
  		  ||LDRSHP.DUPNUM
		  ||'-'
		  ||LDRSHP.SEQNUM IN
  		  (SELECT CMPCOD
  			||'-'
  			||MSTDOCNUM
  			||'-'
  			||DOCOWRIDR
  			||'-'
  			||DUPNUM
			||'-'
			||LDRSHP.SEQNUM AS MSTAWB
  			 FROM OPRLDRSHP LDRSHP
  			WHERE LDRSHP.CMPCOD= ?
  		  AND LDRSHP.LDRNUM    = ?
  		 GROUP BY LDRSHP.LDRNUM,
  			LDRSHP.CMPCOD      ,
  			LDRSHP.MSTDOCNUM   ,
  			LDRSHP.DOCOWRIDR   ,
  			LDRSHP.DUPNUM,LDRSHP.SEQNUM
  		  )
  		AND TRKLDR.ACPIDR                   = ?
  		AND LDRDTL.CMPCOD                   = ?
  		AND ((NVL(ARPSHP.MSTAWBCHKFLG, 'N') = 'Y'
  		AND SHPMST.SEQNUM                   = 1)
  		OR ((NVL(SHPMST.CONFLG, 'N')        = 'N')
		AND (NVL(ARPSHP.MSTAWBCHKFLG, 'N') <> 'Y')))
			AND LDRDTL.ULDNUM IS NULL

            ]]>
      </QRY:Source>
  	</QRY:Definition>
  	
  	<QRY:Definition>
		<QRY:Id>260</QRY:Id>
		<QRY:Source Name="operations.shipment.jto.findbil01detailsforexport" Type="NATIVE">
		  <![CDATA[

		  	 SELECT LDRSHP.CMPCOD,
				  LDRSHP.LDRNUM      ,
				  LDRSHP.SHPSERNUM   ,
				  SHPMST.SHPPFX      ,
				  LDRSHP.MSTDOCNUM   ,
				  LDRSHP.DOCOWRIDR   ,
				  LDRSHP.SEQNUM      ,
				  LDRSHP.DUPNUM      ,
				  LDRSHP.DOCNUM      ,
				  LDRSHP.DSTCOD      ,
				  LDRSHP.ACPPCS      ,
				  LDRSHP.LDRPCS      ,
				  LDRSHP.LDRWGT      ,
				  LDRSHP.NCSPCS      ,
				  LDRSHP.NCSWGT      ,
				  LDRSHP.SCCCOD      ,
				  LDRSHP.RMK         ,
				  LDRDTL.SRC
				   FROM OPRLDRSHP LDRSHP ,
				  OPRLDRDTL LDRDTL       ,
				  OPRSHPMST SHPMST
				  WHERE LDRDTL.CMPCOD =LDRSHP.CMPCOD
				AND LDRDTL.LDRNUM     = LDRSHP.LDRNUM
				AND LDRSHP.CMPCOD     =SHPMST.CMPCOD
				AND LDRSHP.MSTDOCNUM  =SHPMST.MSTDOCNUM
				AND LDRSHP.DOCOWRIDR  =SHPMST.DOCOWRIDR
				AND LDRSHP.DUPNUM     =SHPMST.DUPNUM
				AND LDRSHP.SEQNUM     =SHPMST.SEQNUM
				AND NVL(LDRSHP.BILSTA, 'N' ) <> 'S'
				AND NVL(LDRSHP.BILSTA, 'N' ) <> 'Y'
				and LDRDTL.CMPCOD = ?
		]]>
		</QRY:Source>
		</QRY:Definition><QRY:Definition>
  	<QRY:Id>261</QRY:Id>
  	<QRY:Source Name="operations.shipment.jto.findbildetailsforexport" Type="NATIVE">
  	  <![CDATA[

  		  SELECT TRKLDR.CMPCOD,
  		   	TRKLDR.LDRNUM,
  		   	TRKULD.ULDNUM,LDRDTL.ACPTIM,LDRDTL.BILBIISTA
  		    FROM OPRTRKLDR TRKLDR,
  		  	 OPRTRKULDACP TRKULD,
  		   	 OPRLDRDTL LDRDTL
  		   WHERE TRKLDR.CMPCOD = TRKULD.CMPCOD
  		 AND TRKLDR.ACPIDR = TRKULD.ACPIDR
  		 AND TRKLDR.CMPCOD = LDRDTL.CMPCOD
  		 AND TRKLDR.LDRNUM = LDRDTL.LDRNUM
  		 AND LDRDTL.ULDNUM IS NOT NULL
  		 AND TRKULD.ULDNUM = LDRDTL.ULDNUM
		 AND ( NVL( LDRDTL.BILBIISTA,'E' ) = 'E' OR NVL( LDRDTL.BILBIISTA,'F') = 'F')
  		 AND TRKLDR.CMPCOD = ?
  		 AND TRKLDR.ACPIDR = ?

  	]]>
  	</QRY:Source>
</QRY:Definition>  	

 <QRY:Definition>
  <QRY:Id>262</QRY:Id>
  <QRY:Source Name="operations.shipment.findmastershipment" Type="NATIVE">
    <![CDATA[

      SELECT MST.CMPCOD, MST.DOCOWRIDR, MST.MSTDOCNUM,
         MST.DUPNUM, MST.PARSEQNUM, MSTSHP.STDPCS,
         MSTSHP.STDWGT, ARPSHP.RCVPCS, ARPSHP.RCVWGT, ARPSHP.MSTAWBCHKFLG
      FROM OPRSHPMST MST,OPRARPSHP ARP, OPRSHPMST MSTSHP,  OPRARPSHP ARPSHP

      WHERE MST.MSTDOCNUM = ARP.MSTDOCNUM

         AND MST.DOCOWRIDR = ARP.DOCOWRIDR
         AND MST.DUPNUM = ARP.DUPNUM
         AND MST.SEQNUM = ARP.SEQNUM
         AND MST.CMPCOD = ARP.CMPCOD

         AND MSTSHP.CMPCOD = MST.CMPCOD
         AND MSTSHP.MSTDOCNUM = MST.MSTDOCNUM
         AND MSTSHP.DOCOWRIDR = MST.DOCOWRIDR
         AND MSTSHP.DUPNUM = MST.DUPNUM
         AND MSTSHP.SEQNUM = 1

         AND ARPSHP.CMPCOD = ARP.CMPCOD
         AND ARPSHP.MSTDOCNUM = ARP.MSTDOCNUM
         AND ARPSHP.DOCOWRIDR = ARP.DOCOWRIDR
         AND ARPSHP.DUPNUM = ARP.DUPNUM
         AND ARPSHP.ARPCOD = ARP.ARPCOD
         AND ARPSHP.SEQNUM = 1
         AND ARP.MSTDOCNUM = ?
         AND ARP.DOCOWRIDR = ?
         AND ARP.DUPNUM = ?
         AND ARP.SEQNUM = ?
         AND ARP.CMPCOD = ?
         AND ARP.ARPCOD = ?

    ]]>
  </QRY:Source>
  </QRY:Definition>


<QRY:Definition>
      <QRY:Id>263</QRY:Id>
      <QRY:Source Name="operations.shipment.jto.findskiddamagedetailsforhht" Type="NATIVE">
        <![CDATA[

            SELECT FLTSEG.FLTCARIDR, FLTSEG.FLTNUM, FLTSEG.FLTSEQNUM, FLTSEG.SEGSERNUM,
                FLTSEG.CMPCOD, FLTSEG.POL, FLTSEG.POU,
                SKDDTL.ARPCOD, SKDDTL.SKDIDR, SKDDTL.DOCOWRIDR, SKDDTL.MSTDOCNUM,
                SKDDTL.DUPNUM, SKDDTL.SEQNUM, SKDDTL.DOCNUM, SKDDTL.TMPFLG,
                SKDDMG.DMGPCS, SKDDMG.DMGCOD, SKDDMG.DMGLVL,SKDDMG.SERNUM DMGSERNUM, SKDDMG.SRCIND DMGSRCIND

            FROM OPRFLTSEG FLTSEG,
               OPRSKDDTL SKDDTL,
               OPRSKDDMG SKDDMG

            WHERE   SKDDTL.CMPCOD = FLTSEG.CMPCOD
              AND SKDDTL.FLTCARIDR = FLTSEG.FLTCARIDR
              AND SKDDTL. FLTNUM  = FLTSEG.FLTNUM
              AND SKDDTL.FLTSEQNUM =  FLTSEG.FLTSEQNUM
              AND SKDDTL.ARPCOD = FLTSEG.POU
              AND SKDDTL.CMPCOD = SKDDMG.CMPCOD
              AND SKDDTL.ARPCOD = SKDDMG.ARPCOD
              AND SKDDTL.SKDIDR = SKDDMG.SKDIDR
              AND SKDDTL.CMPCOD = ?
              AND SKDDTL.FLTCARIDR = ?
              AND SKDDTL.FLTNUM = ?
              AND SKDDTL.FLTSEQNUM = ?
              AND SKDDTL.ARPCOD = ?
              AND SKDDTL.DOCNUM = ?

        ]]>
      </QRY:Source>
    </QRY:Definition>

 	 <QRY:Definition>
	<QRY:Id>264</QRY:Id>
	<QRY:Source Name="operations.shipment.jto.generateSkidId" Type="PROCEDURE">
	<![CDATA[
	  CALL PKG_OPR_SHP.opr_shp_generate_skid_id (
          ?,
          ?
        )
          ]]>
    </QRY:Source>
  </QRY:Definition>
   <QRY:Definition>
  <QRY:Id>265</QRY:Id>
  <QRY:Source Name="operations.shipment.jto.findMismatchListDetails" Type="NATIVE">
    <![CDATA[
         SELECT SKD.SKDIDR,SKD.DOCNUM,SKD.PCS,SKD.WGT,
         STU.CURLOCCOD,SKD.TMPFLG,SKD.MSTDOCNUM,SKD.SEQNUM,
         SKD.DUPNUM,SKD.ARACOD,SKD.ARPCOD,SKD.CMPCOD,SKD.DOCOWRIDR,
         SKD.FLTCARIDR,SKD.FLTNUM,SKD.FLTSEQNUM,SKD.LEGSERNUM,STU.CURLOCCOD,STU.CURWHSCOD,
         DMG.DMGPCS,DMG.DMGCOD,DMG.DMGRMK,DMG.DMGLVL,DMG.SERNUM, SKD.NCSFLTNUM, SKD.NCSFLTCARCOD,SKD.NCSFLTDAT

         FROM OPRSKDDTL SKD,
          WHSSTUMST STU,
          OPRSKDDMG DMG

         WHERE SKD.SKDIDR    = STU.STUCOD
        AND  SKD.ARPCOD    = STU.ARPCOD
        AND  SKD.CMPCOD    = STU.CMPCOD
        AND  SKD.SKDIDR    = DMG.SKDIDR(+)
        AND  SKD.CMPCOD    = DMG.CMPCOD(+)

        AND  SKD.TMPFLG = 'Y'
        AND  SKD.CMPCOD = ?
        AND  SKD.ARPCOD = ?

      ]]>
  </QRY:Source>
  </QRY:Definition>
  
   <QRY:Definition>
    <QRY:Id>266</QRY:Id>
    <QRY:Source Name="operations.shipment.jto.findMatchDetails" Type="NATIVE">
      <![CDATA[
           SELECT SKD.SKDIDR,SKD.DOCNUM,SKD.PCS,SKD.WGT,
            SKD.TMPFLG,SHP.MSTDOCNUM,SHP.SEQNUM,
            SHP.DUPNUM,SKD.ARACOD,SKD.ARPCOD,
          SKD.CMPCOD,SHP.DOCOWRIDR,SKD.FLTCARIDR,
            SKD.FLTNUM,SKD.FLTSEQNUM,SKD.LEGSERNUM,
          SHP.OWRCOD,SHP.SHPPFX,SKD.NCSFLTNUM, SKD.NCSFLTCARCOD, SKD.NCSFLTDAT, STU.CURLOCCOD,STU.CURWHSCOD,
            SHP.STDPCS, SHP.STDWGT
            FROM OPRSKDDTL SKD, OPRSHPMST SHP, WHSSTUMST STU

            WHERE SKD.CMPCOD = SHP.CMPCOD
            AND  SKD.DOCNUM    = SHP.DOCNUM
            AND  SKD.SKDIDR    = STU.STUCOD
            AND  SKD.ARPCOD    = STU.ARPCOD
            AND  SKD.CMPCOD    = STU.CMPCOD
            AND  SKD.TMPFLG = 'Y'
            AND  SKD.CMPCOD = ?
            AND  SKD.ARPCOD = ?

        ]]>
    </QRY:Source>
  </QRY:Definition>
  
  <QRY:Definition>
    <QRY:Id>263</QRY:Id>
    <QRY:Source Name="operations.shipment.jto.findoperationalskiddetails" Type="NATIVE">
      <![CDATA[
              SELECT SKD.SKDIDR, SKD.ARPCOD, SKD.CMPCOD, SKD.FLTCARIDR, SKD.FLTNUM, SKD.FLTSEQNUM, SKD.LEGSERNUM, SKD.DOCOWRIDR,
	  	                     SKD.MSTDOCNUM, SKD.DUPNUM, SKD.SEQNUM, NVL(SKD.DOCNUM, MST.DOCNUM) as DOCNUM , SKD.PCS, SKD.WGT, SKD.ARACOD, SKD.SGTARACOD, SKD.TMPFLG,
	  	                     SKD.LSTUPDTIM, MST.SHPPFX, MST.DSTCOD, OPRLEG.STA FLTDAT, MST.STDPCS, MST.STDWGT, MST.PARSEQNUM, LOC.LOCCOD,FLT.FLTCARCOD,ARPSHP.MSTAWBCHKFLG,MST.CONFLG,
                           SKD.ETDPCS SKDETDPCS, SKD.ETDINSPCS SKDETDINSPCS,
                           (CASE WHEN (SYSPAR.PARVAL LIKE '%'||MST.SCCCOD||'%') THEN MST.SCCCOD ELSE NULL END) MSTSCC, ADDSCC.SCC ADDSCC
	              FROM OPRSKDDTL SKD, OPRSHPMST MST, OPRARPIMPFLT FLT, WHSOPRSHPLOC LOC,OPRARPSHP ARPSHP, FLTOPRLEG OPRLEG,
                (SELECT MSTDOCNUM  ,
			DOCOWRIDR        ,
			DUPNUM           ,
			SEQNUM           ,
			CMPCOD           ,
			LTRIM( SYS_CONNECT_BY_PATH( SCCCOD, ',' ), ',' ) SCC
			 FROM
			(SELECT MSTDOCNUM,
			  DOCOWRIDR      ,
			  DUPNUM         ,
			  SEQNUM         ,
			  SCCCOD         ,
			  CMPCOD         ,
			  ROW_NUMBER( ) OVER( PARTITION BY MSTDOCNUM, DOCOWRIDR, DUPNUM, SEQNUM, CMPCOD ORDER BY SCCCOD ) RNM
			   FROM OPRSHPSCC SHPSCC
				   WHERE  EXISTS (SELECT 1 FROM SHRSYSPAR SYSPAR WHERE SHPSCC.CMPCOD = SYSPAR.CMPCOD
				   AND SYSPAR.PARVAL LIKE '%'||SHPSCC.SCCCOD||'%'
				   AND SYSPAR.PARCOD = 'warehouse.defaults.relocationwarningsccs')
				)
				WHERE CONNECT_BY_ISLEAF = 1 CONNECT BY PRIOR MSTDOCNUM = MSTDOCNUM
			  AND PRIOR DOCOWRIDR       = DOCOWRIDR
			  AND PRIOR DUPNUM          = DUPNUM
			  AND PRIOR SEQNUM          = SEQNUM
			  AND PRIOR CMPCOD          = CMPCOD
			  AND PRIOR RNM             = RNM - 1 START
			  WITH RNM                  = 1
			  ) ADDSCC, SHRSYSPAR SYSPAR

	                       WHERE
			      SKD.cmpcod = MST.cmpcod(+) AND
			      SKD.DOCOWRIDR = MST.DOCOWRIDR(+) AND
			      SKD.MSTDOCNUM = MST.MSTDOCNUM(+) AND
			      SKD.DUPNUM = MST.DUPNUM(+) AND
			      SKD.SEQNUM = MST.SEQNUM(+) AND
			      SKD.cmpcod = ARPSHP.cmpcod(+) AND
			      SKD.DOCOWRIDR = ARPSHP.DOCOWRIDR(+) AND
			      SKD.MSTDOCNUM = ARPSHP.MSTDOCNUM(+) AND
			      SKD.DUPNUM = ARPSHP.DUPNUM(+) AND
			      SKD.SEQNUM = ARPSHP.SEQNUM(+) AND
                              SKD.ARPCOD = ARPSHP.ARPCOD(+) AND
			      FLT.CMPCOD(+) = SKD.CMPCOD AND
			      FLT.FLTNUM(+) = SKD.FLTNUM AND
			      FLT.FLTCARIDR(+) = SKD.FLTCARIDR AND
			      FLT.FLTSEQNUM(+) = SKD.FLTSEQNUM AND
			      FLT.LEGSERNUM(+) = SKD.LEGSERNUM AND
			      FLT.ARPCOD(+) =  SKD.ARPCOD AND
            SKD.cmpcod = ADDSCC.cmpcod(+) AND
			      SKD.DOCOWRIDR = ADDSCC.DOCOWRIDR(+) AND
			      SKD.MSTDOCNUM = ADDSCC.MSTDOCNUM(+) AND
			      SKD.DUPNUM = ADDSCC.DUPNUM(+) AND
			      SKD.SEQNUM = ADDSCC.SEQNUM(+) AND
			      SKD.CMPCOD = LOC.CMPCOD(+) AND
			      SKD.DOCOWRIDR = LOC.DOCOWRIDR(+) AND
			      SKD.MSTDOCNUM = LOC.MSTDOCNUM(+) AND
			      SKD.DUPNUM = LOC.DUPNUM(+) AND
			      SKD.SEQNUM = LOC.SEQNUM(+) AND
			      SKD.DOCNUM = LOC.DOCNUM(+) AND
			      SKD.SKDIDR = LOC.STUCOD(+) AND
			      FLT.CMPCOD = OPRLEG.CMPCOD(+) AND
			      FLT.FLTNUM = OPRLEG.FLTNUM(+) AND
			      FLT.FLTCARIDR = OPRLEG.FLTCARIDR(+) AND
			      FLT.FLTSEQNUM = OPRLEG.FLTSEQNUM(+) AND
			      FLT.LEGSERNUM = OPRLEG.LEGSERNUM(+)

		            AND SKD.CMPCOD = SYSPAR.CMPCOD (+)
            		AND SYSPAR.PARCOD = 'warehouse.defaults.relocationwarningsccs'
	  		      AND SKD.SKDIDR = ?
	  		      AND SKD.ARPCOD = ? AND
						SKD.CMPCOD = ?
      ]]>
    </QRY:Source>
  </QRY:Definition>
  
  <QRY:Definition>
    <QRY:Id>264</QRY:Id>
    <QRY:Source Name="operations.shipment.jto.delivery.findskiddetailsforawb" Type="NATIVE">
      <![CDATA[SELECT SKDDTL.SKDIDR SKDIDR,
       SHPLOC.LOCCOD LOCCOD,
       SKDDTL.PCS PCS,
      SKDDTL.WGT WGT,
       SKDDTL.ARPCOD ARPCOD,
     SKDDTL.CMPCOD CMPCOD,
       SKDDTL.COLSTA COLSTA,
       SHPLOC.WHSCOD WHSCOD,
     SHPLOC.STUCOD STUCOD,
       COLSHP.YRD YRD,
       COLINS.DELIDR DELIDR,
       SHPMST.MSTDOCNUM MSTDOCNUM,
       SHPMST.DOCOWRIDR DOCOWRIDR,
       SHPMST.SEQNUM SEQNUM,
       SHPMST.DOCNUM DOCNUM,
     SHPMST.SHPPFX SHPPFX,
       SHPMST.DUPNUM DUPNUM,
       COLSHP.RMK RMK

FROM OPRSKDDTL SKDDTL,
OPRARPCOLSHP COLSHP,
WHSOPRSHPLOC SHPLOC,
OPRSHPCOLINS COLINS,
OPRSHPMST SHPMST

WHERE SKDDTL.MSTDOCNUM = COLSHP.MSTDOCNUM
AND SKDDTL.DOCOWRIDR = COLSHP.DOCOWRIDR
AND SKDDTL.DUPNUM = COLSHP.DUPNUM
AND SKDDTL.SEQNUM = COLSHP.SEQNUM
AND SKDDTL.ARPCOD = COLSHP.ARPCOD
AND SKDDTL.CMPCOD = COLSHP.CMPCOD
AND SKDDTL.MSTDOCNUM = SHPLOC.MSTDOCNUM
AND SKDDTL.DOCOWRIDR = SHPLOC.DOCOWRIDR
AND SKDDTL.DUPNUM = SHPLOC.DUPNUM
AND SKDDTL.SEQNUM = SHPLOC.SEQNUM
AND SKDDTL.ARPCOD = SHPLOC.ARPCOD
AND SKDDTL.CMPCOD = SHPLOC.CMPCOD

AND SHPMST.MSTDOCNUM = SHPLOC.MSTDOCNUM
AND SHPMST.DOCOWRIDR = SHPLOC.DOCOWRIDR
AND SHPMST.DUPNUM = SHPLOC.DUPNUM
AND SHPMST.SEQNUM = SHPLOC.SEQNUM
AND SHPMST.DOCNUM = SHPLOC.DOCNUM

AND SKDDTL.MSTDOCNUM = COLINS.MSTDOCNUM
AND SKDDTL.DOCOWRIDR = COLINS.DOCOWRIDR
AND SKDDTL.DUPNUM = COLINS.DUPNUM
AND SKDDTL.SEQNUM = COLINS.SEQNUM
AND SKDDTL.ARPCOD = COLINS.ARPCOD
AND SKDDTL.CMPCOD = COLINS.CMPCOD

AND SKDDTL.CMPCOD = ?
AND SKDDTL.ARPCOD = ?


      ]]>
    </QRY:Source>
  </QRY:Definition>
  <QRY:Definition>
    <QRY:Id>265</QRY:Id>
    <QRY:Source Name="operations.shipment.jto.delivery.skidleveldeliverydetails" Type="NATIVE">
      <![CDATA[SELECT SKDDTL.SKDIDR SKDIDR,
SKDDTL.MSTDOCNUM MSTDOCNUM,
SKDDTL.SEQNUM SEQNUM,
SKDDTL.DUPNUM DUPNUM,
SKDDTL.DOCOWRIDR DOCOWRIDR,
SHPMST.DOCNUM DOCNUM,
SHPMST.SHPPFX SHPPFX,
SKDDTL.PCS PCS,
SKDDTL.WGT WGT,
COLSHP.TRKCOM TRKCOM,
SKDDTL.DELSTA DELSTA,
SKDDTL.CMPCOD  CMPCOD,
 SKDDTL.ARPCOD ARPCOD,
 COLINS.DELIDR DELIDR,
 SHPMST.STDPCS STCPCS,
 SHPMST.STDWGT STDWGT,
 COLINS.WHSCOD WHCOD


FROM OPRSHPCOLINS COLINS,
     OPRSKDDTL SKDDTL,
     OPRARPCOLSHP COLSHP,
     OPRSHPMST SHPMST

WHERE COLINS.MSTDOCNUM =  SKDDTL.MSTDOCNUM
AND COLINS.DUPNUM = SKDDTL.DUPNUM
AND COLINS.SEQNUM = SKDDTL.SEQNUM
AND COLINS.DOCOWRIDR = SKDDTL.DOCOWRIDR
AND COLINS.ARPCOD = SKDDTL.ARPCOD
AND COLINS.CMPCOD = SKDDTL.CMPCOD

AND COLINS.MSTDOCNUM =  COLSHP.MSTDOCNUM
AND COLINS.DUPNUM = COLSHP.DUPNUM
AND COLINS.SEQNUM = COLSHP.SEQNUM
AND COLINS.DOCOWRIDR = COLSHP.DOCOWRIDR
AND COLINS.ARPCOD = COLSHP.ARPCOD
AND COLINS.CMPCOD = COLSHP.CMPCOD

AND SHPMST.MSTDOCNUM = SKDDTL.MSTDOCNUM
AND SHPMST.DOCOWRIDR = SKDDTL.DOCOWRIDR
AND SHPMST.DUPNUM = SKDDTL.DUPNUM
AND SHPMST.SEQNUM = SKDDTL.SEQNUM
AND SKDDTL.CMPCOD = ?
AND SKDDTL.ARPCOD = ?


        ]]>
    </QRY:Source>
  </QRY:Definition>
  <QRY:Definition>
    <QRY:Id>266</QRY:Id>
    <QRY:Source Name="operations.shipment.jto.findoperationalskiddtls" Type="NATIVE">
      <![CDATA[
          SELECT SKD.MSTDOCNUM, SKD.SEQNUM,SKD.DUPNUM, SKD.DOCOWRIDR,SKD.PCS,
            SKD.WGT,SKD.ARACOD SKDARACOD,ARA.ARACOD ARAARACOD,ARA.MFTPCS,
            SKD.FLTNUM, SKD.FLTSEQNUM, SKD.FLTCARIDR, SKD.ARPCOD,SKD.CMPCOD
          FROM OPRSKDDTL SKD, OPRARPARASHP ARA, OPRSHPMST MST
          WHERE SKD.MSTDOCNUM = MST.MSTDOCNUM AND
            SKD.DUPNUM = MST.DUPNUM AND
            SKD.SEQNUM = MST.SEQNUM AND
            SKD.DOCOWRIDR = MST.DOCOWRIDR AND
            SKD.MSTDOCNUM = ARA.MSTDOCNUM(+) AND
            SKD.DUPNUM = ARA.DUPNUM(+) AND
            SKD.SEQNUM = ARA.SEQNUM(+) AND
            SKD.DOCOWRIDR = ARA.DOCOWRIDR(+) AND

            SKD.SKDIDR = ? AND
            SKD.CMPCOD = ?


        ]]>
    </QRY:Source>
  </QRY:Definition>
  
  <QRY:Definition>
	<QRY:Id>267</QRY:Id>
		<QRY:Source Name="operations.shipment.jto.findOperationalSkidETDSDetails" Type="NATIVE">
			<![CDATA[
			SELECT
			  SKDDTL.CMPCOD CMPCOD,
				SKDDTL.SKDIDR SKDIDR,
			      SCCINF.SCCCOD ADDSCC            ,
				SKDDTL.ARPCOD ARPCOD,
			      SHPMST.SCCCOD MSTSCC            ,
				SKDDTL.MSTDOCNUM MSTDOCNUM,
				SKDDTL.DOCOWRIDR DOCOWRIDR      ,
				SKDDTL.DUPNUM DUPNUM            ,
				SKDDTL.SEQNUM SEQNUM            ,
				SHPMST.SHPPFX SHPPFX		,
				SHPMST.STDPCS STDPCS 		,
			  SUM(BKGSUM.BKGPCS) FBLPCS ,
				ARPSHP.ACPPCS ACPPCS 		,
				ARPSHP.ETDEXCPCS ETDEXCPCS 	,
				ARPSHP.ETDPCS ETDPCS	 	,
				ARPSHP.ETDINSPCS ETDINSPCS 	,
				ARPSHP.ETDSTA ETDSTA	 	,
				SKDDTL.ETDPCS SKDETDPCS 	,
				SKDDTL.PCS ,
				SKDDTL.ETDINSPCS SKDETDINSPCS 	,
				SKDDTL.LSTUPDTIM LSTUPDTIM 	,
				ARPSHP.LSTUPDTIM APRLSTUPDTIM
			FROM
			  OPRSKDDTL SKDDTL,
				OPRARPSHP ARPSHP      ,
			      OPRSHPMST SHPMST         ,
			  (
				SELECT
				  CMPCOD ,
			             docowridr         ,
			    seqnum                     ,
			    mstdocnum                  ,
			    dupnum                     ,
			             LTRIM( SYS_CONNECT_BY_PATH( scccod, ' , ' ), ' , ' ) scccod
			               FROM
				  (
					SELECT
					  CMPCOD ,
			      scccod                     ,
			                 docowridr       ,
			      seqnum                     ,
			      mstdocnum                  ,
			      dupnum                     ,
					  ROW_NUMBER( ) OVER( PARTITION BY CMPCOD, DOCOWRIDR ,SEQNUM,MSTDOCNUM,
					  DUPNUM ORDER BY SCCCOD ) RNM
			                   FROM
					  (
						SELECT
						  CMPCOD ,
			                  docowridr       ,
			        seqnum                    ,
			        mstdocnum                 ,
			        dupnum                    ,
			        scccod
						FROM
						  OPRSHPSCC
					  )
				  )
				WHERE
				  CONNECT_BY_ISLEAF = 1 CONNECT BY PRIOR CMPCOD =CMPCOD
			           AND PRIOR docowridr          =docowridr
			                    AND PRIOR seqnum    =seqnum
			                    AND PRIOR dupnum    =dupnum
			                    AND PRIOR mstdocnum =mstdocnum
			                       AND PRIOR RNM    = RNM - 1 START
			            WITH RNM                    = 1
			  )
			  SCCINF,
			  OPRLODPLNBKGSUM BKGSUM
			WHERE
			  SKDDTL.CMPCOD      = ARPSHP.CMPCOD
				AND SKDDTL.MSTDOCNUM  = ARPSHP.MSTDOCNUM
				AND SKDDTL.DOCOWRIDR  = ARPSHP.DOCOWRIDR
				AND SKDDTL.DUPNUM     = ARPSHP.DUPNUM
				AND SKDDTL.SEQNUM     = ARPSHP.SEQNUM
				AND SKDDTL.ARPCOD     = ARPSHP.ARPCOD
				AND SKDDTL.CMPCOD     = SHPMST.CMPCOD
				AND SKDDTL.MSTDOCNUM  = SHPMST.MSTDOCNUM
				AND SKDDTL.DOCOWRIDR  = SHPMST.DOCOWRIDR
				AND SKDDTL.DUPNUM     = SHPMST.DUPNUM
				AND SKDDTL.SEQNUM     = SHPMST.SEQNUM
			    AND SKDDTL.CMPCOD         = SCCINF.CMPCOD(+)
			    AND SKDDTL.MSTDOCNUM      = SCCINF.MSTDOCNUM(+)
			    AND SKDDTL.DOCOWRIDR      = SCCINF.DOCOWRIDR(+)
			    AND SKDDTL.DUPNUM         = SCCINF.DUPNUM(+)
			    AND SKDDTL.SEQNUM         = SCCINF.SEQNUM(+)
			AND ARPSHP.CMPCOD    = BKGSUM.CMPCOD(+)
			AND ARPSHP.MSTDOCNUM = BKGSUM.MSTDOCNUM(+)
			AND ARPSHP.DOCOWRIDR = BKGSUM.DOCOWRIDR(+)
			AND ARPSHP.DUPNUM    = BKGSUM.DUPNUM(+)
			AND ARPSHP.SEQNUM    = BKGSUM.SEQNUM(+)
				AND SKDDTL.CMPCOD     = ?
				AND SKDDTL.SKDIDR     = ?
				AND SKDDTL.ARPCOD     = ?
			GROUP BY
			  SKDDTL.CMPCOD,
			  SKDDTL.SKDIDR,
			  SCCINF.SCCCOD,
			  SKDDTL.ARPCOD,
			  SHPMST.SCCCOD,
			  SKDDTL.MSTDOCNUM,
			  SKDDTL.DOCOWRIDR,
			  SKDDTL.DUPNUM,
			  SKDDTL.SEQNUM,
			  SHPMST.SHPPFX,
			  SHPMST.STDPCS,
			  ARPSHP.ACPPCS,
			  ARPSHP.ETDEXCPCS,
			  ARPSHP.ETDPCS,
			  ARPSHP.ETDINSPCS,
			  ARPSHP.ETDSTA,
			  SKDDTL.ETDPCS,
			  SKDDTL.PCS,
			  SKDDTL.ETDINSPCS,
			  SKDDTL.LSTUPDTIM,
			  ARPSHP.LSTUPDTIM

			]]>
	</QRY:Source>
</QRY:Definition>
  
  <QRY:Definition>
		<QRY:Id>268</QRY:Id>
		<QRY:Source Name="operations.shipment.jto.findskidsforhawb" Type="NATIVE">
			<![CDATA[
						SELECT TXNHSE.DOCOWRIDR,  TXNHSE.ARPCOD,TXNHSE.CMPCOD,SHPMST.PARSEQNUM,
						                                TXNHSE.MSTDOCNUM, TXNHSE.SEQNUM, TXNHSE.DUPNUM,TXNHSE.DOCNUM,
						                                SKD.SKDIDR, TXNHSE.SERNUM,TXNHSE.PCS, TXNHSE.WGT, SKD.ETDPCS,
						                                SHPMST.SHPPFX,SHPMST.DSTCOD
						                        FROM OPRTXNHSE TXNHSE, OPRSKDDTL SKD, OPRSHPMST SHPMST
						                        WHERE TXNHSE.CMPCOD = SKD.CMPCOD
						                                AND TXNHSE.DOCOWRIDR = SKD.DOCOWRIDR
						                                AND TXNHSE.MSTDOCNUM = SKD.MSTDOCNUM
						                                AND TXNHSE.TXNREFTWO = SKD.SKDIDR
						                                AND TXNHSE.CMPCOD = SHPMST.CMPCOD
						                                AND TXNHSE.DUPNUM = SHPMST.DUPNUM
						                                AND TXNHSE.SEQNUM = SHPMST.SEQNUM
						                                AND TXNHSE.MSTDOCNUM = SHPMST.MSTDOCNUM
						                                AND TXNHSE.DOCOWRIDR = SHPMST.DOCOWRIDR
						                                
						                                AND TXNHSE.ARPCOD = ?
						                                AND TXNHSE.CMPCOD = ?
						                                AND TXNHSE.DOCOWRIDR = ?
						                                AND TXNHSE.MSTDOCNUM = ?
						                                AND TXNHSE.SEQNUM = ?
                                AND TXNHSE.DUPNUM = ?


					]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>269</QRY:Id>
		<QRY:Source Name="operations.shipment.jto.findskidsformawb" Type="NATIVE">
			<![CDATA[
						 SELECT SKD.CMPCOD, SKD.ARPCOD, SKD.DOCOWRIDR, SKD.MSTDOCNUM, SKD.SEQNUM, SKD.DUPNUM,
						                                 SKD.SKDIDR, SKD.PCS, SKD.WGT, SKD.ETDPCS,SHPMST.PARSEQNUM, SHPMST.SHPPFX, SHPMST.DSTCOD
						                         FROM OPRSKDDTL SKD, OPRSHPMST SHPMST
						                         WHERE SKD.CMPCOD = SHPMST.CMPCOD
						                             AND SKD.DUPNUM     = SHPMST.DUPNUM
						                             AND SKD.SEQNUM     = SHPMST.SEQNUM
						                             AND SKD.MSTDOCNUM  = SHPMST.MSTDOCNUM
						                             AND SKD.DOCOWRIDR  = SHPMST.DOCOWRIDR
						                             AND SKD.ARPCOD = ?
						                             AND SKD.CMPCOD = ?
						                             AND SKD.DOCOWRIDR = ?
						                             AND SKD.MSTDOCNUM = ?
						                             AND SKD.SEQNUM = ?
                            AND SKD.DUPNUM = ?

					]]>
		</QRY:Source>
	</QRY:Definition>
	
	<QRY:Definition>
      	    <QRY:Id>270</QRY:Id>
      	    <QRY:Source Name="operations.shipment.jto.findetdsinspectiondetailsforreport" Type="NATIVE">
      	      <![CDATA[
      	     			  SELECT  SKDDTL.CMPCOD CMPCOD,
    					SKDDTL.SKDIDR SKDIDR,
    					SKDDTL.ARPCOD ARPCOD,
    					SKDDTL.MSTDOCNUM MSTDOCNUM,
    					SKDDTL.DOCOWRIDR DOCOWRIDR      ,
    					SKDDTL.DUPNUM DUPNUM            ,
    					SKDDTL.SEQNUM SEQNUM            ,
    					SHPMST.SHPPFX SHPPFX		,
    					   SHPMST.SCCCOD SCCCOD		,
    					SHPMST.STDPCS STDPCS 		,
    					ARPSHP.ACPPCS ACPPCS 		,
    					ARPSHP.ETDEXCPCS ETDEXCPCS 	,
    					ARPSHP.ETDPCS ETDPCS	 	,
    					ARPSHP.ETDINSPCS ETDINSPCS 	,
    					ARPSHP.ETDSTA ETDSTA	 	,
    					SKDDTL.ETDPCS SKDETDPCS 	,
    					SKDDTL.ETDINSPCS SKDETDINSPCS 	,
    					  OPRSHPETDEXCRSN.EXCRSN,OPRSHPETDEXCRSN.EXCPCS,
    					   SUM( NVL(LODPLN.BKGPCS,0) )  FBLPCS,SHRARLMST.TWOAPHCOD
    					FROM    OPRSKDDTL SKDDTL  JOIN OPRARPSHP ARPSHP  ON
    					   SKDDTL.CMPCOD = ARPSHP.CMPCOD
    					AND SKDDTL.MSTDOCNUM  = ARPSHP.MSTDOCNUM
    					AND SKDDTL.DOCOWRIDR  = ARPSHP.DOCOWRIDR
    					AND SKDDTL.DUPNUM     = ARPSHP.DUPNUM
    					AND SKDDTL.SEQNUM     = ARPSHP.SEQNUM
    					AND SKDDTL.ARPCOD     = ARPSHP.ARPCOD
    					   AND SKDDTL.CMPCOD     = ?
    					AND SKDDTL.SKDIDR     = ?
    					AND SKDDTL.ARPCOD     = ?
    					   INNER JOIN OPRSHPMST SHPMST ON
    					    SKDDTL.CMPCOD     = SHPMST.CMPCOD
    					AND SKDDTL.MSTDOCNUM  = SHPMST.MSTDOCNUM
    					AND SKDDTL.DOCOWRIDR  = SHPMST.DOCOWRIDR
    					AND SKDDTL.DUPNUM     = SHPMST.DUPNUM
    					AND SKDDTL.SEQNUM     = SHPMST.SEQNUM
    					   LEFT OUTER JOIN OPRSHPETDEXCRSN ON
    					     ARPSHP.MSTDOCNUM  = OPRSHPETDEXCRSN.MSTDOCNUM
    					AND ARPSHP.DOCOWRIDR  = OPRSHPETDEXCRSN.DOCOWRIDR
    					AND ARPSHP.DUPNUM     = OPRSHPETDEXCRSN.DUPNUM
    					AND ARPSHP.SEQNUM     = OPRSHPETDEXCRSN.SEQNUM
    					AND ARPSHP.ARPCOD     = OPRSHPETDEXCRSN.ARPCOD
    					   AND ARPSHP.CMPCOD     = OPRSHPETDEXCRSN.CMPCOD
    					 LEFT OUTER JOIN OPRLODPLNBKGSUM LODPLN ON
    					    ARPSHP.MSTDOCNUM  = LODPLN.MSTDOCNUM
    					   AND ARPSHP.SEQNUM     = LODPLN.SEQNUM
    					   AND ARPSHP.DUPNUM     = LODPLN.DUPNUM
    					   AND ARPSHP.DOCOWRIDR  = LODPLN.DOCOWRIDR
    					    LEFT OUTER JOIN SHRARLMST ON
    					    SHRARLMST.CMPCOD=LODPLN.CMPCOD
    					   AND SHRARLMST.ARLIDR=LODPLN.FLTCARIDR
    					   GROUP BY
    					   SKDDTL.CMPCOD,
    					SKDDTL.SKDIDR,
    					SKDDTL.ARPCOD ,
    					SKDDTL.MSTDOCNUM ,
    					SKDDTL.DOCOWRIDR       ,
    					SKDDTL.DUPNUM             ,
    					SKDDTL.SEQNUM             ,
    					SHPMST.SHPPFX 		,
    					SHPMST.STDPCS  		,
    					ARPSHP.ACPPCS  		,
    					ARPSHP.ETDEXCPCS  	,
    					ARPSHP.ETDPCS 	 	,
    					ARPSHP.ETDINSPCS  	,
    					ARPSHP.ETDSTA 	 	,
    					SKDDTL.ETDPCS  	,
    					SKDDTL.ETDINSPCS  	,
    					OPRSHPETDEXCRSN.EXCPCS,
                                            OPRSHPETDEXCRSN.EXCRSN,
                                            SHRARLMST.TWOAPHCOD,
                                            SHPMST.SCCCOD
                ]]>
          </QRY:Source>
    </QRY:Definition>
	
	
	  <QRY:Definition>
	    <QRY:Id>271</QRY:Id>
	    <QRY:Source Name="operations.shipment.jto.findCarrierCodeForSkidLabel" Type="NATIVE">
	      <![CDATA[

	      SELECT LTRIM(SYS_CONNECT_BY_PATH(CARRIER,','),',' )CARRIER FROM
	      (SELECT CARRIER,
	        ROWNUM RN
	      FROM
	        (SELECT TEMPVIEW.*,
	           MIN(ORD) OVER() MINORD
	         FROM
	          (SELECT TWOAPHCOD CARRIER,
	             1 AS
	           ORD
	           FROM SHRARLMST,
	             OPRLODPLNBKGSUM
	           WHERE SHRARLMST.ARLIDR = OPRLODPLNBKGSUM.FLTCARIDR
	           AND SHRARLMST.CMPCOD = OPRLODPLNBKGSUM.CMPCOD
	           AND OPRLODPLNBKGSUM.CMPCOD = ?
	           AND DOCOWRIDR =  ?
	           AND MSTDOCNUM =  ?
	           AND DUPNUM =  ?
	           AND SEQNUM =  ?

	           UNION
	           SELECT FLTCARCOD CARRIER,
	             2 AS
	           ORD
	           FROM OPRSHPRTG
	           WHERE CMPCOD =  ?
	           AND DOCOWRIDR =  ?
	           AND MSTDOCNUM =  ?
	           AND DUPNUM =  ?
	           AND SEQNUM =  ?
	           AND RTGSERNUM = 1

	           UNION
	           SELECT OWRCOD CARRIER,
	             3 AS
	           ORD
	           FROM OPRSHPMST
	           WHERE CMPCOD =  ?
	           AND DOCOWRIDR =  ?
	           AND MSTDOCNUM =  ?
	           AND DUPNUM =  ?
	           AND SEQNUM =  ?)
	        TEMPVIEW)
	      WHERE ORD = MINORD
	       AND ROWNUM <= 2)  WHERE CONNECT_BY_ISLEAF = 1 START WITH RN=1
	       CONNECT BY RN=PRIOR RN+1

          	  ]]>
              </QRY:Source>
  </QRY:Definition>
  
  <QRY:Definition>
  <QRY:Id>272</QRY:Id>
  <QRY:Source Name="operations.shipment.jto.retrieveoldldrdetails" Type="NATIVE">
  	<![CDATA[
  	SELECT CMPCOD,ACPIDR,LDRNUM,URGFLG,LDRFLT,ACPFLG
  	FROM OPRTRKLDR
  	WHERE CMPCOD = ? AND LDRNUM =?
  	]]>
  </QRY:Source>
</QRY:Definition>
	
	
	<QRY:Definition>

  
		<QRY:Id>274</QRY:Id>
			<QRY:Source Name="operations.shipment.jto.LDRShipment" Type="OBJECT">
				  <![CDATA[
				  SELECT
				      ldrShipment
				  FROM
				      JTOLDRShipment AS ldrShipment
				  WHERE
				      ldrShipment.ldrShipmentPK.ldrNumber = ?
				    AND ldrShipment.ldrShipmentPK.companyCode = ?

				]]>
			</QRY:Source>
	</QRY:Definition>
  
  <QRY:Definition>
		<QRY:Id>275</QRY:Id>
		<QRY:Source Name="operations.shipment.jto.finduldconditionatairport" Type="NATIVE">
		  <![CDATA[
	 SELECT ULDNUM ,
  CMPCOD       ,
  ARPCOD       ,
  ORGCOD       ,
  DSTCOD       ,
  ULDNAT       ,
  HNDCOD       ,
  WHSCOD       ,
  INTFLG       ,
  TRPTYP       ,
  ULDDIS       ,
  SELRMK       ,
  PLCCVRFLG    ,
  NOOCVRFLG    ,
  PLCUPSFLG    ,
  PLCDWSFLG    ,
  CSDFLG       ,
  TRNFLG       ,
  CSHFLG       ,
  PCHFLG       ,
  HLEFLG       ,
  PLTNETFLG    ,
  STPFLG       ,
  STPNUM       ,
  WODSPTFLG    ,
  WODSPTNUM    ,
  REQTMP       ,
  ACTTMP       ,
  TACMID
   FROM OPRARPULDCDN ULDCDN
  WHERE ULDCDN.ULDNUM = ?
AND ULDCDN.ARPCOD     = ?
AND ULDCDN.CMPCOD     = ?

		]]>
		</QRY:Source>
		</QRY:Definition>
 
	
<QRY:Definition>
  <QRY:Id>242</QRY:Id>
  <QRY:Source Name="operations.shipment.findHandlingDetails" Type="NATIVE">
    <![CDATA[
        SELECT
			  (SELECT MIS.FWDCOD
			  FROM OPRSHPMSTMIS MIS
			  WHERE MIS.CMPCOD  = MST.CMPCOD
			  AND MIS.DOCOWRIDR = MST.DOCOWRIDR
			  AND MIS.MSTDOCNUM = MST.MSTDOCNUM
			  AND MIS.DUPNUM    = MST.DUPNUM
			  AND MIS.SEQNUM    = MST.SEQNUM
			  ) FWDCOD,
			  (SELECT COL.PUOSTA
			  FROM OPRARPCOLSHP COL
			  WHERE COL.CMPCOD  = MST.CMPCOD
			  AND COL.DOCOWRIDR = MST.DOCOWRIDR
			  AND COL.MSTDOCNUM = MST.MSTDOCNUM
			  AND COL.DUPNUM    = MST.DUPNUM
			  AND COL.SEQNUM    = MST.SEQNUM
			  AND COL.ARPCOD    = ?
			  ) PUOSTA ,
        IMP.FLTCARIDR       ,
          IMP.FLTSEQNUM             ,
          IMP.FLTDAT                ,
          IMP.FLTNUM                ,
          IMP.ARPCOD                ,
          IMP.FLTCARCOD             ,
         MST.CMPCOD MSTCMPCOD,
           MST.MSTDOCNUM MSTDOCNUM,
         MST.SEQNUM MSTSEQNUM,
         MST.DUPNUM MSTDUPNUM,
         MST.SHPPFX MSTSHPPFX,
          MST.DOCOWRIDR DOCOWRIDR   ,
          MST.DOCNUM                ,
          HDL.REFNUM HDLREFNUM      ,
          HDL.HDLTYP HDLTYP         ,
          HDL.HDLIDR HDLIDR         ,
          HDL.AGTCOD HDLAGTCOD      ,
     HDL.CUSNAM HDLCUSNAM,
     HDL.GRPIMPNUM HDLGRPIMPNUM,
     HDL.NONBUSFLG HDLNONBUSFLG,
     HDL.GRVYRDFLG HDLGRVYRDFLG,
       HDL.CUSISPFLG HDLCUSISPFLG,
     HDL.CUSISPSTA HDLCUSISPSTA,
         HDL.TKNOUTFLG HDLTKNOUTFLG,
     HDL.RTDFLG HDLRTDFLG,
          HDL.NUMWRK HDLNUMWRK      ,
          HDL.WRKLOC HDLWRKLOC      ,
       HDL.DRYICEUNT HDLDRYICEUNT,
     HDL.WRKSRTTIM HDLWRKSRTTIM,
         HDL.WRKENDTIM HDLWRKENDTIM,
          HDL.RMK HDLRMK            ,
          HDL.HDLSTA HDLSTA         ,
         HDL.STRTIM HDLSRTTIM,
     HDL.ENDTIM HDLENDTIM,
     HDLULD.ULDTYP HDLULDTYP,
         HDLULD.NUMULD HDLULDNUM,
          HDL.PAYADVNUM PAYADVNUM,
         HDL.LSTUPDTIM,
		 HDL.MFTPCS MSGMFTPCS,
          SKD.SKDIDR                ,
          LOC.LOCPCS                ,
     LOC.STUCOD LOCSTUCOD,
         LOC.LOCCOD CURLOCCOD,
     HIS.HDLTYP HISHDLTYP,
     HIS.HDLIDR HISHDLIDR,
         HIS.STRTIM HISSRTTIM,
         HIS.ENDTIM HISENDTIM,
          HIS.HDLSTA HISHDLSTA      ,
			  (SELECT SUM(SEG.RCVWGT) RCVWGT
			  FROM OPRSEGSHP SEG
			  WHERE SEG.CMPCOD  = MST.CMPCOD
			  AND SEG.DOCOWRIDR = MST.DOCOWRIDR
			  AND SEG.DUPNUM    = MST.DUPNUM
			  AND SEG.MSTDOCNUM = MST.MSTDOCNUM
			  AND SEG.SEQNUM    = MST.SEQNUM
			  GROUP BY SEG.CMPCOD,
			    SEG.DOCOWRIDR ,
			    SEG.DUPNUM ,
			    SEG.MSTDOCNUM ,
			    SEG.SEQNUM
			  )RCVWGT ,
			  (SELECT SUM(SEG.RCVPCS) RCVPCS
			  FROM OPRSEGSHP SEG
			  WHERE SEG.CMPCOD  = MST.CMPCOD
			  AND SEG.DOCOWRIDR = MST.DOCOWRIDR
			  AND SEG.DUPNUM    = MST.DUPNUM
			  AND SEG.MSTDOCNUM = MST.MSTDOCNUM
			  AND SEG.SEQNUM    = MST.SEQNUM
			  GROUP BY SEG.CMPCOD,
			    SEG.DOCOWRIDR ,
			    SEG.DUPNUM ,
			    SEG.MSTDOCNUM ,
			    SEG.SEQNUM
			  ) RCVPCS ,
			  (SELECT FLTLEG.STA
			  FROM FLTOPRLEG FLTLEG
			  WHERE FLTLEG.CMPCOD  = IMP.CMPCOD
			  AND FLTLEG.FLTCARIDR = IMP.FLTCARIDR
			  AND FLTLEG.FLTNUM    = IMP.FLTNUM
			  AND FLTLEG.FLTSEQNUM = IMP.FLTSEQNUM
			  AND FLTLEG.LEGSERNUM = IMP.LEGSERNUM
			  ) STA
  FROM OPRSHPMST MST,
     OPRSEGSHP SEG,
     OPRSHPHDLDTL HDL,
     OPRSHPHDLULD HDLULD,
     OPRSHPHDLSKD SKD,
			  OPRARPIMPFLT IMP,
     WHSOPRSHPLOC LOC,
     OPRARPSHP ARPSHP,
          (SELECT CHILDHDL.HDLIDR,
      CHILDHDL.HDLTYP,
            CHILDHDL.STRTIM      ,
            CHILDHDL.ENDTIM      ,
            CHILDHDL.HDLSTA      ,
      CHILDHDL.CMPCOD,
      CHILDHDL.MSTDOCNUM,
            CHILDHDL.SEQNUM      ,
            CHILDHDL.DUPNUM      ,
      CHILDHDL.DOCOWRIDR
             FROM OPRSHPHDLDTL CHILDHDL,
                  OPRSHPHDLDTL HDL
             WHERE CHILDHDL.MSTDOCNUM = HDL.MSTDOCNUM
       AND CHILDHDL.SEQNUM    = HDL.SEQNUM
       AND CHILDHDL.DUPNUM    = HDL.DUPNUM
                   AND CHILDHDL.DOCOWRIDR     = HDL.DOCOWRIDR
			  AND CHILDHDL.CMPCOD      = HDL.CMPCOD
                   AND CHILDHDL.ENDTIM       IS NOT NULL
			  ) HIS
   WHERE MST.MSTDOCNUM = HDL.MSTDOCNUM(+)
     AND MST.SEQNUM   = HDL.SEQNUM(+)
     AND MST.DUPNUM   = HDL.DUPNUM(+)
     AND MST.DOCOWRIDR  = HDL.DOCOWRIDR(+)
     AND MST.CMPCOD   = HDL.CMPCOD(+)
     AND MST.CMPCOD = SEG.CMPCOD
     AND MST.DOCOWRIDR = SEG.DOCOWRIDR
     AND MST.DUPNUM = SEG.DUPNUM
     AND MST.MSTDOCNUM = SEG.MSTDOCNUM
     AND MST.SEQNUM = SEG.SEQNUM
   AND SEG.FLTCARIDR  = IMP.FLTCARIDR
   AND SEG.FLTNUM   = IMP.FLTNUM
   AND SEG.FLTSEQNUM  = IMP.FLTSEQNUM
   AND SEG.CMPCOD   = IMP.CMPCOD
			AND IMP.ARPCOD      = ?
			AND MST.MSTDOCNUM   = ARPSHP.MSTDOCNUM
			AND MST.SEQNUM      = ARPSHP.SEQNUM
			AND MST.DUPNUM      = ARPSHP.DUPNUM
			AND MST.DOCOWRIDR   = ARPSHP.DOCOWRIDR
			AND MST.CMPCOD      = ARPSHP.CMPCOD
			AND ARPSHP.ARPCOD   = ?
     AND MST.MSTDOCNUM = LOC.MSTDOCNUM(+)
     AND MST.SEQNUM = LOC.SEQNUM(+)
     AND MST.DUPNUM = LOC.DUPNUM(+)
     AND MST.DOCOWRIDR = LOC.DOCOWRIDR(+)
     AND MST.CMPCOD = LOC.CMPCOD(+)
     AND MST.CMPCOD = HIS.CMPCOD(+)
     AND MST.MSTDOCNUM = HIS.MSTDOCNUM(+)
     AND MST.SEQNUM = HIS.SEQNUM(+)
     AND MST.DUPNUM = HIS.DUPNUM(+)
     AND MST.DOCOWRIDR = HIS.DOCOWRIDR(+)
     AND HDL.HDLIDR = HDLULD.HDLIDR(+)
     AND HDL.CMPCOD = HDLULD.CMPCOD(+)
     AND HDL.HDLIDR = SKD.HDLIDR(+)
     AND HDL.CMPCOD = SKD.CMPCOD(+)
  ]]>
  </QRY:Source>
  </QRY:Definition>
	 <QRY:Definition>
		<QRY:Id>369</QRY:Id>
		<QRY:Source Name="operations.shipment.cto.findlistadditionalhandlingdetails" Type="NATIVE">
			<![CDATA[
				SELECT ADDHDL.HDLTYP , ADDHDL.SRTTIM , ADDHDL.ENDTIM , ADDHDL.NUMUNT ,
				   ADDHDL.FRQ , ADDHDL.ACTCST , ADDHDL.CUSCOD,ADDHDL.CUSNAM, ADDHDL.NONBUSFLG ,
				   ADDHDL.GRVYRDFLG , ADDHDL.BILRQDFLG  , ADDHDL.PAYTYP  ,ADDHDL.HDLDAT, ADDHDL.HDLSTA,
				   ADDHDL.HDLSUBTYP  , ADDHDL.MSTDOCNUM , ADDHDL.DOCOWRIDR , ADDHDL.HDLIDR,
					ADDHDL.SEQNUM , ADDHDL.DUPNUM , MST.SHPPFX,ADDHDL.PAYADVNUM,MST.DOCNUM,ADDHDL.LSTUPDUSR,ADDHDL.LSTUPDTIM,ADDHDL.ARPCOD
				FROM OPRSHPADDHDL ADDHDL,OPRSHPMST MST
				WHERE   ADDHDL.CMPCOD= MST.CMPCOD(+) AND
			    	 	ADDHDL.DOCOWRIDR=MST.DOCOWRIDR(+) AND
			        	ADDHDL.DUPNUM=MST.DUPNUM(+) AND
			        	ADDHDL.SEQNUM=MST.SEQNUM (+) AND
			        	ADDHDL.MSTDOCNUM=MST.MSTDOCNUM(+) AND
						    
			    		ADDHDL.CMPCOD = ? 
					   

				]]>
		</QRY:Source>
	</QRY:Definition>
	
	<QRY:Definition>
			<QRY:Id>370</QRY:Id>
			<QRY:Source Name="operations.shipment.jto.findpeicedetailsfordlv" Type="NATIVE">
					<![CDATA[
						SELECT (  CASE
					    WHEN SELSHP.SELPCS > 0
					    THEN SELSHP.SELPCS
					    ELSE SEGSHP.MFTPCS
					  END) SHPMFTPCS,
					  (  CASE
					    WHEN SELSHP.SELWGT > 0
					    THEN SELSHP.SELWGT
					    ELSE SEGSHP.MFTWGT
					  END) SHPMFTWGT,
					  SEGSHP.RCVPCS,
					  SEGSHP.RCVWGT
					  FROM OPRSEGSHP SEGSHP,
					  OPRSEGSELSHP SELSHP ,
					  OPRSHPMST SHPMST
					  WHERE
					  SHPMST.CMPCOD = SELSHP.CMPCOD
					  AND SHPMST.DOCOWRIDR = SELSHP.DOCOWRIDR
					  AND SHPMST.MSTDOCNUM = SELSHP.MSTDOCNUM
					  AND SHPMST.SEQNUM = SELSHP.SEQNUM
					  AND SHPMST.DUPNUM = SELSHP.DUPNUM

					  AND SELSHP.CMPCOD = SEGSHP.CMPCOD(+)
					  AND SELSHP.DOCOWRIDR = SEGSHP.DOCOWRIDR(+)
					  AND SELSHP.MSTDOCNUM = SEGSHP.MSTDOCNUM(+)
					  AND SELSHP.SEQNUM = SEGSHP.SEQNUM(+)
					  AND SELSHP.DUPNUM = SEGSHP.DUPNUM(+)
					  AND SELSHP.FLTNUM = SEGSHP.FLTNUM(+)
					  AND SELSHP.FLTSEQNUM = SEGSHP.FLTSEQNUM(+)
					  AND SELSHP.FLTCARIDR = SEGSHP.FLTCARIDR(+)
					  AND SELSHP.SEGSERNUM = SEGSHP.SEGSERNUM(+)

  					  AND  SELSHP.CMPCOD = ?
					  AND SELSHP.DOCOWRIDR = ?
					  AND SELSHP.MSTDOCNUM = ?
					  AND SELSHP.SEQNUM = ?
					  AND SELSHP.DUPNUM = ?
				]]>
		</QRY:Source>
	</QRY:Definition>
	
	<QRY:Definition>
	    <QRY:Id>371</QRY:Id>
	    <QRY:Source Name="operations.shipment.jto.findemailaddforawb" Type="NATIVE">
	      <![CDATA[
	     			SELECT EMLADR,REQTIME FROM OPRSHPNTFCON WHERE
	     			CMPCOD=? AND MSTDOCNUM=? AND SEQNUM=? AND DOCOWRIDR=?  AND DUPNUM=?
	          ]]>
	    </QRY:Source>
  </QRY:Definition>
  
  <QRY:Definition>
    <QRY:Id>372</QRY:Id>
    <QRY:Source Name="operations.shipment.jto.fzedlvmessageloading" Type="NATIVE">
      <![CDATA[
		SELECT SEGSHP.CMPCOD              ,
		  ARPSHP.TOTDLVPCS AS RCVPCS ,
		  SEGSELSHP.SELPCS           ,
		  SHPMST.SHPPFX              ,
		  SHPMST.DOCOWRIDR           ,
		  SHPMST.MSTDOCNUM           ,
		  SHPMST.DOCNUM              ,
		  SHPMST.ORGCOD              ,
		  SHPMST.DSTCOD              ,
		  SEGSELSHP.RMK              ,
		  SEGSELSHP.STDPCS           ,
		  SEGSELSHP.STDWGT           ,
		  ARLMST.TWOAPHCOD CARRCOD   ,
		  SEGSELSHP.WGTCOD           ,
		  OPRLEG.LEGDST ,
		  OPRLEG.STD    ,
		  SEGSELSHP.AGTCOD,
		  SHPMIS.BDNSRTFLG
		   FROM
		   OPRSEGSHP SEGSHP,
		  OPRSEGSELSHP SEGSELSHP,
		  OPRSHPMST SHPMST      ,
		  FLTOPRLEG OPRLEG      ,
		  SHRARLMST ARLMST,
		  OPRSHPMSTMIS SHPMIS,
		  OPRARPSHP ARPSHP
		  WHERE SEGSHP.MSTDOCNUM = ARPSHP.MSTDOCNUM
			AND SEGSHP.DOCOWRIDR     = ARPSHP.DOCOWRIDR
			AND SEGSHP.SEQNUM  = ARPSHP.SEQNUM
			AND SEGSHP.DUPNUM  = ARPSHP.DUPNUM
			AND SEGSHP.CMPCOD     = ARPSHP.CMPCOD
			AND SEGSHP.FLTNUM     = SEGSELSHP.FLTNUM(+)
			AND SEGSHP.FLTCARIDR  = SEGSELSHP.FLTCARIDR(+)
			AND SEGSHP.FLTSEQNUM  = SEGSELSHP.FLTSEQNUM(+)
			AND SEGSHP.SEGSERNUM  = SEGSELSHP.SEGSERNUM(+)
			AND SEGSHP.SEQNUM     = SEGSELSHP.SEQNUM(+)
			AND SEGSHP.DUPNUM     = SEGSELSHP.DUPNUM(+)
			AND SEGSHP.MSTDOCNUM  = SEGSELSHP.MSTDOCNUM(+)
			AND SEGSHP.DOCOWRIDR  = SEGSELSHP.DOCOWRIDR(+)
			AND SEGSHP.CMPCOD     = SEGSELSHP.CMPCOD(+)
			AND SEGSHP.FLTNUM     = OPRLEG.FLTNUM
			AND SEGSHP.FLTCARIDR  = OPRLEG.FLTCARIDR
			AND SEGSHP.FLTSEQNUM  = OPRLEG.FLTSEQNUM
			AND SEGSHP.CMPCOD     = OPRLEG.CMPCOD
			AND SEGSHP.SEQNUM     = SHPMST.SEQNUM
			AND SEGSHP.DUPNUM     = SHPMST.DUPNUM
			AND SEGSHP.MSTDOCNUM  = SHPMST.MSTDOCNUM
			AND SEGSHP.DOCOWRIDR  = SHPMST.DOCOWRIDR
			AND SEGSHP.CMPCOD     = SHPMST.CMPCOD
			AND SEGSHP.SEQNUM     > 1
			AND ARLMST.ARLIDR     = SEGSHP.FLTCARIDR
			AND ARLMST.CMPCOD     = SEGSHP.CMPCOD

			AND SHPMIS.SEQNUM     = SHPMST.SEQNUM
			AND SHPMIS.DUPNUM     = SHPMST.DUPNUM
			AND SHPMIS.MSTDOCNUM  = SHPMST.MSTDOCNUM
			AND SHPMIS.DOCOWRIDR  = SHPMST.DOCOWRIDR
			AND SHPMIS.CMPCOD     = SHPMST.CMPCOD

			AND OPRLEG.LEGDST     = ?
			AND SHPMST.CMPCOD     = ?
			AND SHPMST.MSTDOCNUM  = ?
			AND SHPMST.DOCOWRIDR  = ?
			AND SHPMST.DUPNUM     = ?
			AND SHPMST.SEQNUM     = ?
	  ]]>
    </QRY:Source>
     </QRY:Definition>
	
	
	<!--Modifed by A-4562 for ICRD-19394 starts -->
	<QRY:Definition>
			<QRY:Id>373</QRY:Id>
			<QRY:Source Name="operations.shipment.findAdditionalHandlingDetailsforCharging" Type="NATIVE">
			  <![CDATA[
	              SELECT ADDHDL.CMPCOD CMPCOD,
                         HDLIDR ,
                         HDLTYP ,
						 SRTTIM ,
					     ENDTIM ,
					     NUMUNT ,
					     ACTCST ,
				         CUSCOD ,
						 NONBUSFLG ,
						 GRVYRDFLG ,
				   		 BILRQDFLG ,
                         PAYTYP,
						 CUSNAM,ARPCOD,
						  MSTDOCNUM,
						  SEQNUM,
						  DUPNUM,
						  DOCOWRIDR,
						  LSTUPDTIM,
						  LSTUPDUSR
						FROM OPRSHPADDHDL ADDHDL		
						WHERE   ADDHDL.HDLSTA = 'N'
				  AND  ADDHDL.CMPCOD = ?
	
			]]>
			</QRY:Source>
		</QRY:Definition>		 
	<!--Modifed by A-4562 for ICRD-19394 Ends -->
<QRY:Definition>
		<QRY:Id>297</QRY:Id>
		<QRY:Source Name="operations.shipment.fetchshipmentsforcharging" Type="NATIVE">
			<![CDATA[
                 SELECT SELSHP.CMPCOD,
                        SELSHP.DOCOWRIDR,
                        SELSHP.MSTDOCNUM,
                        SELSHP.SEQNUM,
                        SELSHP.DUPNUM,
                        MST.STDWGT,
                        SELSHP.SELWGT,
						SELSHP.FLTCARIDR,
  						SELSHP.FLTNUM,
						SELSHP.FLTSEQNUM,
						SELSHP.SEGSERNUM,
                        SELSHP.BRKDWNSRTTIM,
						SELSHP.CNSSRTTIM,
                        MST.CONFLG,
						MST.SHPPFX,
						MST.DOCNUM,
					MST.PARSEQNUM,
				        SELSHP.PAYADVNUM,
						COL.PAYTYP,
						COL.AGTCOD,
						COL.BILRQD
                FROM OPRSHPMST MST,
                        OPRSEGSELSHP SELSHP,
						OPRARPCOLSHP COL
                WHERE MST.CMPCOD = SELSHP.CMPCOD
                 AND MST.DOCOWRIDR = SELSHP.DOCOWRIDR
                 AND MST.MSTDOCNUM = SELSHP.MSTDOCNUM
                 AND MST.SEQNUM = SELSHP.SEQNUM
                 AND MST.DUPNUM = SELSHP.DUPNUM
				 AND SELSHP.CMPCOD = COL.CMPCOD(+)
				 AND SELSHP.DOCOWRIDR = COL.DOCOWRIDR(+)
                 AND SELSHP.MSTDOCNUM = COL.MSTDOCNUM(+)
                 AND SELSHP.SEQNUM = COL.SEQNUM(+)
                 AND SELSHP.DUPNUM = COL.DUPNUM(+)
                 AND MST.CMPCOD = ?
                 AND MST.DOCOWRIDR = ?
                 AND MST.MSTDOCNUM = ?
                 AND MST.SEQNUM = ?
                 AND MST.DUPNUM = ?
                 AND(SELSHP.IMPTSCCOLFLG IS NULL OR SELSHP.IMPTSCCOLFLG <> ?)
                UNION
                SELECT MST.CMPCOD,
                        MST.DOCOWRIDR,
                        MST.MSTDOCNUM,
                        MST.SEQNUM,
                        MST.DUPNUM,
			MST.STDWGT,
			SELSHP2.SELWGT,
                        SELSHP2.FLTCARIDR,
						SELSHP2.FLTNUM,
						SELSHP2.FLTSEQNUM,
						SELSHP2.SEGSERNUM,
                        SELSHP2.BRKDWNSRTTIM,
						SELSHP2.CNSSRTTIM,
                        MST.CONFLG,
						MST.SHPPFX,
MST.DOCNUM,

						MST.PARSEQNUM,
				        SELSHP2.PAYADVNUM,
						COL.PAYTYP,
						COL.AGTCOD,
					COL.BILRQD

                FROM OPRSHPMST MST,
                        OPRSEGSELSHP SELSHP1,
                        OPRSEGSELSHP SELSHP2,
			OPRARPCOLSHP COL
               WHERE mst.cmpcod = selshp2.cmpcod
 				AND mst.docowridr = selshp2.docowridr
				 AND mst.mstdocnum = selshp2.mstdocnum
				 AND mst.seqnum = selshp2.seqnum
				 AND mst.dupnum = selshp2.dupnum
				 AND selshp1.cmpcod = COL.cmpcod(+)
				 AND selshp1.docowridr = COL.docowridr(+)
				 AND selshp1.mstdocnum = COL.mstdocnum(+)
				 AND selshp1.seqnum = COL.seqnum(+)
				 AND selshp1.dupnum = COL.dupnum(+)
                 AND selshp1.CMPCOD = ?
                 AND selshp1.DOCOWRIDR = ?
                 AND selshp1.MSTDOCNUM = ?
                 AND selshp1.SEQNUM = ?
                 AND selshp1.DUPNUM = ?
				  AND selshp2.seqnum < selshp1.seqnum
 AND selshp1.cmpcod = selshp2.cmpcod
 AND selshp1.mstdocnum = selshp2.mstdocnum
 AND selshp1.dupnum = selshp2.dupnum
 AND selshp1.docowridr = selshp2.docowridr
 AND selshp1.fltnum = selshp2.fltnum
  AND selshp1.fltcaridr = selshp2.fltcaridr
   AND selshp1.fltseqnum = selshp2.fltseqnum
    AND selshp1.segsernum = selshp2.segsernum
                 AND(SELSHP2.IMPTSCCOLFLG IS NULL OR SELSHP2.IMPTSCCOLFLG <> ?)
                ORDER BY SEQNUM DESC
				]]>
		</QRY:Source>
	</QRY:Definition>

	
<QRY:Definition>
	<QRY:Id>298</QRY:Id>
	<QRY:Source Name="operations.shipment.findhandlingforcarryout" Type="NATIVE">
		<![CDATA[
			    SELECT SHPHDL.MSTDOCNUM  FROM  OPRSHPHDLDTL SHPHDL where
			    SHPHDL.CMPCOD=?
			    AND SHPHDL.ARPCOD=?
			    AND SHPHDL.MSTDOCNUM=?
			    AND SHPHDL.SEQNUM=?
			    AND SHPHDL.DUPNUM=?
			    AND SHPHDL.DOCOWRIDR= ?
			    AND SHPHDL.HDLSTA ='S'


			UNION ALL

			    SELECT ARPSHP.CUSCLRNUM FROM OPRARPSHP ARPSHP  WHERE
			    ARPSHP.CMPCOD= ?
			    AND ARPSHP.ARPCOD= ?
			    AND ARPSHP.MSTDOCNUM= ?
			    AND ARPSHP.SEQNUM= ?
			    AND ARPSHP.DUPNUM= ?
                                    AND ARPSHP.DOCOWRIDR= ?
			]]>
	</QRY:Source>
	</QRY:Definition>

    <QRY:Definition>
		<QRY:Id>353</QRY:Id>
		<QRY:Source Name="operations.shipment.isOLTShipment" Type="NATIVE">
			<![CDATA[
			  SELECT  COLMST.OLTNUM
				FROM  OPRCOLINSMST COLMST,
 					  OPRSHPCOLINS COLINS
				WHERE COLMST.CMPCOD = COLINS.CMPCOD
				  AND COLMST.ARPCOD = COLINS.ARPCOD
				  AND COLMST.DELIDR = COLINS.DELIDR
				  AND COLINS.CMPCOD = ?
				  AND COLINS.DOCOWRIDR = ?
				  AND COLINS.MSTDOCNUM = ?
				  AND COLINS.SEQNUM = ?
				  AND COLINS.DUPNUM = ?
				  AND COLINS.ARPCOD = ?
				  AND COLINS.DELIDR = (SELECT MAX(DELIDR)
                            FROM OPRSHPCOLINS CHDINS
                          WHERE  CHDINS.CMPCOD = ?
                             AND CHDINS.DOCOWRIDR = ?
					         AND CHDINS.MSTDOCNUM = ?
					         AND CHDINS.SEQNUM = ?
					         AND CHDINS.DUPNUM = ?
					         AND CHDINS.ARPCOD = ? )
			]]>
		</QRY:Source>
	</QRY:Definition>
<QRY:Definition>
		<QRY:Id>302</QRY:Id>
		<QRY:Source Name="operations.shipment.cto.flndshipmentdetailsforbondedtransfer" Type="NATIVE">
			<![CDATA[
				SELECT  COLMST.DST,
						COLMST.GRASHT,
						COLMST.NONBUSHURHND,
						COLMST.OLTNUM,
						SELSHP.SELWGT,
            		(SELECT
				       SUM( DLVRTN.RTNWGT  )  RTNWGT
				       FROM OPRSHPDLVRTN DLVRTN
	               WHERE DLVRTN.CMPCOD(+) = COLINS.CMPCOD
	                 AND DLVRTN.DOCOWRIDR(+) = COLINS.DOCOWRIDR
	                 AND DLVRTN.MSTDOCNUM(+) = COLINS.MSTDOCNUM
	                 AND DLVRTN.DUPNUM(+) = COLINS.DUPNUM
	                 AND DLVRTN.SEQNUM(+) = COLINS.SEQNUM
	                 AND DLVRTN.ARPCOD(+) = COLINS.ARPCOD
				    )RTNWGT
				  FROM  OPRSEGSELSHP SELSHP,
						OPRCOLINSMST COLMST,
						OPRSHPCOLINS COLINS

				WHERE COLINS.CMPCOD = SELSHP.CMPCOD
				  AND COLINS.DOCOWRIDR = SELSHP.DOCOWRIDR
				  AND COLINS.MSTDOCNUM = SELSHP.MSTDOCNUM
				  AND COLINS.SEQNUM = SELSHP.SEQNUM
				  AND COLINS.DUPNUM = SELSHP.DUPNUM

				  AND COLMST.CMPCOD = COLINS.CMPCOD
				  AND COLMST.ARPCOD = COLINS.ARPCOD
				  AND COLMST.DELIDR = COLINS.DELIDR

				  AND COLINS.CMPCOD = ?
				  AND COLINS.DOCOWRIDR = ?
				  AND COLINS.MSTDOCNUM = ?
				  AND COLINS.SEQNUM = ?
				  AND COLINS.DUPNUM = ?
				  AND COLINS.ARPCOD = ?

				  AND COLMST.CAROUTTYP = ?

				  AND COLINS.DELIDR = (SELECT MAX(DELIDR) FROM OPRSHPCOLINS CHDINS
										 WHERE  CHDINS.CMPCOD = ?
											AND CHDINS.DOCOWRIDR = ?
											AND CHDINS.MSTDOCNUM = ?
											AND CHDINS.SEQNUM = ?
											AND CHDINS.DUPNUM = ?
											AND CHDINS.ARPCOD = ?)

				]]>
		</QRY:Source>
	</QRY:Definition>
<QRY:Definition>
    <QRY:Id>273</QRY:Id>
    <QRY:Source Name="operations.shipment.cto.findAcceptanceDetailsForCarryOut" Type="OBJECT">
      <![CDATA[
      SELECT INSMST.DELIDR, INSMST.REGTYP, INSMST.CAROUTTYP, INSMST.CAROUTREQ,
              INSMST.GRPIMPNUM, INSMST.DST, INSMST.nonbushurhnd, INSMST.GRASHT, INSMST.OLTNUM,INSMST.SRC,
              SHPINS.MSTDOCNUM, SHPINS.DOCOWRIDR, SHPINS.DUPNUM,SHPINS.SEQNUM,
              SHPINS.ARPCOD,SHPINS.CMPCOD, SHPINS.AGTCOD, SHPMST.SHPPFX, SHPMST.DOCNUM,
              ARPCOL.PAYTYP, ARPCOL.BILRQD, ARPCOL.OLTSTA, ARPCOL.OUTFLG,INSMST.WRKFLOSTA,INSMST.DLVLOC
          FROM OPRCOLINSMST INSMST, OPRSHPCOLINS SHPINS,
             OPRSHPMST SHPMST, OPRARPCOLSHP ARPCOL
          WHERE SHPINS.ARPCOD (+)= INSMST.ARPCOD AND
              SHPINS.CMPCOD (+)= INSMST.CMPCOD AND
              SHPINS.DELIDR(+) = INSMST.DELIDR AND
              SHPMST.MSTDOCNUM (+)= SHPINS.MSTDOCNUM AND
              SHPMST.DOCOWRIDR (+) = SHPINS.DOCOWRIDR AND
              SHPMST.DUPNUM(+) = SHPINS.DUPNUM AND
              SHPMST.SEQNUM (+)= SHPINS.SEQNUM AND
              SHPMST.CMPCOD (+)= SHPINS.CMPCOD AND
              ARPCOL.MSTDOCNUM (+)= SHPINS.MSTDOCNUM AND
              ARPCOL.DOCOWRIDR (+)= SHPINS.DOCOWRIDR AND
              ARPCOL.DUPNUM (+)= SHPINS.DUPNUM AND
              ARPCOL.SEQNUM (+)= SHPINS.SEQNUM AND
              ARPCOL.CMPCOD (+)= SHPINS.CMPCOD AND
              ARPCOL.ARPCOD (+)= SHPINS.ARPCOD AND
              INSMST.ARPCOD = ? AND
              INSMST.CMPCOD = ? AND
              INSMST.DELIDR = ?

        ]]>
        </QRY:Source>
</QRY:Definition>

<QRY:Definition>
		<QRY:Id>274</QRY:Id>
		<QRY:Source Name="operations.shipment.jto.findShipmentDetailsForDPRReport" Type="NATIVE">
			<![CDATA[
				  SELECT DISTINCT IMPFLT.FLTCARCOD,
				   IMPFLT.FLTNUM         ,
				   IMPFLT.FLTDAT         ,
				   SELSHP.SELPCS         ,
				   SELSHP.SELWGT         ,
				   LEG.ATA               ,
				   LEG.STA               ,
				   SELSHP.DOCRCVFLG
				    FROM
				   OPRARPIMPFLT IMPFLT   ,
				   OPRFLTSEG FLTSEG      ,
				   OPRSEGSELSHP SELSHP   ,
				   FLTOPRLEG LEG
				   WHERE LEG.FLTCARIDR = IMPFLT.FLTCARIDR
				 AND LEG.FLTSEQNUM     = IMPFLT.FLTSEQNUM
				 AND LEG.LEGSERNUM     = IMPFLT.LEGSERNUM
				 AND LEG.FLTNUM        = IMPFLT.FLTNUM
				 AND LEG.CMPCOD        = IMPFLT.CMPCOD
				 AND LEG.LEGDST        = IMPFLT.ARPCOD
				 AND SELSHP.CMPCOD        = IMPFLT.CMPCOD
				 AND SELSHP.FLTNUM     = IMPFLT.FLTNUM
				 AND SELSHP.FLTCARIDR  = IMPFLT.FLTCARIDR
				 AND SELSHP.FLTSEQNUM  = IMPFLT.FLTSEQNUM
				 AND SELSHP.CMPCOD     = FLTSEG.CMPCOD
				 AND SELSHP.FLTNUM     = FLTSEG.FLTNUM
				 AND SELSHP.FLTCARIDR  = FLTSEG.FLTCARIDR
				 AND SELSHP.FLTSEQNUM  = FLTSEG.FLTSEQNUM
				 AND SELSHP.CMPCOD     = FLTSEG.CMPCOD
				 AND IMPFLT.ARPCOD     = FLTSEG.POU
				 AND LEG.ATA          IS NOT NULL
				AND SELSHP.DOCRCVFLG = 'Y'
				AND SELSHP.MSTDOCNUM  = ?
				AND SELSHP.DOCOWRIDR  = ?
				AND SELSHP.DUPNUM     = ?
				AND SELSHP.SEQNUM     = ?
				AND SELSHP.CMPCOD     = ?
				ORDER BY LEG.ATA DESC
				]]>
		</QRY:Source>
	</QRY:Definition>
	
<QRY:Definition>
  <QRY:Id>256</QRY:Id>
  <QRY:Source Name="operations.shipment.findSkidDetails" Type="OBJECT">
    <![CDATA[

      SELECT
        operationalSkid
      FROM
        OperationalSkid AS operationalSkid
      WHERE
        operationalSkid.operationalSkidPK.companyCode = ? AND
        operationalSkid.operationalSkidPK.airportCode = ? AND
        operationalSkid.ownerId = ? AND
        operationalSkid.masterDocumentNumber = ? AND
        operationalSkid.duplicateNumber = ? AND
        operationalSkid.sequenceNumber = ?

      ]]>
  </QRY:Source>
</QRY:Definition>	

 <QRY:Definition>
  <QRY:Id>266</QRY:Id>
  <QRY:Source Name="operations.shipment.cto.delivery.finddeliverylistdetails" Type="NATIVE">
    <![CDATA[ SELECT COLINS.DELIDR DELIDR,
             COLINS.MSTDOCNUM MSTDOCNUM,
             COLINS.DOCOWRIDR DOCOWRIDR,
             COLINS.DUPNUM DUPNUM,
             COLINS.SEQNUM SEQNUM,
             COLINS.COLPCS COLPCS,
             SHPMST.DOCNUM DOCNUM,
                 SHPMST.SHPPFX SHPPFX,
             ARPSHP.RCVPCS RCVPCS,
             ARPSHP.RCVWGT RCVWGT,
             COLSHP.RMK RMK,
                       COLINS.CMPCOD,
                       COLINS.ARPCOD,
                       DENSE_RANK() OVER ( ORDER BY   COLINS.DOCOWRIDR,
                                                      COLINS.MSTDOCNUM,
                                                      COLINS.DUPNUM,
                                                      COLINS.SEQNUM,
                                                      COLINS.CMPCOD,
                                                      COLINS.DELIDR) RANK
         FROM OPRSHPCOLINS COLINS,
             WHSOPRSHPLOC SHPLOC,
             OPRARPSHP ARPSHP,
             OPRARPCOLSHP COLSHP,
             OPRSHPMST SHPMST

          WHERE COLINS.MSTDOCNUM  = SHPLOC.MSTDOCNUM
          AND   COLINS.DOCOWRIDR  = SHPLOC.DOCOWRIDR
          AND   COLINS.DUPNUM  = SHPLOC.DUPNUM
          AND   COLINS.SEQNUM  = SHPLOC.SEQNUM
          AND   COLINS.CMPCOD = SHPLOC.CMPCOD
          AND  COLINS.ARPCOD = SHPLOC.ARPCOD
          AND   COLINS.MSTDOCNUM  = ARPSHP.MSTDOCNUM
          AND   COLINS.DOCOWRIDR  = ARPSHP.DOCOWRIDR
          AND   COLINS.DUPNUM  = ARPSHP.DUPNUM
          AND   COLINS.SEQNUM  = ARPSHP.SEQNUM
          AND   COLINS.CMPCOD = ARPSHP.CMPCOD
          AND  COLINS.ARPCOD = ARPSHP.ARPCOD

          AND   COLINS.MSTDOCNUM  = COLSHP.MSTDOCNUM
          AND   COLINS.DOCOWRIDR  = COLSHP.DOCOWRIDR
          AND   COLINS.DUPNUM  = COLSHP.DUPNUM
          AND   COLINS.SEQNUM  = COLSHP.SEQNUM
          AND   COLINS.CMPCOD = COLSHP.CMPCOD
          AND  COLINS.ARPCOD = COLSHP.ARPCOD

          AND   COLINS.MSTDOCNUM  = SHPMST.MSTDOCNUM
          AND   COLINS.DOCOWRIDR  = SHPMST.DOCOWRIDR
          AND   COLINS.DUPNUM  = SHPMST.DUPNUM
          AND   COLINS.SEQNUM  = SHPMST.SEQNUM
          AND   COLINS.CMPCOD = SHPMST.CMPCOD

          AND  COLINS.CMPCOD = ?
          AND   COLINS.ARPCOD = ?
    ]]>
  </QRY:Source>
  </QRY:Definition>
  
  <QRY:Definition>
        <QRY:Id>253</QRY:Id>
        <QRY:Source Name="operations.shipment.cto.delivery.findCTODliverylistDetails" Type="NATIVE">
          <![CDATA[
  
          SELECT MST.MSTDOCNUM,MST.DOCNUM,MST.SEQNUM,MST.SHPPFX,MST.DOCOWRIDR,MST.CMPCOD,MST.ORGCOD,MST.DSTCOD,ARP.RCVPCS,ARP.RCVWGT,MST.SHPDES,
            WHSSHPLOC.LOCCOD,WHSSHPLOC.WHSCOD,ARPCOL.AGTCOD,ARPCOL.SHPPRI,SHPCOL.COLSTA,DLVDTL.VHLTYP,DLVDTL.DLVINF,DLVDTL.DLVRTO,DLVDTL.DRIIDR,
            DLVDTL.RMK,MST.DUPNUM,COLINS.GRPRMK,SHPCOL.DELIDR, MST.STDPCS, MST.STDWGT, ARP.ARPCOD, ARP.AVLPCS, ARP.AVLWGT,ARPCOL.TRKCOM,MSTMIS.COLAGY,
            ARPCOL.OUTTIM
          FROM
            OPRSHPMST MST,
            OPRARPSHP ARP,
            OPRARPCOLSHP ARPCOL,
            OPRCOLINSMST COLINS,
            OPRSHPCOLINS SHPCOL ,
            OPRSHPDLVDTL DLVDTL,
            WHSOPRSHPLOC WHSSHPLOC,
            OPRSHPMSTMIS MSTMIS
          WHERE
            MST.MSTDOCNUM = ARP.MSTDOCNUM AND
            MST.DUPNUM = ARP.DUPNUM AND
            MST.SEQNUM = ARP.SEQNUM AND
            MST.DOCOWRIDR = ARP.DOCOWRIDR AND
            MST.CMPCOD = ARP.CMPCOD AND
            ARP.MSTDOCNUM = ARPCOL.MSTDOCNUM AND
            ARP.DUPNUM = ARPCOL.DUPNUM AND
            ARP.SEQNUM = ARPCOL.SEQNUM AND
            ARP.DOCOWRIDR = ARPCOL.DOCOWRIDR AND
            ARP.CMPCOD = ARPCOL.CMPCOD AND
            ARP.ARPCOD = ARPCOL.ARPCOD AND
            ARP.MSTDOCNUM = SHPCOL.MSTDOCNUM AND
            ARP.DUPNUM = SHPCOL.DUPNUM AND
            ARP.SEQNUM = SHPCOL.SEQNUM AND
            ARP.DOCOWRIDR = SHPCOL.DOCOWRIDR AND
            ARP.CMPCOD = SHPCOL.CMPCOD AND
            ARP.ARPCOD = SHPCOL.ARPCOD AND
            COLINS.CMPCOD  = SHPCOL.CMPCOD AND
            COLINS.DELIDR  = SHPCOL.DELIDR AND
            COLINS.ARPCOD  = SHPCOL.ARPCOD AND
            ARP.MSTDOCNUM = DLVDTL.MSTDOCNUM(+) AND
            ARP.DUPNUM = DLVDTL.DUPNUM(+) AND
            ARP.SEQNUM = DLVDTL.SEQNUM(+) AND
            ARP.DOCOWRIDR = DLVDTL.DOCOWRIDR(+) AND
            ARP.CMPCOD = DLVDTL.CMPCOD(+) AND
            ARP.ARPCOD = DLVDTL.ARPCOD(+) AND
            ARP.MSTDOCNUM = WHSSHPLOC.MSTDOCNUM(+) AND
            ARP.DUPNUM = WHSSHPLOC.DUPNUM(+) AND
            ARP.SEQNUM = WHSSHPLOC.SEQNUM(+) AND
            ARP.DOCOWRIDR= WHSSHPLOC.DOCOWRIDR(+) AND
            ARP.CMPCOD = WHSSHPLOC.CMPCOD(+) AND
            ARP.ARPCOD = WHSSHPLOC.ARPCOD(+) AND
            ARP.MSTDOCNUM = MSTMIS.MSTDOCNUM(+) AND
            ARP.DUPNUM = MSTMIS.DUPNUM(+) AND
            ARP.SEQNUM = MSTMIS.SEQNUM(+) AND
            ARP.DOCOWRIDR = MSTMIS.DOCOWRIDR(+) AND
            ARP.CMPCOD = MSTMIS.CMPCOD(+) AND
            ARP.CMPCOD = ? AND
            ARP.ARPCOD = ?
  
          ]]>
        </QRY:Source>
  </QRY:Definition>
  
   <QRY:Definition>
      <QRY:Id>259</QRY:Id>
      <QRY:Source Name="jto.operations.shipment.cto.delivery.findAWBDetails" Type="NATIVE">
        <![CDATA[
  
          SELECT
            MST.MSTDOCNUM, MST.SHPPFX, MST.DOCNUM, MST.DOCOWRIDR, MST.DUPNUM, MST.SEQNUM, MST.ORGCOD, MST.DSTCOD, MST.SHPDES, MST.AGTCOD, MST.STDPCS, MST.STDWGT, WHSSHPLOC.LOCPCS, WHSSHPLOC.LOCWGT, WHSSHPLOC.LOCCOD, WHSSHPLOC.WHSCOD, WHSSHPLOC.ARPCOD, WHSSHPLOC.CMPCOD,
            ARPSHP.AVLPCS, ARPSHP.AVLWGT, ARPSHP.RCVPCS, ARPSHP.RCVWGT, DLVDTL.VHLTYP, DLVDTL.DLVINF, DLVDTL.DLVRTO, DLVDTL.DRIIDR, DLVDTL.RMK
  
          FROM
            OPRSHPMST MST, WHSOPRSHPLOC WHSSHPLOC, OPRARPSHP ARPSHP, OPRSHPDLVDTL DLVDTL
          WHERE
  
            MST.MSTDOCNUM = ARPSHP.MSTDOCNUM AND
            MST.DUPNUM = ARPSHP.DUPNUM AND
            MST.SEQNUM = ARPSHP.SEQNUM AND
            MST.DOCOWRIDR= ARPSHP.DOCOWRIDR AND
            MST.CMPCOD = ARPSHP.CMPCOD AND
            ARPSHP.MSTDOCNUM = WHSSHPLOC.MSTDOCNUM AND
            ARPSHP.DUPNUM = WHSSHPLOC.DUPNUM AND
            ARPSHP.SEQNUM = WHSSHPLOC.SEQNUM AND
            ARPSHP.DOCOWRIDR= WHSSHPLOC.DOCOWRIDR AND
            ARPSHP.CMPCOD = WHSSHPLOC.CMPCOD AND
            ARPSHP.ARPCOD = WHSSHPLOC.ARPCOD AND
            ARPSHP.MSTDOCNUM = DLVDTL.MSTDOCNUM(+) AND
            ARPSHP.DUPNUM = DLVDTL.DUPNUM(+) AND
            ARPSHP.SEQNUM = DLVDTL.SEQNUM(+) AND
            ARPSHP.DOCOWRIDR = DLVDTL.DOCOWRIDR(+) AND
            ARPSHP.CMPCOD = DLVDTL.CMPCOD(+) AND
            ARPSHP.ARPCOD = DLVDTL.ARPCOD(+) AND
            WHSSHPLOC.CMPCOD = ? AND
            WHSSHPLOC.ARPCOD = ? AND
            WHSSHPLOC.DOCOWRIDR = ? AND
            WHSSHPLOC.MSTDOCNUM = ? AND
            WHSSHPLOC.DUPNUM = ? AND
            WHSSHPLOC.SEQNUM = ?
  
  
          ]]>
      </QRY:Source>
    </QRY:Definition>
  
    <QRY:Definition>
      <QRY:Id>260</QRY:Id>
      <QRY:Source Name="jto.operations.shipment.findShipmentContactDetails" Type="NATIVE">
        <![CDATA[
  
          SELECT SHPMST.MSTDOCNUM, SHPMST.CMPCOD MSTCMPCOD,
                   SHPMST.DUPNUM MSTDUPNUM, SHPMST.SEQNUM MSTSEQNUM,
                   SHPMST.DOCOWRIDR MSTDOCOWRIDR, SHPMST.AGTCOD,
                 SHPMST.AGTNAM, SHPMST.SHPCOD,
                 SHPMST.SHPNAM, SHPMST.SHPPFX,
                 SHPMST.SHPADRONE, SHPMST.CNSCOD,
                 SHPMST.CNSNAM, SHPMST.CNSADRONE,
                 MSTCNT.CNSADRTWO, MSTCNT.CNSCTR,
                 MSTCNT.CNSCTY, MSTCNT.CNSMALIDR,
                 MSTCNT.CNSPRTNFNFLG, MSTCNT.CNSPSTCOD,
                 MSTCNT.CNSSTT, MSTCNT.CNSTELNUM,
                 MSTCNT.SHPACCNUM, MSTCNT.SHPADRTWO,
                 MSTCNT.SHPCTR, MSTCNT.SHPCTY,
                 MSTCNT.SHPMALIDR, MSTCNT.SHPPSTCOD,
                 SHPMST.SHPSTA, MSTCNT.SHPSTT,
                 MSTCNT.SHPTELNUM, MSTCNT.NFYACCNUM,
                 MSTCNT.NFYADRONE, MSTCNT.NFYADRTWO,
                 MSTCNT.NFYCTY, MSTCNT.NFYMALIDR,
                 MSTCNT.NFYSTT, MSTCNT.NFYTELNUM
            FROM OPRSHPMST SHPMST LEFT OUTER JOIN OPRSHPMSTCNT MSTCNT
                 ON SHPMST.CMPCOD = MSTCNT.CMPCOD
               AND SHPMST.MSTDOCNUM = MSTCNT.MSTDOCNUM
               AND SHPMST.DOCOWRIDR = MSTCNT.DOCOWRIDR
               AND SHPMST.DUPNUM = MSTCNT.DUPNUM
               AND SHPMST.SEQNUM = MSTCNT.SEQNUM
           WHERE SHPMST.CMPCOD = ?
               AND SHPMST.SEQNUM = ?
               AND SHPMST.DUPNUM = ?
               AND SHPMST.MSTDOCNUM = ?
               AND SHPMST.DOCOWRIDR = ?
  
          ]]>
      </QRY:Source>
  
    </QRY:Definition>
      <QRY:Definition>
      <QRY:Id>261</QRY:Id>
      <QRY:Source Name="operations.shipment.cto.delivery.findCTODliveryIdDetails" Type="NATIVE">
        <![CDATA[
            SELECT   INS.DELIDR, MST.DLVCRTDAT, SHP.AGTCOD,
             SHP.TRKCOM, INS.CMPCOD, INS.DOCOWRIDR,
             INS.MSTDOCNUM, INS.DUPNUM, INS.SEQNUM,
               SHP.YRD YRD,
             MST.GRPRMK GRPRMK,
             SHP.SHPPRI SHPPRI,
             INS.COLSTA COLSTA,
                       INS.ARPCOD ARPCOD,
                DENSE_RANK() OVER ( ORDER BY INS.DELIDR) RANK
              FROM OPRARPCOLSHP SHP,
             OPRSHPCOLINS INS,
             OPRCOLINSMST MST
             WHERE INS.DELIDR = MST.DELIDR
               AND INS.CMPCOD = MST.CMPCOD
             AND INS.ARPCOD = MST.ARPCOD
               AND SHP.CMPCOD = INS.CMPCOD
               AND SHP.DOCOWRIDR = INS.DOCOWRIDR
               AND SHP.MSTDOCNUM = INS.MSTDOCNUM
               AND SHP.DUPNUM = INS.DUPNUM
               AND SHP.SEQNUM = INS.SEQNUM
  
        ]]>
      </QRY:Source>
  </QRY:Definition>
  
  <QRY:Definition>
	<QRY:Id>341</QRY:Id>
	<QRY:Source Name="operations.shipment.cto.findhandlingdetails" Type="NATIVE">
		<![CDATA[
			SELECT HDLIDR, HNDLNG.CMPCOD, DOCOWRIDR, SEQNUM, DUPNUM, MSTDOCNUM, DOCNUM, CMPNAM,
			CUSCMPCOD, INCHRGNAM, PHN, EML, FLTCARIDR, FLTNUM, FLTDAT,
			PCS, WGT, CMMDTY, URGHNDLNGCIN, URGHNDLNGOUT, DELVRYTIM, VEHNUM, BUCBRKDWN,
			SPLSTGINS, RMK, FLTSEQNUM, LEGSERNUM,
			DECODE(ARL.APHCODUSE,2,ARL.TWOAPHCOD,ARL.THRAPHCOD) AS ARLCOD
			FROM OPRSHPCRGHNDLNG HNDLNG, SHRARLMST ARL
			WHERE ARL.CMPCOD = HNDLNG.CMPCOD AND ARL.ARLIDR = HNDLNG.FLTCARIDR
			AND HNDLNG.CMPCOD = ? AND HNDLNG.MSTDOCNUM = ? AND HNDLNG.DOCOWRIDR = ?
			AND HNDLNG.DUPNUM = ? AND HNDLNG.SEQNUM = ?
			]]>
	</QRY:Source>
</QRY:Definition>

<QRY:Definition>
	<QRY:Id>315</QRY:Id>
	<QRY:Source Name="operations.shipment.cto.findcargohandlingdetailsforwebportal" Type="NATIVE">
		<![CDATA[
			SELECT HDLIDR,HNDLNG.CMPCOD,CMPNAM,INCHRGNAM,PHN,EML,FLTCARIDR,FLTNUM,FLTDAT,SHPPFX,MSTDOCNUM,DOCNUM,PCS,
			WGT,CMMDTY,URGHNDLNGCIN,URGHNDLNGOUT,DELVRYTIM,VEHNUM,SPLSTGINS,BUCBRKDWN,RMK,
			DOCOWRIDR, SEQNUM, DUPNUM,FLTSEQNUM, LEGSERNUM, DECODE(ARL.APHCODUSE,2,ARL.TWOAPHCOD,ARL.THRAPHCOD) AS ARLCOD
			FROM  OPRSHPCRGHNDLNG HNDLNG,SHRARLMST ARL WHERE ARL.CMPCOD = HNDLNG.CMPCOD AND ARL.ARLIDR = HNDLNG.FLTCARIDR AND HDLIDR =?
			]]>
	</QRY:Source>
</QRY:Definition>
<QRY:Definition>
	<QRY:Id>343</QRY:Id>
	<QRY:Source Name="operations.shipment.cto.findcargohandlingawbforflight" Type="NATIVE">
		<![CDATA[
			SELECT HDLIDR, CMPCOD, DOCOWRIDR, SEQNUM, DUPNUM, MSTDOCNUM, DOCNUM, CMPNAM,
			CUSCMPCOD, INCHRGNAM, PHN, EML, FLTCARIDR, FLTNUM, FLTDAT,
			PCS, WGT, CMMDTY, URGHNDLNGCIN, URGHNDLNGOUT, DELVRYTIM, VEHNUM, BUCBRKDWN,
			SPLSTGINS, RMK, FLTSEQNUM, LEGSERNUM
			FROM OPRSHPCRGHNDLNG HNDLNG
			WHERE HNDLNG.CMPCOD = ? AND HNDLNG.FLTCARIDR = ?
			AND HNDLNG.FLTNUM = ? AND HNDLNG.FLTSEQNUM = ?
			]]>
	</QRY:Source>
</QRY:Definition>

<QRY:Definition>
    <QRY:Id>273</QRY:Id>
    <QRY:Source Name="operations.shipment.discrepancy.findskiddamage" Type="NATIVE">
      <![CDATA[
            SELECT OPRSKDDMG.SKDIDR,  OPRSKDDTL.MSTDOCNUM,  OPRSKDDTL.DOCNUM,  OPRSKDDTL.DOCOWRIDR,  OPRSKDDTL.DUPNUM,  OPRSKDDTL.SEQNUM,
              OPRSKDDMG.ARPCOD,  OPRSKDDMG.DMGPCS,  OPRSKDDMG.DMGCOD,  OPRSKDDMG.DMGLVL,  OPRSKDDMG.DMGRMK ,OPRSKDDMG.SERNUM,OPRSKDDTL.CMPCOD,
			  OPRSKDDTL.FLTCARIDR, OPRSKDDTL.FLTNUM, OPRSKDDTL.FLTSEQNUM, OPRSKDDTL.LEGSERNUM, OPRSKDDMG.SRCIND DMGSRCIND, DMGCOD.JPNDMGCODDTL
              FROM OPRSKDDTL,  OPRSKDDMG, SHRDMGCODMST DMGCOD
            WHERE OPRSKDDTL.SKDIDR = OPRSKDDMG.SKDIDR
		      AND OPRSKDDTL.ARPCOD = OPRSKDDMG.ARPCOD
			  AND OPRSKDDTL.CMPCOD = OPRSKDDMG.CMPCOD
			  AND OPRSKDDMG.CMPCOD = DMGCOD.CMPCOD(+)
			  AND OPRSKDDMG.DMGCOD = DMGCOD.DMGCOD(+)
            AND OPRSKDDMG.ARPCOD = ?
            AND OPRSKDDMG.CMPCOD = ?
          ]]>
    </QRY:Source>
  </QRY:Definition>
  
<QRY:Definition>
      <QRY:Id>338</QRY:Id> 
      <QRY:Source Name="operations.shipment.discrepancy.findskiddamageforprint" Type="NATIVE">
        <![CDATA[
              SELECT OPRSKDDTL.CMPCOD, OPRSKDDTL.MSTDOCNUM,  OPRSKDDTL.DOCOWRIDR,  OPRSKDDTL.DUPNUM,  OPRSKDDTL.SEQNUM,
	      	                      DMGCOD.ARPCOD,  DMGCOD.DMGLVL,  DMGCOD.JPNDMGCODDTL,  SUM(DMGCOD.DMGPCS) DMGPCS
	      	                      FROM OPRSKDDTL,  (SELECT CMPCOD         ,
	      	      			    ARPCOD               ,
	      	      			    SKDIDR               ,
	      	      			    DMGLVL               ,
	      	      			    DMGPCS               ,
	      	      			    DMGCOD               ,
	      	      			    SRCIND               ,
	      						SERNUM               ,
	      	      			    DMGDES JPNDMGCODDTL
	      	      			     FROM
	      	      			    (SELECT CMPCOD,
	      	      			      ARPCOD      ,
	      	      			      SKDIDR      ,
	      	      			      DMGLVL      ,
	      	      			      DMGPCS      ,
	      	      			      DMGCOD      ,
	      	      			      SRCIND      ,
	      						  SERNUM      ,
	      	      			      DMGDES      ,
	      	      			      MAX(DMGDES) OVER(PARTITION BY CMPCOD, ARPCOD , SKDIDR , DMGLVL , DMGPCS , DMGCOD, SRCIND, SERNUM) MAXDMGDES
	      	      			       FROM
	      	      			      (SELECT CMPCOD,
	      	      			        ARPCOD      ,
	      	      			        SKDIDR      ,
	      	      			        DMGLVL      ,
	      	      			        DMGPCS      ,
	      	      			        DMGCOD      ,
	      	      			        SRCIND      ,
	      							SERNUM      ,
	      	      			        RTRIM(LTRIM( JPYDES, ',' ),',') DMGDES
	      	      			         FROM
	      	      			        (SELECT DMG.CMPCOD,
	      	      			          DMG.ARPCOD      ,
	      	      			          DMG.SKDIDR      ,
	      	      			          DMG.DMGLVL      ,
	      	      			          DMG.DMGPCS      ,
	      	      			          DMG.DMGCOD      ,
	      	      			          DMG.SRCIND      ,
	      							  DMG.SERNUM,
	      	      			          SHR.JPNDMGCODDTL,
	      	      			          ROW_NUMBER( ) OVER( PARTITION BY DMG.CMPCOD, DMG.ARPCOD, DMG.SKDIDR, DMG.DMGLVL,DMG.DMGPCS, DMG.DMGCOD, DMG.SRCIND, DMG.SERNUM ORDER BY SHR.JPNDMGCODDTL ) SLNO
	      	      			           FROM OPRSKDDMG DMG,
	      	      			          SHRDMGCODMST SHR
	      	      			          WHERE DMG.CMPCOD                  = SHR.CMPCOD(+)
	      	      			        AND INSTR(DMG.DMGCOD, SHR.DMGCOD(+))>0
	      	      			        )MODEL PARTITION BY( CMPCOD, ARPCOD, SKDIDR, DMGLVL, DMGPCS, DMGCOD, SRCIND, SERNUM ) DIMENSION BY( SLNO ) MEASURES(JPNDMGCODDTL, CAST( '' AS VARCHAR2( 1000 ) )AS JPYDES ) RULES SEQUENTIAL ORDER ( JPYDES[SLNO]
	      	      			     ORDER BY SLNO = JPYDES[CV( ) - 1]
	      	      			        ||','
	      	      			        || JPNDMGCODDTL[CV( )] )
	      	      			      )
	      	      			    )
	      	      			    WHERE DMGDES = MAXDMGDES
	      	      			  OR DMGDES     IS NULL
	      	      			  ) DMGCOD
	      	                    WHERE OPRSKDDTL.SKDIDR = DMGCOD.SKDIDR
	      	        		      AND OPRSKDDTL.ARPCOD = DMGCOD.ARPCOD
	      	        			  AND OPRSKDDTL.CMPCOD = DMGCOD.CMPCOD
	      	        			  AND DMGCOD.SRCIND = 'DLV'
	      	                      AND DMGCOD.ARPCOD = ?
                AND DMGCOD.CMPCOD = ?
            ]]>
      </QRY:Source>
  </QRY:Definition>  
  
  
  <QRY:Definition>
  		<QRY:Id>277</QRY:Id>
  		<QRY:Source Name="operations.shipment.cto.findshipmentsforuldsintruck" Type="NATIVE">
  			<![CDATA[
  					 SELECT TRKDTL.ACPIDR ,
                         LDRDTL.ULDNUM ,
                         TRKDTL.ARPCOD ,
                         ULDACP.ULDNUM ULDACPULDNUM,
                         LDRSHP.CMPCOD ,
                         SHPMST.MSTDOCNUM ,
                         SHPMST.SEQNUM ,
                         SHPMST.STDPCS ,
                         SHPMST.STDWGT ,
                         SHPMST.DOCNUM ,
                         SHPMST.DOCOWRIDR ,
                         LDRSHP.DUPNUM ,
                         ARPSHP.MSTAWBCHKFLG ,
                         ULDACP.SERNUM ULDSERNUM ,
                         SHPMST.SCCCOD ,
                         SHPMST.SHPPFX ,
                         LDRSHP.LDRPCS ,
                         SHPMST.PARSEQNUM ,
                         TXNHSE.SERNUM TXNSERNUM ,
						 TXNHSE.TXNREFFOR,
						 TXNHSE.TXNREFSIX,
                         SHPMST.SHPDES ,
                         LDRSHP.LDRWGT ,
                         LDRSHP.NCSPCS ,
                         LDRSHP.NCSWGT
                       FROM OPRACPTRKDTL TRKDTL
                       INNER JOIN OPRTRKLDR TRKLDR
                       ON TRKDTL.CMPCOD  = TRKLDR.CMPCOD
                       AND TRKDTL.ACPIDR = TRKLDR.ACPIDR
                       INNER JOIN OPRLDRDTL LDRDTL
                       ON TRKLDR.CMPCOD  = LDRDTL.CMPCOD
                       AND TRKLDR.LDRNUM = LDRDTL.LDRNUM
                       INNER JOIN OPRLDRSHP LDRSHP
                       ON LDRDTL.CMPCOD  = LDRSHP.CMPCOD
                       AND LDRDTL.LDRNUM = LDRSHP.LDRNUM
                       LEFT OUTER JOIN OPRULDACPDTL ACPDTL
                       ON LDRSHP.CMPCOD     = ACPDTL.CMPCOD
                       AND LDRSHP.MSTDOCNUM = ACPDTL.MSTDOCNUM
                       AND LDRSHP.DUPNUM    =acpdtl.dupnum
                       AND ldrshp.docowridr =acpdtl.docowridr
                       AND LDRDTL.ULDNUM    = ACPDTL.ULDNUM
                       LEFT OUTER JOIN OPRULDACP ULDACP
                       ON ACPDTL.CMPCOD     = ULDACP.CMPCOD
                       AND ACPDTL.ARPCOD    = ULDACP.ARPCOD
                       AND ACPDTL.ULDNUM    = ULDACP.ULDNUM
                       AND ACPDTL.ULDSERNUM =ULDACP.SERNUM
                       INNER JOIN OPRSHPMST SHPMST
                       ON LDRSHP.CMPCOD     = SHPMST.CMPCOD
                       AND LDRSHP.MSTDOCNUM = SHPMST.MSTDOCNUM
                       AND LDRSHP.SEQNUM    = SHPMST.SEQNUM
                       AND LDRSHP.DUPNUM    = SHPMST.DUPNUM
                       AND LDRSHP.DOCOWRIDR = SHPMST.DOCOWRIDR
                       LEFT OUTER JOIN OPRARPSHP ARPSHP
                       ON LDRSHP.CMPCOD     = ARPSHP.CMPCOD
                       AND LDRSHP.MSTDOCNUM = ARPSHP.MSTDOCNUM
                       AND LDRSHP.SEQNUM    = ARPSHP.SEQNUM
                       AND LDRSHP.DUPNUM    = ARPSHP.DUPNUM
                       AND LDRSHP.DOCOWRIDR = ARPSHP.DOCOWRIDR
                       LEFT OUTER JOIN OPRTXNHSE TXNHSE
                       ON LDRSHP.CMPCOD     = TXNHSE.CMPCOD
                       AND LDRSHP.MSTDOCNUM = TXNHSE.MSTDOCNUM
                       AND LDRSHP.SEQNUM    = TXNHSE.SEQNUM
                       AND LDRSHP.DUPNUM    = TXNHSE.DUPNUM
                       AND LDRSHP.DOCOWRIDR = TXNHSE.DOCOWRIDR
                       AND LDRDTL.ULDNUM    = TXNHSE.TXNREFSIX
                       AND TXNHSE.TXNCOD    = 'ACP'
                       WHERE TRKDTL.ACPIDR  = ?
                       AND TRKDTL.CMPCOD    = ?
                      AND TRKDTL.ARPCOD    = ?
  
  
  					]]>
  		</QRY:Source>
	</QRY:Definition>
	
<QRY:Definition>
    <QRY:Id>263</QRY:Id>
    <QRY:Source Name="operations.shipment.cto.discrepancycorrection.finddiscrepancyshipments" Type="NATIVE">
      <![CDATA[
          SELECT FLTSEG.CMPCOD,
            FLTSEG.FLTNUM,
            FLTSEG.FLTCARIDR,
            FLTSEG.FLTSEQNUM,
            FLTSEG.SEGSERNUM,
            IMPFLT.ARPCOD,
            IMPFLT.FLTCARCOD,
            IMPFLT.FLTOPRSTA,  FLT.FLTDAT,
            MST.SHPPFX  SHPPFX,
            MST.DOCOWRIDR,
            MST.MSTDOCNUM MSTDOCNUM,
            MST.SEQNUM,
            MST.DUPNUM,
            MST.DOCNUM,
             SHRARP.CNTCOD,
            DIS.DISCOD,
            SUM(CASE
			   WHEN SEG.SELPREFLG IS NOT NULL
			   THEN SEGSEL.SELPCS
			   ELSE SEG.MFTPCS
			 END) AS SUMMFTPCS,
            SUM(CASE
			   WHEN SEG.SELPREFLG IS NOT NULL
			   THEN SEGSEL.SELWGT
			   ELSE SEG.MFTWGT
			 END) AS SUMMFTWGT,
            SUM(SEG.RCVPCS) AS SUMRCVPCS,
            SUM(SEG.RCVWGT) AS SUMRCVWGT,
            MST.SHPDES,
            MST.SCCCOD,
            SEGSEL.ACHSTA , SEGSEL.PKGSTA,SEGSEL.BINSTA,
            SEGSEL.DSTCOD, SEG.NXTCARCOD,SEGSEL.SHPSYN
            FROM ( SELECT SEGSHP.* ,
			  (SELECT 'Y'
				 FROM DUAL
				WHERE EXISTS
				(SELECT MSTDOCNUM
				   FROM OPRSEGSELSHP SELTST
				  WHERE SELTST.CMPCOD   = SEGSHP.CMPCOD
				AND SELTST.DOCOWRIDR    = SEGSHP.DOCOWRIDR
				AND SELTST.MSTDOCNUM    = SEGSHP.MSTDOCNUM
				AND SELTST.DUPNUM       = SEGSHP.DUPNUM
				AND SELTST.SEQNUM       = SEGSHP.SEQNUM
				AND SELTST.FLTCARIDR    = SEGSHP.FLTCARIDR
				AND SELTST.FLTNUM       = SEGSHP.FLTNUM
				AND SELTST.FLTSEQNUM = SEGSHP.FLTSEQNUM
				)
				  ) SELPREFLG	FROM
					 OPRSEGSHP SEGSHP ) SEG,
            OPRSEGSELSHP SEGSEL,
            OPRFLTSEG FLTSEG,
            OPRARPIMPFLT IMPFLT,
            OPRSHPMST MST, SHRARPMST SHRARP, OPRSHPDIS DIS,
            OPRDMGDIS DMG,
            OPRFNDSHP FNDSHP,
            OPRFNDSHPDMG FNDDMG,
            FLTOPRMST FLT
            WHERE SEG.CMPCOD = FLTSEG.CMPCOD
           AND SEG.FLTNUM = FLTSEG.FLTNUM
           AND SEG.FLTSEQNUM = FLTSEG.FLTSEQNUM
           AND SEG.FLTCARIDR = FLTSEG.FLTCARIDR
           AND SEG.SEGSERNUM = FLTSEG.SEGSERNUM
           AND FLTSEG.CMPCOD = IMPFLT.CMPCOD
           AND FLTSEG.FLTNUM = IMPFLT.FLTNUM
           AND FLTSEG.FLTSEQNUM = IMPFLT.FLTSEQNUM
           AND FLTSEG.FLTCARIDR = IMPFLT.FLTCARIDR
           AND FLTSEG.POU = IMPFLT.ARPCOD
           AND SEG.CMPCOD = SEGSEL.CMPCOD
           AND SEG.DOCOWRIDR = SEGSEL.DOCOWRIDR
           AND SEG.MSTDOCNUM = SEGSEL.MSTDOCNUM
           AND SEG.DUPNUM = SEGSEL.DUPNUM
           AND SEG.SEQNUM = SEGSEL.SEQNUM
           AND SEG.CMPCOD = SEGSEL.CMPCOD
           AND SEG.FLTNUM = SEGSEL.FLTNUM
           AND SEG.FLTSEQNUM = SEGSEL.FLTSEQNUM
           AND SEG.FLTCARIDR = SEGSEL.FLTCARIDR
           AND SEG.SEGSERNUM = SEGSEL.SEGSERNUM
           AND SEG.CMPCOD = MST.CMPCOD
           AND SEG.DOCOWRIDR = MST.DOCOWRIDR
           AND SEG.MSTDOCNUM = MST.MSTDOCNUM
           AND SEG.DUPNUM = MST.DUPNUM
           AND SEG.SEQNUM = MST.SEQNUM
           AND IMPFLT.CMPCOD = FLT.CMPCOD
           AND IMPFLT.FLTCARIDR = FLT.FLTCARIDR
           AND IMPFLT.FLTNUM = FLT.FLTNUM
           AND IMPFLT.FLTSEQNUM = FLT.FLTSEQNUM
           AND MST.CMPCOD =  SHRARP.CMPCOD(+)
           AND MST.DSTCOD       = SHRARP.ARPCOD(+)
           AND SEG.CMPCOD = DIS.CMPCOD(+)
           AND SEG.FLTNUM = DIS.FLTNUM(+)
           AND SEG.FLTSEQNUM = DIS.FLTSEQNUM(+)
           AND SEG.FLTCARIDR = DIS.FLTCARIDR(+)
           AND SEG.DOCOWRIDR = DIS.DOCOWRIDR(+)
           AND SEG.MSTDOCNUM = DIS.MSTDOCNUM(+)
           AND SEG.DUPNUM = DIS.DUPNUM(+)
           AND SEG.SEQNUM = DIS.SEQNUM(+)
           AND DIS.ARPCOD(+) = ?
           AND SEG.CMPCOD = DMG.CMPCOD(+)
           AND DMG.ARPCOD(+) = ?
           AND SEG.FLTNUM = DMG.FLTNUM(+)
           AND SEG.FLTSEQNUM = DMG.FLTSEQNUM(+)
           AND SEG.FLTCARIDR = DMG.FLTCARIDR(+)
           AND SEG.DOCOWRIDR = DMG.DOCOWRIDR(+)
           AND SEG.MSTDOCNUM = DMG.MSTDOCNUM(+)
           AND SEG.DUPNUM = DMG.DUPNUM(+)
           AND SEG.SEQNUM = DMG.SEQNUM(+)
           AND IMPFLT.CMPCOD = FNDSHP.CMPCOD(+)
           AND IMPFLT.FLTNUM = FNDSHP.FLTNUM(+)
           AND IMPFLT.FLTSEQNUM = FNDSHP.FLTSEQNUM(+)
           AND IMPFLT.FLTCARIDR = FNDSHP.FLTCARIDR(+)
           AND IMPFLT.ARPCOD = FNDSHP.ARPCOD(+)
           AND MST.CMPCOD = FNDDMG.CMPCOD(+)
           AND MST.MSTDOCNUM = FNDDMG.FNDSHPNUM(+)
           AND FNDDMG.ARPCOD(+) = ?
           AND IMPFLT.CMPCOD = ?

      ]]>
    </QRY:Source>
  </QRY:Definition>	
  <QRY:Definition>
  <QRY:Id>264</QRY:Id>
  <QRY:Source Name="operations.shipment.findandlockshipments" Type="NATIVE">
  	<![CDATA[
  	SELECT MST.DOCOWRIDR,MST.DUPNUM,MST.SEQNUM,MST.CMPCOD,
  	MST.SHPPFX,MST.MSTDOCNUM,MST.DOCTYP,MST.MSTDOCNUM DOCNUM,
  	MST.CPTDAT,MST.OWRCOD,MST.CNSCOD,MST.ORGCOD,
  	MST.DSTCOD,MST.SHPSTA,MST.UBRNUM,MST.SHPTYP,MST.PRGSTA,MST.CONFLG,
  	MST.SCCCOD, MST.LSTUPDTIM, MST.LSTUPDUSR
  	FROM OPRSHPIDX MST
  	WHERE MST.CMPCOD=?
  	AND   MST.MSTDOCNUM=?
  	AND   MST.DOCOWRIDR=?
  	FOR UPDATE
  ]]>
  </QRY:Source>
  </QRY:Definition>

  
  <QRY:Definition>
	<QRY:Id>342</QRY:Id>
	<QRY:Source Name="operations.shipment.cto.findmanifestedshipmentsforcto" Type="NATIVE">
		<![CDATA[
			select segshp.mstdocnum,segshp.docowridr,segshp.dupnum,segshp.seqnum,segshp.cmpcod,segshp.FLTNUM,segshp.FLTCARIDR,segshp.FLTSEQNUM from oprsegshp segshp,oprsegselshp selshp
			where    segshp.FLTNUM = selshp.FLTNUM
				AND segshp.FLTCARIDR = selshp.FLTCARIDR
				AND segshp.FLTSEQNUM = selshp.FLTSEQNUM
				AND  segshp.MSTDOCNUM = selshp.MSTDOCNUM
				AND segshp.DOCOWRIDR = selshp.DOCOWRIDR
				AND segshp.DUPNUM = selshp.DUPNUM
				AND segshp.SEQNUM = selshp.SEQNUM
				AND segshp.CMPCOD = selshp.CMPCOD
			AND(selshp.selpcs> 0 or segshp.mftpcs>0)
			AND segshp.FLTNUM = ?
			AND segshp.FLTSEQNUM = ?
			AND segshp.FLTCARIDR = ?
			AND segshp.CMPCOD = ?
			]]>
	</QRY:Source>
</QRY:Definition>

<QRY:Definition>
   <QRY:Id>268</QRY:Id>
   <QRY:Source Name="operations.shipment.cto.finddetailsforholdlist" Type="NATIVE">
    <![CDATA[

  SELECT SHPMST.CONFLG,SHPMST.CMPCOD, SHPMST.SHPPFX,
     SHPBLK.DOCOWRIDR, SHPBLK.SEQNUM,
       SHPBLK.DUPNUM, SHPBLK.MSTDOCNUM,
     SHPBLK.DOCNUM, SHPBLK.BLKSTA,
       SHPBLK.BLKRMK, SHPBLK.HLDRSNCOD,
     SUM(SEGSHP.RCVPCS) RCVPCS, SHPBLK.SERNUM, SUM((CASE
          WHEN SEGSHP.SELPREFLG IS NOT NULL
            THEN SELSHP.SELPCS
          ELSE SEGSHP.MFTPCS
        END)) MFTPCS,IMP.EPKFLG

  FROM OPRSHPMST SHPMST, OPRSHPBLK SHPBLK,  ( SELECT SEGSHP.* ,
  (SELECT 'Y'
     FROM DUAL
    WHERE EXISTS
    (SELECT MSTDOCNUM
       FROM OPRSEGSELSHP SELTST
      WHERE SELTST.CMPCOD   = SEGSHP.CMPCOD
    AND SELTST.DOCOWRIDR    = SEGSHP.DOCOWRIDR
    AND SELTST.MSTDOCNUM    = SEGSHP.MSTDOCNUM
    AND SELTST.DUPNUM       = SEGSHP.DUPNUM
    AND SELTST.SEQNUM       = SEGSHP.SEQNUM
    AND SELTST.FLTCARIDR    = SEGSHP.FLTCARIDR
    AND SELTST.FLTNUM       = SEGSHP.FLTNUM
    AND SELTST.FLTSEQNUM = SEGSHP.FLTSEQNUM
    )
	  ) SELPREFLG	FROM
		 OPRSEGSHP SEGSHP ) SEGSHP,
  OPRFLTSEG FLTSEG, OPRSEGSELSHP SELSHP,OPRARPIMPFLT IMP, OPRSHPBLKFLT BLKFLT

  WHERE SHPMST.CMPCOD = SHPBLK.CMPCOD
   AND SHPMST.SEQNUM = SHPBLK.SEQNUM
   AND SHPMST.DUPNUM = SHPBLK.DUPNUM
   AND SHPMST.DOCOWRIDR = SHPBLK.DOCOWRIDR
   AND SHPMST.MSTDOCNUM = SHPBLK.MSTDOCNUM

   AND SHPMST.CMPCOD = SEGSHP.CMPCOD
   AND SHPMST.SEQNUM = SEGSHP.SEQNUM
   AND SHPMST.DUPNUM = SEGSHP.DUPNUM
   AND SHPMST.DOCOWRIDR = SEGSHP.DOCOWRIDR
   AND SHPMST.MSTDOCNUM = SEGSHP.MSTDOCNUM

   AND SHPBLK.ARPCOD = FLTSEG.POU
   AND SHPBLK.CMPCOD = BLKFLT.CMPCOD
   AND SHPBLK.SEQNUM = BLKFLT.SEQNUM
   AND SHPBLK.DUPNUM = BLKFLT.DUPNUM
   AND SHPBLK.DOCOWRIDR = BLKFLT.DOCOWRIDR
   AND SHPBLK.MSTDOCNUM = BLKFLT.MSTDOCNUM
   AND SHPBLK.SERNUM = BLKFLT.SERNUM
   AND BLKFLT.FLTNUM = IMP.FLTNUM
   AND BLKFLT.FLTCARIDR = IMP.FLTCARIDR
   AND BLKFLT.FLTSEQNUM = IMP.FLTSEQNUM
   AND BLKFLT.BLKSTA = 'B'

   AND SEGSHP.CMPCOD = FLTSEG.CMPCOD
   AND SEGSHP.FLTCARIDR = FLTSEG.FLTCARIDR
   AND SEGSHP.FLTNUM = FLTSEG.FLTNUM
   AND SEGSHP.SEGSERNUM = FLTSEG.SEGSERNUM
   AND SEGSHP.FLTSEQNUM = FLTSEG.FLTSEQNUM

  AND SEGSHP.CMPCOD = SELSHP.CMPCOD (+)
   AND SEGSHP.FLTCARIDR = SELSHP.FLTCARIDR (+)
   AND SEGSHP.FLTNUM = SELSHP.FLTNUM (+)
   AND SEGSHP.SEGSERNUM = SELSHP.SEGSERNUM (+)
   AND SEGSHP.FLTSEQNUM = SELSHP.FLTSEQNUM (+)
  AND SEGSHP.SEQNUM = SELSHP.SEQNUM (+)
   AND SEGSHP.DUPNUM = SELSHP.DUPNUM (+)
   AND SEGSHP.DOCOWRIDR = SELSHP.DOCOWRIDR (+)
   AND SEGSHP.MSTDOCNUM = SELSHP.MSTDOCNUM (+)
   AND FLTSEG.FLTCARIDR = IMP.FLTCARIDR
   AND FLTSEG.FLTNUM    = IMP.FLTNUM
   AND FLTSEG.FLTSEQNUM = IMP.FLTSEQNUM
   AND FLTSEG.CMPCOD    = IMP.CMPCOD
   AND IMP.ARPCOD       = FLTSEG.POU
  AND SHPBLK.CMPCOD=?
    ]]>
   </QRY:Source>
  </QRY:Definition>
  
   <QRY:Definition>
    <QRY:Id>242</QRY:Id>
    <QRY:Source Name="operations.shipment.findHoldBUCHandling" Type="NATIVE">
      <![CDATA[
  
      SELECT
        SHPMST.MSTDOCNUM MSTDOCNUM,
         SHPMST.DOCNUM DOCNUM,
         SHPMST.SEQNUM SEQNUM,
         SHPMST.DUPNUM DUPNUM,
         SHPMST.CMPCOD CMPCOD,
         SHPMST.DOCOWRIDR DOCOWRIDR,
        0 STDPCS,
         0 MFTPCS,
         0 RCVPCS,
         NULL CONFLG,
        0 PARSEQNUM,
        NULL SHPPFX,
        SEGSHP.FLTNUM,
        SEGSHP.FLTSEQNUM,
        SEGSHP.FLTCARIDR,
        NULL FLTDAT,
        IMPFLT.ARPCOD ARPCOD,
        NULL FLTCARCOD,
         NULL EPKFLG,
        NULL SELENDFLG,
        NULL CARCHKENDFLG,
         HDLDTL.HDLTYP HDLTYP,
         HDLDTL.HDLSTA HDLSTA,
         HDLDTL.HDLIDR HDLIDR,
         NULL ARACOD,
         0 ARAMFTPCS,
         0 ARAMFTWGT,
         0 ARARCVPCS,
         0 ARARCVWGT,
         NULL DMGCOD,
         NULL DMGLVL,
         0 DMGPCS,
         0 DMGSERNUM,
         NULL DMGSKDIDR,
         NULL DMGRMK,
        NULL BLKSTA,
         NULL BLKRMK,
         NULL HLDRSNCOD,
         0 BLKSERNUM,
         NULL PARCONFLG,
         0 CNT,
        NULL BUCFLG,
        0 SELPCS,
          NULL ANT_FLTNUM,
        0 ANT_FLTSEQNUM,
          0 ANT_FLTCARIDR,
          NULL ANT_FLTCARCOD,
          NULL ANT_FLTDAT, NULL INHFLG,
          SHPMIS.BDNSRTFLG,NULL SHPLOCCOD, 0 BLKCNT, NULL FRCRLSFLG,NULL STA
       FROM
         OPRSHPHDLDTL HDLDTL,
         OPRSHPMST SHPMST,
         OPRSEGSHP SEGSHP,
         OPRFLTSEG FLTSEG,
         OPRARPIMPFLT IMPFLT,
         OPRSHPMSTMIS SHPMIS
       WHERE
         SHPMST.CMPCOD = SEGSHP.CMPCOD
        AND SHPMST.SEQNUM = SEGSHP.SEQNUM
        AND SHPMST.DUPNUM = SEGSHP.DUPNUM
        AND SHPMST.MSTDOCNUM = SEGSHP.MSTDOCNUM
        AND SHPMST.DOCOWRIDR = SEGSHP.DOCOWRIDR
        AND SEGSHP.FLTCARIDR = FLTSEG.FLTCARIDR
        AND SEGSHP.CMPCOD = FLTSEG.CMPCOD
        AND SEGSHP.FLTNUM = FLTSEG.FLTNUM
        AND SEGSHP.FLTSEQNUM = FLTSEG.FLTSEQNUM
        AND SEGSHP.SEGSERNUM = FLTSEG.SEGSERNUM
        AND FLTSEG.FLTNUM = IMPFLT.FLTNUM
        AND FLTSEG.FLTCARIDR = IMPFLT.FLTCARIDR
        AND FLTSEG.FLTSEQNUM = IMPFLT.FLTSEQNUM
        AND FLTSEG.CMPCOD = IMPFLT.CMPCOD
        AND FLTSEG.POU = IMPFLT.ARPCOD
        AND SHPMST.CMPCOD = HDLDTL.CMPCOD
        AND SHPMST.SEQNUM = HDLDTL.SEQNUM
        AND SHPMST.DUPNUM = HDLDTL.DUPNUM
        AND SHPMST.MSTDOCNUM = HDLDTL.MSTDOCNUM
        AND SHPMST.DOCOWRIDR = HDLDTL.DOCOWRIDR
        AND SHPMST.CMPCOD = SHPMIS.CMPCOD
        AND SHPMST.SEQNUM = SHPMIS.SEQNUM
        AND SHPMST.DUPNUM = SHPMIS.DUPNUM
        AND SHPMST.MSTDOCNUM = SHPMIS.MSTDOCNUM
        AND SHPMST.DOCOWRIDR = SHPMIS.DOCOWRIDR
      ]]>
    </QRY:Source>
</QRY:Definition>

 <QRY:Definition>
  <QRY:Id>247</QRY:Id>
  <QRY:Source Name="operations.shipment.findHoldMAWBCheck" Type="NATIVE">
    <![CDATA[

    SELECT
      SHPMST.MSTDOCNUM MSTDOCNUM,
    SHPMST.DOCNUM DOCNUM,
    SHPMST.SEQNUM SEQNUM,
    SHPMST.DUPNUM DUPNUM,
    SHPMST.CMPCOD CMPCOD,
    SHPMST.DOCOWRIDR DOCOWRIDR,
    0 STDPCS,
    0 MFTPCS,
    0 RCVPCS,
    NULL CONFLG,
    0 PARSEQNUM,
      NULL SHPPFX,
    SEGSHP.FLTNUM,
    SEGSHP.FLTSEQNUM,
    SEGSHP.FLTCARIDR,
      NULL FLTDAT,
    IMPFLT.ARPCOD ARPCOD,
    NULL FLTCARCOD,
    NULL EPKFLG,
    NULL SELENDFLG,
    NULL CARCHKENDFLG,
    NULL HDLTYP,
    NULL HDLSTA,
    NULL HDLIDR,
    NULL ARACOD,
    0 ARAMFTPCS,
    0 ARAMFTWGT,
    0 ARARCVPCS,
    0 ARARCVWGT,
    NULL DMGCOD,
    NULL DMGLVL,
    0 DMGPCS,
    0 DMGSERNUM,
    NULL DMGSKDIDR,
    NULL DMGRMK,
    NULL BLKSTA,
    NULL BLKRMK,
    NULL HLDRSNCOD,
    0 BLKSERNUM,
    NULL PARCONFLG,
    COUNT(SEGSHP.MSTDOCNUM) CNT,
    NULL BUCFLG,
    0 SELPCS,
    NULL ANT_FLTNUM,
    0 ANT_FLTSEQNUM,
    0 ANT_FLTCARIDR,
    NULL ANT_FLTCARCOD,
    NULL ANT_FLTDAT, NULL INHFLG,
    SHPMIS.BDNSRTFLG ,NULL SHPLOCCOD, 0 BLKCNT, NULL FRCRLSFLG,NULL STA
     FROM OPRSHPMST SHPMST,
        OPRSEGSHP SEGSHP,
        OPRARPIMPFLT IMPFLT,
        OPRFLTSEG FLTSEG,
        OPRSHPMSTMIS SHPMIS
    WHERE
      SHPMST.CMPCOD = SEGSHP.CMPCOD
       AND SHPMST.DUPNUM = SEGSHP.DUPNUM
       AND SHPMST.MSTDOCNUM = SEGSHP.MSTDOCNUM
       AND SHPMST.DOCOWRIDR = SEGSHP.DOCOWRIDR
       AND SEGSHP.SEQNUM > SHPMST.SEQNUM
       AND SEGSHP.FLTCARIDR = FLTSEG.FLTCARIDR
       AND SEGSHP.CMPCOD = FLTSEG.CMPCOD
       AND SEGSHP.FLTNUM = FLTSEG.FLTNUM
       AND SEGSHP.FLTSEQNUM = FLTSEG.FLTSEQNUM
       AND SEGSHP.SEGSERNUM = FLTSEG.SEGSERNUM
       AND FLTSEG.FLTNUM = IMPFLT.FLTNUM
       AND FLTSEG.FLTCARIDR = IMPFLT.FLTCARIDR
       AND FLTSEG.FLTSEQNUM = IMPFLT.FLTSEQNUM
       AND FLTSEG.CMPCOD = IMPFLT.CMPCOD
       AND FLTSEG.POU = IMPFLT.ARPCOD
       AND SHPMST.CMPCOD = SHPMIS.CMPCOD
      AND SHPMST.SEQNUM = SHPMIS.SEQNUM
      AND SHPMST.DUPNUM = SHPMIS.DUPNUM
      AND SHPMST.MSTDOCNUM = SHPMIS.MSTDOCNUM
      AND SHPMST.DOCOWRIDR = SHPMIS.DOCOWRIDR
    ]]>
  </QRY:Source>
</QRY:Definition>

<QRY:Definition>
  <QRY:Id>241</QRY:Id>
  <QRY:Source Name="operations.shipment.findHoldMasterDetails" Type="NATIVE">
    <![CDATA[

  SELECT
       SHPMST.MSTDOCNUM MSTDOCNUM,
       SHPMST.DOCNUM DOCNUM,
       SHPMST.SEQNUM SEQNUM,
       SHPMST.DUPNUM DUPNUM,
       SHPMST.CMPCOD CMPCOD,
       SHPMST.DOCOWRIDR DOCOWRIDR,
       SHPMST.STDPCS STDPCS,
       SUM(SEGSHP.MFTPCS) MFTPCS,
       SUM(SEGSHP.RCVPCS) RCVPCS,
       SHPMST.CONFLG CONFLG,
      SHPMST.PARSEQNUM PARSEQNUM,
      SHPMST.SHPPFX SHPPFX,
      SEGSHP.FLTNUM FLTNUM,
      SEGSHP.FLTSEQNUM FLTSEQNUM,
      SEGSHP.FLTCARIDR FLTCARIDR,
      IMPFLT.FLTDAT FLTDAT,
      IMPFLT.ARPCOD ARPCOD,
      IMPFLT.FLTCARCOD FLTCARCOD,
       IMPFLT.EPKFLG EPKFLG,
      IMPFLT.FLGFLG SELENDFLG,
      IMPFLT.CARCHKENDFLG CARCHKENDFLG,
       NULL HDLTYP,
       NULL HDLSTA,
       NULL HDLIDR,
       NULL ARACOD,
       0 ARAMFTPCS,
       0 ARAMFTWGT,
       0 ARARCVPCS,
       0 ARARCVWGT,
       NULL DMGCOD,
       NULL DMGLVL,
       0 DMGPCS,
       0 DMGSERNUM,
       NULL DMGSKDIDR,
       NULL DMGRMK,
      NULL BLKSTA,
       NULL BLKRMK,
       NULL HLDRSNCOD,
       0 BLKSERNUM,
       NULL PARCONFLG,
       0 CNT,
      NULL BUCFLG,
      0 SELPCS,
        NULL ANT_FLTNUM,
      0 ANT_FLTSEQNUM,
        0 ANT_FLTCARIDR,
        NULL ANT_FLTCARCOD,
        NULL ANT_FLTDAT, NULL INHFLG ,
        SHPMIS.BDNSRTFLG,NULL SHPLOCCOD, 0 BLKCNT, NULL FRCRLSFLG,FLTLEG.STA

     FROM OPRSHPMST SHPMST,
        OPRSEGSHP SEGSHP,
        OPRARPIMPFLT IMPFLT,
        OPRFLTSEG FLTSEG,
        OPRSHPMSTMIS SHPMIS,
        FLTOPRLEG FLTLEG
        
     WHERE
        SHPMST.CMPCOD = SEGSHP.CMPCOD
      AND SHPMST.SEQNUM = SEGSHP.SEQNUM
      AND SHPMST.DUPNUM = SEGSHP.DUPNUM
      AND SHPMST.MSTDOCNUM = SEGSHP.MSTDOCNUM
      AND SHPMST.DOCOWRIDR = SEGSHP.DOCOWRIDR
      AND SEGSHP.FLTCARIDR = FLTSEG.FLTCARIDR
      AND SEGSHP.CMPCOD = FLTSEG.CMPCOD
      AND SEGSHP.FLTNUM = FLTSEG.FLTNUM
      AND SEGSHP.FLTSEQNUM = FLTSEG.FLTSEQNUM
      AND SEGSHP.SEGSERNUM = FLTSEG.SEGSERNUM
      AND FLTSEG.FLTNUM = IMPFLT.FLTNUM
      AND FLTSEG.FLTCARIDR = IMPFLT.FLTCARIDR
      AND FLTSEG.FLTSEQNUM = IMPFLT.FLTSEQNUM
      AND FLTSEG.CMPCOD = IMPFLT.CMPCOD
      AND FLTSEG.POU = IMPFLT.ARPCOD
      AND SHPMST.CMPCOD = SHPMIS.CMPCOD
      AND SHPMST.SEQNUM = SHPMIS.SEQNUM
      AND SHPMST.DUPNUM = SHPMIS.DUPNUM
      AND SHPMST.MSTDOCNUM = SHPMIS.MSTDOCNUM
      AND SHPMST.DOCOWRIDR = SHPMIS.DOCOWRIDR
      
      AND IMPFLT.FLTNUM = FLTLEG.FLTNUM
      AND IMPFLT.FLTCARIDR = FLTLEG.FLTCARIDR
      AND IMPFLT.FLTSEQNUM = FLTLEG.FLTSEQNUM
      AND IMPFLT.CMPCOD = FLTLEG.CMPCOD
      AND IMPFLT.ARPCOD = FLTLEG.LEGDST
      
      
      
    ]]>
  </QRY:Source>
</QRY:Definition>



<QRY:Definition>
  <QRY:Id>243</QRY:Id>
  <QRY:Source Name="operations.shipment.findHoldExteriorLabel" Type="NATIVE">
    <![CDATA[

    SELECT
      SHPMST.MSTDOCNUM MSTDOCNUM,
       SHPMST.DOCNUM DOCNUM,
       SHPMST.SEQNUM SEQNUM,
       SHPMST.DUPNUM DUPNUM,
       SHPMST.CMPCOD CMPCOD,
       SHPMST.DOCOWRIDR DOCOWRIDR,
      0 STDPCS,
       0 MFTPCS,
       0 RCVPCS,
       NULL CONFLG,
      0 PARSEQNUM,
      NULL SHPPFX,
      SEGSHP.FLTNUM,
      SEGSHP.FLTSEQNUM,
      SEGSHP.FLTCARIDR,
      NULL FLTDAT,
      IMPFLT.ARPCOD ARPCOD,
      NULL FLTCARCOD,
       NULL EPKFLG,
      NULL SELENDFLG,
      NULL CARCHKENDFLG,
       NULL HDLTYP,
       NULL HDLSTA,
       NULL HDLIDR,
       ARPARA.ARACOD ARACOD,
       ARPARA.MFTPCS ARAMFTPCS,
       ARPARA.MFTWGT ARAMFTWGT,
       ARPARA.RCVPCS ARARCVPCS,
       ARPARA.RCVWGT ARARCVWGT,
       NULL DMGCOD,
       NULL DMGLVL,
       0 DMGPCS,
       0 DMGSERNUM,
       NULL DMGSKDIDR,
       NULL DMGRMK,
      NULL BLKSTA,
       NULL BLKRMK,
       NULL HLDRSNCOD,
       0 BLKSERNUM,
       NULL PARCONFLG,
       0 CNT,
      NULL BUCFLG,
      0 SELPCS,
        NULL ANT_FLTNUM,
      0 ANT_FLTSEQNUM,
        0 ANT_FLTCARIDR,
        NULL ANT_FLTCARCOD,
        NULL ANT_FLTDAT, NULL INHFLG,
        SHPMIS.BDNSRTFLG,NULL SHPLOCCOD, 0 BLKCNT, NULL FRCRLSFLG,NULL STA

     FROM
        OPRARPARASHP ARPARA,
        OPRSHPMST SHPMST,
        OPRSEGSHP SEGSHP,
        OPRFLTSEG FLTSEG,
        OPRARPIMPFLT IMPFLT,
        OPRARPSHP ARPSHP,
        OPRSHPMSTMIS SHPMIS
     WHERE
       SHPMST.CMPCOD = SEGSHP.CMPCOD
      AND SHPMST.SEQNUM = SEGSHP.SEQNUM
      AND SHPMST.DUPNUM = SEGSHP.DUPNUM
      AND SHPMST.MSTDOCNUM = SEGSHP.MSTDOCNUM
      AND SHPMST.DOCOWRIDR = SEGSHP.DOCOWRIDR
      AND SEGSHP.FLTCARIDR = FLTSEG.FLTCARIDR
      AND SEGSHP.CMPCOD = FLTSEG.CMPCOD
      AND SEGSHP.FLTNUM = FLTSEG.FLTNUM
      AND SEGSHP.FLTSEQNUM = FLTSEG.FLTSEQNUM
      AND SEGSHP.SEGSERNUM = FLTSEG.SEGSERNUM
      AND FLTSEG.FLTNUM = IMPFLT.FLTNUM
      AND FLTSEG.FLTCARIDR = IMPFLT.FLTCARIDR
      AND FLTSEG.FLTSEQNUM = IMPFLT.FLTSEQNUM
      AND FLTSEG.CMPCOD = IMPFLT.CMPCOD
      AND FLTSEG.POU = IMPFLT.ARPCOD
      AND SEGSHP.CMPCOD = ARPSHP.CMPCOD
      AND SEGSHP.SEQNUM = ARPSHP.SEQNUM
      AND SEGSHP.DUPNUM = ARPSHP.DUPNUM
      AND SEGSHP.MSTDOCNUM = ARPSHP.MSTDOCNUM
      AND SEGSHP.DOCOWRIDR = ARPSHP.DOCOWRIDR
      AND ARPSHP.CMPCOD = ARPARA.CMPCOD
      AND ARPSHP.SEQNUM = ARPARA.SEQNUM
      AND ARPSHP.DUPNUM = ARPARA.DUPNUM
      AND ARPSHP.MSTDOCNUM = ARPARA.MSTDOCNUM
      AND ARPSHP.DOCOWRIDR = ARPARA.DOCOWRIDR
      AND ARPSHP.ARPCOD = ARPARA.ARPCOD
      AND SHPMST.CMPCOD = SHPMIS.CMPCOD
      AND SHPMST.SEQNUM = SHPMIS.SEQNUM
      AND SHPMST.DUPNUM = SHPMIS.DUPNUM
      AND SHPMST.MSTDOCNUM = SHPMIS.MSTDOCNUM
      AND SHPMST.DOCOWRIDR = SHPMIS.DOCOWRIDR
    ]]>
  </QRY:Source>
</QRY:Definition>
  <QRY:Definition>
  <QRY:Id>244</QRY:Id>
  <QRY:Source Name="operations.shipment.findHoldDamageDetails" Type="NATIVE">
    <![CDATA[

    SELECT
      SHPMST.MSTDOCNUM MSTDOCNUM,
       SHPMST.DOCNUM DOCNUM,
       SHPMST.SEQNUM SEQNUM,
       SHPMST.DUPNUM DUPNUM,
       SHPMST.CMPCOD CMPCOD,
       SHPMST.DOCOWRIDR DOCOWRIDR,
      0 STDPCS,
       0 MFTPCS,
       0 RCVPCS,
       NULL CONFLG,
      0 PARSEQNUM,
      NULL SHPPFX,
      SEGSHP.FLTNUM,
      SEGSHP.FLTSEQNUM,
      SEGSHP.FLTCARIDR,
      NULL FLTDAT,
      IMPFLT.ARPCOD ARPCOD,
      NULL FLTCARCOD,
       NULL EPKFLG,
      NULL SELENDFLG,
      NULL CARCHKENDFLG,
       NULL HDLTYP,
       NULL HDLSTA,
       NULL HDLIDR,
       NULL ARACOD,
       0 ARAMFTPCS,
       0 ARAMFTWGT,
       0 ARARCVPCS,
       0 ARARCVWGT,
       SKDDMG.DMGCOD DMGCOD,
       SKDDMG.DMGLVL DMGLVL,
       SKDDMG.DMGPCS DMGPCS,
       SKDDMG.SERNUM DMGSERNUM,
       SKDDTL.SKDIDR DMGSKDIDR,
       SKDDMG.DMGRMK DMGRMK,
      NULL BLKSTA,
       NULL BLKRMK,
       NULL HLDRSNCOD,
       0 BLKSERNUM,
       NULL PARCONFLG,
       0 CNT,
      NULL BUCFLG,
      0 SELPCS,
        NULL ANT_FLTNUM,
      0 ANT_FLTSEQNUM,
        0 ANT_FLTCARIDR,
        NULL ANT_FLTCARCOD,
        NULL ANT_FLTDAT, NULL INHFLG,
        SHPMIS.BDNSRTFLG ,SHPLOC.LOCCOD SHPLOCCOD, 0 BLKCNT, NULL FRCRLSFLG,NULL STA

     FROM OPRSHPMST SHPMST,
        OPRSEGSHP SEGSHP,
        OPRARPIMPFLT IMPFLT,
        OPRFLTSEG FLTSEG,
        OPRSKDDTL SKDDTL,
        OPRSKDDMG SKDDMG,
        OPRSHPMSTMIS SHPMIS,WHSOPRSHPLOC SHPLOC
     WHERE
        SHPMST.CMPCOD = SEGSHP.CMPCOD
      AND SHPMST.SEQNUM = SEGSHP.SEQNUM
      AND SHPMST.DUPNUM = SEGSHP.DUPNUM
      AND SHPMST.MSTDOCNUM = SEGSHP.MSTDOCNUM
      AND SHPMST.DOCOWRIDR = SEGSHP.DOCOWRIDR
      AND SEGSHP.FLTCARIDR = FLTSEG.FLTCARIDR
      AND SEGSHP.CMPCOD = FLTSEG.CMPCOD
      AND SEGSHP.FLTNUM = FLTSEG.FLTNUM
      AND SEGSHP.FLTSEQNUM = FLTSEG.FLTSEQNUM
      AND SEGSHP.SEGSERNUM = FLTSEG.SEGSERNUM
      AND FLTSEG.FLTNUM = IMPFLT.FLTNUM
      AND FLTSEG.FLTCARIDR = IMPFLT.FLTCARIDR
      AND FLTSEG.FLTSEQNUM = IMPFLT.FLTSEQNUM
      AND FLTSEG.CMPCOD = IMPFLT.CMPCOD
      AND FLTSEG.POU = IMPFLT.ARPCOD
      AND SEGSHP.CMPCOD = SKDDTL.CMPCOD
      AND SEGSHP.SEQNUM = SKDDTL.SEQNUM
      AND SEGSHP.DUPNUM = SKDDTL.DUPNUM
      AND SEGSHP.MSTDOCNUM = SKDDTL.MSTDOCNUM
      AND SEGSHP.DOCOWRIDR = SKDDTL.DOCOWRIDR
      AND SEGSHP.FLTCARIDR = SKDDTL.FLTCARIDR
      AND SEGSHP.FLTNUM = SKDDTL.FLTNUM
      AND SEGSHP.FLTSEQNUM = SKDDTL.FLTSEQNUM
      AND SHPMST.CMPCOD = SHPMIS.CMPCOD
      AND SHPMST.SEQNUM = SHPMIS.SEQNUM
      AND SHPMST.DUPNUM = SHPMIS.DUPNUM
      AND SHPMST.MSTDOCNUM = SHPMIS.MSTDOCNUM
      AND SHPMST.DOCOWRIDR = SHPMIS.DOCOWRIDR
      AND SKDDTL.SKDIDR = SKDDMG.SKDIDR(+)
      AND SKDDTL.ARPCOD    = SHPLOC.ARPCOD
	AND SKDDTL.SKDIDR    = SHPLOC.STUCOD
	AND SKDDTL.DOCOWRIDR = SHPLOC.DOCOWRIDR
	AND SKDDTL.MSTDOCNUM = SHPLOC.MSTDOCNUM
	AND SKDDTL.DUPNUM    = SHPLOC.DUPNUM
	AND SKDDTL.SEQNUM    = SHPLOC.SEQNUM

    ]]>
  </QRY:Source>
</QRY:Definition>
  <QRY:Definition>
  <QRY:Id>245</QRY:Id>
  <QRY:Source Name="operations.shipment.findBlockDetailsForHold" Type="NATIVE">
    <![CDATA[

    SELECT
      SHPMST.MSTDOCNUM MSTDOCNUM,
       SHPMST.DOCNUM DOCNUM,
       SHPMST.SEQNUM SEQNUM,
       SHPMST.DUPNUM DUPNUM,
       SHPMST.CMPCOD CMPCOD,
       SHPMST.DOCOWRIDR DOCOWRIDR,
      0 STDPCS,
       0 MFTPCS,
       0 RCVPCS,
       NULL CONFLG,
      0 PARSEQNUM,
      NULL SHPPFX,
      SHPBLK.FLTNUM,
      SHPBLK.FLTSEQNUM,
      SHPBLK.FLTCARIDR,
      NULL FLTDAT,
      IMPFLT.ARPCOD ARPCOD,
      NULL FLTCARCOD,
       NULL EPKFLG,
      NULL SELENDFLG,
      NULL CARCHKENDFLG,
       NULL HDLTYP,
       NULL HDLSTA,
       NULL HDLIDR,
       NULL ARACOD,
       0 ARAMFTPCS,
       0 ARAMFTWGT,
       0 ARARCVPCS,
       0 ARARCVWGT,
       NULL DMGCOD,
       NULL DMGLVL,
       0 DMGPCS,
       0 DMGSERNUM,
       NULL DMGSKDIDR,
       NULL DMGRMK,
      SHPBLK.BLKSTA BLKSTA,
       SHPBLK.BLKRMK BLKRMK,
       SHPBLK.HLDRSNCOD HLDRSNCOD,
       SHPBLK.SERNUM BLKSERNUM,
       NULL PARCONFLG,
       0 CNT,
      NULL BUCFLG,
      0 SELPCS,
        NULL ANT_FLTNUM,
      0 ANT_FLTSEQNUM,
        0 ANT_FLTCARIDR,
        NULL ANT_FLTCARCOD,
        NULL ANT_FLTDAT, SHPBLK.INHFLG INHFLG,
		SHPMIS.BDNSRTFLG,NULL SHPLOCCOD, 0 BLKCNT, SHPBLK.FRCRLSFLG,NULL STA
     FROM OPRSHPMST SHPMST,
        OPRARPIMPFLT IMPFLT,
        OPRSHPBLKFLT SHPBLK,
        OPRSHPMSTMIS SHPMIS
     WHERE
        SHPMST.CMPCOD = SHPBLK.CMPCOD
      AND SHPMST.SEQNUM = SHPBLK.SEQNUM
      AND SHPMST.DUPNUM = SHPBLK.DUPNUM
      AND SHPMST.MSTDOCNUM = SHPBLK.MSTDOCNUM
      AND SHPMST.DOCOWRIDR = SHPBLK.DOCOWRIDR
      AND SHPBLK.CMPCOD = IMPFLT.CMPCOD
      AND SHPBLK.ARPCOD = IMPFLT.ARPCOD
      AND SHPBLK.FLTCARIDR = IMPFLT.FLTCARIDR
      AND SHPBLK.FLTNUM = IMPFLT.FLTNUM
      AND SHPBLK.FLTSEQNUM = IMPFLT.FLTSEQNUM
      AND SHPMST.CMPCOD = SHPMIS.CMPCOD
      AND SHPMST.SEQNUM = SHPMIS.SEQNUM
      AND SHPMST.DUPNUM = SHPMIS.DUPNUM
      AND SHPMST.MSTDOCNUM = SHPMIS.MSTDOCNUM
      AND SHPMST.DOCOWRIDR = SHPMIS.DOCOWRIDR

    ]]>
  </QRY:Source>
</QRY:Definition>

  <QRY:Definition>
  <QRY:Id>246</QRY:Id>
  <QRY:Source Name="operations.shipment.findHoldParentConsoleDetails" Type="NATIVE">
    <![CDATA[

    SELECT
         MST.MSTDOCNUM MSTDOCNUM,
       MST.DOCNUM DOCNUM,
       MST.SEQNUM SEQNUM,
       MST.DUPNUM DUPNUM,
       MST.CMPCOD CMPCOD,
       MST.DOCOWRIDR DOCOWRIDR,
      0 STDPCS,
       0 MFTPCS,
       0 RCVPCS,
       NULL CONFLG,
      0 PARSEQNUM,
      NULL SHPPFX,
      SUB.FLTNUM,
      SUB.FLTSEQNUM,
      SUB.FLTCARIDR,
      NULL FLTDAT,
      SUB.ARPCOD ARPCOD,
      NULL FLTCARCOD,
       NULL EPKFLG,
      NULL SELENDFLG,
      NULL CARCHKENDFLG,
       NULL HDLTYP,
       NULL HDLSTA,
       NULL HDLIDR,
       NULL ARACOD,
       0 ARAMFTPCS,
       0 ARAMFTWGT,
       0 ARARCVPCS,
       0 ARARCVWGT,
       NULL DMGCOD,
       NULL DMGLVL,
       0 DMGPCS,
       0 DMGSERNUM,
       NULL DMGSKDIDR,
       NULL DMGRMK,
      NULL BLKSTA,
       NULL BLKRMK,
       NULL HLDRSNCOD,
       0 BLKSERNUM,
       MST.CONFLG PARCONFLG,
       0 CNT,
      NULL BUCFLG,
      0 SELPCS,
        NULL ANT_FLTNUM,
      0 ANT_FLTSEQNUM,
        0 ANT_FLTCARIDR,
        NULL ANT_FLTCARCOD,
        NULL ANT_FLTDAT,NULL INHFLG,
        SHPMIS.BDNSRTFLG,NULL SHPLOCCOD, 0 BLKCNT, NULL FRCRLSFLG,NULL STA
      FROM
        OPRSHPMST MST,
        OPRSHPMSTMIS SHPMIS,
       (SELECT
           SHPMST.CMPCOD,
           SHPMST.SEQNUM,
           SHPMST.DUPNUM,
           SHPMST.MSTDOCNUM,
           SHPMST.DOCOWRIDR,
           SHPMST.PARSEQNUM,
           SEGSHP.FLTNUM,
           SEGSHP.FLTSEQNUM,
           SEGSHP.FLTCARIDR,
           IMPFLT.ARPCOD
        FROM OPRSHPMST SHPMST,
           OPRSEGSHP SEGSHP,
           OPRARPIMPFLT IMPFLT,
           OPRFLTSEG FLTSEG
         WHERE
            SHPMST.CMPCOD = SEGSHP.CMPCOD
          AND SHPMST.SEQNUM = SEGSHP.SEQNUM
          AND SHPMST.DUPNUM = SEGSHP.DUPNUM
          AND SHPMST.MSTDOCNUM = SEGSHP.MSTDOCNUM
          AND SHPMST.DOCOWRIDR = SEGSHP.DOCOWRIDR
          AND SEGSHP.FLTCARIDR = FLTSEG.FLTCARIDR
          AND SEGSHP.CMPCOD = FLTSEG.CMPCOD
          AND SEGSHP.FLTNUM = FLTSEG.FLTNUM
          AND SEGSHP.FLTSEQNUM = FLTSEG.FLTSEQNUM
          AND SEGSHP.SEGSERNUM = FLTSEG.SEGSERNUM
          AND FLTSEG.FLTNUM = IMPFLT.FLTNUM
          AND FLTSEG.FLTCARIDR = IMPFLT.FLTCARIDR
          AND FLTSEG.FLTSEQNUM = IMPFLT.FLTSEQNUM
          AND FLTSEG.CMPCOD = IMPFLT.CMPCOD
          AND FLTSEG.POU = IMPFLT.ARPCOD

    ]]>
  </QRY:Source>
</QRY:Definition>

<QRY:Definition>
		<QRY:Id>276</QRY:Id>
		<QRY:Source Name="opearations.shipment.baselinecountforflightassignment" Type="NATIVE">
			<![CDATA[
						
		SELECT BSELINCNT.MSTDOCNUM, BSELINCNT.DOCOWRIDR, BSELINCNT.SEQNUM, BSELINCNT.DUPNUM,BSELINCNT.CMPCOD,
		
		SUM(BSELINCNT.TOTAWBDGRPCS)TOTAWBDGRPCS,SUM(BSELINCNT.TOTDGRPKG)TOTDGRPKG,BSELINCNT.SHPPFX FROM (


		SELECT MST.MSTDOCNUM, MST.DOCOWRIDR, MST.SEQNUM, MST.DUPNUM, MST.CMPCOD, SUM (MST.TOTAWBDGRPCS) TOTAWBDGRPCS,0  
		TOTDGRPKG,MST.SHPPFX
				FROM
				 (SELECT DISTINCT MST.MSTDOCNUM  , MST.DOCOWRIDR  , MST.SEQNUM  , MST.DUPNUM, 
		MST.CMPCOD  , ADV.NUMPCS TOTAWBDGRPCS  , ADV.SCCCOD,MST.SHPPFX		
				FROM
				OPRSHPMST MST,
				OPRSHPACPADV 
		ADV,
				SHRSCCMST SCC
				WHERE
				MST.CMPCOD = ADV.CMPCOD(+)
				AND MST.MSTDOCNUM = ADV.MSTDOCNUM(+)
				AND 
		MST.DOCOWRIDR = ADV.DOCOWRIDR(+)
				AND MST.SEQNUM = ADV.SEQNUM(+)
				AND MST.DUPNUM = ADV.DUPNUM(+)

		AND ADV.CMPCOD = SCC.CMPCOD
		AND ADV.SCCCOD LIKE '%'||SCC.SCCCOD||'%'
		AND SCC.DGRIND = 'Y'
		AND MST.CMPCOD = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	
	<QRY:Definition>
	<QRY:Id>277</QRY:Id>
	<QRY:Source Name="opearations.shipment.dgcountforflightassignment" Type="NATIVE">
			<![CDATA[
		SELECT   MST.MSTDOCNUM, MST.DOCOWRIDR, MST.SEQNUM, MST.DUPNUM, MST.CMPCOD, 0 TOTAWBDGRPCS,
         		NVL (SUM (CASE WHEN NVL (  DGR.NOOFOVRPACKS, 0) > 0 THEN DGR.NOOFOVRPACKS
         		ELSE (CASE WHEN NVL (  DGR.NOOFALLPACKS, 0) > 0 THEN DGR.NOOFALLPACKS ELSE DGR.NUMPKG
         		END ) END ),0 )TOTDGRPKG, MST.SHPPFX
    			FROM OPRSHPMST MST, OPRSHPDGR DGR
  			WHERE MST.CMPCOD = DGR.CMPCOD(+)
     			AND MST.MSTDOCNUM = DGR.MSTDOCNUM(+)
     			AND MST.DOCOWRIDR = DGR.DOCOWRIDR(+)
     			AND MST.SEQNUM = DGR.SEQNUM(+)
     			AND MST.DUPNUM = DGR.DUPNUM(+)
     			AND MST.CMPCOD = ?			
			
				]]>
			</QRY:Source>
	</QRY:Definition>
	
	<QRY:Definition>
	      <QRY:Id>278</QRY:Id>
	     	<QRY:Source Name="operations.shipment.finddgrlimit" Type="NATIVE">
	  		<![CDATA[
	  		 SELECT SUM(DRYICEFGT) DRYICEFGT,SUM(DRYICEREF) DRYICEREF FROM(
	  		SELECT NVL(SUM(NTC.NETQTY*NTC.BLDPCS),0) DRYICEFGT,0 DRYICEREF
			FROM OPRNTCDGR NTC, OPRSHPDGR DGR
			WHERE
			NTC.CMPCOD = DGR.CMPCOD
			AND NTC.MSTDOCNUM = DGR.MSTDOCNUM
			AND NTC.DOCOWRIDR = DGR.DOCOWRIDR
			AND NTC.DUPNUM = DGR.DUPNUM
			AND NTC.SEQNUM = DGR.SEQNUM
			AND NTC.UNIIDR = DGR.UNIIDR
			AND NTC.PARSERNUM = DGR.SERNUM
			AND NTC.CMPCOD = ?
			AND NTC.FLTCARIDR = ?
			AND NTC.FLTNUM = ?
			AND NTC.FLTSEQNUM =?
			AND NTC.UNIIDR = ?
			AND DGR.PROSHPNAM = ?
			UNION
			SELECT 0 DRYICEFGT, NVL(SUM(NTC.NETQTY*NTC.BLDPCS),0) DRYICEREF
			FROM OPRNTCDGR NTC, OPRSHPDGR DGR
			WHERE
			NTC.CMPCOD = DGR.CMPCOD
			AND NTC.MSTDOCNUM = DGR.MSTDOCNUM
			AND NTC.DOCOWRIDR = DGR.DOCOWRIDR
			AND NTC.DUPNUM = DGR.DUPNUM
			AND NTC.SEQNUM = DGR.SEQNUM
			AND NTC.UNIIDR = DGR.UNIIDR
			AND NTC.PARSERNUM = DGR.SERNUM
			AND NTC.CMPCOD = ?
			AND NTC.FLTCARIDR = ?
			AND NTC.FLTNUM = ?
			AND NTC.FLTSEQNUM = ?
			AND NTC.UNIIDR = ?
			AND DGR.PROSHPNAM = ?)
		]]>
		</QRY:Source>
	</QRY:Definition>
	
	<QRY:Definition>
      <QRY:Id>279</QRY:Id>
	<QRY:Source Name="operations.shipement.findBlockDetailsOfShipments" Type="NATIVE">
		<![CDATA[
			 SELECT BLK.BLKAUT, BLK.MSTDOCNUM, BLK.DOCNUM, BLK.DOCOWRIDR, BLK.SEQNUM, BLK.DUPNUM, AUT.AUTNAM
			   FROM OPRSHPBLK BLK, OPRBLKAUT AUT
			  WHERE AUT.AUTCOD=BLK.BLKAUT
				AND BLK.BLKSTA='B'
				AND AUT.CMPCOD = BLK.CMPCOD
				AND BLK.CMPCOD = ?
			AND BLK.ARPCOD= ?

		 ]]>
		</QRY:Source>
	</QRY:Definition>











<QRY:Definition>
		<QRY:Id>231</QRY:Id>
		<QRY:Source Name="operations.shipment.findAwbDetailsForReport" Type="NATIVE">
						<![CDATA[
							SELECT *
							   FROM
							  (SELECT row_number() over(partition BY MSTDOCNUM,DOCOWRIDR,SEQNUM,CMPCOD,DUPNUM, RATLINSERNUM,CHDCOD order by FLTDAT,a nulls last) slno1,
							    k.*
							     FROM
							    (SELECT SHPMST.ORGCOD                                 ,
							      SHPMST.AGTNAM                                       ,
							      SHPMST.MSTDOCNUM                                    ,
								  SHPMST.STDWGTCOD									  ,
							      SHPMST.DOCOWRIDR                                    ,
							      SHPMST.SEQNUM                                       ,
							      SHPMST.CMPCOD                                       ,
							      SHPMST.DUPNUM                                       ,
							      SHPMST.SHPPFX                                       ,
							      SHPMST.DSTCOD                                       ,
							      SHPMST.PAYTYP                                       ,
							      SHPMST.EXEDAT                                       ,
							      NVL(SHPMST.SCCCOD,BKGDTL.SCCCOD) SCCCOD             ,
							      SHPMST.EXESTN                                       ,
							      SHPMST.SHPDES                                       ,
							      SHPMST.CURCOD                                       ,
							      SHPMST.SHPNAM                                       ,
							      SHPMST.CNSNAM                                       ,
							      CHGDTL.TAX CHGDTLTAX                                ,
							      CHGDTL.CHDCOD                                       ,
							      CHGDTL.CHGAMT                                       ,
							      CHGDTL.CHGHED                                       ,
							      CHGDTL.DUECARFLG                                    ,
							      CHGDTL.DUEAGTFLG					  ,
							      RATDTL.TAX RATDTLTAX                                ,
							      RATDTL.RATLINSERNUM                                 ,
							      RATDTL.NUMPCS                                       ,
							      RATDTL.GRSWGT                                       ,
							      RATDTL.CHGWGT                                       ,
							      RATDTL.NETCHG                                       ,
							      RATDTL.IATRAT                                       ,
							      RATDTL.IATCHG                                       ,
							      RATDTL.IATRATCLS                                    ,
							      RATDTL.ARLRAT                                       ,
							      RATDTL.ARLRATCLS                                    ,
							      NVL(EXPFLT.FLTCARCOD, BKGFLTDTL.FLTCARCOD) FLTCARCOD,
							      NVL(EXPFLT.FLTNUM , BKGFLTDTL.FLTNUM) FLTNUM        ,
							      EXPFLT.FLTNUM a                                     ,
							      BKGFLTDTL.FLTNUM b                                  ,
							      NVL(EXPFLT.FLTDAT ,BKGFLTDTL.FLTDAT) FLTDAT         ,
							      EXPFLT.FLTSEQNUM                                    ,
							      EXPFLT.FLTSEQNUM c                                  ,
							      BKGFLTDTL.FLTSEQNUM d                               ,
							      EXPFLT.FLTCARIDR                                    ,
							      EXPFLT.LEGSERNUM                                    ,
							      (
							      CASE
							        WHEN FLTSEG.POL IS NOT NULL
							        THEN FLTSEG.POL
							          ||'-'
							          ||FLTSEG.POU
							        ELSE BKGFLTDTL.FLTORG
							          ||'-'
							          ||BKGFLTDTL.FLTDST
							      END ) ROUTE ,
							      NVL(SHPACC.ACCINF,BKGMST.SHPRMK) RMK
							       FROM OPRSHPMST SHPMST
							    JOIN OPRSHPRATDTL RATDTL
							         ON ( SHPMST.DOCOWRIDR =RATDTL.DOCOWRIDR
							    AND SHPMST.MSTDOCNUM       =RATDTL.MSTDOCNUM
							    AND SHPMST.CMPCOD          = RATDTL.CMPCOD
							    AND SHPMST.DUPNUM          = RATDTL.DUPNUM
							    AND SHPMST.SEQNUM          = RATDTL.SEQNUM)
							    JOIN OPRSHPMSTACC SHPACC
							         ON(SHPMST.DOCOWRIDR =SHPACC.DOCOWRIDR
							    AND SHPMST.MSTDOCNUM     =SHPACC.MSTDOCNUM
							    AND SHPMST.CMPCOD        = SHPACC.CMPCOD
							    AND SHPMST.DUPNUM        = SHPACC.DUPNUM
							    AND SHPMST.SEQNUM        = SHPACC.SEQNUM )
							    LEFT OUTER JOIN OPRSHPCHGDTL CHGDTL
							         ON(SHPMST.DOCOWRIDR = CHGDTL.DOCOWRIDR
							    AND SHPMST.MSTDOCNUM     = CHGDTL.MSTDOCNUM
							    AND SHPMST.CMPCOD        = CHGDTL.CMPCOD
							    AND SHPMST.DUPNUM        = CHGDTL.DUPNUM
							    AND SHPMST.SEQNUM        = CHGDTL.SEQNUM)
							    LEFT OUTER JOIN OPRSEGSHP SEGSHP
							         ON( SHPMST.DOCOWRIDR =SEGSHP.DOCOWRIDR
							    AND SHPMST.MSTDOCNUM      =SEGSHP.MSTDOCNUM
							    AND SHPMST.CMPCOD         = SEGSHP.CMPCOD
							    AND SHPMST.DUPNUM         = SEGSHP.DUPNUM
							    AND SHPMST.SEQNUM         = SEGSHP.SEQNUM)
							    LEFT OUTER JOIN OPRFLTSEG FLTSEG
							         ON(SEGSHP.FLTNUM = FLTSEG.FLTNUM
							    AND SEGSHP.FLTCARIDR  =FLTSEG.FLTCARIDR
							    AND SEGSHP.FLTSEQNUM  =FLTSEG.FLTSEQNUM
							    AND SEGSHP.SEGSERNUM  = FLTSEG.SEGSERNUM
							    AND SEGSHP.CMPCOD     = FLTSEG.CMPCOD
							    AND SHPMST.ORGCOD     = FLTSEG.POL)
							    LEFT OUTER JOIN OPRARPEXPFLT EXPFLT
							         ON(FLTSEG.FLTNUM = EXPFLT.FLTNUM
							    AND FLTSEG.FLTCARIDR  = EXPFLT.FLTCARIDR
							    AND FLTSEG.FLTSEQNUM  = EXPFLT.FLTSEQNUM
							    AND FLTSEG.CMPCOD     = EXPFLT.CMPCOD
							    AND SHPMST.ORGCOD     = EXPFLT.ARPCOD )
							    LEFT OUTER JOIN CAPBKGMST BKGMST
							         ON (SHPMST.CMPCOD = BKGMST.CMPCOD
							    AND SHPMST.UBRNUM      =BKGMST.UBRNUM)
							    LEFT OUTER JOIN CAPBKGDTL BKGDTL
							         ON( SHPMST.CMPCOD = BKGDTL.CMPCOD
							    AND SHPMST.UBRNUM      =BKGDTL.UBRNUM)
							    LEFT OUTER JOIN CAPBKGFLTDTL BKGFLTDTL
							         ON(SHPMST.CMPCOD = BKGFLTDTL.CMPCOD
							    AND SHPMST.UBRNUM     =BKGFLTDTL.UBRNUM
    							    AND SHPMST.ORGCOD     =BKGFLTDTL.flTORG)
							WHERE SHPMST.CMPCOD= ?
							   	    
						]]>
			</QRY:Source>
	</QRY:Definition>
	
	<QRY:Definition>
   <QRY:Id>248</QRY:Id>
   <QRY:Source Name="operations.shipment.findHoldBUC" Type="NATIVE">
     <![CDATA[
      SELECT
       SHPMST.MSTDOCNUM MSTDOCNUM,
        SHPMST.DOCNUM DOCNUM,
        SHPMST.SEQNUM SEQNUM,
        SHPMST.DUPNUM DUPNUM,
        SHPMST.CMPCOD CMPCOD,
        SHPMST.DOCOWRIDR DOCOWRIDR,
       0 STDPCS,
        0 MFTPCS,
        0 RCVPCS,
        NULL CONFLG,
       0 PARSEQNUM,
       NULL SHPPFX,
       SEGSHP.FLTNUM,
       SEGSHP.FLTSEQNUM,
       SEGSHP.FLTCARIDR,
       NULL FLTDAT,
       IMPFLT.ARPCOD ARPCOD,
       NULL FLTCARCOD,
        NULL EPKFLG,
       NULL SELENDFLG,
       NULL CARCHKENDFLG,
        NULL HDLTYP,
        NULL HDLSTA,
        NULL HDLIDR,
        NULL ARACOD,
        0 ARAMFTPCS,
        0 ARAMFTWGT,
        0 ARARCVPCS,
        0 ARARCVWGT,
        NULL DMGCOD,
        NULL DMGLVL,
        0 DMGPCS,
        0 DMGSERNUM,
        NULL DMGSKDIDR,
        NULL DMGRMK,
       NULL BLKSTA,
        NULL BLKRMK,
        NULL HLDRSNCOD,
        0 BLKSERNUM,
        NULL PARCONFLG,
        0 CNT,
       SELSHP.BUCFLG BUCFLG,
       SELSHP.SELPCS SELPCS,
         NULL ANT_FLTNUM,
       0 ANT_FLTSEQNUM,
         0 ANT_FLTCARIDR,
         NULL ANT_FLTCARCOD,
         NULL ANT_FLTDAT,NULL INHFLG,
         SHPMIS.BDNSRTFLG ,NULL SHPLOCCOD, 0 BLKCNT, NULL FRCRLSFLG,NULL STA
      FROM
        OPRSEGSELSHP SELSHP,
        OPRSHPMST SHPMST,
        OPRSEGSHP SEGSHP,
        OPRFLTSEG FLTSEG,
        OPRARPIMPFLT IMPFLT,
        OPRSHPMSTMIS SHPMIS
 
      WHERE
        SHPMST.CMPCOD = SEGSHP.CMPCOD
       AND SHPMST.SEQNUM = SEGSHP.SEQNUM
       AND SHPMST.DUPNUM = SEGSHP.DUPNUM
       AND SHPMST.MSTDOCNUM = SEGSHP.MSTDOCNUM
       AND SHPMST.DOCOWRIDR = SEGSHP.DOCOWRIDR
       AND SEGSHP.FLTCARIDR = FLTSEG.FLTCARIDR
       AND SEGSHP.CMPCOD = FLTSEG.CMPCOD
       AND SEGSHP.FLTNUM = FLTSEG.FLTNUM
       AND SEGSHP.FLTSEQNUM = FLTSEG.FLTSEQNUM
       AND SEGSHP.SEGSERNUM = FLTSEG.SEGSERNUM
       AND FLTSEG.FLTNUM = IMPFLT.FLTNUM
       AND FLTSEG.FLTCARIDR = IMPFLT.FLTCARIDR
       AND FLTSEG.FLTSEQNUM = IMPFLT.FLTSEQNUM
       AND FLTSEG.CMPCOD = IMPFLT.CMPCOD
       AND FLTSEG.POU = IMPFLT.ARPCOD
       AND SEGSHP.FLTCARIDR = SELSHP.FLTCARIDR
       AND SEGSHP.CMPCOD = SELSHP.CMPCOD
       AND SEGSHP.FLTNUM = SELSHP.FLTNUM
       AND SEGSHP.FLTSEQNUM = SELSHP.FLTSEQNUM
       AND SEGSHP.SEGSERNUM = SELSHP.SEGSERNUM
       AND SEGSHP.SEQNUM = SELSHP.SEQNUM
       AND SEGSHP.DUPNUM = SELSHP.DUPNUM
       AND SEGSHP.MSTDOCNUM = SELSHP.MSTDOCNUM
       AND SEGSHP.DOCOWRIDR = SELSHP.DOCOWRIDR
  	  AND SHPMST.CMPCOD = SHPMIS.CMPCOD
       AND SHPMST.SEQNUM = SHPMIS.SEQNUM
       AND SHPMST.DUPNUM = SHPMIS.DUPNUM
       AND SHPMST.MSTDOCNUM = SHPMIS.MSTDOCNUM
       AND SHPMST.DOCOWRIDR = SHPMIS.DOCOWRIDR
     ]]>
   </QRY:Source>
</QRY:Definition>

 <QRY:Definition>
  <QRY:Id>248</QRY:Id>
  <QRY:Source Name="operations.shipment.findHoldRemarks" Type="NATIVE">
    <![CDATA[

    SELECT   MST.MSTDOCNUM MSTDOCNUM ,
             MST.DOCNUM DOCNUM,
         MST.SEQNUM SEQNUM,
         MST.DUPNUM DUPNUM,
         MST.CMPCOD CMPCOD,
         MST.DOCOWRIDR DOCOWRIDR,
         0 STDPCS,
         0 MFTPCS,
         0 RCVPCS,
         NULL CONFLG,
         0 PARSEQNUM,
         NULL SHPPFX,
         SUB.FLTNUM,
         SUB.FLTSEQNUM,
         SUB.FLTCARIDR,
         NULL FLTDAT,
         IMPFLT.ARPCOD ARPCOD,
         NULL FLTCARCOD,
         NULL EPKFLG,
         NULL SELENDFLG,
         NULL CARCHKENDFLG,
         NULL HDLTYP,
         NULL HDLSTA,
         NULL HDLIDR,
         NULL ARACOD,
         0 ARAMFTPCS,
         0 ARAMFTWGT,
         0 ARARCVPCS,
         0 ARARCVWGT,
         NULL DMGCOD,
         NULL DMGLVL,
         0 DMGPCS,
         0 DMGSERNUM,
         NULL DMGSKDIDR,
         NULL DMGRMK,
         NULL BLKSTA,
         NULL BLKRMK,
         NULL HLDRSNCOD,
         0 BLKSERNUM,
         NULL PARCONFLG,
         0 CNT,
         NULL BUCFLG,
         0 SELPCS,
         SEGSHP.FLTNUM ANT_FLTNUM,
         SEGSHP.FLTSEQNUM ANT_FLTSEQNUM,
         SEGSHP.FLTCARIDR ANT_FLTCARIDR,
         IMPFLT.FLTCARCOD ANT_FLTCARCOD,
         IMPFLT.FLTDAT ANT_FLTDAT,	NULL INHFLG,
         SHPMIS.BDNSRTFLG ,NULL SHPLOCCOD, 0 BLKCNT, NULL FRCRLSFLG,NULL STA
      FROM OPRSEGSHP SEGSHP,
          OPRFLTSEG FLTSEG,
           OPRARPIMPFLT IMPFLT,
           OPRSHPMST MST,
           (SELECT SEGSHP.FLTNUM,
               SEGSHP.FLTSEQNUM,
               SEGSHP.FLTCARIDR,
               IMPFLT.FLTCARCOD,
               IMPFLT.FLTDAT FLTDAT,
               SEGSHP.MSTDOCNUM SUBMSTDOCNUM,
               SEGSHP.DOCOWRIDR SUBDOCOWRIDR,
               SEGSHP.SEQNUM SUBSEQNUM,
               SEGSHP.DUPNUM SUBDUPNUM,
               SEGSHP.CMPCOD SUBCMPCOD
            FROM OPRSEGSHP SEGSHP,
             OPRFLTSEG FLTSEG,
             OPRARPIMPFLT IMPFLT
           WHERE SEGSHP.FLTCARIDR = FLTSEG.FLTCARIDR
                 AND SEGSHP.FLTNUM        = FLTSEG.FLTNUM
               AND SEGSHP.SEGSERNUM     = FLTSEG.SEGSERNUM
               AND SEGSHP.FLTSEQNUM     = FLTSEG.FLTSEQNUM
               AND FLTSEG.CMPCOD        = IMPFLT.CMPCOD
               AND FLTSEG.FLTNUM        = IMPFLT.FLTNUM
               AND FLTSEG.FLTSEQNUM     = IMPFLT.FLTSEQNUM
               AND FLTSEG.FLTCARIDR     = IMPFLT.FLTCARIDR
               AND FLTSEG.POU           = IMPFLT.ARPCOD
               AND FLTSEG.FLTNUM        = ?
               AND FLTSEG.FLTSEQNUM     = ?
               AND FLTSEG.FLTCARIDR     = ?
               AND FLTSEG.CMPCOD        = ?
             ) SUB,
             OPRSHPMSTMIS SHPMIS
       WHERE SEGSHP.FLTCARIDR         = FLTSEG.FLTCARIDR
         AND SEGSHP.FLTNUM        = FLTSEG.FLTNUM
         AND SEGSHP.SEGSERNUM     = FLTSEG.SEGSERNUM
         AND SEGSHP.FLTSEQNUM     = FLTSEG.FLTSEQNUM
         AND FLTSEG.CMPCOD        = IMPFLT.CMPCOD
         AND FLTSEG.FLTNUM        = IMPFLT.FLTNUM
         AND FLTSEG.FLTSEQNUM     = IMPFLT.FLTSEQNUM
         AND FLTSEG.FLTCARIDR     = IMPFLT.FLTCARIDR
         AND FLTSEG.POU           = IMPFLT.ARPCOD
         AND SEGSHP.CMPCOD        = ?
         AND SEGSHP.SEQNUM        = SUB.SUBSEQNUM
         AND SEGSHP.DUPNUM        = SUB.SUBDUPNUM
         AND IMPFLT.ARPCOD        = ?
         AND SEGSHP.MSTDOCNUM     = SUB.SUBMSTDOCNUM
         AND SEGSHP.DOCOWRIDR     = SUB.SUBDOCOWRIDR
         AND SEGSHP.CMPCOD        = SUB.SUBCMPCOD
         AND SEGSHP.SEQNUM        = MST.SEQNUM
         AND SEGSHP.DUPNUM        = MST.DUPNUM
         AND SEGSHP.CMPCOD        = MST.CMPCOD
         AND SEGSHP.MSTDOCNUM     = MST.MSTDOCNUM
         AND SEGSHP.DOCOWRIDR     = MST.DOCOWRIDR
         AND SHPMIS.SEQNUM        = MST.SEQNUM
         AND SHPMIS.DUPNUM        = MST.DUPNUM
         AND SHPMIS.CMPCOD        = MST.CMPCOD
         AND SHPMIS.MSTDOCNUM     = MST.MSTDOCNUM
         AND SHPMIS.DOCOWRIDR     = MST.DOCOWRIDR
         AND ( SEGSHP.FLTNUM      <> ?
         OR SEGSHP.FLTSEQNUM     <> ?
        OR SEGSHP.FLTCARIDR     <> ?)
        ]]>
      </QRY:Source>
    </QRY:Definition>

  <QRY:Definition>
    <QRY:Id>272</QRY:Id>
    <QRY:Source Name="operations.shipment.findshipmentsforcto" Type="NATIVE">
      <![CDATA[
            SELECT MST.DOCOWRIDR,MST.DUPNUM ,MST.SEQNUM,MST.CMPCOD,
            IDX.SHPPFX,MST.MSTDOCNUM,MST.DOCTYP,MST.DOCNUM,
            MST.CPTDAT,MST.CNSCOD,MST.ORGCOD,STDDISWGT,MST.STDPCS,MST.STDWGT,
            MST.DSTCOD,MST.SHPSTA,MST.UBRNUM,MST.SHPTYP,MST.CONFLG,IDX.OWRCOD,MST.PARSEQNUM,
            MST.LSTUPDUSR, MST.LSTUPDTIM, SHP.OUTFLG
            FROM OPRSHPIDX IDX,OPRSHPMST  MST,OPRARPCOLSHP SHP
            WHERE
            MST.DOCOWRIDR = IDX.DOCOWRIDR AND
            MST.CMPCOD = IDX.CMPCOD AND 
            MST.DUPNUM = IDX.DUPNUM AND
            MST.MSTDOCNUM = IDX.MSTDOCNUM AND
            MST.CMPCOD = ? AND ? = (CASE WHEN MST.PARSEQNUM = 0
            THEN MST.SHPPFX ||MST.DOCNUM ELSE MST.DOCNUM END)
            AND MST.MSTDOCNUM = SHP.MSTDOCNUM(+)
			AND MST.CMPCOD    = SHP.CMPCOD(+)
			AND MST.DOCOWRIDR = SHP.DOCOWRIDR(+)
			AND MST.DUPNUM    = SHP.DUPNUM(+)
			AND MST.SEQNUM    = SHP.SEQNUM(+)
          ]]>
    </QRY:Source>
  </QRY:Definition>
   
   <QRY:Definition>
	<QRY:Id>273</QRY:Id>
	<QRY:Source Name="operations.shipment.shipmentdocument.fetchfilenames" Type="NATIVE">
		<![CDATA[
		SELECT SHP.DOCTYP, SHP.RMK,SHP.FILNAM,SHP.CMPCOD,SHP.DOCOWRIDR,SHP.MSTDOCNUM, SHP.DUPNUM, SHP.SEQNUM, SHP.SERNUM, SHP.FILBLB,SHP.LSTUPDTIM,
		SHP.REFONE,SHP.REFTWO,SHP.REFTHR,SHP.REFFOR,SHP.ARCFLG 
		FROM  OPRSHPDOCDTL SHP 
		 WHERE SHP.CMPCOD= ?
		]]>
	</QRY:Source>
	</QRY:Definition>
	
   
<QRY:Definition>
	 <QRY:Id>274</QRY:Id>
	 <QRY:Source Name="operations.shipment.cto.findfsuawrdetails" Type="NATIVE">
	<![CDATA[
			SELECT MST.DOMFLG,MST.MSTDOCNUM, MST.DOCOWRIDR, MST.DUPNUM, MST.SEQNUM, MST.CMPCOD, MST.SHPPFX, MST.STDPCS, MST.STDWGT,
			   MST.ORGCOD, MST.DSTCOD, MST.OWRCOD, MST.AGTCOD, AGTGRP.GRPNAM AGTGRP, MST.CNSCOD, CUSMST.CUSGRP CNSGRP,
			   IMPFLT.FLTNUM, IMPFLT.FLTDAT, IMPFLT.FLTCARCOD, ARP.ARPCOD, ARP.RCVPCS, ARP.RCVWGT, SYS.PARVAL WGTCOD,
			   ARL.TWOAPHCOD CARRCOD, LEG.STA, LEG.ATA, LEG.STD, LEG.ATD, SEGSHP.MFTPCS, SEGSHP.MFTWGT, SHPRTG.DSTCOD RTGCNT, MIS.JNVPAR,  SHRMST.CNTCOD
	    FROM OPRSHPMST  MST,
		 OPRARPSHP ARP,
		 OPRARPIMPFLT IMPFLT,
		 FLTOPRLEG LEG,
		 SHRSYSPAR SYS,
		 SHRARLMST ARL,
				OPRSEGSHP SEGSHP,
				SHRCUSMST CUSMST,
				SHRGENMSTGRPDTL AGTGRP,
				 OPRSHPRTG SHPRTG,
				  OPRSHPMSTMIS MIS,
				  SHRARPMST SHRMST
	   WHERE MST.MSTDOCNUM = ARP.MSTDOCNUM
	     AND MST.DOCOWRIDR = ARP.DOCOWRIDR
	     AND MST.DUPNUM = ARP.DUPNUM
	     AND MST.SEQNUM = ARP.SEQNUM
	     AND MST.CMPCOD = ARP.CMPCOD
	     AND MST.CMPCOD = SYS.CMPCOD
		 AND MST.CMPCOD = ARL.CMPCOD
	     AND MST.DOCOWRIDR = ARL.ARLIDR
		 AND SEGSHP.MSTDOCNUM =  MST.MSTDOCNUM
	     AND SEGSHP.DOCOWRIDR =  MST.DOCOWRIDR
	     AND SEGSHP.DUPNUM =  MST.DUPNUM
	     AND SEGSHP.SEQNUM =  MST.SEQNUM
	     AND SEGSHP.MSTDOCNUM =  MST.MSTDOCNUM
		 AND SEGSHP.FLTCARIDR =  IMPFLT.FLTCARIDR
	     AND SEGSHP.FLTNUM =  IMPFLT.FLTNUM
	     AND SEGSHP.FLTSEQNUM =  IMPFLT.FLTSEQNUM
	     AND IMPFLT.CMPCOD = LEG.CMPCOD
	     AND IMPFLT.ARPCOD = ARP.ARPCOD
	     AND IMPFLT.FLTCARIDR = LEG.FLTCARIDR
	     AND IMPFLT.FLTNUM = LEG.FLTNUM
	     AND IMPFLT.FLTSEQNUM = LEG.FLTSEQNUM
	     AND IMPFLT.LEGSERNUM = LEG.LEGSERNUM
	     AND IMPFLT.ARPCOD = LEG.LEGDST
				AND MST.CMPCOD = CUSMST.CMPCOD(+)
				AND MST.SHPCOD = CUSMST.CUSCOD(+)
				AND MST.CMPCOD = AGTGRP.CMPCOD(+)
				AND MST.AGTCOD = AGTGRP.GRPENT(+)
                AND AGTGRP.GRPCATCOD(+) = 'GEN'
				AND MST.MSTDOCNUM 		= SHPRTG.MSTDOCNUM(+)
				AND MST.DOCOWRIDR 		= SHPRTG.DOCOWRIDR(+)
				AND MST.DUPNUM 		 	= SHPRTG.DUPNUM(+)
				AND MST.SEQNUM 		 	= SHPRTG.SEQNUM(+)
				AND MST.CMPCOD 		 	= SHPRTG.CMPCOD(+)
				 AND MST.MSTDOCNUM = MIS.MSTDOCNUM(+)
				AND MST.DOCOWRIDR   = MIS.DOCOWRIDR(+)
				AND MST.DUPNUM      = MIS.DUPNUM(+)
				AND MST.SEQNUM      = MIS.SEQNUM(+)
				AND MST.CMPCOD      = MIS.CMPCOD(+)
				 AND MST.CMPCOD      = SHRMST.CMPCOD(+)
				AND MST.ORGCOD      =  SHRMST.ARPCOD(+)
	     AND MST.MSTDOCNUM = ?
	     AND MST.DOCOWRIDR = ?
	     AND MST.DUPNUM = ?
	     AND MST.SEQNUM = ?
	     AND MST.CMPCOD = ?
	     AND ARP.ARPCOD = ?
	     AND SYS.PARCOD = ?


	]]>
	</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>275</QRY:Id>
		<QRY:Source Name="operations.shipment.findgroupdeliverydetails.queryprefix" Type="NATIVE">
			<![CDATA[
		    SELECT SUBQRY.CMPCOD, NVL(SUBQRY.ULDNUM,   ?) ULDNUM,  SUBQRY.ULDSHPPCS,
			  SUBQRY.ULDSHPWGT,  SUBQRY.DOCOWRIDR,  SUBQRY.MSTDOCNUM,  SUBQRY.DUPNUM,
			  SUBQRY.SEQNUM,  SUBQRY.TOTDLVPCS,  SUBQRY.TOTDLVWGT,  SUBQRY.RCVPCS,
			  SUBQRY.RCVWGT,  SUBQRY.ARPCOD,  SUBQRY.STDPCS,  SUBQRY.STDWGT,  SUBQRY.SHPPFX,
			  SUBQRY.DOCNUM,  SUBQRY.PRDCOD,  SUBQRY.PRDNAM,  SUBQRY.AGTCOD,  SUBQRY.SCCCOD,
			  SUBQRY.CNSCOD,  SUBQRY.ORGCOD,  SUBQRY.DSTCOD,  SUBQRY.CONFLG,  SUBQRY.CONBDNFLG,
			  SUBQRY.AVLPCS,  SUBQRY.AVLWGT,  SUBQRY.ARPLSTUPDTIM,  SUBQRY.CURCOD,  
			  SUBQRY.PAYTYP,  SUBQRY.SCCMATVAL,  SUBQRY.CUSSCCCOD,  SUBQRY.CUSPRI,
			  SUBQRY.CUSMAXPRI,  DLVNOT.DLVNOTSTA,  DLVNOT.DLVNOTPCS,  DLVNOT.DLVNOTWGT,
			  DLVNOT.DLVNOTNUM,  DLVNOT.ULDNUM DLVULDNUM,  DLVNOT.DNTISSDAT,  DLVNOT.PAYADVNUM,
			  DLVNOT.PAYADVISSDAT,  DLVNOT.PAYADVEXPDAT,  DLVNOT.DLVPCS,  DLVNOT.DLVWGT,
			  SHPDTL.LSTUPDTIM SHPLSTUPDTIM,  SUBQRY.TOTDLVNOTPCS,  SUBQRY.TOTDLVNOTWGT,
			  SUBQRY.CNSFLG, AGTMST.CUSCOD,ACC.SRVCRGCLS,ACC.TOTCCF 
			FROM
			  (SELECT K.CMPCOD, K.ULDNUM, K.ULDSHPPCS, K.ULDSHPWGT, K.DOCOWRIDR, K.MSTDOCNUM,
			     K.DUPNUM, K.SEQNUM, K.TOTDLVPCS, K.TOTDLVWGT, K.RCVPCS, K.RCVWGT,
			     K.ARPCOD, K.STDPCS, K.STDWGT, K.SHPPFX, K.DOCNUM, K.PRDCOD,
			     K.PRDNAM, K.AGTCOD, K.SCCCOD, K.CNSCOD, K.ORGCOD, K.DSTCOD,
			     K.CONFLG, K.CONBDNFLG, K.AVLPCS, K.AVLWGT, K.ARPLSTUPDTIM,
			     K.CURCOD, K.PAYTYP, K.SCCMATVAL, K.CUSSCCCOD, K.CUSAGTCOD,  K.CUSCOD, 
			     K.CUSPRI, K.CUSMAXPRI, K.TOTDLVNOTPCS, K.TOTDLVNOTWGT, 
			     K.CNSFLG
			   FROM
			    (SELECT M.CMPCOD, M.ULDNUM, M.ULDSHPPCS, M.ULDSHPWGT, M.DOCOWRIDR,
			       M.MSTDOCNUM, M.DUPNUM, M.SEQNUM, M.TOTDLVPCS, M.TOTDLVWGT,
			       M.RCVPCS, M.RCVWGT, M.ARPCOD, M.STDPCS, M.STDWGT, M.SHPPFX,
			       M.DOCNUM, M.PRDCOD, M.PRDNAM, M.AGTCOD, M.SCCCOD, M.CNSCOD,
			       M.ORGCOD, M.DSTCOD, M.CONFLG, M.CONBDNFLG, M.AVLPCS, M.AVLWGT,
			       M.ARPLSTUPDTIM, M.CURCOD, M.PAYTYP, M.SCCMATVAL, M.CUSSCCCOD, 
			       M.CUSAGTCOD, M.CUSCOD, M.CUSPRI, M.TOTDLVNOTPCS, M.TOTDLVNOTWGT,			       
			       MAX(M.CUSPRI) OVER(PARTITION BY M.MSTDOCNUM,    M.DOCOWRIDR,    
			       M.SEQNUM,    M.DUPNUM,    M.CMPCOD) CUSMAXPRI, M.CNSFLG
			     FROM
			      (SELECT Q.CMPCOD, Q.ULDNUM, Q.ULDSHPPCS, Q.ULDSHPWGT, Q.DOCOWRIDR,
			         Q.MSTDOCNUM, Q.DUPNUM, Q.SEQNUM, Q.TOTDLVPCS, Q.TOTDLVWGT,
			         Q.RCVPCS, Q.RCVWGT, Q.ARPCOD, Q.STDPCS, Q.STDWGT, Q.SHPPFX,
			         Q.DOCNUM, Q.PRDCOD, Q.PRDNAM, Q.AGTCOD, Q.SCCCOD, Q.CNSCOD,
			         Q.ORGCOD, Q.DSTCOD, Q.CONFLG, Q.CONBDNFLG, Q.AVLPCS, Q.AVLWGT,
			         Q.ARPLSTUPDTIM, Q.CURCOD, Q.PAYTYP, Q.SCCMATVAL, Q.CUSSCCCOD, 
			         Q.CUSAGTCOD, Q.CUSCOD, Q.TOTDLVNOTPCS, Q.TOTDLVNOTWGT,
			         CASE
			       WHEN Q.SCCMATVAL > 0
			       AND Q.CUSSCCCOD IS NOT NULL THEN
			        2
			       WHEN Q.CUSSCCCOD IS NULL THEN
			        0
			       ELSE
			        -1
			       END CUSPRI,Q.CNSFLG
			       FROM
			        (
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>276</QRY:Id>
		<QRY:Source Name="operations.shipment.findgroupdeliverydetails.querysufix" Type="NATIVE">
			<![CDATA[
				 )
			      Q)
			    M)
			  K
			   WHERE K.CUSMAXPRI = K.CUSPRI
			   AND ( K.CUSPRI != -1 OR K.CNSFLG = 'N') )
			SUBQRY LEFT
			OUTER JOIN OPRSHPDLVNOT DLVNOT ON SUBQRY.CMPCOD = DLVNOT.CMPCOD
			 AND SUBQRY.ARPCOD = DLVNOT.ARPCOD
			 AND SUBQRY.DOCOWRIDR = DLVNOT.DOCOWRIDR
			 AND SUBQRY.MSTDOCNUM = DLVNOT.MSTDOCNUM
			 AND SUBQRY.DUPNUM = DLVNOT.DUPNUM
			 AND SUBQRY.SEQNUM = DLVNOT.SEQNUM
			 AND COALESCE(DLVNOT.ULDNUM,   SUBQRY.ULDNUM,   ?) = COALESCE(SUBQRY.ULDNUM,   ?) LEFT
			OUTER JOIN OPRSHPDTL SHPDTL ON SUBQRY.CMPCOD = SHPDTL.CMPCOD
			 AND SUBQRY.DOCOWRIDR = SHPDTL.DOCOWRIDR
			 AND SUBQRY.MSTDOCNUM = SHPDTL.MSTDOCNUM
			 AND SUBQRY.DUPNUM = SHPDTL.DUPNUM
			 AND SUBQRY.SEQNUM = SHPDTL.SEQNUM
			 LEFT OUTER JOIN SHRAGTMST AGTMST 
			 	   ON SUBQRY.CMPCOD = AGTMST.CMPCOD 
	   			AND SUBQRY.CUSAGTCOD = AGTMST.AGTCOD
				
				LEFT OUTER JOIN OPRSHPMSTACC ACC
				ON SUBQRY.CMPCOD     = ACC.CMPCOD
				AND SUBQRY.DOCOWRIDR = ACC.DOCOWRIDR
				AND SUBQRY.MSTDOCNUM = ACC.MSTDOCNUM
				AND SUBQRY.DUPNUM    = ACC.DUPNUM
				AND COALESCE(ACC.SEQNUM, 1)    = 1
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>277</QRY:Id>
		<QRY:Source Name="operations.shipment.findgroupdeliverydetails.basequeryone" Type="NATIVE">
			<![CDATA[
			 SELECT SHPMST.CMPCOD, ULDSHP.ULDNUM, NVL(ULDSHP.NUMPCS,    0) ULDSHPPCS,
			   NVL(ULDSHP.WGT,    0) ULDSHPWGT, SHPMST.DOCOWRIDR, SHPMST.MSTDOCNUM,
			   SHPMST.DUPNUM, SHPMST.SEQNUM, ARPSHP.TOTDLVPCS, ARPSHP.TOTDLVWGT,
			   ARPSHP.RCVPCS, ARPSHP.RCVWGT, ARPSHP.ARPCOD, SHPMST.STDPCS, SHPMST.STDWGT,
			   SHPMST.SHPPFX, SHPMST.DOCNUM, SHPMST.PRDCOD, SHPMST.PRDNAM, SHPMST.AGTCOD,
			   SHPMST.SCCCOD, SHPMST.CNSCOD, SHPMST.ORGCOD, SHPMST.DSTCOD, SHPMST.CONFLG,
			   ARPSHP.CONBDNFLG, ARPSHP.AVLPCS, ARPSHP.AVLWGT, ARPSHP.LSTUPDTIM ARPLSTUPDTIM,
			   SHPMST.CURCOD, SHPMST.PAYTYP, 
			   INSTR(? || CUSAGT.SCCCOD || ?,    ? || SHPMST.SCCCOD || ?) SCCMATVAL,
			   CUSAGT.SCCCOD CUSSCCCOD,CUSAGT.AGTCOD CUSAGTCOD,CUSAGT.CUSCOD,ARPSHP.TOTDLVNOTPCS,
			   ARPSHP.TOTDLVNOTWGT, 'Y' CNSFLG
			 FROM OPRSHPMST SHPMST
			 INNER JOIN OPRARPSHP ARPSHP ON SHPMST.CMPCOD = ARPSHP.CMPCOD
			 AND SHPMST.DOCOWRIDR = ARPSHP.DOCOWRIDR
			 AND SHPMST.MSTDOCNUM = ARPSHP.MSTDOCNUM
			 AND SHPMST.DUPNUM = ARPSHP.DUPNUM
			 AND SHPMST.SEQNUM = ARPSHP.SEQNUM
			 AND SHPMST.DSTCOD = ARPSHP.ARPCOD
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>278</QRY:Id>
		<QRY:Source Name="operations.shipment.findgroupdeliverydetails.basequerytwo" Type="NATIVE">
			<![CDATA[
			 SELECT SHPMST.CMPCOD, ULDSHP.ULDNUM ULDNUM, NVL(ULDSHP.NUMPCS,    0) ULDSHPPCS,
			   NVL(ULDSHP.WGT,    0) ULDSHPWGT, SHPMST.DOCOWRIDR, SHPMST.MSTDOCNUM, SHPMST.DUPNUM,
			   SHPMST.SEQNUM, ARPSHP.TOTDLVPCS, ARPSHP.TOTDLVWGT, ARPSHP.RCVPCS, ARPSHP.RCVWGT,
			   ARPSHP.ARPCOD, SHPMST.STDPCS, SHPMST.STDWGT, SHPMST.SHPPFX, SHPMST.DOCNUM,
			   SHPMST.PRDCOD, SHPMST.PRDNAM, SHPMST.AGTCOD, SHPMST.SCCCOD, SHPMST.CNSCOD,
			   SHPMST.ORGCOD, SHPMST.DSTCOD, SHPMST.CONFLG, ARPSHP.CONBDNFLG, ARPSHP.AVLPCS,
			   ARPSHP.AVLWGT, ARPSHP.LSTUPDTIM ARPLSTUPDTIM, SHPMST.CURCOD, SHPMST.PAYTYP,
			   INSTR(? || CUSAGT.SCCCOD || ?,    ? || SHPMST.SCCCOD || ?) SCCMATVAL,
			   CUSAGT.SCCCOD CUSSCCCOD, CUSAGT.AGTCOD CUSAGTCOD, CUSAGT.CUSCOD, ARPSHP.TOTDLVNOTPCS,
			   ARPSHP.TOTDLVNOTWGT, CASE WHEN MST1.DOCOWRIDR = SHPMST.DOCOWRIDR
                           AND MST1.MSTDOCNUM = SHPMST.MSTDOCNUM AND MST1.DUPNUM = SHPMST.DUPNUM
			   AND MST1.SEQNUM = SHPMST.SEQNUM THEN 'Y' ELSE 'N' END CNSFLG
			 FROM OPRSHPMST SHPMST
			 INNER JOIN OPRARPSHP ARPSHP ON SHPMST.CMPCOD = ARPSHP.CMPCOD
			 AND SHPMST.DOCOWRIDR = ARPSHP.DOCOWRIDR
			 AND SHPMST.MSTDOCNUM = ARPSHP.MSTDOCNUM
			 AND SHPMST.DUPNUM = ARPSHP.DUPNUM
			 AND SHPMST.SEQNUM = ARPSHP.SEQNUM
			 AND SHPMST.DSTCOD = ARPSHP.ARPCOD
			 INNER JOIN OPRULDSHP ULDSHP ON ARPSHP.CMPCOD = ULDSHP.CMPCOD
			 AND ARPSHP.ARPCOD = ULDSHP.ARPCOD
			 AND ARPSHP.DOCOWRIDR = ULDSHP.DOCOWRIDR
			 AND ARPSHP.MSTDOCNUM = ULDSHP.MSTDOCNUM
			 AND ARPSHP.DUPNUM = ULDSHP.DUPNUM
			 AND ARPSHP.SEQNUM = ULDSHP.SEQNUM
			 INNER JOIN OPRULDSHP ULDSHP1 ON ULDSHP1.CMPCOD = ULDSHP.CMPCOD
			 AND ULDSHP1.ARPCOD = ULDSHP.ARPCOD
			 AND ULDSHP1.ULDNUM = ULDSHP.ULDNUM	
			 INNER JOIN OPRSHPMST MST1 ON MST1.CMPCOD = ULDSHP1.CMPCOD
			 AND MST1.DOCOWRIDR = ULDSHP1.DOCOWRIDR
			 AND MST1.MSTDOCNUM = ULDSHP1.MSTDOCNUM
			 AND MST1.DUPNUM = ULDSHP1.DUPNUM
			 AND MST1.SEQNUM = ULDSHP1.SEQNUM
			]]>
		</QRY:Source>
	</QRY:Definition>
<QRY:Definition>
		<QRY:Id>279</QRY:Id>
		<QRY:Source Name="operations.shipment.findctodeliverychallandetails" Type="NATIVE">
			<![CDATA[
		    SELECT DLV.DLVNOTNUM,
			  MST.MSTDOCNUM      ,
			  MST.SEQNUM         ,
			  MST.DUPNUM         ,
			  MST.DOCOWRIDR      ,
			  MST.CMPCOD         ,
			  MST.SHPPFX         ,
			  MST.SHPDES         ,
			  DLV.DLVNOTPCS      ,
			  DLV.DLVNOTWGT      ,
			  DLV.DLVCUSCOD      ,
			  DLV.DLVCUSNAM      ,
			  DLV.ARPCOD         ,
			  DLV.RMK            ,
			  DLV.DNTISSDAT      ,
			  PAYATR.PAYTYP      ,
			  PAYATR.PAYATR      ,
			  PAYATR.PAYATRVAL   ,
				SUM(DISTINCT SRVPAY.AMTINNBASCUR) AMTINNBASCUR,
			  IMPFLT.FLTCARCOD, IMPFLT.FLTNUM, IMPFLT.FLTDAT
			   FROM OPRSHPMST MST   ,
			  OPRSHPDLVNOT DLV      ,
				  OPRSEGSHP SEGSHP, OPRARPIMPFLT IMPFLT, OPRFLTSEG SEG,
			  CSHPAYADV PAYADV      ,
			  CSHPAYADVSRV ADVSRV   ,
			  CSHPAYADVSRVPAY SRVPAY,
			  CSHSRVPAYATR PAYATR
			  WHERE DLV.CMPCOD   = MST.CMPCOD
				AND DLV.DOCOWRIDR    = MST.DOCOWRIDR
				AND DLV.MSTDOCNUM    = MST.MSTDOCNUM
				AND DLV.SEQNUM       = MST.SEQNUM
				AND DLV.DUPNUM       = MST.DUPNUM
				AND DLV.CMPCOD   = SEGSHP.CMPCOD
				AND DLV.DOCOWRIDR    = SEGSHP.DOCOWRIDR
				AND DLV.MSTDOCNUM    = SEGSHP.MSTDOCNUM
				AND DLV.SEQNUM       = SEGSHP.SEQNUM
				AND DLV.DUPNUM       = SEGSHP.DUPNUM
				AND SEGSHP.FLTCARIDR =IMPFLT.FLTCARIDR
				AND SEGSHP.FLTNUM=IMPFLT.FLTNUM
				AND SEGSHP.FLTSEQNUM=IMPFLT.FLTSEQNUM
				AND SEGSHP.CMPCOD = IMPFLT.CMPCOD
				AND DLV.ARPCOD=IMPFLT.ARPCOD
				AND IMPFLT.FLTCARIDR=SEG.FLTCARIDR
				AND IMPFLT.FLTNUM=SEG.FLTNUM
				AND IMPFLT.FLTSEQNUM=SEG.FLTSEQNUM
				AND IMPFLT.CMPCOD=SEG.CMPCOD
				AND SEG.POU=IMPFLT.ARPCOD
				AND DLV.CMPCOD       = PAYADV.CMPCOD(+)
				AND DLV.ARPCOD       = PAYADV.STNCOD(+)
				AND DLV.PAYADVNUM    = PAYADV.PAYADVNUM(+)
				AND PAYADV.CMPCOD    = ADVSRV.CMPCOD(+)
				AND PAYADV.STNCOD    = ADVSRV.STNCOD(+)
				AND PAYADV.PAYADVNUM = ADVSRV.PAYADVNUM(+)
				AND ADVSRV.CMPCOD    = SRVPAY.CMPCOD(+)
				AND ADVSRV.STNCOD    = SRVPAY.STNCOD(+)
				AND ADVSRV.PAYADVNUM = SRVPAY.PAYADVNUM(+)
				AND ADVSRV.SRVCOD    = SRVPAY.SRVCOD(+)
				AND SRVPAY.CMPCOD    = PAYATR.CMPCOD(+)
				AND SRVPAY.STNCOD    = PAYATR.STNCOD(+)
				AND SRVPAY.PAYADVNUM = PAYATR.PAYADVNUM(+)
				AND SRVPAY.SRVCOD    = PAYATR.SRVCOD(+)
				AND SRVPAY.PAYTYP    = PAYATR.PAYTYP(+)
				AND DLV.DLVNOTNUM    = ?
				AND DLV.CMPCOD       = ?
				AND DLV.ARPCOD       = ?
				GROUP BY DLV.DLVNOTNUM,
				  MST.MSTDOCNUM       ,
				  MST.SEQNUM          ,
				  MST.DUPNUM          ,
				  MST.DOCOWRIDR       ,
				  MST.CMPCOD          ,
				  MST.SHPDES          ,
				  MST.SHPPFX          ,
				  DLV.DLVNOTPCS       ,
				  DLV.DLVNOTWGT       ,
				  DLV.DLVCUSCOD       ,
				  DLV.DLVCUSNAM       ,
				  DLV.ARPCOD          ,
				  DLV.RMK             ,
				  DLV.DNTISSDAT       ,
				  PAYATR.PAYTYP       ,
				  PAYATR.PAYATRVAL,
				  IMPFLT.FLTCARCOD, 
				  IMPFLT.FLTNUM, 
				  IMPFLT.FLTDAT,
				  PAYATR.PAYATR 
			]]>
		</QRY:Source>
	</QRY:Definition>   

	<QRY:Definition>
		<QRY:Id>280</QRY:Id>
		<QRY:Source Name="operations.shipment.cto.findfsuarrdetails" Type="NATIVE">
			<![CDATA[
			 SELECT DISTINCT MST.DOMFLG,ULD.CMPCOD CMPCOD, ULD.FLTCARIDR FLTCARIDR, ULD.FLTNUM FLTNUM, ULD.FLTSEQNUM FLTSEQNUM,
                SHP.DOCOWRIDR, SHP.MSTDOCNUM MSTDOCNUM, SHP.DUPNUM DUPNUM, SHP.SEQNUM SHPSEQNUM,
                SHP.RMK SHPRMK, MST.SHPDES SHPDES, MST.ORGCOD ORGCOD, MST.DSTCOD DSTCOD,
                MST.STDWGTCOD STDWGTCOD, MST.STDDISWGT STDDISWGT, MST.SHPPFX, MST.STDPCS, MST.STDWGT,
                MST.OWRCOD OWRCOD, MST.AGTCOD, AGTGRP.GRPNAM AGTGRP, MST.CNSCOD,MST.SEQNUM, CUSMST.CUSGRP CNSGRP,
                MST.GRSVOL, SEG.POL POL, SEG.POU POU, SEGSHP.MFTPCS MFTPCS, SEGSHP.MFTWGT MFTWGT,
                SEGSHP.MFTVOL MFTVOL, ARPSHP.DOCRCVFLG, LEG.ATA, LEG.ATD, LEG.STA, LEG.STD,FLTMST.FLTROU,MIS.JNVPAR, 
                CASE
                        WHEN ARL.APHCODUSE = 3
                                THEN ARL.THRAPHCOD
                        ELSE ARL.TWOAPHCOD
                END CARCOD,SYS.PARVAL WGTCOD, SHPRTG.DSTCOD RTGCNT,  SHRMST.CNTCOD
           FROM OPRSEGULD ULD,
                OPRSEGULDSHP SHP,
                OPRSHPMST MST,
                OPRFLTSEG SEG,
                OPRSEGSHP SEGSHP,
                OPRARPSHP ARPSHP,
                FLTOPRLEG LEG,
                FLTOPRMST FLTMST,
				SHRSYSPAR SYS,
                SHRCUSMST CUSMST,
                SHRGENMSTGRPDTL AGTGRP,
                SHRARLMST ARL,
                OPRSHPRTG SHPRTG,
				 OPRSHPMSTMIS MIS,
				 SHRARPMST SHRMST
          WHERE ULD.FLTCARIDR = SHP.FLTCARIDR(+)
            AND ULD.FLTNUM = SHP.FLTNUM(+)
            AND ULD.FLTSEQNUM = SHP.FLTSEQNUM(+)
            AND ULD.SEGSERNUM = SHP.SEGSERNUM(+)
            AND ULD.CMPCOD = SHP.CMPCOD(+)
            AND ULD.ULDNUM = SHP.ULDNUM(+)
            AND ULD.FLTCARIDR = SEG.FLTCARIDR(+)
            AND ULD.FLTNUM = SEG.FLTNUM(+)
            AND ULD.FLTSEQNUM = SEG.FLTSEQNUM(+)
            AND ULD.SEGSERNUM = SEG.SEGSERNUM(+)
            AND ULD.CMPCOD = SEG.CMPCOD(+)
            AND SHP.DOCOWRIDR = MST.DOCOWRIDR(+)
            AND SHP.MSTDOCNUM = MST.MSTDOCNUM(+)
            AND SHP.DUPNUM = MST.DUPNUM(+)
            AND SHP.SEQNUM = MST.SEQNUM(+)
            AND SHP.CMPCOD = MST.CMPCOD(+)
            AND SHP.DOCOWRIDR = SEGSHP.DOCOWRIDR(+)
            AND SHP.MSTDOCNUM = SEGSHP.MSTDOCNUM(+)
            AND SHP.DUPNUM = SEGSHP.DUPNUM(+)
            AND SHP.SEQNUM = SEGSHP.SEQNUM(+)
            AND SHP.CMPCOD = SEGSHP.CMPCOD(+)
            AND SHP.FLTCARIDR = SEGSHP.FLTCARIDR(+)
            AND SHP.FLTNUM = SEGSHP.FLTNUM(+)
            AND SHP.FLTSEQNUM = SEGSHP.FLTSEQNUM(+)
            AND SHP.SEGSERNUM = SEGSHP.SEGSERNUM(+)
            AND SEGSHP.DOCOWRIDR = ARPSHP.DOCOWRIDR(+)
            AND SEGSHP.MSTDOCNUM = ARPSHP.MSTDOCNUM(+)
            AND SEGSHP.DUPNUM = ARPSHP.DUPNUM(+)
            AND SEGSHP.SEQNUM = ARPSHP.SEQNUM(+)
            AND SEGSHP.CMPCOD = ARPSHP.CMPCOD(+)			
            AND FLTMST.FLTNUM       = SHP.FLTNUM
            AND FLTMST.FLTCARIDR    = SHP.FLTCARIDR
            AND FLTMST.FLTSEQNUM    = SHP.FLTSEQNUM
            AND FLTMST.CMPCOD       = SHP.CMPCOD		
			AND MST.MSTDOCNUM = MIS.MSTDOCNUM(+)
			AND MST.DOCOWRIDR   = MIS.DOCOWRIDR(+)
			AND MST.DUPNUM      = MIS.DUPNUM(+)
			AND MST.SEQNUM      = MIS.SEQNUM(+)
			AND MST.CMPCOD      = MIS.CMPCOD(+)
			AND ULD.CMPCOD = SYS.CMPCOD
            AND MST.CMPCOD = CUSMST.CMPCOD(+)
            AND MST.SHPCOD = CUSMST.CUSCOD(+)
            AND MST.CMPCOD = AGTGRP.CMPCOD(+)
            AND MST.AGTCOD = AGTGRP.GRPENT(+)
			AND AGTGRP.GRPCATCOD(+) = 'GEN'
            AND ULD.CMPCOD = ARL.CMPCOD
            AND ULD.FLTCARIDR = ARL.ARLIDR
            AND SEG.CMPCOD = LEG.CMPCOD
            AND SEG.FLTCARIDR = LEG.FLTCARIDR
            AND SEG.FLTNUM = LEG.FLTNUM
            AND SEG.FLTSEQNUM = LEG.FLTSEQNUM
            AND SEG.POU = LEG.LEGDST
            AND MST.MSTDOCNUM 		= SHPRTG.MSTDOCNUM(+)
			AND MST.DOCOWRIDR 		= SHPRTG.DOCOWRIDR(+)
			AND MST.DUPNUM 		 	= SHPRTG.DUPNUM(+)
			AND MST.SEQNUM 		 	= SHPRTG.SEQNUM(+)
			AND MST.CMPCOD 		 	= SHPRTG.CMPCOD(+)
			AND SHP.MSTDOCNUM IS NOT NULL
			AND MST.CMPCOD      = SHRMST.CMPCOD(+)
  AND MST.ORGCOD      =  SHRMST.ARPCOD(+)
            AND ULD.FLTCARIDR = ?
            AND ULD.FLTNUM = ?
            AND ULD.FLTSEQNUM = ?
            AND ULD.CMPCOD = ?
            AND SEG.POU = ?
			AND SYS.PARCOD = ?
			AND ARPSHP.ARPCOD(+) = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	
	<QRY:Definition>
		<QRY:Id>281</QRY:Id>
		<QRY:Source Name="operations.shipment.findundelivereddnforshipment" Type="OBJECT">
			<![CDATA[
		SELECT
				deliveryNote
		FROM
				com.ibsplc.icargo.business.operations.shipment.delivery.DeliveryNote AS deliveryNote
		WHERE
				deliveryNote.deliveryNotePK.companyCode = ?
			AND	deliveryNote.deliveryNotePK.airportCode = ?
			AND	deliveryNote.masterDocumentNumber = ?
			AND deliveryNote.ownerId = ?
			AND deliveryNote.duplicateNumber = ?
			AND deliveryNote.sequenceNumber = ?
			AND (deliveryNote.deliveryNotePieces -deliveryNote.deliveredPieces > 0 OR deliveryNote.deliveryNoteWeight -deliveryNote.deliveredWeight > 0)
		
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>282</QRY:Id>
		<QRY:Source Name="operations.shipment.trackShipmentHistory" Type="NATIVE">
			<![CDATA[
		        SELECT CMPCOD,
						  DOCOWRIDR   ,
						  MSTDOCNUM   ,
						  DUPNUM      ,
						  SEQNUM      ,
						  ORGCOD      ,
						  DSTCOD      ,
						  SHPDES      ,
						  SCCCOD      ,
						  SHPNAM      ,
						  CNSNAM      ,
						  TXNCOD      ,
						  TXNDES      ,
						  MSTORGCOD  , 
						  MSTDSTCOD  ,
						  STDPCS      ,
						  STDWGT      ,
						  TXNPCS      ,
						  TXNWGT      ,
						  TXNVOL      ,
						  TXNDAT      ,
						  LOCDAT      ,
						  ARPCOD      ,
						  0 TXNPRT    ,
						  TXNREFONE   ,
						  TXNREFTWO   ,
						  TXNREFTHR   ,
						  TXNREFFOR   ,
						  TXNREFFIV   ,
						  TXNREFSIX   ,
						  TXNREFSEV	  ,
						  TXNREFTEN   ,
						  ULDDTL      ,
						  STDWGTCOD   ,
						  TXNREFNIN   ,
						  TXNREFEIN   ,
						  TXNREFELV   ,
						  TXNREFEGT   ,
						  LSTUPDTIM,
						  SHPPFX
						   FROM
						  (SELECT HIS.CMPCOD,
						    HIS.DOCOWRIDR   ,
						    HIS.MSTDOCNUM   ,
						    HIS.DUPNUM      ,
						    HIS.SEQNUM      ,
						    (SELECT ARPMST.ARPNAM
						       FROM SHRARPMST ARPMST
						      WHERE ARPMST.CMPCOD= MST.CMPCOD
						    AND ARPMST.ARPCOD    = MST.ORGCOD
						    ) ORGCOD,
						    (SELECT ARPMST.ARPNAM
						       FROM SHRARPMST ARPMST
						      WHERE ARPMST.CMPCOD= MST.CMPCOD
						    AND ARPMST.ARPCOD    = MST.DSTCOD
						    ) DSTCOD  ,
						    MST.SHPDES,
						    MST.SCCCOD,
						    MST.SHPNAM,
						    MST.CNSNAM,
						    CASE
						      WHEN TXNCOD IN ('OFLD','OVCD')
						      THEN 'DIS'
						      ELSE HIS.TXNCOD
						    END TXNCOD          ,
						    HIS.TXNDES TXNDES   ,
						    MST.ORGCOD MSTORGCOD,
						    MST.DSTCOD MSTDSTCOD,
						    MST.STDPCS          ,
						    MST.STDWGT          ,
						    HIS.TXNPCS          ,
						    HIS.TXNWGT          ,
							HIS.TXNVOL          ,
						    HIS.TXNDATUTC TXNDAT,
						    HIS.TXNDAT LOCDAT   ,
						    HIS.ARPCOD ARPCOD   ,
						    0 TXNPRT            ,
						    HIS.TXNREFONE       ,
						    HIS.TXNREFTWO       ,
						    HIS.TXNREFTHR       ,
						    HIS.TXNREFFOR       ,
						    HIS.TXNREFFIV       ,
						    HIS.TXNREFSIX       ,
						    HIS.TXNREFSEV       ,
						    HIS.TXNREFTEN       ,
						    HIS.TXNREFSIX ULDDTL,
						    MST.STDWGTCOD       ,
						    HIS.TXNREFNIN       ,
						    HIS.TXNREFEIN       ,
						    HIS.TXNREFELV       ,
							HIS.TXNREFEGT       ,
							HIS.LSTUPDTIM		,
						    MST.SHPPFX
						     FROM OPRSHPMST MST,
						    OPRSHPHIS HIS
						    WHERE HIS.CMPCOD=MST.CMPCOD(+)
						  AND HIS.DOCOWRIDR =MST.DOCOWRIDR(+)
						  AND HIS.MSTDOCNUM =MST.MSTDOCNUM(+)
						  AND HIS.DUPNUM    =MST.DUPNUM(+)
  AND HIS.SEQNUM    =MST.SEQNUM(+)
			]]>
		</QRY:Source>
	</QRY:Definition>
	
	<QRY:Definition>
		<QRY:Id>283</QRY:Id>
		<QRY:Source Name="operations.shipment.trackLatestStatus_part_one" Type="NATIVE">
			<![CDATA[
						SELECT * FROM
  (SELECT CMPCOD                                                                                                                   ,
    DOCOWRIDR                                                                                                                      ,
    MSTDOCNUM                                                                                                                      ,
    DUPNUM                                                                                                                         ,
    SEQNUM                                                                                                                         ,
    ARPCOD                                                                                                                         ,
    TXNCOD                                                                                                                         ,
    TXNDES                                                                                                                         ,
    TXNDAT                                                                                                                         ,
    ACTPCS                                                                                                                         ,
    ACTWGT                                                                                                                         ,
	ACTVOL																														   ,
    NVL(LAG(ACTPCS) OVER(PARTITION BY CMPCOD, DOCOWRIDR, MSTDOCNUM, DUPNUM, SEQNUM ORDER BY TXNDAT DESC, TXNPRT), 0) PCS           ,
    NVL(LAG(ACTWGT) OVER(PARTITION BY CMPCOD, DOCOWRIDR, MSTDOCNUM, DUPNUM, SEQNUM ORDER BY TXNDAT DESC, TXNPRT), 0) WGT           ,
	NVL(LAG(ACTVOL) OVER(PARTITION BY CMPCOD, DOCOWRIDR, MSTDOCNUM, DUPNUM, SEQNUM ORDER BY TXNDAT DESC, TXNPRT), 0) VOL           ,
    ACTPCS -NVL(LAG(ACTPCS) OVER(PARTITION BY CMPCOD, DOCOWRIDR, MSTDOCNUM, DUPNUM, SEQNUM ORDER BY TXNDAT DESC, TXNPRT), 0) EVTPCS,
    ACTWGT -NVL(LAG(ACTWGT) OVER(PARTITION BY CMPCOD, DOCOWRIDR, MSTDOCNUM, DUPNUM, SEQNUM ORDER BY TXNDAT DESC, TXNPRT), 0) EVTWGT,
	ACTVOL -NVL(LAG(ACTVOL) OVER(PARTITION BY CMPCOD, DOCOWRIDR, MSTDOCNUM, DUPNUM, SEQNUM ORDER BY TXNDAT DESC, TXNPRT), 0) EVTVOL,
	STDPCS -NVL(LAG(STDPCS) OVER(PARTITION BY CMPCOD, DOCOWRIDR, MSTDOCNUM, DUPNUM, SEQNUM ORDER BY TXNDAT DESC, TXNPRT), 0) EVTSTDPCS,
    TXNPRT                                                                                                                         ,
    (SELECT ARPMST.ARPNAM
       FROM SHRARPMST ARPMST
      WHERE ARPMST.CMPCOD= Z.CMPCOD
    AND ARPMST.ARPCOD    = Z.ORGCOD
    ) ORGCOD,
    (SELECT ARPMST.ARPNAM
       FROM SHRARPMST ARPMST
      WHERE ARPMST.CMPCOD= Z.CMPCOD
    AND ARPMST.ARPCOD    = Z.DSTCOD
    ) DSTCOD ,
    STDPCS   ,
    STDWGT   ,
    STDWGTCOD,
    SHPDES   ,
    SCCCOD   ,
    SHPNAM   ,
    CNSNAM   ,
    LOCDAT   ,
    (SELECT RTRIM(xmlagg(xmlelement(e, sernum
      ||'*'
      || txnrefone
      || txnrefthr
      || (
      CASE
        WHEN txnrefthr IS NULL
        AND txnrefone  IS NULL
        THEN ''
        ELSE '/'
      END)
      || txnreffor
      || (
      CASE
        WHEN txnreften IS NULL
        THEN ''
        ELSE '('
      END)
      || txnreften
      || (
      CASE
        WHEN txnreften IS NULL
        THEN ''
        ELSE ')'
      END)
      || ',')).EXTRACT('//text()'), ',') enames
       FROM oprshphis shphis
      WHERE shphis.cmpcod = z.cmpcod
    AND shphis.docowridr  = z.docowridr
    AND shphis.mstdocnum  = z.mstdocnum
    AND shphis.dupnum     = z.dupnum
    AND shphis.seqnum     = z.seqnum
    AND shphis.txncod     = z.txncod
    AND shphis.arpcod     = z.arpcod
    AND z.txncod NOT     IN ('DLV')
    ) FLTDTL,
	 (SELECT RTRIM(xmlagg(xmlelement(e,  fltcarcod
      || fltnum
      || (
      CASE
        WHEN fltdat IS NULL
        AND fltdat  IS NULL
        THEN ''
        ELSE '/'
      END)
      || to_char(fltdat, 'dd-Mon-yyyy')
      
      || ',')).EXTRACT('//text()'), ',') enames
    FROM CAPBKGFLTDTL FLTDTL
    WHERE FLTDTL.cmpcod  = z.cmpcod
    AND FLTDTL.docowridr = z.docowridr
    AND FLTDTL.mstdocnum = z.mstdocnum
    AND FLTDTL.dupnum    = z.dupnum
    AND FLTDTL.seqnum    = z.seqnum    
    AND z.txncod IN ('BKD') ) BKGFLTDTL,
   (SELECT TOTNUMPCS 
    FROM capbkgmst bkgmst
    WHERE bkgmst.cmpcod  = z.cmpcod
    AND bkgmst.docowridr = z.docowridr
    AND bkgmst.mstdocnum = z.mstdocnum
    AND bkgmst.dupnum    = z.dupnum
    AND bkgmst.seqnum    = z.seqnum
    AND z.txncod        IN ('BKD')
    )BKDPCS,
    (SELECT TOTWGT 
    FROM capbkgmst bkgmst
    WHERE bkgmst.cmpcod  = z.cmpcod
    AND bkgmst.docowridr = z.docowridr
    AND bkgmst.mstdocnum = z.mstdocnum
    AND bkgmst.dupnum    = z.dupnum
    AND bkgmst.seqnum    = z.seqnum
    AND z.txncod        IN ('BKD')
    )BKDWGT,
    (SELECT TOTVOL 
    FROM capbkgmst bkgmst
    WHERE bkgmst.cmpcod  = z.cmpcod
    AND bkgmst.docowridr = z.docowridr
    AND bkgmst.mstdocnum = z.mstdocnum
    AND bkgmst.dupnum    = z.dupnum
    AND bkgmst.seqnum    = z.seqnum
    AND z.txncod        IN ('BKD')   
    )BKDVOL,
    CASE
      WHEN TXNCOD IN('RCF')
      THEN
        (SELECT RTRIM(XMLAGG(XMLELEMENT(E, SHPHIS.TXNREFSIX
          || ',')).EXTRACT('//text()'), ',') ENAMES
           FROM OPRSHPHIS SHPHIS
          WHERE SHPHIS.CMPCOD = Z.CMPCOD
        AND SHPHIS.DOCOWRIDR  = Z.DOCOWRIDR
        AND SHPHIS.MSTDOCNUM  = Z.MSTDOCNUM
        AND SHPHIS.DUPNUM     = Z.DUPNUM
        AND SHPHIS.SEQNUM     = Z.SEQNUM
        AND SHPHIS.TXNCOD     = Z.TXNCOD
        AND SHPHIS.ARPCOD     = Z.ARPCOD
        )
      ELSE NULL
    END ULDDTL,
    (SELECT RTRIM(xmlagg(xmlelement(e, bkgdtl.uldgrp
      ||'-'
      ||bkgdtl.uldnum
      || ',')).EXTRACT('//text()'), ',') enames
       FROM capbkgmst bkgmst,
      capbkgdtl bkgdtl
      WHERE bkgmst.cmpcod = z.cmpcod
    AND bkgmst.docowridr  = z.docowridr
    AND bkgmst.mstdocnum  = z.mstdocnum
    AND bkgmst.dupnum     = z.dupnum
    AND bkgmst.seqnum     = z.seqnum
    AND bkgdtl.cmpcod     =bkgmst.cmpcod
    AND bkgdtl.ubrnum     =bkgmst.ubrnum
    AND bkgdtl.uldnum     >0
    
    )BKDULDDTL,
    (SELECT RTRIM(xmlagg(xmlelement(e, uldacp.uldnum
      || ',')).EXTRACT('//text()'), ',') enames
       FROM opruldacpdtl uldacp
      WHERE uldacp.cmpcod = z.cmpcod
    AND uldacp.docowridr  = z.docowridr
    AND uldacp.mstdocnum  = z.mstdocnum
    AND uldacp.dupnum     = z.dupnum
    AND uldacp.seqnum     = z.seqnum
    )acpulddtl,
    SHPPFX,
    (SELECT RTRIM(XMLAGG(XMLELEMENT(E, sernum
          ||'*'
          || txnrefone
          || txnrefthr
          || (
          CASE
            WHEN txnrefthr IS NULL
            AND txnrefone  IS NULL
            THEN ''
            ELSE '/'
          END)
          || SHPHIS.TXNREFEIN
          || ',')).EXTRACT('//text()'), ',') ENAMES
           FROM OPRSHPHIS SHPHIS
          WHERE SHPHIS.CMPCOD = Z.CMPCOD
        AND SHPHIS.DOCOWRIDR  = Z.DOCOWRIDR
        AND SHPHIS.MSTDOCNUM  = Z.MSTDOCNUM
        AND SHPHIS.DUPNUM     = Z.DUPNUM
        AND SHPHIS.SEQNUM     = Z.SEQNUM
        AND SHPHIS.TXNCOD     = Z.TXNCOD
        AND SHPHIS.ARPCOD     = Z.ARPCOD
    )FLTCON
     FROM
    (SELECT CMPCOD         ,
      DOCOWRIDR            ,
      MSTDOCNUM            ,
      DUPNUM               ,
      SEQNUM               ,
      ORGCOD               ,
      DSTCOD               ,
      STDPCS               ,
      STDWGT               ,
      STDWGTCOD            ,
      SHPDES               ,
      SCCCOD               ,
      SHPNAM               ,
      CNSNAM               ,
      ARPCOD               ,
      TXNCOD               ,
      TXNDES               ,
      TXNPCS AS ACTPCS   ,
      TXNWGT AS ACTWGT   ,
	  TXNVOL AS ACTVOL ,
      MIN(TXNDATUTC) TXNDAT,
      MAX(TXNDAT) LOCDAT   ,
      TXNPRT               ,
      SERNUM               ,
      SHPPFX               ,
      TXNREFEIN
       FROM
      /* RCS,RCT,DLV,MAN,DEP,PRE,RCF,ARR,TFD
      UNION
      OFLD OVCD as DEP
      UNION
      BKD
      */
      /*OTHERS*/
      (
      SELECT MST.CMPCOD,
        MST.DOCOWRIDR  ,
        MST.MSTDOCNUM  ,
        MST.DUPNUM     ,
        MST.SEQNUM     ,
        MST.ORGCOD     ,
        MST.DSTCOD     ,
        MST.STDPCS     ,
        MST.STDWGT     ,
        MST.STDWGTCOD  ,
        MST.SHPDES     ,
        MST.SCCCOD     ,
        MST.SHPNAM     ,
        MST.CNSNAM     ,
        HIS.ARPCOD     ,
        HIS.TXNCOD     ,
        HIS.TXNDES     ,
        HIS.TXNPCS     ,
        HIS.TXNWGT     ,
		HIS.TXNVOL     ,
        HIS.TXNDATUTC  ,
        HIS.TXNDAT     ,
        TXNPRT.TXNPRT  ,
        0 SERNUM       ,
        MST.SHPPFX     ,
        HIS.TXNREFEIN
         FROM OPRSHPMST MST
      INNER JOIN OPRSHPHIS HIS
           ON MST.CMPCOD = HIS.CMPCOD
      AND MST.DOCOWRIDR  = HIS.DOCOWRIDR
      AND MST.MSTDOCNUM  = HIS.MSTDOCNUM
      AND MST.DUPNUM     = HIS.DUPNUM
      AND MST.SEQNUM     = HIS.SEQNUM
      INNER JOIN OPRTXNPRT TXNPRT
           ON HIS.TXNCOD = TXNPRT.TXNCOD
      AND HIS.CMPCOD     = TXNPRT.CMPCOD						
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>284</QRY:Id>
		<QRY:Source Name="operations.shipment.trackLatestStatus_part_two" Type="NATIVE">
			<![CDATA[
					
       	        UNION       	       
		       	       
		              /* OFLD OVCD As DEP */
       	        UNION       	       
		       	       
		              /* OFLD OVCD As DEP */
		              
		(SELECT CMPCOD            ,
		  DOCOWRIDR               ,
		  MSTDOCNUM               ,
		  DUPNUM                  ,
		  SEQNUM                  ,
		  ORGCOD                  ,
		  DSTCOD                  ,
		  STDPCS                  ,
		  STDWGT                  ,
		  STDWGTCOD               ,
		  SHPDES                  ,
		  SCCCOD                  ,
		  SHPNAM                  ,
		  CNSNAM                  ,
		  ARPCOD                  ,
		  TXNCOD                  ,
		  'Departed' TXNDES       ,
		  SUM(TXNPCS) TXNPCS      ,
		  SUM(TXNWGT) TXNWGT      ,
		  SUM(TXNVOL) TXNVOL      ,
		  MIN(TXNDATUTC) TXNDATUTC,
		  MIN(TXNDAT) TXNDAT      ,
		  TXNPRT                  ,
		  0 SERNUM                ,
		  SHPPFX                  ,
		  TXNREFEIN
		   FROM
		  (SELECT MST.CMPCOD,
		    MST.DOCOWRIDR   ,
		    MST.MSTDOCNUM   ,
		    MST.DUPNUM      ,
		    MST.SEQNUM      ,
		    MST.ORGCOD      ,
		    MST.DSTCOD      ,
		    MST.STDPCS      ,
		    MST.STDWGT      ,
		    MST.STDWGTCOD   ,
		    MST.SHPDES      ,
		    MST.SCCCOD      ,
		    MST.SHPNAM      ,
		    MST.CNSNAM      ,
		    HIS.ARPCOD      ,
		    CASE
		      WHEN HIS.TXNCOD IN ('OFLD','OVCD')
		      THEN 'DEP'
		      ELSE HIS.TXNCOD
		    END TXNCOD,
		    HIS.TXNDES,
		    CASE
		      WHEN HIS.TXNREFEGT ='OFLD'
		      THEN (-HIS.TXNPCS)
		      WHEN HIS.TXNREFEGT ='OVCD'
		      THEN (HIS.TXNPCS)
		      ELSE (HIS.TXNPCS)
		    END TXNPCS,
		    CASE
		      WHEN HIS.TXNREFEGT ='OFLD'
		      THEN (-HIS.TXNWGT)
		      WHEN HIS.TXNREFEGT ='OVCD'
		      THEN (HIS.TXNWGT)
		      ELSE (HIS.TXNWGT)
		    END TXNWGT   ,
			CASE
		      WHEN HIS.TXNREFEGT ='OFLD'
		      THEN (-HIS.TXNVOL)
		      WHEN HIS.TXNREFEGT ='OVCD'
		      THEN (HIS.TXNVOL)
		      ELSE (HIS.TXNVOL)
		    END TXNVOL   ,
		    HIS.TXNDATUTC,
		    HIS.TXNDAT   ,
		    TXNPRT.TXNPRT,
		    MST.SHPPFX,
		    HIS.TXNREFEIN
		     FROM OPRSHPMST MST
		  INNER JOIN OPRSHPHIS HIS
		       ON MST.CMPCOD = HIS.CMPCOD
		  AND MST.DOCOWRIDR  = HIS.DOCOWRIDR
		  AND MST.MSTDOCNUM  = HIS.MSTDOCNUM
		  AND MST.DUPNUM     = HIS.DUPNUM
		  AND MST.SEQNUM     = HIS.SEQNUM
		  INNER JOIN OPRTXNPRT TXNPRT
		       ON HIS.TXNCOD = TXNPRT.TXNCOD
  AND HIS.CMPCOD     = TXNPRT.CMPCOD
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>285</QRY:Id>
		<QRY:Source Name="operations.shipment.trackLatestStatus_part_three" Type="NATIVE">
			<![CDATA[
		          
		       		UNION
					       	       
					              /* OFLD OVCD As MAN */
		       		UNION
					       	       
					              /* OFLD OVCD As MAN */
					              (SELECT CMPCOD            ,
						        DOCOWRIDR               ,
						        MSTDOCNUM               ,
						        DUPNUM                  ,
						        SEQNUM                  ,
						        ORGCOD                  ,
						        DSTCOD                  ,
						        STDPCS                  ,
						        STDWGT                  ,
						        STDWGTCOD               ,
						        SHPDES                  ,
						        SCCCOD                  ,
						        SHPNAM                  ,
						        CNSNAM                  ,
						        ARPCOD                  ,
						        TXNCOD                  ,
						        'Manifested' TXNDES     ,
						        SUM(TXNPCS) TXNPCS      ,
						        SUM(TXNWGT) TXNWGT      ,
								SUM(TXNVOL) TXNVOL      ,
						        MIN(TXNDATUTC) TXNDATUTC,
						        MIN(TXNDAT) TXNDAT      ,
						        TXNPRT                  ,
						        0 SERNUM                ,
						        SHPPFX                  ,
						        TXNREFEIN
						         FROM
						        (SELECT MST.CMPCOD,
						          MST.DOCOWRIDR   ,
						          MST.MSTDOCNUM   ,
						          MST.DUPNUM      ,
						          MST.SEQNUM      ,
						          MST.ORGCOD      ,
						          MST.DSTCOD      ,
						          MST.STDPCS      ,
						          MST.STDWGT      ,
						          MST.STDWGTCOD   ,
						          MST.SHPDES      ,
						          MST.SCCCOD      ,
						          MST.SHPNAM      ,
						          MST.CNSNAM      ,
						          HIS.ARPCOD      ,
						          CASE
						            WHEN HIS.TXNCOD IN ('OFLD','OVCD')
						            THEN 'MAN'
						            ELSE HIS.TXNCOD
						          END TXNCOD,
						          HIS.TXNDES,
						          CASE
						            WHEN HIS.TXNREFEGT ='OFLD'
						            THEN (-HIS.TXNPCS)
						            WHEN HIS.TXNREFEGT ='OVCD'
						            THEN (HIS.TXNPCS)
						            ELSE (HIS.TXNPCS)
						          END TXNPCS,
						          CASE
						            WHEN HIS.TXNREFEGT ='OFLD'
						            THEN (-HIS.TXNWGT)
						            WHEN HIS.TXNREFEGT ='OVCD'
						            THEN (HIS.TXNWGT)
						            ELSE (HIS.TXNWGT)
						          END TXNWGT   ,
								   CASE
						            WHEN HIS.TXNREFEGT ='OFLD'
						            THEN (-HIS.TXNVOL)
						            WHEN HIS.TXNREFEGT ='OVCD'
						            THEN (HIS.TXNVOL)
						            ELSE (HIS.TXNVOL)
						          END TXNVOL   ,
						          HIS.TXNDATUTC,
						          HIS.TXNDAT   ,
						          TXNPRT.TXNPRT,
						          MST.SHPPFX,
						          HIS.TXNREFEIN
						           FROM OPRSHPMST MST
						        INNER JOIN OPRSHPHIS HIS
						             ON MST.CMPCOD = HIS.CMPCOD
						        AND MST.DOCOWRIDR  = HIS.DOCOWRIDR
						        AND MST.MSTDOCNUM  = HIS.MSTDOCNUM
						        AND MST.DUPNUM     = HIS.DUPNUM
						        AND MST.SEQNUM     = HIS.SEQNUM
						        INNER JOIN OPRTXNPRT TXNPRT
						             ON HIS.TXNCOD = TXNPRT.TXNCOD
  AND HIS.CMPCOD     = TXNPRT.CMPCOD
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>286</QRY:Id>
		<QRY:Source Name="operations.shipment.trackLatestStatus_part_four" Type="NATIVE">
			<![CDATA[
		          
		       		UNION


						       		/*BKD*/
						       		(SELECT CMPCOD         ,
								  DOCOWRIDR            ,
								  MSTDOCNUM            ,
								  DUPNUM               ,
								  SEQNUM               ,
								  ORGCOD               ,
								  DSTCOD               ,
								  STDPCS               ,
								  STDWGT               ,
								  STDWGTCOD            ,
								  SHPDES               ,
								  SCCCOD               ,
								  SHPNAM               ,
								  CNSNAM               ,
								  ARPCOD               ,
								  TXNCOD               ,
								  TXNDES               ,
								  SUM(TXNPCS) ACTPCS   ,
								  SUM(TXNWGT) ACTWGT   ,
								  SUM(TXNVOL) ACTVOL   ,
								  MIN(TXNDATUTC) TXNDAT,
								  MAX(TXNDAT) LOCDAT   ,
								  TXNPRT               ,
								  SERNUM               ,
								  SHPPFX               ,
								  ''
								   FROM
								  (SELECT INNERBKD.CMPCOD,
								    INNERBKD.DOCOWRIDR   ,
								    INNERBKD.MSTDOCNUM   ,
								    INNERBKD.DUPNUM      ,
								    INNERBKD.SEQNUM      ,
								    INNERBKD.ORGCOD      ,
								    INNERBKD.DSTCOD      ,
								    INNERBKD.STDPCS      ,
								    INNERBKD.STDWGT      ,
								    INNERBKD.STDWGTCOD   ,
								    INNERBKD.SHPDES      ,
								    INNERBKD.SCCCOD      ,
								    INNERBKD.SHPNAM      ,
								    INNERBKD.CNSNAM      ,
								    INNERBKD.ARPCOD      ,
								    INNERBKD.TXNCOD      ,
								    INNERBKD.TXNDES      ,
								    INNERBKD.TXNPCS      ,
								    INNERBKD.TXNWGT      ,
									INNERBKD.TXNVOL      ,
								    INNERBKD.TXNDATUTC   ,
								    INNERBKD.TXNDAT      ,
								    INNERBKD.TXNPRT      ,
								    INNERBKD.SERNUM      ,
								    INNERBKD.SHPPFX      ,
								    INNERBKD.TXNREFEIN
								     FROM
								    (SELECT HIS.CMPCOD,
								      HIS.DOCOWRIDR   ,
								      HIS.MSTDOCNUM   ,
								      HIS.DUPNUM      ,
								      HIS.SEQNUM      ,
								      MST.ORGCOD      ,
								      MST.DSTCOD      ,
								      MST.STDPCS      ,
								      MST.STDWGT      ,
								      MST.STDWGTCOD   ,
								      MST.SHPDES      ,
								      MST.SCCCOD      ,
								      MST.SHPNAM      ,
								      MST.CNSNAM      ,
								      HIS.ARPCOD      ,
								      HIS.TXNCOD      ,
								      HIS.TXNDES      ,
								      CASE
								        WHEN HIS.TXNREFNIN IN ('Q','X')
								        THEN 0
								        ELSE HIS.TXNPCS
								      END TXNPCS,
								      CASE
								        WHEN HIS.TXNREFNIN IN ('Q','X')
								        THEN 0
								        ELSE HIS.TXNWGT
								      END TXNWGT    ,
									   CASE
								        WHEN HIS.TXNREFNIN IN ('Q','X')
								        THEN 0
								        ELSE HIS.TXNVOL
								      END TXNVOL    ,
								      HIS.TXNDATUTC ,
								      HIS.TXNDAT    ,
								      TXNPRT.TXNPRT ,
								      HIS.SERNUM    ,
								      MST.SHPPFX    ,
								      HIS.TXNREFEIN ,
								      MAX(SERNUM) OVER (PARTITION BY HIS.CMPCOD, HIS.DOCOWRIDR, HIS.MSTDOCNUM, HIS.DUPNUM, HIS.SEQNUM) MAXSERNUM
								       FROM OPRSHPMST MST
								    INNER JOIN OPRSHPHIS HIS
								         ON MST.CMPCOD = HIS.CMPCOD
								    AND MST.DOCOWRIDR  = HIS.DOCOWRIDR
								    AND MST.MSTDOCNUM  = HIS.MSTDOCNUM
								    AND MST.DUPNUM     = HIS.DUPNUM
								    AND MST.SEQNUM     = HIS.SEQNUM
								    INNER JOIN OPRTXNPRT TXNPRT
								         ON HIS.TXNCOD = TXNPRT.TXNCOD
    AND HIS.CMPCOD     = TXNPRT.CMPCOD

			]]>
		</QRY:Source>
	</QRY:Definition>
	
	<QRY:Definition>
		<QRY:Id>287</QRY:Id>
		<QRY:Source Name="operations.shipment.findacceptancedetailsforenquirytwo" Type="NATIVE">
		<![CDATA[
		
		SELECT ACPULDDTL.CMPCOD, ACPULDDTL.ULDNUM, ACPULDDTL.WHSCOD, ACPULDDTL.LOCCOD,
		       ACPULDDTL.ACPPCS, ACPULDDTL.ULDDISWGT ACPWGT, ACPULDDTL.ULDNUM CTOSTUCOD, ACPULDDTL.ARPCOD, 
	               ARPSHP.ACPPCS TOTACPPCS, ARPSHP.ACPWGT TOTACPWGT
		  FROM OPRULDACPDTL ACPULDDTL, OPRSHPDTL DTL, OPRARPSHP ARPSHP
		 WHERE DTL.CMPCOD = ACPULDDTL.CMPCOD
		   AND DTL.DOCOWRIDR = ACPULDDTL.DOCOWRIDR
		   AND DTL.MSTDOCNUM = ACPULDDTL.MSTDOCNUM
		   AND DTL.DUPNUM = ACPULDDTL.DUPNUM
		   AND DTL.SEQNUM = ACPULDDTL.SEQNUM
		   AND ACPULDDTL.CMPCOD = ARPSHP.CMPCOD
		   AND ACPULDDTL.ARPCOD = ARPSHP.ARPCOD
		   AND ACPULDDTL.DOCOWRIDR = ARPSHP.DOCOWRIDR
		   AND ACPULDDTL.MSTDOCNUM = ARPSHP.MSTDOCNUM
		   AND ACPULDDTL.DUPNUM = ARPSHP.DUPNUM
  		   AND ACPULDDTL.SEQNUM = ARPSHP.SEQNUM
		   AND DTL.CMPCOD = ?	   
		   AND DTL.DOCOWRIDR = ?
		   AND DTL.MSTDOCNUM = ?
		   AND DTL.DUPNUM = ?
		   AND DTL.SEQNUM = ?
		]]>
		</QRY:Source>
	</QRY:Definition>
		<QRY:Definition>
		<QRY:Id>298</QRY:Id>
		<QRY:Source Name="operations.shipment.findConsignmentAMSShipmentDetails" Type="NATIVE">
			<![CDATA[
				SELECT DISTINCT
					SEGSHP.CMPCOD,  SEGSHP.FLTCARIDR,
					SEGSHP.FLTNUM, SEGSHP.FLTSEQNUM, SEGSHP.SEGSERNUM,
					OPRMST.FLTDAT AS FLTDAT, OPRMST.FLTROU,
					ARLMST.TWOAPHCOD, ARLMST.THRAPHCOD, ARLMST.APHCODUSE,
					SEGSHP.MFTPCS, SEGSHP.MFTWGT, SHPMST.SHPPFX, SHPMST.ORGCOD, SHPMST.DSTCOD,SEGSHP.SLCPCS
					FROM CSTSEGSHP SEGSHP INNER JOIN FLTOPRMST OPRMST ON
							SEGSHP.CMPCOD = OPRMST.CMPCOD
						AND SEGSHP.FLTCARIDR = OPRMST.FLTCARIDR
						AND SEGSHP.FLTNUM = OPRMST.FLTNUM
						AND SEGSHP.FLTSEQNUM = OPRMST.FLTSEQNUM
					  INNER JOIN OPRSHPMST SHPMST ON
							SEGSHP.CMPCOD = SHPMST.CMPCOD
						AND SEGSHP.DOCOWRIDR = SHPMST.DOCOWRIDR
						AND SEGSHP.MSTDOCNUM = SHPMST.MSTDOCNUM
						AND SEGSHP.DUPNUM = SHPMST.DUPNUM
						AND SEGSHP.SEQNUM = SHPMST.SEQNUM
					  INNER JOIN SHRARLMST ARLMST ON
						SEGSHP.CMPCOD = ARLMST.CMPCOD
						AND SEGSHP.FLTCARIDR = ARLMST.ARLIDR
					  WHERE SEGSHP.CMPCOD =?
						AND SEGSHP.DOCOWRIDR = ?
						AND SEGSHP.MSTDOCNUM = ?
						AND SEGSHP.DUPNUM = ?
						AND SEGSHP.SEQNUM = ?

				]]>
		</QRY:Source>
		</QRY:Definition>
		<QRY:Definition>
		<QRY:Id>300</QRY:Id>
		<QRY:Source Name="operations.shipment.findConsignmentAMSHouseTransferDetails" Type="NATIVE">
			<![CDATA[
					SELECT DISTINCT  TXNHSE.CMPCOD,
					  TXNHSE.TXNREFONE,
					  TXNHSE.TXNREFTWO,
					  TXNHSE.TXNREFTHR,
					  TXNHSE.DOCOWRIDR,
					  TXNHSE.MSTDOCNUM,
					  TXNHSE.DUPNUM,
					  TXNHSE.SEQNUM,
					  TXNHSE.DOCNUM,
					  TXNHSE.TXNREFTWO || '~' || TXNHSE.TXNREFTHR || '~' || TXNHSE.TXNREFFIV AS FLTREFIDN,
					  SHPAMS.DMSINTIDR,
					  SHPAMS.PERPCDARP,
					  SHPAMS.FRMCOD,
					  SHPAMS.INBTRFREFNUM,
					  SHPAMS.BNDPRMIDR,
					  
					  SHPAMS.BNDCARIDR,
					  SHPAMS.ONWCAR,
					  SHPAMS.DATARRPERPCDARP,
					  SHPAMS.DSTARP,
					  SHPAMS.AMDCOD,
					  SHPAMS.AMDRMK,
					  SHPAMS.FDA,
					  COALESCE(SHPAMS.PRTINDREF,   AMSSHP.PRTINDREF,   -1) PRTINDREF
					FROM OPRTXNHSE TXNHSE
					INNER JOIN FLTOPRMST OPRMST ON TXNHSE.CMPCOD = OPRMST.CMPCOD
					 AND TXNHSE.TXNREFTWO = OPRMST.FLTCARIDR
					 AND TXNHSE.TXNREFTHR = OPRMST.FLTNUM
					 AND TXNHSE.TXNREFFIV = OPRMST.FLTSEQNUM
					INNER JOIN FLTOPRSEG FLTSEG ON FLTSEG.CMPCOD = OPRMST.CMPCOD
					 AND FLTSEG.FLTCARIDR = OPRMST.FLTCARIDR
					 AND FLTSEG.FLTNUM = OPRMST.FLTNUM
					 AND FLTSEG.FLTSEQNUM = OPRMST.FLTSEQNUM
					INNER JOIN OPRSHPMST SHPMST ON TXNHSE.CMPCOD = SHPMST.CMPCOD
					 AND TXNHSE.DOCOWRIDR = SHPMST.DOCOWRIDR
					 AND TXNHSE.MSTDOCNUM = SHPMST.MSTDOCNUM
					 AND TXNHSE.DUPNUM = SHPMST.DUPNUM
					 AND TXNHSE.SEQNUM = SHPMST.SEQNUM
					LEFT OUTER JOIN OPRSHPAMSDTL SHPAMS ON SHPMST.CMPCOD = SHPAMS.CMPCOD
					 AND SHPMST.DOCOWRIDR = SHPAMS.DOCOWRIDR
					 AND SHPMST.MSTDOCNUM = SHPAMS.MSTDOCNUM
					 AND SHPMST.DUPNUM = SHPAMS.DUPNUM
					 AND SHPMST.SEQNUM = SHPAMS.SEQNUM
					 AND OPRMST.FLTCARIDR = SHPAMS.FLTCARIDR
					 AND OPRMST.FLTNUM = SHPAMS.FLTNUM
					 AND OPRMST.FLTSEQNUM = SHPAMS.FLTSEQNUM LEFT
					OUTER JOIN CSTARPSHP CSTSHP ON SHPMST.CMPCOD = CSTSHP.CMPCOD
					 AND SHPMST.DOCOWRIDR = CSTSHP.DOCOWRIDR
					 AND SHPMST.MSTDOCNUM = CSTSHP.MSTDOCNUM
					 AND SHPMST.DUPNUM = CSTSHP.DUPNUM
					 AND SHPMST.SEQNUM = CSTSHP.SEQNUM LEFT
					OUTER JOIN CSTAMSARPSHP AMSSHP ON CSTSHP.CMPCOD = AMSSHP.CMPCOD
					 AND CSTSHP.DOCOWRIDR = AMSSHP.DOCOWRIDR
					 AND CSTSHP.MSTDOCNUM = AMSSHP.MSTDOCNUM
					 AND CSTSHP.DUPNUM = AMSSHP.DUPNUM
					 AND CSTSHP.SEQNUM = AMSSHP.SEQNUM
					 AND CSTSHP.ARPCOD = AMSSHP.ARPCOD
					 AND CSTSHP.PRTNUM = AMSSHP.PRTNUM
					 AND OPRMST.FLTCARIDR || '~' || OPRMST.FLTNUM || '~' || OPRMST.FLTSEQNUM = CSTSHP.FLTREFIDN
					WHERE TXNHSE.CMPCOD = ?
					 AND TXNHSE.TXNREFTWO = ?
					 AND TXNHSE.TXNREFTHR = ?
					 AND TXNHSE.TXNREFFIV = ?
					 AND TXNHSE.DOCOWRIDR = ?
					 AND TXNHSE.DUPNUM = ?
					 AND TXNHSE.SEQNUM = ?
					 AND TXNHSE.MSTDOCNUM = ?
					 AND COALESCE(SHPAMS.PRTINDREF,   AMSSHP.PRTINDREF,   -1) > -1
					]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>301</QRY:Id>
		<QRY:Source Name="operations.shipment.findConsignmentAMSTransferDetails_1" Type="NATIVE">
		<![CDATA[

SELECT DISTINCT SEGSHP.CMPCOD,
  SEGSHP.FLTCARIDR           ,
  SEGSHP.FLTNUM              ,
  SEGSHP.FLTSEQNUM           ,
  SEGSHP.DOCOWRIDR           ,
  SHPMST.MSTDOCNUM           ,
  SHPMST.DUPNUM              ,
  SHPMST.SEQNUM              ,
  SHPMST.DOCNUM              ,
  OPRMST.FLTCARIDR
  || '~'
  || OPRMST.FLTNUM
  || '~'
  || OPRMST.FLTSEQNUM AS FLTREFIDN,
  SHPAMS.DMSINTIDR                ,
  SHPAMS.PERPCDARP                ,
  SHPAMS.FRMCOD                   ,
  SHPAMS.INBTRFREFNUM             ,
  SHPAMS.BNDPRMIDR                ,
  
  SHPAMS.BNDCARIDR                ,
  SHPAMS.ONWCAR                   ,
  SHPAMS.DATARRPERPCDARP          ,
  SHPAMS.DSTARP                   ,
  SHPAMS.AMDCOD                   ,
  SHPAMS.AMDRMK                   ,
  SHPAMS.FDA                      ,
  COALESCE(SHPAMS.PRTINDREF, AMSSHP.PRTINDREF, -1) PRTINDREF
   FROM CSTSEGSHP SEGSHP
INNER JOIN FLTOPRMST OPRMST
     ON SEGSHP.CMPCOD = OPRMST.CMPCOD
AND SEGSHP.FLTCARIDR  = OPRMST.FLTCARIDR
AND SEGSHP.FLTNUM     = OPRMST.FLTNUM
AND SEGSHP.FLTSEQNUM  = OPRMST.FLTSEQNUM
INNER JOIN FLTOPRSEG FLTSEG
     ON FLTSEG.CMPCOD = OPRMST.CMPCOD
AND FLTSEG.FLTCARIDR  = OPRMST.FLTCARIDR
AND FLTSEG.FLTNUM     = OPRMST.FLTNUM
AND FLTSEG.FLTSEQNUM  = OPRMST.FLTSEQNUM
INNER JOIN OPRSHPMST SHPMST
     ON SEGSHP.CMPCOD = SHPMST.CMPCOD
AND SEGSHP.DOCOWRIDR  = SHPMST.DOCOWRIDR
AND SEGSHP.MSTDOCNUM  = SHPMST.MSTDOCNUM
AND SEGSHP.DUPNUM     = SHPMST.DUPNUM
AND SEGSHP.SEQNUM     = SHPMST.SEQNUM

LEFT OUTER JOIN OPRSHPAMSDTL SHPAMS
     ON SHPMST.CMPCOD = SHPAMS.CMPCOD
AND SHPMST.DOCOWRIDR  = SHPAMS.DOCOWRIDR
AND SHPMST.MSTDOCNUM  = SHPAMS.MSTDOCNUM
AND SHPMST.DUPNUM     = SHPAMS.DUPNUM
AND SHPMST.SEQNUM     = SHPAMS.SEQNUM
AND OPRMST.FLTCARIDR  = SHPAMS.FLTCARIDR
AND OPRMST.FLTNUM     = SHPAMS.FLTNUM
AND OPRMST.FLTSEQNUM  = SHPAMS.FLTSEQNUM
LEFT OUTER JOIN CSTARPSHP CSTSHP
     ON SHPMST.CMPCOD = CSTSHP.CMPCOD
AND SHPMST.DOCOWRIDR  = CSTSHP.DOCOWRIDR
AND SHPMST.MSTDOCNUM  = CSTSHP.MSTDOCNUM
AND SHPMST.DUPNUM     = CSTSHP.DUPNUM
AND SHPMST.SEQNUM     = CSTSHP.SEQNUM
LEFT OUTER JOIN CSTAMSARPSHP AMSSHP
     ON CSTSHP.CMPCOD = AMSSHP.CMPCOD
AND CSTSHP.DOCOWRIDR  = AMSSHP.DOCOWRIDR
AND CSTSHP.MSTDOCNUM  = AMSSHP.MSTDOCNUM
AND CSTSHP.DUPNUM     = AMSSHP.DUPNUM
AND CSTSHP.SEQNUM     = AMSSHP.SEQNUM
AND CSTSHP.ARPCOD     = AMSSHP.ARPCOD
AND CSTSHP.PRTNUM     = AMSSHP.PRTNUM
AND OPRMST.FLTCARIDR
  || '~'
  || OPRMST.FLTNUM
  || '~'
  || OPRMST.FLTSEQNUM                                = CSTSHP.FLTREFIDN
  WHERE SEGSHP.CMPCOD                                = ?
AND SEGSHP.FLTCARIDR                                 = ?
AND SEGSHP.FLTNUM                                    = ?
AND SEGSHP.FLTSEQNUM                                 = ?
AND SEGSHP.DOCOWRIDR                                 = ?
AND SEGSHP.DUPNUM                                    = ?
AND SEGSHP.SEQNUM                                    = ?
AND SEGSHP.MSTDOCNUM                                 = ?
AND COALESCE(SHPAMS.PRTINDREF, AMSSHP.PRTINDREF, -1) > -1

]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>302</QRY:Id>
		<QRY:Source Name="operations.shipment.findshipmentaudithistorydetails" Type="NATIVE">
			<![CDATA[
				SELECT SHPAUD.CMPCOD,
				SHPAUD.STNCOD,
        SHPAUD.UPDTXNTIMUTC,
        SHPAUD.ADLINF,
        SHPAUD.SERNUM,
		SHPAUD.DOCNUM,
         HIS.HISSEQNUM,
  CASE
    WHEN CFG.TXNCOD IS NOT NULL
    THEN CFG.TXNCODDES
    ELSE SHPAUD.ACTCOD
  END ACTCOD ,HIS.HISFLDNAM,HIS.HISFLDOLDVAL,HIS.HISFLDNEWVAL,
  SHPAUD.UPDTXNTIM,
  SHPAUD.UPDUSR
FROM OPRSHPAUD SHPAUD ,
  SHRAUDTXNCFG CFG , OPRSHPAUDHIS HIS
WHERE  SHPAUD.CMPCOD    = CFG.CMPCOD
AND SHPAUD.ACTCOD    = CFG.TXNCOD
AND SHPAUD.CMPCOD = HIS.CMPCOD
AND SHPAUD.DOCOWRIDR = HIS.DOCOWRIDR
AND SHPAUD.DUPNUM = HIS.DUPNUM
AND SHPAUD.SEQNUM = HIS.SEQNUM
AND SHPAUD.MSTDOCNUM = HIS.MSTDOCNUM
AND SHPAUD.SERNUM = HIS.SERNUM
AND SHPAUD.CMPCOD  = ?
AND SHPAUD.MSTDOCNUM = ?

				]]>
		</QRY:Source>
		</QRY:Definition>	
<QRY:Definition>
		<QRY:Id>303</QRY:Id>
		<QRY:Source Name="operations.shipment.findshipmentdetailsforaudit" Type="NATIVE">
			<![CDATA[
		SELECT MST.AGTCOD,MST.ORGCOD,MST.DSTCOD,MST.STDPCS,MST.STDWGT,MST.EXEDAT,MST.SHPSTA, RTG.SHPRTG
FROM OPRSHPMST MST, 
(SELECT MSTDOCNUM  ,
			DOCOWRIDR        ,
			DUPNUM           ,
			SEQNUM           ,
			CMPCOD           ,
                        RTGSERNUM,
                        LTRIM( SYS_CONNECT_BY_PATH(  SHPRTG, ',' ), ',' ) SHPRTG
                        from
(SELECT mstdocnum,
  docowridr,
  dupnum,
  seqnum,
  dstcod || '(' || fltcarcod || ')' SHPRTG,
  RTGSERNUM,
  cmpcod,
   row_number() over(PARTITION BY mstdocnum,   docowridr,   dupnum,   seqnum,   cmpcod
ORDER BY  RTGSERNUM) rnm
FROM oprshprtg rtg)
WHERE CONNECT_BY_ISLEAF = 1 CONNECT BY PRIOR MSTDOCNUM = MSTDOCNUM
			  AND PRIOR DOCOWRIDR       = DOCOWRIDR
			  AND PRIOR DUPNUM          = DUPNUM
			  AND PRIOR SEQNUM          = SEQNUM
			  AND PRIOR CMPCOD          = CMPCOD
			  AND PRIOR RNM             = RNM - 1 START
			  WITH RNM                  = 1) RTG
WHERE MST.CMPCOD = RTG.CMPCOD(+)
AND MST.MSTDOCNUM = RTG.MSTDOCNUM(+)
AND MST.DOCOWRIDR = RTG.DOCOWRIDR(+)
AND MST.DUPNUM = RTG.DUPNUM(+)
AND MST.SEQNUM = RTG.SEQNUM(+)
AND MST.MSTDOCNUM = ?
AND MST.CMPCOD = ?


				]]>
		</QRY:Source>
		</QRY:Definition>	
		<QRY:Definition>
		<QRY:Id>303</QRY:Id>
		<QRY:Source Name="operations.shipment.findaudittransactioncodes" Type="NATIVE">
			<![CDATA[
		SELECT CFG.TXNCOD,CFG.TXNCODDES
FROM SHRAUDTXNCFG CFG
WHERE CFG.CMPCOD = ?
				]]>
		</QRY:Source>
		</QRY:Definition>	
	<QRY:Definition>
	 <QRY:Id>304</QRY:Id>
	 <QRY:Source Name="operations.shipment.cto.findfsutgcdetails" Type="NATIVE">
		<![CDATA[
	SELECT MST.DOMFLG,MST.MSTDOCNUM, MST.DOCOWRIDR, MST.DUPNUM, MST.SEQNUM, MST.CMPCOD, MST.SHPPFX, MST.STDPCS, MST.STDWGT,
	       MST.ORGCOD, MST.DSTCOD, MST.AGTCOD, AGTGRP.GRPNAM AGTGRP, MST.SHPCOD,MST.CNSCOD,SHPCUSMST.CUSGRP SHPGRP,CNSCUSMST.CUSGRP CNSGRP,
               ABNSHP.ABNPCS,  ABNSHP.ABNWGT, ABNSHP.ABNTIM, 
	      	SYS.PARVAL WGTCOD, MST.OWRCOD, MIS.STACOD, MIS.MSGSEQNUM,MIS.MSGTYP,MIS.JNVPAR,SHPRTG.DSTCOD RTGCNT,SHRMST.CNTCOD
			FROM OPRSHPMST MST, WHSABNSHPHIS ABNSHP, SHRSYSPAR SYS, OPRSHPMSTMIS MIS, SHRCUSMST SHPCUSMST,SHRCUSMST CNSCUSMST,
	       SHRGENMSTGRPDTL AGTGRP, OPRSHPRTG SHPRTG,SHRARPMST SHRMST
	 WHERE MST.MSTDOCNUM = ABNSHP.MSTDOCNUM
	   AND MST.DOCOWRIDR = ABNSHP.DOCOWRIDR
	   AND MST.DUPNUM = ABNSHP.DUPNUM
	   AND MST.SEQNUM = ABNSHP.SEQNUM
	   AND MST.CMPCOD = ABNSHP.CMPCOD
	   AND MST.MSTDOCNUM (+)= MIS.MSTDOCNUM
       AND MST.DOCOWRIDR (+)= MIS.DOCOWRIDR
       AND MST.DUPNUM (+)= MIS.DUPNUM
       AND MST.SEQNUM (+)= MIS.SEQNUM
       AND MST.CMPCOD (+)= MIS.CMPCOD
	   AND MST.CMPCOD = SYS.CMPCOD
	   AND MST.CMPCOD = SHPCUSMST.CMPCOD(+)
	   AND MST.SHPCOD = SHPCUSMST.CUSCOD(+)
    AND MST.CMPCOD = CNSCUSMST.CMPCOD(+)
	   AND MST.CNSCOD = CNSCUSMST.CUSCOD(+)
	   AND MST.CMPCOD = AGTGRP.CMPCOD(+)
	   AND MST.AGTCOD = AGTGRP.GRPENT(+)
       AND AGTGRP.GRPCATCOD(+) = 'GEN'
	   	AND MST.MSTDOCNUM 		= SHPRTG.MSTDOCNUM(+)
		AND MST.DOCOWRIDR 		= SHPRTG.DOCOWRIDR(+)
		AND MST.DUPNUM 		 	= SHPRTG.DUPNUM(+)
		AND MST.SEQNUM 		 	= SHPRTG.SEQNUM(+)
		AND MST.CMPCOD 		 	= SHPRTG.CMPCOD(+)
		 AND MST.CMPCOD      = SHRMST.CMPCOD(+)
  AND MST.ORGCOD      =  SHRMST.ARPCOD(+)
	   AND MST.MSTDOCNUM = ?
	   AND MST.DOCOWRIDR = ?
	   AND MST.DUPNUM = ?
	   AND MST.SEQNUM = ?
	   AND MST.CMPCOD = ?
           AND ABNSHP.ARPCOD = ?
	   AND SYS.PARCOD = ?
   	]]>
	</QRY:Source>
	</QRY:Definition>	
<QRY:Definition>
    <QRY:Id>253</QRY:Id>
    <QRY:Source Name="operations.shipment.findHandlingInstructionDetailsForEnquiry" Type="NATIVE">
      <![CDATA[
        SELECT HND.ARPCOD,
     HND.CMPCOD,
     HND.DOCOWRIDR,
     HND.MSTDOCNUM,
     HND.SEQNUM,
     HND.DUPNUM,
     HND.FLTCARCOD,
     HND.FLTNUM,
     HND.FLTDAT,
     HND.FLTCARIDR,
     HND.FLTSEQNUM,
     HND.PERCHG,
     HND.PERCHGPHN,
     HND.LSTUPDTIM,
     HND.AWBLSTSRC,
     HND.COLAGY,
     HND.AWBCOLCMP,
     HND.HNDINSSERNUM,
     HND.GENRMK,
     HND.HHTRMK,
     HND.SHPURG,
     HND.SHPRMK,
     HND.ULDRMK,
     HND.WRNRMK,
     RMK.SHPWRN,
     STGDTL.ARPCOD ARACOD,
     STGDTL.PCS ARAPCS,
     STGDTL.STGRMK,
     MST.DOCNUM,
     MST.SHPCOD,
     MST.ORGCOD,
     MST.DSTCOD,
     MST.AGTCOD,
     MST.STDWGTCOD,
     MST.SHPPFX,
     MST.DTACPTFLG,
	 MST.STDPCS,
	 MST.STDWGT,
     DENSE_RANK() OVER(
   ORDER BY HND.LSTUPDTIM DESC,    HND.MSTDOCNUM,    HND.DOCOWRIDR,    HND.SEQNUM,    HND.DUPNUM,    HND.HNDINSSERNUM,    HND.ARPCOD,    HND.CMPCOD) AS
  RANK
   FROM OPRSHPHNDINS HND,
        OPRSHPMST MST, OPRARPSHP ARPSHP,
        OPRSHPHNDRMK RMK,
        OPRSHPHNDSTGDTL STGDTL
  WHERE MST.CMPCOD = ARPSHP.CMPCOD
   AND MST.DOCOWRIDR = ARPSHP.DOCOWRIDR
   AND MST.MSTDOCNUM = ARPSHP.MSTDOCNUM
   AND MST.DUPNUM = ARPSHP.DUPNUM
   AND MST.SEQNUM = ARPSHP.SEQNUM
   AND ARPSHP.CMPCOD = HND.CMPCOD
   AND ARPSHP.ARPCOD = HND.ARPCOD
   AND ARPSHP.DOCOWRIDR = HND.DOCOWRIDR
   AND ARPSHP.MSTDOCNUM = HND.MSTDOCNUM
   AND ARPSHP.DUPNUM = HND.DUPNUM
   AND ARPSHP.SEQNUM = HND.SEQNUM
    AND HND.CMPCOD = RMK.CMPCOD(+)
	AND HND.ARPCOD = RMK.ARPCOD(+)
   AND HND.DOCOWRIDR = RMK.DOCOWRIDR(+)
   AND  HND.MSTDOCNUM = RMK.MSTDOCNUM(+)
   AND  HND.DUPNUM = RMK.DUPNUM(+)
   AND HND.SEQNUM = RMK.SEQNUM(+) 
   AND HND.HNDINSSERNUM = RMK.HNDINSSERNUM(+)
   AND HND.CMPCOD = STGDTL.CMPCOD(+)   
   AND HND.ARPCOD = STGDTL.ARPCOD(+)
   AND HND.DOCOWRIDR = STGDTL.DOCOWRIDR(+)
   AND  HND.MSTDOCNUM = STGDTL.MSTDOCNUM(+)
   AND  HND.DUPNUM = STGDTL.DUPNUM(+)
   AND HND.SEQNUM = STGDTL.SEQNUM(+)
   AND HND.HNDINSSERNUM = STGDTL.HNDINSSERNUM(+)
      ]]>
    </QRY:Source>
  </QRY:Definition>
  <QRY:Definition>
  <QRY:Id>252</QRY:Id>
  <QRY:Source Name="operations.shipment.findhandlinginstructions" Type="NATIVE">
    <![CDATA[
	SELECT MST.MSTDOCNUM,
		  MST.SHPPFX,
		  MST.CMPCOD,
		  MST.SEQNUM,
		  MST.DUPNUM,
		  MST.PARSEQNUM,
		  MST.STDPCS,MST.STDWGT,MST.SCCCOD,MST.SHPDES HNDINSSHPDES,
		  HNDINS.FLTCARCOD,
		  HNDINS.FLTNUM,
		  HNDINS.FLTDAT,
		  HNDINS.FLTSEQNUM,
		  HNDINS.FLTCARIDR,
		  HNDINS.ARPCOD,
		  HNDINS.AWBCOLCMP,
		  HNDINS.AWBLSTSRC,
		  HNDINS.PERCHG,
		  MST.CNSNAM,
		  HNDINS.CRTDAT,
		  HNDINS.GENRMK,
		  HNDINS.HHTRMK,
		  HNDINS.LSTUPDTIM,
		  HNDINS.LSTUPDUSR,
		  HNDINS.MSTDOCNUM HNDINSMSTDOCNUM,
		  HNDINS.PERCHGPHN,
		  HNDINS.SHPRMK,
		  HNDINS.SHPURG,
		  HNDINS.ULDRMK,
		  HNDINS.ULDURG,
		  HNDINS.WRNRMK,
		  HNDINS.HNDINSSERNUM,
		  STGDTL.STGARACOD,
		  STGDTL.PCS ARAPCS,
		  STGDTL.STGSRC,
		  STGDTL.STGRMK,
		  STGDTL.SCCCOD STGSCCCOD,
		  HNDHIS.SHPDAT,
		  HNDHIS.SHPSRC,
		  HNDHIS.SERNUM HISSERNUM,
		  HNDINS.CONBDNFLG,
		  SHPRMK.SHPWRN,
		  SHPRMK.SERNUM RMKSERNUM,
		  STGDTL.CRTDAT ARASHPCRTDAT
	FROM OPRSHPMST MST,
		  OPRSHPMSTMIS MSTMIS,
		  OPRSHPHNDINS HNDINS,
		  OPRSHPHNDSTGDTL STGDTL,
		  OPRSHPHNDHIS HNDHIS,
		  OPRSHPHNDRMK SHPRMK
	WHERE MST.CMPCOD = HNDINS.CMPCOD(+)
		 AND MST.SEQNUM = HNDINS.SEQNUM(+)
		 AND MST.DUPNUM = HNDINS.DUPNUM(+)
		 AND MST.MSTDOCNUM = HNDINS.MSTDOCNUM(+)
		 AND MST.DOCOWRIDR = HNDINS.DOCOWRIDR(+)
		 AND MST.CMPCOD = MSTMIS.CMPCOD(+)
		 AND MST.SEQNUM = MSTMIS.SEQNUM(+)
		 AND MST.DUPNUM = MSTMIS.DUPNUM(+)
		 AND MST.MSTDOCNUM = MSTMIS.MSTDOCNUM(+)
		 AND MST.DOCOWRIDR = MSTMIS.DOCOWRIDR(+)
		AND HNDINS.cmpcod = STGDTL.cmpcod(+)
		 AND HNDINS.ARPCOD = STGDTL.ARPCOD(+)
		 AND HNDINS.seqnum = STGDTL.seqnum(+)
		 AND HNDINS.dupnum = STGDTL.dupnum(+)
		 AND HNDINS.mstdocnum = STGDTL.mstdocnum(+)
		 AND HNDINS.docowridr = STGDTL.docowridr(+)
		 AND HNDINS.hndinssernum = STGDTL.hndinssernum(+)
		 AND HNDINS.CMPCOD = HNDHIS.CMPCOD(+)
		 AND HNDINS.ARPCOD = hndhis.ARPCOD(+)
		 AND HNDINS.SEQNUM = HNDHIS.SEQNUM(+)
		 AND HNDINS.DUPNUM = HNDHIS.DUPNUM(+)
		 AND HNDINS.MSTDOCNUM = HNDHIS.MSTDOCNUM(+)
		 AND HNDINS.DOCOWRIDR = HNDHIS.DOCOWRIDR(+)
		 AND HNDINS.HNDINSSERNUM = HNDHIS.HNDINSSERNUM(+)
		 AND HNDINS.CMPCOD = SHPRMK.CMPCOD(+)
		 AND HNDINS.ARPCOD = shprmk.ARPCOD(+)
		 AND HNDINS.SEQNUM = SHPRMK.SEQNUM(+)
		 AND HNDINS.DUPNUM = SHPRMK.DUPNUM(+)
		 AND HNDINS.MSTDOCNUM = SHPRMK.MSTDOCNUM(+)
		 AND HNDINS.DOCOWRIDR = SHPRMK.DOCOWRIDR(+)
		 AND HNDINS.HNDINSSERNUM = SHPRMK.HNDINSSERNUM(+)
         AND MST.CMPCOD = ?
         AND MST.DUPNUM = ?
         AND MST.MSTDOCNUM = ?
         AND MST.DOCOWRIDR = ?
  ]]>
  </QRY:Source>
  </QRY:Definition>
  
  <QRY:Definition>
	<QRY:Id>285</QRY:Id>
	<QRY:Source Name="operations.shipment.findshipmentsforhawb" Type="NATIVE">
	  <![CDATA[
	     SELECT MST.DOCOWRIDR,MST.DUPNUM ,MST.SEQNUM,MST.CMPCOD,
	        IDX.SHPPFX,MST.MSTDOCNUM,MST.DOCTYP,MST.DOCNUM,
	        MST.CPTDAT,MST.CNSCOD,MST.STDDISWGT,MST.SHPSTA,MST.UBRNUM,MST.SHPTYP,MST.CONFLG,IDX.OWRCOD,MST.PARSEQNUM,
	        MST.LSTUPDUSR, MST.LSTUPDTIM,MSTDUP.ORGCOD,MSTDUP.DSTCOD
	        FROM OPRSHPIDX IDX,OPRSHPMST  MST,OPRSHPMST MSTDUP
	        WHERE
	        MST.DOCOWRIDR=IDX.DOCOWRIDR AND
	        MST.CMPCOD=IDX.CMPCOD AND
	        MST.DUPNUM=IDX.DUPNUM AND
	        MST.MSTDOCNUM=IDX.MSTDOCNUM AND
	        MSTDUP.DOCNUM = MST.MSTDOCNUM AND
	        MSTDUP.DUPNUM = MST.DUPNUM AND
	        MSTDUP.DOCOWRIDR=MST.DOCOWRIDR AND
	        MSTDUP.CMPCOD=MST.CMPCOD AND
	    	MSTDUP.PARSEQNUM=0 AND
	    	MST.CMPCOD=? AND
	   	MST.DOCNUM=?
	  ]]>
	</QRY:Source>
	</QRY:Definition>
	
	<QRY:Definition>
    <QRY:Id>253</QRY:Id>
    <QRY:Source Name="operations.shipment.findHandlingInstructionDetails" Type="NATIVE">
      <![CDATA[     	
	   SELECT HND.ARPCOD, HND.CMPCOD, HND.DOCOWRIDR, HND.MSTDOCNUM, HND.SEQNUM, HND.DUPNUM, HND.FLTCARCOD,
       HND.FLTNUM, HND.FLTDAT, HND.FLTCARIDR, HND.FLTSEQNUM, HND.PERCHG, HND.PERCHGPHN, HND.LSTUPDTIM,
       HND.AWBLSTSRC, HND.COLAGY, HND.AWBCOLCMP, HND.HNDINSSERNUM, HND.GENRMK, HND.HHTRMK, HND.SHPURG,
       HND.SHPRMK, HND.ULDRMK, HND.WRNRMK, RMK.SHPWRN,  RMK.SERNUM RMKSERNUM,  STGDTL.STGARACOD, STGDTL.PCS ARAPCS, STGDTL.STGRMK,STGDTL.SCCCOD STGSCCCOD,STGDTL.STGSRC,
       MST.DOCNUM, MST.SHPCOD, MST.ORGCOD, MST.DSTCOD, MST.AGTCOD, MST.STDWGTCOD, MST.SHPPFX, MST.DTACPTFLG,
	   HNDHIS.SHPDAT,MST.STDPCS ,MST.STDWGT,MST.SHPDES HNDINSSHPDES,
	   HNDHIS.SHPSRC,
	   HNDHIS.SERNUM HISSERNUM,
       MST.SCCCOD, MST.PARSEQNUM
  FROM OPRSHPMST MST,
  OPRSHPMST shpmst,
       OPRARPSHP ARPSHP,
       OPRSHPHNDINS HND,
       OPRSHPHNDRMK RMK,
       OPRSHPHNDSTGDTL STGDTL,
       OPRSHPHNDHIS HNDHIS
 WHERE MST.CMPCOD = ARPSHP.CMPCOD
   AND MST.DOCOWRIDR = ARPSHP.DOCOWRIDR
   AND MST.MSTDOCNUM = ARPSHP.MSTDOCNUM
   AND MST.DUPNUM = ARPSHP.DUPNUM
   AND MST.SEQNUM = ARPSHP.SEQNUM
   AND MST.CMPCOD = shpmst.CMPCOD
   AND MST.DOCOWRIDR = shpmst.DOCOWRIDR
   AND MST.MSTDOCNUM = shpmst.MSTDOCNUM
   AND MST.DUPNUM = shpmst.DUPNUM  
   AND ARPSHP.CMPCOD = HND.CMPCOD
   AND ARPSHP.ARPCOD = HND.ARPCOD
   AND ARPSHP.DOCOWRIDR = HND.DOCOWRIDR
   AND ARPSHP.MSTDOCNUM = HND.MSTDOCNUM
   AND ARPSHP.DUPNUM = HND.DUPNUM
   AND ARPSHP.SEQNUM = HND.SEQNUM
   AND HND.CMPCOD = RMK.CMPCOD(+)
   AND HND.ARPCOD = RMK.ARPCOD(+)
   AND HND.DOCOWRIDR = RMK.DOCOWRIDR(+)
   AND HND.MSTDOCNUM = RMK.MSTDOCNUM(+)
   AND HND.DUPNUM = RMK.DUPNUM(+)
   AND HND.SEQNUM = RMK.SEQNUM(+)
   AND HND.HNDINSSERNUM = RMK.HNDINSSERNUM(+)
   AND HND.CMPCOD = STGDTL.CMPCOD(+)
   AND HND.ARPCOD = STGDTL.ARPCOD(+)
   AND HND.DOCOWRIDR = STGDTL.DOCOWRIDR(+)
   AND HND.MSTDOCNUM = STGDTL.MSTDOCNUM(+)
   AND HND.DUPNUM = STGDTL.DUPNUM(+)
   AND HND.SEQNUM = STGDTL.SEQNUM(+)
   AND HND.HNDINSSERNUM = STGDTL.HNDINSSERNUM(+)
   AND HND.CMPCOD = HNDHIS.CMPCOD(+)
   AND HND.ARPCOD = HNDHIS.ARPCOD(+)
   AND HND.DOCOWRIDR = HNDHIS.DOCOWRIDR(+)
   AND HND.MSTDOCNUM = HNDHIS.MSTDOCNUM(+)
   AND HND.DUPNUM = HNDHIS.DUPNUM(+)
   AND HND.SEQNUM = HNDHIS.SEQNUM(+)
   AND HND.HNDINSSERNUM = HNDHIS.HNDINSSERNUM(+)
   AND hnd.cmpcod = ?
   AND shpmst.parseqnum = 0
        
      ]]>
    
		</QRY:Source>
		</QRY:Definition>
	<QRY:Definition>
    <QRY:Id>254</QRY:Id>
    <QRY:Source Name="operations.shipment.findchecksheetsforawb" Type="NATIVE">
      <![CDATA[  
			SELECT * FROM (SELECT CHKSHTMST.CMPCOD,CHKSHTMST.MSTDOCNUM,CHKSHTMST.DOCOWRIDR,CHKSHTMST.DUPNUM,CHKSHTMST.SEQNUM,CHKSHTMST.TXNCOD,
				  CHKSHTMST.ARPCOD,CHKSHTMST.CFGIDR,CHKSHTMST.TMTIDR,CHKSHTDTL.TMTANS,CHKSHTDTL.TMTSERNUM,CHKSHTMST.CHKSHTVLDFLG
			FROM SHRCHKSHTCFGMST CHKSHTCFG,OPRSHPCHKSHTMST CHKSHTMST
			JOIN OPRSHPCHKSHTDTL CHKSHTDTL
				ON CHKSHTMST.CMPCOD = CHKSHTDTL.CMPCOD
				AND CHKSHTMST.MSTDOCNUM = CHKSHTDTL.MSTDOCNUM
				AND CHKSHTMST.SEQNUM = CHKSHTDTL.SEQNUM
				AND CHKSHTMST.DOCOWRIDR = CHKSHTDTL.DOCOWRIDR
				AND CHKSHTMST.DUPNUM = CHKSHTDTL.DUPNUM
				AND CHKSHTMST.CFGIDR = CHKSHTDTL.CFGIDR
				AND CHKSHTMST.ARPCOD = CHKSHTDTL.ARPCOD
			WHERE CHKSHTMST.CMPCOD = ?
				AND CHKSHTMST.MSTDOCNUM = ?
				AND CHKSHTMST.DOCOWRIDR = ?
				AND CHKSHTMST.DUPNUM = ?
				AND CHKSHTMST.SEQNUM = ?
				AND CHKSHTMST.ARPCOD = ?
				AND CHKSHTCFG.CMPCOD=CHKSHTMST.CMPCOD
			    AND CHKSHTCFG.CFGIDR=CHKSHTMST.CFGIDR


	 ]]>
    
		</QRY:Source>
		</QRY:Definition>		 
	  <QRY:Definition>
<QRY:Id>199</QRY:Id>
	<QRY:Source Name="operations.shipment.findshipmentdetailsforspotraterequest" Type="NATIVE">
		<![CDATA[
		SELECT MST.CMPCOD,
		  MST.MSTDOCNUM,
		  MST.DOCOWRIDR ,
		  MST.SEQNUM ,
		  MST.DUPNUM,
		  MST.SHPPFX ,
		  MST.SHPSTA,
		  MST.PRDCOD,
		  MST.PRDNAM,
		  MST.AGTCOD,
		  MST.ORGCOD,
		  MST.DSTCOD,
		  MST.UBRNUM,
		  RAT.CHGWGT,
		  RAT.CMDITMNAM,
		  RAT.SCCCOD,
		  RAT.RATLINSERNUM,
		  ACC.JRNDAT,
		  CRA.RATSTA,
		  CRA.SPLIND,
			MST.VODFLG,
		  MST.SPTRATIDR,
		  SHP.SPTRATAPLFLG,
		  SHP.SPTRATDTHFLG		
		FROM 
		OPRSHPMST MST 
		LEFT OUTER JOIN  OPRSHPRATDTL RAT
		ON MST.CMPCOD          = RAT.CMPCOD
		AND MST.DOCOWRIDR         = RAT.DOCOWRIDR
		AND MST.MSTDOCNUM         = RAT.MSTDOCNUM
		AND MST.SEQNUM            = RAT.SEQNUM
		AND MST.DUPNUM            = RAT.DUPNUM

		LEFT OUTER JOIN  OPRSHPMSTACC ACC
		ON MST.CMPCOD            = ACC.CMPCOD
		AND MST.MSTDOCNUM         = ACC.MSTDOCNUM
		AND MST.DOCOWRIDR         = ACC.DOCOWRIDR
		AND MST.DUPNUM            = ACC.DUPNUM
		AND MST.SEQNUM            = ACC.SEQNUM

		LEFT OUTER JOIN  CRAAWBDTL CRA
		ON MST.CMPCOD            = CRA.CMPCOD
		AND MST.DOCOWRIDR         = CRA.DOCOWRIDR
		AND MST.MSTDOCNUM         = CRA.MSTDOCNUM
		AND MST.SEQNUM            = CRA.SEQNUM
		AND MST.DUPNUM            = CRA.DUPNUM

		LEFT OUTER JOIN TRFSPTRATSHP SHP
		ON MST.CMPCOD            = SHP.CMPCOD
		AND MST.DOCOWRIDR         = SHP.DOCOWRIDR
		AND MST.MSTDOCNUM         = SHP.MSTDOCNUM
		AND MST.SEQNUM            = SHP.SEQNUM
		AND MST.DUPNUM            = SHP.DUPNUM
		AND NVL(SHP.SPTRATDTHFLG,'Y') <>'D'

		LEFT OUTER JOIN  TRFSPTRATMST SPT
		ON SHP.CMPCOD            = SPT.CMPCOD
		AND SHP.SPTRATIDR         = SPT.SPTRATIDR


		AND SPT.SPTRATSTA NOT IN ('CNL','RJC')
		

		]]>
</QRY:Source>
</QRY:Definition> 
	 <QRY:Definition>
    <QRY:Id>255</QRY:Id>
    <QRY:Source Name="operation.shipment.findCheckSheetDetailsForEnquiry" Type="NATIVE">
      <![CDATA[     	
	   Select 
		Chksht.Cmpcod Cmpcode,
		Chksht.Mstdocnum ,
		Chksht.Docowridr ,
		Chksht.Dupnum ,
		Chksht.Seqnum ,
		Chksht.Cfgidr ,
		Chksht.Arpcod ,
		(SELECT FLDDES from shronetim where fldval=Chksht.Txncod and fldtyp='shared.checksheet.transaction' and CMPCOD=CHKSHT.Cmpcod) TXNCOD,
		Chksht.LSTUPDUSR ,
		CHKSHT.LSTUPDTIM ,
		Chkshtdtl.Tmtans ,
		Tmtdtl.Tmtidr ,
		Tmtdtl.Tmtsernum ,
		Tmtdtl.Dtltxt ,
		Tmtdtl.Appdev ,
		Tmtdtl.Restyp ,
		Tmtdtl.Issman ,
		Tmtdtl.Sernum ,
		TMTDTL.DEPSERNUM 
		From
		OPRSHPCHKSHTMST CHKSHT, OPRSHPCHKSHTDTL CHKSHTDTL, SHRTMTMST TMTMST, SHRTMTDTL TMTDTL
		Where
		CHKSHT.Cmpcod = CHKSHTDTL.Cmpcod
		And CHKSHT.Mstdocnum = CHKSHTDTL.Mstdocnum
		And CHKSHT.Docowridr = CHKSHTDTL.Docowridr
		And CHKSHT.Seqnum = CHKSHTDTL.Seqnum
		And CHKSHT.Dupnum = CHKSHTDTL.Dupnum
		And CHKSHT.Cfgidr = CHKSHTDTL.Cfgidr
		And CHKSHT.Arpcod = CHKSHTDTL.Arpcod
		And TMTMST.Cmpcod = CHKSHT.Cmpcod
		And TMTMST.Tmtidr = CHKSHT.Tmtidr
		And TMTDTL.Cmpcod = CHKSHT.Cmpcod
		And TMTDTL.Tmtidr = CHKSHT.Tmtidr
		And TMTDTL.Tmtsernum = CHKSHTDTL.Tmtsernum
		And CHKSHT.Cmpcod = ?
		And CHKSHT.Mstdocnum = ?
		And CHKSHT.Docowridr = ?
		And CHKSHT.Seqnum = ?
		And CHKSHT.Dupnum = ?
		order by CHKSHT.Arpcod
		


        
      ]]>
    
		</QRY:Source>
		</QRY:Definition>	
		<!-- Code for ICRD-3145 by a-5178 starts-->
		 <QRY:Definition>
    <QRY:Id>256</QRY:Id>
    <QRY:Source Name="operations.shipment.generateDeliveryListReport" Type="NATIVE">
			<![CDATA[
	SELECT DISTINCT MST.MSTDOCNUM ,
  MST.DOCOWRIDR,
  MST.DUPNUM,
  MST.SEQNUM,
  MST.DOCNUM,
  MST.ORGCOD,
  MST.DSTCOD,
  MST.SHPSTA,
  MST.SHPPFX,
  MST.CMPCOD,
  SHP.TOTDLVPCS,
  SHP.TOTDLVWGT,
  SHP.SECCLRSTA,
  SHP.CUSCLRSTA,
  SHP.RCVPCS,
  SHP.RCVWGT,
  SEGSHP.MFTPCS,
  SEG.POL,
  IMPFLT.FLTCARCOD,
  IMPFLT.FLTNUM,
  IMPFLT.FLTDAT,
  SHPDIS.DISCOD,
  MST.CNSNAM,
  DLVDTL.CNSADD,
       PRATDTL. CMDITMNAM
FROM OPRSHPMST MST,
  OPRARPSHP SHP,
  OPRFLTSEG SEG,
  OPRARPIMPFLT IMPFLT,
  OPRSHPDLVNOT DLVNOT,
  OPRSEGSHP SEGSHP,
  OPRULDSHP ULDSHP,
  OPRSHPDIS SHPDIS,
  OPRSHPDLVDTL DLVDTL,
  OPRSHPRATDTL PRATDTL
WHERE MST.MSTDOCNUM     =SHP.MSTDOCNUM(+)
AND MST.DOCOWRIDR       =SHP.DOCOWRIDR(+)
AND MST.DUPNUM          =SHP.DUPNUM(+)
AND MST.SEQNUM          =SHP.SEQNUM(+)
AND MST.CMPCOD          =SHP.CMPCOD(+)
AND SHP.MSTDOCNUM       =ULDSHP.MSTDOCNUM(+)
AND SHP.DOCOWRIDR       =ULDSHP.DOCOWRIDR(+)
AND SHP.DUPNUM          =ULDSHP.DUPNUM(+)
AND SHP.SEQNUM          =ULDSHP.SEQNUM(+)
AND SHP.ARPCOD          =ULDSHP.ARPCOD(+)
AND SHP.CMPCOD          =ULDSHP.CMPCOD(+)
AND SHPDIS.MSTDOCNUM(+) = SHP.MSTDOCNUM
AND SHPDIS.DOCOWRIDR(+) = SHP.DOCOWRIDR
AND SHPDIS.DUPNUM(+)    = SHP.DUPNUM
AND SHPDIS.SEQNUM(+)    = SHP.SEQNUM
AND SHPDIS.ARPCOD(+)    = SHP.ARPCOD
AND SHPDIS.CMPCOD(+)    = SHP.CMPCOD
AND DLVDTL.MSTDOCNUM(+) = SHP.MSTDOCNUM
AND DLVDTL.DOCOWRIDR(+) = SHP.DOCOWRIDR
AND DLVDTL.SEQNUM(+)    = SHP.SEQNUM
AND DLVDTL.DUPNUM(+)    = SHP.DUPNUM
AND DLVDTL.CMPCOD(+)    = SHP.CMPCOD
AND DLVDTL.ARPCOD(+)    = SHP.ARPCOD
AND MST.MSTDOCNUM       =DLVNOT.MSTDOCNUM(+)
AND MST.DOCOWRIDR       =DLVNOT.DOCOWRIDR(+)
AND MST.DUPNUM          =DLVNOT.DUPNUM(+)
AND MST.CMPCOD          =DLVNOT.CMPCOD(+)
AND MST.MSTDOCNUM       =SEGSHP.MSTDOCNUM (+)
AND MST.DOCOWRIDR       =SEGSHP.DOCOWRIDR (+)
AND MST.DUPNUM          =SEGSHP.DUPNUM(+)
AND MST.CMPCOD          =SEGSHP.CMPCOD (+)
AND SEGSHP.FLTCARIDR    =IMPFLT.FLTCARIDR(+)
AND SEGSHP.FLTNUM       =IMPFLT.FLTNUM(+)
AND SEGSHP.FLTSEQNUM    =IMPFLT.FLTSEQNUM(+)
AND SEGSHP.CMPCOD       =IMPFLT.CMPCOD(+)
AND SHP.ARPCOD          =IMPFLT.ARPCOD
AND PRATDTL.MSTDOCNUM  (+) = MST.MSTDOCNUM
AND PRATDTL.DOCOWRIDR (+)  = MST.DOCOWRIDR
AND PRATDTL.DUPNUM  (+)    = MST.DUPNUM
AND PRATDTL.SEQNUM (+)     = MST.SEQNUM 
AND PRATDTL.CMPCOD (+)     = MST.CMPCOD
AND IMPFLT.FLTCARIDR    =SEG.FLTCARIDR(+)
AND IMPFLT.FLTNUM       =SEG.FLTNUM(+)
AND IMPFLT.FLTSEQNUM    =SEG.FLTSEQNUM(+)
AND IMPFLT.CMPCOD       =SEG.CMPCOD(+)
AND MST.CMPCOD          = ?

				]]>
		</QRY:Source>
		</QRY:Definition>	
		<!-- Code for ICRD-3145 by a-5178 ENDs-->  
		<!--Modified by A-5116 for ICRD-31427 -->
<QRY:Definition>
	<QRY:Id>288</QRY:Id>
	<QRY:Source Name="operations.shipment.findshipmentdetailshistory" Type="NATIVE">
	  <![CDATA[
	    SELECT mst.vernum mstvernum,
  MST.MSTDOCNUM,
  MST.CMPCOD MSTCMPCOD,
  MST.DOCOWRIDR MSTDOCOWRIDR,
  MST.DUPNUM MSTDUPNUM,
  MST.SEQNUM MSTSEQNUM,
  MST.DOCNUM,
  ACC.JRNDAT,
  MST.PLTFLG,
  MST.SHPBNDFLG,
  MST.DOCTYP,
  MST.PARSEQNUM,
  MST.RFCFLG,
  MST.CRAIMPFLG,
  MST.SHPPFX,
  MST.SHPSTA,
  MST.SHPTYP,
  MST.UBRNUM,
  MST.CONFLG,
  MST.HSEFINFLG,
  ACC.IATCOD,
  MST.DOCOWRIDR,
  CNT.CNSACCNUM,
  MST.CNSADRONE,
  CNT.CNSADRTWO,
  MST.CNSCOD,
  CNT.CNSCTR,
  CNT.CNSCTY,
  CNT.CNSMALIDR,
  MST.CNSNAM,
  CNT.CNSPRTNFNFLG,
  CNT.CNSPSTCOD,
  CNT.CNSSTT,
  CNT.CNSTELNUM,
  CNT.SHPACCNUM,
  MST.SHPADRONE,
  CNT.SHPADRTWO,
  MST.SHPCOD,
  CNT.SHPCTR,
  CNT.SHPCTY,
  CNT.SHPMALIDR,
  MST.SHPNAM,
  CNT.SHPPSTCOD,
  CNT.SHPSTT,
  CNT.SHPTELNUM,
  CNT.NFYACCNUM,
  CNT.NFYADRONE,
  CNT.NFYADRTWO,
  MST.NFYCOD,
  CNT.NFYCTR,
  CNT.NFYCTY,
  CNT.NFYMALIDR,
  MST.NFYNAM,
  CNT.NFYPSTCOD,
  CNT.NFYSTT,
  CNT.NFYTELNUM,
  MST.AGTCOD,
  MST.AGTNAM,
  ACC.CASCOD,
  MST.SCCCOD,
  MST.DTACPTFLG,
  MST.STDDISWGT,
  MST.STDPCS,
  MST.STDWGT,
  MST.STDWGTCOD,
  MST.HDLINF,
  MST.SHPDES,
  MST.ORGCOD,
  MST.DSTCOD,
  MIS.SCICOD,
  MIS.REQRTG,
  MST.SPTRATIDR,
  MST.PAYTYP MSTPAYTYP,
  ACC.DVLCUS,
  ACC.DVLCAR,
  MST.CURCOD,
  MST.EXEUSRCOD,
  MST.EXESTN,
  MST.EXEFLG,
  MST.EXEDAT,
  MST.DOMFLG,
  ACC.ACCINF,
  ACC.INSMINAMT,
  ACC.INSAMT,
  mst.PRDNAM,
  mst.PRDPRT,
  MIS.TRTMOD,
  ACC.RATCONIDR,
  mst.PRDCOD,
  MIS.SHPINFONE,
  MIS.SHPINFTWO,
  ACC.SRVCRGCLS,
  ACC.TOTDUECARPPCHG,
  ACC.TOTDUECARCCCHG,
  ACC.TOTDUEAGTPPCHG,
  ACC.TOTDUEAGTCCCHG,
  ACC.WGTPPCHG,
  ACC.WGTCCCHG,
  ACC.VALPPCHG,
  ACC.VALCCCHG,
  ACC.TAXPPD,
  ACC.TAXCCF,
  MST.GRSVOL,
  MST.GRSDISVOL,
  MST.GRSVOLUNT,
  ACC.TOTPPD,
  ACC.TOTCCF,
  ACC.CSHFLG,
  MST.OWRCOD,
  ACC.SPTRAT,
  ACC.SPTRATAPRDAT,
  ACC.SPTRATREQDAT,
  ACC.SPTRATSTA,
  ACC.CMSPPD,
  ACC.CMSCCF,
  MST.SLCPCS SLCPCS,
  MIS.REQFLT REQFLT,
  MIS.CRSREFONE CRSREFONE,
  MIS.CRSREFTWO CRSREFTWO,
  ACC.UNQREFONE UNQREFONE,
  ACC.UNQREFTWO UNQREFTWO,
  ACC.UNQREFTHR UNQREFTHR,
  ACC.UNQREFFOR UNQREFFOR,
  ACC.UNQREFFIV UNQREFFIV,
  FLT.FLTDAT FLTFLTDAT,
  ACC.HGRWGTBRK,
  FLT.DUPNUM FLTDUPNUM,
  FLT.SEGSERNUM FLTSEGSERNUM,
  FLT.FLTNUM FLTFLTNUM,
  FLT.DOCOWRIDR FLTDOCOWRIDR,
  FLT.SEQNUM FLTSEQNUM,
  FLT.FLTCARIDR FLTFLTCARIDR,
  FLT.RTGSERNUM FLTRTGSERNUM,
  FLT.RTESEQNUM FLTRTESEQNUM,
  FLT.FLTSEQNUM FLTFLTSEQNUM,
  FLT.MSTDOCNUM FLTMSTDOCNUM,
  FLT.DSTCOD RTGDSTCOD,
  FLT.FLTCARCOD FLTFLTCARCOD,
  FLT.CMPCOD FLTCMPCOD,
  FLT.DSTCOD FLTDSTCOD,
  CHG.CHGHEDIDR,
  CHG.CHGAMT,
  CHG.PAYTYP CHGPAYTYP,
  CHG.DUECARFLG,
  CHG.DUEAGTFLG,
  CHG.CHGRMK,
  CHG.CHGHED,
  CHG.CMPCOD CHGCMPCOD,
  CHG.DOCOWRIDR CHGDOCOWRIDR,
  CHG.MSTDOCNUM CHGMSTDOCNUM,
  CHG.DUPNUM CHGDUPNUM,
  CHG.SEQNUM CHGSEQNUM,
  CHG.CHDCOD,
  CHG.TAX CHDTAX,
  MST.SRCIND,
  MST.TRGPNT,
  MST.MISMTH,
  MST.STKHLDCOD,
  MST.CAOFLG,
  MST.LSTUPDTIM MSTLSTUPDTIM,
  MST.LSTUPDUSR MSTLSTUPDUSR,
  MST.CHGCOD,
  MIS.CHRTRFLG,
  ACC.RATCONSTA,
  MIS.REQFLTSEQNUM REQFLTSEQNUM,
  MIS.REQFLTCARIDR REQFLTCARIDR,
  MIS.REQFLTDAT REQFLTDAT,
  MIS.MIPERRCOD MIPERRCOD,
  MIS.REQFLTCARCOD REQFLTCARCOD,
  MIS.REQFLTNUM REQFLTNUM,
  MIS.BOE BOE ,
  DENSE_RANK()OVER (ORDER BY MSTCMPCOD,MSTDOCOWRIDR,MST.MSTDOCNUM,MSTDUPNUM,MSTSEQNUM,MST.VERNUM DESC) AS RANK,
  RAT.SEQNUM RATSEQNUM,
  RAT.RATLINSERNUM RATRATLINSERNUM,
  RAT.NUMPCS RATNUMPCS,
  GRSWGT RATGRSWGT,
  RAT.GRSVOL RATGRSVOL,
  CMDITMNUM,
  CMDITMNAM,
  IATRATCLS,
  ACTRATCLS,
  ARLRATCLS,
  IATRAT,
  ARLRAT,
  CHGWGT,
  RATDES,
  ARLRATLINIDR,
  IATRATLINIDR,
  RAT.SCCCOD RATSCCCOD,

  RAT.TAX,
  RAT.ARLTRFNAM,
  RAT.IATTRFNAM,
  RAT.ARLTRFSERNUM,
  RAT.IATTRFSERNUM,
  RAT.ARLTRFRATSERNUM,
  RAT.IATTRFRATSERNUM,
  RAT.IATULDTYP IATULDTYP,
  RAT.CRTREF,
  RAT.NUMULD NUMULD,
  RAT.SRVCOD,
  RAT.RCP,
  DIM.RATLINSERNUM,
  DIM.DIMSERNUM,
  DIM.PCSLEN,
  DIM.PCSHGT,
  DIM.PCSWID,
  DIM.PCSVOL,
  DIM.NUMPCS,
  DIM.WGT,
  DIM.DISWGT,
  RAT.HRMCMDCOD,
  RAT.IATRATTYP,
  DGR.NETQTY,
  DGR.NUMPKG,
  DGR.PKGGRP,
  DGR.PKGINS,
  DGR.PKGTYP DGRPKGTYP,
  DGR.SERNUM DGRSERNUM,
  DGR.UNIIDR,
  DGR.PROSHPNAM,
  DGR.ERGCOD,
  DGR.TECNAM,
  DGR.TPTIND,
  DGR.SCCCOD DGRSCC,
  DGR.SCCCODONE DGRSCCONE,
  DGR.SCCCODTWO DGRSCCTWO,
  DGR.PSGLTDQTYPKI DGRPSGLTDQTYPKI,
  DGR.PKGGRPDES DGRPKGGRPDES,
  DGR.PSGLTDNOTRESFLG DGRPSGLTDNOTRESFLG,
  DGR.PSGNONLTDNOTRESFLG DGRPSGNONLTDNOTRESFLG,
  DGR.CRGNOTRESFLG DGRCRGNOTRESFLG,
  DGR.APPFLG DGRAPPFLG,
  DGR.NOSFLG DGRNOSFLG,
  DGR.NETQTYUNT,
  DGR.ALLPCKSERNUM,
  DGR.OVRPCKSERNUM,
  DGR.NOOFOVRPACKS,
  DGR.NOOFALLPACKS,
  DGR.CARFLAG,
  DGR.RMC,
  DGR.PKGGRPRMC,
  DGR.RDOACTFLG,
  DGR.SHPCLS,
  DGR.SUBRSKONE,
  DGR.SUBRSKTWO,
  DGR.SUBRSKTHR,
  DGR.LSTUPDTIM DGRLSTUPDTIM,
  DGR.TECNAMFLG,
  MST.CHGGRPCOD,
  MST.VODFLG MSTVODFLG,
  MST.RDYCRGFLG,
  MST.RATLINRMK MSTRATLINRMK,
  MST.PRGCLSDAT MSTPRGCLSDAT,
  MST.PAYDUEFLG MSTPAYDUEFLG,
  MST.MSTCLSTIM MSTMSTCLSTIM,
  MST.INTFLG MSTINTFLG,
  MST.FRCCLSRMK MSTFRCCLSRMK,
  MST.FRCCLSFLG MSTFRCCLSFLG,
  MST.CPTDATUTC MSTCPTDATUTC,
  MST.CPTDAT MSTCPTDAT,
  CHG.ACTCHGAMT CHGACTCHGAMT,
  CHG.TAXPCT CHGTAXPCT,
  CHG.VERNUM CHGVERNUM,
  CHG.MNLUPDFLG CHGMNLUPDFLG,
  CHG.PAYMOD CHGPAYMOD,
  CHG.CHDGRSAMT CHGCHDGRSAMT,
  CHG.ETYSUBCOD CHGETYSUBCOD,
  CHG.CUSTYP CHGCUSTYP,
  CHG.CUSCOD CHGCUSCOD,
  RAT.ACTALNCHG RATACTALNCHG,
  RAT.ACTARLRAT RATACTARLRAT,
  RAT.ACTCHGWGT RATACTCHGWGT,
  RAT.ACTCMDITMNUM RATACTCMDITMNUM,
  RAT.ACTGRSVOL RATACTGRSVOL,
  RAT.ACTIATCHG RATACTIATCHG,
  RAT.ACTIATRAT RATACTIATRAT,
  RAT.ACTNETCHG RATACTNETCHG,
  RAT.AGTCMS RATAGTCMS,
  RAT.ALNBSECHG ALNBSECHG,
  RAT.ALNCHG ALNCHG,
  RAT.ARLRATTYP RATARLRATTYP,
  RAT.CMPCOD RATCMPCOD,
  RAT.CONFLG RATCONFLG,
  RAT.CTRORG RATCTRORG,
  RAT.DOCOWRIDR RATDOCOWRIDR,
  RAT.DSCPCT RATDSCPCT,
  RAT.DUPNUM RATDUPNUM,
  RAT.GRSDISWGT RATGRSDISWGT,
  RAT.GRSWGTCOD RATGRSWGTCOD,
  RAT.IATBSECHG IATBSECHG,
  RAT.IATCHG IATCHG,
  RAT.IATCOD RATIATCOD,
  RAT.LSTUPDTIM RATLSTUPDTIM,
  RAT.LSTUPDUSR RATLSTUPDUSR,
  RAT.MIPCOMNUM RATMIPCOMNUM,
  RAT.MIPCONDES RATMIPCONDES,
  RAT.MIPCTRORN RATMIPCTRORN,
  RAT.MIPGODDES RATMIPGODDES,
  RAT.MIPGRSVOL RATMIPGRSVOL,
  RAT.MIPGRSWGTCOD RATMIPGRSWGTCOD,
  RAT.MIPHRMCMDCOD RATMIPHRMCMDCOD,
  RAT.MIPRATCLS RATMIPRATCLS,
  RAT.MIPSLAC RATMIPSLAC,
  RAT.MIPSRVCOD RATMIPSRVCOD,
  RAT.MIPULDNUM RATMIPULDNUM,
  RAT.MIPVOLCOD RATMIPVOLCOD,
  RAT.MSTDOCNUM RATMSTDOCNUM,
  RAT.NETCHG NETCHG,
  RAT.OVRFLWFLG RATOVRFLWFLG,
  RAT.PARSERNUM RATPARSERNUM,
  RAT.RATLINSEQNUM RATRATLINSEQNUM,
  RAT.RATUSEFLG RATRATUSEFLG,
  RAT.SHPTAXPCT RATSHPTAXPCT,
  RAT.TAXBSSVAL RATTAXBSSVAL,
  RAT.TAXPCT RATTAXPCT,
  RAT.VERNUM RATVERNUM,
  RAT.ADDARLRATLINIDS,
  RAT.TRKOALRATFLG,
  DIM.CMPCOD DIMCMPCOD,
  DIM.DOCOWRIDR DIMDOCOWRIDR,
  DIM.DUPNUM DIMDUPNUM,
  DIM.LSTUPDTIM DIMLSTUPDTIM,
  DIM.LSTUPDUSR DIMLSTUPDUSR,
  DIM.MIPDISWGT DIMMIPDISWGT,
  DIM.MIPHGT DIMMIPHGT,
  DIM.MIPLEN DIMMIPLEN,
  DIM.MIPPCS DIMMIPPCS,
  DIM.MIPUNTCOD DIMMIPUNTCOD,
  DIM.MIPWGTCOD DIMMIPWGTCOD,
  DIM.MIPWID DIMMIPWID,
  DIM.MSTDOCNUM DIMMSTDOCNUM,
  DIM.SEQNUM DIMSEQNUM,
  DIM.VERNUM DIMVERNUM,
  DIM.WGTCOD DIMWGTCOD,
  MIS.QLTASRVERNUM MISQLTASRVERNUM,
  MIS.ADLSHPDES MISADLSHPDES,
  MIS.AGTPLC MISAGTPLC,
  MIS.AGTPPTNUM MISAGTPPTNUM,
  MIS.AGTREF MISAGTREF,
  MIS.AGTUNQIDR MISAGTUNQIDR,
  MIS.AWBRMK MISAWBRMK,
  MIS.AWBRPTRMK MISAWBRPTRMK,
  MIS.AWBSYN MISAWBSYN,
  MIS.BDNSRTFLG MISBDNSRTFLG,
  MIS.BKGCRNDAT MISBKGCRNDAT,
  MIS.CCFBKGFLG MISCCFBKGFLG,
  MIS.CMPCOD MISCMPCOD,
  MIS.CNEISOCNTCOD MISCNEISOCNTCOD,
  MIS.COLAGY MISCOLAGY,
  MIS.COLCHRIDN MISCOLCHRIDN,
  MIS.CUSORGCOD MISCUSORGCOD,
  MIS.DOCOWRIDR MISDOCOWRIDR,
  MIS.DOCSUBTYP MISDOCSUBTYP,
  MIS.DUPNUM MISDUPNUM,
  MIS.EOSSNDFLG MISEOSSNDFLG,
  MIS.ERINUM MISERINUM,
  MIS.EURSTA MISEURSTA,
  MIS.FHLFLG MISFHLFLG,
  MIS.FRMCOD MISFRMCOD,
  MIS.FWBFLG MISFWBFLG,
  MIS.FWDCOD MISFWDCOD,
  MIS.GNDCHDFLG MISGNDCHDFLG,
  MIS.HRMCSTCOD MISHRMCSTCOD,
  MIS.IMARCVTIM MISIMARCVTIM,
  MIS.INSDTL MISINSDTL,
  MIS.INSPRTFLG MISINSPRTFLG,
  MIS.JNTCONFLG MISJNTCONFLG,
  MIS.LSTSHPSRC MISLSTSHPSRC,
  MIS.MANUPD MISMANUPD,
  MIS.MIPSENFILREF MISMIPSENFILREF,
  MIS.MIPWGTCOD MISMIPWGTCOD,
  MIS.MSGSEQNUM MISMSGSEQNUM,
  MIS.MSGTYP MISMSGTYP,
  MIS.MSTDOCNUM MISMSTDOCNUM,
  MIS.NOMHDLPTY,
  MIS.NOMHDLPTYPLC,
  MIS.NUMFSU MISNUMFSU,
  MIS.NUMFWB MISNUMFWB,
  MIS.OTHPCIND MISOTHPCIND,
  MIS.PERCOD MISPERCOD,
  MIS.PPDCHRIDN MISPPDCHRIDN,
  MIS.PPTCOD MISPPTCOD,
  MIS.PPTCTY MISPPTCTY,
  MIS.PPTIDR MISPPTIDR,
  MIS.PRTCCJFLG MISPRTCCJFLG,
  MIS.SEQNUM MISSEQNUM,
  MIS.SHPBNDFLG MISSHPBNDFLG,
  MIS.SHPDESCOD MISSHPDESCOD,
  MIS.SHPISOCNTCOD MISSHPISOCNTCOD,
  MIS.SHPSIG,
  MIS.SHWRATFORRPT MISSHWRATFORRPT,
  MIS.SNDCMPDSG MISSNDCMPDSG,
  MIS.SNDCTY MISSNDCTY,
  MIS.SNDDSG MISSNDDSG,
  MIS.SNDFILREF MISSNDFILREF,
  MIS.STACOD MISSTACOD,
  MIS.VERNUM MISVERNUM,
  MIS.AGTSIG,
  MIS.LNKSHPPFX,
  MIS.LNKMSTDOCNUM,
  MIS.PKGTYP,
  CNT.AGTADR CNTAGTADR,
  CNT.AGTCTR CNTAGTCTR,
  CNT.AGTCTY CNTAGTCTY,
  CNT.AGTPSTCOD CNTAGTPSTCOD,
  CNT.AGTSTT CNTAGTSTT,
  CNT.CMPCOD CNTCMPCOD,
  CNT.CNSERINUM CNTCNSERINUM,
  CNT.DOCOWRIDR CNTDOCOWRIDR,
  CNT.DUPNUM CNTDUPNUM,
  CNT.MSTDOCNUM CNTMSTDOCNUM,
  CNT.NFYERINUM CNTNFYERINUM,
  CNT.POA CNTPOA,
  CNT.SEQNUM CNTSEQNUM,
  CNT.SHPERINUM CNTSHPERINUM,
  CNT.SHPREFNUM CNTSHPREFNUM,
  CNT.VERNUM CNTVERNUM,
  ACC.ACTCMSCCF ACCACTCMSCCF,
  ACC.ACTCMSPPD ACCACTCMSPPD,
  ACC.ACTTAXCCF ACCACTTAXCCF,
  ACC.ACTTAXPPD ACCACTTAXPPD,
  ACC.ACTTOTCCF ACCACTTOTCCF,
  ACC.ACTTOTDUEAGTCCCHG ACCACTTOTDUEAGTCCCHG,
  ACC.ACTTOTDUEAGTPPCHG ACCACTTOTDUEAGTPPCHG,
  ACC.ACTTOTDUECARCCCHG ACCACTTOTDUECARCCCHG,
  ACC.ACTTOTDUECARPPCHG ACCACTTOTDUECARPPCHG,
  ACC.ACTTOTPPD ACCACTTOTPPD,
  ACC.ACTVALCCCHG ACCACTVALCCCHG,
  ACC.ACTVALPPCHG ACCACTVALPPCHG,
  ACC.ACTWGTCCCHG ACCACTWGTCCCHG,
  ACC.ACTWGTPPCHG ACCACTWGTPPCHG,
  ACC.AGTACCNUM ACCAGTACCNUM,
  ACC.ATOCMTTAX ACCATOCMTTAX,
  ACC.CMPCOD ACCCMPCOD,
  ACC.CMSAMT ACCCMSAMT,
  ACC.CMSCASIND ACCCMSCASIND,
  ACC.CMSPCT ACCCMSPCT,
  ACC.CONCHG ACCCONCHG,
  ACC.CONRAT ACCCONRAT,
  ACC.DOCOWRIDR ACCDOCOWRIDR,
  ACC.DSTCCFCHG ACCDSTCCFCHG,
  ACC.DSTCHG ACCDSTCHG,
  ACC.DSTCNVRAT ACCDSTCNVRAT,
  ACC.DSTCURCOD ACCDSTCURCOD,
  ACC.DUPNUM ACCDUPNUM,
  ACC.INSPCT ACCINSPCT,
  ACC.MIPDESCURCOD ACCMIPDESCURCOD,
  ACC.MNLCPTFLG ACCMNLCPTFLG,
  ACC.MSTDOCNUM ACCMSTDOCNUM,
  ACC.OTHPAYTYP ACCOTHPAYTYP,
  ACC.RATCONAPRDAT ACCRATCONAPRDAT,
  ACC.RATCONREQDAT ACCRATCONREQDAT,
  ACC.SALINCAMT ACCSALINCAMT,
  ACC.SALINCCASIND ACCSALINCCASIND,
  ACC.SEQNUM ACCSEQNUM,
  ACC.SHPREFNUM ACCSHPREFNUM,
  ACC.SPTCHG ACCSPTCHG,
  ACC.TOTDSTCCFCHG ACCTOTDSTCCFCHG,
  ACC.VALTAX ACCVALTAX,
  ACC.VERNUM ACCVERNUM,
  ACC.VFYEXEFLG ACCVFYEXEFLG,
  ACC.PAYMOD ACCPAYMOD,
  MIS.MSGSEQNUM ,
  OTHSRV.OTHSRVINF OTHSRVINF,
  OTHSRV.VERNUM OTHSRVVERNUM,
  SRV.SRVCOD SRVSRVCOD,
  SRV.VERNUM SRVVERNUM,
  SHPACC.ACCINFIDR SHPACCACCINFIDR,
  SHPACC.ACCINF SHPACCACCINF,
  SHPACC.SERNUM SHPACCSERNUM,
  SHPACC.VERNUM SHPACCVERNUM,
  MSTCNT.CNTIDR MSTCNTCNTIDR,
  MSTCNT.CNTTYP MSTCNTCNTTYP,
  MSTCNT.CNTVAL MSTCNTCNTVAL,
  MSTCNT.SERNUM MSTCNTSERNUM,
  MSTCNT.VERNUM MSTCNTVERNUM,
  FLTBOK.CARIDR FLTBOKCARIDR,
  FLTBOK.CARCOD FLTBOKCARCOD,
  FLTBOK.FLTDAT FLTBOKFLTDAT,
  FLTBOK.FLTNUM FLTBOKFLTNUM,
  FLTBOK.SEGNUM FLTBOKSEGNUM,
  FLTBOK.SEGORG FLTBOKSEGORG,
  FLTBOK.SEGDST FLTBOKSEGDST,
  FLTBOK.VERNUM FLTBOKVERNUM,
  FLTBOK.SERNUM FLTBOKSERNUM,
  OTHPPT.PPTCOD OTHPPTPPTCOD,
  OTHPPT.PPTCTY OTHPPTPPTCTY,
  OTHPPT.CMPDSG OTHPPTCMPDSG,
  OTHPPT.PPTNAM OTHPPTPPTNAM,
  OTHPPT.OFFCTY OTHPPTOFFCTY,
  OTHPPT.OFFDSG OTHPPTOFFDSG,
  OTHPPT.OFFFILREF OTHPPTOFFFILREF,
  OTHPPT.SERNUM OTHPPTSERNUM,
  OTHPPT.PPTIDR OTHPPTPPTIDR,
  OTHPPT.STNCOD OTHPPTSTNCOD,
  OTHPPT.VERNUM OTHPPTVERNUM,
  SSR.SPLSRVREQ SPLSRVREQ ,
  SSR.SERNUM SHPSSRSERNUM,
  SSR.VERNUM SSRVERNUM,
  
  MIS.PRMTYP,
  MIS.LSTEVLDAT,
  MIS.QTNREVNUM,
  MIS.EVLTYP,
  ACC.TOTARLCHG,
  ACC.JNTREV,
  ACC.GSCCMS,
  ACC.GSCADLCMS,
  ACC.DSTEXGRATBSS ACCDSTEXGRATBSS,
  ACC.DSTCURCNVDAT ACCDSTCURCNVDAT,
  MIS.EVTTIMUTC,
  MIS.EVTINF,
  CNT.AGTSTN AGTSTACOD,
  CNT.SHPSTN SHPSTNCOD,
  CNT.CNSSTN CNSSTNCOD,
  OCI.SERNUM AS OCISERNUM,
       OCI.CNTCOD AS OCICNTCOD,
       OCI.SRCIND AS OCISRCIND,
       OCI.INFIDF,
       OCI.CUSINFIDF,
       OCI.CUSINF,
      OCI.PARSERNUM,
	  CSTINF.SERNUM AS CUSSERNUM,
      CSTINF.CSTAUTCOD,
      CSTINF.PARTYP,
      CSTINF.PARVAL,
   NFY.NFDSTN NFDSTNCOD,
  NFY.CMPCOD NFYCMPCOD,
  NFY.DOCOWRIDR NFYDOCOWRIDR,
  NFY.MSTDOCNUM NFYMSTDOCNUM,
  NFY.DUPNUM NFYDUPNUM,
  NFY.SEQNUM NFYSEQNUM,
  NFY.NFYCOD NFYNFYCOD,
  NFY.NFYNAM NFYNFYNAM,
  NFY.NFYTELNUM NFYNFYTELNUM,
  NFY.NFYMALIDR NFYNFYMALIDR,
  NFY.NFYADRONE NFYNFYADRONE,
  NFY.NFYADRTWO NFYNFYADRTWO,
  NFY.NFYCTY NFYNFYCTY,
  NFY.NFYSTT NFYNFYSTT,
  NFY.NFYCTR NFYNFYCTR,
  NFY.NFYPSTCOD NFYNFYPSTCOD,
  NFY.PRTNFNFLG NFYPRTNFNFLG,
  NFY.NFYMOD NFYNFYMOD,
  NFY.NFYACCNUM NFYNFYACCNUM,
  MIS.MSGORG MSGORG,
  ULD.CMPCOD ULDCMPCOD,ULD.DOCOWRIDR ULDDOCOWRIDR,ULD.MSTDOCNUM ULDMSTDOCNUM,ULD.DUPNUM ULDDUPNUM,
  ULD.SEQNUM ULDSEQNUM,ULD.RATLINSERNUM ULDRATLINSERNUM,
  ULD.SERNUM ULDSERNUM, ULD.ULDNUM ULDNUM,ULD.SLCPCS ULDSLCPCS
FROM OPRSHPMSTHIS MST,
  OPRSHPRTGHIS FLT,
  OPRSHPNFYHIS NFY,
  OPRSHPCHGDTLHIS CHG,
  OPRSHPMSTACCHIS ACC,
  OPRSHPMSTMISHIS MIS,
  OPRSHPMSTCNTHIS CNT,
  OPRSHPRATDTLHIS RAT,
  OPRSHPDIMDTLHIS DIM,
  OPRSHPDGRHIS DGR,
  OPRSHPSRVHIS SRV,
  OPRSHPOTHSRVHIS OTHSRV,
  OPRSHPACCDTLHIS SHPACC,
  OPRSHPCNTHIS MSTCNT,
  OPRSHPFLTBOKHIS FLTBOK,
  OPRSHPOTHPPTHIS OTHPPT,
  OPRSHPSPLSRVREQHIS SSR,
  OPRSHPOCIHIS OCI,
  OPRSHPCSTINFHIS CSTINF, 
  OPRSHPRATULD ULD
WHERE MST.CMPCOD     = ACC.CMPCOD
AND MST.DOCOWRIDR    = ACC.DOCOWRIDR
AND MST.MSTDOCNUM    = ACC.MSTDOCNUM
AND MST.DUPNUM       = ACC.DUPNUM
AND MST.SEQNUM       = ACC.SEQNUM
AND MST.vernum       = acc.vernum
AND MST.CMPCOD       = MIS.CMPCOD
AND MST.DOCOWRIDR    = MIS.DOCOWRIDR
AND MST.MSTDOCNUM    = MIS.MSTDOCNUM
AND MST.DUPNUM       = MIS.DUPNUM
AND MST.SEQNUM       = MIS.SEQNUM
AND MST.vernum       = mis.vernum
AND MST.CMPCOD       = CNT.CMPCOD
AND MST.DOCOWRIDR    = CNT.DOCOWRIDR
AND MST.MSTDOCNUM    = CNT.MSTDOCNUM
AND MST.DUPNUM       = CNT.DUPNUM
AND MST.SEQNUM       = CNT.SEQNUM
AND MST.vernum       = cnt.vernum
AND MST.CMPCOD       = FLT.CMPCOD(+)
AND MST.DOCOWRIDR    = FLT.DOCOWRIDR(+)
AND MST.MSTDOCNUM    = FLT.MSTDOCNUM(+)
AND MST.DUPNUM       = FLT.DUPNUM(+)
AND MST.SEQNUM       = FLT.SEQNUM(+)
AND MST.vernum       = flt.vernum(+)
AND MST.CMPCOD       = CHG.CMPCOD(+)
AND MST.DOCOWRIDR    = CHG.DOCOWRIDR(+)
AND MST.MSTDOCNUM    = CHG.MSTDOCNUM(+)
AND MST.DUPNUM       = CHG.DUPNUM(+)
AND MST.SEQNUM       = CHG.SEQNUM(+)
AND MST.vernum       = chg.vernum(+)
AND MST.CMPCOD       = RAT.CMPCOD(+)
AND MST.DOCOWRIDR    = RAT.DOCOWRIDR(+)
AND MST.MSTDOCNUM    = RAT.MSTDOCNUM(+)
AND MST.DUPNUM       = RAT.DUPNUM(+)
AND MST.SEQNUM       = RAT.SEQNUM(+)
AND MST.vernum       = RAT.vernum(+)
AND RAT.CMPCOD       =DIM.CMPCOD(+)
AND RAT.DOCOWRIDR    =DIM.DOCOWRIDR(+)
AND RAT.MSTDOCNUM    =DIM.MSTDOCNUM(+)
AND RAT.DUPNUM       =DIM.DUPNUM(+)
AND RAT.SEQNUM       =DIM.SEQNUM(+)
AND RAT.RATLINSERNUM =DIM.RATLINSERNUM(+)
AND RAT.VERNUM       =DIM.VERNUM(+)
AND RAT.CMPCOD      =ULD.CMPCOD(+)
AND RAT.DOCOWRIDR   =ULD.DOCOWRIDR(+)
AND RAT.MSTDOCNUM   =ULD.MSTDOCNUM(+)
AND RAT.DUPNUM      =ULD.DUPNUM(+)
AND RAT.SEQNUM      =ULD.SEQNUM(+)
AND RAT.RATLINSERNUM=ULD.RATLINSERNUM(+) 
AND MST.CMPCOD       = DGR.CMPCOD(+)
AND MST.DOCOWRIDR    = DGR.DOCOWRIDR(+)
AND MST.MSTDOCNUM    = DGR.MSTDOCNUM(+)
AND MST.DUPNUM       = DGR.DUPNUM(+)
AND MST.SEQNUM       = DGR.SEQNUM(+)
AND MST.VERNUM       = DGR.VERNUM(+)
AND MST.DOCOWRIDR    = SRV.DOCOWRIDR(+)
AND MST.MSTDOCNUM    = SRV.MSTDOCNUM(+)
AND MST.DUPNUM       = SRV.DUPNUM(+)
AND MST.SEQNUM       = SRV.SEQNUM(+)
AND MST.CMPCOD       = SRV.CMPCOD(+)
AND MST.VERNUM       = SRV.VERNUM(+)
AND MST.DOCOWRIDR    = OTHSRV.DOCOWRIDR(+)
AND MST.MSTDOCNUM    = OTHSRV.MSTDOCNUM(+)
AND MST.DUPNUM       = OTHSRV.DUPNUM(+)
AND MST.SEQNUM       = OTHSRV.SEQNUM(+)
AND MST.VERNUM       = OTHSRV.VERNUM(+)
AND MST.CMPCOD       = OTHSRV.CMPCOD(+)
AND MST.DOCOWRIDR    = SHPACC.DOCOWRIDR(+)
AND MST.MSTDOCNUM    = SHPACC.MSTDOCNUM(+)
AND MST.DUPNUM       = SHPACC.DUPNUM(+)
AND MST.SEQNUM       = SHPACC.SEQNUM(+)
AND MST.VERNUM       = SHPACC.VERNUM(+)
AND MST.CMPCOD       = SHPACC.CMPCOD(+)
AND MST.DOCOWRIDR    = MSTCNT.DOCOWRIDR(+)
AND MST.MSTDOCNUM    = MSTCNT.MSTDOCNUM(+)
AND MST.DUPNUM       = MSTCNT.DUPNUM(+)
AND MST.SEQNUM       = MSTCNT.SEQNUM(+)
AND MST.VERNUM       = MSTCNT.VERNUM(+)
AND MST.CMPCOD       = MSTCNT.CMPCOD(+)
AND MST.DOCOWRIDR    = FLTBOK.DOCOWRIDR(+)
AND MST.MSTDOCNUM    = FLTBOK.MSTDOCNUM(+)
AND MST.DUPNUM       = FLTBOK.DUPNUM(+)
AND MST.SEQNUM       = FLTBOK.SEQNUM(+)
AND MST.VERNUM       = FLTBOK.VERNUM(+)
AND MST.CMPCOD       = FLTBOK.CMPCOD(+)
AND MST.DOCOWRIDR    = OTHPPT.DOCOWRIDR(+)
AND MST.MSTDOCNUM    = OTHPPT.MSTDOCNUM(+)
AND MST.DUPNUM       = OTHPPT.DUPNUM(+)
AND MST.SEQNUM       = OTHPPT.SEQNUM(+)
AND MST.VERNUM       = OTHPPT.VERNUM(+)
AND MST.CMPCOD       = OTHPPT.CMPCOD(+)
AND MST.DOCOWRIDR    = SSR.DOCOWRIDR(+)
AND MST.MSTDOCNUM    = SSR.MSTDOCNUM(+)
AND MST.DUPNUM       = SSR.DUPNUM(+)
AND MST.SEQNUM       = SSR.SEQNUM(+)
AND MST.VERNUM       = SSR.VERNUM(+)
AND MST.CMPCOD       = SSR.CMPCOD(+)
AND MST.CMPCOD           = OCI.CMPCOD(+)
AND MST.DOCOWRIDR        = OCI.DOCOWRIDR(+)
AND MST.MSTDOCNUM        = OCI.MSTDOCNUM(+)
AND MST.DUPNUM           = OCI.DUPNUM(+)
AND MST.SEQNUM           = OCI.SEQNUM(+)
AND MST.VERNUM           = OCI.VERNUM(+)
AND MST.CMPCOD           = CSTINF.CMPCOD(+)
AND MST.DOCOWRIDR        = CSTINF.DOCOWRIDR(+)
AND MST.MSTDOCNUM        = CSTINF.MSTDOCNUM(+)
AND MST.DUPNUM           = CSTINF.DUPNUM(+)
AND MST.SEQNUM           = CSTINF.SEQNUM(+)
AND MST.VERNUM           = CSTINF.VERNUM(+)
AND MST.CMPCOD           = NFY.CMPCOD(+)
AND MST.DOCOWRIDR        = NFY.DOCOWRIDR(+)
AND MST.MSTDOCNUM        = NFY.MSTDOCNUM(+)
AND MST.DUPNUM           = NFY.DUPNUM(+)
AND MST.SEQNUM           = NFY.SEQNUM(+)
AND MST.VERNUM           = NFY.VERNUM(+)
AND MST.NFYCOD           = NFY.NFYCOD(+)
	  ]]>
	</QRY:Source>
	</QRY:Definition>

<QRY:Definition>
    <QRY:Id>289</QRY:Id>
    <QRY:Source Name="operation.shipment.finduldacceptancehistorydetails" Type="NATIVE">
      <![CDATA[     	
				   SELECT ULDSHPACP.CMPCOD ULDSHPACPCMPCOD, ULDSHPACP.ARPCOD ULDSHPACPARPCOD, ULDSHPACP.DOCOWRIDR ULDSHPACPDOCOWRIDR, ULDSHPACP.MSTDOCNUM ULDSHPACPMSTDOCNUM, ULDSHPACP.DUPNUM ULDSHPACPDUPNUM,
						ULDSHPACP.SEQNUM ULDSHPACPSEQNUM, ULDSHPACP.ACPVER ULDSHPACPACPVER, ULDSHPACP.LSTUPDUSR, ULDSHPACP.LSTUPDTIM, ULDSHPACP.ULDNUM ULDSHPACPULDNUM,
						ULDSHPACP.ACPPCS, ULDSHPACP.ULDWGTCOD, ULDSHPACP.ACPVOLCOD, ULDSHPACP.CMDITMNAM, ULDSHPACP.SCCCOD,ULDSHPACP.ACPDISVOL,ULDSHPACP.ULDDISWGT,
						ULDSHPACP.ACPSTRTIM, ULDSHPACP.ACPENDTIM, ULDSHPACP.ACPUSR, ACPDIM.CMPCOD  ACPDIMCMPCOD, ACPDIM.ARPCOD ACPDIMARPCOD, ACPDIM.DOCOWRIDR ACPDIMDOCOWRIDR,
						ACPDIM.MSTDOCNUM ACPDIMMSTDOCNUM, ACPDIM.DUPNUM ACPDIMDUPNUM, ACPDIM.SEQNUM ACPDIMSEQNUM, ACPDIM.ACPVER ACPDIMACPVER, ACPDIM.PCSLEN, ACPDIM.PCSWID, ACPDIM.PCSHGT,
						ACPDIM.PCSVOL, ACPDIM.NUMPCS, ACPDIM.DISWGT, ACPDIM.WGTCOD,ACPDIM.DIMSERNUM, ACPFLT.CMPCOD ACPFLTCMPCOD, ACPFLT.ARPCOD ACPFLTARPCOD, ACPFLT.DOCOWRIDR ACPFLTDOCOWRIDR,
						ACPFLT.MSTDOCNUM ACPFLTMSTDOCNUM, ACPFLT.DUPNUM ACPFLTDUPNUM, ACPFLT.SEQNUM ACPFLTSEQNUM, ACPFLT.ACPVER ACPFLTACPVER, ACPFLT.FLTCARCOD, ACPFLT.FLTCARIDR, ACPFLT.FLTNUM,
						ACPFLT.FLTSEQNUM, ACPFLT.FLTDAT, ACPFLT.POU,ACPFLT.PCS,
						ULDSHPACP.WHSCOD ULDSHPACPWHSCOD,
ULDSHPACP.LOCCOD ULDSHPACPLOCCOD,
ULDSHPACP.ULDSERNUM,
ULDSHPACP.ULDCTR,
ULDSHPACP.SHPDES ULDSHPACPSHPDES,
ULDSHPACP.SHPRMK ULDSHPACPSHPRMK,
ULDSHPACP.ACPSTA ULDSHPACPACPSTA,
ACPFLT.SERNUM,
ACPFLT.LEGSERNUM,
ACPFLT.ULDNUM,
ACPFLT.WGT,
ULDACP.TARDISWGT ULDACPTARDISWGT,
  ULDACP.TARWGTCOD ULDACPTARWGTCOD,
ULDACP.FLTCARIDR ULDACPFLTCARIDR,
  ULDACP.FLTNUM ULDACPFLTNUM,
  ULDACP.FLTSEQNUM ULDACPFLTSEQNUM,
  ULDACP.SEGSERNUM ULDACPSEGSERNUM,
  ULDACP.FLTDAT ULDACPFLTDAT,
  ULDACP.LSTUPDUSR ULDACPLSTUPDUSR,
  ULDACP.LSTUPDTIM ULDACPLSTUPDTIM, 
  ULDACP.POU ULDACPPOU
FROM OPRULDACPDTLHIS ULDSHPACP INNER JOIN OPRULDACPHIS ULDACP ON
						ULDSHPACP.CMPCOD = ULDACP.CMPCOD
						AND ULDSHPACP.ARPCOD = ULDACP.ARPCOD
						AND ULDSHPACP.ULDNUM = ULDACP.ULDNUM
						AND ULDSHPACP.ACPVER = ULDACP.ACPVER

						LEFT OUTER JOIN OPRSHPDIMACPHIS ACPDIM
						ON ULDSHPACP.CMPCOD = ACPDIM.CMPCOD
						AND ULDSHPACP.ARPCOD = ACPDIM.ARPCOD
						AND ULDSHPACP.DOCOWRIDR = ACPDIM.DOCOWRIDR
						AND ULDSHPACP.MSTDOCNUM = ACPDIM.MSTDOCNUM
						AND ULDSHPACP.DUPNUM = ACPDIM.DUPNUM
						AND ULDSHPACP.SEQNUM = ACPDIM.SEQNUM
						AND ULDSHPACP.ACPVER = ACPDIM.ACPVER

						LEFT OUTER JOIN OPRACPFLTDTLHIS ACPFLT ON
						ULDSHPACP.CMPCOD = ACPFLT.CMPCOD
						AND ULDSHPACP.ARPCOD = ACPFLT.ARPCOD
						AND ULDSHPACP.DOCOWRIDR = ACPFLT.DOCOWRIDR
						AND ULDSHPACP.MSTDOCNUM = ACPFLT.MSTDOCNUM
						AND ULDSHPACP.DUPNUM = ACPFLT.DUPNUM
						AND ULDSHPACP.SEQNUM = ACPFLT.SEQNUM
						AND ULDSHPACP.ACPVER = ACPFLT.ACPVER
						WHERE ULDSHPACP.CMPCOD = ?
				]]>
    
		</QRY:Source>
		</QRY:Definition>	

<QRY:Definition>
    <QRY:Id>290</QRY:Id>
    <QRY:Source Name="operation.shipment.findshipmentacceptancehistorydetails" Type="NATIVE">
      <![CDATA[     	
					 SELECT SHPACP.CMPCOD SHPACPCMPCOD,
  SHPACP.ARPCOD SHPACPARPCOD,
  SHPACP.DOCOWRIDR SHPACPDOCOWRIDR,
  SHPACP.MSTDOCNUM SHPACPMSTDOCNUM,
  SHPACP.DUPNUM SHPACPDUPNUM,
  SHPACP.SEQNUM SHPACPSEQNUM,
  SHPACP.ACPVER SHPACPACPVER,
  SHPACP.LSTUPDUSR,
  SHPACP.LSTUPDTIM,
  SHPACP.ACPPCS SHPACPACPPCS,
  SHPACP.ACPWGTCOD,
  SHPACP.ACPVOLCOD SHPACPACPVOLCOD,
  SHPACP.CMDITMNAM SHPACPCMDITMNAM,
  SHPACP.SCCCOD SHPACPSCCCOD,
  SHPACP.ACPSTRTIM,
  SHPACP.ACPENDTIM,
  SHPACP.ACPIDR,
  SHPACP.ACPUSR,
  SHPACP.ACPDISVOL SHPACPACPDISVOL,
  SHPACP.ACPDISWGT,
  SHPACP.ACPSTA SHPACPACPSTA,
  SHPACP.LOCCOD SHPACPLOCCOD,
  SHPACP.SHPDES SHPACPSHPDES,
  SHPACP.SHPRMK SHPACPSHPRMK,
  SHPACP.STUCOD,
  SHPACP.WHSCOD SHPACPWHSCOD,
  ACPDIM.CMPCOD ACPDIMCMPCOD,
  ACPDIM.ARPCOD ACPDIMARPCOD,
  ACPDIM.DOCOWRIDR ACPDIMDOCOWRIDR,
  ACPDIM.MSTDOCNUM ACPDIMMSTDOCNUM,
  ACPDIM.DUPNUM ACPDIMDUPNUM,
  ACPDIM.SEQNUM ACPDIMSEQNUM,
  ACPDIM.ACPVER ACPDIMACPVER,
  ACPDIM.PCSLEN,
  ACPDIM.PCSWID,
  ACPDIM.PCSHGT,
  ACPDIM.DISWGT,
  ACPDIM.PCSVOL,
  ACPDIM.NUMPCS,
  ACPDIM.WGTCOD,
  ACPDIM.DIMSERNUM,
  ACPFLT.CMPCOD ACPFLTCMPCOD,
  ACPFLT.ARPCOD ACPFLTARPCOD,
  ACPFLT.DOCOWRIDR ACPFLTDOCOWRIDR,
  ACPFLT.MSTDOCNUM ACPFLTMSTDOCNUM,
  ACPFLT.DUPNUM ACPFLTDUPNUM,
  ACPFLT.SEQNUM ACPFLTSEQNUM,
  ACPFLT.ACPVER ACPFLTACPVER,
  ACPFLT.FLTCARCOD,
  ACPFLT.FLTCARIDR,
  ACPFLT.FLTNUM,
  ACPFLT.FLTSEQNUM,
  ACPFLT.FLTDAT,
  ACPFLT.POU,
  ACPFLT.PCS,
  ACPFLT.LEGSERNUM,
  ACPFLT.SERNUM,
  ACPFLT.ULDNUM ACPFLTULDNUM,
  ACPFLT.WGT ACPFLTWGT
FROM OPRSHPACPDTLHIS SHPACP
LEFT OUTER JOIN OPRSHPDIMACPHIS ACPDIM
ON SHPACP.CMPCOD     = ACPDIM.CMPCOD
AND SHPACP.ARPCOD    = ACPDIM.ARPCOD
AND SHPACP.DOCOWRIDR = ACPDIM.DOCOWRIDR
AND SHPACP.MSTDOCNUM = ACPDIM.MSTDOCNUM
AND SHPACP.DUPNUM    = ACPDIM.DUPNUM
AND SHPACP.SEQNUM    = ACPDIM.SEQNUM
AND SHPACP.ACPVER    = ACPDIM.ACPVER
LEFT OUTER JOIN OPRACPFLTDTLHIS ACPFLT
ON SHPACP.CMPCOD     = ACPFLT.CMPCOD
AND SHPACP.ARPCOD    = ACPFLT.ARPCOD
AND SHPACP.DOCOWRIDR = ACPFLT.DOCOWRIDR
AND SHPACP.MSTDOCNUM = ACPFLT.MSTDOCNUM
AND SHPACP.DUPNUM    = ACPFLT.DUPNUM
AND SHPACP.SEQNUM    = ACPFLT.SEQNUM
AND SHPACP.ACPVER    = ACPFLT.ACPVER
WHERE SHPACP.CMPCOD  = ?
						
      ]]>
		</QRY:Source>
		</QRY:Definition>	
<!--added for CRQ ICRD 16898 -->	
<QRY:Definition>
    <QRY:Id>291</QRY:Id>
    <QRY:Source Name="operations.shipment.findDangerousGoodsOccurrenceDetails " Type="NATIVE">
      <![CDATA[     	
					SELECT DGO.CMPCOD ,
					  DGO.DOCOWRIDR ,
					  DGO.MSTDOCNUM ,
					  DGO.DUPNUM ,
					  DGO.SEQNUM ,
					  DGO.SERNUM ,
					  DGO.UNDNUM ,
					  DGO.PROSHPNAM ,
					  DGO.TECNAM ,
					  DGO.SHPCLS ,
					  DGO.PKGTYP ,
					  DGO.NUMPKG ,
					  DGO.SUBRSK ,
					  DGO.PKGGRP ,
					  DGO.CATCOD ,
					  DGO.NETWGT ,
					  DGO.NETWGTCOD ,
					  DGO.TPTIND ,
					  DGO.OCCTYP ,
					  DGO.OCCDAT ,
					  DGO.ARPCOD ,
					  DGO.TILNUM ,
					  DGO.FLTNUM ,
					  DGO.FLTCARIDR ,
					  DGO.FLTCARCOD,
					  DGO.FLTDAT ,
					  DGO.ACRTYP ,
					  DGO.OPRCOD ,
					  DGO.DEPARP ,
					  DGO.DSTARP ,
					  DGO.ORGARP ,
					  DGO.TELNUM ,
					  DGO.RPTNUM ,
					  DGO.CPLDAT ,
					  DGO.CPTUSRCOD ,
					  DGO.OCCDES ,
					  DGO.SHPADR ,
					  DGO.PKGSPCMRK ,
					  DGO.REFNUM ,
					  DGO.ADLINF ,
					  DGO.RPTREF ,
					  ARL.ARLNAM,
					  ARL.BLGADR,
					  ARL.BLGCNTCOD,
					  ARL.BLGCTYCOD,
					  ARL.BLGSTANAM
					FROM OPRSHPDGROCC DGO
					JOIN SHRARLMST ARL
					   ON ARL.CMPCOD = DGO.CMPCOD 
					   AND ARL.ARLIDR = ? 
					WHERE DGO.CMPCOD  = ?
					   AND DGO.DOCOWRIDR = ? 
					   AND DGO.MSTDOCNUM = ? 
					   AND DGO.DUPNUM = ? 
					   AND DGO.SEQNUM = ? 
					   
      ]]>
    
		</QRY:Source>
		</QRY:Definition>	
		
	<QRY:Definition>
	    <QRY:Id>291</QRY:Id>
	    <QRY:Source Name="operation.shipment.findshipmentdetailsHistoryobjects" Type="OBJECT">
	      <![CDATA[     	


	      SELECT shipmentHistory from
		com.ibsplc.icargo.business.operations.shipment.ShipmentMasterHistory as shipmentHistory
		WHERE

		shipmentHistory.shipmentMasterHistoryPk.companyCode=? and 
		shipmentHistory.shipmentMasterHistoryPk.masterDocumentNumber=? and 
		shipmentHistory.shipmentMasterHistoryPk.ownerId=? and 
		shipmentHistory.shipmentMasterHistoryPk.duplicateNumber=? and 
		shipmentHistory.shipmentMasterHistoryPk.sequenceNumber=?


	      ]]>

		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	    <QRY:Id>292</QRY:Id>
	    <QRY:Source Name="operations.shipment.findactualtruthdetails" Type="NATIVE">
	      <![CDATA[     	
SELECT MST.CMPCOD,
  MST.SHPPFX,
  MST.MSTDOCNUM,
  MST.DOCOWRIDR,
  MST.DUPNUM,
  MST.SEQNUM,
  MST.UBRNUM,
 CASE
    WHEN MST.SHPSTA = 'R'
    THEN 'E'
    WHEN MST.SHPSTA = 'B'
    THEN 'E'
    ELSE MST.SHPSTA
  END SHPSTA,
  MST.ORGCOD,
  MST.DSTCOD,
  MST.SHPCOD,
  MST.CNSCOD,
  MST.CPTDAT,  
  MST.STDDISWGT,
  MST.GRSDISVOL,
  MST.STDWGTCOD,
  MST.GRSVOLUNT,
  'C' LENUNT,
  CASE
    WHEN ((ACP.CMPCOD IS NOT NULL)
    OR (ULDACP.CMPCOD IS NOT NULL))
    THEN 'Y'
    ELSE 'N'
END ACPIND,
 MST.STDPCS,
  MST.STDWGT,
  MST.GRSVOL,
  ACP.ACPPCS,
  ACP.ACPWGT,
  ACP.ACPVOL,
  ULDACP.ACPPCS ULDACPPCS,
  ULDACP.ULDWGT,
  ULDACP.ACPVOL ULDACPVOL,
   ULDACP.ARPCOD ULDARPCOD,
  ULDACP.ULDNUM,
  DIM.PCSLEN,
  DIM.PCSHGT,
  DIM.PCSWID,
  DIM.NUMPCS,
  DIM.PCSVOL,
  DIM.WGT,  
  MST.PRDNAM,
  MST.PRDPRT,
  MST.SCCCOD PRDSCC,
  MIS.trtmod,
  MST.SHPDES,
  RAT.CMDITMNAM, 
  SCCVWS.SCCCOD,
  SCCVWS.ITAIND,
  SCCVWS.RSTBUMTRG,
  MST.AGTCOD,
  MST.AGTNAM,
  NVL(ACC.AGTACCNUM,AGT.ACCNUM) AGTACCNUM,
  CNT.AGTADR AGTADDRESONE,
  CNT.AGTCTY AGTCTYOCD,
  CNT.AGTSTT AGTSTT,
  CNT.AGTCTR AGTCNTCOD,
  CNT.AGTPSTCOD AGTZIPCOD,
  NVL(CNT.AGTADR,AGT.CUSBLGSTR) AGTBLGADR,
  MST.SHPCOD,
  MST.SHPNAM,
  CNT.SHPACCNUM SHPACCNUM,
  MST.SHPADRONE SHPADDRESONE,
  CNT.SHPCTY SHPCTYCOD,
  CNT.SHPSTT SHPSTT,
  CNT.SHPCTR SHPCNTCOD,
  CNT.SHPPSTCOD SHPZIPCOD,
  CNT.SHPTELNUM SHPPHNNUM,
  CNT.SHPMALIDR SHPEMLADR,
  MST.SHPADRONE shpBLGADR,
  mst.CNSCOD,
  mst.CNSNAM,
  CNT.CNSACCNUM CNSACCNUM,
  MST.CNSADRONE CNSADDRESONE,
  cnt.CNSCTY CNSCTYCOD,
  cnt.CNSSTT CNSSTT,
  cnt.CNSCTR CNSCNTCOD,
  cnt.CNSPSTCOD CNSZIPCOD,
  CNT.CNSTELNUM CNSPHNNUM,
  CNT.CNSMALIDR CNSEMLADR,
  MST.CNSADRONE cnsBLGADR,
  rat.RATLINSERNUM RATRATLINSERNUM ,
  MST.CURCOD,
  ACP.ACPIDR,
  DIM.DIMSERNUM,
  DIM.SRC DIMSRC,
  MST.RDYCRGFLG,
  MST.DTACPTFLG,
  shpdtl.ACPFNLFLG,
  shpdtl.APRFLG,
  SRV.SRVCOD PRDSRVCOD,
  acc.TOTARLCHG NETNETCHARGE,
  (acc.VALCCCHG+acc.VALPPCHG) VALUATIONCHARGE,
  acc.PAYMOD MEANSOFPAYMENT,
  MST.PAYTYP PAYMENTTYPE,
  RAT.ARLRATTYP MODEOFCHARGECALCULATION,
  RAT.ARLTRFNAM MARKETRATELINEID,
  RAT.ARLRATLINIDR TECHKEYFORMARKETLINEID,
  MIS.PRMTYP PROMOTIONTYPE,
  MIS.LSTEVLDAT LASTEVALDATE,
  acc.GSCCMS GLOBALSALESCOMMISSION,
  acc.GSCADLCMS ADDITIONALCOMMISSION,
  acc.JNTREV JOINTREVENUE,
  MIS.EVLTYP EVALUATIONTYPE,
  MST.SPTRATIDR QUOTATIONNUMBER,
  MIS.QTNREVNUM QUOTATIONREVISIONNO,
  MIS.SCICOD SPECIALCUSTOMSINDICATOR,
  SHPCNT.CNTTYP CUSTOMERTYPE,
  SHPCNT.CNTVAL CNTVAL,
  SHPCNT.CNTIDR CNTIDR,
  NVL(CNT.AGTSTN,BKGMST.STNCOD) AGTSTN,
  CNT.SHPSTN SHPSTN,
  CNT.CNSSTN CNSSTN
FROM OPRSHPMST MST,
  OPRSHPRATDTL RAT,
  SHRCUSMST AGT,
  OPRSHPSRV SRV,
  OPRSHPACPDTL ACP,
  opruldacpdtl ULDACP,
  OPRSHPMSTMIS MIS,
  oprshpmstacc acc,
  oprshpmstcnt cnt,
  OPRSHPDTL shpdtl,
  OPRSHPCNT SHPCNT,
  CAPBKGMST BKGMST,
  (SELECT dimacp.mstdocnum,
    dimacp.docowridr,
    dimacp.seqnum,
    dimacp.dupnum,
    dimacp.cmpcod,
    dimacp.PCSLEN,
    dimacp.PCSHGT,
    dimacp.PCSWID,
    dimacp.NUMPCS,
    dimacp.PCSVOL,
    dimacp.WGT,
    dimacp.DIMSERNUM,
	'ACP' src
  FROM OPRSHPDIMACP DIMACP
  WHERE EXISTS
				(SELECT 1
					FROM oprshpdtl shpdtl
				WHERE DIMACP.CMPCOD=shpdtl.CMPCOD
		AND DIMACP.MSTDOCNUM =shpdtl.MSTDOCNUM
		AND DIMACP.DOCOWRIDR =shpdtl.DOCOWRIDR
		AND DIMACP.SEQNUM    =shpdtl.SEQNUM
		AND DIMACP.DUPNUM    =shpdtl.DUPNUM
    AND shpdtl.APRFLG ='Y'
		)
  UNION ALL
  SELECT dim.mstdocnum,
    dim.docowridr,
    dim.seqnum,
    dim.dupnum,
    dim.cmpcod,
    DIM.PCSLEN,
    DIM.PCSHGT,
    DIM.PCSWID,
    DIM.NUMPCS,
    DIM.PCSVOL,
    DIM.WGT,
    DIM.DIMSERNUM,
	'SHP' src
  FROM OPRSHPDIMDTL DIM
  WHERE NOT EXISTS
    (SELECT 1
    FROM OPRSHPDIMACP DIMACP
    WHERE DIMACP.CMPCOD  =DIM.CMPCOD
    AND DIMACP.MSTDOCNUM =DIM.MSTDOCNUM
    AND DIMACP.DOCOWRIDR =DIM.DOCOWRIDR
    AND DIMACP.SEQNUM    =DIM.SEQNUM
    AND DIMACP.DUPNUM    =DIM.DUPNUM
    AND EXISTS
				(SELECT 1
					FROM oprshpdtl shpdtl
				WHERE DIMACP.CMPCOD=shpdtl.CMPCOD
		AND DIMACP.MSTDOCNUM =shpdtl.MSTDOCNUM
		AND DIMACP.DOCOWRIDR =shpdtl.DOCOWRIDR
		AND DIMACP.SEQNUM    =shpdtl.SEQNUM
		AND DIMACP.DUPNUM    =shpdtl.DUPNUM
      AND shpdtl.APRFLG ='Y'
		)
    )
  ) DIM,
  (SELECT SHPSCC.CMPCOD,
    SHPSCC.MSTDOCNUM,
    SHPSCC.DOCOWRIDR,
    SHPSCC.DUPNUM,
    SHPSCC.SEQNUM,
    SHPSCC.SCCCOD,
    SCCMST.RSTBUMTRG,
    SCCMST.ITAIND
  FROM 
    (SELECT SUBSTR ( STRING_TO_TOKENIZE , DECODE(LEVEL, 1, 1, INSTR(STRING_TO_TOKENIZE, DELIMITER, 1, LEVEL-1)+1) , INSTR(STRING_TO_TOKENIZE, DELIMITER, 1, LEVEL) - DECODE(LEVEL, 1, 1, INSTR(STRING_TO_TOKENIZE, DELIMITER, 1, LEVEL-1)+1) ) SCCCOD,
      CMPCOD,
      SEQNUM,
      DUPNUM,
      DOCOWRIDR,
      MSTDOCNUM
    FROM
      (SELECT SCCCOD
        ||',' AS STRING_TO_TOKENIZE,
        ','   AS DELIMITER,
        CMPCOD,
        SEQNUM,
        DUPNUM,
        DOCOWRIDR,
        MSTDOCNUM
      FROM OPRSHPMST MST
      WHERE MST.MSTDOCNUM = ?
		AND MST.DOCOWRIDR   = ?
		AND MST.SEQNUM      = ?
		AND MST.DUPNUM 		= ?
		AND MST.CMPCOD      = ?
       )
      CONNECT BY INSTR(STRING_TO_TOKENIZE, DELIMITER, 1, LEVEL)>0
    ) SHPSCC,
    SHRSCCMST SCCMST
  WHERE SHPSCC.SCCCOD=SCCMST.SCCCOD
  AND SHPSCC.CMPCOD  =SCCMST.CMPCOD
  ) SCCVWS
WHERE MST.MSTDOCNUM =MIS.MSTDOCNUM(+)
AND MST.DOCOWRIDR   =MIS.DOCOWRIDR(+)
AND MST.DUPNUM      =MIS.DUPNUM(+)
AND MST.SEQNUM      =MIS.SEQNUM(+)
AND MST.CMPCOD      =MIS.CMPCOD(+)
AND MST.MSTDOCNUM   =ACC.MSTDOCNUM(+)
AND MST.DOCOWRIDR   =ACC.DOCOWRIDR(+)
AND MST.DUPNUM      =ACC.DUPNUM(+)
AND MST.SEQNUM      =ACC.SEQNUM(+)
AND MST.CMPCOD      =ACC.CMPCOD(+)
AND MST.MSTDOCNUM   =CNT.MSTDOCNUM(+)
AND MST.DOCOWRIDR   =CNT.DOCOWRIDR(+)
AND MST.DUPNUM      =CNT.DUPNUM(+)
AND MST.SEQNUM      =CNT.SEQNUM(+)
AND MST.CMPCOD      =CNT.CMPCOD(+)
AND MST.MSTDOCNUM   =DIM.MSTDOCNUM(+)
AND MST.DOCOWRIDR   =DIM.DOCOWRIDR(+)
AND MST.DUPNUM      =DIM.DUPNUM(+)
AND MST.SEQNUM      =DIM.SEQNUM(+)
AND MST.CMPCOD      =DIM.CMPCOD(+)
AND MST.MSTDOCNUM   =ACP.MSTDOCNUM(+)
AND MST.DOCOWRIDR   =ACP.DOCOWRIDR(+)
AND MST.DUPNUM      =ACP.DUPNUM(+)
AND MST.SEQNUM      =ACP.SEQNUM(+)
AND MST.CMPCOD      =ACP.CMPCOD(+)
AND MST.MSTDOCNUM   =RAT.MSTDOCNUM(+)
AND MST.DOCOWRIDR   =RAT.DOCOWRIDR(+)
AND MST.DUPNUM      =RAT.DUPNUM(+)
AND MST.SEQNUM      =RAT.SEQNUM(+)
AND MST.CMPCOD      =RAT.CMPCOD(+)
AND MST.MSTDOCNUM   =SCCVWS.MSTDOCNUM(+)
AND MST.DOCOWRIDR   =SCCVWS.DOCOWRIDR(+)
AND MST.DUPNUM      =SCCVWS.DUPNUM(+)
AND MST.SEQNUM      =SCCVWS.SEQNUM(+)
AND MST.CMPCOD      =SCCVWS.CMPCOD(+)
AND MST.AGTCOD      =AGT.CUSCOD(+)
AND MST.CMPCOD      =AGT.CMPCOD(+)
AND MST.CMPCOD      =shpdtl.CMPCOD(+)
AND MST.MSTDOCNUM   =shpdtl.MSTDOCNUM(+)
AND MST.DOCOWRIDR   =shpdtl.DOCOWRIDR(+)
AND MST.SEQNUM      = shpdtl.SEQNUM(+)
AND MST.DUPNUM      =shpdtl.DUPNUM(+)
AND MST.CMPCOD      =SRV.CMPCOD(+)
AND MST.MSTDOCNUM   =SRV.MSTDOCNUM(+)
AND MST.DOCOWRIDR   =SRV.DOCOWRIDR(+)
AND MST.DUPNUM      =SRV.DUPNUM(+)
AND MST.SEQNUM      =SRV.SEQNUM(+)
AND MST.MSTDOCNUM   =ULDACP.MSTDOCNUM(+)
AND MST.DOCOWRIDR   =ULDACP.DOCOWRIDR(+)
AND MST.DUPNUM      =ULDACP.DUPNUM(+)
AND MST.SEQNUM      =ULDACP.SEQNUM(+)
AND MST.CMPCOD      =ULDACP.CMPCOD(+)
AND MST.MSTDOCNUM = SHPCNT.MSTDOCNUM(+)
AND MST.DOCOWRIDR = SHPCNT.DOCOWRIDR(+)
AND MST.SEQNUM = SHPCNT.SEQNUM(+)
AND MST.CMPCOD = SHPCNT.CMPCOD(+)
AND MST.DUPNUM        = SHPCNT.DUPNUM(+)
AND MST.MSTDOCNUM     = BKGMST.MSTDOCNUM(+)
AND MST.DOCOWRIDR     =BKGMST.DOCOWRIDR(+)
AND MST.DUPNUM        =BKGMST.DUPNUM(+)
AND MST.SEQNUM        =BKGMST.SEQNUM(+)
AND MST.CMPCOD        =BKGMST.CMPCOD(+)
AND BKGMST.BKGSTA(+) <> 'X'
AND SHPCNT.CNTIDR(+) IN ('LV','MP','FX','TE','M')
AND MST.MSTDOCNUM   = ?
AND MST.DOCOWRIDR   = ?
AND MST.SEQNUM      = ?
AND MST.CMPCOD      = ?
	      ]]>
		</QRY:Source>
	</QRY:Definition>
<QRY:Definition>
<QRY:Id>292</QRY:Id>
<QRY:Source Name="operations.shipment.findallshipment" Type="NATIVE">
	<![CDATA[
		SELECT MST.DOCOWRIDR,MST.DUPNUM,MST.SEQNUM,MST.CMPCOD,
	MST.SHPPFX,MST.MSTDOCNUM,MST.DOCTYP,MST.MSTDOCNUM DOCNUM,
	MST.CPTDAT,MST.OWRCOD,MST.CNSCOD,MST.ORGCOD,
	MST.DSTCOD,MST.UBRNUM,MST.SHPTYP,MST.PRGSTA,MST.CONFLG,
	MST.SCCCOD,MST.SHPCOD, 0 PARSEQNUM, MST.LSTUPDTIM, MST.LSTUPDUSR, MST.SHPSTA,MST.AGTCOD
	FROM OPRSHPIDX MST
	WHERE MST.CMPCOD=?
	AND   MST.MSTDOCNUM=?
  
	]]>
</QRY:Source>
</QRY:Definition>	
<QRY:Definition>
<QRY:Id>293</QRY:Id>
<QRY:Source Name="operations.shipment.findallshipments" Type="NATIVE">
	<![CDATA[
		SELECT MST.DOCOWRIDR,MST.DUPNUM ,MST.SEQNUM,MST.CMPCOD,
		IDX.SHPPFX,MST.MSTDOCNUM,MST.DOCTYP,MST.DOCNUM,
		MST.CPTDAT,IDX.OWRCOD,MST.CNSCOD,MST.ORGCOD,
		MST.DSTCOD,MST.UBRNUM,MST.SHPTYP,IDX.PRGSTA, MST.CONFLG,
    MST.SCCCOD,MST.SHPCOD,MST.PARSEQNUM, MST.LSTUPDTIM ,MST.LSTUPDUSR,IDX.SHPSTA,MST.AGTCOD
		FROM OPRSHPIDX IDX JOIN OPRSHPMST  MST
		ON		MST.DOCOWRIDR = IDX.DOCOWRIDR AND
		MST.CMPCOD = IDX.CMPCOD AND
		MST.DUPNUM = IDX.DUPNUM AND
		MST.MSTDOCNUM = IDX.MSTDOCNUM 
		WHERE MST.CMPCOD=? 
	]]>
</QRY:Source>
</QRY:Definition>	
<QRY:Definition>
	 <QRY:Id>294</QRY:Id>
	 <QRY:Source Name="operations.shipment.cto.findfsufohdetails" Type="NATIVE">
		<![CDATA[
		SELECT MST.DOMFLG,MST.MSTDOCNUM, MST.DOCOWRIDR, MST.DUPNUM, MST.SEQNUM, MST.CMPCOD, MST.SHPPFX, MST.STDPCS, MST.STDWGT,
	       MST.ORGCOD, MST.DSTCOD, MST.AGTCOD, AGTGRP.GRPNAM AGTGRP, MST.SHPCOD, CUSMST.CUSGRP SHPGRP,
	       DECODE(DTL.TOTACPPCS,0,ARPSHP.ACPPCS,DTL.TOTACPPCS) TOTACPPCS,
		   DECODE(DTL.TOTACPWGT,0,ARPSHP.ACPWGT,DTL.TOTACPWGT) TOTACPWGT,
		   DTL.TOTACPVOL,
		   CASE MST.GRSVOLUNT
               WHEN 'B'
                       THEN 'MC'
               WHEN 'I'
                       THEN 'CI'
               WHEN 'C'
                       THEN 'CC'
               WHEN 'F'
                       THEN 'CF'
               ELSE MST.GRSVOLUNT
				END GRSVOLUNT,
				COALESCE(DTL.ACPARPCOD,ARPSHP.ARPCOD) ACPARPCOD, DTL.ACPDAT, DTL.ACPUSR, SYS.PARVAL WGTCOD, MST.OWRCOD, MIS.STACOD, MIS.MSGSEQNUM,MIS.JNVPAR, 
				MIS.MSGTYP,SHPRTG.DSTCOD RTGCNT,  SHRMST.CNTCOD
			FROM OPRSHPMST MST, OPRSHPDTL DTL, SHRSYSPAR SYS, OPRSHPMSTMIS MIS, SHRCUSMST CUSMST,
	       SHRGENMSTGRPDTL AGTGRP, OPRARPSHP ARPSHP,OPRSHPRTG SHPRTG,SHRARPMST SHRMST
	 WHERE MST.MSTDOCNUM = DTL.MSTDOCNUM
	   AND MST.DOCOWRIDR = DTL.DOCOWRIDR
	   AND MST.DUPNUM = DTL.DUPNUM
	   AND MST.SEQNUM = DTL.SEQNUM
	   AND MST.CMPCOD = DTL.CMPCOD
	   AND MST.MSTDOCNUM (+)= MIS.MSTDOCNUM
       AND MST.DOCOWRIDR (+)= MIS.DOCOWRIDR
       AND MST.DUPNUM (+)= MIS.DUPNUM
       AND MST.SEQNUM (+)= MIS.SEQNUM
       AND MST.CMPCOD (+)= MIS.CMPCOD
	   AND MST.CMPCOD = SYS.CMPCOD
	   AND MST.CMPCOD = CUSMST.CMPCOD(+)
	   AND MST.SHPCOD = CUSMST.CUSCOD(+)
	   AND MST.CMPCOD = AGTGRP.CMPCOD(+)
	   AND MST.AGTCOD = AGTGRP.GRPENT(+)
	   AND MST.CMPCOD = ARPSHP.CMPCOD(+)
	   AND MST.MSTDOCNUM = ARPSHP.MSTDOCNUM(+)
       AND MST.DOCOWRIDR = ARPSHP.DOCOWRIDR(+)
       AND MST.DUPNUM = ARPSHP.DUPNUM(+)
       AND MST.SEQNUM = ARPSHP.SEQNUM(+)
       AND AGTGRP.GRPCATCOD(+) = 'GEN'
        AND MST.MSTDOCNUM 		= SHPRTG.MSTDOCNUM(+)
		AND MST.DOCOWRIDR 		= SHPRTG.DOCOWRIDR(+)
		AND MST.DUPNUM 		 	= SHPRTG.DUPNUM(+)
		AND MST.SEQNUM 		 	= SHPRTG.SEQNUM(+)
		AND MST.CMPCOD 		 	= SHPRTG.CMPCOD(+)
		  AND MST.CMPCOD      = SHRMST.CMPCOD(+)
  AND MST.ORGCOD      =  SHRMST.ARPCOD(+)
	   AND MST.MSTDOCNUM = ?
	   AND MST.DOCOWRIDR = ?
	   AND MST.DUPNUM = ?
	   AND MST.SEQNUM = ?
	   AND MST.CMPCOD = ?
	   AND SYS.PARCOD = ?
	]]>
</QRY:Source>
</QRY:Definition>	

<QRY:Definition>
    <QRY:Id>295</QRY:Id>
    <QRY:Source Name="operations.shipment.findshipmentparametersforchecksheet" Type="NATIVE">
      <![CDATA[     	
SELECT MST.CMPCOD,
  MST.MSTDOCNUM,
  MST.DOCOWRIDR,
  MST.DUPNUM,
  MST.SEQNUM,
  MST.UBRNUM,
  MST.SHPCOD,
  MST.SHPNAM,
  (select (CASE WHEN KSHP > 0 THEN 'Y' ELSE 'N' END) 
from 
(select count(*) as KSHP from SHRCUSCFT WHERE CUSCOD=? and SYSDATE between VLDSTRDAT and VLDENDDAT and CFTTYP='KSH')) as KNWSHP,
  MST.SCCCOD,
  MST.SHPPFX,
  PARGRP.GRPNAM SCCGRPNAM,
  MST.STDPCS,
  MST.STDDISWGT,
  MST.ORGCOD,
  MST.DSTCOD,
  MST.PRDNAM,
  MST.GRSDISVOL,
  MST.STDWGTCOD,
  MST.GRSVOLUNT,
  BKGFLTDTL.FLTCARCOD BKGFLTCARCOD,
  BKGFLTDTL.FLTNUM BKGFLTNUM,
  BKGFLTDTL.FLTDAT BKGFLTDAT,
  BKGFLTDTL.ACRTYPCOD,
  (SELECT RTRIM ( XMLAGG (XMLELEMENT (e, DSTCOD
    || ',') ).extract ('//text()'), ',')
  FROM OPRSHPRTG FLT
  WHERE MST.DOCOWRIDR = FLT.DOCOWRIDR
  AND MST.MSTDOCNUM   = FLT.MSTDOCNUM
  AND MST.DUPNUM      = FLT.DUPNUM
  AND MST.SEQNUM      = FLT.SEQNUM
  AND MST.CMPCOD      = FLT.CMPCOD
  ) RTGDSTCOD,
  ADLSCCGRPDTL.SCCCOD MSTSCCCOD,
  ADLSCCGRPDTL.GRPNAM MSTSCCGRPNAM,
  CMDGRPDTL.CMDITMNAM,
  CMDGRPDTL.GRPNAM CMDGRPNAM  ,
  ARPGRPDTL.GRPNAM ARPGRPNAM,
  ARPGRPDTL.GRPENT ARPCOD
FROM OPRSHPMST MST,
  CAPBKGFLTDTL BKGFLTDTL,
  SHRCUSMST CUS,
  SHRGENMSTGRPDTL PARGRP,
  (SELECT MST.CMPCOD,
    MST.DOCOWRIDR,
    MST.MSTDOCNUM,
    MST.DUPNUM,
    MST.SEQNUM,
    MST.SCCCOD,
    GRP.GRPNAM
FROM OPRSHPMST MST,(SELECT  SUBSTR
         ( STRING_TO_TOKENIZE
         , DECODE(LEVEL, 1, 1, INSTR(STRING_TO_TOKENIZE, DELIMITER, 1, LEVEL-1)+1)
         , INSTR(STRING_TO_TOKENIZE, DELIMITER, 1, LEVEL) -
           DECODE(LEVEL, 1, 1, INSTR(STRING_TO_TOKENIZE, DELIMITER, 1, LEVEL-1)+1)
         ) SCCCOD,CMPCOD
  FROM ( SELECT SCCCOD||',' AS STRING_TO_TOKENIZE, ','  AS DELIMITER,CMPCOD
        FROM OPRSHPMST  MST 
		WHERE MST.CMPCOD   = ?
		AND MST.DOCOWRIDR      = ?
		AND MST.MSTDOCNUM      = ?
		AND MST.DUPNUM         = ?
		AND MST.SEQNUM         = ?
       )
	CONNECT BY INSTR(STRING_TO_TOKENIZE, DELIMITER, 1, LEVEL)>0) MSTSCC,
    SHRGENMSTGRPDTL GRP
  WHERE GRP.GRPTYP(+) = 'SCCGRP'
  AND GRP.GRPCATCOD(+) = 'CHKSHT'
  AND MSTSCC.CMPCOD      = GRP.CMPCOD(+)
  AND MSTSCC.SCCCOD      = GRP.GRPENT(+)
  ) ADLSCCGRPDTL,
  (SELECT MST.CMPCOD,
    MST.DOCOWRIDR,
    MST.MSTDOCNUM,
    MST.DUPNUM,
    MST.SEQNUM,
    RATDTL.CMDITMNAM,
    GRP.GRPNAM
  FROM OPRSHPMST MST,
    OPRSHPRATDTL RATDTL ,
    SHRGENMSTGRPDTL GRP
  WHERE GRP.GRPTYP(+)  = 'CMYGRP'
  AND GRP.GRPCATCOD(+) = 'CHKSHT'
  AND MST.CMPCOD       = RATDTL.CMPCOD(+)
  AND MST.DOCOWRIDR    = RATDTL.DOCOWRIDR(+)
  AND MST.MSTDOCNUM    = RATDTL.MSTDOCNUM(+)
  AND MST.DUPNUM       = RATDTL.DUPNUM(+)
  AND MST.SEQNUM       = RATDTL.SEQNUM(+)
  AND RATDTL.CMPCOD      = GRP.CMPCOD(+)
  AND RATDTL.CMDITMNAM = GRP.GRPENT(+)
  ) CMDGRPDTL  ,
 (
 SELECT DTL.GRPNAM,
				  DTL.GRPTYP,
				  DTL.GRPENT,
				  DTL.CMPCOD
				FROM SHRGENMSTGRPDTL DTL,
				    SHRGENMSTGRP MST
				WHERE MST.CMPCOD = DTL.CMPCOD(+)
				  AND MST.GRPTYP = DTL.GRPTYP(+)
				  AND MST.GRPCATCOD = DTL.GRPCATCOD(+)
				  AND MST.GRPNAM = DTL.GRPNAM(+)
				  AND DTL.GRPTYP(+)   = 'ARPGRP'
				  AND DTL.GRPCATCOD(+) = 'CHKSHT'
				  AND DTL.GRPENT(+)  = ? 
) ARPGRPDTL
WHERE MST.CMPCOD         = ADLSCCGRPDTL.CMPCOD(+)
AND MST.DOCOWRIDR      = ADLSCCGRPDTL.DOCOWRIDR(+)
AND MST.MSTDOCNUM      = ADLSCCGRPDTL.MSTDOCNUM(+)
AND MST.DUPNUM         = ADLSCCGRPDTL.DUPNUM(+)
AND MST.SEQNUM         = ADLSCCGRPDTL.SEQNUM(+)
AND MST.CMPCOD         = CMDGRPDTL.CMPCOD(+)
AND MST.DOCOWRIDR      = CMDGRPDTL.DOCOWRIDR(+)
AND MST.MSTDOCNUM      = CMDGRPDTL.MSTDOCNUM(+)
AND MST.DUPNUM         = CMDGRPDTL.DUPNUM(+)
AND MST.SEQNUM         = CMDGRPDTL.SEQNUM(+)
AND MST.UBRNUM         = BKGFLTDTL.UBRNUM(+)
AND MST.CMPCOD         = BKGFLTDTL.CMPCOD(+)
AND MST.CMPCOD         = CUS.CMPCOD(+)
AND MST.SHPCOD         = CUS.CUSCOD(+)
AND MST.CMPCOD      = PARGRP.CMPCOD(+)
AND MST.SCCCOD      = PARGRP.GRPENT(+)
AND PARGRP.GRPTYP(+) = 'SCCGRP'
AND PARGRP.GRPCATCOD(+) = 'CHKSHT'
AND ARPGRPDTL.CMPCOD (+) = MST.CMPCOD
AND ARPGRPDTL.GRPENT(+) = ?
AND MST.CMPCOD         = ?
AND MST.DOCOWRIDR      = ?
AND MST.MSTDOCNUM      = ?
AND MST.DUPNUM         = ?
AND MST.SEQNUM         = ?
      ]]>
    
		</QRY:Source>
		</QRY:Definition>		
	
<QRY:Definition>
  <QRY:Id>296</QRY:Id>
    <QRY:Source Name="operations.shipment.findirregularitydetails" Type="NATIVE">
      <![CDATA[ 		
	
SELECT MST.SHPPFX,DTL.CMPCOD,
  DTL.UBRNUM,
  DTL.DOCOWRIDR,
  CASE DTL.MSTDOCNUM
  WHEN  '00000000'
  THEN NULL 
  ELSE DTL.MSTDOCNUM
  END MSTDOCNUM,
  DTL.DUPNUM,
  DTL.SEQNUM,
  DTL.IRRCOD,
  IRRMST.IRRDES,
  DTL.SERNUM,
  DTL.TXNCOD,
  DTL.ARPCOD,
  DTL.OCCTIM,
  DTL.RMK,
  DTL.RSLSTA,
  DTL.TXNREFONE,
  DTL.TXNREFTWO,
  DTL.TXNREFTHR,
  DTL.TXNREFFOR,
  DTL.TXNREFFIV,
  DTL.TXNREFSIX,
  DTL.TXNREFSEV,
  DTL.TXNREFEGT,
  DTL.TXNREFNIN,
  DTL.TXNREFTEN,
  DTL.LSTUPDTIM,
  DTL.LSTUPDUSR,
  DTL.FLTNUM,
  DTL.FLTCARCOD,
  DTL.FLTDAT,
  DTL.IRRPCS,
  DTL.IRRWGT,
  MST.CPTDAT,
  DTL.ULDNUM,
  DTL.TOKNUM,
  MST.DOCNUM
  
			FROM OPRSHPIRRDTL DTL
			LEFT OUTER JOIN OPRSHPMST MST
			ON DTL.CMPCOD = MST.CMPCOD
			AND DTL.DOCOWRIDR = MST.DOCOWRIDR
			AND DTL.MSTDOCNUM = MST.MSTDOCNUM
			AND DTL.DUPNUM = MST.DUPNUM
			AND DTL.SEQNUM = MST.SEQNUM
			INNER JOIN SHRIRRMST IRRMST
			ON  DTL.CMPCOD = IRRMST.CMPCOD
			AND DTL.TXNCOD = IRRMST.TXNCOD
			AND DTL.IRRCOD = IRRMST.IRRCOD
			AND DTL.CMPCOD = ?
			AND NVL(DTL.RSLSTA ,1)!= 'D'
	
			]]>
    
		</QRY:Source>
		</QRY:Definition>	
		<QRY:Definition>
  <QRY:Id>297</QRY:Id>
    <QRY:Source Name="operations.shipment.cto.findfsudisirregularitydetails" Type="NATIVE">
      <![CDATA[ 		
	
		SELECT  MST.MSTDOCNUM,MST.DOCOWRIDR,
		  MST.DUPNUM,MST.SEQNUM, MST.CMPCOD,
		  MST.SHPPFX,MST.OWRCOD, MST.STDPCS,
		  MST.STDWGT, MST.ORGCOD, MST.DSTCOD,
		  MST.AGTCOD,IRDTL.ARPCOD,IRDTL.OCCTIM, IRDTL.IRRCOD,SHPRTG.DSTCOD RTGCNT, IRDTL.TXNREFTLV AS FLTNUM,
		  IRDTL.TXNREFELV AS FLTCARCOD, IRDTL.TXNREFTTN AS FLTDAT, IRDTL.IRRPCS, IRDTL.IRRWGT, MIS.JNVPAR,
		  MST.AGTCOD,SHRMST.CNTCOD
		FROM OPRSHPMST MST,OPRSHPIRRDTL IRDTL,OPRSHPRTG SHPRTG,OPRSHPMSTMIS MIS,SHRARPMST SHRMST
		WHERE MST.MSTDOCNUM = IRDTL.MSTDOCNUM
			AND MST.DOCOWRIDR = IRDTL.DOCOWRIDR
			AND MST.DUPNUM = IRDTL.DUPNUM
			AND MST.SEQNUM = IRDTL.SEQNUM
			AND MST.CMPCOD = IRDTL.CMPCOD
			AND MST.MSTDOCNUM 		= SHPRTG.MSTDOCNUM(+)
			AND MST.DOCOWRIDR 		= SHPRTG.DOCOWRIDR(+)
			AND MST.DUPNUM 		 	= SHPRTG.DUPNUM(+)
			AND MST.SEQNUM 		 	= SHPRTG.SEQNUM(+)
			AND MST.CMPCOD 		 	= SHPRTG.CMPCOD(+)
			AND MST.MSTDOCNUM =MIS.MSTDOCNUM(+)
				AND MST.DOCOWRIDR   =MIS.DOCOWRIDR(+)
				AND MST.DUPNUM      =MIS.DUPNUM(+)
				AND MST.SEQNUM      =MIS.SEQNUM(+)
				AND MST.CMPCOD      =MIS.CMPCOD(+)
				 AND MST.CMPCOD      = SHRMST.CMPCOD(+)
				AND MST.ORGCOD      =  SHRMST.ARPCOD(+)
			AND IRDTL.MSTDOCNUM = ?
			AND IRDTL.DOCOWRIDR = ?
			AND IRDTL.DUPNUM = ?
			AND IRDTL.SEQNUM = ?
			AND IRDTL.CMPCOD = ?    
			AND NVL(IRDTL.RSLSTA ,1)!= 'D' 
	
			]]>
    
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	    <QRY:Id>298</QRY:Id>
	    <QRY:Source Name="operation.shipment.findshipmentirregularitydetails" Type="OBJECT">
	      <![CDATA[     	


	      SELECT shipmentIrregularity from
		com.ibsplc.icargo.business.operations.shipment.cto.ShipmentIrregularity as shipmentIrregularity
		WHERE

		shipmentIrregularity.shipmentIrregularityPK.companyCode=? 		
	
			]]>
    
		</QRY:Source>
		</QRY:Definition>
		
		<QRY:Definition>
  <QRY:Id>298</QRY:Id>
    <QRY:Source Name="operations.shipment.findCargoReceiptDetails" Type="NATIVE">
      <![CDATA[ 		
	
		 SELECT SHPMST.CMPCOD, SHPMST.DOCOWRIDR, SHPMST.MSTDOCNUM, SHPMST.DUPNUM, SHPMST.SEQNUM, 
  SHPMST.SHPPFX, SHPMST.EXEFLG, SHPMST.EXEDAT, SHPMST.SHPCOD, SHPMST.SHPNAM, SHPMST.ORGCOD, 
  SHPMST.DSTCOD, SHPMST.RDYCRGFLG, ARLMST.ARLNAM, COALESCE(SHPACPDTL.ARPCOD,ULDACPDTL.ARPCOD) ARPCOD, SRN.SRNNUM, NVL(SRN.SRNPCS,0) SRNPCS, NVL(SRN.SRNWGT,0) SRNWGT, SHPACPDTL.ACPPCS, 
  SHPACPDTL.ACPWGT, SHPACPDTL.ACPDISWGT, SHPACPDTL.ACPVOL, SHPACPDTL.ACPDISVOL, SHPACPDTL.ACPWGTCOD, 
  SHPACPDTL.ACPVOLCOD, SHPACPDTL.ACPIDR, ULDACPDTL.ACPPCS ULDPCS, ULDACPDTL.ULDWGT, ULDACPDTL.ULDDISWGT, ULDACPDTL.ACPVOL ULDVOL, 
  ULDACPDTL.ACPDISVOL ULDDISVOL, ULDACPDTL.ULDWGTCOD, ULDACPDTL.ACPVOLCOD ULDVOLCOD, ULDACPDTL.ULDNUM, SHPRTG.DSTCOD RTGARPCOD, 
  SHPRTG.RTGSERNUM, SHPHIS.TXNCOD, SHPHIS.TXNDAT, SHPHIS.SERNUM, SHPHIS.TXNREFNUM 
FROM OPRSHPMST SHPMST 
INNER JOIN SHRARLMST ARLMST 
ON SHPMST.CMPCOD = ARLMST.CMPCOD 
AND SHPMST.DOCOWRIDR = ARLMST.ARLIDR 
INNER JOIN OPRSHPRTG SHPRTG 
ON SHPRTG.CMPCOD = SHPMST.CMPCOD 
AND SHPRTG.DOCOWRIDR = SHPMST.DOCOWRIDR 
AND SHPRTG.MSTDOCNUM = SHPMST.MSTDOCNUM 
AND SHPRTG.DUPNUM = SHPMST.DUPNUM 
AND SHPRTG.SEQNUM = SHPMST.SEQNUM 
INNER JOIN OPRSHPHIS SHPHIS 
ON SHPHIS.CMPCOD = SHPMST.CMPCOD 
AND SHPHIS.DOCOWRIDR = SHPMST.DOCOWRIDR 
AND SHPHIS.MSTDOCNUM = SHPMST.MSTDOCNUM 
AND SHPHIS.DUPNUM = SHPMST.DUPNUM 
AND SHPHIS.SEQNUM = SHPMST.SEQNUM 
LEFT OUTER JOIN OPRSHPACPDTL SHPACPDTL 
ON SHPACPDTL.CMPCOD = SHPMST.CMPCOD 
AND SHPACPDTL.DOCOWRIDR = SHPMST.DOCOWRIDR 
AND SHPACPDTL.MSTDOCNUM = SHPMST.MSTDOCNUM 
AND SHPACPDTL.DUPNUM = SHPMST.DUPNUM 
AND SHPACPDTL.SEQNUM = SHPMST.SEQNUM 
LEFT OUTER JOIN OPRULDACPDTL ULDACPDTL 
ON ULDACPDTL.CMPCOD = SHPMST.CMPCOD 
AND ULDACPDTL.DOCOWRIDR = SHPMST.DOCOWRIDR 
AND ULDACPDTL.MSTDOCNUM = SHPMST.MSTDOCNUM 
AND ULDACPDTL.DUPNUM = SHPMST.DUPNUM 
AND ULDACPDTL.SEQNUM = SHPMST.SEQNUM 
LEFT OUTER JOIN OPRSHPSRN SRN 
ON SRN.CMPCOD = SHPMST.CMPCOD 
AND SRN.DOCOWRIDR = SHPMST.DOCOWRIDR 
AND SRN.MSTDOCNUM = SHPMST.MSTDOCNUM 
AND SRN.DUPNUM = SHPMST.DUPNUM 
AND SRN.SEQNUM = SHPMST.SEQNUM 
AND SRN.ARPCOD = COALESCE(SHPACPDTL.ARPCOD,ULDACPDTL.ARPCOD)
WHERE SHPMST.CMPCOD = ? 
AND SHPMST.DOCOWRIDR = ? 
AND SHPMST.MSTDOCNUM = ? 
AND SHPMST.DUPNUM = ? 
AND SHPMST.SEQNUM = ? 
 
	
			]]>
    
		</QRY:Source>
		</QRY:Definition>
		
		<QRY:Definition>
  <QRY:Id>299</QRY:Id>
    <QRY:Source Name="operations.shipment.findCargoReceiptDetailswithversion" Type="NATIVE">
      <![CDATA[ 		
	
		 SELECT SHPMSTHIS.CMPCOD, SHPMSTHIS.DOCOWRIDR, SHPMSTHIS.MSTDOCNUM, SHPMSTHIS.DUPNUM, SHPMSTHIS.SEQNUM, 
  SHPMSTHIS.SHPPFX, SHPMSTHIS.EXEFLG, SHPMSTHIS.EXEDAT, SHPMSTHIS.SHPCOD, SHPMSTHIS.SHPNAM, SHPMSTHIS.ORGCOD, 
  SHPMSTHIS.DSTCOD, SHPMSTHIS.VERNUM, SHPMSTHIS.RDYCRGFLG, ARLMST.ARLNAM, COALESCE(SHPACPDTL.ARPCOD,ULDACPDTL.ARPCOD) ARPCOD, SHPACPDTL.ACPPCS, SHPACPDTL.ACPWGT, SHPACPDTL.ACPDISWGT, SHPACPDTL.ACPVOL, SHPACPDTL.ACPDISVOL, SHPACPDTL.ACPWGTCOD, 
  SHPACPDTL.ACPVOLCOD, SHPACPDTL.ACPIDR, ULDACPDTL.ACPPCS ULDPCS, ULDACPDTL.ULDWGT, ULDACPDTL.ULDDISWGT, ULDACPDTL.ACPVOL ULDVOL, 
  ULDACPDTL.ACPDISVOL ULDDISVOL, ULDACPDTL.ULDWGTCOD, ULDACPDTL.ACPVOLCOD ULDVOLCOD, ULDACPDTL.ULDNUM, SHPRTG.DSTCOD RTGARPCOD, 
  SHPRTG.RTGSERNUM, SHPHIS.TXNCOD, SHPHIS.TXNDAT, SHPHIS.SERNUM, SHPHIS.TXNREFNUM 
FROM OPRSHPMSTHIS SHPMSTHIS 
INNER JOIN SHRARLMST ARLMST 
ON SHPMSTHIS.CMPCOD = ARLMST.CMPCOD 
AND SHPMSTHIS.DOCOWRIDR = ARLMST.ARLIDR 
INNER JOIN OPRSHPRTG SHPRTG 
ON SHPRTG.CMPCOD = SHPMSTHIS.CMPCOD 
AND SHPRTG.DOCOWRIDR = SHPMSTHIS.DOCOWRIDR 
AND SHPRTG.MSTDOCNUM = SHPMSTHIS.MSTDOCNUM 
AND SHPRTG.DUPNUM = SHPMSTHIS.DUPNUM 
AND SHPRTG.SEQNUM = SHPMSTHIS.SEQNUM 
INNER JOIN OPRSHPHIS SHPHIS 
ON SHPHIS.CMPCOD = SHPMSTHIS.CMPCOD 
AND SHPHIS.DOCOWRIDR = SHPMSTHIS.DOCOWRIDR 
AND SHPHIS.MSTDOCNUM = SHPMSTHIS.MSTDOCNUM 
AND SHPHIS.DUPNUM = SHPMSTHIS.DUPNUM 
AND SHPHIS.SEQNUM = SHPMSTHIS.SEQNUM 
LEFT OUTER JOIN OPRSHPACPDTL SHPACPDTL 
ON SHPACPDTL.CMPCOD = SHPMSTHIS.CMPCOD 
AND SHPACPDTL.ARPCOD = SHPMSTHIS.ORGCOD 
AND SHPACPDTL.DOCOWRIDR = SHPMSTHIS.DOCOWRIDR 
AND SHPACPDTL.MSTDOCNUM = SHPMSTHIS.MSTDOCNUM 
AND SHPACPDTL.DUPNUM = SHPMSTHIS.DUPNUM 
AND SHPACPDTL.SEQNUM = SHPMSTHIS.SEQNUM 
LEFT OUTER JOIN OPRULDACPDTL ULDACPDTL 
ON ULDACPDTL.CMPCOD = SHPMSTHIS.CMPCOD 
AND ULDACPDTL.ARPCOD = SHPMSTHIS.ORGCOD 
AND ULDACPDTL.DOCOWRIDR = SHPMSTHIS.DOCOWRIDR 
AND ULDACPDTL.MSTDOCNUM = SHPMSTHIS.MSTDOCNUM 
AND ULDACPDTL.DUPNUM = SHPMSTHIS.DUPNUM 
AND ULDACPDTL.SEQNUM = SHPMSTHIS.SEQNUM 
WHERE SHPMSTHIS.CMPCOD = ? 
AND SHPMSTHIS.DOCOWRIDR = ? 
AND SHPMSTHIS.MSTDOCNUM = ? 
AND SHPMSTHIS.DUPNUM = ? 
AND SHPMSTHIS.SEQNUM = ? 
AND SHPMSTHIS.VERNUM = ? 
  
	
			]]>
    
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>300</QRY:Id>
		<QRY:Source Name="operations.shipment.findbuildupinfoforawb" Type="NATIVE"> 
			<![CDATA[
			SELECT SEG.FLTNUM,SEG.FLTSEQNUM,SEG.SEGSERNUM,SEG.FLTCARIDR,
				SEG.BDPPCS,SEG.BDPWGT,SEG.BDPVOL,
			   SHPDTL.AUTBDP, SHPDTL.AUTACP,SHPDTL.EXEPAYADVNUM
			FROM  OPRSEGSHP SEG  ,OPRSHPDTL SHPDTL
			WHERE
			     SHPDTL.MSTDOCNUM = SEG.MSTDOCNUM (+)
			   AND SHPDTL.DUPNUM = SEG.DUPNUM (+)
			   AND SHPDTL.DOCOWRIDR = SEG.DOCOWRIDR (+)
			   AND SHPDTL.SEQNUM = SEG.SEQNUM (+)
			   AND SHPDTL.CMPCOD = SEG.CMPCOD	(+)	   
			   AND SHPDTL.MSTDOCNUM = ?
			   AND SHPDTL.DUPNUM = ?
			   AND SHPDTL.DOCOWRIDR = ?
			   AND SHPDTL.SEQNUM = ?
			   AND SHPDTL.CMPCOD = ?
			   
			  
		]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
  <QRY:Id>300</QRY:Id>
    <QRY:Source Name="operations.shipment.findshipmentacpdet" Type="NATIVE">
    <![CDATA[ 		
	select ARPSHP.ACPPCS TOTACPPCS, ARPSHP.ACPWGT TOTACPWGT,SHPDTL.APRFLG, SHPDTL.ACPDAT,COALESCE(SHPDTL.ACPARPCOD,ARPSHP.ARPCOD) ACPARPCOD,
	ARPSHP.ACPVOL TOTACPVOL,SHPMST.RDYCRGFLG RDYCRGFLG,SHPDTL.ACPFNLFLG ACPFNLFLG,SHPMST.ORGCOD, SHPMST.STDPCS, SHPMST.STDWGT, SHPMST.GRSVOL STDVOL, ARPSHP.TMPSTGFLG 
	from OPRSHPMST SHPMST inner join OPRSHPDTL SHPDTL 
	on SHPMST.CMPCOD = SHPDTL.CMPCOD 
	 and SHPMST.DOCOWRIDR = SHPDTL.DOCOWRIDR
	 and SHPMST.DUPNUM = SHPDTL.DUPNUM
	 and SHPMST.SEQNUM = SHPDTL.SEQNUM
	 and SHPMST.MSTDOCNUM = SHPDTL.MSTDOCNUM 
	 inner join OPRARPSHP ARPSHP 
	on SHPDTL.CMPCOD = ARPSHP.CMPCOD 
	 and SHPDTL.DOCOWRIDR = ARPSHP.DOCOWRIDR
	 and SHPDTL.DUPNUM = ARPSHP.DUPNUM
	 and SHPDTL.SEQNUM = ARPSHP.SEQNUM
	 and SHPDTL.MSTDOCNUM = ARPSHP.MSTDOCNUM 
	 and ARPSHP.ACPPCS > 0 
	where SHPDTL.MSTDOCNUM = ? AND SHPDTL.DOCOWRIDR = ? AND SHPDTL.DUPNUM = ? AND SHPDTL.SEQNUM = ? AND SHPDTL.CMPCOD = ?
  	]]>
		</QRY:Source>
	</QRY:Definition>
	
	<QRY:Definition>
	 <QRY:Id>301</QRY:Id>
	 <QRY:Source Name="operations.shipment.findReleaseBlocks" Type="NATIVE">
	 	<![CDATA[
			SELECT RELMST.CMPCOD,
				RELMST.BLKTYP,
				RELMST.TXNCOD,
				RELMST.SERNUM,
				RELMST.BLKSERNUM,
				RELMST.BLKRELSTR,
				RELMST.VALCLSNAM,
				RELMST.LSTUPDTIM,
				RELMST.LSTUPDUSR,
				RELPAR.PARCOD,
				RELPAR.PARVAL,
				RELPAR.EXCFLG,
				RELPAR.LSTUPDTIM PARLSTUPDTIM,
				RELPAR.LSTUPDUSR PARLSTUPDUSR
			  FROM 
			  OPRBLKRELMST RELMST 
			  LEFT OUTER JOIN OPRBLKRELPAR RELPAR
			  ON RELMST.CMPCOD       = RELPAR.CMPCOD
			  AND RELMST.BLKTYP      = RELPAR.BLKTYP
			  AND RELMST.SERNUM      = RELPAR.SERNUM
			  
			WHERE 
				RELMST.CMPCOD = ?
			
		]]>
	 </QRY:Source>
	</QRY:Definition>

	<!-- Added by A-5173 for ICRD-20782 Starts-->
	<QRY:Definition>
		<QRY:Id>301</QRY:Id>
		<QRY:Source Name="operations.shipment.listShipmentHistoryForLifeCycle" Type="NATIVE">
			<![CDATA[
			
			SELECT HIS.CMPCOD,
			  HIS.DOCOWRIDR,
			  HIS.MSTDOCNUM,
			  HIS.DUPNUM,
			  HIS.SEQNUM,
			  HIS.SERNUM,
			  HIS.ARPCOD,
			  HIS.TXNCOD,
			  HIS.TXNDAT,
			  HIS.TXNDATUTC,
			  HIS.TXNDES,
			  HIS.TXNPCS,
			  HIS.TXNWGT,
			  HIS.TXNVOL,
			  HIS.TXNREFONE,
			  HIS.TXNREFTWO,
			  HIS.TXNREFTHR,
			  HIS.TXNREFFOR,
			  HIS.TXNREFFIV,
			  HIS.TXNREFSIX,
			  HIS.TXNREFSEV,
			  HIS.TXNREFEGT,
			  HIS.TXNREFTEN,
			  HIS.SRCIND,
			  HIS.LSTUPDTIM,
			  HIS.LSTUPDUSR,
			  MST.DSTCOD,
			  MST.AGTCOD,
			  MST.ORGCOD,
			  MST.EXEDAT,
			  MST.SHPPFX,
			  MST.IATCOD,
			  HIS.TXNREFTTN,
			  COALESCE(MST.STDPCS, HIS.TXNPCS) STDPCS
			FROM OPRSHPHIS HIS,
			(
			SELECT * FROM (
			   SELECT MSTHIS.CMPCOD,
				MSTHIS.DOCOWRIDR,
				MSTHIS.MSTDOCNUM,
				MSTHIS.DUPNUM,
				MSTHIS.SEQNUM,
				MSTHIS.VERNUM,
				MSTHIS.DSTCOD,
				MSTHIS.STDPCS,
				MSTHIS.AGTCOD,MSTHIS.ORGCOD,NVL(MSTHIS.EXEDAT,MSTHIS.CPTDAT) EXEDAT,MSTHIS.SHPPFX,ACC.IATCOD,
				MAX (MSTHIS.VERNUM) OVER (PARTITION BY MSTHIS.CMPCOD, MSTHIS.DOCOWRIDR, MSTHIS.MSTDOCNUM, MSTHIS.DUPNUM, MSTHIS.SEQNUM) MAXVERNUM
				FROM oprshpmsthis MSTHIS
				
				JOIN OPRSHPMSTACCHIS ACC ON
								MSTHIS.CMPCOD     = ACC.CMPCOD
								AND MSTHIS.DOCOWRIDR = ACC.DOCOWRIDR
								AND MSTHIS.MSTDOCNUM = ACC.MSTDOCNUM
								AND MSTHIS.DUPNUM = ACC.DUPNUM
								AND MSTHIS.SEQNUM = ACC.SEQNUM
								AND MSTHIS.VERNUM = ACC.VERNUM
								 
				WHERE MSTHIS.CMPCOD  = ?
				AND MSTHIS.DOCOWRIDR = ?
				AND MSTHIS.MSTDOCNUM = ?
				AND MSTHIS.DUPNUM    = ?
				AND MSTHIS.SEQNUM    = ?  
				)  WHERE VERNUM = MAXVERNUM 
			) MST
			WHERE HIS.CMPCOD  = MST.CMPCOD (+)
			AND HIS.DOCOWRIDR = MST.DOCOWRIDR (+)
			AND HIS.MSTDOCNUM = MST.MSTDOCNUM (+)
			AND HIS.DUPNUM    = MST.DUPNUM (+)
			AND HIS.SEQNUM    = MST.SEQNUM (+)
			AND HIS.CMPCOD    = ?
			AND HIS.DOCOWRIDR = ?
			AND HIS.MSTDOCNUM = ?
			AND HIS.DUPNUM    = ?
			AND HIS.SEQNUM    = ?
								
		   ]]>
		</QRY:Source>
	</QRY:Definition>
	<!-- Added by A-5173 for ICRD-20782 Ends-->
	<QRY:Definition>
	<QRY:Id>302</QRY:Id>
	<QRY:Source Name="operations.shipment.dgorshipmentdocument.fetchfilenames" Type="NATIVE">
		<![CDATA[
		SELECT SHP.DOCTYP, SHP.RMK,SHP.FILNAM,SHP.CMPCOD,SHP.DOCOWRIDR,SHP.MSTDOCNUM, SHP.DUPNUM, SHP.SEQNUM, SHP.SERNUM, SHP.DOCSERNUM, SHP.FILBLB
		FROM  OPRSHPDGROCCDOC SHP 
		 WHERE SHP.CMPCOD= ? AND SHP.MSTDOCNUM=? AND SHP.DOCOWRIDR=? AND SHP.SEQNUM=? AND SHP.DUPNUM=? AND SHP.DGOCCRNUM=? AND SHP.SERNUM=?
		]]>
	</QRY:Source>
	</QRY:Definition>   

    <QRY:Definition>
	<QRY:Id>416</QRY:Id>
	<QRY:Source Name="operations.shipment.acpmode.findExportShipmentEnquiryDetails" Type="NATIVE">
		<![CDATA[
		SELECT SHPMST.CMPCOD,
          SHPMST.SHPPFX,
          SHPMST.MSTDOCNUM,
          SHPMST.UBRNUM,
          SHPMST.STDPCS,
          SHPMST.STDWGT,
          SHPMST.SCCCOD MSTSCC,
          SHPMST.ORGCOD,
          SHPMST.DSTCOD,
          SHPMST.PRDCOD,
          SHPMST.PRDNAM,
          SHPMST.AGTCOD,
          SHPMST.SHPCOD,
          SHPMST.DOCOWRIDR,
          SHPMST.SHPSTA,
          SHPMST.RDYCRGFLG,
          SHPMST.DUPNUM,
          SHPMST.SEQNUM,
          SHPMST.EXEFLG,
          SHPMST.OWRCOD,
          SHPDTL.APRFLG,
		  SHPMST.AGTNAM,
		  SHPMST.SHPDES,
          (CASE 
          WHEN SHPMST.EFTAWBFLG='Y'
          THEN 1
          ELSE null
          END) AWBTYP,
          (SELECT RTRIM(XMLAGG(XMLELEMENT(E, ULDACPDTL.ULDNUM
          || ',')).EXTRACT('//text()'), ',') FROM OPRULDACPDTL ULDACPDTL
        WHERE ARPSHP.CMPCOD     = ULDACPDTL.CMPCOD
        AND ARPSHP.ARPCOD    = ULDACPDTL.ARPCOD
        AND ARPSHP.DOCOWRIDR =ULDACPDTL.DOCOWRIDR
        AND ARPSHP.MSTDOCNUM =ULDACPDTL.MSTDOCNUM
        AND ARPSHP.DUPNUM    =ULDACPDTL.DUPNUM
        AND ARPSHP.SEQNUM    =ULDACPDTL.SEQNUM) ULDNUM,
          (SELECT BKGMST.SHPRDYTIM FROM CAPBKGMST BKGMST WHERE SHPMST.CMPCOD  = BKGMST.CMPCOD
        AND SHPMST.UBRNUM = BKGMST.UBRNUM AND BKGMST.BKGSTA IN ('C', 'Q')) LAT,
          FLTDTL.FLTCARCOD,
          FLTDTL.FLTNUM,
          FLTDTL.FLTDAT,
          FLTDTL.FLTSEQNUM,
          FLTDTL.FLTBKGSTA,
          ARPSHP.ACPPCS,
          ARPSHP.ACPWGT,
		  ARLMST.ISSPRTARL, ARLMST.OWNARLIND,
          SHPMIS.SCICOD,
		  ARPSHP.PLTUSEFLG PLTFLG, 
		  NVL((SELECT SUM(SHPGRP.NUMPCS) 
		  FROM OPRSHPPCSGRP SHPGRP, 
		  OPRSHPTXNPCSGRPHIS TXNGRPHIS 
		  WHERE SHPGRP.CMPCOD = TXNGRPHIS.CMPCOD 
		AND SHPGRP.DOCOWRIDR = TXNGRPHIS.DOCOWRIDR 
		AND SHPGRP.MSTDOCNUM = TXNGRPHIS.MSTDOCNUM 
		AND SHPGRP.DUPNUM = TXNGRPHIS.DUPNUM 
		AND SHPGRP.SEQNUM = TXNGRPHIS.SEQNUM 
		AND SHPGRP.GRPIDR = TXNGRPHIS.GRPIDR 
		AND TXNGRPHIS.CMPCOD = SHPMST.CMPCOD 
		AND TXNGRPHIS.DOCOWRIDR = SHPMST.DOCOWRIDR 
		AND TXNGRPHIS.MSTDOCNUM = SHPMST.MSTDOCNUM 
		AND TXNGRPHIS.DUPNUM = SHPMST.DUPNUM 
		AND TXNGRPHIS.SEQNUM = SHPMST.SEQNUM 
		AND TXNGRPHIS.TXNCOD = 'ACP' 
		AND TXNGRPHIS.ARPCOD = ? )		
		, 0) TOTTIDPCS,
		NVL((SELECT COUNT(DISTINCT SHPGRP.GRPIDR) 
      FROM OPRSHPPCSGRP SHPGRP, 
      OPRSHPTXNPCSGRPHIS TXNGRPHIS 
      WHERE SHPGRP.CMPCOD = TXNGRPHIS.CMPCOD 
    AND SHPGRP.DOCOWRIDR = TXNGRPHIS.DOCOWRIDR 
    AND SHPGRP.MSTDOCNUM = TXNGRPHIS.MSTDOCNUM 
    AND SHPGRP.DUPNUM = TXNGRPHIS.DUPNUM 
    AND SHPGRP.SEQNUM = TXNGRPHIS.SEQNUM 
    AND SHPGRP.GRPIDR = TXNGRPHIS.GRPIDR 
    AND TXNGRPHIS.CMPCOD = SHPMST.CMPCOD 
    AND TXNGRPHIS.DOCOWRIDR = SHPMST.DOCOWRIDR 
    AND TXNGRPHIS.MSTDOCNUM = SHPMST.MSTDOCNUM 
    AND TXNGRPHIS.DUPNUM = SHPMST.DUPNUM 
    AND TXNGRPHIS.SEQNUM = SHPMST.SEQNUM 
    AND TXNGRPHIS.TXNCOD = 'ACP' 
    AND TXNGRPHIS.ARPCOD = ? ) 
    , 0) TOTTIDNUM,
	ARPSHP.ACPVOL,
	SHPMST.GRSVOL

        FROM OPRSHPMST SHPMST
        INNER JOIN OPRSHPMSTMIS SHPMIS
        ON SHPMST.CMPCOD     = SHPMIS.CMPCOD
        AND SHPMST.DOCOWRIDR =SHPMIS.DOCOWRIDR
        AND SHPMST.MSTDOCNUM =SHPMIS.MSTDOCNUM
        AND SHPMST.DUPNUM    =SHPMIS.DUPNUM
        AND SHPMST.SEQNUM    =SHPMIS.SEQNUM
        INNER JOIN OPRSHPDTL SHPDTL
        ON SHPMST.CMPCOD     = SHPDTL.CMPCOD
        AND SHPMST.DOCOWRIDR =SHPDTL.DOCOWRIDR
        AND SHPMST.MSTDOCNUM =SHPDTL.MSTDOCNUM
        AND SHPMST.DUPNUM    =SHPDTL.DUPNUM
        AND SHPMST.SEQNUM    =SHPDTL.SEQNUM
        INNER JOIN OPRARPSHP ARPSHP
        ON SHPMST.CMPCOD     = ARPSHP.CMPCOD
        AND SHPMST.DOCOWRIDR =ARPSHP.DOCOWRIDR
        AND SHPMST.MSTDOCNUM =ARPSHP.MSTDOCNUM
        AND SHPMST.DUPNUM    =ARPSHP.DUPNUM
        AND SHPMST.SEQNUM    =ARPSHP.SEQNUM
        LEFT OUTER JOIN CAPBKGFLTDTL FLTDTL
        ON SHPMST.CMPCOD  = FLTDTL.CMPCOD
        AND SHPMST.UBRNUM = FLTDTL.UBRNUM
		AND COALESCE(FLTDTL.FLTORG,?)   = ?
		AND (FLTDTL.FLTBKGSTA='C'
		OR FLTDTL.FLTBKGSTA ='Q')
		LEFT OUTER JOIN CAPBKGDTL BKGDTL
		ON BKGDTL.CMPCOD = FLTDTL.CMPCOD
		AND BKGDTL.UBRNUM = FLTDTL.UBRNUM
		LEFT OUTER JOIN CAPBKGMST BKGMST
		ON BKGMST.CMPCOD = FLTDTL.CMPCOD
		AND BKGMST.UBRNUM = FLTDTL.UBRNUM
		LEFT OUTER JOIN SHRARLMST ARLMST
        ON FLTDTL.CMPCOD     = ARLMST.CMPCOD
        AND FLTDTL.FLTCARIDR = ARLMST.ARLIDR
        WHERE COALESCE(ARPSHP.ARPCOD,?)   = ? 
		AND SHPMST.CMPCOD                   = ?
        AND SHPMST.DSTCOD              <> ?
	]]>
	</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>417</QRY:Id>
		<QRY:Source Name="operations.shipment.bkgmode.findExportShipmentEnquiryDetails" Type="NATIVE">
			<![CDATA[
			SELECT SHPMST.CMPCOD,
			  SHPMST.SHPPFX,
			  SHPMST.MSTDOCNUM,
			  SHPMST.UBRNUM,
			  SHPMST.STDPCS,
			  SHPMST.STDWGT,
			  SHPMST.SCCCOD MSTSCC,
			  SHPMST.ORGCOD,
			  SHPMST.DSTCOD,
			  SHPMST.PRDCOD,
			  SHPMST.PRDNAM,
			  SHPMST.AGTCOD,
			  SHPMST.SHPCOD,
			  SHPMST.DOCOWRIDR,
			  SHPMST.SHPSTA,
			  SHPMST.RDYCRGFLG,
			  SHPMST.DUPNUM,
			  SHPMST.SEQNUM,
			  SHPMST.EXEFLG,
			  SHPMST.OWRCOD,
			  SHPMST.AGTNAM,
			  SHPMST.SHPDES,
			  (SELECT APRFLG FROM OPRSHPDTL WHERE SHPMST.CMPCOD  = CMPCOD(+)
				AND SHPMST.DOCOWRIDR =DOCOWRIDR(+)
				AND SHPMST.MSTDOCNUM =MSTDOCNUM(+)
				AND SHPMST.DUPNUM    =DUPNUM(+)
				AND SHPMST.SEQNUM    =SEQNUM(+)) APRFLG,
			  (CASE 
			  WHEN SHPMST.EFTAWBFLG='Y'
			  THEN 1
			  ELSE null
			  END) AWBTYP,
			  SHPACC.JRNDAT,
			 (SELECT RTRIM(XMLAGG(XMLELEMENT(E, ULDACPDTL.ULDNUM
          || ',')).EXTRACT('//text()'), ',') FROM OPRULDACPDTL ULDACPDTL
			WHERE ARPSHP.CMPCOD     = ULDACPDTL.CMPCOD
			AND ARPSHP.ARPCOD    = ULDACPDTL.ARPCOD
			AND ARPSHP.DOCOWRIDR =ULDACPDTL.DOCOWRIDR
			AND ARPSHP.MSTDOCNUM =ULDACPDTL.MSTDOCNUM
			AND ARPSHP.DUPNUM    =ULDACPDTL.DUPNUM
			AND ARPSHP.SEQNUM    =ULDACPDTL.SEQNUM) ULDNUM,
			  BKGMST.SHPRDYTIM LAT,
			  FLTDTL.FLTCARCOD,
			  FLTDTL.FLTNUM,
			  FLTDTL.FLTDAT,
			  FLTDTL.FLTSEQNUM,
			  FLTDTL.FLTBKGSTA,
			  ARPSHP.ACPPCS,
			  ARPSHP.ACPWGT,
			  ARLMST.ISSPRTARL, ARLMST.OWNARLIND,
			  SHPMIS.SCICOD,
			  SHPMST.PLTFLG PLTFLG, 
				NVL((SELECT SUM(SHPGRP.NUMPCS) 
				FROM OPRSHPPCSGRP SHPGRP, 
				OPRSHPTXNPCSGRPHIS TXNGRPHIS 
				WHERE SHPGRP.CMPCOD = TXNGRPHIS.CMPCOD 
				AND SHPGRP.DOCOWRIDR = TXNGRPHIS.DOCOWRIDR 
				AND SHPGRP.MSTDOCNUM = TXNGRPHIS.MSTDOCNUM 
				AND SHPGRP.DUPNUM = TXNGRPHIS.DUPNUM 
				AND SHPGRP.SEQNUM = TXNGRPHIS.SEQNUM 
				AND SHPGRP.GRPIDR = TXNGRPHIS.GRPIDR 
				AND TXNGRPHIS.CMPCOD = SHPMST.CMPCOD 
				AND TXNGRPHIS.DOCOWRIDR = SHPMST.DOCOWRIDR 
				AND TXNGRPHIS.MSTDOCNUM = SHPMST.MSTDOCNUM 
				AND TXNGRPHIS.DUPNUM = SHPMST.DUPNUM 
				AND TXNGRPHIS.SEQNUM = SHPMST.SEQNUM 
				AND TXNGRPHIS.TXNCOD = 'ACP' 
				AND TXNGRPHIS.ARPCOD = ? ) 
				, 0) TOTTIDPCS,
				NVL((SELECT COUNT(DISTINCT SHPGRP.GRPIDR) 
      FROM OPRSHPPCSGRP SHPGRP, 
      OPRSHPTXNPCSGRPHIS TXNGRPHIS 
      WHERE SHPGRP.CMPCOD = TXNGRPHIS.CMPCOD 
    AND SHPGRP.DOCOWRIDR = TXNGRPHIS.DOCOWRIDR 
    AND SHPGRP.MSTDOCNUM = TXNGRPHIS.MSTDOCNUM 
    AND SHPGRP.DUPNUM = TXNGRPHIS.DUPNUM 
    AND SHPGRP.SEQNUM = TXNGRPHIS.SEQNUM 
    AND SHPGRP.GRPIDR = TXNGRPHIS.GRPIDR 
    AND TXNGRPHIS.CMPCOD = SHPMST.CMPCOD 
    AND TXNGRPHIS.DOCOWRIDR = SHPMST.DOCOWRIDR 
    AND TXNGRPHIS.MSTDOCNUM = SHPMST.MSTDOCNUM 
    AND TXNGRPHIS.DUPNUM = SHPMST.DUPNUM 
    AND TXNGRPHIS.SEQNUM = SHPMST.SEQNUM 
    AND TXNGRPHIS.TXNCOD = 'ACP' 
    AND TXNGRPHIS.ARPCOD = ? ) 
    , 0) TOTTIDNUM,
	 ARPSHP.ACPVOL,
	 SHPMST.GRSVOL

			FROM CAPBKGMST BKGMST INNER JOIN OPRSHPMST SHPMST
			ON BKGMST.CMPCOD  = SHPMST.CMPCOD
			AND BKGMST.UBRNUM = SHPMST.UBRNUM
			INNER JOIN CAPBKGFLTDTL FLTDTL
			ON BKGMST.CMPCOD  = FLTDTL.CMPCOD
			AND BKGMST.UBRNUM = FLTDTL.UBRNUM
			INNER JOIN SHRARLMST ARLMST
			ON FLTDTL.CMPCOD     = ARLMST.CMPCOD
			AND FLTDTL.FLTCARIDR = ARLMST.ARLIDR
			INNER JOIN OPRSHPMSTACC SHPACC
			ON SHPMST.CMPCOD     = SHPACC.CMPCOD
			AND SHPMST.DOCOWRIDR =SHPACC.DOCOWRIDR
			AND SHPMST.MSTDOCNUM =SHPACC.MSTDOCNUM
			AND SHPMST.DUPNUM    =SHPACC.DUPNUM
			AND SHPMST.SEQNUM    =SHPACC.SEQNUM
			INNER JOIN OPRSHPMSTMIS SHPMIS
			ON SHPMST.CMPCOD     = SHPMIS.CMPCOD
			AND SHPMST.DOCOWRIDR =SHPMIS.DOCOWRIDR
			AND SHPMST.MSTDOCNUM =SHPMIS.MSTDOCNUM
			AND SHPMST.DUPNUM    =SHPMIS.DUPNUM
			AND SHPMST.SEQNUM    =SHPMIS.SEQNUM
			LEFT OUTER JOIN OPRSHPDTL SHPDTL
			ON SHPMST.CMPCOD     = SHPDTL.CMPCOD
			AND SHPMST.DOCOWRIDR =SHPDTL.DOCOWRIDR
			AND SHPMST.MSTDOCNUM =SHPDTL.MSTDOCNUM
			AND SHPMST.DUPNUM    =SHPDTL.DUPNUM
			AND SHPMST.SEQNUM    =SHPDTL.SEQNUM
			LEFT OUTER JOIN OPRARPSHP ARPSHP
			ON SHPMST.CMPCOD     = ARPSHP.CMPCOD
			AND SHPMST.DOCOWRIDR =ARPSHP.DOCOWRIDR
			AND SHPMST.MSTDOCNUM =ARPSHP.MSTDOCNUM
			AND SHPMST.DUPNUM    =ARPSHP.DUPNUM
			AND SHPMST.SEQNUM    =ARPSHP.SEQNUM
			AND COALESCE(ARPSHP.ARPCOD,?)   = ?
			WHERE BKGMST.BKGSTA IN ('C','Q') 
			AND FLTDTL.FLTBKGSTA IN ('C','Q') 
			AND COALESCE(FLTDTL.FLTORG,?)   = ?
			AND SHPMST.CMPCOD               = ?
			AND SHPMST.DSTCOD              <> ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>418</QRY:Id>
		<QRY:Source Name="operations.shipment.jrnmode.findExportShipmentEnquiryDetails" Type="NATIVE">
			<![CDATA[
			SELECT SHPMST.CMPCOD,
			  SHPMST.SHPPFX,
			  SHPMST.MSTDOCNUM,
			  SHPMST.UBRNUM,
			  SHPMST.STDPCS,
			  SHPMST.STDWGT,
			  SHPMST.SCCCOD MSTSCC,
			  SHPMST.ORGCOD,
			  SHPMST.DSTCOD,
			  SHPMST.PRDCOD,
			  SHPMST.PRDNAM,
			  SHPMST.AGTCOD,
			  SHPMST.SHPCOD,
			  SHPMST.DOCOWRIDR,
			  SHPMST.AGTNAM,
			  SHPMST.SHPDES,
			  (CASE WHEN NVL(SHPMST.VODFLG,'N') = 'Y'
			    THEN 'V'
				ELSE SHPMST.SHPSTA
			  END) SHPSTA,
			  SHPMST.RDYCRGFLG,
			  SHPMST.DUPNUM,
			  SHPMST.SEQNUM,
			  SHPMST.EXEFLG,
			  SHPMST.OWRCOD,
			  (SELECT APRFLG FROM OPRSHPDTL WHERE SHPMST.CMPCOD  = CMPCOD(+)
				AND SHPMST.DOCOWRIDR =DOCOWRIDR(+)
				AND SHPMST.MSTDOCNUM =MSTDOCNUM(+)
				AND SHPMST.DUPNUM    =DUPNUM(+)
				AND SHPMST.SEQNUM    =SEQNUM(+)) APRFLG,
			  (CASE 
			  WHEN SHPMST.EFTAWBFLG='Y'
			  THEN 1
			  ELSE null
			  END) AWBTYP,
			  SHPACC.JRNDAT,
			  (SELECT RTRIM(XMLAGG(XMLELEMENT(E, ULDACPDTL.ULDNUM
          || ',')).EXTRACT('//text()'), ',') FROM OPRULDACPDTL ULDACPDTL
			WHERE ARPSHP.CMPCOD     = ULDACPDTL.CMPCOD
			AND ARPSHP.ARPCOD    = ULDACPDTL.ARPCOD
			AND ARPSHP.DOCOWRIDR =ULDACPDTL.DOCOWRIDR
			AND ARPSHP.MSTDOCNUM =ULDACPDTL.MSTDOCNUM
			AND ARPSHP.DUPNUM    =ULDACPDTL.DUPNUM
			AND ARPSHP.SEQNUM    =ULDACPDTL.SEQNUM) ULDNUM,
			  (SELECT BKGMST.SHPRDYTIM FROM CAPBKGMST BKGMST WHERE SHPMST.CMPCOD  = BKGMST.CMPCOD
			AND SHPMST.UBRNUM = BKGMST.UBRNUM AND BKGMST.BKGSTA IN ('C', 'Q')) LAT,
			  FLTDTL.FLTCARCOD,
			  FLTDTL.FLTNUM,
			  FLTDTL.FLTDAT,
			  FLTDTL.FLTSEQNUM,
			  FLTDTL.FLTBKGSTA,
			  ARPSHP.ACPPCS,
			  ARPSHP.ACPWGT,
			  ARLMST.ISSPRTARL, ARLMST.OWNARLIND,
			  SHPMIS.SCICOD,
			  SHPMST.PLTFLG PLTFLG, 
				NVL((SELECT SUM(SHPGRP.NUMPCS) 
				FROM OPRSHPPCSGRP SHPGRP, 
				OPRSHPTXNPCSGRPHIS TXNGRPHIS 
				WHERE SHPGRP.CMPCOD = TXNGRPHIS.CMPCOD 
				AND SHPGRP.DOCOWRIDR = TXNGRPHIS.DOCOWRIDR 
				AND SHPGRP.MSTDOCNUM = TXNGRPHIS.MSTDOCNUM 
				AND SHPGRP.DUPNUM = TXNGRPHIS.DUPNUM 
				AND SHPGRP.SEQNUM = TXNGRPHIS.SEQNUM 
				AND SHPGRP.GRPIDR = TXNGRPHIS.GRPIDR 
				
				AND TXNGRPHIS.CMPCOD = SHPMST.CMPCOD 
				AND TXNGRPHIS.DOCOWRIDR = SHPMST.DOCOWRIDR 
				AND TXNGRPHIS.MSTDOCNUM = SHPMST.MSTDOCNUM 
				AND TXNGRPHIS.DUPNUM = SHPMST.DUPNUM 
				AND TXNGRPHIS.SEQNUM = SHPMST.SEQNUM 
				AND TXNGRPHIS.TXNCOD = 'ACP' 
				AND TXNGRPHIS.ARPCOD = ? ), 0) TOTTIDPCS,
				NVL((SELECT COUNT(DISTINCT SHPGRP.GRPIDR) 
      FROM OPRSHPPCSGRP SHPGRP, 
      OPRSHPTXNPCSGRPHIS TXNGRPHIS 
      WHERE SHPGRP.CMPCOD = TXNGRPHIS.CMPCOD 
    AND SHPGRP.DOCOWRIDR = TXNGRPHIS.DOCOWRIDR 
    AND SHPGRP.MSTDOCNUM = TXNGRPHIS.MSTDOCNUM 
    AND SHPGRP.DUPNUM = TXNGRPHIS.DUPNUM 
    AND SHPGRP.SEQNUM = TXNGRPHIS.SEQNUM 
    AND SHPGRP.GRPIDR = TXNGRPHIS.GRPIDR 
    AND TXNGRPHIS.CMPCOD = SHPMST.CMPCOD 
    AND TXNGRPHIS.DOCOWRIDR = SHPMST.DOCOWRIDR 
    AND TXNGRPHIS.MSTDOCNUM = SHPMST.MSTDOCNUM 
    AND TXNGRPHIS.DUPNUM = SHPMST.DUPNUM 
    AND TXNGRPHIS.SEQNUM = SHPMST.SEQNUM 
    AND TXNGRPHIS.TXNCOD = 'ACP' 
    AND TXNGRPHIS.ARPCOD = ? ) 
    , 0) TOTTIDNUM,
	ARPSHP.ACPVOL,
	SHPMST.GRSVOL

			FROM OPRSHPMST SHPMST
			INNER JOIN OPRSHPMSTACC SHPACC
			ON SHPMST.CMPCOD     = SHPACC.CMPCOD
			AND SHPMST.DOCOWRIDR =SHPACC.DOCOWRIDR
			AND SHPMST.MSTDOCNUM =SHPACC.MSTDOCNUM
			AND SHPMST.DUPNUM    =SHPACC.DUPNUM
			AND SHPMST.SEQNUM    =SHPACC.SEQNUM
			INNER JOIN OPRSHPMSTMIS SHPMIS
			ON SHPMST.CMPCOD     = SHPMIS.CMPCOD
			AND SHPMST.DOCOWRIDR =SHPMIS.DOCOWRIDR
			AND SHPMST.MSTDOCNUM =SHPMIS.MSTDOCNUM
			AND SHPMST.DUPNUM    =SHPMIS.DUPNUM
			AND SHPMST.SEQNUM    =SHPMIS.SEQNUM
			LEFT OUTER JOIN OPRSHPDTL SHPDTL
			ON SHPMST.CMPCOD     = SHPDTL.CMPCOD
			AND SHPMST.DOCOWRIDR =SHPDTL.DOCOWRIDR
			AND SHPMST.MSTDOCNUM =SHPDTL.MSTDOCNUM
			AND SHPMST.DUPNUM    =SHPDTL.DUPNUM
			AND SHPMST.SEQNUM    =SHPDTL.SEQNUM
			LEFT OUTER JOIN OPRARPSHP ARPSHP
			ON SHPMST.CMPCOD     = ARPSHP.CMPCOD
			AND SHPMST.DOCOWRIDR =ARPSHP.DOCOWRIDR
			AND SHPMST.MSTDOCNUM =ARPSHP.MSTDOCNUM
			AND SHPMST.DUPNUM    =ARPSHP.DUPNUM
			AND SHPMST.SEQNUM    =ARPSHP.SEQNUM
			AND COALESCE(ARPSHP.ARPCOD,?)   = ?
			LEFT OUTER JOIN CAPBKGFLTDTL FLTDTL
			ON SHPMST.CMPCOD  = FLTDTL.CMPCOD
			AND SHPMST.UBRNUM = FLTDTL.UBRNUM
			AND COALESCE(FLTDTL.FLTORG,?)   = ?
			AND (FLTDTL.FLTBKGSTA='C'
			OR FLTDTL.FLTBKGSTA ='Q')
			LEFT OUTER JOIN CAPBKGDTL BKGDTL
			ON BKGDTL.CMPCOD = FLTDTL.CMPCOD
			AND BKGDTL.UBRNUM = FLTDTL.UBRNUM
			LEFT OUTER JOIN CAPBKGMST BKGMST
			ON BKGMST.CMPCOD = FLTDTL.CMPCOD
			AND BKGMST.UBRNUM = FLTDTL.UBRNUM
			LEFT OUTER JOIN SHRARLMST ARLMST
			ON FLTDTL.CMPCOD     = ARLMST.CMPCOD
			AND FLTDTL.FLTCARIDR = ARLMST.ARLIDR
			WHERE SHPMST.CMPCOD               = ?
			AND SHPMST.DSTCOD              <> ?
	]]>
	</QRY:Source>
</QRY:Definition>

<QRY:Definition>
	 <QRY:Id>302</QRY:Id>
    <QRY:Source Name="operations.shipment.findshipmentscreeningdetails" Type="NATIVE">
      <![CDATA[ 		
			  SELECT MST.CMPCOD,MST.MSTDOCNUM, MST.DOCOWRIDR, MST.DUPNUM,
			  MST.SEQNUM, MST.STDPCS, MST.STDWGT, MST.SCCCOD, MST.SHPDES,MST.VODFLG,MST.EXEFLG,MST.ORGCOD,MST.DSTCOD,MST.PRDCOD,MST.PRDNAM,MST.PRDPRT,
			  DTL.EXMCOD, DTL.SCRRMK, DTL.SCRDAT, DTL.SCRSECRWDFLG, DTL.REGAGTTYPFLG,
		      DTL.SCRNAM,OCI.INFIDF PARINFIDF, OCI.CUSINFIDF PARCUSINFIDF, OCI.CUSINF PARCUSINF,
			  OCI.CNTCOD PARCNTCOD,OCI.SERNUM PARSERNUM,OCI.PARSERNUM PARPARSERNUM,OCI.SRCIND SRCIND,
			  OCICHD.INFIDF CHDINFIDF,OCICHD.CUSINFIDF CHDCUSINFIDF, OCICHD.CUSINF CHDCUSINF,
			  OCICHD.CNTCOD CHDCNTCOD,OCICHD.SERNUM CHDSERNUM,OCICHD.PARSERNUM CHDPARSERNUM,
			  SCRDTL.SCRWGT, SCRDTL.SCRRES, SCRDTL.SERNUM SCRSERNUM,
			  SCRDTL.SCRCOD, SCRDTL.SCRPCS, SCRDTL.SCRARP,DTL.APRFLG,DTL.ACPFNLFLG,DTL.ACPDAT,
			(ARPSHP. ACPPCS + ARPSHP.RCVPCS) ARPPCS, 
			MST.CONFLG, MST.DSTCOD, MST.SHPPFX, ARPSHP.PLTUSEFLG, 
			
			(SELECT (ACPPCS + RCVPCS)  FROM OPRARPSHP
			  WHERE CMPCOD = MST.CMPCOD 
			  AND MSTDOCNUM = MST.MSTDOCNUM 
			  AND SEQNUM = MST.SEQNUM 
			  AND DUPNUM = MST.DUPNUM 
			  AND DOCOWRIDR = MST.DOCOWRIDR 
			  AND ARPCOD = ?
			  ) ARPPCSATARP,
			   (SELECT PLTUSEFLG  FROM OPRARPSHP
			  WHERE CMPCOD = MST.CMPCOD 
			  AND MSTDOCNUM = MST.MSTDOCNUM 
			  AND SEQNUM = MST.SEQNUM 
			  AND DUPNUM = MST.DUPNUM 
			  AND DOCOWRIDR = MST.DOCOWRIDR 
			  AND MST.PLTFLG = 'Y'
			  AND ARPCOD = ?
			  ) PLTUSEFLGARP,
			   ( select count(1) from oprshptxnpcsgrphis 
				where cmpcod =  MST.CMPCOD
				AND MSTDOCNUM =  MST.MSTDOCNUM 
				AND SEQNUM = MST.SEQNUM 
				AND DUPNUM = MST.DUPNUM 		  
				AND DOCOWRIDR =  MST.DOCOWRIDR 
				AND TXNCOD = 'SCR'
				AND TXNREFTWO = SCRDTL.SERNUM
				AND ARPCOD = ARPSHP.ARPCOD) TXNPCS

					FROM OPRSHPMST MST,
					OPRSHPDTL DTL,
					OPRSHPOCI OCI,
					OPRSHPOCI OCICHD,
					OPRSHPSCRDTL SCRDTL,
					OPRARPSHP ARPSHP 

				WHERE MST.MSTDOCNUM = DTL.MSTDOCNUM(+)
				AND MST.DOCOWRIDR = DTL.DOCOWRIDR(+)
				AND MST.DUPNUM = DTL.DUPNUM(+)
				AND MST.SEQNUM = DTL.SEQNUM(+)
				AND MST.CMPCOD = DTL.CMPCOD(+)

				AND MST.MSTDOCNUM = OCI.MSTDOCNUM(+)
				AND MST.DOCOWRIDR = OCI.DOCOWRIDR(+)
				AND MST.DUPNUM = OCI.DUPNUM(+)
				AND MST.SEQNUM = OCI.SEQNUM(+)
				AND MST.CMPCOD = OCI.CMPCOD(+)
			  
				AND OCI.MSTDOCNUM = OCICHD.MSTDOCNUM(+)
				AND OCI.DOCOWRIDR = OCICHD.DOCOWRIDR(+)
				AND OCI.DUPNUM = OCICHD.DUPNUM(+)
				AND OCI.SEQNUM = OCICHD.SEQNUM(+)
				AND OCI.CMPCOD = OCICHD.CMPCOD(+)
				AND OCI.SERNUM = OCICHD.PARSERNUM(+)
				AND OCICHD.PARSERNUM(+) > 0
			    AND OCI.PARSERNUM(+) = 0
				AND OCI.CUSINFIDF(+) IN ('RC','RA','AC', 'KC') 
			  
				AND MST.MSTDOCNUM = SCRDTL.MSTDOCNUM(+)
				AND MST.DOCOWRIDR = SCRDTL.DOCOWRIDR(+)
				AND MST.DUPNUM = SCRDTL.DUPNUM(+)
				AND MST.SEQNUM = SCRDTL.SEQNUM(+)
				AND MST.CMPCOD = SCRDTL.CMPCOD(+)	
			  
				AND SCRDTL.MSTDOCNUM = ARPSHP.MSTDOCNUM(+)
				AND SCRDTL.DOCOWRIDR = ARPSHP.DOCOWRIDR(+)
				AND SCRDTL.DUPNUM = ARPSHP.DUPNUM(+)
				AND SCRDTL.SEQNUM = ARPSHP.SEQNUM(+)
				AND SCRDTL.CMPCOD = ARPSHP.CMPCOD(+)
         			AND SCRDTL.SCRARP = ARPSHP.ARPCOD(+) 
			  
				AND MST.CMPCOD = ?
				AND MST.MSTDOCNUM = ?
				AND MST.SEQNUM = ?
				AND MST.DUPNUM = ?			  
				AND MST.DOCOWRIDR = ?
				
			]]>   
		</QRY:Source>
		</QRY:Definition>
<QRY:Definition>
	<QRY:Id>305</QRY:Id>
		<QRY:Source Name="operations.shipment.finduldatairportdetails" Type="NATIVE"> 
			<![CDATA[
			SELECT ULD.ULDNUM,ULD.ARPCOD, ULD.INTFLG FROM OPRULDSHP SHP
			JOIN OPRARPULD ULD
			ON SHP.CMPCOD = ULD.CMPCOD
			AND SHP.ULDNUM = ULD.ULDNUM
			WHERE
			ULD.ARPCOD = ?
			AND SHP.DOCOWRIDR = ?
			AND SHP.MSTDOCNUM = ?
			AND SHP.DUPNUM = ?
			AND SHP.SEQNUM = ?
			AND SHP.CMPCOD = ?
			]]>   
		</QRY:Source>
		</QRY:Definition>
		
<QRY:Definition>		
	<QRY:Id>303</QRY:Id>
		<QRY:Source Name="operations.shipment.findshipmentdetailsforiqa" Type="NATIVE">
		<![CDATA[
		SELECT MST.MSTDOCNUM,
		MST.CMPCOD MSTCMPCOD,
		MST.DOCOWRIDR MSTDOCOWRIDR,
		MST.DUPNUM MSTDUPNUM,
		MST.SEQNUM MSTSEQNUM,
		MST.DOCNUM,
		MST.DOCTYP,
		MST.OWRCOD,
		MST.LSTUPDTIM MSTLSTUPDTIM,
		MST.LSTUPDUSR MSTLSTUPDUSR,
		MST.ORGCOD,
		MST.DSTCOD,
		MST.STDPCS,
		MST.STDWGT,
		MST.SHPDES,
		MST.PRDNAM,
		MST.SCCCOD,
		MST.PAYTYP MSTPAYTYP,
		MST.CHGCOD,
		MST.SHPPFX,
		COALESCE(MST.CURCOD,MSTAWB.CURCOD,
		(SELECT PARVAL
		FROM SHRSTNPAR
		WHERE CMPCOD = MSTAWB.CMPCOD
		AND STNCOD   = MSTAWB.ORGCOD
		AND PARCOD  IN ('shared.station.basecurrency' )
		))CURCOD,
		MST.CNSCOD,
		MST.CNSADRONE,
		MST.CNSNAM,
		MST.SHPCOD,
		MST.SHPNAM,
		MST.SHPADRONE,
		MST.CONFLG,
		MST.STDWGTCOD,
		 MST.AGTCOD,
		 MST.PRDCOD,
		CNT.CNSACCNUM,
		CNT.CNSADRTWO,
		CNT.CNSCTR,
		CNT.CNSCTY,
		CNT.SHPACCNUM,
		CNT.SHPADRTWO,
		CNT.SHPCTR,
		CNT.SHPCTY,
		CNT.CNSPSTCOD,
		CNT.SHPPSTCOD,
		CNT.CNSACCNUM,
		CNT.SHPACCNUM,
		ADLCNT.CNTTYP,
		ADLCNT.CNTADR,
		ADLCNT.CTTCUSCOD CNTCOD,
		ADLCNT.CTTCUSNAM CNTNAM,
		ADLCNT.CNTCTY,
		ADLCNT.CNTCTR,
		ADLCNT.CNTPSTCOD,
		ADLCNT.CNSMALIDR,
		ADLCNT.ACCNUM,
		ADLCNT.VATREGNUM,
		ADLCNT.CSTLOCNUM,		
		ADLCNT.CNTERINUM,
		ADLCNT.CNTSTT,
		ADLCNT.CNTTELNUM,
		ADLCNT.CNSMALIDR,
		ADLCNT.CNTADRTWO,
		CHG.CHGHEDIDR,
		CHG.CHGAMT,
		CHG.PAYTYP CHGPAYTYP,
		CHG.DUECARFLG,
		CHG.CHDCOD,
		CHG.DUEAGTFLG,
		CHG.CHGRMK,
		CHG.CHGHED,
		CHG.CMPCOD CHGCMPCOD,
		CHG.SEQNUM CHGSEQNUM,
		CHG.DOCOWRIDR CHGDOCOWRIDR,
		CHG.MSTDOCNUM CHGMSTDOCNUM,
		CHG.DUPNUM CHGDUPNUM,
		ARPSHP.ACPPCS - ARPSHP.TOTDLVPCS TOTACPPCS,
		ARPSHP.LSTUPDUSR ARPSHPLSTUPDUSR,
		ARPSHP.ACPWGT - ARPSHP.TOTDLVWGT TOTACPWGT,
		ARPSHP.LSTUPDTIM ARPSHPLSTUPDTIM,
		ARPSHP.DCSREQFLG,
		ARPSHP.AVLPCS,
		ARPSHP.AVLWGT,
		ARPSHP.MFTPCS,
		ARPSHP.MFTWGT,
		ACC.ACCINF,
		ACC.INSMINAMT,
		ACC.INSAMT,
		ACC.RATCONIDR,
		ACC.SRVCRGCLS,
		ACC.TOTDUECARPPCHG,
		ACC.TOTDUECARCCCHG,
		ACC.TOTDUEAGTPPCHG,
		ACC.TOTDUEAGTCCCHG,
		ACC.WGTPPCHG,
		ACC.WGTCCCHG,
		ACC.VALPPCHG,
		ACC.VALCCCHG,
		ACC.TAXPPD,
		ACC.TAXCCF,
		ACC.TOTPPD,
		ACC.TOTCCF,
		ACC.CSHFLG,
		ACC.CMSCCF,
		ACC.MNLCPTFLG,
		ACC.IATCOD,
		ACC.DVLCUS,
		ACC.DVLCAR,
		ACC.DSTEXGRATBSS,
		RAT.CMPCOD RATCMPCOD,
		RAT.DOCOWRIDR RATDOCOWRIDR,
		RAT.MSTDOCNUM RATMSTDOCNUM,
		RAT.DUPNUM RATDUPNUM,
		RAT.SEQNUM RATSEQNUM,
		RAT.RATLINSERNUM RATRATLINSERNUM,
		RAT.NUMPCS RATNUMPCS,
		RAT.SCCCOD,
		RAT.TAX,
		RAT.SRVCOD,
		RAT.CHGWGT,
		RAT.GRSWGT,
		RAT.IATCHG RATIATACHG,
		RAT.NETCHG,
		RAT.CMDITMNAM,
		RAT.IATRAT,
		MIS.SCICOD,
		RTG.DSTCOD RTGDSTCOD,
		RTG.RTGSERNUM RTGSERNUM,
		RTG.FLTCARCOD RTGFLTCARCOD,
		SHPCUS.VATREGNUM SHPVATNUM,
    HIS.EQASTA,
		SHPCUS.ERINUM AS SHPERINUM,
		(SELECT MIN(TXNDAT) DAT 
		FROM OPRSHPHIS HIS 
		WHERE HIS.CMPCOD = MST.CMPCOD 
		AND HIS.MSTDOCNUM = MST.MSTDOCNUM 
		AND HIS.DOCOWRIDR = MST.DOCOWRIDR 
		AND HIS.DUPNUM = MST.DUPNUM 
		AND HIS.ARPCOD = MST.DSTCOD 
		AND HIS.TXNCOD ='RCF' 
		) RCFSTRTIM , 
		(SELECT SHRMIS.CSTLOCNUM FROM SHRCUSMISDTL SHRMIS
		WHERE SHPCUS.CMPCOD= SHRMIS.CMPCOD(+)
		AND SHPCUS.CUSCOD= SHRMIS.CUSCOD(+))
		SHPLOCNUM,
		CNSCUS.VATREGNUM CNSVATNUM,
		CNSCUS.ERINUM AS CNSERINUM,
		(SELECT SHRMIS.CSTLOCNUM FROM SHRCUSMISDTL SHRMIS
		WHERE CNSCUS.CMPCOD= SHRMIS.CMPCOD(+)
		AND CNSCUS.CUSCOD= SHRMIS.CUSCOD(+))
		CNSLOCNUM,
		CUS.CUSINFIDF,
		CUS.CUSINF,
		CUS.SRCIND,
		CUS.SERNUM    AS CUSSERNUM,
		CUS.CNTCOD AS CUSCNTCOD,
		CUS.INFIDF,
		(SELECT MIN (HIS.STRTIM)
		FROM OPRULDBDNHIS HIS ,
		OPRSHPBDNDTL BDNDTL
		WHERE MST.CMPCOD = BDNDTL.CMPCOD(+)
		AND MST.MSTDOCNUM = BDNDTL.MSTDOCNUM(+)
		AND MST.DOCOWRIDR = BDNDTL.DOCOWRIDR(+)
		
		AND MST.DUPNUM = BDNDTL.DUPNUM(+)
		AND MST.DSTCOD = BDNDTL.ARPCOD(+)
		AND BDNDTL.ULDNUM = HIS.ULDNUM(+)
		AND BDNDTL.FLTNUM = HIS.FLTNUM(+)
		AND BDNDTL.FLTSEQNUM = HIS.FLTSEQNUM(+)
		AND BDNDTL.FLTCARIDR = HIS.FLTCARIDR(+)
		AND BDNDTL.LEGSERNUM = HIS.LEGSERNUM(+)
		) BRKSTRTIM ,
		 
		  
		(SELECT DECODE(ARL.APHCODUSE,2,ARL.TWOAPHCOD,ARL.THRAPHCOD)
					 FROM SHRARLACTMST ARL
					 WHERE ARL.CMPCOD = SEGSHP.CMPCOD
	  AND ARL.ARLIDR = SEGSHP.FLTCARIDR 
	  ) INBFLTCARCOD,
	  AGT.OWNFLG,
	  DTL.CTOCHGCOLFLG,
	  MST.EXEDAT,
	  MSTAWB.ORGCOD MAWBORGCOD,
	  MSTAWB.DSTCOD MAWBDSTCOD,
	  (SELECT 'Y'
  FROM DUAL
  WHERE EXISTS
    (SELECT 1
    FROM OPRSHPCCA CCA
	
	WHERE CCA.CMPCOD = MST.CMPCOD 
	AND CCA.DOCOWRIDR = MST.DOCOWRIDR 
	AND CCA.MSTDOCNUM = MST.MSTDOCNUM 

	AND CCA.DUPNUM = MST.DUPNUM 
	AND CCA.SEQNUM = MST.SEQNUM 
	AND CCA.CCASTA in ('O','A')
    )
  ) CCAFLG,
  (SELECT PARVAL
  FROM SHRSYSPAR SYSPAR
  WHERE SYSPAR.PARCOD = 'common.customer.walkincustomer'
  AND SYSPAR.CMPCOD  = MST.CMPCOD
  ) WALKINCOD,
  CSTINF.PARTYP CSTINFPARTYP,
  CSTINF.PARVAL CSTINFPARVAL,
  CSTINF.CSTAUTCOD CSTINFCSTAUTCOD,
  CSTINF.SERNUM CSTINFSERNUM
 
		FROM OPRSHPMST MST,
			OPRSHPMST MSTAWB,
			OPRSHPCHGDTL CHG,
			OPRSHPMSTMIS MIS,
			OPRARPSHP ARPSHP,
			OPRSHPMSTACC ACC,
			OPRSHPADLCNT ADLCNT,
			OPRSHPRATDTL RAT,
			OPRSHPMSTCNT CNT,
			SHRCUSMST SHPCUS,
			SHRCUSMST CNSCUS,
			OPRSHPOCI CUS,
			OPRSHPRTG RTG,
      OPRSEGSHP SEGSHP,
      SHRAGTMST AGT,
      OPRSHPDTL DTL,
	  OPRSHPCSTINF CSTINF,
       (SELECT CMPCOD,
  MSTDOCNUM,
  DOCOWRIDR,
  DUPNUM,
  SEQNUM,
  MAX(eqasta) eqaSTA
FROM
  (SELECT HIS.CMPCOD,
    HIS.MSTDOCNUM,
    HIS.DOCOWRIDR,
    HIS.DUPNUM,
    HIS.SEQNUM,
    FIRST_VALUE(HIS.TXNREFNIN) OVER (PARTITION BY HIS.CMPCOD,
    HIS.MSTDOCNUM,HIS.DOCOWRIDR, HIS.DUPNUM,HIS.SEQNUM
    ORDER BY SERNUM DESC) eqasta
  FROM OPRSHPHIS HIS
  WHERE HIS.TXNCOD ='STD'
  AND HIS.TXNREFEGT ='EQA'
  )
GROUP BY CMPCOD,
  MSTDOCNUM,
  DOCOWRIDR,
  DUPNUM,
  SEQNUM
) HIS 
      
		WHERE MST.CMPCOD         = ACC.CMPCOD
		AND MST.DOCOWRIDR        = ACC.DOCOWRIDR
		AND MST.MSTDOCNUM        = ACC.MSTDOCNUM
		AND MST.DUPNUM           = ACC.DUPNUM
		AND MST.SEQNUM           = ACC.SEQNUM
		AND MST.CMPCOD           = MIS.CMPCOD
		AND MST.DOCOWRIDR        = MIS.DOCOWRIDR
		AND MST.MSTDOCNUM        = MIS.MSTDOCNUM
		AND MST.DUPNUM           = MIS.DUPNUM
		AND MST.SEQNUM           = MIS.SEQNUM

		AND MST.CMPCOD           = CHG.CMPCOD(+)
		AND MST.DOCOWRIDR        = CHG.DOCOWRIDR(+)
		AND MST.MSTDOCNUM        = CHG.MSTDOCNUM(+)
		AND MST.DUPNUM           = CHG.DUPNUM(+)
		AND MST.SEQNUM           = CHG.SEQNUM(+)
		AND MST.CMPCOD           = ARPSHP.CMPCOD(+)
		AND MST.DOCOWRIDR        = ARPSHP.DOCOWRIDR(+)
		AND MST.MSTDOCNUM        = ARPSHP.MSTDOCNUM(+)
		AND MST.DUPNUM           = ARPSHP.DUPNUM(+)
		AND MST.SEQNUM           = ARPSHP.SEQNUM(+)
		AND MST.CMPCOD           = ADLCNT.CMPCOD(+)
		AND MST.DSTCOD           = ARPSHP.ARPCOD(+)
		AND MST.DOCOWRIDR        = ADLCNT.DOCOWRIDR(+)
		AND MST.MSTDOCNUM        = ADLCNT.MSTDOCNUM(+)
		AND MST.DUPNUM           = ADLCNT.DUPNUM(+)
		AND MST.SEQNUM           = ADLCNT.SEQNUM(+)
		AND MST.CMPCOD           = RAT.CMPCOD(+)
		AND MST.DOCOWRIDR        = RAT.DOCOWRIDR(+)
		AND MST.MSTDOCNUM        = RAT.MSTDOCNUM(+)
		AND MST.DUPNUM           = RAT.DUPNUM(+)
		AND MST.SEQNUM           = RAT.SEQNUM(+)
		AND MST.CMPCOD           = CNT.CMPCOD(+)
		AND MST.DOCOWRIDR        = CNT.DOCOWRIDR(+)
		AND MST.MSTDOCNUM        = CNT.MSTDOCNUM(+)
		AND MST.DUPNUM           = CNT.DUPNUM(+)
		AND MST.SEQNUM           = CNT.SEQNUM(+)
		AND MST.CMPCOD           = SHPCUS.CMPCOD(+)
		AND MST.SHPCOD           = SHPCUS.CUSCOD(+)
		AND MST.CMPCOD           = CNSCUS.CMPCOD(+)
		AND MST.CNSCOD           = CNSCUS.CUSCOD(+)
		AND MST.CMPCOD           = CUS.CMPCOD(+)
		AND MST.DOCOWRIDR        = CUS.DOCOWRIDR(+)
		AND MST.MSTDOCNUM        = CUS.MSTDOCNUM(+)
		AND MST.DUPNUM           = CUS.DUPNUM(+)
		AND MST.SEQNUM           = CUS.SEQNUM(+)
		AND MST.MSTDOCNUM        = RTG.MSTDOCNUM(+)
		AND MST.DOCOWRIDR        = RTG.DOCOWRIDR(+)
		AND MST.DUPNUM           = RTG.DUPNUM(+)
		AND MST.SEQNUM           = RTG.SEQNUM(+)
		AND MST.CMPCOD           = RTG.CMPCOD(+)


		AND MST.MSTDOCNUM = SEGSHP.MSTDOCNUM (+)
		AND MST.DOCOWRIDR = SEGSHP.DOCOWRIDR (+)
		AND MST.SEQNUM = SEGSHP.SEQNUM (+)
		AND MST.DUPNUM = SEGSHP.DUPNUM (+)
		AND MST.CMPCOD = SEGSHP.CMPCOD (+)

		AND MST.CMPCOD    = AGT.CMPCOD(+)
		AND MST.AGTCOD    = AGT.AGTCOD(+)

		AND MST.CMPCOD    = DTL.CMPCOD(+)
		AND MST.MSTDOCNUM = DTL.MSTDOCNUM(+)
		AND MST.DOCOWRIDR = DTL.DOCOWRIDR(+)
		AND MST.SEQNUM    = DTL.SEQNUM(+)
		AND MST.DUPNUM    = DTL.DUPNUM(+)

		AND MST.MSTDOCNUM = HIS.MSTDOCNUM (+)
		AND MST.DOCOWRIDR = HIS.DOCOWRIDR (+)
		AND MST.SEQNUM = HIS.SEQNUM (+)
		AND MST.DUPNUM = HIS.DUPNUM (+)
		AND MST.CMPCOD = HIS.CMPCOD (+)
		AND MST.CMPCOD    = CSTINF.CMPCOD(+)
		AND MST.DOCOWRIDR = CSTINF.DOCOWRIDR(+)
		AND MST.MSTDOCNUM = CSTINF.MSTDOCNUM(+)
		AND MST.DUPNUM    = CSTINF.DUPNUM(+)
		AND MST.SEQNUM    = CSTINF.SEQNUM(+)

		AND MSTAWB.CMPCOD    = MST.CMPCOD
		AND MSTAWB.MSTDOCNUM = MST.MSTDOCNUM
		AND MSTAWB.DOCOWRIDR = MST.DOCOWRIDR
		AND MSTAWB.SEQNUM    = 1
		AND MSTAWB.DUPNUM    = MST.DUPNUM

		AND MST.CMPCOD    = ?
		AND MST.DOCOWRIDR = ?
		AND MST.MSTDOCNUM = ?
		AND MST.DUPNUM    = ?
		AND MST.SEQNUM    = ?
		AND NVL (CHG.CHGAMT, 1) >= 0
		order by  RTG.RTGSERNUM
		]]>
	</QRY:Source>
</QRY:Definition>
<QRY:Definition>
    <QRY:Id>304</QRY:Id>
    <QRY:Source Name="operations.shipment.findcdsreport" Type="NATIVE">
      <![CDATA[ 		
	
		SELECT DISMST.CMPCOD,
					  DISMST.ARPCOD,
					  DISMST.DOCOWRIDR,
					  DISMST.MSTDOCNUM,
					  DISMST.DUPNUM,
					  DISMST.SEQNUM,
					  DISMST.DISSEQNUM,
			SRVDTL.CDSSTA,
					  DISMST.DMGCOD,
			SRVDTL.FLTCARIDR,
			SRVDTL.FLTCARCOD,
			SRVDTL.FLTDAT,
			SRVDTL.FLTNUM,
			SRVDTL.FLTSEQNUM,
					  DISMST.DMGPCS,
			SRVDTL.DMGREACOD,
			SRVDTL.PKGTYP,
			SRVDTL.DMGCODPKG,
			SRVDTL.MATTYP,
			SRVDTL.DMGNOTPNT,
			SRVDTL.DMGFURHND,
			SRVDTL.LSTLODSTN,
			SRVDTL.DMGRMK,
			SRVDTL.DMGPKGRMK,
			SRVDTL.SPLMRKFLG,
			SRVDTL.PKGIFTFLG,
			SRVDTL.PILSYMFLG,
			SRVDTL.SPLMRKPKGRMK,
			SRVDTL.PKGINSRMK,
			SRVDTL.PILSYMRMK,
					  SRVDTL.ADMUNT,
					  DISBLB.IMG,
					  DISBLB.ARPCOD,
					  DISBLB.IMG,
					  DISBLB.LSTUPDTIM,
					  DISBLB.LSTUPDUSR,
					  DISBLB.FILNAM,
					  DISBLB.IMGSEQNUM
		FROM OPRDMGDIS DISMST,
		  OPRDMGSRYDTL SRVDTL,
		  OPRDMGDISBLB DISBLB
					WHERE DISMST.CMPCOD  = SRVDTL.CMPCOD(+)
					AND DISMST.DOCOWRIDR = SRVDTL.DOCOWRIDR(+)
					AND DISMST.MSTDOCNUM = SRVDTL.MSTDOCNUM(+)
					AND DISMST.SEQNUM    = SRVDTL.SEQNUM(+)
					AND DISMST.DUPNUM    = SRVDTL.DUPNUM(+)
					AND DISMST.ARPCOD    = SRVDTL.ARPCOD(+)
					AND DISMST.DISSEQNUM = SRVDTL.DISSEQNUM(+)
					AND DISMST.CMPCOD    = DISBLB.CMPCOD(+)
					AND DISMST.DOCOWRIDR = DISBLB.DOCOWRIDR(+)
					AND DISMST.MSTDOCNUM = DISBLB.MSTDOCNUM(+)
					AND DISMST.SEQNUM    = DISBLB.SEQNUM(+)
					AND DISMST.DUPNUM    = DISBLB.DUPNUM(+)
					AND DISMST.ARPCOD    = DISBLB.ARPCOD(+)
					AND DISMST.DISSEQNUM = DISBLB.DISSEQNUM(+)
							AND DISMST.DMGCOD !='CDR'
							AND DISMST.CMPCOD       = ?
							AND DISMST.DOCOWRIDR    = ?
							AND DISMST.MSTDOCNUM    = ?
							AND DISMST.SEQNUM       = ?
							AND DISMST.DUPNUM       = ?
	
			]]>
    
	</QRY:Source>
</QRY:Definition>

	<QRY:Definition>
	 <QRY:Id>304</QRY:Id>
	 <QRY:Source Name="operations.shipment.cto.findfsurctdetails" Type="NATIVE">
		<![CDATA[
			SELECT 
				MST.DOMFLG,MST.MSTDOCNUM, 
				MST.DOCOWRIDR, 
				MST.DUPNUM, 
				MST.SEQNUM, 
				MST.CMPCOD,
                MST.SHPPFX, 
				MST.STDPCS, 
				MST.STDWGT, 
				MST.ORGCOD, 
				MST.DSTCOD, 
				MST.AGTCOD, 
				MST.SHPCOD, 
				MST.RDYCRGFLG,
				MST.SHPNAM,
				MST.AGTCOD,
				CTM.CTMREFNUM,
				NVL(ARPSHP.INBCARCOD,CTM.INBCARCOD) INBCARCOD,
				SYS.PARVAL WGTCOD,
				CTM.CRNDAT, 
				DECODE(ARPSHP.ACPPCS,0,CTMDTL.ACTPCS,ARPSHP.ACPPCS) ACTPCS,
		        DECODE(ARPSHP.ACPWGT,0,CTMDTL.ACTWGT,ARPSHP.ACPWGT) ACTWGT,
				CASE MST.GRSVOLUNT
				   WHEN 'B'
						   THEN 'MC'
				   WHEN 'I'
						   THEN 'CI'
				   WHEN 'C'
						   THEN 'CC'
				   WHEN 'F'
						   THEN 'CF'
				   ELSE MST.GRSVOLUNT
                END GRSVOLUNT,
                ARL.TWOAPHCOD CARRCOD,
				MIS.STACOD,
				MIS.MSGSEQNUM,
				MIS.MSGTYP,
				MIS.JNVPAR,
				CTM.OUTCARCOD,
				ARPSHP.ARPCOD, 
				ARPSHP.ACPDAT, 
				DTL.ACPUSR,
				CUSMST.CUSGRP SHPGRP,
				AGTGRP.GRPNAM AGTGRP,
				SHPRTG.DSTCOD RTGCNT,
				SHRMST.CNTCOD
            FROM OPRSHPMST  MST,
                OPRSHPDTL DTL,
				OPRARPSHP ARPSHP,
                OPRMFTCTMSHP CTMDTL,
                OPRMFTCTM CTM,
                SHRSYSPAR SYS,
                SHRARLMST ARL,
                OPRSHPMSTMIS MIS,
				SHRCUSMST CUSMST,
				SHRGENMSTGRPDTL AGTGRP,
				OPRSHPRTG SHPRTG,
				SHRARPMST SHRMST
            WHERE MST.MSTDOCNUM = DTL.MSTDOCNUM
			   AND MST.DOCOWRIDR = DTL.DOCOWRIDR
			   AND MST.DUPNUM = DTL.DUPNUM
			   AND MST.SEQNUM = DTL.SEQNUM
			   AND MST.CMPCOD = DTL.CMPCOD
			   AND MST.CMPCOD = SYS.CMPCOD
			   AND MST.CMPCOD = ARL.CMPCOD
			   AND MST.DOCOWRIDR = ARL.ARLIDR
			   AND MST.MSTDOCNUM = MIS.MSTDOCNUM
			   AND MST.DOCOWRIDR = MIS.DOCOWRIDR
			   AND MST.DUPNUM = MIS.DUPNUM
			   AND MST.SEQNUM = MIS.SEQNUM
			   AND MST.CMPCOD = MIS.CMPCOD                    
			   AND MST.MSTDOCNUM = CTMDTL.MSTDOCNUM(+)
			   AND MST.DOCOWRIDR = CTMDTL.DOCOWRIDR(+)
			   AND MST.DUPNUM = CTMDTL.DUPNUM(+)
			   AND MST.SEQNUM = CTMDTL.SEQNUM(+)
			   AND MST.CMPCOD = CTMDTL.CMPCOD(+)
			   AND CTMDTL.CTMREFNUM = CTM.CTMREFNUM(+)
			   AND CTMDTL.CTMSERNUM = CTM.CTMSERNUM(+)
			   AND CTMDTL.CMPCOD = CTM.CMPCOD(+)
			   AND MST.MSTDOCNUM = ARPSHP.MSTDOCNUM(+)
			   AND MST.DOCOWRIDR = ARPSHP.DOCOWRIDR(+)
			   AND MST.DUPNUM = ARPSHP.DUPNUM(+)
			   AND MST.SEQNUM = ARPSHP.SEQNUM(+)
			   AND MST.CMPCOD = ARPSHP.CMPCOD(+)
			   AND MST.CMPCOD = CUSMST.CMPCOD(+)
			   AND MST.SHPCOD = CUSMST.CUSCOD(+)
			   AND MST.CMPCOD = AGTGRP.CMPCOD(+)
			   AND MST.AGTCOD = AGTGRP.GRPENT(+)
               AND AGTGRP.GRPCATCOD(+) = 'GEN'
			   AND MST.MSTDOCNUM 		= SHPRTG.MSTDOCNUM(+)
			   AND MST.DOCOWRIDR 		= SHPRTG.DOCOWRIDR(+)
			   AND MST.DUPNUM 		 	= SHPRTG.DUPNUM(+)
			   AND MST.SEQNUM 		 	= SHPRTG.SEQNUM(+)
			   AND MST.CMPCOD 		 	= SHPRTG.CMPCOD(+)
				AND MST.CMPCOD      = SHRMST.CMPCOD(+)
				AND MST.ORGCOD      =  SHRMST.ARPCOD(+)
			   AND MST.MSTDOCNUM = ?
			   AND MST.DOCOWRIDR = ?
			   AND MST.DUPNUM = ?
			   AND MST.SEQNUM = ?
			   AND MST.CMPCOD = ?
			   AND SYS.PARCOD = ?
			   AND ARPSHP.ARPCOD = ?
			order by  CTM.CTMREFNUM DESC
		]]>
	 </QRY:Source>
	</QRY:Definition>
	
	
	<QRY:Definition>
	 <QRY:Id>305</QRY:Id>
	 <QRY:Source Name="operations.shipment.findLatestShipmentVersion" Type="NATIVE">
		<![CDATA[
			SELECT MAX(MST.VERNUM) VERNUM
			FROM OPRSHPMSTHIS MST
			WHERE MST.CMPCOD = ?
          AND MST.DOCOWRIDR = ?
          AND MST.MSTDOCNUM = ?
          AND MST.DUPNUM    = ?
          AND MST.SEQNUM    = ?

		]]>
	 </QRY:Source>
	</QRY:Definition>
<QRY:Definition>
	 <QRY:Id>306</QRY:Id>
    <QRY:Source Name="operations.shipment.findAWBAmendmentDetails" Type="NATIVE">
      <![CDATA[ 		
			  SELECT MST.MSTDOCNUM,MST.SHPPFX, MST.CMPCOD , MST.DOCOWRIDR , MST.DUPNUM , MST.SEQNUM , 
				MST.STDPCS, MST.STDWGT, MST.GRSVOL, MST.SHPDES, MST.ORGCOD, MST.DSTCOD, MST.SRCIND, MST.SHPSTA, MST.SCCCOD, 
				CNT.CNSACCNUM, MST.CNSADRONE, CNT.CNSADRTWO, MST.CNSCOD, CNT.CNSCTR, CNT.CNSCTY, CNT.CNSMALIDR, MST.CNSNAM,MST.EXEDAT, 
				CNT.CNSPSTCOD, CNT.CNSSTT, CNT.CNSTELNUM, CNT.SHPACCNUM, MST.SHPADRONE, CNT.SHPADRTWO, MST.SHPCOD, CNT.SHPCTR, CNT.SHPCTY, CNT.SHPMALIDR, 
				MST.SHPNAM, CNT.SHPPSTCOD, CNT.SHPSTT, CNT.SHPTELNUM,MST.HDLINF,MST.LSTUPDTIM MSTLSTUPDTIM, MST.LSTUPDUSR MSTLSTUPDUSR 
				, MST.DTACPTFLG, MST.CONFLG , MST.STDDISWGT , MST.AGTCOD, MST.STDWGTCOD,MST.UBRNUM,MST.EFTAWBFLG 
				FROM 
				OPRSHPMST MST,OPRSHPMSTCNT CNT 
				WHERE MST.DOCOWRIDR = CNT.DOCOWRIDR 
				AND MST.MSTDOCNUM = CNT.MSTDOCNUM 
				AND MST.SEQNUM = CNT.SEQNUM 
				AND MST.DUPNUM = CNT.DUPNUM 
				AND MST.CMPCOD = CNT.CMPCOD 
				AND MST.DOCOWRIDR = ? 
				AND MST.MSTDOCNUM = ?
				AND MST.DUPNUM = ?
				AND MST.SEQNUM = ?
				And Mst.Cmpcod = ?
				
			]]>   
		</QRY:Source>
		</QRY:Definition>

	<QRY:Definition>
	 <QRY:Id>300</QRY:Id>
	 <QRY:Source Name="operations.shipment.findBlockAuthorityDetails" Type="NATIVE">
	 	<![CDATA[
	 	SELECT AUT.CMPCOD,AUT.AUTCOD,AUT.AUTNAM
		FROM OPRBLKAUT AUT
		WHERE AUT.CMPCOD=?
	 	]]>
	 </QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	 <QRY:Id>302</QRY:Id>
	 <QRY:Source Name="operations.shipment.findConfiguredBlocks" Type="NATIVE">
	 	<![CDATA[
			SELECT AUTMST.CMPCOD CMPCOD,AUTMST.BLKTYP BLKTYP,AUTMST.TXNCOD TXNCOD,AUTMST.SERNUM SERNUM,AUTMST.TXNPOR TXNPOR,
				AUTMST.TXNPORTYP TXNPORTYP,AUTMST.BLKSTR BLKSTR,AUTMST.VALCLSNAM VALCLSNAM,AUTMST.LSTUPDTIM LSTUPDTIM,
				AUTMST.LSTUPDUSR LSTUPDUSR,
				AUTPAR.PARCOD BLKPARCOD,AUTPAR.PARVAL BLKPARVAL,AUTPAR.EXCFLG BLKEXCFLG,
				AUTPAR.LSTUPDTIM PARLSTUPDTIM,AUTPAR.LSTUPDUSR PARLSTUPDUSR
				
		FROM OPRAUTBLKMST AUTMST 
			 LEFT OUTER JOIN OPRAUTBLKPAR AUTPAR ON
				AUTMST.CMPCOD = AUTPAR.CMPCOD AND 
				AUTMST.BLKTYP = AUTPAR.BLKTYP AND
				AUTMST.SERNUM = AUTPAR.SERNUM
		WHERE 
				AUTMST.CMPCOD = ?			
		]]>
	 </QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	 <QRY:Id>303</QRY:Id>
	 <QRY:Source Name="operations.shipment.findShipmentBlockExist" Type="NATIVE">
	 	<![CDATA[
			SELECT BLK.TRKNUM,
			  BLK.ARPCOD,
			  BLK.CMPCOD,
			  BLK.DOCOWRIDR,
			  BLK.MSTDOCNUM,
			  BLK.DUPNUM,
			  BLK.SEQNUM,
			  BLK.DOCNUM,
			  BLK.SERNUM,
			  BLK.BLKAUT,
			  BLK.BLKSTRDAT,
			  BLK.BLKEXPDAT,
			  BLK.BLKSTA,
			  BLK.BLKUSR,
			  BLK.RELDAT, BLK.BLKRMK,
			  BLK.LSTUPDTIM,
			  BLK.LSTUPDUSR,
			  BLK.BLKTXNCOD,
			  BLK.HLDRSNCOD,
			  BLK.INHFLG
						
		FROM OPRSHPBLK BLK

		WHERE BLK.CMPCOD = ? AND
			BLK.DOCOWRIDR = ? AND
			BLK.MSTDOCNUM = ? AND
			BLK.DUPNUM = ? AND
			BLK.SEQNUM = ? 
			
		]]>
	 </QRY:Source>
	</QRY:Definition>   
<!--Added by A-4781 for ICRD-37104 & ICRD-18796 -->
		<QRY:Definition>
		<QRY:Id>308</QRY:Id>
		<QRY:Source Name="operations.shipment.findshipmentmasterdetailsforfze" Type="NATIVE">
			<![CDATA[
				SELECT HSE.SHPPFX,
				  HSE.MSTDOCNUM,
				  HSE.DSTCOD,
				  HSE.STDPCS,
				  HSE.OWRCOD,
				  HSE.ORGCOD,
				  HSE.STDWGT,
				  HSE.DOCNUM HSENUM,
				  MST.AGTCOD,
				  MST.AGTNAM,
				  MST.SHPNAM,
				  MST.CNSNAM,MST.DOMFLG,
				  RTG.MSTDOCNUM RTGDOCNUM,
				  RTG.FLTCARIDR,
				  RTG.DSTCOD AS RTGDSTCOD,
				  RTG.FLTCARCOD,
				  RTG.RTGSERNUM,
				  RTG.DUPNUM,
				  (SELECT RTRIM(XMLAGG(XMLELEMENT(A, SHPRTG.DSTCOD,SHPRTG.FLTCARCOD
				    ||' ')).EXTRACT('//text()'), ' ') DSTCOD
				  FROM OPRSHPRTG SHPRTG
				  WHERE SHPRTG.CMPCOD  = HSE.CMPCOD
				  AND SHPRTG.DOCOWRIDR = HSE.DOCOWRIDR
				  AND SHPRTG.MSTDOCNUM = HSE.MSTDOCNUM
				  AND SHPRTG.DUPNUM    = HSE.DUPNUM
				  AND SHPRTG.SEQNUM    = HSE.SEQNUM
				  ) AS RTGDSTCOD,
				  AGTGRP.GRPNAM AGTGRP ,
				  CUSCNS.CUSGRP CUSGRP,
				  CUSSHP.CUSGRP SHPGRP,
				  MST.SHPCOD, MST.CNSCOD CUSCOD
				FROM OPRSHPMST HSE,
				  OPRSHPMST MST,
				  SHRCUSMST CUSCNS,
				  SHRCUSMST CUSSHP,
				  SHRGENMSTGRPDTL AGTGRP,
				  OPRSHPRTG RTG
				WHERE HSE.CMPCOD  = MST.CMPCOD
				AND HSE.MSTDOCNUM = MST.MSTDOCNUM
				AND HSE.DOCOWRIDR = MST.DOCOWRIDR
				AND HSE.DUPNUM    = MST.DUPNUM
				AND HSE.PARSEQNUM =MST.SEQNUM
				AND MST.CMPCOD    = CUSCNS.CMPCOD(+)
				AND MST.CNSCOD    = CUSCNS.CUSCOD(+)
				AND MST.CMPCOD    = CUSSHP.CMPCOD(+)
				AND MST.SHPCOD    = CUSSHP.CUSCOD(+)
				AND MST.CMPCOD    = AGTGRP.CMPCOD(+)
				AND MST.AGTCOD    = AGTGRP.GRPENT(+)
				AND AGTGRP.GRPCATCOD(+) = 'GEN'
				AND HSE.CMPCOD    = RTG.CMPCOD(+)
				AND HSE.MSTDOCNUM = RTG.MSTDOCNUM(+)
				AND HSE.DOCOWRIDR = RTG.DOCOWRIDR(+)
				AND HSE.SEQNUM    = RTG.SEQNUM(+)
				AND HSE.DUPNUM    = RTG.DUPNUM(+)
				AND HSE.CMPCOD    =?
				AND HSE.MSTDOCNUM = ?
				AND HSE.DOCOWRIDR = ?
				AND HSE.DUPNUM    = ?
				AND HSE.SEQNUM    = ?
			]]>
		</QRY:Source>
</QRY:Definition>


<QRY:Definition>
	    <QRY:Id>309</QRY:Id>
	    <QRY:Source Name="operations.shipment.findCDRReport" Type="NATIVE">
	      <![CDATA[     

				SELECT SOFDTL.CMPCOD,
				  SOFDTL.ARPCOD,
				  SOFDTL.DOCOWRIDR,
				  SOFDTL.MSTDOCNUM,
				  SOFDTL.DUPNUM,
				  SOFDTL.SEQNUM,
				  SOFDTL.DISSEQNUM,
				  SOFDTL.FLTCARIDR,
				  SOFDTL.FLTNUM,
				  SOFDTL.FLTSEQNUM,
				  SOFDTL.FLTDAT,
				  SOFDTL.HSEDTL,
				  SOFDTL.PCKPOS,
				  SOFDTL.PCKCOD,
				  SOFDTL.COMCOD,
				  SOFDTL.WGTSHT,
				  SOFDTL.OUTPCK,
				  SOFDTL.DMGPCS,
				  SOFDTL.CNTDTL,
				  SOFDTL.DMGCODPCK,
				  SOFDTL.PCKLBL,
				  SOFDTL.CNTPCK,
				  SOFDTL.CHKCNT,
				  SOFDTL.PCKINS,
				  SOFDTL.PCKINSRMK,
				  SOFDTL.DMGRMK,
				  SOFDTL.REQBYY,
				  SOFDTL.ADMUNT,
				  SOFDTL.SOFDOCNUM,
				  CNTDTL.DMGCNTSEQNUM,
				  CNTDTL.DMGTYP,
				  CNTDTL.PCKNUM,
				  CNTDTL.PCSCNT ,
				  CNTDTL.PCKWGT,
				  DISBLB.IMG,
				  DISBLB.IMGSEQNUM,
				  DISBLB.FILNAM,
				  DISBLB.LSTUPDUSR,
				  DISBLB.LSTUPDTIM,
				  ARLMST.ARLNAM,
				  ARLMST.TWOAPHCOD
				  
				FROM OPRDMGDIS DISMST,
				  OPRDMGSOFDTL SOFDTL,
				  OPRSOFCNTRPTDTL CNTDTL,
				  OPRDMGDISBLB DISBLB,
				  SHRARLACTMST ARLMST
				  
				WHERE DISMST.CMPCOD     = SOFDTL.CMPCOD
				AND DISMST.DOCOWRIDR    = SOFDTL.DOCOWRIDR
				AND DISMST.MSTDOCNUM    = SOFDTL.MSTDOCNUM
				AND DISMST.SEQNUM       = SOFDTL.SEQNUM
				AND DISMST.DUPNUM       = SOFDTL.DUPNUM
				AND DISMST.ARPCOD       = SOFDTL.ARPCOD
				AND DISMST.DISSEQNUM    = SOFDTL.DISSEQNUM
				AND ARLMST.CMPCOD(+) = SOFDTL.CMPCOD
				AND ARLMST.ARLIDR(+) = SOFDTL.FLTCARIDR


				AND SOFDTL.CMPCOD       = CNTDTL.CMPCOD(+)
				AND SOFDTL.DOCOWRIDR    = CNTDTL.DOCOWRIDR(+)
				AND SOFDTL.MSTDOCNUM    = CNTDTL.MSTDOCNUM(+)
				AND SOFDTL.SEQNUM       = CNTDTL.SEQNUM(+)
				AND SOFDTL.DUPNUM       = CNTDTL.DUPNUM(+)
				AND SOFDTL.ARPCOD       = CNTDTL.ARPCOD(+)
				AND SOFDTL.DISSEQNUM    = CNTDTL.DISSEQNUM(+)
				

				AND SOFDTL.CMPCOD       = DISBLB.CMPCOD(+)
				AND SOFDTL.DOCOWRIDR    = DISBLB.DOCOWRIDR(+)
				AND SOFDTL.MSTDOCNUM    = DISBLB.MSTDOCNUM(+)
				AND SOFDTL.SEQNUM       = DISBLB.SEQNUM(+)
				AND SOFDTL.DUPNUM       = DISBLB.DUPNUM(+)
				AND SOFDTL.ARPCOD       = DISBLB.ARPCOD(+)
				AND SOFDTL.DISSEQNUM    = DISBLB.DISSEQNUM(+)
				
				
				AND SOFDTL.CMPCOD       = ?
				AND SOFDTL.DOCOWRIDR    = ?
				AND SOFDTL.MSTDOCNUM    = ?
				AND SOFDTL.SEQNUM       = ?
				AND SOFDTL.DUPNUM       = ?
				AND SOFDTL.ARPCOD       = ?
				AND SOFDTL.SOFDOCNUM 	= ?
	
			]]>
    
		</QRY:Source>
</QRY:Definition>
<!-- Added by A-5274 for ICRD-15333 starts-->
<QRY:Definition>
		<QRY:Id>310</QRY:Id>
		<QRY:Source Name="operations.shipment.findshipmentcontactdetails" Type="NATIVE">
	<![CDATA[
	SELECT CNTIDR , CNTTYP , CNTVAL
FROM OPRSHPCNT CNT ,
  OPRSHPMST MST
WHERE CNT.CMPCOD  = MST.CMPCOD
AND CNT.DOCOWRIDR = MST.DOCOWRIDR
AND CNT.MSTDOCNUM = MST.MSTDOCNUM
AND CNT.DUPNUM    =MST.DUPNUM
AND CNT.SEQNUM    = MST.SEQNUM
AND CNT.CNTTYP  IN ('S','C','B','N','D','X','Y','Z','T','E','A')
AND CNT.cmpcod        =?
AND CNT.DOCOWRIDR     =?
AND CNT.MSTDOCNUM     =?
AND CNT.DUPNUM        =?
AND CNT.SEQNUM        =? 
ORDER BY CNT.CNTTYP,CNT.SERNUM		
			]]>
		</QRY:Source>
	</QRY:Definition>
<!-- Added by A-5274 for ICRD-15333 ends-->	
<QRY:Definition>
		<QRY:Id>311</QRY:Id>
		<QRY:Source Name="operations.shipment.fsadetails_part_one" Type="NATIVE">
			<![CDATA[
				SELECT *
FROM
  (SELECT CMPCOD,
    DOCOWRIDR,
    MSTDOCNUM,
    DUPNUM,
    SEQNUM,
    ARPCOD,
    TXNCOD,
    TXNDES,
    TXNDAT,
    ACTPCS,
    ACTWGT,
    NVL(LAG(ACTPCS) OVER(PARTITION BY CMPCOD, DOCOWRIDR, MSTDOCNUM, DUPNUM, SEQNUM ORDER BY TXNDAT DESC, TXNPRT), 0) PCS,
    NVL(LAG(ACTWGT) OVER(PARTITION BY CMPCOD, DOCOWRIDR, MSTDOCNUM, DUPNUM, SEQNUM ORDER BY TXNDAT DESC, TXNPRT), 0) WGT,
    ACTPCS -NVL(LAG(ACTPCS) OVER(PARTITION BY CMPCOD, DOCOWRIDR, MSTDOCNUM, DUPNUM, SEQNUM ORDER BY TXNDAT DESC, TXNPRT), 0) EVTPCS,
    ACTWGT -NVL(LAG(ACTWGT) OVER(PARTITION BY CMPCOD, DOCOWRIDR, MSTDOCNUM, DUPNUM, SEQNUM ORDER BY TXNDAT DESC, TXNPRT), 0) EVTWGT,
    TXNPRT,
    ORGCOD,
    DSTCOD,
    STDPCS,
    STDWGT,
    STDWGTCOD,
    SHPDES,
    SCCCOD,
    SHPNAM,
    CNSNAM,
    LOCDAT,
    (SELECT RTRIM(xmlagg(xmlelement(e, sernum
      ||'*'
      || txnrefone
      || lPAD(txnrefthr,4,'0')
      || (
      CASE
        WHEN txnrefthr IS NULL
        AND txnrefone IS NULL
        THEN ''
        ELSE '/'
      END)
      || txnreffor
      || (
      CASE
        WHEN txnreften IS NULL
        THEN ''
        ELSE '('
      END)
      || txnreften
      || (
      CASE
        WHEN txnreften IS NULL
        THEN ''
        ELSE ')'
      END)
      || '~'
      ||TXNPCS
      ||'~'
      ||TXNWGT
      ||'~'
      ||TXNREFSEV
      || ',')).EXTRACT('//text()'), ',') enames
    FROM oprshphis shphis
    WHERE shphis.cmpcod = z.cmpcod
    AND shphis.docowridr = z.docowridr
    AND shphis.mstdocnum = z.mstdocnum
    AND shphis.dupnum = z.dupnum
    AND shphis.seqnum = z.seqnum
    AND shphis.txncod = z.txncod
    AND shphis.arpcod = z.arpcod
    AND z.txncod NOT IN ('DLV')
    ) FLTDTL,
    CASE
      WHEN TXNCOD IN('BKD','RCS')
      THEN
        (SELECT RTRIM(XMLAGG(XMLELEMENT(E, sernum
          ||'*'
          || SHPHIS.TXNREFSIX
          || '/')).EXTRACT('//text()'), ',') ENAMES
        FROM OPRSHPHIS SHPHIS
        WHERE SHPHIS.CMPCOD = Z.CMPCOD
        AND SHPHIS.DOCOWRIDR = Z.DOCOWRIDR
        AND SHPHIS.MSTDOCNUM = Z.MSTDOCNUM
        AND SHPHIS.DUPNUM = Z.DUPNUM
        AND SHPHIS.SEQNUM = Z.SEQNUM
        AND SHPHIS.TXNCOD = Z.TXNCOD
        AND SHPHIS.ARPCOD = Z.ARPCOD
        )
      ELSE NULL
    END ULDDTL
  FROM
    (SELECT CMPCOD,
      DOCOWRIDR,
      MSTDOCNUM,
      DUPNUM,
      SEQNUM,
      ORGCOD,
      DSTCOD,
      STDPCS,
      STDWGT,
      STDWGTCOD,
      SHPDES,
      SCCCOD,
      SHPNAM,
      CNSNAM,
      ARPCOD,
      TXNCOD,
      TXNDES,
      SUM(TXNPCS) ACTPCS,
      SUM(TXNWGT) ACTWGT,
      MIN(TXNDATUTC) TXNDAT,
      MIN(TXNDAT) LOCDAT,
      TXNPRT,
      SERNUM
    FROM
      /* RCS,RCT,DLV,MAN,DEP,PRE,RCF,ARR,TFD
      UNION
      OFLD OVCD as DEP
      UNION
      BKD
      */
      /*OTHERS*/
      (
      SELECT MST.CMPCOD,
        MST.DOCOWRIDR,
        MST.MSTDOCNUM,
        MST.DUPNUM,
        MST.SEQNUM,
        ORGCOD,
        DSTCOD,
        MST.STDPCS,
        MST.STDWGT,
        MST.STDWGTCOD,
        MST.SHPDES,
        MST.SCCCOD,
        MST.SHPNAM,
        MST.CNSNAM,
        HIS.ARPCOD,
        HIS.TXNCOD,
        HIS.TXNDES,
        HIS.TXNPCS,
        HIS.TXNWGT,
        HIS.TXNDATUTC,
        HIS.TXNDAT,
        TXNPRT.TXNPRT,
        0 SERNUM
      FROM OPRSHPMST MST
      INNER JOIN OPRSHPHIS HIS
      ON MST.CMPCOD = HIS.CMPCOD
      AND MST.DOCOWRIDR = HIS.DOCOWRIDR
      AND MST.MSTDOCNUM = HIS.MSTDOCNUM
      AND MST.DUPNUM = HIS.DUPNUM
      AND MST.SEQNUM = HIS.SEQNUM
      INNER JOIN OPRTXNPRT TXNPRT
      ON HIS.TXNCOD = TXNPRT.TXNCOD
      AND His.Cmpcod = Txnprt.Cmpcod 		
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>312</QRY:Id>
		<QRY:Source Name="operations.shipment.fsadetails_part_two" Type="NATIVE">
			<![CDATA[
				  /* OFLD OVCD As DEP */
        (
        SELECT CMPCOD,
          DOCOWRIDR,
          MSTDOCNUM,
          DUPNUM,
          SEQNUM,
          ORGCOD,
          DSTCOD,
          STDPCS,
          STDWGT,
          STDWGTCOD,
          SHPDES,
          SCCCOD,
          SHPNAM,
          CNSNAM,
          ARPCOD,
          TXNCOD,
          'Departed' TXNDES,
          SUM(TXNPCS) TXNPCS,
          SUM(TXNWGT) TXNWGT,
          MIN(TXNDATUTC) TXNDATUTC,
          MIN(TXNDAT) TXNDAT,
          TXNPRT,
          0 SERNUM
        FROM
          (SELECT MST.CMPCOD,
            MST.DOCOWRIDR,
            MST.MSTDOCNUM,
            MST.DUPNUM,
            MST.SEQNUM,
            ORGCOD,
            DSTCOD,
            MST.STDPCS,
            MST.STDWGT,
            MST.STDWGTCOD,
            MST.SHPDES,
            MST.SCCCOD,
            MST.SHPNAM,
            MST.CNSNAM,
            HIS.ARPCOD,
            CASE
              WHEN HIS.TXNCOD = 'DIS' AND TXNREFEGT IN ('OFLD','OVCD')
              THEN 'DEP'
              ELSE HIS.TXNCOD
            END TXNCOD,
            HIS.TXNDES,
            CASE
              WHEN HIS.TXNREFEGT ='OFLD'
              THEN (-HIS.TXNPCS)
              WHEN HIS.TXNREFEGT ='OVCD'
              THEN (HIS.TXNPCS)
              ELSE (HIS.TXNPCS)
            END TXNPCS,
            CASE
              WHEN HIS.TXNREFEGT ='OFLD'
              THEN (-HIS.TXNWGT)
              WHEN HIS.TXNREFEGT ='OVCD'
              THEN (HIS.TXNWGT)
              ELSE (HIS.TXNWGT)
            END TXNWGT,
            HIS.TXNDATUTC,
            HIS.TXNDAT,
            TXNPRT.TXNPRT
          FROM OPRSHPMST MST
          INNER JOIN OPRSHPHIS HIS
          ON MST.CMPCOD = HIS.CMPCOD
          AND MST.DOCOWRIDR = HIS.DOCOWRIDR
          AND MST.MSTDOCNUM = HIS.MSTDOCNUM
          AND MST.DUPNUM = HIS.DUPNUM
          AND MST.SEQNUM = HIS.SEQNUM
          INNER JOIN OPRTXNPRT TXNPRT
          ON HIS.TXNCOD = Txnprt.Txncod
          AND His.Cmpcod = Txnprt.Cmpcod 		
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>313</QRY:Id>
		<QRY:Source Name="operations.shipment.fsadetails_part_three" Type="NATIVE">
			<![CDATA[
				  AND HIS.TXNCOD = 'DIS' AND TXNREFEGT IN ('OFLD','OVCD')
          ) X
        GROUP BY X.CMPCOD,
          X.DOCOWRIDR,
          X.MSTDOCNUM,
          X.DUPNUM,
          X.SEQNUM,
          X.ORGCOD,
          X.DSTCOD,
          X.STDPCS,
          X.STDWGT,
          X.STDWGTCOD,
          X.SHPDES,
          X.SCCCOD,
          X.SHPNAM,
          X.CNSNAM,
          X.ARPCOD,
          X.TXNCOD,
          X.TXNDES,
          X.TXNPRT
        )
      UNION
        /*BKD*/
        (
        SELECT CMPCOD,
          DOCOWRIDR,
          MSTDOCNUM,
          DUPNUM,
          SEQNUM,
          ORGCOD,
          DSTCOD,
          STDPCS,
          STDWGT,
          STDWGTCOD,
          SHPDES,
          SCCCOD,
          SHPNAM,
          CNSNAM,
          ARPCOD,
          TXNCOD,
          TXNDES,
          SUM(TXNPCS) ACTPCS,
          SUM(TXNWGT) ACTWGT,
          MIN(TXNDATUTC) TXNDAT,
          MIN(TXNDAT) LOCDAT,
          TXNPRT,
          SERNUM
        FROM
          (SELECT HIS.CMPCOD,
            HIS.DOCOWRIDR,
            HIS.MSTDOCNUM,
            HIS.DUPNUM,
            HIS.SEQNUM,
            ORGCOD,
            DSTCOD,
            MST.STDPCS,
            MST.STDWGT,
            MST.STDWGTCOD,
            MST.SHPDES,
            MST.SCCCOD,
            MST.SHPNAM,
            MST.CNSNAM,
            NVL(HIS.TXNREFELV,HIS.ARPCOD) ARPCOD,
            HIS.TXNCOD,
            HIS.TXNDES,
            CASE
              WHEN HIS.TXNREFNIN IN ('Q','X')
              THEN 0
              ELSE HIS.TXNPCS
            END TXNPCS,
            CASE
              WHEN HIS.TXNREFNIN IN ('Q','X')
              THEN 0
              ELSE HIS.TXNWGT
            END TXNWGT,
            HIS.TXNDATUTC ,
            HIS.TXNDAT,
            TXNPRT.TXNPRT,
            HIS.SERNUM
          FROM OPRSHPMST MST
          INNER JOIN OPRSHPHIS HIS
          ON MST.CMPCOD = HIS.CMPCOD
          AND MST.DOCOWRIDR = HIS.DOCOWRIDR
          AND MST.MSTDOCNUM = HIS.MSTDOCNUM
          AND MST.DUPNUM = HIS.DUPNUM
          AND MST.SEQNUM = HIS.SEQNUM
          INNER JOIN Oprtxnprt Txnprt
          ON His.Txncod = Txnprt.Txncod
          AND His.Cmpcod = Txnprt.Cmpcod 		
		]]>
	 </QRY:Source>
	</QRY:Definition>
		<QRY:Definition>
		<QRY:Id>314</QRY:Id>
		<QRY:Source Name="operations.shipment.fsadetails_part_four" Type="NATIVE">
			<![CDATA[
				UNION ALL
				SELECT *
				FROM
				  (SELECT CMPCOD,
					DOCOWRIDR,
					MSTDOCNUM,
					DUPNUM,
					SEQNUM,
					ARPCOD,
					TXNCOD,
					TXNDES,
					TXNDAT,
					ACTPCS,
					ACTWGT,
					NVL(LAG(ACTPCS) OVER(PARTITION BY CMPCOD, DOCOWRIDR, MSTDOCNUM, DUPNUM, SEQNUM ORDER BY TXNDAT DESC), 0) PCS,
					NVL(LAG(ACTWGT) OVER(PARTITION BY CMPCOD, DOCOWRIDR, MSTDOCNUM, DUPNUM, SEQNUM ORDER BY TXNDAT DESC), 0) WGT,
					ACTPCS -NVL(LAG(ACTPCS) OVER(PARTITION BY CMPCOD, DOCOWRIDR, MSTDOCNUM, DUPNUM, SEQNUM ORDER BY TXNDAT DESC), 0) EVTPCS,
					ACTWGT -NVL(LAG(ACTWGT) OVER(PARTITION BY CMPCOD, DOCOWRIDR, MSTDOCNUM, DUPNUM, SEQNUM ORDER BY TXNDAT DESC), 0) EVTWGT,
					0 TXNPRT,
					ORGCOD,
					DSTCOD,
					STDPCS,
					STDWGT,
					STDWGTCOD,
					SHPDES,
					SCCCOD,
					SHPNAM,
					CNSNAM,
					LOCDAT,
					(SELECT RTRIM(xmlagg(xmlelement(e, sernum
					  ||'*'
					  || txnrefone
					  || lPAD(txnrefthr,4,'0')
					  || (
					  CASE
						WHEN txnrefthr IS NULL
						AND txnrefone IS NULL
						THEN ''
						ELSE '/'
					  END)
					  || txnreffor
					  || (
					  CASE
						WHEN txnreften IS NULL
						THEN ''
						ELSE '('
					  END)
					  || txnreften
					  || (
					  CASE
						WHEN txnreften IS NULL
						THEN ''
						ELSE ')'
					  END)
					  || '~'
					  ||TXNPCS
					  ||'~'
					  ||TXNWGT
					  ||'~'
					  ||TXNREFSEV
					  || ',')).EXTRACT('//text()'), ',') enames
					FROM oprshphis shphis
					WHERE shphis.cmpcod = z.cmpcod
					AND shphis.docowridr = z.docowridr
					AND shphis.mstdocnum = z.mstdocnum
					AND shphis.dupnum = z.dupnum
					AND shphis.seqnum = z.seqnum
					AND shphis.txncod = z.txncod
					AND shphis.arpcod = z.arpcod
					AND z.txncod NOT IN ('DLV')
					) FLTDTL,
					 NULL ULDDTL
				  FROM
					(
						SELECT MST.CMPCOD,
					  MST.DOCOWRIDR,
					  MST.MSTDOCNUM,
					  MST.DUPNUM,
					  MST.SEQNUM,
					  MST.ORGCOD,
					  MST.DSTCOD,
					  MST.STDPCS,
					  MST.STDWGT,
					  MST.STDWGTCOD,
					  MST.SHPDES,
					  MST.SCCCOD,
					  MST.SHPNAM,
					  MST.CNSNAM,
					  HIS.ARPCOD,
					  HIS.TXNCOD,
					  HIS.TXNDES,
					  SUM(TXNPCS) ACTPCS,
					  SUM(TXNWGT) ACTWGT,
					  MIN(TXNDATUTC) TXNDAT,
					  MIN(TXNDAT) LOCDAT,
					  0,
					  HIS.SERNUM
					  FROM OPRSHPMST MST
					  INNER JOIN OPRSHPHIS HIS
					  ON MST.CMPCOD = HIS.CMPCOD
					  AND MST.DOCOWRIDR = HIS.DOCOWRIDR
					  AND MST.MSTDOCNUM = HIS.MSTDOCNUM
					  AND MST.DUPNUM = HIS.DUPNUM
					  AND MST.SEQNUM = HIS.SEQNUM
					  WHERE ((Mst.Cmpcod
						|| Mst.Docowridr
						|| Mst.Mstdocnum
						|| Mst.Dupnum
						|| Mst.Seqnum) In (?))
					  AND HIS.TXNCOD = 'CCD'
					GROUP BY MST.Cmpcod,
					  MST.Docowridr,
					  MST.Mstdocnum,
					  MST.Dupnum,
					  MST.Seqnum,
					  MST.Orgcod,
					  MST.Dstcod,
					  MST.Stdpcs,
					  MST.Stdwgt,
					  MST.Stdwgtcod,
					  MST.Shpdes,
					  MST.Scccod,
					  MST.Shpnam,
					  MST.Cnsnam,
					  HIS.Arpcod,
					  HIS.Txncod,
					  HIS.Txndes,
					  HIS.SERNUM
					Order By Txndat Desc
					) Z
				  )
				WHERE EVTPCS > 0
				 		
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
			<QRY:Id>316</QRY:Id>
			<QRY:Source Name="operations.shipment.findimagesequencenumber" Type="NATIVE">
				<![CDATA[
					select OPRDMGDISBLB_SEQ.nextval as IMGSEQNUM from dual
				]]>
			</QRY:Source>
	</QRY:Definition>
	
	<QRY:Definition>
		<QRY:Id>317</QRY:Id>
		<QRY:Source Name="operations.shipment.validateShipmentDetails_part_one" Type="NATIVE">
			<![CDATA[			
				WITH IDX AS
				(SELECT IDX.DOCOWRIDR,
				IDX.DUPNUM,
				IDX.SEQNUM,
				IDX.CMPCOD,
				IDX.SHPPFX,
				IDX.MSTDOCNUM,
				IDX.DOCTYP,
				IDX.MSTDOCNUM DOCNUM,
				IDX.CPTDAT,
				IDX.OWRCOD,
				IDX.CNSCOD,
				IDX.ORGCOD,
				IDX.DSTCOD,
				IDX.UBRNUM,
				IDX.SHPTYP,
				IDX.PRGSTA,
				IDX.CONFLG,
				IDX.SCCCOD,
				IDX.SHPCOD,
				0 PARSEQNUM,
				IDX.LSTUPDTIM,
				IDX.LSTUPDUSR,
				IDX.SHPSTA,
				IDX.AGTCOD,
				IDX.STDPCS,
				IDX.STDWGT,
				IDX.CRAPRGSTA
			  FROM OPRSHPIDX IDX
			  WHERE IDX.CMPCOD  = ?
			  AND IDX.MSTDOCNUM = ?  
		]]>
		</QRY:Source>
	</QRY:Definition>
	
	<QRY:Definition>
		<QRY:Id>318</QRY:Id>
		<QRY:Source Name="operations.shipment.validateShipmentDetails_part_two" Type="NATIVE">
			<![CDATA[			
				SELECT MST.DOCOWRIDR,
				MST.DUPNUM ,
				MST.SEQNUM,
				MST.SHPPFX,
				MST.CMPCOD,
				MST.MSTDOCNUM,
				MST.DOCTYP,
				MST.DOCNUM,
				MST.CPTDAT,
				MST.SHPSTA,
				MST.CNSCOD,
				MST.ORGCOD,
				MST.DSTCOD,
				MST.UBRNUM,
				MST.SHPTYP,
				MST.CONFLG,
				MST.SCCCOD,
				MST.OWRCOD,
				MST.SHPCOD,
				MST.SHPNAM,
				MST.PARSEQNUM,
				MST.LSTUPDTIM ,
				MST.LSTUPDUSR,
				MST.AGTCOD,
				MST.EFTAWBFLG,
				MST.STDPCS,
				MST.GRSVOL,
				MST.STDWGT,
				MST.PRDNAM,
				MST.PRDPRT,
				 MST.SHPDES,
				MST.PRDCOD,
				MST.RATCUSCOD,
				MST.DTACPTFLG,
				NULL CRAPRGSTA,
				
				MST.PLTFLG 
			  FROM OPRSHPMST MST
			  WHERE MST.CMPCOD  = ?			
			]]>
		</QRY:Source>
	</QRY:Definition>
	
	<QRY:Definition>
		<QRY:Id>319</QRY:Id>
		<QRY:Source Name="operations.shipment.validateShipmentDetails_part_three" Type="NATIVE">
			<![CDATA[	
				  SELECT MST.DOCOWRIDR,
				  MST.DUPNUM,
				  MST.SEQNUM,
				  MST.CMPCOD,
				  MST.SHPPFX,
				  MST.MSTDOCNUM,
				  MST.DOCTYP,
				  MST.DOCNUM DOCNUM,
				  MST.CPTDAT,
				  MST.OWRCOD,
				  MST.CNSCOD,
				  MST.ORGCOD,
				  MST.DSTCOD,
				  MST.UBRNUM,
				  MST.SHPTYP,
				  IDX.PRGSTA,
				  MST.CONFLG,
				  MST.SCCCOD,
				  MST.SHPCOD,
				  MST.SHPNAM,
				  MST.PARSEQNUM,
				  greatest(IDX.LSTUPDTIM,mst.lstupdtim)  as lstupdtim,
				  MST.LSTUPDUSR,
				  MST.SHPSTA,
				  MST.AGTCOD,
				  MST.EFTAWBFLG,
				  MST.STDPCS,
				  MST.GRSVOL,
				  MST.STDWGT,
				 MST.PRDNAM,
				 MST.PRDPRT,
				 MST.SHPDES,
				MST.PRDCOD,
				MST.RATCUSCOD,
				MST.DTACPTFLG,
				IDX.CRAPRGSTA,
				
				MST.PLTFLG 
				FROM MST ,IDX
				WHERE MST.DOCOWRIDR = IDX.DOCOWRIDR(+)
				AND MST.CMPCOD      = IDX.CMPCOD(+)
				AND MST.DUPNUM      = IDX.DUPNUM(+)
				AND MST.MSTDOCNUM   = IDX.MSTDOCNUM(+)
				AND MST.SEQNUM      > 1
				UNION
				SELECT IDX.DOCOWRIDR,
				  IDX.DUPNUM,
				  IDX.SEQNUM,
				  IDX.CMPCOD,
				  IDX.SHPPFX,
				  IDX.MSTDOCNUM,
				  IDX.DOCTYP,
				  IDX.MSTDOCNUM DOCNUM,
				  IDX.CPTDAT,
				  IDX.OWRCOD,
				  IDX.CNSCOD,
				  IDX.ORGCOD,
				  IDX.DSTCOD,
				  IDX.UBRNUM,
				  IDX.SHPTYP,
				  IDX.PRGSTA,
				  IDX.CONFLG,
				  IDX.SCCCOD,
				  IDX.SHPCOD,
				  MST.SHPNAM,				  
				  MST.PARSEQNUM,
				   greatest(IDX.LSTUPDTIM,mst.lstupdtim)  as lstupdtim,
					IDX.LSTUPDUSR,
				  IDX.SHPSTA,
				  IDX.AGTCOD,
				  MST.EFTAWBFLG,
				  IDX.STDPCS,
				  MST.GRSVOL,
				  IDX.STDWGT,
				  MST.PRDNAM,
				  MST.PRDPRT,
				 MST.SHPDES,
				MST.PRDCOD,
				MST.RATCUSCOD,
				MST.DTACPTFLG,
				IDX.CRAPRGSTA,
				
				MST.PLTFLG 
				FROM MST , IDX
				WHERE MST.DOCOWRIDR(+) = IDX.DOCOWRIDR
				AND MST.CMPCOD(+)      = IDX.CMPCOD
				AND MST.DUPNUM(+)      = IDX.DUPNUM
				AND MST.MSTDOCNUM(+)   = IDX.MSTDOCNUM
				AND MST.SEQNUM(+) 	   = IDX.SEQNUM	
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>320</QRY:Id>
		<QRY:Source Name="operations.shipment.findShipmentDetailsForWebServices" Type="NATIVE">
			<![CDATA[	
			    select MST.MSTDOCNUM,MST.DOCOWRIDR,MST.DUPNUM,MST.SEQNUM,MST.CMPCOD,OTHPPT.PPTIDR OTHPPTIDR,OTHPPT.PPTCTY OTHCNTCTY,OTHPPT.PPTNAM OTHPPTNAM,OTHPPT.PPTCOD OTHPPTCOD,OTHPPT.OFFFILREF,OTHPPT.STNCOD OTHSTNCOD,ACC.ACCINFIDR ACCINFIDR, ACC.ACCINF ACCINF,
				        OTHPPT.SERNUM OTHSERNUM,ADLCNT.CNTTYP ADLCNTTYP,ADLCNT.ACCNUM ADLACCNUM,ADLCNT.CNTADR ADLCNTADR,ADLCNT.CNTCTY ADLCNTCTY,
						ADLCNT.VATREGNUM ADLVATREGNUM,ADLCNT.CNTSTT ADLCNTSTT,ADLCNT.CNTCTR ADLCNTCTR,ADLCNT.CNTPSTCOD ADLCNTPSTCOD, ACC.SERNUM ACCSERNUM, SHPCCA.SHPVERNUM SHPVERNUM,MSTMIS.LSTVERNUM LSTVERNUM,ADLCNT.CNTTELNUM ADLCNTTELNUM,  ADLCNT.CNSMALIDR ADLCNSMALIDR,ADLCNT.CNTERINUM ADLCNTERINUM, ADLCNT.CTTCUSNAM ADLCNTNAM, ADLCNT.CTTCUSCOD ADLCNTCOD,
						ADLCNT.CSTLOCNUM ADLCSTLOCNUM
				   FROM OPRSHPMST MST ,
				        OPRSHPMSTMIS MSTMIS ,
					    OPRSHPACCDTL ACC,
						OPRSHPOTHPPT OTHPPT,
						OPRSHPADLCNT ADLCNT,
						OPRSHPCCA SHPCCA
				  WHERE MST.CMPCOD  = MSTMIS.CMPCOD
                   AND  MST.DOCOWRIDR = MSTMIS.DOCOWRIDR
                   AND  MST.MSTDOCNUM = MSTMIS.MSTDOCNUM
                   AND  MST.DUPNUM    =MSTMIS.DUPNUM
                   AND  MST.SEQNUM    = MSTMIS.SEQNUM
				   AND  MST.CMPCOD  = ACC.CMPCOD(+)				        
                   AND  MST.DOCOWRIDR = ACC.DOCOWRIDR(+)
                   AND  MST.MSTDOCNUM = ACC.MSTDOCNUM(+)
                   AND  MST.DUPNUM    =ACC.DUPNUM(+)
                   AND  MST.SEQNUM    = ACC.SEQNUM(+)
				   AND  MST.CMPCOD  = OTHPPT.CMPCOD(+)
                   AND  MST.DOCOWRIDR = OTHPPT.DOCOWRIDR(+)
                   AND  MST.MSTDOCNUM = OTHPPT.MSTDOCNUM(+)
                   AND  MST.DUPNUM    =OTHPPT.DUPNUM(+)
                   AND  MST.SEQNUM    = OTHPPT.SEQNUM(+)
				   AND  MST.CMPCOD  = ADLCNT.CMPCOD(+)
                   AND  MST.DOCOWRIDR = ADLCNT.DOCOWRIDR(+)
                   AND  MST.MSTDOCNUM = ADLCNT.MSTDOCNUM(+)
                   AND  MST.DUPNUM    =ADLCNT.DUPNUM(+)
                   AND  MST.SEQNUM    = ADLCNT.SEQNUM(+)
				   AND ADLCNT.CNTTYP(+) IN ('S','C','B','N','D','X','Y','Z','T','E','A')
				   AND  MSTMIS.CMPCOD  = SHPCCA.CMPCOD(+)
                   AND  MSTMIS.DOCOWRIDR = SHPCCA.DOCOWRIDR(+)
                   AND  MSTMIS.MSTDOCNUM = SHPCCA.MSTDOCNUM(+)
                   AND  MSTMIS.DUPNUM    =SHPCCA.DUPNUM(+)
                   AND  MSTMIS.SEQNUM    = SHPCCA.SEQNUM(+)
				   AND  MSTMIS.LSTVERNUM = SHPCCA.SHPVERNUM(+)
				   AND  MST.CMPCOD = ?
				   AND  MST.DOCOWRIDR = ?
				   AND  MST.MSTDOCNUM = ?
				   AND  MST.DUPNUM = ?
				   AND  MST.SEQNUM = ?
		]]>
	 </QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
		<QRY:Id>321</QRY:Id>
		<QRY:Source Name="operations.shipment.findHAWBTypeCount" Type="NATIVE">
			<![CDATA[		
				SELECT COUNT(1)AS TCOUNT, LSTSHPSRC
				FROM
				  (SELECT row_number() OVER (PARTITION BY MST.CMPCOD,MST.MSTDOCNUM,MST.DOCOWRIDR,MST.DUPNUM,MST.SEQNUM 
				  	order by MST.vernum DESC) AS rownumber, MST.VERNUM, MST.SHPSTA, MST.MSTDOCNUM, MST.DOCNUM, MST.SEQNUM, 
				  	MST.DUPNUM, (CASE MIS.MANUPD WHEN 'Y' THEN 'MAN' ELSE 'ELE' END) LSTSHPSRC
				  FROM OPRSHPMSTHIS MST, OPRSHPMSTMISHIS MIS
				  WHERE MIS.CMPCOD  = MST.CMPCOD
				  AND MIS.MSTDOCNUM = MST.MSTDOCNUM
				  AND MIS.DOCOWRIDR = MST.DOCOWRIDR
				  AND MIS.DUPNUM    = MST.DUPNUM
				  AND MIS.SEQNUM    = MST.SEQNUM
				  AND MIS.VERNUM    = MST.VERNUM
				  AND MIS.SEQNUM    > 1
				  AND MST.CMPCOD    = ?
				  AND MST.DOCOWRIDR = ?
				  AND MST.MSTDOCNUM = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	
	<QRY:Definition>
	 <QRY:Id>322</QRY:Id>
	 <QRY:Source Name="operations.shipment.findLatestCCAVersion" Type="NATIVE">
		<![CDATA[
			SELECT MAX(CCAHIS.VERNUM) VERNUM
				FROM OPRSHPCCAHIS CCAHIS
			WHERE CCAHIS.CMPCOD = ?
		          AND CCAHIS.DOCOWRIDR = ?
		          AND CCAHIS.MSTDOCNUM = ?
		          AND CCAHIS.DUPNUM    = ?
		          AND CCAHIS.SEQNUM    = ?
				  AND CCAHIS.CORNUM    = ?
		]]>
	 </QRY:Source>
	</QRY:Definition>
	
	
	<QRY:Definition>
		<QRY:Id>325</QRY:Id>
		<QRY:Source Name="operations.shipment.cto.delivery.findshipmentsforcollectionlist.queryprefix" Type="NATIVE">
			<![CDATA[		
				SELECT SUBQRY.CMPCOD,SUBQRY.OWRCOD, 
NVL(SUBQRY.ULDNUM, 'BULK') ULDNUM, 
SEGULDSHP.ULDNUM SEGULDNUM,
NOTULD.ULDNUM DLVULDNUM,
 (SELECT DNULD.ULDNUM
  FROM OPRSHPDLVNOTULD DNULD
  WHERE DNULD.DLVNOTNUM = DLVNOTFLT.DLVNOTNUM
  AND DNULD.CMPCOD      = DLVNOTFLT.CMPCOD
  AND DNULD.ARPCOD      = DLVNOTFLT.ARPCOD
  AND DNULD.ULDNUM      =SEGULDSHP.ULDNUM
  AND DNULD.ULDNUM      = SUBQRY.ULDNUM
  ) FLTULDNUM,
						  SUBQRY.ULDSHPPCS, 
						  SUBQRY.ULDSHPWGT, 
						  SUBQRY.DOCOWRIDR, 
						  SUBQRY.MSTDOCNUM, 
						  SUBQRY.DUPNUM, 
						  SUBQRY.SEQNUM, 
						  SUBQRY.PARSEQNUM,
						  SUBQRY.TOTDLVPCS, 
						  SUBQRY.TOTDLVWGT, 
						  SUBQRY.RCVPCS, 
						  SUBQRY.RCVWGT, 
						  SUBQRY.ARPCOD, 
						  SUBQRY.DOCHDRFLG, 
						  SUBQRY.STDPCS, 
						  SUBQRY.STDWGT, 
						  SUBQRY.SHPPFX, 
						  SUBQRY.DOCNUM, 
						  SUBQRY.PRDCOD, 
						  SUBQRY.PRDNAM, 
						  SUBQRY.AGTCOD, 
						  SUBQRY.SCCCOD, 
NVL(SUBQRY.CNSCOD, 
(SELECT parval 
FROM shrsyspar 
WHERE cmpcod = ? 
AND parcod ='common.customer.walkincustomer' 
)) CNSCOD, 
						  SUBQRY.CNSNAM,
						  SUBQRY.ORGCOD, 
						  SUBQRY.DSTCOD, 
						  SUBQRY.CONFLG, 
						  SUBQRY.CONBDNFLG, 
						  SUBQRY.AVLPCS, 
						  SUBQRY.AVLWGT, 
						  SUBQRY.ARPLSTUPDTIM, 
						  SUBQRY.CURCOD, 
						  SUBQRY.DOMFLG,
						  SUBQRY.PAYTYP, 
						  SUBQRY.SCCMATVAL, 
						  SUBQRY.CUSSCCCOD, 
						  SUBQRY.CUSAGTCOD,
						  AGTMST.AGTNAM CUSAGTNAM,
						  CUSMST.CUSNAM,
						  SUBQRY.CUSPRI, 
						  SUBQRY.CUSMAXPRI, 
						  DLVNOT.DLVNOTSTA, 
						  DLVNOT.DLVNOTPCS, 
						  DLVNOT.DLVNOTWGT, 
						  DLVNOT.DLVNOTNUM, 
						  DLVNOT.DNTISSDAT, 
						  DLVNOT.PAYADVNUM, 
						  DLVNOT.PAYADVISSDAT, 
						  DLVNOT.PAYADVEXPDAT, 
						  DLVNOT.DLVPCS, 
						  DLVNOT.DLVWGT, 
						  NVL((SELECT NVL(NVL(DLVULD.DLVNOTPCS, DLVNOT.DLVNOTPCS), 0)
						  FROM OPRSHPDLVNOTULD DLVULD, OPRSHPDLVNOTFLT DLVFLT
						  WHERE DLVFLT.FLTNUM  = SEGULDSHP.FLTNUM
						  AND DLVFLT.FLTCARIDR = SEGULDSHP.FLTCARIDR
						  AND DLVFLT.FLTSEQNUM = SEGULDSHP.FLTSEQNUM
						  AND DLVFLT.SEGSERNUM = SEGULDSHP.SEGSERNUM
						  AND DLVFLT.DLVNOTNUM = DLVNOT.DLVNOTNUM
						  AND DLVFLT.ARPCOD    = DLVNOT.ARPCOD
						  AND DLVFLT.CMPCOD    = DLVNOT.CMPCOD
						  AND DLVFLT.DLVNOTNUM = DLVULD.DLVNOTNUM(+)
						  AND  DLVFLT.ARPCOD  = DLVULD.ARPCOD(+)
						  AND  DLVFLT.CMPCOD = DLVULD.CMPCOD(+)
						   AND ((NOTULD.ULDNUM IS NULL 
							AND (SUBQRY.ULDNUM IS NULL
						  OR SUBQRY.ULDNUM <> SEGULDSHP.ULDNUM))
						  OR (SUBQRY.ULDNUM = SEGULDSHP.ULDNUM
						  AND SEGULDSHP.ULDNUM    = DLVULD.ULDNUM))
						  ),0)FLTDLVNOTPCS,
						  NVL((SELECT NVL(NVL(DLVULD.DLVNOTWGT, DLVNOT.DLVNOTWGT), 0)
						  FROM OPRSHPDLVNOTULD DLVULD, OPRSHPDLVNOTFLT DLVFLT
						  WHERE DLVFLT.FLTNUM  = SEGULDSHP.FLTNUM
						  AND DLVFLT.FLTCARIDR = SEGULDSHP.FLTCARIDR
						  AND DLVFLT.FLTSEQNUM = SEGULDSHP.FLTSEQNUM
						  AND DLVFLT.SEGSERNUM = SEGULDSHP.SEGSERNUM
						  AND DLVFLT.DLVNOTNUM = DLVNOT.DLVNOTNUM
						  AND DLVFLT.ARPCOD    = DLVNOT.ARPCOD
						  AND DLVFLT.CMPCOD    = DLVNOT.CMPCOD
						  AND DLVFLT.DLVNOTNUM = DLVULD.DLVNOTNUM(+)
						  AND  DLVFLT.ARPCOD  = DLVULD.ARPCOD(+)
						  AND  DLVFLT.CMPCOD = DLVULD.CMPCOD(+)
						  AND ((NOTULD.ULDNUM IS NULL 
							AND (SUBQRY.ULDNUM IS NULL
						  OR SUBQRY.ULDNUM <> SEGULDSHP.ULDNUM))
						  OR (SUBQRY.ULDNUM = SEGULDSHP.ULDNUM
						  AND SEGULDSHP.ULDNUM    = DLVULD.ULDNUM))
						  ),0)FLTDLVNOTWGT, 
						  NVL((SELECT NVL(NVL(DLVULD.DLVPCS, DLVNOT.DLVPCS), 0)
						  FROM OPRSHPDLVNOTULD DLVULD, OPRSHPDLVNOTFLT DLVFLT
						  WHERE DLVFLT.FLTNUM  = SEGULDSHP.FLTNUM
						  AND DLVFLT.FLTCARIDR = SEGULDSHP.FLTCARIDR
						  AND DLVFLT.FLTSEQNUM = SEGULDSHP.FLTSEQNUM
						  AND DLVFLT.SEGSERNUM = SEGULDSHP.SEGSERNUM
						  AND DLVFLT.DLVNOTNUM = DLVNOT.DLVNOTNUM
						  AND DLVFLT.ARPCOD    = DLVNOT.ARPCOD
						  AND DLVFLT.CMPCOD    = DLVNOT.CMPCOD
						  AND DLVFLT.DLVNOTNUM = DLVULD.DLVNOTNUM(+)
						  AND  DLVFLT.ARPCOD  = DLVULD.ARPCOD(+)
						  AND  DLVFLT.CMPCOD = DLVULD.CMPCOD(+)
						  AND ((NOTULD.ULDNUM IS NULL 
							AND (SUBQRY.ULDNUM IS NULL
						  OR SUBQRY.ULDNUM <> SEGULDSHP.ULDNUM))
						  OR (SUBQRY.ULDNUM = SEGULDSHP.ULDNUM
						  AND SEGULDSHP.ULDNUM    = DLVULD.ULDNUM))
						  ),0)FLTDLVPCS, 
						  NVL((SELECT NVL(NVL(DLVULD.DLVWGT, DLVNOT.DLVWGT), 0)
						  FROM OPRSHPDLVNOTULD DLVULD, OPRSHPDLVNOTFLT DLVFLT
						  WHERE DLVFLT.FLTNUM  = SEGULDSHP.FLTNUM
						  AND DLVFLT.FLTCARIDR = SEGULDSHP.FLTCARIDR
						  AND DLVFLT.FLTSEQNUM = SEGULDSHP.FLTSEQNUM
						  AND DLVFLT.SEGSERNUM = SEGULDSHP.SEGSERNUM
						  AND DLVFLT.DLVNOTNUM = DLVNOT.DLVNOTNUM
						  AND DLVFLT.ARPCOD    = DLVNOT.ARPCOD
						  AND DLVFLT.CMPCOD    = DLVNOT.CMPCOD
						  AND DLVFLT.DLVNOTNUM = DLVULD.DLVNOTNUM(+)
						  AND  DLVFLT.ARPCOD  = DLVULD.ARPCOD(+)
						  AND  DLVFLT.CMPCOD = DLVULD.CMPCOD(+)
						   AND ((NOTULD.ULDNUM IS NULL 
							AND (SUBQRY.ULDNUM IS NULL
						  OR SUBQRY.ULDNUM <> SEGULDSHP.ULDNUM))
						  OR (SUBQRY.ULDNUM = SEGULDSHP.ULDNUM
						  AND SEGULDSHP.ULDNUM    = DLVULD.ULDNUM))
						  ),0)FLTDLVWGT,
						  DLVNOTLOC.LOCPCS,
						  DLVNOTLOC.LOCCOD, 
						  DLVNOTLOC.DLVNOTNUM LOCDLVNOTNUM,
						  DLVNOTLOC.WHSCOD,
						  DLVNOTLOC.STUCOD,
						  DLVNOTLOC.DLVNOTPCS LOCDLVNOTPCS,
						  SHPDTL.LSTUPDTIM SHPLSTUPDTIM, 
						  SUBQRY.TOTDLVNOTPCS, 
						  SUBQRY.TOTDLVNOTWGT, 
						  SUBQRY.CNSFLG, 
						  AGTMST.CUSCOD, 
						  ADLCNT.CTTCUSCOD DLVAGTCOD, 
						ADLCNT.CTTCUSNAM DLVAGTNAM,
						  ACC.SRVCRGCLS, 
						  ACC.TOTCCF, 
						  SHPBLK.blksta, 
						  SHPBLK.blkrmk, 
						  SHPBLK.SERNUM BLKSERNUM,
						 shpblk.BLKAUT BLKAUT,
						  SHPMIS.SCICOD, 
COLLST.DLVIDR, 
COLLST.collststa, 
COLLST.expdat, 
NVL(LSTSHP.ULDNUM, 'BULK') COLLSTULDNUM, 
LSTSHP.Collstpcs, 
LSTSHP.collstwgt, 
LSTSHP.dlvpcs Collstdlvpcs, 
LSTSHP.dlvwgt collstdlvwgt, 
DLVNOT.ADLINFONE, 
DLVNOT.ADDINFTWO, 
DLVNOT.ADDINFTHR,
SEGULDSHP.RCVPCS FLTPCS,
SEGULDSHP.RCVWGT FLTWGT,
SEGULDSHP.FLTNUM,
SEGULDSHP.FLTCARIDR,
SEGULDSHP.FLTSEQNUM,
SEGULDSHP.SEGSERNUM,
SEGULDSHP.CMPCOD FLTCMPCOD,
DLVNOTFLT.DLVNOTNUM FLTDN,
NVL(DLVNOTFLT.FLTCARIDR,0) FLTDNCARIDR,
DLVNOTFLT.FLTNUM FLTDNFLTNUM,
NVL(DLVNOTFLT.FLTSEQNUM,0) FLTDNFLTSEQNUM,
NVL(DLVNOTFLT.SEGSERNUM,0) FLTDNSERNUM,
IMPFLT.FLTDAT FLTDAT,
(CASE ARL.APHCODUSE WHEN 2
	THEN ARL.TWOAPHCOD
	ELSE ARL.THRAPHCOD
	END) FLTCARCOD,
  (SELECT RCVPCS
  FROM oprsegshp shp
  WHERE SHP.CMPCOD  = SUBQRY.CMPCOD
  AND SHP.DOCOWRIDR = SUBQRY.DOCOWRIDR
  AND SHP.MSTDOCNUM = SUBQRY.MSTDOCNUM
  AND SHP.DUPNUM    = SUBQRY.DUPNUM
  AND SHP.SEQNUM    = SUBQRY.SEQNUM
  AND SHP.FLTCARIDR =SEGULDSHP.FLTCARIDR
  AND SHP.FLTNUM    =SEGULDSHP.FLTNUM
  AND SHP.FLTSEQNUM =SEGULDSHP.FLTSEQNUM
  AND SHP.SEGSERNUM =SEGULDSHP.SEGSERNUM
  ) FLTSHPPCS,
   (SELECT RCVWGT
  FROM oprsegshp shp
  WHERE SHP.CMPCOD  = SUBQRY.CMPCOD
  AND SHP.DOCOWRIDR = SUBQRY.DOCOWRIDR
  AND SHP.MSTDOCNUM = SUBQRY.MSTDOCNUM
  AND SHP.DUPNUM    = SUBQRY.DUPNUM
  AND SHP.SEQNUM    = SUBQRY.SEQNUM
  AND SHP.FLTCARIDR =SEGULDSHP.FLTCARIDR
  AND SHP.FLTNUM    =SEGULDSHP.FLTNUM
  AND SHP.FLTSEQNUM =SEGULDSHP.FLTSEQNUM
  AND SHP.SEGSERNUM =SEGULDSHP.SEGSERNUM
  ) FLTSHPWGT,
  (SELECT MST.PLTFLG FROM OPRSHPMST MST
  WHERE MST.CMPCOD  = SUBQRY.CMPCOD
  AND MST.DOCOWRIDR = SUBQRY.DOCOWRIDR
  AND MST.MSTDOCNUM = SUBQRY.MSTDOCNUM
  AND MST.DUPNUM    = SUBQRY.DUPNUM
  AND MST.SEQNUM    =1)PLTFLG,
   (select CASE 
WHEN (SHPMST.PLTFLG = 'Y' AND ARPSHP.PLTUSEFLG = 'Y' AND SHPDTL.PLTUSEFLG ='Y') 
THEN 'Y' 
ELSE 'N'
END pltinuse
FROM OPRSHPMST SHPMST 
INNER JOIN OPRARPSHP ARPSHP 
  ON SHPMST.CMPCOD = ARPSHP.CMPCOD 
  AND SHPMST.DOCOWRIDR = ARPSHP.DOCOWRIDR 
  AND SHPMST.MSTDOCNUM = ARPSHP.MSTDOCNUM 
  AND SHPMST.DUPNUM = ARPSHP.DUPNUM 
  AND SHPMST.SEQNUM = ARPSHP.SEQNUM
INNER JOIN OPRSHPDTL SHPDTL
  ON SHPMST.CMPCOD     = SHPDTL.CMPCOD
  AND SHPMST.DOCOWRIDR =SHPDTL.DOCOWRIDR
  AND SHPMST.MSTDOCNUM =SHPDTL.MSTDOCNUM
  AND SHPMST.DUPNUM    =SHPDTL.DUPNUM
  AND SHPMST.SEQNUM    =SHPDTL.SEQNUM
WHERE SHPMST.SEQNUM =1
AND SHPMST.CMPCOD = SUBQRY.CMPCOD
AND SHPMST.DOCOWRIDR = SUBQRY.DOCOWRIDR
AND SHPMST.MSTDOCNUM = SUBQRY.MSTDOCNUM
AND SHPMST.DUPNUM = SUBQRY.DUPNUM
AND ARPSHP.ARPCOD = SUBQRY.ARPCOD) PLTUSEFLG
						FROM 
						  (SELECT K.CMPCOD, 
							K.ULDNUM, 
                            K.OWRCOD,							
							K.ULDSHPPCS, 
							K.ULDSHPWGT, 
							K.DOCOWRIDR, 
							K.MSTDOCNUM, 
							K.DUPNUM, 
							K.SEQNUM, 
							K.PARSEQNUM,
							K.TOTDLVPCS, 
							K.TOTDLVWGT, 
							K.RCVPCS, 
							K.RCVWGT, 
							K.ARPCOD, 
							K.DOCHDRFLG, 
							K.STDPCS, 
							K.STDWGT, 
							K.SHPPFX, 
							K.DOCNUM, 
							K.PRDCOD, 
							K.PRDNAM, 
							K.AGTCOD, 
							K.SCCCOD, 
							K.CNSCOD, 
							K.CNSNAM,
							K.ORGCOD, 
							K.DSTCOD, 
							K.CONFLG, 
							K.CONBDNFLG, 
							K.AVLPCS, 
							K.AVLWGT, 
							K.ARPLSTUPDTIM, 
							K.CURCOD, 
							K.PAYTYP, 
							K.SCCMATVAL, 
							K.CUSSCCCOD, 
							K.CUSAGTCOD, 
							K.CUSCOD, 
							k.DOMFLG,
							K.CUSPRI, 
							K.CUSMAXPRI, 
							K.TOTDLVNOTPCS, 
							K.TOTDLVNOTWGT, 
K.CNSFLG 
						  FROM 
							(SELECT M.CMPCOD, 
                              M.OWRCOD,							
							  M.ULDNUM, 
							  M.ULDSHPPCS, 
							  M.ULDSHPWGT, 
							  M.DOCOWRIDR, 
							  M.MSTDOCNUM, 
							  M.DUPNUM, 
							  M.SEQNUM, 
							  M.PARSEQNUM,
							  M.TOTDLVPCS, 
							  M.TOTDLVWGT, 
							  M.RCVPCS, 
							  M.RCVWGT, 
							  M.ARPCOD, 
							  M.DOCHDRFLG, 
							  M.STDPCS, 
							  M.STDWGT, 
							  M.SHPPFX, 
							  M.DOCNUM, 
							  M.PRDCOD, 
							  M.PRDNAM, 
							  M.AGTCOD, 
							  M.SCCCOD, 
							  M.CNSCOD, 
							  M.CNSNAM, 							  
							  M.ORGCOD, 
							  M.DSTCOD, 
							  M.CONFLG, 
							  M.CONBDNFLG, 
							  M.AVLPCS, 
							  M.AVLWGT, 
							  M.ARPLSTUPDTIM, 
							  M.CURCOD, 
							  M.DOMFLG,
							  M.PAYTYP, 
							  M.SCCMATVAL, 
							  M.CUSSCCCOD, 
							  M.CUSAGTCOD, 
							  M.CUSCOD, 
							  M.CUSPRI, 
							  M.TOTDLVNOTPCS, 
							  M.TOTDLVNOTWGT, 
							  MAX(M.CUSPRI) OVER(PARTITION BY M.MSTDOCNUM, M.DOCOWRIDR, M.SEQNUM, M.DUPNUM, M.CMPCOD) CUSMAXPRI, 
 M.CNSFLG 
							FROM 
							  (SELECT Q.CMPCOD, 
                                Q.OWRCOD,							  
								Q.ULDNUM, 
								Q.ULDSHPPCS, 
								Q.ULDSHPWGT, 
								Q.DOCOWRIDR, 
								Q.MSTDOCNUM, 
								Q.DUPNUM, 
								Q.SEQNUM, 
								Q.PARSEQNUM,
								Q.TOTDLVPCS, 
								Q.TOTDLVWGT, 
								Q.RCVPCS, 
								Q.RCVWGT, 
								Q.ARPCOD, 
								Q.DOCHDRFLG, 
								Q.STDPCS, 
								Q.STDWGT, 
								Q.SHPPFX, 
								Q.DOCNUM, 
								Q.PRDCOD, 
								Q.PRDNAM, 
								Q.AGTCOD, 
								Q.SCCCOD, 
								Q.CNSCOD, 
								Q.CNSNAM,								
								Q.ORGCOD, 
								Q.DSTCOD, 
								Q.CONFLG, 
								Q.CONBDNFLG, 
								Q.AVLPCS, 
								Q.AVLWGT, 
								Q.ARPLSTUPDTIM, 
								Q.CURCOD, 
								Q.DOMFLG,
								Q.PAYTYP, 
								Q.SCCMATVAL, 
								Q.CUSSCCCOD, 
								Q.CUSAGTCOD, 
								Q.CUSCOD, 
								Q.TOTDLVNOTPCS, 
								Q.TOTDLVNOTWGT, 
								CASE 
								  WHEN Q.SCCMATVAL > 0 
								  AND Q.CUSSCCCOD IS NOT NULL 
								  THEN 2 
								  WHEN Q.CUSSCCCOD IS NULL 
								  THEN 0 
								  ELSE -1 
								END CUSPRI, 
Q.CNSFLG 
        
							
							  FROM 
								(
			]]>
		</QRY:Source>
	</QRY:Definition>
	
	<QRY:Definition>
		<QRY:Id>326</QRY:Id>
		<QRY:Source Name="operations.shipment.cto.delivery.findshipmentsforcollectionlist.basequeryone" Type="NATIVE">
			<![CDATA[		
				SELECT SHPMST.CMPCOD,SHPMST.OWRCOD, 
          ULDSHP.ULDNUM, 
          NVL(ULDSHP.NUMPCS, 0) ULDSHPPCS, 
          NVL(ULDSHP.WGT, 0) ULDSHPWGT, 
          SHPMST.DOCOWRIDR, 
          SHPMST.MSTDOCNUM, 
          SHPMST.DUPNUM, 
          SHPMST.SEQNUM, 
		  SHPMST.PARSEQNUM,
          ARPSHP.TOTDLVPCS, 
          ARPSHP.TOTDLVWGT, 
(( 
CASE 
WHEN ARPSHP.DCSFLG = 'Y' 
THEN ARPSHP.DCSPCS 
ELSE ARPSHP.RCVPCS 
END)+ARPSHP.ACPPCS) RCVPCS, 
(( 
CASE 
WHEN ARPSHP.DCSFLG = 'Y' 
THEN ARPSHP.DCSWGT 
ELSE ARPSHP.RCVWGT 
END)+ARPSHP.ACPWGT) RCVWGT, 
          ARPSHP.ARPCOD, 
               (SELECT DISTINCT arpshp.DOCHDRFLG
                FROM OPRARPSHP arpshp
                WHERE arpshp.MSTDOCNUM =SHPMST.MSTDOCNUM
                AND arpshp.DOCOWRIDR   =SHPMST.DOCOWRIDR
                AND arpshp.DUPNUM      =SHPMST.DUPNUM
                AND arpshp.SEQNUM      =1
                AND arpshp.CMPCOD      =SHPMST.CMPCOD
				AND arpshp.ARPCOD =?
                ) AS DOCHDRFLG,
          SHPMST.STDPCS, 
          SHPMST.STDWGT, 
          SHPMST.SHPPFX, 
          SHPMST.DOCNUM, 
          SHPMST.PRDCOD, 
          SHPMST.PRDNAM, 
          SHPMST.AGTCOD, 
          SHPMST.SCCCOD, 
          SHPMST.CNSCOD, 
		  SHPMST.CNSNAM, 
          SHPMST.ORGCOD, 
          SHPMST.DSTCOD, 
          SHPMST.CONFLG, 
          ARPSHP.CONBDNFLG, 
          ARPSHP.AVLPCS, 
          ARPSHP.AVLWGT, 
          ARPSHP.LSTUPDTIM ARPLSTUPDTIM, 
          SHPMST.CURCOD, 
		  (SELECT DOMFLG FROM  OPRSHPMST MSTAWB
		  WHERE MSTAWB.CMPCOD      = SHPMST.CMPCOD
		  AND MSTAWB.MSTDOCNUM = SHPMST.MSTDOCNUM
		  AND MSTAWB.DOCOWRIDR = SHPMST.DOCOWRIDR
		  AND MSTAWB.SEQNUM    = 1
		  AND MSTAWB.DUPNUM    = SHPMST.DUPNUM) DOMFLG,
          SHPMST.PAYTYP, 
INSTR(? 
|| CUSAGT.SCCCOD 
|| ?, ?
|| SHPMST.SCCCOD 
|| ?) SCCMATVAL, 
          CUSAGT.SCCCOD CUSSCCCOD, 
          CUSAGT.AGTCOD CUSAGTCOD, 
          CUSAGT.CUSCOD, 
          ARPSHP.TOTDLVNOTPCS, 
          ARPSHP.TOTDLVNOTWGT, 
          'Y' CNSFLG ,
		  NULL CUSPRI,
NULL CUSMAXPRI 
        FROM OPRSHPMST SHPMST 
        INNER JOIN OPRARPSHP ARPSHP 
        ON SHPMST.CMPCOD = ARPSHP.CMPCOD 
        AND SHPMST.DOCOWRIDR = ARPSHP.DOCOWRIDR 
        AND SHPMST.MSTDOCNUM = ARPSHP.MSTDOCNUM 
        AND SHPMST.DUPNUM = ARPSHP.DUPNUM 
        AND SHPMST.SEQNUM = ARPSHP.SEQNUM 
AND EXISTS 
(SELECT 1 
FROM OPRSHPMST 
WHERE CMPCOD = ARPSHP.CMPCOD 
        AND DOCOWRIDR = ARPSHP.DOCOWRIDR
        AND MSTDOCNUM = ARPSHP.MSTDOCNUM
        AND DUPNUM    = ARPSHP.DUPNUM
        AND DSTCOD = ARPSHP.ARPCOD 
AND SEQNUM =1 
) 
  ]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>4450</QRY:Id>
		<QRY:Source Name="operations.shipment.cto.delivery.findshipmentsforcollectionlist.basequeryoneparttwo" Type="NATIVE">
			<![CDATA[	     
  LEFT OUTER JOIN OPRSEGSHP SEGSHP
        ON SEGSHP.CMPCOD     = SHPMST.CMPCOD
        AND SEGSHP.DOCOWRIDR = SHPMST.DOCOWRIDR
        AND SEGSHP.MSTDOCNUM = SHPMST.MSTDOCNUM
        AND SEGSHP.DUPNUM    = SHPMST.DUPNUM
        
  
        LEFT OUTER JOIN OPRFLTSEG FLTSEG
        ON FLTSEG.CMPCOD    = SEGSHP.CMPCOD
        AND FLTSEG.FLTCARIDR=SEGSHP.FLTCARIDR
        AND FLTSEG.FLTNUM   =SEGSHP.FLTNUM
        AND FLTSEG.FLTSEQNUM=SEGSHP.FLTSEQNUM
        AND FLTSEG.SEGSERNUM=SEGSHP.SEGSERNUM
        AND FLTSEG.POU=ARPSHP.ARPCOD
LEFT OUTER JOIN OPRSHPDLVNOT DLVNOT 
ON DLVNOT.CMPCOD = SHPMST.CMPCOD 
AND DLVNOT.DOCOWRIDR = SHPMST.DOCOWRIDR 
AND DLVNOT.MSTDOCNUM = SHPMST.MSTDOCNUM 
AND DLVNOT.DUPNUM = SHPMST.DUPNUM 
AND DLVNOT.SEQNUM = SHPMST.SEQNUM 
AND DLVNOT.DLVNOTSTA <>'C'      
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>327</QRY:Id>
		<QRY:Source Name="operations.shipment.cto.delivery.findshipmentsforcollectionlist.basequerytwo" Type="NATIVE">
			<![CDATA[		
				SELECT SHPMST.CMPCOD,SHPMST.OWRCOD, 
          ULDSHP.ULDNUM ULDNUM, 
          NVL(ULDSHP.NUMPCS, 0) ULDSHPPCS, 
          NVL(ULDSHP.WGT, 0) ULDSHPWGT, 
          SHPMST.DOCOWRIDR, 
          SHPMST.MSTDOCNUM, 
          SHPMST.DUPNUM, 
          SHPMST.SEQNUM, 
		  SHPMST.PARSEQNUM,
          ARPSHP.TOTDLVPCS, 
          ARPSHP.TOTDLVWGT, 
(( 
CASE 
WHEN ARPSHP.DCSFLG = 'Y' 
THEN ARPSHP.DCSPCS 
ELSE ARPSHP.RCVPCS 
END)+ARPSHP.ACPPCS) RCVPCS, 
(( 
CASE 
WHEN ARPSHP.DCSFLG = 'Y' 
THEN ARPSHP.DCSWGT 
ELSE ARPSHP.RCVWGT 
END)+ARPSHP.ACPWGT) RCVWGT, 
          ARPSHP.ARPCOD, 
               (SELECT DISTINCT arpshp.DOCHDRFLG
                FROM OPRARPSHP arpshp
                WHERE arpshp.MSTDOCNUM =SHPMST.MSTDOCNUM
                AND arpshp.DOCOWRIDR   =SHPMST.DOCOWRIDR
                AND arpshp.DUPNUM      =SHPMST.DUPNUM
                AND arpshp.SEQNUM      =1
                AND arpshp.CMPCOD      =SHPMST.CMPCOD
				AND arpshp.ARPCOD =?
                ) AS DOCHDRFLG,
          SHPMST.STDPCS, 
          SHPMST.STDWGT, 
          SHPMST.SHPPFX, 
          SHPMST.DOCNUM, 
          SHPMST.PRDCOD, 
          SHPMST.PRDNAM, 
          SHPMST.AGTCOD, 
          SHPMST.SCCCOD, 
          SHPMST.CNSCOD, 
		  SHPMST.CNSNAM,
          SHPMST.ORGCOD, 
          SHPMST.DSTCOD, 
          SHPMST.CONFLG, 
          ARPSHP.CONBDNFLG, 
          ARPSHP.AVLPCS, 
          ARPSHP.AVLWGT, 
          ARPSHP.LSTUPDTIM ARPLSTUPDTIM, 
          SHPMST.CURCOD, 
		  (SELECT DOMFLG FROM  OPRSHPMST MSTAWB
		  WHERE MSTAWB.CMPCOD      = SHPMST.CMPCOD
		  AND MSTAWB.MSTDOCNUM = SHPMST.MSTDOCNUM
		  AND MSTAWB.DOCOWRIDR = SHPMST.DOCOWRIDR
		  AND MSTAWB.SEQNUM    = 1
		  AND MSTAWB.DUPNUM    = SHPMST.DUPNUM) DOMFLG,
          SHPMST.PAYTYP, 
INSTR(? 
|| CUSAGT.SCCCOD 
|| ?, ?
|| SHPMST.SCCCOD 
|| ?) SCCMATVAL, 
          CUSAGT.SCCCOD CUSSCCCOD, 
          CUSAGT.AGTCOD CUSAGTCOD, 
          CUSAGT.CUSCOD, 
          ARPSHP.TOTDLVNOTPCS, 
          ARPSHP.TOTDLVNOTWGT, 
          CASE 
            WHEN MST1.DOCOWRIDR = SHPMST.DOCOWRIDR 
            AND MST1.MSTDOCNUM = SHPMST.MSTDOCNUM 
            AND MST1.DUPNUM = SHPMST.DUPNUM 
            AND MST1.SEQNUM = SHPMST.SEQNUM 
            THEN 'Y' 
            ELSE 'N' 
          END CNSFLG ,
		   NULL CUSPRI,
NULL CUSMAXPRI 
        FROM OPRSHPMST SHPMST 
        INNER JOIN OPRARPSHP ARPSHP 
        ON SHPMST.CMPCOD = ARPSHP.CMPCOD 
        AND SHPMST.DOCOWRIDR = ARPSHP.DOCOWRIDR 
        AND SHPMST.MSTDOCNUM = ARPSHP.MSTDOCNUM 
        AND SHPMST.DUPNUM = ARPSHP.DUPNUM 
        AND SHPMST.SEQNUM = ARPSHP.SEQNUM 
AND EXISTS 
(SELECT 1 
FROM OPRSHPMST 
WHERE CMPCOD = ARPSHP.CMPCOD 
        AND DOCOWRIDR = ARPSHP.DOCOWRIDR
        AND MSTDOCNUM = ARPSHP.MSTDOCNUM
        AND DUPNUM    = ARPSHP.DUPNUM
        AND DSTCOD = ARPSHP.ARPCOD 
AND SEQNUM =1 
) 
        INNER JOIN OPRULDSHP ULDSHP 
        ON ARPSHP.CMPCOD = ULDSHP.CMPCOD 
        AND ARPSHP.ARPCOD = ULDSHP.ARPCOD 
        AND ARPSHP.DOCOWRIDR = ULDSHP.DOCOWRIDR 
        AND ARPSHP.MSTDOCNUM = ULDSHP.MSTDOCNUM 
        AND ARPSHP.DUPNUM = ULDSHP.DUPNUM 
        AND ARPSHP.SEQNUM = ULDSHP.SEQNUM 
        INNER JOIN OPRULDSHP ULDSHP1 
        ON ULDSHP1.CMPCOD = ULDSHP.CMPCOD 
        AND ULDSHP1.ARPCOD = ULDSHP.ARPCOD 
        AND ULDSHP1.ULDNUM = ULDSHP.ULDNUM 
        INNER JOIN OPRSHPMST MST1 
        ON MST1.CMPCOD = ULDSHP1.CMPCOD 
        AND MST1.DOCOWRIDR = ULDSHP1.DOCOWRIDR 
        AND MST1.MSTDOCNUM = ULDSHP1.MSTDOCNUM 
        AND MST1.DUPNUM = ULDSHP1.DUPNUM 
        AND MST1.SEQNUM = ULDSHP1.SEQNUM 
  ]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>4449</QRY:Id>
		<QRY:Source Name="operations.shipment.cto.delivery.findshipmentsforcollectionlist.basequerytwoparttwo" Type="NATIVE">
			<![CDATA[		
		   LEFT OUTER JOIN OPRSEGSHP SEGSHP
        ON SEGSHP.CMPCOD     = SHPMST.CMPCOD
        AND SEGSHP.DOCOWRIDR = SHPMST.DOCOWRIDR
        AND SEGSHP.MSTDOCNUM = SHPMST.MSTDOCNUM
        AND SEGSHP.DUPNUM    = SHPMST.DUPNUM
       
  
        LEFT OUTER JOIN OPRFLTSEG FLTSEG
        ON FLTSEG.CMPCOD    = SEGSHP.CMPCOD
        AND FLTSEG.FLTCARIDR=SEGSHP.FLTCARIDR
        AND FLTSEG.FLTNUM   =SEGSHP.FLTNUM
        AND FLTSEG.FLTSEQNUM=SEGSHP.FLTSEQNUM
        AND FLTSEG.SEGSERNUM=SEGSHP.SEGSERNUM
AND FLTSEG.POU      =ARPSHP.ARPCOD
LEFT OUTER JOIN OPRSHPDLVNOT DLVNOT 
ON DLVNOT.CMPCOD = SHPMST.CMPCOD 
AND DLVNOT.DOCOWRIDR = SHPMST.DOCOWRIDR 
AND DLVNOT.MSTDOCNUM = SHPMST.MSTDOCNUM 
AND DLVNOT.DUPNUM = SHPMST.DUPNUM 
AND DLVNOT.SEQNUM = SHPMST.SEQNUM 
AND DLVNOT.DLVNOTSTA <>'C' 
          
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>349</QRY:Id>
		<QRY:Source Name="operations.shipment.cto.delivery.findshipmentsforcollectionlist.basequerythree" Type="NATIVE">
			<![CDATA[		
							 ) Q 
				  ) M 
				) K 
			  WHERE K.CUSMAXPRI = K.CUSPRI 
			  AND ( K.CUSPRI != -1 
			  OR K.CNSFLG = 'N') 
		]]>
		</QRY:Source>
	</QRY:Definition>
		
         
      
         
         
		
       

        
         
         
         
		
             
	<QRY:Definition>
		<QRY:Id>328</QRY:Id>
		<QRY:Source Name="operations.shipment.cto.delivery.findshipmentsforcollectionlist.querysufix" Type="NATIVE">
			<![CDATA[		
					
			  ) SUBQRY 
LEFT OUTER JOIN OPRCOLLSTSHP LSTSHP 
ON SUBQRY.CMPCOD = LSTSHP.CMPCOD 
AND SUBQRY.DOCOWRIDR = LSTSHP.DOCOWRIDR 
AND SUBQRY.MSTDOCNUM = LSTSHP.MSTDOCNUM 
AND SUBQRY.DUPNUM = LSTSHP.DUPNUM 
AND SUBQRY.SEQNUM = LSTSHP.SEQNUM 
LEFT OUTER JOIN OPRCOLLST COLLST 
ON LSTSHP.CMPCOD = COLLST.CMPCOD 
AND LSTSHP.ARPCOD = COLLST.ARPCOD 
AND LSTSHP.DLVIDR = COLLST.DLVIDR 
			LEFT OUTER JOIN OPRSHPDLVNOT DLVNOT 
			ON SUBQRY.CMPCOD = DLVNOT.CMPCOD 
			AND SUBQRY.DOCOWRIDR = DLVNOT.DOCOWRIDR 
			AND SUBQRY.MSTDOCNUM = DLVNOT.MSTDOCNUM 
			AND SUBQRY.DUPNUM = DLVNOT.DUPNUM 
			AND SUBQRY.SEQNUM = DLVNOT.SEQNUM 
			AND DLVNOT.DLVNOTSTA <>'C'
			LEFT OUTER JOIN OPRSHPDTL SHPDTL 
			ON SUBQRY.CMPCOD = SHPDTL.CMPCOD 
			AND SUBQRY.DOCOWRIDR = SHPDTL.DOCOWRIDR 
			AND SUBQRY.MSTDOCNUM = SHPDTL.MSTDOCNUM 
			AND SUBQRY.DUPNUM = SHPDTL.DUPNUM 
			AND SUBQRY.SEQNUM = SHPDTL.SEQNUM 
LEFT OUTER JOIN OPRSHPDLVNOTULD NOTULD 
ON SUBQRY.CMPCOD = NOTULD.CMPCOD 
AND SUBQRY.ARPCOD = NOTULD.ARPCOD 
AND DLVNOT.DLVNOTNUM = NOTULD.DLVNOTNUM  
			LEFT OUTER JOIN SHRAGTMST AGTMST 
			ON SUBQRY.CMPCOD = AGTMST.CMPCOD 
			AND SUBQRY.CUSAGTCOD = AGTMST.AGTCOD 
			LEFT OUTER JOIN SHRCUSMST CUSMST
			ON  AGTMST.CMPCOD =  CUSMST.CMPCOD
			AND AGTMST.CUSCOD = CUSMST.CUSCOD

			LEFT OUTER JOIN OPRSHPMSTACC ACC 
			ON SUBQRY.CMPCOD = ACC.CMPCOD 
			AND SUBQRY.DOCOWRIDR = ACC.DOCOWRIDR 
			AND SUBQRY.MSTDOCNUM = ACC.MSTDOCNUM 
			AND SUBQRY.DUPNUM = ACC.DUPNUM 
			AND COALESCE(ACC.SEQNUM, 1) = 1 
			LEFT OUTER JOIN OPRSHPBLK SHPBLK 
			ON SUBQRY.CMPCOD = SHPBLK.CMPCOD 
			AND SUBQRY.DOCOWRIDR = SHPBLK.DOCOWRIDR 
			AND SUBQRY.MSTDOCNUM = SHPBLK.MSTDOCNUM 
			AND SUBQRY.DUPNUM = SHPBLK.DUPNUM 
AND (SHPBLK.SEQNUM = SUBQRY.SEQNUM 
OR SHPBLK.SEQNUM = SUBQRY.parseqnum) 
			AND SUBQRY.ARPCOD = SHPBLK.ARPCOD 
			AND SHPBLK.BLKSTA = 'B' 
			
			LEFT OUTER JOIN OPRSHPMSTMIS SHPMIS 
			ON SUBQRY.CMPCOD = SHPMIS.CMPCOD 
			AND SUBQRY.DOCOWRIDR = SHPMIS.DOCOWRIDR 
			AND SUBQRY.MSTDOCNUM = SHPMIS.MSTDOCNUM 
			AND SUBQRY.DUPNUM = SHPMIS.DUPNUM 
			AND SUBQRY.SEQNUM = SHPMIS.SEQNUM 
			
			
 LEFT OUTER JOIN OPRSHPADLCNT ADLCNT 
  ON SUBQRY.CMPCOD = ADLCNT.CMPCOD 
  AND SUBQRY.DOCOWRIDR = ADLCNT.DOCOWRIDR 
  AND SUBQRY.MSTDOCNUM = ADLCNT.MSTDOCNUM 
  AND SUBQRY.DUPNUM = ADLCNT.DUPNUM 
  AND SUBQRY.SEQNUM = ADLCNT.SEQNUM 
  AND ADLCNT.CNTTYP = ? 
			
			LEFT OUTER JOIN OPRSHPDLVNOTLOC DLVNOTLOC
			ON DLVNOT.CMPCOD = DLVNOTLOC.CMPCOD
			AND DLVNOT.ARPCOD = DLVNOTLOC.ARPCOD
			AND DLVNOT.DLVNOTNUM = DLVNOTLOC.DLVNOTNUM
			AND DLVNOT.DOCOWRIDR = DLVNOTLOC.DOCOWRIDR
			AND DLVNOT.MSTDOCNUM = DLVNOTLOC.MSTDOCNUM
			AND DLVNOT.DUPNUM    = DLVNOTLOC.DUPNUM
			AND DLVNOT.SEQNUM    = DLVNOTLOC.SEQNUM

			LEFT OUTER JOIN OPRSEGULDSHP SEGULDSHP 
			ON SUBQRY.CMPCOD = SEGULDSHP.CMPCOD 
			AND SUBQRY.DOCOWRIDR = SEGULDSHP.DOCOWRIDR 
			AND SUBQRY.MSTDOCNUM = SEGULDSHP.MSTDOCNUM 
			AND SUBQRY.DUPNUM = SEGULDSHP.DUPNUM 
			AND SUBQRY.seqnum = SEGULDSHP.seqnum 
			AND SEGULDSHP.RCVPCS>0
			
			LEFT OUTER JOIN OPRFLTSEG FLTSEG 
			ON FLTSEG.CMPCOD = SEGULDSHP.CMPCOD 
			AND FLTSEG.FLTCARIDR=SEGULDSHP.FLTCARIDR 
			AND FLTSEG.FLTNUM =SEGULDSHP.FLTNUM 
			AND FLTSEG.FLTSEQNUM=SEGULDSHP.FLTSEQNUM 
			AND FLTSEG.SEGSERNUM=SEGULDSHP.SEGSERNUM 
			AND FLTSEG.POU =SUBQRY.ARPCOD
			
			LEFT OUTER JOIN OPRARPIMPFLT IMPFLT 
			ON IMPFLT.CMPCOD = SEGULDSHP.CMPCOD 
			AND IMPFLT.FLTCARIDR=SEGULDSHP.FLTCARIDR 
			AND IMPFLT.FLTNUM =SEGULDSHP.FLTNUM 
			AND IMPFLT.FLTSEQNUM=SEGULDSHP.FLTSEQNUM 
			AND IMPFLT.ARPCOD =SUBQRY.ARPCOD
			
			LEFT OUTER JOIN OPRSHPDLVNOTFLT DLVNOTFLT 
			ON DLVNOT.CMPCOD = DLVNOTFLT.CMPCOD
			AND DLVNOT.DLVNOTNUM = DLVNOTFLT.DLVNOTNUM
			AND DLVNOT.ARPCOD = DLVNOTFLT.ARPCOD
			AND SEGULDSHP.FLTCARIDR =DLVNOTFLT.FLTCARIDR
			AND SEGULDSHP.FLTNUM =DLVNOTFLT.FLTNUM
			AND SEGULDSHP.FLTSEQNUM =DLVNOTFLT.FLTSEQNUM
			AND SEGULDSHP.SEGSERNUM =DLVNOTFLT.SEGSERNUM
			
			
			LEFT OUTER JOIN SHRARLMST ARL
			ON  ARL.CMPCOD =SEGULDSHP.CMPCOD
			AND ARL.ARLIDR =SEGULDSHP.FLTCARIDR

			]]>
		</QRY:Source>
	</QRY:Definition>
	
	<QRY:Definition>
		<QRY:Id>328</QRY:Id>
		<QRY:Source Name="operations.shipment.cto.delivery.findshipmentsforgroupid" Type="NATIVE">
			<![CDATA[
  SELECT SUBQRY.CMPCOD,
  SUBQRY.OWRCOD,
    SUBQRY.uldnum,
	  SUBQRY.DOCOWRIDR,
	  SUBQRY.MSTDOCNUM,
	  SUBQRY.DUPNUM,
	  SUBQRY.SEQNUM,
	  SUBQRY.PARSEQNUM,
	  SUBQRY.TOTDLVPCS,
	  SUBQRY.TOTDLVWGT,
	  SUBQRY.RCVPCS,
	  SUBQRY.RCVWGT,
	  SUBQRY.ARPCOD,
	  SUBQRY.DOCHDRFLG,
	  SUBQRY.STDPCS,
	  SUBQRY.STDWGT,
	  SUBQRY.SHPPFX,
	  SUBQRY.DOCNUM,
    SUBQRY.PRDCOD,
	  SUBQRY.PRDNAM,
	  SUBQRY.AGTCOD,
	  SUBQRY.SCCCOD,
	  SUBQRY.CNSCOD,
	  SUBQRY.CNSNAM,
	  SUBQRY.ORGCOD,
	  SUBQRY.DSTCOD,
	  SUBQRY.AVLPCS,
	  SUBQRY.AVLWGT,
	  SUBQRY.ARPLSTUPDTIM,
	  SUBQRY.CURCOD,
	  SUBQRY.DOMFLG,
	  SUBQRY.PAYTYP,
	  SUBQRY.TOTDLVNOTPCS,
	  SUBQRY.TOTDLVNOTWGT,
	  SUBQRY.CUSCOD,
	  SUBQRY.CUSNAM,
	  SUBQRY.CUSIDRTYP,
	  SUBQRY.CUSIDRDTL,
	  SUBQRY.CUSTAXOFF,
	  SUBQRY.CUSTAXREGNUM,
    SUBQRY.CUSPRI, 
    SUBQRY.CUSAGTCOD,
    SUBQRY.CUSAGTCUSCOD,
    AGTMST.AGTNAM CUSAGTNAM,
     SHPBLK.blksta,
	  SHPBLK.blkrmk,
	  SHPBLK.SERNUM BLKSERNUM,
	 SHPBLK.BLKAUT BLKAUT,
	  SHPMIS.SCICOD,
     DLVNOT.DLVNOTSTA,
  DLVNOT.DLVNOTPCS,
  DLVNOT.DLVNOTWGT,
  DLVNOT.DLVNOTNUM,
NOTULD.ULDNUM DLVULDNUM, 
  DLVNOT.DNTISSDAT,
  DLVNOT.PAYADVNUM,
  DLVNOT.PAYADVISSDAT,
  DLVNOT.PAYADVEXPDAT,
  DLVNOT.DLVPCS,
	  DLVNOT.DLVWGT,
	   NVL(ULDSHP.NUMPCS, 0) ULDSHPPCS, 
	          NVL(ULDSHP.WGT, 0) ULDSHPWGT,
SUBQRY.DLVIDR, 
SUBQRY.DLVGAT, 
SUBQRY.COLLSTSTA, 
SUBQRY.ULDNUM COLLSTULDNUM, 
SUBQRY.Collstpcs COLPCS,
SUBQRY.collstwgt COLWGT,
SUBQRY.Collstpcs, 
SUBQRY.collstwgt, 
SUBQRY.Collstdlvpcs, 
SUBQRY.collstdlvwgt, 
 ADLCNT.CTTCUSCOD DLVAGTCOD, 
ADLCNT.CTTCUSNAM DLVAGTNAM,
 SUBQRY.ULDPCS,
  SUBQRY.ULDWGT,
  DLVNOT.ADLINFONE,
    DLVNOT.ADDINFTWO,
DLVNOT.ADDINFTHR,
SUBQRY.EXPDAT,
(SELECT MST.PLTFLG FROM OPRSHPMST MST
  WHERE MST.CMPCOD  = SUBQRY.CMPCOD
  AND MST.DOCOWRIDR = SUBQRY.DOCOWRIDR
  AND MST.MSTDOCNUM = SUBQRY.MSTDOCNUM
  AND MST.DUPNUM    = SUBQRY.DUPNUM
  AND MST.SEQNUM    =1)PLTFLG,
(select CASE 
WHEN (SHPMST.PLTFLG = 'Y' AND ARPSHP.PLTUSEFLG = 'Y' AND SHPDTL.PLTUSEFLG ='Y') 
THEN 'Y' 
ELSE 'N'
END pltflg
FROM OPRSHPMST SHPMST 
INNER JOIN OPRARPSHP ARPSHP 
  ON SHPMST.CMPCOD = ARPSHP.CMPCOD 
  AND SHPMST.DOCOWRIDR = ARPSHP.DOCOWRIDR 
  AND SHPMST.MSTDOCNUM = ARPSHP.MSTDOCNUM 
  AND SHPMST.DUPNUM = ARPSHP.DUPNUM 
  AND SHPMST.SEQNUM = ARPSHP.SEQNUM
INNER JOIN OPRSHPDTL SHPDTL
  ON SHPMST.CMPCOD     = SHPDTL.CMPCOD
  AND SHPMST.DOCOWRIDR =SHPDTL.DOCOWRIDR
  AND SHPMST.MSTDOCNUM =SHPDTL.MSTDOCNUM
  AND SHPMST.DUPNUM    =SHPDTL.DUPNUM
  AND SHPMST.SEQNUM    =SHPDTL.SEQNUM
WHERE SHPMST.SEQNUM =1
AND SHPMST.CMPCOD = SUBQRY.CMPCOD
AND SHPMST.DOCOWRIDR = SUBQRY.DOCOWRIDR
AND SHPMST.MSTDOCNUM = SUBQRY.MSTDOCNUM
AND SHPMST.DUPNUM = SUBQRY.DUPNUM
AND ARPSHP.ARPCOD = SUBQRY.ARPCOD) PLTUSEFLG
  FROM 
(SELECT M.CMPCOD, 
M.OWRCOD,
    M.uldnum,
	  M.DOCOWRIDR,
	  M.MSTDOCNUM,
	  M.DUPNUM,
	  M.SEQNUM,
	  M.PARSEQNUM,
	  M.TOTDLVPCS,
	  M.TOTDLVWGT,
	  M.RCVPCS,
	  M.RCVWGT,
	  M.ARPCOD,
	  M.DOCHDRFLG,
	  M.STDPCS,
	  M.STDWGT,
	  M.SHPPFX,
	  M.DOCNUM,
    M.PRDCOD,
	  M.PRDNAM,
	  M.AGTCOD,
	  M.SCCCOD,
	  M.CNSCOD,
	  M.CNSNAM,
	  M.ORGCOD,
	  M.DSTCOD,
	  M.AVLPCS,
	  M.AVLWGT,
	  M.ARPLSTUPDTIM,
	  M.CURCOD,
	  M.DOMFLG,
	  M.PAYTYP,
	  M.TOTDLVNOTPCS,
	  M.TOTDLVNOTWGT,
	  M.CUSCOD,
	  M.CUSNAM,
	  M.CUSIDRTYP,
	  M.CUSIDRDTL,
	M.CUSTAXOFF,
	M.CUSTAXREGNUM,
	  M.DLVGAT,
    M.CUSPRI, 
    M.CUSAGTCOD,
    M.CUSAGTCUSCOD,
    M.CUSMAXPRI,
	M.ULDPCS,
    M.ULDWGT,
M.COLLSTULDNUM, 
M.Collstpcs, 
M.collstwgt, 
M.Collstdlvpcs, 
M.collstdlvwgt, 
M.DLVIDR, 
M.COLLSTSTA , 
M.EXPDAT 
  FROM 
 (  SELECT Q.CMPCOD,
 Q.OWRCOD,
    Q.uldnum,
	  Q.DOCOWRIDR,
	  Q.MSTDOCNUM,
	  Q.DUPNUM,
	  Q.SEQNUM,
	  Q.PARSEQNUM,
	  Q.TOTDLVPCS,
	  Q.TOTDLVWGT,
	  Q.RCVPCS,
	  Q.RCVWGT,
	  Q.ARPCOD,
	  Q.DOCHDRFLG,
	  Q.STDPCS,
	  Q.STDWGT,
	  Q.SHPPFX,
	  Q.DOCNUM,
	  Q.PRDCOD,
	  Q.PRDNAM,
	  Q.AGTCOD,
	  Q.SCCCOD,
	  Q.CNSCOD,
	  Q.CNSNAM,
	  Q.ORGCOD,
	  Q.DSTCOD,
	  Q.AVLPCS,
	  Q.AVLWGT,
	  Q.ARPLSTUPDTIM,
	  Q.CURCOD,
	  Q.DOMFLG,
	  Q.PAYTYP,
	  Q.TOTDLVNOTPCS,
	  Q.TOTDLVNOTWGT,
	  Q.CUSCOD,
	  Q.CUSNAM,
	  Q.CUSIDRTYP,
	  Q.CUSIDRDTL,
	  Q.CUSTAXOFF,
	  Q.CUSTAXREGNUM,
		  Q.DLVGAT,
    Q.CUSPRI, 
    Q.CUSAGTCOD,
    Q.CUSAGTCUSCOD,
    MAX(Q.CUSPRI) OVER(PARTITION BY Q.MSTDOCNUM, Q.DOCOWRIDR, Q.SEQNUM, Q.DUPNUM, Q.CMPCOD) CUSMAXPRI,
	Q.ULDPCS,
    Q.ULDWGT,
Q.COLLSTULDNUM, 
Q.Collstpcs, 
Q.collstwgt, 
Q.Collstdlvpcs, 
Q.collstdlvwgt, 
Q.DLVIDR, 
Q.COLLSTSTA , 
Q.EXPDAT 
  FROM 
 ( SELECT SHPMST.CMPCOD,
 SHPMST.OWRCOD,
  LSTSHP.uldnum,
	  SHPMST.DOCOWRIDR,
	  SHPMST.MSTDOCNUM,
	  SHPMST.DUPNUM,
	  SHPMST.SEQNUM,
	  SHPMST.PARSEQNUM,
	  ARPSHP.TOTDLVPCS,
	  ARPSHP.TOTDLVWGT,
(( 
CASE 
WHEN ARPSHP.DCSFLG = 'Y' 
THEN ARPSHP.DCSPCS 
ELSE ARPSHP.RCVPCS 
END)+ARPSHP.ACPPCS) RCVPCS, 
(( 
CASE 
WHEN ARPSHP.DCSFLG = 'Y' 
THEN ARPSHP.DCSWGT 
ELSE ARPSHP.RCVWGT 
END)+ARPSHP.ACPWGT) RCVWGT, 
	  ARPSHP.ARPCOD,
	  arpshp.DOCHDRFLG,
	  SHPMST.STDPCS,
	  SHPMST.STDWGT,
	  SHPMST.SHPPFX,
	  SHPMST.DOCNUM,
	  SHPMST.PRDCOD,
	  SHPMST.PRDNAM,
	  SHPMST.AGTCOD,
	  SHPMST.SCCCOD,
	  SHPMST.CNSCOD,
	  SHPMST.CNSNAM,
	  SHPMST.ORGCOD,
	  SHPMST.DSTCOD,
	  ARPSHP.AVLPCS,
	  ARPSHP.AVLWGT,
	  ARPSHP.LSTUPDTIM ARPLSTUPDTIM,
	  SHPMST.CURCOD,
	  MSTAWB.DOMFLG,
	  SHPMST.PAYTYP,
	  ARPSHP.TOTDLVNOTPCS,
	  ARPSHP.TOTDLVNOTWGT,
	  COLLST.CUSCOD,
	  COLLST.CUSNAM,
	  COLLST.CUSIDRTYP,
	  COLLST.CUSIDRDTL,
	  COLLST.CUSTAXOFF,
	  COLLST.CUSTAXREGNUM,
			  COLLST.DLVGAT,
LSTSHP.ULDNUM COLLSTULDNUM, 
NVL(LSTSHP.Collstpcs, 0) Collstpcs, 
NVL(LSTSHP.collstwgt, 0) collstwgt, 
NVL(LSTSHP.dlvpcs, 0) Collstdlvpcs, 
NVL(LSTSHP.dlvwgt, 0) collstdlvwgt, 
COLLST.DLVIDR, 
COLLST.COLLSTSTA , 
COLLST.EXPDAT, 
    CASE 
        WHEN INSTR(?
          || CUSAGT.SCCCOD
          || ?, ?
          || 'GEN'
          || ?)> 0 
        AND CUSAGT.SCCCOD IS NOT NULL 
        THEN 2 
        WHEN CUSAGT.SCCCOD IS NULL 
        THEN 0 
        ELSE -1 
      END CUSPRI, 
    
    CUSAGT.AGTCOD CUSAGTCOD,
    CUSAGT.CUSCOD CUSAGTCUSCOD,
	ARPSHP.ULDPCS,
    ARPSHP.ULDWGT
    
  
FROM OPRCOLLST COLLST

INNER JOIN OPRCOLLSTSHP LSTSHP
ON COLLST.CMPCOD     = LSTSHP.CMPCOD
AND COLLST.ARPCOD    = LSTSHP.ARPCOD
AND COLLST.DLVIDR    = LSTSHP.DLVIDR

INNER JOIN OPRARPSHP ARPSHP
ON LSTSHP.CMPCOD     = ARPSHP.CMPCOD
AND LSTSHP.DOCOWRIDR = ARPSHP.DOCOWRIDR
AND LSTSHP.MSTDOCNUM = ARPSHP.MSTDOCNUM
AND LSTSHP.DUPNUM    = ARPSHP.DUPNUM
AND LSTSHP.SEQNUM    = ARPSHP.SEQNUM
AND LSTSHP.ARPCOD    = ARPSHP.ARPCOD
	
INNER JOIN OPRSHPMST SHPMST
ON SHPMST.CMPCOD     = ARPSHP.CMPCOD
AND SHPMST.DOCOWRIDR = ARPSHP.DOCOWRIDR
AND SHPMST.MSTDOCNUM = ARPSHP.MSTDOCNUM
AND SHPMST.DUPNUM    = ARPSHP.DUPNUM
AND SHPMST.SEQNUM    = ARPSHP.SEQNUM
AND EXISTS 
(SELECT 1 
FROM OPRSHPMST 
WHERE CMPCOD = ARPSHP.CMPCOD 
        AND DOCOWRIDR = ARPSHP.DOCOWRIDR
        AND MSTDOCNUM = ARPSHP.MSTDOCNUM
        AND DUPNUM    = ARPSHP.DUPNUM
        AND DSTCOD = ARPSHP.ARPCOD 
AND SEQNUM =1 
) 
LEFT OUTER JOIN OPRSHPMST MSTAWB
ON MSTAWB.CMPCOD    = SHPMST.CMPCOD
AND MSTAWB.MSTDOCNUM = SHPMST.MSTDOCNUM
AND MSTAWB.DOCOWRIDR = SHPMST.DOCOWRIDR
AND MSTAWB.SEQNUM    = 1
AND MSTAWB.DUPNUM    = SHPMST.DUPNUM

    LEFT OUTER JOIN SHRCUSAGT CUSAGT
    ON SHPMST.CMPCOD                           = CUSAGT.CMPCOD
    AND SHPMST.CNSCOD                          = CUSAGT.CUSCOD
    AND CUSAGT.IMPFLG                          = 'Y'
    AND COALESCE(CUSAGT.STNCOD, ARPSHP.ARPCOD) = ARPSHP.ARPCOD
    AND INSTR(?
      || COALESCE(CUSAGT.SCCCOD, SHPMST.SCCCOD)
      || ?, ?
      || SHPMST.SCCCOD
      || ?) > 0
      
  WHERE COLLST.cmpcod = ? 
AND COLLST.arpcod = ?
AND COLLST.DLVIDR = ? 
)Q
)M
WHERE cuspri=CUSMAXPRI 
)SUBQRY

LEFT OUTER JOIN OPRSHPDLVNOT DLVNOT
ON SUBQRY.CMPCOD      = DLVNOT.CMPCOD
AND SUBQRY.ARPCOD     = DLVNOT.ARPCOD
AND SUBQRY.DOCOWRIDR  = DLVNOT.DOCOWRIDR
AND SUBQRY.MSTDOCNUM  = DLVNOT.MSTDOCNUM
AND SUBQRY.DUPNUM     = DLVNOT.DUPNUM
AND SUBQRY.SEQNUM     = DLVNOT.SEQNUM
AND DLVNOT.DLVNOTSTA <> 'C'
LEFT OUTER JOIN OPRSHPDLVNOTULD NOTULD 
ON SUBQRY.CMPCOD = NOTULD.CMPCOD 
AND SUBQRY.ARPCOD = NOTULD.ARPCOD 
AND DLVNOT.DLVNOTNUM = NOTULD.DLVNOTNUM 

LEFT OUTER JOIN OPRSHPBLK SHPBLK
ON SUBQRY.CMPCOD     = SHPBLK.CMPCOD
AND SUBQRY.DOCOWRIDR = SHPBLK.DOCOWRIDR
AND SUBQRY.MSTDOCNUM = SHPBLK.MSTDOCNUM
AND SUBQRY.DUPNUM    = SHPBLK.DUPNUM
AND (SHPBLK.SEQNUM = SUBQRY.SEQNUM 
OR SHPBLK.SEQNUM = SUBQRY.parseqnum) 
AND SUBQRY.ARPCOD    = SHPBLK.ARPCOD
AND SHPBLK.BLKSTA    = 'B'

LEFT OUTER JOIN OPRSHPMSTMIS SHPMIS
ON SUBQRY.CMPCOD     = SHPMIS.CMPCOD
AND SUBQRY.DOCOWRIDR = SHPMIS.DOCOWRIDR
AND SUBQRY.MSTDOCNUM = SHPMIS.MSTDOCNUM
AND SUBQRY.DUPNUM    = SHPMIS.DUPNUM
AND SUBQRY.SEQNUM    = SHPMIS.SEQNUM

	LEFT OUTER JOIN OPRULDSHP ULDSHP 
ON SUBQRY.CMPCOD = ULDSHP.CMPCOD 
AND SUBQRY.ARPCOD = ULDSHP.ARPCOD 
AND SUBQRY.DOCOWRIDR = ULDSHP.DOCOWRIDR 
AND SUBQRY.MSTDOCNUM = ULDSHP.MSTDOCNUM 
AND SUBQRY.DUPNUM = ULDSHP.DUPNUM 
AND SUBQRY.SEQNUM = ULDSHP.SEQNUM 
AND SUBQRY.ULDNUM    = ULDSHP.ULDNUM	
	 LEFT OUTER JOIN OPRSHPADLCNT ADLCNT 
  ON SUBQRY.CMPCOD = ADLCNT.CMPCOD 
  AND SUBQRY.DOCOWRIDR = ADLCNT.DOCOWRIDR 
  AND SUBQRY.MSTDOCNUM = ADLCNT.MSTDOCNUM 
  AND SUBQRY.DUPNUM = ADLCNT.DUPNUM 
  AND SUBQRY.SEQNUM = ADLCNT.SEQNUM 
  AND ADLCNT.CNTTYP = 'E' 
	
LEFT OUTER JOIN SHRAGTMST AGTMST
ON SUBQRY.CMPCOD     = AGTMST.CMPCOD
AND SUBQRY.CUSAGTCOD = AGTMST.AGTCOD
ORDER by ULDNUM,DOCOWRIDR,MSTDOCNUM,DUPNUM,SEQNUM





]]>
</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
<QRY:Id>321</QRY:Id>
<QRY:Source Name="operations.shipment.cto.delivery.findcollectionlistdetails" Type="NATIVE">
<![CDATA[		
SELECT col.cmpcod,
  col.arpcod ,
  col.DLVIDR,
  col.COLLSTSTA,
  col.GENDAT,
  col.EXPDAT,
  col.CUSCOD,
  col.CUSNAM,
  col.CUSIDRTYP,
  col.CUSIDRDTL,
  shp.DOCOWRIDR,
  shp.MSTDOCNUM,
  shp.DUPNUM,
  shp.SEQNUM ,
  shp.ULDNUM ,
  shp.COLLSTPCS ,
  shp.COLLSTWGT ,
  shp.DLVPCS ,
  shp.DLVWGT,
  MST.SHPPFX,
  DLVNOT.ADLINFONE,
  DLVNOT.ADDINFTWO,
  DLVNOT.ADDINFTHR,
  (select CASE 
WHEN (SHPMST.PLTFLG = 'Y' AND ARPSHP.PLTUSEFLG = 'Y' AND SHPDTL.PLTUSEFLG ='Y') 
THEN 'Y' 
ELSE 'N'
END pltflg
FROM OPRSHPMST SHPMST 
INNER JOIN OPRARPSHP ARPSHP 
  ON SHPMST.CMPCOD = ARPSHP.CMPCOD 
  AND SHPMST.DOCOWRIDR = ARPSHP.DOCOWRIDR 
  AND SHPMST.MSTDOCNUM = ARPSHP.MSTDOCNUM 
  AND SHPMST.DUPNUM = ARPSHP.DUPNUM 
  AND SHPMST.SEQNUM = ARPSHP.SEQNUM
INNER JOIN OPRSHPDTL SHPDTL
  ON SHPMST.CMPCOD     = SHPDTL.CMPCOD
  AND SHPMST.DOCOWRIDR =SHPDTL.DOCOWRIDR
  AND SHPMST.MSTDOCNUM =SHPDTL.MSTDOCNUM
  AND SHPMST.DUPNUM    =SHPDTL.DUPNUM
  AND SHPMST.SEQNUM    =SHPDTL.SEQNUM
WHERE SHPMST.SEQNUM = SHP.SEQNUM
AND SHPMST.CMPCOD = SHP.CMPCOD
AND SHPMST.DOCOWRIDR = SHP.DOCOWRIDR
AND SHPMST.MSTDOCNUM = SHP.MSTDOCNUM
AND SHPMST.DUPNUM = SHP.DUPNUM
AND ARPSHP.ARPCOD = COL.ARPCOD) PLTUSEFLG

FROM OPRCOLLST COL,
  OPRCOLLSTSHP SHP,
  OPRCOLLSTSHP SHP1,
  OPRSHPMST MST,
  OPRSHPDLVNOT DLVNOT
  
WHERE col.cmpcod = shp.cmpcod
AND col.arpcod = shp.arpcod
AND col.DLVIDR = shp.DLVIDR

AND col.cmpcod = shp1.cmpcod
AND col.arpcod = shp1.arpcod
AND col.DLVIDR = shp1.DLVIDR

AND MST.CMPCOD     	   = SHP.CMPCOD
AND MST.DOCOWRIDR      = SHP.DOCOWRIDR
AND MST.MSTDOCNUM      = SHP.MSTDOCNUM
AND MST.DUPNUM         = SHP.DUPNUM
AND MST.SEQNUM         = SHP.SEQNUM
	  
AND SHP.CMPCOD     	   = DLVNOT.CMPCOD(+)
AND SHP.DOCOWRIDR      = DLVNOT.DOCOWRIDR(+)
AND SHP.MSTDOCNUM      = DLVNOT.MSTDOCNUM(+)
AND SHP.DUPNUM         = DLVNOT.DUPNUM(+)
AND SHP.SEQNUM         = DLVNOT.SEQNUM(+)
AND col.cmpcod = ?
AND col.arpcod= ?

			]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>322</QRY:Id>
<QRY:Source Name="operations.shipment.cto.delivery.findcollectionlistforlov" Type="NATIVE">
<![CDATA[		
SELECT SHP.DLVIDR DLVIDR, 
  MAX( COL.CUSNAM) CUSNAM, 
  MAX(COL.COLLSTSTA) COLLSTSTA, 
  COL.ARPCOD ARPCOD, 
  MAX(COL.EXPDAT) EXPDAT,
  MAX(COL.GENDAT) GENDAT,	
  SUM(SHP.COLLSTPCS) COLLSTPCS, 
  SUM(SHP.COLLSTWGT) COLLSTWGT 
FROM OPRCOLLST COL, 
  OPRCOLLSTSHP SHP 
WHERE col.cmpcod = SHP.cmpcod 
AND COL.ARPCOD = SHP.ARPCOD 
AND COL.DLVIDR = SHP.DLVIDR 
AND COL.CMPCOD = ?
AND COL.ARPCOD = ? 
]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>323</QRY:Id>
<QRY:Source Name="operations.shipment.cto.delivery.findgroupdeliverydetails" Type="NATIVE">
<![CDATA[		

	SELECT col.cmpcod, 
	  col.arpcod , 
	  col.DLVIDR, 
	  col.COLLSTSTA, 
	  col.GENDAT, 
	  col.EXPDAT, 
	  col.CUSCOD, 
	  col.CUSNAM, 
	  col.CUSIDRTYP, 
	  col.CUSIDRDTL, 
	  shp.DOCOWRIDR, 
	  shp.MSTDOCNUM, 
	  shp.DUPNUM, 
	  shp.SEQNUM , 
	  shp.ULDNUM , 
	  shp.COLLSTPCS , 
	  shp.COLLSTWGT , 
	  shp.DLVPCS , 
	  shp.DLVWGT, 
	  mst.docnum, 
	  mst.CNSNAM CNSNAM,
	  mst.CNSCOD CNSCOD,
	  mst.SHPPFX, 
	  mst.CONFLG,MSTACC.SRVCRGCLS,MSTACC.TOTCCF,
	  SHPDTL.CHGCLDFLG,
	  Arpmstdst.CNTCOD,
	  arp.DORDLVFLG, 
 arp.CONBDNFLG, 	  
	  dlvnot.dlvnotnum, 
	  dlvnot.dlvnotsta, 
	  dlvnot.dlvnotpcs, 
	  dlvnot.dlvnotwgt,
	  dlvnot.dlvpcs DLVNOTDLVPCS,
  	  dlvnot.dlvwgt DLVNOTDLVWGT,
	   DLVNOT.DNTISSDAT,
	  DLVNOT.PAYADVNUM,
	  DLVNOT.PAYADVISSDAT,
	  DLVNOT.PAYADVEXPDAT,
	  NVL(DLVNOTULD.ULDNUM, 'BULK') DLVULDNUM,
	  DLVNOTULD.DLVNOTNUM ULDDLVNOTNUM,
	  DLVNOTULD.DLVNOTPCS ULDDLVNOTPCS,
	  DLVNOTULD.DLVNOTWGT ULDDLVNOTWGT,
	  DLVNOTULD.DLVPCS ULDDLVPCS,
	  DLVNOTULD.DLVWGT ULDDLVWGT,
	  Mis.scicod,
	  arp.PLTUSEFLG,
  MST.PLTFLG,
  SHPDTL.PLTUSEFLG SHPDTLPLTUSEFLG,
  MST.STDPCS,
  MST.STDWGT
	   
	FROM OPRCOLLST COL
	
	INNER JOIN OPRCOLLSTSHP SHP
	ON col.cmpcod = shp.cmpcod 
	AND col.arpcod = shp.arpcod 
	AND col.DLVIDR = shp.DLVIDR 
	
	INNER JOIN OPRSHPMST MST
	ON shp.cmpcod = mst.cmpcod 
		AND shp.docowridr = mst.docowridr
		AND shp.mstdocnum = mst.mstdocnum
		AND shp.dupnum    = mst.dupnum
		AND shp.seqnum    = mst.seqnum
	
	INNER JOIN OPRARPSHP ARP 
	ON  shp.cmpcod = ARP.cmpcod 
		AND shp.docowridr = ARP.docowridr
		AND shp.mstdocnum = ARP.mstdocnum
		AND shp.dupnum    = ARP.dupnum
		AND shp.seqnum    = ARP.seqnum
		and shp.arpcod = ARP.arpcod
	INNER JOIN OPRSHPDTL SHPDTL
	ON shp.cmpcod = SHPDTL.cmpcod
	AND shp.docowridr = SHPDTL.docowridr
	AND shp.mstdocnum = SHPDTL.mstdocnum
	AND shp.dupnum = SHPDTL.dupnum
	AND shp.seqnum = SHPDTL.seqnum 
	LEFT OUTER JOIN OPRSHPDLVNOT DLVNOT
	ON shp.cmpcod = DLVNOT.cmpcod
		AND shp.docowridr     = DLVNOT.docowridr
		AND shp.mstdocnum     = DLVNOT.mstdocnum
		AND shp.dupnum        = DLVNOT.dupnum
		AND shp.seqnum        = DLVNOT.seqnum
		AND DLVNOT.dlvnotsta <> 'C'
	LEFT OUTER JOIN OPRSHPDLVNOTULD DLVNOTULD
		ON DLVNOT.CMPCOD      = DLVNOTULD.CMPCOD
		AND DLVNOT.DLVNOTNUM  = DLVNOTULD.DLVNOTNUM
		AND DLVNOT.ARPCOD     = DLVNOTULD.ARPCOD
		AND DLVNOT.dlvnotsta <> 'C'

		LEFT OUTER JOIN Oprshpmstmis Mis
		ON shp.Docowridr         = Mis.Docowridr
		AND shp.Mstdocnum         = Mis.Mstdocnum
		AND shp.Dupnum            = Mis.Dupnum
		AND shp.Seqnum            = Mis.Seqnum
		AND shp.Cmpcod            = Mis.Cmpcod
		LEFT OUTER JOIN OPRSHPMSTACC MSTACC 
		ON MST.cmpcod = MSTACC.cmpcod 
		AND MST.docowridr = MSTACC.docowridr
		AND MST.mstdocnum = MSTACC.mstdocnum
		AND MST.dupnum    = MSTACC.dupnum
		AND MST.seqnum    = MSTACC.seqnum
		LEFT OUTER JOIN OPRSHPDTL SHPDTL 
		ON MST.cmpcod = SHPDTL.cmpcod 
		AND MST.docowridr = SHPDTL.docowridr
		AND MST.mstdocnum = SHPDTL.mstdocnum
		AND MST.dupnum    = SHPDTL.dupnum
		AND MST.seqnum    = SHPDTL.seqnum

		LEFT OUTER JOIN Shrarpmst Arpmstorg
ON mst.Cmpcod  = Arpmstorg.Cmpcod
AND mst.ORGCOD = Arpmstorg.Arpcod

		LEFT OUTER JOIN Shrctymst Orgcty
		ON Arpmstorg.Cmpcod  = orgcty.Cmpcod
		AND Arpmstorg.CTYCOD = ORGCTY.CTYCOD

		LEFT OUTER JOIN  Shrarpmst Arpmstdst
ON mst.CMPCOD  = ARPMSTDST.CMPCOD
AND mst.DSTCOD = Arpmstdst.Arpcod

		LEFT OUTER JOIN Shrctymst Dstcty
		ON Arpmstdst.Cmpcod  = dstcty.Cmpcod
		AND Arpmstdst.CTYCOD = DSTCTY.CTYCOD

		
	WHERE col.collststa = 'ACT' 
		AND col.cmpcod  = ?
		AND col.arpcod    = ?
		AND col.DLVIDR    = ?


			]]>
		</QRY:Source>
	</QRY:Definition>
<QRY:Definition>
<QRY:Id>400</QRY:Id>
<QRY:Source Name="operations.shipment.cto.delivery.findgroupdeliverydetailspart1" Type="NATIVE">
<![CDATA[		
	SELECT SUBQRY.CMPCOD, 
  NVL(SUBQRY.ULDNUM, 'BULK') ULDNUM, 
  NVL(DLVNOTULD.ULDNUM, 'BULK') DLVULDNUM,
  DLVNOTULD.DLVNOTNUM ULDDLVNOTNUM,
  DLVNOTULD.DLVNOTPCS ULDDLVNOTPCS,
  DLVNOTULD.DLVNOTWGT ULDDLVNOTWGT,
  DLVNOTULD.DLVPCS ULDDLVPCS,
  DLVNOTULD.DLVWGT ULDDLVWGT,
  SUBQRY.ULDSHPPCS, 
  SUBQRY.ULDSHPWGT, 
  SUBQRY.DOCOWRIDR, 
  SUBQRY.MSTDOCNUM, 
  SUBQRY.DUPNUM, 
  SUBQRY.SEQNUM, 
  SUBQRY.PARSEQNUM, 
  SUBQRY.TOTDLVPCS, 
  SUBQRY.TOTDLVWGT, 
  SUBQRY.RCVPCS, 
  SUBQRY.RCVWGT, 
  SUBQRY.ARPCOD, 
  SUBQRY.DOCHDRFLG, 
  SUBQRY.STDPCS, 
  SUBQRY.STDWGT, 
  SUBQRY.SHPPFX, 
  SUBQRY.DOCNUM, 
  SUBQRY.PRDCOD, 
  SUBQRY.PRDNAM, 
  SUBQRY.AGTCOD, 
  SUBQRY.SCCCOD, 
  NVL(SUBQRY.CNSCOD, 
  (SELECT parval 
  FROM shrsyspar 
  WHERE cmpcod = 'AV' 
  AND parcod ='common.customer.walkincustomer' 
  )) CNSCOD, 
  SUBQRY.CNSCOD, 
  SUBQRY.CNSNAM, 
  SUBQRY.ORGCOD, 
  SUBQRY.DSTCOD, 
  SUBQRY.CONFLG, 
  SUBQRY.CONBDNFLG, 
  SUBQRY.AVLPCS, 
  SUBQRY.AVLWGT, 
  SUBQRY.ARPLSTUPDTIM, 
  SUBQRY.CURCOD, 
  SUBQRY.DOMFLG, 
  SUBQRY.PAYTYP, 
  DLVNOT.DLVNOTSTA, 
  DLVNOT.DLVNOTPCS, 
  DLVNOT.DLVNOTWGT, 
  DLVNOT.DLVNOTNUM, 
  DLVNOT.DNTISSDAT, 
  DLVNOT.PAYADVNUM, 
  DLVNOT.PAYADVISSDAT, 
  DLVNOT.PAYADVEXPDAT, 
  DLVNOT.DLVPCS, 
  DLVNOT.DLVWGT, 
  DLVNOTLOC.LOCPCS, 
  DLVNOTLOC.LOCCOD, 
  DLVNOT.ADLINFONE,
  DLVNOT.ADDINFTWO,
  DLVNOT.ADDINFTHR,
  DLVNOTLOC.DLVNOTNUM LOCDLVNOTNUM, 
  DLVNOTLOC.WHSCOD, 
  DLVNOTLOC.STUCOD, 
  DLVNOTLOC.DLVNOTPCS LOCDLVNOTPCS, 
  SHPDTL.LSTUPDTIM SHPLSTUPDTIM, 
  SUBQRY.TOTDLVNOTPCS, 
  SUBQRY.TOTDLVNOTWGT, 
  SUBQRY.CNSFLG, 
  ADLCNT.CTTCUSCOD DLVAGTCOD, 
  ADLCNT.CTTCUSNAM DLVAGTNAM, 
  ACC.SRVCRGCLS, 
  ACC.TOTCCF, 
  SHPDTL.CHGCLDFLG,
  SHPBLK.blksta, 
  SHPBLK.blkrmk, 
  SHPBLK.SERNUM BLKSERNUM, 
  SHPMIS.SCICOD, 
  COLLST.dlvidr, 
  COLLST.collststa, 
  COLLST.expdat, 
  NVL(LSTSHP.ULDNUM, 'BULK') COLLSTULDNUM, 
  LSTSHP.Collstpcs, 
  LSTSHP.collstwgt, 
  LSTSHP.dlvpcs Collstdlvpcs, 
  LSTSHP.dlvwgt collstdlvwgt,
  ARPMSTDST.CNTCOD,
  SUBQRY.PLTUSEFLG,
   SHPDTL.PLTUSEFLG SHPDTLPLTUSEFLG,
  SUBQRY.PLTFLG
FROM 
  (SELECT SHPMST.CMPCOD, 
          ULDSHP.ULDNUM, 
          NVL(ULDSHP.NUMPCS, 0) ULDSHPPCS, 
          NVL(ULDSHP.WGT, 0) ULDSHPWGT, 
          SHPMST.DOCOWRIDR, 
          SHPMST.MSTDOCNUM, 
          SHPMST.DUPNUM, 
          SHPMST.SEQNUM, 
          SHPMST.PARSEQNUM, 
          ARPSHP.TOTDLVPCS, 
          ARPSHP.TOTDLVWGT, 
          (( 
          CASE 
            WHEN ARPSHP.DCSFLG = 'Y' 
            THEN ARPSHP.DCSPCS 
            ELSE ARPSHP.RCVPCS 
          END)+ARPSHP.ACPPCS) RCVPCS, 
          (( 
          CASE 
            WHEN ARPSHP.DCSFLG = 'Y' 
            THEN ARPSHP.DCSWGT 
            ELSE ARPSHP.RCVWGT 
          END)+ARPSHP.ACPWGT) RCVWGT, 
          ARPSHP.ARPCOD, 
          arpshp.DOCHDRFLG, 
          SHPMST.STDPCS, 
          SHPMST.STDWGT, 
          SHPMST.SHPPFX, 
          SHPMST.DOCNUM, 
          SHPMST.PRDCOD, 
          SHPMST.PRDNAM, 
          SHPMST.AGTCOD, 
          SHPMST.SCCCOD, 
          SHPMST.CNSCOD, 
          SHPMST.CNSNAM, 
          SHPMST.ORGCOD, 
          SHPMST.DSTCOD, 
          SHPMST.CONFLG, 
          ARPSHP.CONBDNFLG, 
          ARPSHP.AVLPCS, 
          ARPSHP.AVLWGT, 
          ARPSHP.LSTUPDTIM ARPLSTUPDTIM, 
          SHPMST.CURCOD, 
          MSTAWB.DOMFLG, 
          SHPMST.PAYTYP, 
          ARPSHP.TOTDLVNOTPCS, 
          ARPSHP.TOTDLVNOTWGT, 
          'Y' CNSFLG,
		  ARPSHP.PLTUSEFLG,
		  SHPMST.PLTFLG
        FROM OPRSHPMST SHPMST 
        INNER JOIN OPRARPSHP ARPSHP 
        ON SHPMST.CMPCOD = ARPSHP.CMPCOD 
        AND SHPMST.DOCOWRIDR = ARPSHP.DOCOWRIDR 
        AND SHPMST.MSTDOCNUM = ARPSHP.MSTDOCNUM 
        AND SHPMST.DUPNUM = ARPSHP.DUPNUM 
        AND SHPMST.SEQNUM = ARPSHP.SEQNUM 
        AND EXISTS 
          (SELECT 1 
          FROM OPRSHPMST 
          WHERE CMPCOD = ARPSHP.CMPCOD 
          AND DOCOWRIDR = ARPSHP.DOCOWRIDR 
          AND MSTDOCNUM = ARPSHP.MSTDOCNUM 
          AND DUPNUM = ARPSHP.DUPNUM 
          AND DSTCOD = ARPSHP.ARPCOD 
          AND SEQNUM =1 
          ) 
        LEFT OUTER JOIN OPRSEGSHP SEGSHP 
        ON SEGSHP.CMPCOD = SHPMST.CMPCOD 
        AND SEGSHP.DOCOWRIDR = SHPMST.DOCOWRIDR 
        AND SEGSHP.MSTDOCNUM = SHPMST.MSTDOCNUM 
        AND SEGSHP.DUPNUM = SHPMST.DUPNUM 
        LEFT OUTER JOIN OPRSHPMST MSTAWB 
        ON MSTAWB.CMPCOD = SHPMST.CMPCOD 
        AND MSTAWB.MSTDOCNUM = SHPMST.MSTDOCNUM 
        AND MSTAWB.DOCOWRIDR = SHPMST.DOCOWRIDR 
        AND MSTAWB.SEQNUM = 1 
        AND MSTAWB.DUPNUM = SHPMST.DUPNUM 
        LEFT OUTER JOIN OPRFLTSEG FLTSEG 
        ON FLTSEG.CMPCOD = SEGSHP.CMPCOD 
        AND FLTSEG.FLTCARIDR=SEGSHP.FLTCARIDR 
        AND FLTSEG.FLTNUM =SEGSHP.FLTNUM 
        AND FLTSEG.FLTSEQNUM=SEGSHP.FLTSEQNUM 
        AND FLTSEG.SEGSERNUM=SEGSHP.SEGSERNUM 
        AND FLTSEG.POU =ARPSHP.ARPCOD 
        LEFT OUTER JOIN opruldshp uldshp 
        ON arpshp.cmpcod = uldshp.cmpcod 
        AND arpshp.arpcod = uldshp.arpcod 
        AND arpshp.docowridr = uldshp.docowridr 
        AND arpshp.mstdocnum = uldshp.mstdocnum 
        AND arpshp.dupnum = uldshp.dupnum 
        AND arpshp.seqnum = uldshp.seqnum 
        LEFT OUTER JOIN OPRSHPDLVNOT DLVNOT 
        ON DLVNOT.CMPCOD = SHPMST.CMPCOD 
        AND DLVNOT.DOCOWRIDR = SHPMST.DOCOWRIDR 
        AND DLVNOT.MSTDOCNUM = SHPMST.MSTDOCNUM 
        AND DLVNOT.DUPNUM = SHPMST.DUPNUM 
        AND DLVNOT.SEQNUM = SHPMST.SEQNUM 
        AND DLVNOT.DLVNOTSTA <>'C' 
        WHERE SHPMST.CMPCOD = ? 
        AND ARPSHP.ARPCOD = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
<QRY:Definition>
<QRY:Id>401</QRY:Id>
<QRY:Source Name="operations.shipment.cto.delivery.findgroupdeliverydetailspart2" Type="NATIVE">
<![CDATA[		
	 AND ARPSHP.AVLPCS > 0 
        AND (shpmst.conflg = 'N' 
        OR arpshp.conbdnflg = 'Y' 
        OR arpshp.acppcs >0) 
        UNION 
        SELECT SHPMST.CMPCOD, 
          ULDSHP.ULDNUM ULDNUM, 
          NVL(ULDSHP.NUMPCS, 0) ULDSHPPCS, 
          NVL(ULDSHP.WGT, 0) ULDSHPWGT, 
          SHPMST.DOCOWRIDR, 
          SHPMST.MSTDOCNUM, 
          SHPMST.DUPNUM, 
          SHPMST.SEQNUM, 
          SHPMST.PARSEQNUM, 
          ARPSHP.TOTDLVPCS, 
          ARPSHP.TOTDLVWGT, 
          (( 
          CASE 
            WHEN ARPSHP.DCSFLG = 'Y' 
            THEN ARPSHP.DCSPCS 
            ELSE ARPSHP.RCVPCS 
          END)+ARPSHP.ACPPCS) RCVPCS, 
          (( 
          CASE 
            WHEN ARPSHP.DCSFLG = 'Y' 
            THEN ARPSHP.DCSWGT 
            ELSE ARPSHP.RCVWGT 
          END)+ARPSHP.ACPWGT) RCVWGT, 
          ARPSHP.ARPCOD, 
          arpshp.DOCHDRFLG, 
          SHPMST.STDPCS, 
          SHPMST.STDWGT, 
          SHPMST.SHPPFX, 
          SHPMST.DOCNUM, 
          SHPMST.PRDCOD, 
          SHPMST.PRDNAM, 
          SHPMST.AGTCOD, 
          SHPMST.SCCCOD, 
          SHPMST.CNSCOD, 
          SHPMST.CNSNAM, 
          SHPMST.ORGCOD, 
          SHPMST.DSTCOD, 
          SHPMST.CONFLG, 
          ARPSHP.CONBDNFLG, 
          ARPSHP.AVLPCS, 
          ARPSHP.AVLWGT, 
          ARPSHP.LSTUPDTIM ARPLSTUPDTIM, 
          SHPMST.CURCOD, 
          MSTAWB.DOMFLG, 
          SHPMST.PAYTYP, 
          ARPSHP.TOTDLVNOTPCS, 
          ARPSHP.TOTDLVNOTWGT, 
          CASE 
            WHEN MST1.DOCOWRIDR = SHPMST.DOCOWRIDR 
            AND MST1.MSTDOCNUM = SHPMST.MSTDOCNUM 
            AND MST1.DUPNUM = SHPMST.DUPNUM 
            AND MST1.SEQNUM = SHPMST.SEQNUM 
            THEN 'Y' 
            ELSE 'N' 
          END CNSFLG,
		ARPSHP.PLTUSEFLG,
		SHPMST.PLTFLG		
        FROM OPRSHPMST SHPMST 
        INNER JOIN OPRARPSHP ARPSHP 
        ON SHPMST.CMPCOD = ARPSHP.CMPCOD 
        AND SHPMST.DOCOWRIDR = ARPSHP.DOCOWRIDR 
        AND SHPMST.MSTDOCNUM = ARPSHP.MSTDOCNUM 
        AND SHPMST.DUPNUM = ARPSHP.DUPNUM 
        AND SHPMST.SEQNUM = ARPSHP.SEQNUM 
        AND EXISTS 
          (SELECT 1 
          FROM OPRSHPMST 
          WHERE CMPCOD = ARPSHP.CMPCOD 
          AND DOCOWRIDR = ARPSHP.DOCOWRIDR 
          AND MSTDOCNUM = ARPSHP.MSTDOCNUM 
          AND DUPNUM = ARPSHP.DUPNUM 
          AND DSTCOD = ARPSHP.ARPCOD 
          AND SEQNUM =1 
          ) 
        INNER JOIN OPRULDSHP ULDSHP 
        ON ARPSHP.CMPCOD = ULDSHP.CMPCOD 
        AND ARPSHP.ARPCOD = ULDSHP.ARPCOD 
        AND ARPSHP.DOCOWRIDR = ULDSHP.DOCOWRIDR 
        AND ARPSHP.MSTDOCNUM = ULDSHP.MSTDOCNUM 
        AND ARPSHP.DUPNUM = ULDSHP.DUPNUM 
        AND ARPSHP.SEQNUM = ULDSHP.SEQNUM 
        INNER JOIN OPRULDSHP ULDSHP1 
        ON ULDSHP1.CMPCOD = ULDSHP.CMPCOD 
        AND ULDSHP1.ARPCOD = ULDSHP.ARPCOD 
        AND ULDSHP1.ULDNUM = ULDSHP.ULDNUM 
        INNER JOIN OPRSHPMST MST1 
        ON MST1.CMPCOD = ULDSHP1.CMPCOD 
        AND MST1.DOCOWRIDR = ULDSHP1.DOCOWRIDR 
        AND MST1.MSTDOCNUM = ULDSHP1.MSTDOCNUM 
        AND MST1.DUPNUM = ULDSHP1.DUPNUM 
        AND MST1.SEQNUM = ULDSHP1.SEQNUM 
        LEFT OUTER JOIN OPRSEGSHP SEGSHP 
        ON SEGSHP.CMPCOD = SHPMST.CMPCOD 
        AND SEGSHP.DOCOWRIDR = SHPMST.DOCOWRIDR 
        AND SEGSHP.MSTDOCNUM = SHPMST.MSTDOCNUM 
        AND SEGSHP.DUPNUM = SHPMST.DUPNUM 
        LEFT OUTER JOIN OPRSHPMST MSTAWB 
        ON MSTAWB.CMPCOD = SHPMST.CMPCOD 
        AND MSTAWB.MSTDOCNUM = SHPMST.MSTDOCNUM 
        AND MSTAWB.DOCOWRIDR = SHPMST.DOCOWRIDR 
        AND MSTAWB.SEQNUM = 1 
        AND MSTAWB.DUPNUM = SHPMST.DUPNUM 
        LEFT OUTER JOIN OPRFLTSEG FLTSEG 
        ON FLTSEG.CMPCOD = SEGSHP.CMPCOD 
        AND FLTSEG.FLTCARIDR=SEGSHP.FLTCARIDR 
        AND FLTSEG.FLTNUM =SEGSHP.FLTNUM 
        AND FLTSEG.FLTSEQNUM=SEGSHP.FLTSEQNUM 
        AND FLTSEG.SEGSERNUM=SEGSHP.SEGSERNUM 
        AND FLTSEG.POU =ARPSHP.ARPCOD 
        LEFT OUTER JOIN OPRSHPDLVNOT DLVNOT 
        ON DLVNOT.CMPCOD = SHPMST.CMPCOD 
        AND DLVNOT.DOCOWRIDR = SHPMST.DOCOWRIDR 
        AND DLVNOT.MSTDOCNUM = SHPMST.MSTDOCNUM 
        AND DLVNOT.DUPNUM = SHPMST.DUPNUM 
        AND DLVNOT.SEQNUM = SHPMST.SEQNUM 
        AND DLVNOT.DLVNOTSTA <>'C' 
        WHERE shpmst.cmpcod = ? 
        AND arpshp.arpcod = ? 
			]]>
		</QRY:Source>
	</QRY:Definition>
<QRY:Definition>
<QRY:Id>402</QRY:Id>
<QRY:Source Name="operations.shipment.cto.delivery.findgroupdeliverydetailspart3" Type="NATIVE">
<![CDATA[		
  AND ARPSHP.AVLPCS > 0 
        AND (shpmst.conflg = 'N' 
        OR arpshp.conbdnflg = 'Y' 
        OR arpshp.acppcs >0) 
  ) SUBQRY 
LEFT OUTER JOIN OPRCOLLSTSHP LSTSHP 
ON SUBQRY.CMPCOD = LSTSHP.CMPCOD 
AND SUBQRY.DOCOWRIDR = LSTSHP.DOCOWRIDR 
AND SUBQRY.MSTDOCNUM = LSTSHP.MSTDOCNUM 
AND SUBQRY.DUPNUM = LSTSHP.DUPNUM 
AND SUBQRY.SEQNUM = LSTSHP.SEQNUM 
LEFT OUTER JOIN OPRCOLLST COLLST 
ON LSTSHP.CMPCOD = COLLST.CMPCOD 
AND LSTSHP.ARPCOD = COLLST.ARPCOD 
AND LSTSHP.DLVIDR = COLLST.DLVIDR 
LEFT OUTER JOIN OPRSHPDLVNOT DLVNOT 
ON SUBQRY.CMPCOD = DLVNOT.CMPCOD 
AND SUBQRY.DOCOWRIDR = DLVNOT.DOCOWRIDR 
AND SUBQRY.MSTDOCNUM = DLVNOT.MSTDOCNUM 
AND SUBQRY.DUPNUM = DLVNOT.DUPNUM 
AND SUBQRY.SEQNUM = DLVNOT.SEQNUM 
AND DLVNOT.DLVNOTSTA <>'C' 
LEFT OUTER JOIN OPRSHPDLVNOTULD DLVNOTULD
ON DLVNOT.CMPCOD      = DLVNOTULD.CMPCOD
AND DLVNOT.DLVNOTNUM  = DLVNOTULD.DLVNOTNUM
AND DLVNOT.ARPCOD     = DLVNOTULD.ARPCOD
AND DLVNOT.DLVNOTSTA <>'C'
LEFT OUTER JOIN OPRSHPDTL SHPDTL 
ON SUBQRY.CMPCOD = SHPDTL.CMPCOD 
AND SUBQRY.DOCOWRIDR = SHPDTL.DOCOWRIDR 
AND SUBQRY.MSTDOCNUM = SHPDTL.MSTDOCNUM 
AND SUBQRY.DUPNUM = SHPDTL.DUPNUM 
AND SUBQRY.SEQNUM = SHPDTL.SEQNUM 
LEFT OUTER JOIN OPRSHPMSTACC ACC 
ON SUBQRY.CMPCOD = ACC.CMPCOD 
AND SUBQRY.DOCOWRIDR = ACC.DOCOWRIDR 
AND SUBQRY.MSTDOCNUM = ACC.MSTDOCNUM 
AND SUBQRY.DUPNUM = ACC.DUPNUM 
AND COALESCE(ACC.SEQNUM, 1) = 1 
LEFT OUTER JOIN OPRSHPBLK SHPBLK 
ON SUBQRY.CMPCOD = SHPBLK.CMPCOD 
AND SUBQRY.DOCOWRIDR = SHPBLK.DOCOWRIDR 
AND SUBQRY.MSTDOCNUM = SHPBLK.MSTDOCNUM 
AND SUBQRY.DUPNUM = SHPBLK.DUPNUM 
AND (SHPBLK.SEQNUM = SUBQRY.SEQNUM 
OR SHPBLK.SEQNUM = SUBQRY.parseqnum) 
AND SUBQRY.ARPCOD = SHPBLK.ARPCOD 
AND SHPBLK.BLKSTA = 'B' 
LEFT OUTER JOIN OPRSHPMSTMIS SHPMIS 
ON SUBQRY.CMPCOD = SHPMIS.CMPCOD 
AND SUBQRY.DOCOWRIDR = SHPMIS.DOCOWRIDR 
AND SUBQRY.MSTDOCNUM = SHPMIS.MSTDOCNUM 
AND SUBQRY.DUPNUM = SHPMIS.DUPNUM 
AND SUBQRY.SEQNUM = SHPMIS.SEQNUM 
LEFT OUTER JOIN OPRSHPADLCNT ADLCNT 
ON SUBQRY.CMPCOD = ADLCNT.CMPCOD 
AND SUBQRY.DOCOWRIDR = ADLCNT.DOCOWRIDR 
AND SUBQRY.MSTDOCNUM = ADLCNT.MSTDOCNUM 
AND SUBQRY.DUPNUM = ADLCNT.DUPNUM 
AND SUBQRY.SEQNUM = ADLCNT.SEQNUM 
AND ADLCNT.CNTTYP = 'E' 
LEFT OUTER JOIN OPRSHPDLVNOTLOC DLVNOTLOC 
ON DLVNOT.CMPCOD = DLVNOTLOC.CMPCOD 
AND DLVNOT.ARPCOD = DLVNOTLOC.ARPCOD 
AND DLVNOT.DLVNOTNUM = DLVNOTLOC.DLVNOTNUM 
AND DLVNOT.DOCOWRIDR = DLVNOTLOC.DOCOWRIDR 
AND DLVNOT.MSTDOCNUM = DLVNOTLOC.MSTDOCNUM 
AND DLVNOT.DUPNUM = DLVNOTLOC.DUPNUM 
AND DLVNOT.SEQNUM = DLVNOTLOC.SEQNUM
LEFT OUTER JOIN  Shrarpmst ARPMSTDST
ON SUBQRY.CMPCOD  = ARPMSTDST.CMPCOD
AND SUBQRY.DSTCOD = ARPMSTDST.ARPCOD

			]]>
		</QRY:Source>
	</QRY:Definition>
	
	<QRY:Definition>
<QRY:Id>324</QRY:Id>
<QRY:Source Name="operations.shipment.cto.delivery.finddnlocationdetails" Type="NATIVE">
<![CDATA[		
SELECT DLVNOTMST.CMPCOD, DLVNOTMST.DOCOWRIDR, DLVNOTMST.MSTDOCNUM, DLVNOTMST.DUPNUM, DLVNOTMST.SEQNUM,DLVNOTMST.DLVNOTNUM,NOTULD.ULDNUM,
DLVNOTLOC.LOCCOD,DLVNOTMST.DLVNOTPCS,
  DLVNOTMST.DLVNOTWGT,DLVNOTLOC.WHSCOD,DLVNOTLOC.STUCOD,DLVNOTLOC.LOCPCS FROM OPRSHPDLVNOT DLVNOTMST ,OPRSHPDLVNOTLOC DLVNOTLOC,OPRSHPDLVNOTULD NOTULD

WHERE DLVNOTMST.CMPCOD = DLVNOTLOC.CMPCOD(+)
AND DLVNOTMST.ARPCOD = DLVNOTLOC.ARPCOD(+)
AND DLVNOTMST.DLVNOTNUM = DLVNOTLOC.DLVNOTNUM(+)
AND DLVNOTMST.CMPCOD = NOTULD.CMPCOD(+)
AND DLVNOTMST.ARPCOD = NOTULD.ARPCOD(+)
AND DLVNOTMST.DLVNOTNUM = NOTULD.DLVNOTNUM(+)

AND DLVNOTMST.CMPCOD = ?
AND DLVNOTMST.DOCOWRIDR = ?
AND DLVNOTMST.MSTDOCNUM = ?
AND DLVNOTMST.SEQNUM = ?
AND DLVNOTMST.DUPNUM = ?


			]]>
		</QRY:Source>
	</QRY:Definition>
<QRY:Definition>
<QRY:Id>330</QRY:Id>
<QRY:Source Name="operations.shipment.printccadetails" Type="NATIVE">
<![CDATA[		
  SELECT CCAREFNUM,
  SHPPFX,
  MSTDOCNUM,
  REVAGTCOD,
  REVAGTNAM,
  CCAIND,
  CCASTA,
   REVGRSWGT,
          ORGGRSWGT,
          REVWGTCHG,
          REVVALCHG,
          REVTAX,
          ORGVALCHG,
          ORGTAX,
          ORGVOLWGT,
          REVVOLWGT,
          REVCHGWGT,
          ORGCHGWGT,
          ORGWGTCHG,
          REVMKTCHG,
          ORGMKTCHG,
          ORGPAYTYPOTH,
          REVPAYTYPOTH,
          ORGPAYTYPFRT,
        REVPAYTYPFRT,
  ISSPTY,
  CCAISSDAT,
  ACPUSR,
  CORUSR,
  CORNUM,
  CCAISSSTN,
  REVTOTPPD,
  REVTOTCCF,
  REVTOTDUECARCHG,
  REVTOTDUEAGTCHG,
  ORGTOTCCF,
  ORGTOTPPD,
  ORGTOTDUECARCHG,
  ORGTOTDUEAGTCHG,
  REVCURCOD,
  CORRSN,
  SRCIND
FROM OPRSHPCCA
WHERE CMPCOD = ?
]]>
</QRY:Source>
</QRY:Definition>	
<QRY:Definition>
<QRY:Id>340</QRY:Id>
<QRY:Source Name="operations.shipment.findShipmentPieceSummary" Type="NATIVE">
<![CDATA[		
SELECT Sum.Cmpcod,
  Sum.Docowridr,
  Sum.Mstdocnum,
  Sum.Dupnum,
  Sum.Seqnum ,
  Sum.Grpnam,
  Sum.Grppcs,
  Sum.Grpvol,
  Sum.Grpwgt,
  pcs.grpidr PCSIDR,
  Pcs.Numpcs,
  Pcs.Pcswgt,
  pcs.PCSVOL,
  Sum.Lstupdtim
FROM Oprshppcssum SUM
JOIN Oprshppcsgrp pcs
ON Sum.Cmpcod     = pcs.Cmpcod
AND Sum.Docowridr = pcs.Docowridr
AND Sum.Mstdocnum = pcs.Mstdocnum
AND Sum.Dupnum    = pcs.Dupnum
AND Sum.Seqnum    = pcs.Seqnum
WHERE Sum.Cmpcod  = ?
AND Sum.Docowridr = ?
AND Sum.Mstdocnum = ?
AND Sum.Dupnum    = ?
AND Sum.Seqnum    = ?
order by grpnam
]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>345</QRY:Id>
<QRY:Source Name="operations.shipment.validateShipmentPieceId" Type="NATIVE">
<![CDATA[		
SELECT SHPPCS.CMPCOD,
  SHPPCS.DOCOWRIDR,
  SHPPCS.MSTDOCNUM,
  SHPPCS.DUPNUM,
  SHPPCS.SEQNUM,
  SHPPCS.GRPIDR PCSIDR,
  SHPPCS.PCSWGT,
  SHPPCS.PCSVOL
FROM OPRSHPPCSGRP SHPPCS
WHERE SHPPCS.GRPIDR    IN
]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>346</QRY:Id>
<QRY:Source Name="operations.shipment.findTransactionPieceGroupHistory" Type="NATIVE">
<![CDATA[		
SELECT TXNHIS.CMPCOD,
  TXNHIS.ARPCOD,
  TXNHIS.FLTNUM,
  TXNHIS.DOCOWRIDR,
  TXNHIS.MSTDOCNUM,
  MST.DOCNUM,
  TXNHIS.DUPNUM,
  TXNHIS.SEQNUM,
  TXNHIS.TXNCOD,
  TXNHIS.GRPIDR PCSIDR,
  TXNHIS.TXNREFONE,
  TXNHIS.TXNREFTWO,
  TXNHIS.TXNREFTHR,
  TXNHIS.TXNREFFOR,
  TXNHIS.TXNREFFIV,
  TXNHIS.TXNREFSEV,
  TXNHIS.TXNREFSIX,
  TXNHIS.TXNREFEGT,
  TXNHIS.TXNREFNIN,
  TXNHIS.TXNREFTEN
FROM OPRSHPTXNPCSGRPHIS TXNHIS,
  OPRSHPMST MST
WHERE TXNHIS.CMPCOD  = MST.CMPCOD
AND TXNHIS.DOCOWRIDR = MST.DOCOWRIDR
AND TXNHIS.MSTDOCNUM = MST.MSTDOCNUM
AND TXNHIS.DUPNUM    = MST.DUPNUM
AND TXNHIS.SEQNUM    = MST.SEQNUM
AND TXNHIS.CMPCOD = ?
AND TXNHIS.DOCOWRIDR= ?
AND TXNHIS.MSTDOCNUM= ?
AND TXNHIS.DUPNUM   = ?
AND TXNHIS.SEQNUM   = ?
AND GRPIDR  IN 
]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>347</QRY:Id>
<QRY:Source Name="operations.shipment.findHouseLevelPieces" Type="NATIVE">
<![CDATA[		
SELECT CMPCOD,
  DOCOWRIDR,
  MSTDOCNUM,
  DUPNUM,
  SEQNUM,
  PCSGRP.GRPIDR PCSIDR,
  PCSWGT,
  PCSVOL
FROM OPRSHPPCSGRP PCSGRP
WHERE CMPCOD = ?
AND DOCOWRIDR= ?
AND MSTDOCNUM= ?
AND DUPNUM   = ?
AND Seqnum   > 1
AND GRPIDR  IN 
]]>
</QRY:Source>
</QRY:Definition>


<QRY:Definition>
<QRY:Id>403</QRY:Id>
<QRY:Source Name="operations.shipment.printcca" Type="NATIVE">
	<![CDATA[
  SELECT CCA.CCAREFNUM,
  CCA.CCAISSDAT,
  CCA.CORNUM,
  CCA.CCAISSSTN,
  CCA.SHPPFX,
  CCA.MSTDOCNUM,
  CCA.REVORGCOD,
  CCA.REVDSTCOD,
  CCA.REVAGTCOD,
  CCA.REVAGTNAM,
  CCA.REVCURCOD,
  CCA.ORGCURCOD,
  CCA.REVWGTCHG,
  CCA.REVVALCHG,
  (CCA.REVTOTDUEAGTCHG + CCA.REVTOTDUECARCHG) AS OTHCHG,
  CCA.ORGWGTCHG, 
  CCA.ORGVALCHG,
  CCA.CORRMK,
  CCA.CORRSN,
  CCA.REVCNSNAM,
  CCA.REVTOTPPD,
  CCA.REVTOTCCF,
  CCA.REVTOTDUECARCHG,
  CCA.REVTOTDUEAGTCHG,
  CCA.ORGTOTCCF,
  CCA.ORGTOTPPD,
  CCA.ORGTOTDUECARCHG,
  CCA.ORGTOTDUEAGTCHG,
  CCA.ORGPAYTYPFRT,
  CCA.REVPAYTYPFRT,
  CCA.ORGPAYTYPOTH,
  CCA.REVPAYTYPOTH,
  CCA.REVMKTCHG,
  CCA.ORGMKTCHG,
  CCA.REVSHPNAM,
  CCA.REVCNSNAM,
   shpmst.EXEDAT,
   shpmst.SHPDES
FROM OPRSHPCCA CCA,
OPRSHPMST shpmst
WHERE cca.cmpcod=shpmst.cmpcod
AND cca.docowridr = shpmst.docowridr
and cca.mstdocnum= shpmst.mstdocnum
and cca.CMPCOD = ?

		
	]]>
</QRY:Source>
</QRY:Definition>
 <QRY:Definition>
		<QRY:Id>132</QRY:Id>
		<QRY:Source Name="operations.shipment.findOtherChargeDetailsForCCA" Type="NATIVE">
			<![CDATA[
			SELECT CCACHGDTL.CHDCOD, CCACHGDTL.CHGHED CHARGEHEAD,CCACHGDTL.CORNUM,CCACHGDTL.CMPCOD,CCACHGDTL.REVCHGAMT,CCACHGDTL.ORGCHGAMT,
				CCACHGDTL.DUECARFLG DUECARRIERFLAG, CCACHGDTL.DUEAGTFLG DUEAGENTFLAG,( CCACHGDTL.REVCHGAMT -CCACHGDTL.ORGCHGAMT) CHARGEAMOUNT,
				CCADTL.REVPAYTYPOTH OTHERCHARGEPAYTYP,CCADTL.MSTDOCNUM,CCADTL.DUPNUM,CCADTL.SEQNUM,CCADTL.DOCOWRIDR,CCACHGDTL.CHGHEDIDR
			  FROM OPRSHPCCACHGDTL CCACHGDTL,OPRSHPCCA CCADTL
			 WHERE 
                   CCADTL.CMPCOD= ?
			   AND CCADTL.DOCOWRIDR = ?
			   AND CCADTL.MSTDOCNUM = ?
			   AND CCADTL.DUPNUM = ?
			   AND CCADTL.SEQNUM= ?
			   AND CCADTL.CMPCOD=CCACHGDTL.CMPCOD
			   AND CCADTL.MSTDOCNUM=CCACHGDTL.MSTDOCNUM
			   AND CCADTL.DUPNUM=CCACHGDTL.DUPNUM
			   AND CCADTL.SEQNUM=CCACHGDTL.SEQNUM
			   AND CCADTL.DOCOWRIDR=CCACHGDTL.DOCOWRIDR
			   AND CCADTL.CORNUM=CCACHGDTL.CORNUM
		]]>
		</QRY:Source>
	</QRY:Definition>
<QRY:Definition>
<QRY:Id>404</QRY:Id>
<QRY:Source Name="operations.shipment.eqaiqastatusforcca.fragment" Type="NATIVE">
	<![CDATA[
(SELECT CMPCOD,
  MSTDOCNUM,
  DOCOWRIDR,
  DUPNUM,
  SEQNUM,
 CASE WHEN MAX(EQASTA) ='Pending' THEN 'Started EQA' 
 WHEN MAX(EQASTA) IS NULL then 'Open EQA'
 else 'Finished' end eqaSTA
FROM
  (SELECT HIS.CMPCOD,
    HIS.MSTDOCNUM,
    HIS.DOCOWRIDR,
    HIS.DUPNUM,
    HIS.SEQNUM,
    FIRST_VALUE(HIS.TXNREFNIN) OVER (PARTITION BY HIS.CMPCOD, 
    HIS.MSTDOCNUM,HIS.DOCOWRIDR, HIS.DUPNUM,HIS.SEQNUM 
    ORDER BY SERNUM DESC) eqasta
  FROM OPRSHPHIS HIS
  WHERE HIS.TXNCOD  ='STD'
  AND HIS.TXNREFEGT ='EQA'
  )
GROUP BY CMPCOD,
  MSTDOCNUM,
  DOCOWRIDR,
  DUPNUM,
  SEQNUM
) HIS, CSHQLTASRMST IQA		
	]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>404</QRY:Id>
<QRY:Source Name="operations.shipment.findshipmentdetailsforawblist" Type="NATIVE">
<![CDATA[		
SELECT MST.MSTDOCNUM,
  MST.CMPCOD MSTCMPCOD,
  MST.DOCOWRIDR MSTDOCOWRIDR,
  MST.DUPNUM MSTDUPNUM,
  MST.SEQNUM MSTSEQNUM,
  MST.ORGCOD,
  MST.DSTCOD,
  MST.SHPPFX,
  MST.DOCNUM,
  MST.STDDISWGT,
  MST.STDPCS,
  MST.STDWGT,
  MST.STDWGTCOD,
  MST.HDLINF,
  MST.SHPDES,
  MST.SCCCOD,
  MST.CHGCOD,
  MST.PARSEQNUM,
  MST.SHPSTA,
  MST.SHPTYP,
  MST.CONFLG,
  MST.HSEFINFLG,
  MST.DOCOWRIDR,
  MST.CNSCOD,
  MST.CNSNAM,
  MST.SHPCOD,
  MST.SHPNAM,
  MST.SHPSTA,
  MST.AGTCOD,
  MST.AGTNAM,
  MST.GRSVOL,
  MST.GRSDISVOL,
  MST.GRSVOLUNT,
  MST.OWRCOD,
  MST.SRCIND,
  MST.LSTUPDTIM MSTLSTUPDTIM,
  MST.LSTUPDUSR MSTLSTUPDUSR,
  RTG.DSTCOD RTGDSTCOD,
  RTG.FLTCARCOD FLTFLTCARCOD,
  RTG.FLTDAT FLTFLTDAT,
  RTG.DUPNUM FLTDUPNUM,
  RTG.SEGSERNUM FLTSEGSERNUM,
  RTG.FLTNUM FLTFLTNUM,
  RTG.DOCOWRIDR FLTDOCOWRIDR,
  RTG.SEQNUM FLTSEQNUM,
  RTG.FLTCARIDR FLTFLTCARIDR,
  RTG.RTGSERNUM FLTRTGSERNUM,
  RTG.RTESEQNUM FLTRTESEQNUM,
  RTG.FLTSEQNUM FLTFLTSEQNUM,
  RTG.MSTDOCNUM FLTMSTDOCNUM,
  RTG.CMPCOD FLTCMPCOD,
  RTG.DSTCOD FLTDSTCOD,
  MIS.LSTSHPSRC MISLSTSHPSRC
FROM
  (SELECT SUBSTR(AWB, 1,INSTR(AWB,'|',1,1)-1) SHPPFX,
    SUBSTR(AWB, INSTR(AWB,'|',1,1)        +1,INSTR(AWB,'|',1,2)-INSTR(AWB,'|',1,1)-1) MSTDOCNUM,
    SUBSTR(AWB, INSTR(AWB,'|',1,2)        +1,INSTR(AWB,'|',1,3)-INSTR(AWB,'|',1,2)-1) DUPNUM,
    SUBSTR(AWB, INSTR(AWB,'|',1,3)        +1) SEQNUM
  FROM
    (SELECT SUBSTR ( CSVAWB , DECODE(LEVEL, 1, 1, INSTR(CSVAWB, DELIMITER, 1, LEVEL-1)+1) , INSTR(CSVAWB, DELIMITER, 1, LEVEL) - DECODE(LEVEL, 1, 1, INSTR(CSVAWB, DELIMITER, 1, LEVEL-1)+1) ) AWB
    FROM
      (SELECT ? AS CSVAWB,',' AS DELIMITER FROM DUAL
      )
      CONNECT BY INSTR(CSVAWB, DELIMITER, 1, LEVEL)> 0
    )
  )FIL
INNER JOIN OPRSHPIDX IDX
ON  IDX.SHPPFX     = FIL.SHPPFX
AND IDX.MSTDOCNUM  = FIL.MSTDOCNUM
AND IDX.SEQNUM     = FIL.SEQNUM
INNER JOIN OPRSHPMST MST
ON MST.CMPCOD	   =IDX.CMPCOD
AND MST.SHPPFX     = IDX.SHPPFX
AND MST.MSTDOCNUM  = IDX.MSTDOCNUM
AND MST.DUPNUM     = IDX.DUPNUM
AND MST.SEQNUM     = IDX.SEQNUM
LEFT OUTER JOIN OPRSHPMSTMIS MIS
ON MST.CMPCOD     = MIS.CMPCOD
AND MST.DOCOWRIDR = MIS.DOCOWRIDR
AND MST.MSTDOCNUM = MIS.MSTDOCNUM
AND MST.DUPNUM = MIS.DUPNUM
AND MST.SEQNUM = MIS.SEQNUM
LEFT OUTER JOIN OPRSHPRTG RTG
ON MST.CMPCOD      = RTG.CMPCOD
AND MST.DOCOWRIDR  = RTG.DOCOWRIDR
AND MST.MSTDOCNUM  = RTG.MSTDOCNUM
AND MST.DUPNUM     = RTG.DUPNUM
AND MST.SEQNUM     = RTG.SEQNUM
WHERE IDX.CMPCOD   =?
AND IDX.PRGSTA     =?




			]]>
		</QRY:Source>
	</QRY:Definition>
	
		<QRY:Definition>
<QRY:Id>405</QRY:Id>
<QRY:Source Name="operations.shipment.findShipmentDetailsAtAirport" Type="NATIVE">
<![CDATA[
	SELECT SUM (SEGSHP.MFTPCS)MFTPCS,
	SUM (SEGSHP.MFTWGT)MFTWGT,
	SUM (SEGSHP.MFTVOL)MFTVOL,
	SUM (SEGSHP.RCVPCS)RCVPCS,	
  SUM (SEGSHP.RCVWGT)RCVWGT,
  SUM (SEGSHP.RCVVOL)RCVVOL,
  SHPMST.CMPCOD,
  SHPMST.DOCOWRIDR,
  SHPMST.MSTDOCNUM,
  SHPMST.DUPNUM,
  SHPMST.SEQNUM,
  SHPMST.ORGCOD,
  SHPMST.DSTCOD,
  ARPSHP.DOCRCVFLG
FROM OPRSEGSHP SEGSHP,
  FLTOPRSEG FLTSEG,
  OPRSHPMST SHPMST,
  OPRARPSHP ARPSHP
WHERE SEGSHP.FLTCARIDR=FLTSEG.FLTCARIDR
AND SEGSHP.FLTNUM     =FLTSEG.FLTNUM
AND SEGSHP.FLTSEQNUM  =FLTSEG.FLTSEQNUM
AND SEGSHP.SEGSERNUM  =FLTSEG.SEGSERNUM
AND SEGSHP.CMPCOD     = SHPMST.CMPCOD
AND SEGSHP.DOCOWRIDR  = SHPMST.DOCOWRIDR
AND SEGSHP.MSTDOCNUM  = SHPMST.DOCNUM
AND SEGSHP.SEQNUM     = SHPMST.SEQNUM
AND SEGSHP.DUPNUM     = SHPMST.DUPNUM
AND ARPSHP.CMPCOD     = SHPMST.CMPCOD
AND ARPSHP.DOCOWRIDR  = SHPMST.DOCOWRIDR
AND ARPSHP.MSTDOCNUM  = SHPMST.DOCNUM
AND ARPSHP.SEQNUM     = SHPMST.SEQNUM
AND ARPSHP.DUPNUM     = SHPMST.DUPNUM
AND ARPSHP.ARPCOD     = SHPMST.DSTCOD
AND SHPMST.CMPCOD     = ?
	]]>
		</QRY:Source>
	</QRY:Definition>
<QRY:Definition>
<QRY:Id>406</QRY:Id>
<QRY:Source Name="operations.shipment.findshipmentsforepouch" Type="NATIVE">
<![CDATA[
	select ORGCOD,DSTCOD,SHPPFX,MSTDOCNUM,DOCNUM,DUPNUM,SEQNUM,DOCOWRIDR,CMPCOD,AGTCOD,SHPDES
	FROM OPRSHPMST MST
	WHERE 
	MST.CMPCOD=?
	]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>407</QRY:Id>
	<QRY:Source Name="operations.shipment.findepouchdocumentconfiguration" Type="NATIVE">
	<![CDATA[
		SELECT CMPCOD,
		  ARPCOD,
		  TXNCOD,
		  SERNUM,
		  DOCTYP,
		  DOCNAM,
		  DOCEXN,
		  TXNREFONE,
		  TXNREFTWO,
		  TXNREFFOR,
		  TXNREFTHR,
		  BLDCLS
		FROM OPRDOCDTLCFG
		WHERE cmpcod=?
		AND txncod  =?
		AND arpcod  =?
	]]>
		</QRY:Source>
	</QRY:Definition>
<QRY:Definition>
		<QRY:Id>408</QRY:Id>
		<QRY:Source Name="operations.shipment.findacceptancependinglist" Type="NATIVE">
			<![CDATA[
  SELECT ACPDET.*
FROM
  (SELECT *
  FROM
    (SELECT 'DBLK' IRRCOD,
      0 avlpcs,
    SHPMST.CMPCOD,
    SHPMST.SHPPFX,
    SHPMST.MSTDOCNUM,
SHPMST.UBRNUM,
    SHPMST.STDPCS,
    SHPMST.STDWGT,
    SHPMST.SCCCOD MSTSCC,
    SHPMST.ORGCOD,
SHPMST.DSTCOD,
    SHPMST.PRDCOD,
    SHPMST.PRDNAM,
    SHPMST.AGTCOD,
    SHPMST.SHPCOD,
    SHPMST.DOCOWRIDR,
SHPMST.SHPSTA,
    SHPMST.RDYCRGFLG,
    SHPMST.DUPNUM,
    SHPMST.SEQNUM,
    SHPMST.EXEFLG,
    SHPMST.OWRCOD,
      NULL IRRARPCOD,
      NULL RSLSTA,
      NULL IRRRMK,
      SHPMST.SHPDES,
      NULL OCCTIM,
      SHPBLK.LSTUPDTIM BLKTIM,
      SHPBLK.BLKRMK,
      SHPBLK.ARPCOD BLKARPCOD, 
      '1' BLKEXISTS, 
      NULL DGREXISTS,
      (SELECT MSTDOCNUM
      FROM oprshpdtl SHPDTL
      WHERE SHPDTL.SCRSECRWDFLG = ?
      AND SHPDTL.TOTACPPCS      > 0
      AND SHPDTL.cmpcod         = shpmst.cmpcod
      AND SHPDTL.mstdocnum      = shpmst.docnum
      AND SHPDTL.docowridr      = shpmst.docowridr
      AND SHPDTL.dupnum         = shpmst.dupnum
      AND SHPDTL.seqnum         = shpmst.seqnum
      ) TOTACPPCS
    FROM OPRSHPBLK SHPBLK
	  INNER JOIN OPRSHPMST SHPMST
    ON SHPMST.MSTDOCNUM  = SHPBLK.MSTDOCNUM
    AND SHPMST.DOCOWRIDR = SHPBLK.DOCOWRIDR
    AND SHPMST.DUPNUM    = SHPBLK.DUPNUM
    AND SHPMST.SEQNUM    = SHPBLK.SEQNUM
    AND SHPMST.CMPCOD    = SHPBLK.CMPCOD
    WHERE shpblk.seqnum  = 1
	AND SHPBLK.BLKTXNCOD IN ('ACP','AWB','SCR') 
    AND SHPBLK.CMPCOD    = ?
      AND SHPBLK.ARPCOD    = ?
    AND SHPBLK.BLKAUT   IN ( ?,?)
      AND SHPBLK.BLKSTA    = ?
      AND CASE NVL(SHPSTA,'O') WHEN 'C' THEN 'C' WHEN 'P' THEN 'C' ELSE 'O' END ='O'
    )
  WHERE totacppcs IS NOT NULL
	UNION ALL
  SELECT IRRDTL.IRRCOD,
	   0 avlpcs,
      SHPMST.CMPCOD,
      SHPMST.SHPPFX,
      SHPMST.MSTDOCNUM,
      SHPMST.UBRNUM,
      SHPMST.STDPCS,
      SHPMST.STDWGT,
      SHPMST.SCCCOD MSTSCC,
      SHPMST.ORGCOD,
      SHPMST.DSTCOD,
      SHPMST.PRDCOD,
      SHPMST.PRDNAM,
      SHPMST.AGTCOD,
      SHPMST.SHPCOD,
      SHPMST.DOCOWRIDR,
      SHPMST.SHPSTA,
      SHPMST.RDYCRGFLG,
      SHPMST.DUPNUM,
      SHPMST.SEQNUM,
      SHPMST.EXEFLG,
      SHPMST.OWRCOD,
    IRRDTL.ARPCOD IRRARPCOD,
    IRRDTL.RSLSTA,
    IRRDTL.RMK IRRRMK,
SHPMST.SHPDES,
    IRRDTL.OCCTIM,
      NULL BLKTIM,
      NULL BLKRMK,
      NULL BLKARPCOD,
      NULL BLKEXISTS ,
    (SELECT 1
    FROM SHRSYSPAR
    WHERE PARCOD                                 = ?
    AND Pkg_Frmwrk.Fun_String_Check(SHRSYSPAR.PARVAL, IRRDTL.TXNREFFTN,',')>0
    ) DGREXISTS,
    '0' TOTACPPCS
    FROM OPRSHPIRRDTL IRRDTL
  INNER JOIN OPRSHPMST SHPMST
  ON SHPMST.CMPCOD     = IRRDTL.CMPCOD
  AND SHPMST.DOCOWRIDR         = IRRDTL.DOCOWRIDR
AND SHPMST.MSTDOCNUM = IRRDTL.MSTDOCNUM
  AND SHPMST.DUPNUM    = IRRDTL.DUPNUM
  AND SHPMST.SEQNUM            = IRRDTL.SEQNUM
  INNER JOIN SHRIRRMST IRRMST
  ON IRRMST.CMPCOD           = IRRDTL.CMPCOD
  AND IRRMST.IRRCOD          = IRRDTL.IRRCOD
  AND IRRMST.RSLREQFLG       = ?
  AND IRRMST.TXNCOD          =  ?
	  WHERE IRRDTL.CMPCOD = ?
      AND IRRDTL.ARPCOD = ?
  AND IRRDTL.TXNCOD            = ?
      AND NVL(IRRDTL.RSLSTA,?) = ?
	  AND CASE NVL(SHPSTA,'O') WHEN 'C' THEN 'C' WHEN 'P' THEN 'C' ELSE 'O' END ='O'
 
 
 
 

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>409</QRY:Id>
		<QRY:Source Name="operations.shipment.cto.autoDeliveryProcedure" Type="OBJECT">
		<![CDATA[
			CALL PKG_OPR_SHP.OPR_SHP_AUTO_DLV (
	  ?,?
	)
			]]>
		</QRY:Source>
	</QRY:Definition>
	
	<QRY:Definition>
		<QRY:Id>410</QRY:Id>
		<QRY:Source Name="operations.shipment.findshipmentdetailshistoryforarchive" Type="NATIVE">
			<![CDATA[			
					SELECT	MST.VERNUM MSTVERNUM, 
						   MST.MSTDOCNUM, 
						   MST.CMPCOD             MSTCMPCOD, 
						   MST.DOCOWRIDR          MSTDOCOWRIDR, 
						   MST.DUPNUM             MSTDUPNUM, 
						   MST.SEQNUM             MSTSEQNUM, 
						   MST.DOCNUM, 
						   MST.PLTFLG, 
						   MST.SHPBNDFLG, 
						   MST.DOCTYP, 
						   MST.PARSEQNUM, 
						   MST.RFCFLG, 
						   MST.CRAIMPFLG, 
						   MST.SHPPFX, 
						   MST.SHPSTA, 
						   MST.SHPTYP, 
						   MST.UBRNUM, 
						   MST.CONFLG, 
						   MST.HSEFINFLG, 
						   MST.DOCOWRIDR, 
						   MST.CNSADRONE, 
						   MST.CNSCOD, 
						   MST.CNSNAM, 
						   MST.SHPADRONE, 
						   MST.SHPCOD, 
						   MST.SHPNAM, 
						   MST.NFYCOD, 
						   MST.NFYNAM, 
						   MST.AGTCOD, 
						   MST.AGTNAM, 
						   MST.SCCCOD, 
						   MST.DTACPTFLG, 
						   MST.STDDISWGT, 
						   MST.STDPCS, 
						   MST.STDWGT, 
						   MST.STDWGTCOD, 
						   MST.HDLINF, 
						   MST.SHPDES, 
						   MST.ORGCOD, 
						   MST.DSTCOD, 
						   MST.SPTRATIDR, 
						   MST.PAYTYP             MSTPAYTYP, 
						   MST.CURCOD, 
						   MST.EXEUSRCOD, 
						   MST.EXESTN, 
						   MST.EXEFLG, 
						   MST.EXEDAT, 
						   MST.PRDNAM, 
						   MST.PRDPRT, 
						   MST.PRDCOD, 
						   MST.GRSVOL, 
						   MST.GRSDISVOL, 
						   MST.GRSVOLUNT, 
						   MST.OWRCOD, 
						   MST.SLCPCS             SLCPCS, 
						   MST.SRCIND, 
						   MST.TRGPNT, 
						   MST.MISMTH, 
						   MST.STKHLDCOD, 
						   MST.CAOFLG, 
						   MST.LSTUPDTIM          MSTLSTUPDTIM, 
						   MST.LSTUPDUSR          MSTLSTUPDUSR, 
						   MST.CHGCOD, 
						   MST.CHGGRPCOD, 
						   MST.VODFLG             MSTVODFLG, 
						   MST.RDYCRGFLG, 
						   MST.RATLINRMK          MSTRATLINRMK, 
						   MST.PRGCLSDAT          MSTPRGCLSDAT, 
						   MST.PAYDUEFLG          MSTPAYDUEFLG, 
						   MST.MSTCLSTIM          MSTMSTCLSTIM, 
						   MST.INTFLG             MSTINTFLG, 
						   MST.FRCCLSRMK          MSTFRCCLSRMK, 
						   MST.FRCCLSFLG          MSTFRCCLSFLG, 
						   MST.CPTDATUTC          MSTCPTDATUTC, 
						   MST.CPTDAT             MSTCPTDAT, 
						   FLT.FLTDAT             FLTFLTDAT, 
						   FLT.DUPNUM             FLTDUPNUM, 
						   FLT.SEGSERNUM          FLTSEGSERNUM, 
						   FLT.FLTNUM             FLTFLTNUM, 
						   FLT.DOCOWRIDR          FLTDOCOWRIDR, 
						   FLT.SEQNUM             FLTSEQNUM, 
						   FLT.FLTCARIDR          FLTFLTCARIDR, 
						   FLT.RTGSERNUM          FLTRTGSERNUM, 
						   FLT.RTESEQNUM          FLTRTESEQNUM, 
						   FLT.FLTSEQNUM          FLTFLTSEQNUM, 
						   FLT.MSTDOCNUM          FLTMSTDOCNUM, 
						   FLT.DSTCOD             RTGDSTCOD, 
						   FLT.FLTCARCOD          FLTFLTCARCOD, 
						   FLT.CMPCOD             FLTCMPCOD, 
						   FLT.DSTCOD             FLTDSTCOD, 
						   CHG.CHGHEDIDR, 
						   CHG.CHGAMT, 
						   CHG.PAYTYP             CHGPAYTYP, 
						   CHG.DUECARFLG, 
						   CHG.DUEAGTFLG, 
						   CHG.CHGRMK, 
						   CHG.CHGHED, 
						   CHG.CMPCOD             CHGCMPCOD, 
						   CHG.DOCOWRIDR          CHGDOCOWRIDR, 
						   CHG.MSTDOCNUM          CHGMSTDOCNUM, 
						   CHG.DUPNUM             CHGDUPNUM, 
						   CHG.SEQNUM             CHGSEQNUM, 
						   CHG.CHDCOD, 
						   CHG.TAX                CHDTAX, 
						   CHG.ACTCHGAMT          CHGACTCHGAMT, 
						   CHG.TAXPCT             CHGTAXPCT, 
						   CHG.VERNUM             CHGVERNUM, 
						   CHG.MNLUPDFLG          CHGMNLUPDFLG, 
						   CHG.PAYMOD             CHGPAYMOD, 
						   CHG.CHDGRSAMT          CHGCHDGRSAMT, 
						   CHG.ETYSUBCOD          CHGETYSUBCOD, 
						   CHG.CUSTYP             CHGCUSTYP, 
						   CHG.CUSCOD             CHGCUSCOD, 
						   ACC.TOTARLCHG, 
						   ACC.JNTREV, 
						   ACC.GSCCMS, 
						   ACC.GSCADLCMS, 
						   ACC.DSTEXGRATBSS       ACCDSTEXGRATBSS, 
						   ACC.DSTCURCNVDAT       ACCDSTCURCNVDAT, 
						   ACC.ACTCMSCCF          ACCACTCMSCCF, 
						   ACC.ACTCMSPPD          ACCACTCMSPPD, 
						   ACC.ACTTAXCCF          ACCACTTAXCCF, 
						   ACC.ACTTAXPPD          ACCACTTAXPPD, 
						   ACC.ACTTOTCCF          ACCACTTOTCCF, 
						   ACC.ACTTOTDUEAGTCCCHG  ACCACTTOTDUEAGTCCCHG, 
						   ACC.ACTTOTDUEAGTPPCHG  ACCACTTOTDUEAGTPPCHG, 
						   ACC.ACTTOTDUECARCCCHG  ACCACTTOTDUECARCCCHG, 
						   ACC.ACTTOTDUECARPPCHG  ACCACTTOTDUECARPPCHG, 
						   ACC.ACTTOTPPD          ACCACTTOTPPD, 
						   ACC.ACTVALCCCHG        ACCACTVALCCCHG, 
						   ACC.ACTVALPPCHG        ACCACTVALPPCHG, 
						   ACC.ACTWGTCCCHG        ACCACTWGTCCCHG, 
						   ACC.ACTWGTPPCHG        ACCACTWGTPPCHG, 
						   ACC.AGTACCNUM          ACCAGTACCNUM, 
						   ACC.ATOCMTTAX          ACCATOCMTTAX, 
						   ACC.CMPCOD             ACCCMPCOD, 
						   ACC.CMSAMT             ACCCMSAMT, 
						   ACC.CMSCASIND          ACCCMSCASIND, 
						   ACC.CMSPCT             ACCCMSPCT, 
						   ACC.CONCHG             ACCCONCHG, 
						   ACC.CONRAT             ACCCONRAT, 
						   ACC.DOCOWRIDR          ACCDOCOWRIDR, 
						   ACC.DSTCCFCHG          ACCDSTCCFCHG, 
						   ACC.DSTCHG             ACCDSTCHG, 
						   ACC.DSTCNVRAT          ACCDSTCNVRAT, 
						   ACC.DSTCURCOD          ACCDSTCURCOD, 
						   ACC.DUPNUM             ACCDUPNUM, 
						   ACC.INSPCT             ACCINSPCT, 
						   ACC.MIPDESCURCOD       ACCMIPDESCURCOD, 
						   ACC.MNLCPTFLG          ACCMNLCPTFLG, 
						   ACC.MSTDOCNUM          ACCMSTDOCNUM, 
						   ACC.OTHPAYTYP          ACCOTHPAYTYP, 
						   ACC.RATCONAPRDAT       ACCRATCONAPRDAT, 
						   ACC.RATCONREQDAT       ACCRATCONREQDAT, 
						   ACC.SALINCAMT          ACCSALINCAMT, 
						   ACC.SALINCCASIND       ACCSALINCCASIND, 
						   ACC.SEQNUM             ACCSEQNUM, 
						   ACC.SHPREFNUM          ACCSHPREFNUM, 
						   ACC.SPTCHG             ACCSPTCHG, 
						
						   ACC.TOTDSTCCFCHG       ACCTOTDSTCCFCHG, 
						   ACC.VALTAX             ACCVALTAX, 
						   ACC.VERNUM             ACCVERNUM, 
						   ACC.VFYEXEFLG          ACCVFYEXEFLG, 
						   ACC.PAYMOD             ACCPAYMOD, 
						   ACC.RATCONSTA, 
						   ACC.UNQREFONE          UNQREFONE, 
						   ACC.UNQREFTWO          UNQREFTWO, 
						   ACC.UNQREFTHR          UNQREFTHR, 
						   ACC.UNQREFFOR          UNQREFFOR, 
						   ACC.UNQREFFIV          UNQREFFIV, 
						   ACC.HGRWGTBRK, 
						   ACC.SPTRAT, 
						   ACC.SPTRATAPRDAT, 
						   ACC.SPTRATREQDAT, 
						   ACC.SPTRATSTA, 
						   ACC.CMSPPD, 
						   ACC.CMSCCF, 
						   ACC.TOTPPD, 
						   ACC.TOTCCF, 
						   ACC.CSHFLG, 
						   ACC.SRVCRGCLS, 
						   ACC.TOTDUECARPPCHG, 
						   ACC.TOTDUECARCCCHG, 
						   ACC.TOTDUEAGTPPCHG, 
						   ACC.TOTDUEAGTCCCHG, 
						   ACC.WGTPPCHG, 
						   ACC.WGTCCCHG, 
						   ACC.VALPPCHG, 
						   ACC.VALCCCHG, 
						   ACC.TAXPPD, 
						   ACC.TAXCCF, 
						   ACC.RATCONIDR, 
						   ACC.ACCINF, 
						   ACC.INSMINAMT, 
						   ACC.INSAMT, 
						   ACC.DVLCUS, 
						   ACC.DVLCAR, 
						   ACC.CASCOD, 
						   ACC.IATCOD, 
						   ACC.JRNDAT, 
						   MIS.PRMTYP, 
						   MIS.LSTEVLDAT, 
						   MIS.QTNREVNUM, 
						   MIS.EVLTYP, 
						   MIS.EVTTIMUTC, 
						   MIS.EVTINF, 
						   MIS.MSGSEQNUM, 
						   MIS.QLTASRVERNUM       MISQLTASRVERNUM, 
						   MIS.ADLSHPDES          MISADLSHPDES, 
						   MIS.AGTPLC             MISAGTPLC, 
						   MIS.AGTPPTNUM          MISAGTPPTNUM, 
						   MIS.AGTREF             MISAGTREF, 
						   MIS.AGTUNQIDR          MISAGTUNQIDR, 
						   MIS.AWBRMK             MISAWBRMK, 
						   MIS.AWBRPTRMK          MISAWBRPTRMK, 
						   MIS.AWBSYN             MISAWBSYN, 
						   MIS.BDNSRTFLG          MISBDNSRTFLG, 
						   MIS.BKGCRNDAT          MISBKGCRNDAT, 
						   MIS.CCFBKGFLG          MISCCFBKGFLG, 
						   MIS.CMPCOD             MISCMPCOD, 
						   MIS.CNEISOCNTCOD       MISCNEISOCNTCOD, 
						   MIS.COLAGY             MISCOLAGY, 
						   MIS.COLCHRIDN          MISCOLCHRIDN, 
						   MIS.CUSORGCOD          MISCUSORGCOD, 
						   MIS.DOCOWRIDR          MISDOCOWRIDR, 
						   MIS.DOCSUBTYP          MISDOCSUBTYP, 
						   MIS.DUPNUM             MISDUPNUM, 
						   MIS.EOSSNDFLG          MISEOSSNDFLG, 
						   MIS.ERINUM             MISERINUM, 
						   MIS.EURSTA             MISEURSTA, 
						   MIS.FHLFLG             MISFHLFLG, 
						   MIS.FRMCOD             MISFRMCOD, 
						   MIS.FWBFLG             MISFWBFLG, 
						   MIS.FWDCOD             MISFWDCOD, 
						   MIS.GNDCHDFLG          MISGNDCHDFLG, 
						   MIS.HRMCSTCOD          MISHRMCSTCOD, 
						   MIS.IMARCVTIM          MISIMARCVTIM, 
						   MIS.INSDTL             MISINSDTL, 
						   MIS.INSPRTFLG          MISINSPRTFLG, 
						   MIS.JNTCONFLG          MISJNTCONFLG, 
						   MIS.LSTSHPSRC          MISLSTSHPSRC, 
						   MIS.MANUPD             MISMANUPD, 
						   MIS.MIPSENFILREF       MISMIPSENFILREF, 
						   MIS.MIPWGTCOD          MISMIPWGTCOD, 
						   MIS.MSGSEQNUM          MISMSGSEQNUM, 
						   MIS.MSGTYP             MISMSGTYP, 
						   MIS.MSTDOCNUM          MISMSTDOCNUM, 
						   MIS.NOMHDLPTY, 
						   MIS.NOMHDLPTYPLC, 
						   MIS.NUMFSU             MISNUMFSU, 
						   MIS.NUMFWB             MISNUMFWB, 
						   MIS.OTHPCIND           MISOTHPCIND, 
						   MIS.PERCOD             MISPERCOD, 
						   MIS.PPDCHRIDN          MISPPDCHRIDN, 
						   MIS.PPTCOD             MISPPTCOD, 
						   MIS.PPTCTY             MISPPTCTY, 
						   MIS.PPTIDR             MISPPTIDR, 
						   MIS.PRTCCJFLG          MISPRTCCJFLG, 
						   MIS.SEQNUM             MISSEQNUM, 
						   MIS.SHPBNDFLG          MISSHPBNDFLG, 
						   MIS.SHPDESCOD          MISSHPDESCOD, 
						   MIS.SHPISOCNTCOD       MISSHPISOCNTCOD, 
						   MIS.SHPSIG, 
						   MIS.SHWRATFORRPT       MISSHWRATFORRPT, 
						   MIS.SNDCMPDSG          MISSNDCMPDSG, 
						   MIS.SNDCTY             MISSNDCTY, 
						   MIS.SNDDSG             MISSNDDSG, 
						   MIS.SNDFILREF          MISSNDFILREF, 
						   MIS.STACOD             MISSTACOD, 
						   MIS.VERNUM             MISVERNUM, 
						   MIS.REQFLTSEQNUM       REQFLTSEQNUM, 
						   MIS.REQFLTCARIDR       REQFLTCARIDR, 
						   MIS.REQFLTDAT          REQFLTDAT, 
						   MIS.MIPERRCOD          MIPERRCOD, 
						   MIS.REQFLTCARCOD       REQFLTCARCOD, 
						   MIS.REQFLTNUM          REQFLTNUM, 
						   MIS.BOE                BOE, 
						   MIS.CHRTRFLG, 
						   MIS.REQFLT             REQFLT, 
						   MIS.CRSREFONE          CRSREFONE, 
						   MIS.CRSREFTWO          CRSREFTWO, 
						   MIS.SHPINFONE, 
						   MIS.SHPINFTWO, 
						   MIS.TRTMOD, 
						   MIS.SCICOD, 
						   MIS.REQRTG, 
						   CNT.AGTSTN             AGTSTACOD, 
						   CNT.SHPSTN             SHPSTNCOD, 
						   CNT.CNSSTN             CNSSTNCOD, 
						   CNT.AGTADR             CNTAGTADR, 
						   CNT.AGTCTR             CNTAGTCTR, 
						   CNT.AGTCTY             CNTAGTCTY, 
						   CNT.AGTPSTCOD          CNTAGTPSTCOD, 
						   CNT.AGTSTT             CNTAGTSTT, 
						   CNT.CMPCOD             CNTCMPCOD, 
						   CNT.CNSERINUM          CNTCNSERINUM, 
						   CNT.DOCOWRIDR          CNTDOCOWRIDR, 
						   CNT.DUPNUM             CNTDUPNUM, 
						   CNT.MSTDOCNUM          CNTMSTDOCNUM, 
						   CNT.NFYERINUM          CNTNFYERINUM, 
						   CNT.POA                CNTPOA, 
						   CNT.SEQNUM             CNTSEQNUM, 
						   CNT.SHPERINUM          CNTSHPERINUM, 
						   CNT.SHPREFNUM          CNTSHPREFNUM, 
						   CNT.VERNUM             CNTVERNUM, 
						   CNT.NFYPSTCOD, 
						   CNT.NFYSTT, 
						   CNT.NFYTELNUM, 
						   CNT.NFYCTR, 
						   CNT.NFYCTY, 
						   CNT.NFYMALIDR, 
						   CNT.SHPPSTCOD, 
						   CNT.SHPSTT, 
						   CNT.SHPTELNUM, 
						   CNT.NFYACCNUM, 
						   CNT.NFYADRONE, 
						   CNT.NFYADRTWO, 
						   CNT.SHPCTR, 
						   CNT.SHPCTY, 
						   CNT.SHPMALIDR, 
						   CNT.SHPADRTWO, 
						   CNT.CNSPRTNFNFLG, 
						   CNT.CNSPSTCOD, 
						   CNT.CNSSTT, 
						   CNT.CNSTELNUM, 
						   CNT.SHPACCNUM, 
						   CNT.CNSCTR, 
						   CNT.CNSCTY, 
						   CNT.CNSMALIDR, 
						   CNT.CNSADRTWO, 
						   CNT.CNSACCNUM, 
						ADLCNT.CMPCOD ADLCNTCMPCOD,
						ADLCNT.DOCOWRIDR ADLCNTDOCOWRIDR,
						ADLCNT.MSTDOCNUM ADLCNTMSTDOCNUM,
						ADLCNT.DUPNUM ADLCNTDUPNUM,
						ADLCNT.SEQNUM ADLCNTSEQNUM,
						   ADLCNT.CNTTYP,
						   ADLCNT.CNTADR,
						   ADLCNT.CNTCTY,
						ADLCNT.CNTCTR,
						ADLCNT.CNTPSTCOD,
						ADLCNT.CNTSTT,
						ADLCNT.CNTTELNUM,
						ADLCNT.CNSMALIDR ADLCNSMALIDR,
						ADLCNT.CNTERINUM,
						ADLCNT.LSTUPDTIM ADLCNTLSTUPDTIM,
						ADLCNT.LSTUPDUSR ADLCNTLSTUPDUSR,
						ADLCNT.CTTCUSCOD,
						ADLCNT.CTTCUSNAM,						
						ADLCNT.ACCNUM,
						ADLCNT.VATREGNUM,
						ADLCNT.CNTADRTWO,
						ADLCNT.VERNUM ADLCNTVERNUM,
						ADLCNT.CSTLOCNUM,
						NFYHIS.CMPCOD NFYCMPCOD,
						NFYHIS.DOCOWRIDR NFYDOCOWRIDR,
						NFYHIS.MSTDOCNUM NFYMSTDOCNUM,
						NFYHIS.DUPNUM NFYDUPNUM,
						NFYHIS.SEQNUM NFYSEQNUM,
						NFYHIS.VERNUM NFYHISVERNUM,
						NFYHIS.NFYCOD NFYNFYCOD,
						 NFYHIS.NFYNAM NFYNFYNAM,
						NFYHIS.NFYTELNUM NFYNFYTELNUM,
						NFYHIS.NFYMALIDR NFYNFYMALIDR,
						NFYHIS.NFYADRONE NFYNFYADRONE,
						NFYHIS.NFYADRTWO NFYNFYADRTWO,
						NFYHIS.NFYCTY NFYNFYCTY,
						NFYHIS.NFYSTT NFYNFYSTT,
						NFYHIS.NFYCTR NFYNFYCTR,
						NFYHIS.NFYPSTCOD NFYNFYPSTCOD,
						NFYHIS.NFYMOD NFYNFYMOD,
						NFYHIS.PRTNFNFLG NFYPRTNFNFLG,
						NFYHIS.NFYACCNUM NFYNFYACCNUM,
						NFYHIS.LSTUPDTIM NFYHISLSTUPDTIM,
						NFYHIS.LSTUPDUSR NFYHISLSTUPDUSR,
						NFYHIS.NFDSTN NFDSTNCOD,
						OCI.CMPCOD OCICMPCOD,
						OCI.VERNUM OCIVERNUM,
						OCI.DOCOWRIDR OCIDOCOWRIDR,
						OCI.MSTDOCNUM OCIMSTDOCNUM,
						OCI.DUPNUM OCIDUPNUM,
						OCI.SEQNUM OCISEQNUM,					
						OCI.SERNUM OCISERNUM,
						OCI.CNTCOD OCICNTCOD,
						OCI.INFIDF,
						OCI.CUSINFIDF,
						OCI.CUSINF,
						OCI.SRCIND OCISRCIND,
						OCI.PARSERNUM,
						DCLHIS.CMPCOD DCLCMPCOD,
						DCLHIS.DOCOWRIDR  DCLDOCOWRIDR,
						DCLHIS.MSTDOCNUM  DCLMSTDOCNUM,
						DCLHIS.DUPNUM  DCLDUPNUM,
						DCLHIS.SEQNUM  DCLSEQNUM,
						DCLHIS.SHPDCLCOD,
						DCLHIS.SHPDES DCLSHPDES,
						DCLHIS.RMK DCLRMK,
						DCLHIS.LSTUPDTIM DCLHISLSTUPDTIM,
						DCLHIS.LSTUPDUSR DCLHISLSTUPDUSR,						
						   RAT.ACTALNCHG          RATACTALNCHG, 
						   RAT.ACTARLRAT          RATACTARLRAT, 
						   RAT.ACTCHGWGT          RATACTCHGWGT, 
						   RAT.ACTCMDITMNUM       RATACTCMDITMNUM, 
						   RAT.ACTGRSVOL          RATACTGRSVOL, 
						   RAT.ACTIATCHG          RATACTIATCHG, 
						   RAT.ACTIATRAT          RATACTIATRAT, 
						   RAT.ACTNETCHG          RATACTNETCHG, 
						   RAT.AGTCMS             RATAGTCMS, 
						   RAT.ALNBSECHG          ALNBSECHG, 
						   RAT.ALNCHG             ALNCHG, 
						   RAT.ARLRATTYP          RATARLRATTYP, 
						   RAT.CMPCOD             RATCMPCOD, 
						   RAT.CONFLG             RATCONFLG, 
						   RAT.CTRORG             RATCTRORG, 
						   RAT.DOCOWRIDR          RATDOCOWRIDR, 
						   RAT.DSCPCT             RATDSCPCT, 
						   RAT.DUPNUM             RATDUPNUM, 
						   RAT.GRSDISWGT          RATGRSDISWGT, 
						   RAT.GRSWGTCOD          RATGRSWGTCOD, 
						   RAT.IATBSECHG          IATBSECHG, 
						   RAT.IATCHG             IATCHG, 
						   RAT.IATCOD             RATIATCOD, 
						   RAT.LSTUPDTIM          RATLSTUPDTIM, 
						   RAT.LSTUPDUSR          RATLSTUPDUSR, 
						   RAT.MIPCOMNUM          RATMIPCOMNUM, 
						   RAT.MIPCONDES          RATMIPCONDES, 
						   RAT.MIPCTRORN          RATMIPCTRORN, 
						   RAT.MIPGODDES          RATMIPGODDES, 
						   RAT.MIPGRSVOL          RATMIPGRSVOL, 
						   RAT.MIPGRSWGTCOD       RATMIPGRSWGTCOD, 
						   RAT.MIPHRMCMDCOD       RATMIPHRMCMDCOD, 
						   RAT.MIPRATCLS          RATMIPRATCLS, 
						   RAT.MIPSLAC            RATMIPSLAC, 
						   RAT.MIPSRVCOD          RATMIPSRVCOD, 
						   RAT.MIPULDNUM          RATMIPULDNUM, 
						   RAT.MIPVOLCOD          RATMIPVOLCOD, 
						   RAT.MSTDOCNUM          RATMSTDOCNUM, 
						   RAT.NETCHG             NETCHG, 
						   RAT.OVRFLWFLG          RATOVRFLWFLG, 
						   RAT.PARSERNUM          RATPARSERNUM, 
						   RAT.RATLINSEQNUM       RATRATLINSEQNUM, 
						   RAT.RATUSEFLG          RATRATUSEFLG, 
						   RAT.SHPTAXPCT          RATSHPTAXPCT, 
						   RAT.TAXBSSVAL          RATTAXBSSVAL, 
						   RAT.TAXPCT             RATTAXPCT, 
						   RAT.VERNUM             RATVERNUM, 
						   RAT.SEQNUM             RATSEQNUM, 
						   RAT.RATLINSERNUM       RATRATLINSERNUM, 
						   RAT.NUMPCS             RATNUMPCS, 
						   RAT.GRSVOL             RATGRSVOL, 
						   RAT.SCCCOD             RATSCCCOD, 
						   RAT.HRMCMDCOD, 
						   RAT.IATRATTYP, 
						   RAT.TAX, 
						   RAT.ARLTRFNAM, 
						   RAT.IATTRFNAM, 
						   RAT.ARLTRFSERNUM, 
						   RAT.IATTRFSERNUM, 
						   RAT.ARLTRFRATSERNUM, 
						   RAT.IATTRFRATSERNUM, 
						   RAT.IATULDTYP          IATULDTYP, 
						   RAT.CRTREF, 
						   RAT.NUMULD             NUMULD, 
						   RAT.SRVCOD, 
						   RAT.RCP, 
						   RAT.ADDARLRATLINIDS,
						   RAT.TRKOALRATFLG, 
						   DIM.CMPCOD             DIMCMPCOD, 
						   DIM.DOCOWRIDR          DIMDOCOWRIDR, 
						   DIM.DUPNUM             DIMDUPNUM, 
						   DIM.LSTUPDTIM          DIMLSTUPDTIM, 
						   DIM.LSTUPDUSR          DIMLSTUPDUSR, 
						   DIM.MIPDISWGT          DIMMIPDISWGT, 
						   DIM.MIPHGT             DIMMIPHGT, 
						   DIM.MIPLEN             DIMMIPLEN, 
						   DIM.MIPPCS             DIMMIPPCS, 
						   DIM.MIPUNTCOD          DIMMIPUNTCOD, 
						   DIM.MIPWGTCOD          DIMMIPWGTCOD, 
						   DIM.MIPWID             DIMMIPWID, 
						   DIM.MSTDOCNUM          DIMMSTDOCNUM, 
						   DIM.SEQNUM             DIMSEQNUM, 
						   DIM.VERNUM             DIMVERNUM, 
						   DIM.WGTCOD             DIMWGTCOD, 
						   DIM.RATLINSERNUM, 
						   DIM.DIMSERNUM, 
						   DIM.PCSLEN, 
						   DIM.PCSHGT, 
						   DIM.PCSWID, 
						   DIM.PCSVOL, 
						   DIM.NUMPCS, 
						   DIM.WGT, 
						   DIM.DISWGT, 
						   DGR.NETQTY, 
						   DGR.NUMPKG, 
						   DGR.PKGGRP, 
						   DGR.PKGINS, 
						   DGR.PKGTYP DGRPKGTYP, 
						   DGR.SERNUM             DGRSERNUM, 
						   DGR.UNIIDR, 
						   DGR.PROSHPNAM, 
						   DGR.ERGCOD, 
						   DGR.TECNAM, 
						   DGR.TPTIND, 
						   DGR.SCCCOD             DGRSCC, 
						   DGR.SCCCODONE          DGRSCCONE, 
						   DGR.SCCCODTWO          DGRSCCTWO, 
						   DGR.PSGLTDQTYPKI       DGRPSGLTDQTYPKI, 
						   DGR.PKGGRPDES          DGRPKGGRPDES, 
						   DGR.PSGLTDNOTRESFLG    DGRPSGLTDNOTRESFLG, 
						   DGR.PSGNONLTDNOTRESFLG DGRPSGNONLTDNOTRESFLG, 
						   DGR.CRGNOTRESFLG       DGRCRGNOTRESFLG, 
						   DGR.APPFLG             DGRAPPFLG, 
						   DGR.NOSFLG             DGRNOSFLG, 
						   DGR.NETQTYUNT, 
						   DGR.ALLPCKSERNUM, 
						   DGR.OVRPCKSERNUM, 
						   DGR.NOOFOVRPACKS, 
						   DGR.NOOFALLPACKS, 
						   DGR.CARFLAG, 
						   DGR.RMC, 
						   DGR.PKGGRPRMC,
						   DGR.RDOACTFLG, 
						   DGR.SHPCLS, 
						   DGR.SUBRSKONE, 
						   DGR.SUBRSKTWO, 
						   DGR.SUBRSKTHR, 
						   DGR.LSTUPDTIM          DGRLSTUPDTIM, 
						   DGR.TECNAMFLG, 
						   SRV.SRVCOD             SRVSRVCOD, 
						   SRV.VERNUM             SRVVERNUM, 
						   OTHSRV.OTHSRVINF       OTHSRVINF, 
						   OTHSRV.VERNUM          OTHSRVVERNUM, 
						   SHPACC.ACCINFIDR       SHPACCACCINFIDR, 
						   SHPACC.ACCINF          SHPACCACCINF, 
						   SHPACC.SERNUM          SHPACCSERNUM, 
						   SHPACC.VERNUM          SHPACCVERNUM, 
						   MSTCNT.CNTIDR          MSTCNTCNTIDR, 
						   MSTCNT.CNTTYP          MSTCNTCNTTYP, 
						   MSTCNT.CNTVAL          MSTCNTCNTVAL, 
						   MSTCNT.SERNUM          MSTCNTSERNUM, 
						   MSTCNT.VERNUM          MSTCNTVERNUM, 
						   FLTBOK.CARIDR          FLTBOKCARIDR, 
						   FLTBOK.CARCOD          FLTBOKCARCOD, 
						   FLTBOK.FLTDAT          FLTBOKFLTDAT, 
						   FLTBOK.FLTNUM          FLTBOKFLTNUM, 
						   FLTBOK.SEGNUM          FLTBOKSEGNUM, 
						   FLTBOK.SEGORG          FLTBOKSEGORG, 
						   FLTBOK.SEGDST          FLTBOKSEGDST, 
						   FLTBOK.VERNUM          FLTBOKVERNUM, 
						   FLTBOK.SERNUM          FLTBOKSERNUM, 
						   OTHPPT.PPTCOD          OTHPPTPPTCOD, 
						   OTHPPT.PPTCTY          OTHPPTPPTCTY, 
						   OTHPPT.CMPDSG          OTHPPTCMPDSG, 
						   OTHPPT.PPTNAM          OTHPPTPPTNAM, 
						   OTHPPT.OFFCTY          OTHPPTOFFCTY, 
						   OTHPPT.OFFDSG          OTHPPTOFFDSG, 
						   OTHPPT.OFFFILREF       OTHPPTOFFFILREF, 
						   OTHPPT.SERNUM          OTHPPTSERNUM, 
						   OTHPPT.PPTIDR          OTHPPTPPTIDR, 
						   OTHPPT.STNCOD          OTHPPTSTNCOD, 
						   OTHPPT.VERNUM          OTHPPTVERNUM, 
						   SSR.SPLSRVREQ          SPLSRVREQ, 
						   SSR.SERNUM             SHPSSRSERNUM, 
						   SSR.VERNUM             SSRVERNUM, 
						   GRSWGT                 RATGRSWGT, 
						   CMDITMNUM, 
						   CMDITMNAM, 
						   IATRATCLS, 
						   ACTRATCLS, 
						   ARLRATCLS, 
						   IATRAT, 
						   ARLRAT, 
						   CHGWGT, 
						   RATDES, 
						   ARLRATLINIDR, 
						   IATRATLINIDR ,
						   ULD.CMPCOD ULDCMPCOD,ULD.DOCOWRIDR ULDDOCOWRIDR,ULD.MSTDOCNUM ULDMSTDOCNUM,
						   ULD.DUPNUM ULDDUPNUM,ULD.SEQNUM ULDSEQNUM,ULD.RATLINSERNUM ULDRATLINSERNUM,
						   ULD.SERNUM ULDSERNUM, ULD.ULDNUM ULDNUM,ULD.SLCPCS ULDSLCPCS	,ULD.VERNUM ULDVERNUM					   
					FROM   (SELECT MST.MSTDOCNUM, 
								   MST.CMPCOD, 
								   MST.DOCOWRIDR, 
								   MST.DUPNUM, 
								   MST.SEQNUM, 
								   MST.VERNUM, 
								   MST.DOCNUM, 
								   MST.PLTFLG, 
								   MST.SHPBNDFLG, 
								   MST.DOCTYP, 
								   MST.PARSEQNUM, 
								   MST.RFCFLG, 
								   MST.CRAIMPFLG, 
								   MST.SHPPFX, 
								   MST.SHPSTA, 
								   MST.SHPTYP, 
								   MST.UBRNUM, 
								   MST.CONFLG, 
								   MST.HSEFINFLG, 
								   MST.CNSADRONE, 
								   MST.CNSCOD, 
								   MST.CNSNAM, 
								   MST.SHPADRONE, 
								   MST.SHPCOD, 
								   MST.SHPNAM, 
								   MST.NFYCOD, 
								   MST.NFYNAM, 
								   MST.AGTCOD, 
								   MST.AGTNAM, 
								   MST.SCCCOD, 
								   MST.DTACPTFLG, 
								   MST.STDDISWGT, 
								   MST.STDPCS, 
								   MST.STDWGT, 
								   MST.STDWGTCOD, 
								   MST.HDLINF, 
								   MST.SHPDES, 
								   MST.ORGCOD, 
								   MST.DSTCOD, 
								   MST.SPTRATIDR, 
								   MST.PAYTYP, 
								   MST.CURCOD, 
								   MST.EXEUSRCOD, 
								   MST.EXESTN, 
								   MST.EXEFLG, 
								   MST.EXEDAT, 
								   MST.PRDNAM, 
								   MST.PRDPRT, 
								   MST.PRDCOD, 
								   MST.GRSVOL, 
								   MST.GRSDISVOL, 
								   MST.GRSVOLUNT, 
								   MST.OWRCOD, 
								   MST.SLCPCS SLCPCS, 
								   MST.SRCIND, 
								   MST.TRGPNT, 
								   MST.MISMTH, 
								   MST.STKHLDCOD, 
								   MST.CAOFLG, 
								   MST.LSTUPDTIM, 
								   MST.LSTUPDUSR, 
								   MST.CHGCOD, 
								   MST.CHGGRPCOD, 
								   MST.VODFLG, 
								   MST.RDYCRGFLG, 
								   MST.RATLINRMK, 
								   MST.PRGCLSDAT, 
								   MST.PAYDUEFLG, 
								   MST.MSTCLSTIM, 
								   MST.INTFLG, 
								   MST.FRCCLSRMK, 
								   MST.FRCCLSFLG, 
								   MST.CPTDATUTC, 
								   MST.CPTDAT 
							FROM   OPRSHPMSTHIS MST 
							WHERE  MST.CMPCOD = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>409</QRY:Id>
		<QRY:Source Name="operations.shipment.cto.delivery.findgroupidsforhht" Type="NATIVE">
		<![CDATA[
		SELECT col.DLVIDR
		FROM OPRCOLLST col,
		  OPRCOLLSTSHP shp
		WHERE col.CMPCOD = shp.CMPCOD
		AND col.ARPCOD = shp.ARPCOD
		AND col.DLVIDR = shp.DLVIDR  
		AND col.COLLSTSTA='ACT'
		AND col.EXPDAT > ?
		AND col.CMPCOD =?
		AND col.ARPCOD= ?
		AND shp.MSTDOCNUM=?
		AND shp.DOCOWRIDR=?
		AND shp.DUPNUM=?
		AND shp.SEQNUM=?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
<QRY:Id>411</QRY:Id>
<QRY:Source Name="operation.shipment.findparentshipmentsummarydetails" Type="NATIVE">
	<![CDATA[
			SELECT MST.CMPCOD, MST.DOCOWRIDR, MST.SHPPFX, MST.MSTDOCNUM, MST.DUPNUM,MST.AGTCOD,MST.AGTNAM,
      MST.SEQNUM, MST.PLTFLG, MST.STDPCS, MST.STDWGT, MST.SCCCOD, MST.SHPDES,
      MST.ORGCOD, MST.GRSVOL, MST.DSTCOD, MST.PRDNAM, MST.PRDPRT,
      DTL.PLTUSEFLG, MST.CNSNAM, MST.CNSADRONE, MST.SHPNAM, MST.SHPADRONE,
      MST.SHPSTA, MST.EXEFLG, ARPSHP.AVLPCS, ARPSHP.AVLWGT, MST.GRSVOLUNT,
      MST.STDWGTCOD,ARPSHP.PLTUSEFLG ARPSHPPLTUSEFLG,
      MST.CONFLG, ARPSHP.ACPPCS, ARPSHP.ACPWGT, ACC.JRNDAT,
      MST.LSTUPDTIM MSTLSTUPDTIM, MST.LSTUPDUSR MSTLSTUPDUSR,
      DTL.LSTUPDTIM DTLLSTUPDTIM, DTL.LSTUPDUSR DTLLSTUPDUSR,
      ARPSHP.LSTUPDTIM ARPSHPLSTUPDTIM, ARPSHP.LSTUPDUSR ARPSHPLSTUPDUSR,
  MIS.CRSREFONE,MST.SRCIND,MIS.CRSREFTWO ,  MST.EXEDAT, MST.OWRCOD,
  ARPSHP.RCVPCS,ARPSHP.RCVWGT,MST.RDYCRGFLG,ARPSHP.BDPPCS,ARPSHP.BDPWGT,ARPSHP.ULDPCS,
  ARPSHP.ULDWGT ,MST.DTACPTFLG,ARPSHP.DOCRCVFLG
 FROM OPRSHPHSE HSE,
  OPRSHPMST MST,
      OPRSHPDTL DTL,
      OPRARPSHP ARPSHP,
      OPRSHPMSTACC ACC,
      OPRSHPMSTMIS MIS
WHERE HSE.CMPCOD  = MST.CMPCOD
AND HSE.DOCOWRIDR = MST.DOCOWRIDR
AND HSE.MSTDOCNUM = MST.MSTDOCNUM
AND HSE.DUPNUM    = MST.DUPNUM
AND HSE.PARSEQNUM= MST.SEQNUM 
AND HSE.CMPCOD = DTL.CMPCOD(+)
  AND HSE.DOCOWRIDR = DTL.DOCOWRIDR(+)
  AND HSE.MSTDOCNUM = DTL.MSTDOCNUM(+)
  AND HSE.DUPNUM = DTL.DUPNUM(+)
  AND HSE.PARSEQNUM = DTL.SEQNUM(+)
  AND HSE.CMPCOD = ACC.CMPCOD
  AND HSE.DOCOWRIDR = ACC.DOCOWRIDR
  AND HSE.MSTDOCNUM = ACC.MSTDOCNUM
  AND HSE.DUPNUM = ACC.DUPNUM
  AND HSE.PARSEQNUM = ACC.SEQNUM
  AND HSE.CMPCOD = ARPSHP.CMPCOD(+)
  AND HSE.DOCOWRIDR = ARPSHP.DOCOWRIDR(+)
  AND HSE.MSTDOCNUM = ARPSHP.MSTDOCNUM(+)
  AND HSE.DUPNUM = ARPSHP.DUPNUM(+)
  AND HSE.PARSEQNUM = ARPSHP.SEQNUM(+)
  AND HSE.CMPCOD = MIS.CMPCOD(+)
  AND HSE.DOCOWRIDR = MIS.DOCOWRIDR(+)
  AND HSE.MSTDOCNUM = MIS.MSTDOCNUM(+)
  AND HSE.DUPNUM = MIS.DUPNUM(+)
  AND HSE.PARSEQNUM = MIS.SEQNUM(+)
  AND HSE.CMPCOD=?
  AND HSE.DOCOWRIDR=?
  AND HSE.MSTDOCNUM=?
  AND HSE.DUPNUM=?
  AND HSE.SEQNUM=?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>411</QRY:Id>
		<QRY:Source Name="operations.shipment.cto.findfsudisovcddetails" Type="NATIVE">
		<![CDATA[
		SELECT MST.DOMFLG,MST.MSTDOCNUM, 
			   MST.DOCOWRIDR, 
			   MST.DUPNUM, 
			   MST.SEQNUM, 
			   MST.CMPCOD, 
			   MST.SHPPFX, 
			   MST.OWRCOD, 
			   MST.STDPCS, 
			   MST.STDWGT, 
			   MST.ORGCOD, 
			   MST.DSTCOD, 
			   MST.AGTCOD, 
			   MST.SHPCOD, 
			   MST.SCCCOD, 
			   SEGSHP.MFTPCS PCS, 
			   SEGSHP.MFTWGT WGT, 
			   SEGSHP.FLTCARIDR, 
			   SEGSHP.FLTNUM, 
			   SYS.PARVAL                  WGTCOD, 
			   CASE WHEN ARL.APHCODUSE = 3 THEN ARL.THRAPHCOD 
			   ELSE ARL.TWOAPHCOD 
			   END                         CARRCOD, 
			   MIS.STACOD, 
			   MIS.MSGSEQNUM, 
			   MIS.MSGTYP, 
			   MIS.SCICOD, 
			   MIS.JNVPAR, 
			   CUSMST.CUSGRP               SHPGRP, 
			   FLTMST.FLTROU, 
			   AGTGRP.GRPNAM               AGTGRP, 
			   COALESCE(EXPFT.FINFLG, 'N') FINFLG ,
			   EXPFT.FLTDAT
		FROM   OPRSHPMST MST, 
			   OPRSEGSHP SEGSHP, 
			   SHRSYSPAR SYS, 
			   SHRARLMST ARL, 
			   OPRSHPMSTMIS MIS, 
			   SHRCUSMST CUSMST, 
			   FLTOPRMST FLTMST, 
			   SHRGENMSTGRPDTL AGTGRP, 
			   OPRARPEXPFLT EXPFT 
		WHERE  MST.CMPCOD = SEGSHP.CMPCOD AND 
			   MST.MSTDOCNUM = SEGSHP.MSTDOCNUM AND 
			   MST.DOCOWRIDR = SEGSHP.DOCOWRIDR AND 
			   MST.DUPNUM = SEGSHP.DUPNUM AND 
			   MST.SEQNUM = SEGSHP.SEQNUM AND 
			   MST.CMPCOD = SYS.CMPCOD AND 
			   SEGSHP.CMPCOD = ARL.CMPCOD AND 
			   SEGSHP.FLTCARIDR = ARL.ARLIDR AND 
			   MST.CMPCOD = MIS.CMPCOD AND 
			   MST.MSTDOCNUM  = MIS.MSTDOCNUM AND 
			   MST.DOCOWRIDR  = MIS.DOCOWRIDR AND 
			   MST.DUPNUM  = MIS.DUPNUM AND 
			   MST.SEQNUM  = MIS.SEQNUM AND 
			   MST.CMPCOD = CUSMST.CMPCOD(+) AND 
			   MST.SHPCOD = CUSMST.CUSCOD(+) AND 
			   FLTMST.CMPCOD = SEGSHP.CMPCOD AND 
			   FLTMST.FLTCARIDR = SEGSHP.FLTCARIDR AND 
			   FLTMST.FLTNUM = SEGSHP.FLTNUM AND 
			   FLTMST.FLTSEQNUM = SEGSHP.FLTSEQNUM AND 
			   MST.CMPCOD = AGTGRP.CMPCOD(+) AND 
			   MST.AGTCOD = AGTGRP.GRPENT(+) AND 
			   EXPFT.CMPCOD = SEGSHP.CMPCOD AND 
			   EXPFT.FLTCARIDR = SEGSHP.FLTCARIDR AND 
			   EXPFT.FLTNUM = SEGSHP.FLTNUM AND 
			   EXPFT.FLTSEQNUM = SEGSHP.FLTSEQNUM AND 
			   MST.CMPCOD = ? AND 
			   MST.MSTDOCNUM = ? AND 
			   MST.DOCOWRIDR = ? AND 
			   MST.DUPNUM = ? AND 
			   MST.SEQNUM = ? AND 
			   SYS.PARCOD = 'system.defaults.unit.weight' AND 
			   AGTGRP.GRPCATCOD(+) = 'GEN' 
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>412</QRY:Id>
		<QRY:Source Name="operations.shipment.printdiascrepancy.partone" Type="NATIVE">
		<![CDATA[
		SELECT NULL RESDOCNUM,
        NULL RESSHPPFX,
        NULL RESFLTNUM,
        NULL RESARLIDR,
        NULL RESFLTDAT,
        (
        CASE
          WHEN MST.PARSEQNUM > 0
          THEN MST.MSTDOCNUM
            ||'/'
            ||MST.DOCNUM
          ELSE MST.MSTDOCNUM
        END) MSTDOCNUM,
        MST.DOCOWRIDR,
        MST.DUPNUM,
        MST.SEQNUM,
        MST.CMPCOD,
        (
        CASE
          WHEN MST.PARSEQNUM > 0
          THEN ''
          ELSE MST.SHPPFX
        END) SHPPFX,
        MST.STDPCS,
        MST.STDWGT,
        DIS.ARPCOD,
        DIS.FLTCARIDR FLTCARIDR,
        DIS.FLTNUM FLTNUM,
        DIS.FLTSEQNUM FLTSEQNUM,
        DIS.FLTCARCOD FLTCARCOD,
        DIS.LEGSERNUM LEGSERNUM,
        DIS.FLTDAT FLTDAT,
        DIS.DISCOD DISCOD,
        DIS.CRTTIM CRTTIM,
        DIS.CLSDAT CLSDAT,
        DIS.DISSTA DISSTA,
        NULL DISRMK,
        DIS.DISPCS DISPCS,
        DIS.DISWGT DISWGT,
        SEGSHP.MFTPCS,
        SEGSHP.RCVPCS,
        NULL FSDMG,
        0 FSDMGPCS,
        SEGSHP.MFTWGT,
        MST.SCCCOD ,
        MST.CNSCOD
      FROM OPRSHPMST MST,
        OPRSHPFLTDIS DIS,
        OPRFLTSEG FLTSEG ,
        OPRSEGSHP SEGSHP ,
        OPRARPSHP ARPSHP
      WHERE DIS.CMPCOD     = MST.CMPCOD
      AND DIS.DOCOWRIDR    = MST.DOCOWRIDR
      AND DIS.MSTDOCNUM    = MST.MSTDOCNUM
      AND DIS.SEQNUM       = MST.SEQNUM
      AND DIS.DUPNUM       = MST.DUPNUM
      AND DIS.CMPCOD       = FLTSEG.CMPCOD
      AND DIS.FLTCARIDR    = FLTSEG.FLTCARIDR
      AND DIS.FLTNUM       = FLTSEG.FLTNUM
      AND DIS.FLTSEQNUM    = FLTSEG.FLTSEQNUM
      AND DIS.ARPCOD       = FLTSEG.POU
      AND FLTSEG.CMPCOD    = SEGSHP.CMPCOD
      AND FLTSEG.FLTCARIDR = SEGSHP.FLTCARIDR
      AND FLTSEG.FLTNUM    = SEGSHP.FLTNUM
      AND FLTSEG.FLTSEQNUM = SEGSHP.FLTSEQNUM
      AND FLTSEG.SEGSERNUM = SEGSHP.SEGSERNUM
      AND DIS.DOCOWRIDR    = SEGSHP.DOCOWRIDR
      AND DIS.MSTDOCNUM    = SEGSHP.MSTDOCNUM
      AND DIS.SEQNUM       = SEGSHP.SEQNUM
      AND DIS.DUPNUM       = SEGSHP.DUPNUM
      AND DIS.CMPCOD       = ARPSHP.CMPCOD
      AND DIS.DOCOWRIDR    = ARPSHP.DOCOWRIDR
      AND DIS.MSTDOCNUM    = ARPSHP.MSTDOCNUM
      AND DIS.SEQNUM       = ARPSHP.SEQNUM
      AND DIS.DUPNUM       = ARPSHP.DUPNUM
      AND DIS.ARPCOD       = ARPSHP.ARPCOD
      AND DIS.CMPCOD       = ?
      
      
	]]>
	</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>413</QRY:Id>
		<QRY:Source Name="operations.shipment.printdiascrepancy.parttwo" Type="NATIVE">
		<![CDATA[
SELECT NULL RESDOCNUM,
        NULL RESSHPPFX,
        NULL RESFLTNUM,
        NULL RESARLIDR,
        NULL RESFLTDAT,
        (
        CASE
          WHEN MST.PARSEQNUM > 0
          THEN MST.MSTDOCNUM
            ||'/'
            ||MST.DOCNUM
          ELSE MST.MSTDOCNUM
        END) MSTDOCNUM,
        MST.DOCOWRIDR,
        MST.DUPNUM,
        MST.SEQNUM,
        MST.CMPCOD,
        (
        CASE
          WHEN MST.PARSEQNUM > 0
          THEN ''
          ELSE MST.SHPPFX
        END) SHPPFX,
        MST.STDPCS,
        MST.STDWGT,
        DIS.ARPCOD,
        DIS.FLTCARIDR FLTCARIDR,
        DIS.FLTNUM FLTNUM,
        DIS.FLTSEQNUM FLTSEQNUM,
        DIS.FLTCARCOD FLTCARCOD,
        DIS.LEGSERNUM LEGSERNUM,
        DIS.FLTDAT FLTDAT,
        DIS.DISCOD DISCOD,
        DIS.CRTTIM CRTTIM,
        DIS.CLSDAT CLSDAT,
        DIS.DISSTA DISSTA,
        DIS.DISRMK DISRMK,
        DIS.DISPCS,
        DIS.DISWGT,
        0 MFTPCS,
        0 RCVPCS,
        NULL FSDMG,
        0 FSDMGPCS,
        ARPSHP.MFTWGT,
        MST.SCCCOD ,
        MST.CNSCOD
      FROM OPRSHPMST MST,
        OPRSHPDIS DIS,
        OPRARPSHP ARPSHP
      WHERE DIS.CMPCOD  = MST.CMPCOD
      AND DIS.DOCOWRIDR = MST.DOCOWRIDR
      AND DIS.MSTDOCNUM = MST.MSTDOCNUM
      AND DIS.SEQNUM    = MST.SEQNUM
      AND DIS.DUPNUM    = MST.DUPNUM
      AND DIS.CMPCOD    = ARPSHP.CMPCOD(+)
      AND DIS.DOCOWRIDR = ARPSHP.DOCOWRIDR(+)
      AND DIS.MSTDOCNUM = ARPSHP.MSTDOCNUM(+)
      AND DIS.SEQNUM    = ARPSHP.SEQNUM(+)
      AND DIS.DUPNUM    = ARPSHP.DUPNUM(+)
      AND DIS.ARPCOD    = ARPSHP.ARPCOD(+)
      AND DIS.CMPCOD    = ?
     
      
	]]>
	</QRY:Source>
	</QRY:Definition>
		<QRY:Definition>
		<QRY:Id>413</QRY:Id>
		<QRY:Source Name="operations.shipment.printdiascrepancy.partthree" Type="NATIVE">
		<![CDATA[
SELECT fndres.mstdocnum RESDOCNUM,
        fndres.shppfx RESSHPPFX,
        fndres.fltnum RESFLTNUM,
        fndres.ARLIDR RESARLIDR,
        fndres.fltdat RESFLTDAT,
        MST.MSTDOCNUM,
        MST.DOCOWRIDR,
        MST.DUPNUM,
        MST.SEQNUM,
        MST.CMPCOD,
        NULL ,
        0 STDPCS,
        0 STDWGT,
        DIS.ARPCOD,
        DIS.FLTCARIDR FLTCARIDR,
        DIS.FLTNUM FLTNUM,
        DIS.FLTSEQNUM FLTSEQNUM,
        DIS.FLTCARCOD FLTCARCOD,
        0 LEGSERNUM,
        DIS.FLTDAT FLTDAT,
        'FDSH' DISCOD,
        DIS.DISDAT CRTTIM,
        NULL CLSDAT,
        DIS.FNDSHPSTA DISSTA,
        DTL.RMK DISRMK,
        DIS.TOTDISPCS DISPCS,
        DIS.TOTDISWGT DISWGT,
        0 MFTPCS,
        0 RCVPCS,
        FNDSHPDMG.DMGCOD FSDMG,
        FNDSHPDMG.DMGPCS FSDMGPCS,
        0 MFTWGT,
        DTL.SCC SCCCOD ,
        NULL CNSCOD
      FROM OPRSHPMST MST,
        OPRFNDSHP DIS,
        OPRFNDSHPDMG FNDSHPDMG,
        OPRFNDSHPRES fndres,
        OPRFNDSHPDTL DTL
      WHERE DIS.CMPCOD        = MST.CMPCOD
      AND DIS.FNDSHPNUM       = MST.MSTDOCNUM
      AND DIS.FNDSHPNUM       = FNDSHPDMG.FNDSHPNUM(+)
      AND DIS.CMPCOD          = FNDSHPDMG.CMPCOD(+)
      AND MST.mstdocnum       =fndres.FNDSHPNUM(+)
      AND DIS.CMPCOD          = DTL.CMPCOD(+)
      AND DIS.FNDSHPNUM       = DTL.FNDSHPNUM(+)
      AND DIS.ARPCOD          = DTL.ARPCOD(+)
      AND DTL.FNDSHPSERNUM(+) = 1
      AND DIS.CMPCOD          = ?
      
      
	]]>
	</QRY:Source>
	</QRY:Definition>
		<QRY:Definition>
		<QRY:Id>413</QRY:Id>
		<QRY:Source Name="operations.shipment.printdiascrepancy.partfour" Type="NATIVE">
		<![CDATA[
SELECT * from(
SELECT NULL RESDOCNUM,
        NULL RESSHPPFX,
        NULL RESFLTNUM,
        NULL RESARLIDR,
        NULL RESFLTDAT,
        MST.MSTDOCNUM,
        MST.DOCOWRIDR,
        MST.DUPNUM,
        MST.SEQNUM,
        MST.CMPCOD,
       
        (
        CASE
          WHEN MST.PARSEQNUM > 0
          THEN ''
          ELSE MST.SHPPFX
        END) SHPPFX,
        MST.STDPCS STDPCS,
        MST.STDWGT STDWGT,
        DIS.ARPCOD,
        DIS.FLTCARIDR FLTCARIDR,
        DIS.FLTNUM FLTNUM,
        DIS.FLTSEQNUM FLTSEQNUM,
        DIS.FLTCARCOD FLTCARCOD,
        0 LEGSERNUM,
        DIS.FLTDAT FLTDAT,
        DIS.DMGCOD DISCOD,
        DIS.DISDAT CRTTIM,
        DIS.CLSDAT CLSDAT,
        DIS.DISSTA DISSTA,
        DIS.RMK DISRMK,
        DIS.DMGPCS DISPCS,
        0 DISWGT,
        0 MFTPCS,
        0 RCVPCS,
        0 MFTWGT,
        mst.scccod SCCCOD ,
        NULL CNSCOD,
		MST.ORGCOD ORGCOD,
		MST.DSTCOD DSTCOD
      FROM OPRSHPMST MST,
        OPRDMGDIS DIS        
WHERE DIS.CMPCOD = MST.CMPCOD AND
DIS.DOCOWRIDR =MST.DOCOWRIDR AND
DIS.MSTDOCNUM=MST.MSTDOCNUM AND
DIS.DUPNUM=MST.DUPNUM AND
DIS.SEQNUM=MST.SEQNUM 
union
 SELECT 
        NULL RESDOCNUM,
        NULL RESSHPPFX,
        NULL RESFLTNUM,
        NULL RESARLIDR,
        NULL RESFLTDAT,
        MST.MSTDOCNUM,
        MST.DOCOWRIDR,
        MST.DUPNUM,
        MST.SEQNUM,
        MST.CMPCOD,
        NULL ,
        0 STDPCS,
        0 STDWGT,
        DIS.ARPCOD,
        DIS.FLTCARIDR FLTCARIDR,
        DIS.FLTNUM FLTNUM,
        DIS.FLTSEQNUM FLTSEQNUM,
        DIS.FLTCARCOD FLTCARCOD,
        0.LEGSERNUM,
        DIS.FLTDAT FLTDAT,
		NULL,
        DIS.DISDAT CRTTIM,
        NULL CLSDAT,
        NULL DISSTA,
        NULL  DISRMK,
        DIS.TOTDISPCS DISPCS,
        DIS.TOTDISWGT DISWGT,
        0 MFTPCS,
        0 RCVPCS,
        0 MFTWGT,
        NULL SCCCOD ,
        NULL CNSCOD ,
          MST.ORGCOD ORGCOD,
		 MST.DSTCOD DSTCOD		
		  FROM OPRSHPMST MST,
        OPRFNDSHP DIS,
        OPRFNDSHPDMG FNDSHPDMG
      WHERE DIS.CMPCOD        = MST.CMPCOD
      AND DIS.FNDSHPNUM       = MST.MSTDOCNUM
      AND DIS.FNDSHPNUM       = FNDSHPDMG.FNDSHPNUM
      AND DIS.CMPCOD          = FNDSHPDMG.CMPCOD) A
      where A.cmpcod=?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
<QRY:Id>205</QRY:Id>
<QRY:Source Name="operations.shipment.listShipmentHandlingHistoryDetails" Type="NATIVE">
	<![CDATA[
SELECT HIS.CMPCOD,
        HIS.DOCOWRIDR,
        HIS.MSTDOCNUM,
        HIS.DUPNUM,
        HIS.SEQNUM,
        HIS.SERNUM,
        HIS.ARPCOD,
        HIS.TXNCOD,
        HIS.TXNDAT,
        HIS.TXNDATUTC,
        HIS.TXNDES,
        HIS.TXNPCS,
        HIS.TXNWGT,
        HIS.SRCIND,
        HIS.TXNVOL
  FROM OPRSHPHIS HIS
  WHERE  HIS.CMPCOD    = ?
			AND HIS.DOCOWRIDR = ?
			AND HIS.MSTDOCNUM = ?
			AND HIS.DUPNUM    = ?
			AND HIS.SEQNUM    = ?

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	    <QRY:Id>414</QRY:Id>
	    <QRY:Source Name="operation.shipment.transactionhousedetails" Type="OBJECT">
		<![CDATA[     	
		SELECT transactionHouse from
			com.ibsplc.icargo.business.operations.shipment.TransactionHouse as transactionHouse
		WHERE
			transactionHouse.transactionHousePK.companyCode=? and 
			transactionHouse.transactionHousePK.masterDocumentNumber=? and 
			transactionHouse.transactionHousePK.ownerId=? and 
			transactionHouse.transactionHousePK.duplicateNumber=? and 
			transactionHouse.transactionHousePK.sequenceNumber=? and 
			transactionHouse.airportCode=?
			]]>
		</QRY:Source>
	</QRY:Definition>
	
	<QRY:Definition>
		<QRY:Id>206</QRY:Id>
			<QRY:Source Name="operations.shipment.saveATandBUMDetails" Type="NATIVE">
			<![CDATA[
				INSERT INTO OPRSHPBUMDTL(UNQIDR,CMPCOD, DOCOWRIDR,MSTDOCNUM,DUPNUM,SEQNUM,SHPPFX,TXNTIM,
					REQRESIND,
					ATHORGCOD,
					ATHDSTCOD,
					ATHPCS,
					ATHWGT,
					ATHVOL,
					ATHPRDCOD,
					ATHPRDPTY,
					ATHPRDTRAMOD,
					ATHPRDSRVOD,
					ATHSHPDES,
					ATHCMDCOD,
					ATHSCCCOD,
					ATHAGTCOD,
					ATHAGTNAM,
					ATHSHPCOD,
					ATHSHPLAVLSVNUM,
					--ATHSHPNAM,
					--ATHSHPPSTCOD,
					ATHCNSCOD,
					ATHCNSLAVLSVNUM,
					--ATHCNSNAM,
					--ATHCNSPSTCOD,
					ATHSCICOD,
					ATHNETCHG,
					ATHVALCHG,
					ATHPAYMOD,
					ATHPAYTYP,
					ATHARLRATTYP,	
					ATHARLTRFNAM, 	
					ATHARLRATLINIDR,		
					ATHPRMTYP,
					ATHLSTEVLDAT,
					ATHGSCAMT,
					ATHDISAMT,
					ATHJNTREV,
					ATHEVLTYP,
					ATHSPTRATIDR,
					ATHQTNREVNUM,

					BKDORGCOD,
					BKDDSTCOD,
					BKDPCS,
					BKDWGT,
					BKDVOL,
					BKDPRDCOD,
					BKDPRDPTY,
					BKDPRDTRAMOD,
					BKDPRDSRVOD,
					BKDSHPDES,
					BKDCMDCOD,
					BKDSCCCOD,
					BKDAGTCOD,
					BKDAGTNAM,
					BKDSHPCOD,
					BKDSHPLAVLSVNUM,
					--BKDSHPNAM,
					--BKDSHPPSTCOD,
					BKDCNSCOD,
					BKDCNSLAVLSVNUM,
					--BKDCNSNAM,
					--BKDCNSPSTCOD,
					BKDSCICOD,
					BKDNETCHG,
					BKDVALCHG,
					BKDPAYMOD,
					BKDPAYTYP,
					BKDARLRATTYP,
					BKDARLTRFNAM,
					BKDARLRATLINIDR,
					BKDPRMTYP,
					BKDLSTEVLDAT,
					BKDGSCAMT,
					BKDDISAMT,
					BKDJNTREV,
					BKDEVLTYP,
					BKDSPTRATIDR,
					BKDQTNREVNUM,
						
					ATHRSNCOD,
					
					ISSATHBKGSYN,
					PCSINNSYN,
					WGTINNSYN,
					VOLINNSYN,	
					ORGINNSYN,	
					DSTINNSYN,	
					SCCINNSYN,
					AGTCODINNSYN,
					SHPCODINNSYN,
					CNSCODINNSYN,
					SHPLAVINNSYN,
					CNSLAVINNSYN,
					--SHPNAMINNSYN,
					--CNSNAMINNSYN,	
					--SHPPSTCODINNSYN,		
					--CNSPSTCODINNSYN,		

					ISSBUMTRG,			
					BUMRSNCOD,	
					STLMAKFLT,
					
					ACPPCSPAR,
					RESEXTAPPPAR,
					ORGDSTDIFPAR,
					RESPFXPAR,
					RESSCRPAR,
					RTNCOD,
					RTNTXT,
					PRCORG,
					PRCACTTYP,
					PRCACTNAM,
					PRCCMP,
					BKGSYNCSCC
					)VALUES
					(OPRSHPBUMDTL_SEQ.NEXTVAL,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,
					?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,
					?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)

					]]>
				</QRY:Source>
	</QRY:Definition>
	
	<QRY:Definition>
	    <QRY:Id>450</QRY:Id>
	    <QRY:Source Name="operations.shipment.listworkdetails" Type="NATIVE">
		<![CDATA[     	
			SELECT WRK.CMPCOD, 
			  WRK.ULDNUM, 
			  WRK.ARPCOD, 
			  WRK.MSTDOCNUM,
			  WRK.DOCOWRIDR,
			  WRK.SEQNUM,
			  WRK.DUPNUM,
			  DTL.WRKFLONAM, 
			  DTL.ASNUSR, 
			  DTL.ACTVAL, 
			  DTL.WRKSTA, 
			  DTL.DUETIM,
			  DTL.DUETIMUTC,
    		  DTL.ACTTIM,
              DTL.ACTTIMUTC, 
			  DTL.HLTTIM, 
			  DTL.CPLTIM, 
			  WRK.LSTUPDTIM,
			  WRK.LSTUPDUSR,
			  DTL.LSTUPDTIM DTLLSTUPDTIM,
			  DTL.LSTUPDUSR DTLLSTUPDUSR,
			  DTL.INTTIM,
			  DTL.INTTIMUTC,
			  WRK.VERNUM, 
			  WRK.WRKSERNUM, 
			  WRK.WRKCFGDOM,
			  DTL.WRKDTLSERNUM,
			  DTL.WRKRMK,
			  DTL.ACTRMK,
			  DTL.CPLUSRCOD,
			  FIRST_VALUE(DTL.ACTVAL) OVER (PARTITION BY WRK.CMPCOD, ULDNUM,DTL.WRKFLONAM,ARPCOD ORDER BY CPLTIM ASC)INIT_ACTVAL, 
			  FIRST_VALUE(DTL.WRKSERNUM) OVER (PARTITION BY WRK.CMPCOD, ULDNUM,DTL.WRKFLONAM,ARPCOD ORDER BY CPLTIM ASC)INIT_WRKSERNUM, 
              FIRST_VALUE(DTL.WRKDTLSERNUM) OVER (PARTITION BY WRK.CMPCOD, ULDNUM,DTL.WRKFLONAM,ARPCOD ORDER BY CPLTIM ASC)INIT_WRKDTLSERNUM, 
			  FIRST_VALUE(DTL.CPLTIM) OVER (PARTITION BY WRK.CMPCOD, ULDNUM,DTL.WRKFLONAM,ARPCOD ORDER BY CPLTIM ASC)INIT_CPLTIM, 
              FIRST_VALUE(DTL.ACTVAL) OVER (PARTITION BY WRK.CMPCOD,ULDNUM,DTL.WRKFLONAM, ARPCOD ORDER BY CPLTIM DESC)FIN_ACTVAL, 
              FIRST_VALUE(DTL.WRKSERNUM) OVER (PARTITION BY WRK.CMPCOD,ULDNUM,DTL.WRKFLONAM, ARPCOD ORDER BY CPLTIM DESC)FIN_WRKSERNUM, 
              FIRST_VALUE(DTL.WRKDTLSERNUM) OVER (PARTITION BY WRK.CMPCOD,ULDNUM,DTL.WRKFLONAM, ARPCOD ORDER BY CPLTIM DESC)FIN_WRKDTLSERNUM,
			  FIRST_VALUE(DTL.CPLTIM) OVER (PARTITION BY WRK.CMPCOD,ULDNUM,DTL.WRKFLONAM, ARPCOD ORDER BY CPLTIM DESC)FIN_CPLTIM 
			FROM OPRSHPWRK WRK 
			INNER JOIN OPRSHPWRKDTL DTL 
			ON WRK.CMPCOD = DTL.CMPCOD 
			AND WRK.WRKSERNUM = DTL.WRKSERNUM 
			AND WRK.VERNUM = DTL.VERNUM 
			AND WRK.CMPCOD =? 
			AND WRK.OVLWRKSTA <> 'I'
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	    <QRY:Id>450</QRY:Id>
	    <QRY:Source Name="operations.shipment.findlatestworkdetails" Type="NATIVE">
		<![CDATA[     	
			SELECT 
			  Z.ULDNUM,
			  Z.WRKFLONAM, 
			  Z.FIN_ACTVAL,
			  Z.FIN_WRKSERNUM,
			  Z.FIN_WRKDTLSERNUM,
			  Z.VERNUM
			FROM
			  (SELECT 
				WRK.ULDNUM,   
				DTL.WRKFLONAM, 
				DTL.INTTIM,    
				FIRST_VALUE(DTL.ACTVAL) OVER (PARTITION BY WRK.CMPCOD,ULDNUM,DTL.WRKFLONAM ORDER BY CPLTIM DESC)FIN_ACTVAL,
				FIRST_VALUE(DTL.WRKSERNUM) OVER (PARTITION BY WRK.CMPCOD,ULDNUM,DTL.WRKFLONAM ORDER BY CPLTIM DESC)FIN_WRKSERNUM,
				FIRST_VALUE(DTL.WRKDTLSERNUM) OVER (PARTITION BY WRK.CMPCOD,ULDNUM,DTL.WRKFLONAM ORDER BY CPLTIM DESC)FIN_WRKDTLSERNUM,
				FIRST_VALUE(DTL.CPLTIM) OVER (PARTITION BY WRK.CMPCOD,ULDNUM,DTL.WRKFLONAM ORDER BY CPLTIM DESC)FIN_CPLTIM,
				DTL.VERNUM
			  FROM OPRSHPWRK WRK
				  INNER JOIN OPRSHPWRKDTL DTL
				  ON WRK.CMPCOD      = DTL.CMPCOD
				  AND WRK.WRKSERNUM  = DTL.WRKSERNUM
				  AND WRK.VERNUM     = DTL.VERNUM
				  AND WRK.CMPCOD     =?
				  AND WRK.OVLWRKSTA <> 'I'
				  AND DTL.INTFLG     = 'Y'
				  AND WRK.MSTDOCNUM  = ?
				  AND WRK.DOCOWRIDR  = ?
				  AND WRK.SEQNUM     = ?
				  AND WRK.DUPNUM     = ?				  
			]]>
		</QRY:Source>
	</QRY:Definition>
	 
<QRY:Definition>
		<QRY:Id>415</QRY:Id>
			<QRY:Source Name="operations.shipment.findshipperreturnnotedetailsforhht" Type="NATIVE">
					<![CDATA[
					SELECT SHPMST.DOCOWRIDR,
					SHPMST.MSTDOCNUM,
					SHPMST.DUPNUM ,
					SHPMST.SEQNUM,
					SHPMST.CMPCOD,
					SHPMST.SHPPFX,
					SHPMST.SHPNAM,
					SHPMST.STDPCS,
					SHPMST.STDWGT,
					SHPMST.GRSVOL,
					SHPMST.DSTCOD,
					SHPMST.PRDNAM,
					SHPMST.SCCCOD,
					SHPMST.SHPDES,
					SHPSRN.SRNNUM,
					SHPSRN.SRNPCS,
					SHPSRN.SRNWGT,
					SHPSRN.ARPCOD,
					SHPSRN.ISSDAT,
					SHPSRN.SRNISSUSR,
					SHPSRN.SRNSTA,
					SHPSRN.EXPDAT,
					SHPSRN.RSNCOD,
					SHPSRN.RMK,
					SHPSRN.PAYADVNUM,
					SHPSRN.PAYADVISSDAT,
					ARPSHPMST.ACPPCS,
					ARPSHPMST.ACPWGT,
					ARPSHPMST.TOTSRNPCS,
					ARPSHPMST.AVLPCS,
					ARPSHPMST.AVLWGT,
					ARPSHPMST.TOTDLVPCS,
					SHPSRN.DLVPCS,
					ARPSHPMST.LSTUPDTIM,
					ARPSHPMST.TMPSTGFLG,
					SHPSRN.LSTUPDTIM SRNTIM
					FROM OPRSHPMST SHPMST,
					OPRSHPSRN SHPSRN,
					OPRARPSHP ARPSHPMST
					WHERE SHPMST.CMPCOD = SHPSRN.CMPCOD
					AND SHPMST.SEQNUM = SHPSRN.SEQNUM
					AND SHPMST.DUPNUM = SHPSRN.DUPNUM
					AND SHPMST.DOCOWRIDR = SHPSRN.DOCOWRIDR
					AND SHPMST.MSTDOCNUM = SHPSRN.MSTDOCNUM
					AND SHPMST.CMPCOD = ARPSHPMST.CMPCOD
					AND SHPMST.SEQNUM = ARPSHPMST.SEQNUM
					AND SHPMST.DUPNUM = ARPSHPMST.DUPNUM
					AND SHPMST.DOCOWRIDR = ARPSHPMST.DOCOWRIDR
					AND SHPMST.MSTDOCNUM = ARPSHPMST.MSTDOCNUM
					AND SHPMST.CMPCOD = ?
					AND ARPSHPMST.ARPCOD = ?
					]]>
				</QRY:Source> 
				</QRY:Definition>

<QRY:Definition>
		<QRY:Id>351</QRY:Id>
		<QRY:Source Name="operations.shipment.findShipmentDetailsHistorySummary" Type="NATIVE">
			<![CDATA[		
				SELECT mst.vernum mstvernum, 
      MST.MSTDOCNUM, 
      MST.CMPCOD MSTCMPCOD, 
      MST.DOCOWRIDR MSTDOCOWRIDR, 
      MST.DUPNUM MSTDUPNUM, 
      MST.SEQNUM MSTSEQNUM, 
      MST.DOCOWRIDR, 
      MST.CNSNAM, 
      MST.SHPNAM, 
      MST.AGTCOD, 
      MST.AGTNAM, 
      MST.SCCCOD, 
      MST.STDPCS, 
      MST.STDWGT, 
      MST.STDWGTCOD, 
      MST.ORGCOD, 
      MST.DSTCOD, 
      MST.CURCOD, 
      mst.PRDNAM, 
      MST.GRSVOL, 
      MST.GRSVOLUNT, 
	  MST.RDYCRGFLG,
      ACC.TOTPPD, 
      ACC.TOTCCF, 
      MST.TRGPNT, 
      MST.LSTUPDTIM MSTLSTUPDTIM, 
      MST.LSTUPDUSR MSTLSTUPDUSR, 
      MST.CHGCOD, 
	  MIS.LSTSHPSRC MISLSTSHPSRC,
      MIS.MIPERRCOD MIPERRCOD, 
	  MIS.MSGSEQNUM MISMSGSEQNUM, 
      DENSE_RANK()OVER (ORDER BY MST.CMPCOD,MST.DOCOWRIDR,MST.MSTDOCNUM,MST.DUPNUM,MST.SEQNUM DESC,MST.VERNUM DESC) AS RANK,
      RAT.RATLINSERNUM RATRATLINSERNUM, 
      CMDITMNAM, 
      MST.CHGGRPCOD,
	  MST.SHPPFX,
	  MST.SHPSTA,
	  MIS.MSGORG MSGORG
    FROM OPRSHPMSTHIS MST, 
      OPRSHPCHGDTLHIS CHG, 
      OPRSHPMSTACCHIS ACC, 
      OPRSHPMSTMISHIS MIS, 
      OPRSHPRATDTLHIS RAT 
    WHERE MST.CMPCOD = ACC.CMPCOD 
    AND MST.DOCOWRIDR = ACC.DOCOWRIDR 
    AND MST.MSTDOCNUM = ACC.MSTDOCNUM 
    AND MST.DUPNUM = ACC.DUPNUM 
    AND MST.SEQNUM = ACC.SEQNUM 
    AND MST.vernum = acc.vernum 
    AND MST.CMPCOD = MIS.CMPCOD 
    AND MST.DOCOWRIDR = MIS.DOCOWRIDR 
    AND MST.MSTDOCNUM = MIS.MSTDOCNUM 
    AND MST.DUPNUM = MIS.DUPNUM 
    AND MST.SEQNUM = MIS.SEQNUM 
    AND MST.vernum = mis.vernum 
    AND MST.CMPCOD = CHG.CMPCOD(+) 
    AND MST.DOCOWRIDR = CHG.DOCOWRIDR(+) 
    AND MST.MSTDOCNUM = CHG.MSTDOCNUM(+) 
    AND MST.DUPNUM = CHG.DUPNUM(+) 
    AND MST.SEQNUM = CHG.SEQNUM(+) 
    AND MST.vernum = chg.vernum(+) 
    AND MST.CMPCOD = RAT.CMPCOD(+) 
    AND MST.DOCOWRIDR = RAT.DOCOWRIDR(+) 
    AND MST.MSTDOCNUM = RAT.MSTDOCNUM(+) 
    AND MST.DUPNUM = RAT.DUPNUM(+) 
    AND MST.SEQNUM = RAT.SEQNUM(+) 
    AND MST.vernum = RAT.vernum(+) 
		]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>352</QRY:Id>
		<QRY:Source Name="operations.shipment.listshipmentworkforperformactivity" Type="NATIVE">
			<![CDATA[		
				SELECT DISTINCT Z.SEQNUM, 
			  Z.MSTDOCNUM, 
			  Z.DUPNUM, 
			  Z.CMPCOD, 
			  Z.DOCOWRIDR, 
			  Z.ARPCOD, 
			  Z.WRKFLONAM, 
			  Z.WRKCFGNAM, 
			  Z.ULDNUM, 
			  Z.ASNUSR, 
			  Z.ACTVAL, 
			  Z.DUETIM, 
			  Z.DUETIMUTC,
			  Z.HLTTIM, 
			  Z.ACTTIM, 
			  Z.ACTTIMUTC,
			  Z.CPLTIM, 
			  Z.WRKSTA, 
			  Z.WRKRMK, 
			  Z.ACTRMK,
			  Z.VERNUM,
			  Z.DTLLSTUPDTIM,
			  Z.DTLLSTUPDUSR, 			  
			  Z.INTTIM,
			  Z.INTTIMUTC, 			  
			  Z.WRKSERNUM, 
			  Z.WRKDTLSERNUM,
			  MST.SHPPFX,
			  MST.SHPPFX||'-'||MST.MSTDOCNUM AS AWBNUM, 
			  MST.SCCCOD, 
			  MST.PRDNAM , 
			  LOC.LOCCOD,
			  COLDTL.DATREF002 MAXSHPTPT,
			  COLDTL.DATREF001 MINSHPTPT,
			  COLDTL.DATREF004 MAXRAPDRYICEWGT,
			  COLMST.SPRVSNFLG,
			  COLDTL.DATREF005 MAXRKNDRYICEWGT,
			  COLDTL.DATREF010 ULDTPT
			FROM 
			  (SELECT WRK.SEQNUM, 
				WRK.MSTDOCNUM, 
				WRK.DUPNUM, 
				WRK.CMPCOD, 
				WRK.DOCOWRIDR, 
				WRK.ARPCOD, 
				DTL.WRKFLONAM, 
				WRK.WRKCFGNAM, 
				WRK.ULDNUM, 
				DTL.ACTVAL, 
				DTL.DUETIM, 
				DTL.DUETIMUTC,
				DTL.HLTTIM, 
				DTL.ACTTIM,
				DTL.ACTTIMUTC, 
				DTL.CPLTIM, 
				DTL.ASNUSR, 
				DTL.WRKSTA, 
				DTL.WRKRMK,
				DTL.ACTRMK,
				DTL.LSTUPDTIM DTLLSTUPDTIM,
			    DTL.LSTUPDUSR DTLLSTUPDUSR, 
			    DTL.INTTIM,
				DTL.INTTIMUTC,
				WRK.VERNUM, 
				WRK.WRKSERNUM, 
				DTL.WRKDTLSERNUM 
			  FROM OPRSHPWRK WRK 
			  INNER JOIN OPRSHPWRKDTL DTL 
			  ON WRK.CMPCOD = DTL.CMPCOD 
			  AND WRK.WRKSERNUM = DTL.WRKSERNUM 
			  AND WRK.VERNUM = DTL.VERNUM 
			  AND WRK.CMPCOD = ?
			  AND (WRK.OVLWRKSTA <> 'I' OR WRK.OVLWRKSTA IS NULL) 
			  AND DTL.WRKSTA ='O' 
			  AND (DTL.ASNUSR = ? or DTL.ASNUSR is null) 			  			 
		]]>
 		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>353</QRY:Id>
		<QRY:Source Name="operations.shipment.listshipmentworkdetails" Type="NATIVE">
			<![CDATA[		
				SELECT Z.SEQNUM, 				  
				  Z.MSTDOCNUM, 
				  Z.DUPNUM, 
				  Z.CMPCOD, 
				  Z.DOCOWRIDR, 
				  Z.ARPCOD, 
				  Z.WRKFLONAM, 
				  Z.WRKCFGNAM, 
				  Z.ULDNUM, 
				  Z.ASNUSR, 
				  Z.ACTVAL, 
				  Z.DUETIM,
				  Z.DUETIMUTC, 
				  Z.HLTTIM, 
				  Z.ACTTIM,
				  Z.ACTTIMUTC, 
				  Z.CPLTIM,
				  Z.CPLTIMUTC,
				  Z.CPLUSRCOD, 
				  Z.WRKSTA, 
				  Z.WRKRMK, 
				  Z.ACTRMK,
				  Z.VERNUM,
				  Z.LSTUPDTIM,
			 	  Z.LSTUPDUSR,
			 	  Z.DTLLSTUPDTIM,
			      Z.DTLLSTUPDUSR,  
				  Z.WRKSERNUM, 
				  Z.WRKDTLSERNUM, 
				  Z.INTTIM,
				  Z.INTTIMUTC, 
				  MST.SHPPFX, 
				  MST.SCCCOD, 
				  MST.PRDNAM , 
				  COLDTL.DATREF002 MAXSHPTPT,
  			  	  COLDTL.DATREF001 MINSHPTPT,				   
				  COLMST.SPRVSNFLG,
				  LOC.LOCCOD,
				  Z.ADHWRKFLG
				FROM 
				  (SELECT WRK.SEQNUM, 
				    WRK.MSTDOCNUM, 
				    WRK.DUPNUM, 
				    WRK.CMPCOD, 
				    WRK.DOCOWRIDR, 
				    WRK.ARPCOD, 
				    DTL.WRKFLONAM, 
				    WRK.WRKCFGNAM, 
				    WRK.ULDNUM, 
				    DTL.ACTVAL, 
				    DTL.DUETIM,
				    DTL.DUETIMUTC, 
				    DTL.HLTTIM, 
				    DTL.ACTTIM,
				    DTL.ACTTIMUTC, 
				    DTL.CPLTIM,
					DTL.CPLTIMUTC,
				    DTL.CPLUSRCOD, 
				    DTL.ASNUSR, 
				    DTL.WRKSTA, 
				    DTL.WRKRMK,
				    DTL.ACTRMK,
				    DTL.LSTUPDTIM DTLLSTUPDTIM,
			        DTL.LSTUPDUSR DTLLSTUPDUSR, 
			        DTL.INTTIM,
					DTL.INTTIMUTC,
				    WRK.VERNUM, 
				    WRK.LSTUPDTIM,
			 		WRK.LSTUPDUSR,
				    WRK.WRKSERNUM, 
				    DTL.WRKDTLSERNUM,
					WRK.ADHWRKFLG
				  FROM OPRSHPWRK WRK 
				  INNER JOIN OPRSHPWRKDTL DTL 
					ON WRK.CMPCOD = DTL.CMPCOD 
					AND WRK.WRKSERNUM = DTL.WRKSERNUM 
					AND WRK.VERNUM = DTL.VERNUM 
				AND WRK.CMPCOD = ? 
				AND WRK.OVLWRKSTA <> 'I' 
		]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>354</QRY:Id>
		<QRY:Source Name="operations.shipment.findshipmentdetailshistoryforarchive2" Type="NATIVE">
			<![CDATA[		
				WHERE MST.CMPCOD     = ACC.CMPCOD
AND MST.DOCOWRIDR    = ACC.DOCOWRIDR
AND MST.MSTDOCNUM    = ACC.MSTDOCNUM
AND MST.DUPNUM       = ACC.DUPNUM
AND MST.SEQNUM       = ACC.SEQNUM
AND MST.VERNUM       = ACC.VERNUM
AND MST.CMPCOD       = MIS.CMPCOD
AND MST.DOCOWRIDR    = MIS.DOCOWRIDR
AND MST.MSTDOCNUM    = MIS.MSTDOCNUM
AND MST.DUPNUM       = MIS.DUPNUM
AND MST.SEQNUM       = MIS.SEQNUM
AND MST.VERNUM       = MIS.VERNUM
AND MST.CMPCOD       = CNT.CMPCOD
AND MST.DOCOWRIDR    = CNT.DOCOWRIDR
AND MST.MSTDOCNUM    = CNT.MSTDOCNUM
AND MST.DUPNUM       = CNT.DUPNUM
AND MST.SEQNUM       = CNT.SEQNUM
AND MST.VERNUM       = CNT.VERNUM
AND MST.CMPCOD       = FLT.CMPCOD(+)
AND MST.DOCOWRIDR    = FLT.DOCOWRIDR(+)
AND MST.MSTDOCNUM    = FLT.MSTDOCNUM(+)
AND MST.DUPNUM       = FLT.DUPNUM(+)
AND MST.SEQNUM       = FLT.SEQNUM(+)
AND MST.VERNUM       = FLT.VERNUM(+)
AND MST.CMPCOD       = CHG.CMPCOD(+)
AND MST.DOCOWRIDR    = CHG.DOCOWRIDR(+)
AND MST.MSTDOCNUM    = CHG.MSTDOCNUM(+)
AND MST.DUPNUM       = CHG.DUPNUM(+)
AND MST.SEQNUM       = CHG.SEQNUM(+)
AND MST.VERNUM       = CHG.VERNUM(+)
AND MST.CMPCOD       = RAT.CMPCOD(+)
AND MST.DOCOWRIDR    = RAT.DOCOWRIDR(+)
AND MST.MSTDOCNUM    = RAT.MSTDOCNUM(+)
AND MST.DUPNUM       = RAT.DUPNUM(+)
AND MST.SEQNUM       = RAT.SEQNUM(+)
AND MST.VERNUM       = RAT.VERNUM(+)
AND RAT.CMPCOD       = DIM.CMPCOD(+)
AND RAT.DOCOWRIDR    = DIM.DOCOWRIDR(+)
AND RAT.MSTDOCNUM    = DIM.MSTDOCNUM(+)
AND RAT.DUPNUM       = DIM.DUPNUM(+)
AND RAT.SEQNUM       = DIM.SEQNUM(+)
AND RAT.RATLINSERNUM = DIM.RATLINSERNUM(+)
AND RAT.VERNUM       = DIM.VERNUM(+)
AND MST.CMPCOD       = DGR.CMPCOD(+)
AND MST.DOCOWRIDR    = DGR.DOCOWRIDR(+)
AND MST.MSTDOCNUM    = DGR.MSTDOCNUM(+)
AND MST.DUPNUM       = DGR.DUPNUM(+)
AND MST.SEQNUM       = DGR.SEQNUM(+)
AND MST.VERNUM       = DGR.VERNUM(+)
AND MST.DOCOWRIDR    = SRV.DOCOWRIDR(+)
AND MST.MSTDOCNUM    = SRV.MSTDOCNUM(+)
AND MST.DUPNUM       = SRV.DUPNUM(+)
AND MST.SEQNUM       = SRV.SEQNUM(+)
AND MST.CMPCOD       = SRV.CMPCOD(+)
AND MST.VERNUM       = SRV.VERNUM(+)
AND MST.DOCOWRIDR    = OTHSRV.DOCOWRIDR(+)
AND MST.MSTDOCNUM    = OTHSRV.MSTDOCNUM(+)
AND MST.DUPNUM       = OTHSRV.DUPNUM(+)
AND MST.SEQNUM       = OTHSRV.SEQNUM(+)
AND MST.VERNUM       = OTHSRV.VERNUM(+)
AND MST.CMPCOD       = OTHSRV.CMPCOD(+)
AND MST.DOCOWRIDR    = SHPACC.DOCOWRIDR(+)
AND MST.MSTDOCNUM    = SHPACC.MSTDOCNUM(+)
AND MST.DUPNUM       = SHPACC.DUPNUM(+)
AND MST.SEQNUM       = SHPACC.SEQNUM(+)
AND MST.VERNUM       = SHPACC.VERNUM(+)
AND MST.CMPCOD       = SHPACC.CMPCOD(+)
AND MST.DOCOWRIDR    = MSTCNT.DOCOWRIDR(+)
AND MST.MSTDOCNUM    = MSTCNT.MSTDOCNUM(+)
AND MST.DUPNUM       = MSTCNT.DUPNUM(+)
AND MST.SEQNUM       = MSTCNT.SEQNUM(+)
AND MST.VERNUM       = MSTCNT.VERNUM(+)
AND MST.CMPCOD       = MSTCNT.CMPCOD(+)
AND MST.DOCOWRIDR    = FLTBOK.DOCOWRIDR(+)
AND MST.MSTDOCNUM    = FLTBOK.MSTDOCNUM(+)
AND MST.DUPNUM       = FLTBOK.DUPNUM(+)
AND MST.SEQNUM       = FLTBOK.SEQNUM(+)
AND MST.VERNUM       = FLTBOK.VERNUM(+)
AND MST.CMPCOD       = FLTBOK.CMPCOD(+)
AND MST.DOCOWRIDR    = OTHPPT.DOCOWRIDR(+)
AND MST.MSTDOCNUM    = OTHPPT.MSTDOCNUM(+)
AND MST.DUPNUM       = OTHPPT.DUPNUM(+)
AND MST.SEQNUM       = OTHPPT.SEQNUM(+)
AND MST.VERNUM       = OTHPPT.VERNUM(+)
AND MST.CMPCOD       = OTHPPT.CMPCOD(+)
AND MST.DOCOWRIDR    = SSR.DOCOWRIDR(+)
AND MST.MSTDOCNUM    = SSR.MSTDOCNUM(+)
AND MST.DUPNUM       = SSR.DUPNUM(+)
AND MST.SEQNUM       = SSR.SEQNUM(+)
AND MST.VERNUM       = SSR.VERNUM(+)
AND MST.CMPCOD       = SSR.CMPCOD(+)
AND MST.DOCOWRIDR    = OCI.DOCOWRIDR(+)
AND MST.MSTDOCNUM    = OCI.MSTDOCNUM(+)
AND MST.DUPNUM       = OCI.DUPNUM(+)
AND MST.SEQNUM       = OCI.SEQNUM(+)
AND MST.VERNUM       = OCI.VERNUM(+)
AND MST.CMPCOD       = OCI.CMPCOD(+) 
AND MST.DOCOWRIDR    = ADLCNT.DOCOWRIDR(+)
AND MST.MSTDOCNUM    = ADLCNT.MSTDOCNUM(+)
AND MST.DUPNUM       = ADLCNT.DUPNUM(+)
AND MST.SEQNUM       = ADLCNT.SEQNUM(+)
AND MST.VERNUM       = ADLCNT.VERNUM(+)
AND MST.CMPCOD       = ADLCNT.CMPCOD(+) 
AND MST.DOCOWRIDR    = DCLHIS.DOCOWRIDR(+)
AND MST.MSTDOCNUM    = DCLHIS.MSTDOCNUM(+)
AND MST.DUPNUM       = DCLHIS.DUPNUM(+)
AND MST.SEQNUM       = DCLHIS.SEQNUM(+)
AND MST.VERNUM       = DCLHIS.VERNUM(+)
AND MST.CMPCOD       = DCLHIS.CMPCOD(+)
AND MST.DOCOWRIDR    = NFYHIS.DOCOWRIDR(+)
AND MST.MSTDOCNUM    = NFYHIS.MSTDOCNUM(+)
AND MST.DUPNUM       = NFYHIS.DUPNUM(+)
AND MST.SEQNUM       = NFYHIS.SEQNUM(+)
AND MST.VERNUM       = NFYHIS.VERNUM(+)
AND MST.CMPCOD       = NFYHIS.CMPCOD(+)  
AND RAT.CMPCOD      =ULD.CMPCOD(+)
AND RAT.DOCOWRIDR   =ULD.DOCOWRIDR(+)
AND RAT.MSTDOCNUM   =ULD.MSTDOCNUM(+)
AND RAT.DUPNUM      =ULD.DUPNUM(+)
AND RAT.SEQNUM      =ULD.SEQNUM(+)
AND RAT.VERNUM      =ULD.VERNUM(+)
AND RAT.RATLINSERNUM=ULD.RATLINSERNUM(+)
		]]>
		</QRY:Source>
	</QRY:Definition>
<QRY:Definition>
<QRY:Id>355</QRY:Id>
<QRY:Source Name="operations.shipment.findAWBLabelSummary" Type="NATIVE">
	<![CDATA[
SELECT AWBLBL.CMPCOD,AWBLBL.DOCOWRIDR,AWBLBL.MSTDOCNUM,AWBLBL.DUPNUM,AWBLBL.SEQNUM,AWBLBL.SERNUM,AWBLBL.LBLIDR, AWBLBL.PCS, AWBLBL.WGT, AWBLBL.LBLREFONE, AWBLBL.LBLREFFOR, AWBLBL.LBLREFFIV, AWBLBL.LBLREFSIX
  ,AWBLBL.LBLREFSEV LBLSTUCOD, AWBLBL.LBLREFEGT LBLWHSCOD, AWBLBL.LBLREFNIN LBLLOCCOD, AWBLBL.SERNUM, AWBLBL.LBLSTA,SHPLOC.LOCPCS, AWBLBL.LBLREFTHR, AWBLBL.LBLREFTWO, AWBLBL.DSTCOD LBLDSTCOD, AWBLBL.ORGCOD LBLORGCOD, SHPMST.SHPPFX SHPPFX,
  ZONATR.PARVAL RLCRSTZON
  FROM OPRAWBLBL AWBLBL
INNER JOIN OPRSHPMST SHPMST
ON AWBLBL.CMPCOD     = SHPMST.CMPCOD
AND AWBLBL.DOCOWRIDR = SHPMST.DOCOWRIDR
AND AWBLBL.MSTDOCNUM = SHPMST.MSTDOCNUM
AND AWBLBL.DUPNUM    = SHPMST.DUPNUM
AND AWBLBL.SEQNUM    = SHPMST.SEQNUM
LEFT OUTER JOIN WHSOPRSHPLOC SHPLOC
ON SHPLOC.CMPCOD = AWBLBL.CMPCOD 
AND SHPLOC.DOCOWRIDR = AWBLBL.DOCOWRIDR 
AND SHPLOC.MSTDOCNUM = AWBLBL.MSTDOCNUM 
AND SHPLOC.DUPNUM = AWBLBL.DUPNUM 
AND SHPLOC.SEQNUM = AWBLBL.SEQNUM 
AND SHPLOC.ARPCOD = AWBLBL.LBLREFFIV 
AND SHPLOC.STUCOD = AWBLBL.LBLREFSEV 
AND SHPLOC.WHSCOD = AWBLBL.LBLREFEGT 
AND SHPLOC.LOCCOD = AWBLBL.LBLREFNIN 
LEFT OUTER JOIN WHSLOCMST LOCMST
ON LOCMST.CMPCOD=AWBLBL.CMPCOD 
AND LOCMST.ARPCOD=AWBLBL.LBLREFFIV
AND LOCMST.WHSCOD=AWBLBL.LBLREFEGT
AND LOCMST.LOCCOD=AWBLBL.LBLREFNIN
LEFT OUTER JOIN WHSZONMST ZONMST 
ON ZONMST.CMPCOD = LOCMST.CMPCOD 
AND ZONMST.ARPCOD = LOCMST.ARPCOD 
AND ZONMST.WHSCOD = LOCMST.WHSCOD 
AND ZONMST.ZONCOD = LOCMST.ZONCOD 
LEFT OUTER JOIN WHSZONTYPMST ZONTYP 
ON ZONTYP.CMPCOD = ZONMST.CMPCOD 
AND ZONTYP.ARPCOD = ZONMST.ARPCOD 
AND ZONTYP.ZONTYP = ZONMST.ZONTYP 
LEFT OUTER JOIN WHSZONATRDTL ZONATR
ON LOCMST.CMPCOD = ZONATR.CMPCOD
AND LOCMST.ARPCOD   = ZONATR.ARPCOD
AND LOCMST.WHSCOD   = ZONATR.WHSCOD
AND LOCMST.ZONCOD   = ZONATR.ZONCOD
AND ZONATR.PARCOD   = 'RSTMANREL'
WHERE AWBLBL.CMPCOD  =?
AND AWBLBL.LBLREFFIV    =? 
		]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>356</QRY:Id>
		<QRY:Source Name="operations.shipment.findHandlerClassNames" Type="NATIVE">
			<![CDATA[
				SELECT
					HNDCLS,
					HNDKEY
				FROM OPRHNDCLSCFG
				WHERE CMPCOD = ?
				AND HNDTYP = ?
				ORDER BY HNDKEY, HNDCLS
				]]>
		</QRY:Source>
	</QRY:Definition>
		<QRY:Definition>
		<QRY:Id>356</QRY:Id>
		<QRY:Source Name="operations.shipment.findShipmentTOA" Type="NATIVE">
			<![CDATA[
				SELECT MAX(BKGMST.SHPDLVTIM)
				FROM OPRSHPMST SHPMST
				INNER JOIN CAPBKGMST BKGMST
				ON SHPMST.CMPCOD  = BKGMST.CMPCOD
				AND SHPMST.UBRNUM = BKGMST.UBRNUM
				AND BKGMST.BKGSTA          IN ('C','Q')
				WHERE SHPMST.CMPCOD  = ?
				AND SHPMST.DOCOWRIDR = ?
				AND SHPMST.MSTDOCNUM = ?
				AND SHPMST.DUPNUM    = ?
				AND SHPMST.SEQNUM    = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
<!--Added for icrd-101551_ by A-4812-->
		<QRY:Id>357</QRY:Id>
		<QRY:Source Name="operations.shipment.findlatestexecutedversion" Type="NATIVE">
			<![CDATA[
SELECT mst.vernum mstvernum,
  MST.MSTDOCNUM,
  MST.CMPCOD MSTCMPCOD,
  MST.DOCOWRIDR MSTDOCOWRIDR,
  MST.DUPNUM MSTDUPNUM,
  MST.SEQNUM MSTSEQNUM,
  MST.DOCNUM,
	ACC.JRNDAT,
  MST.PLTFLG,
  MST.SHPBNDFLG,
  MST.DOCTYP,
  MST.PARSEQNUM,
  MST.RFCFLG,
  MST.CRAIMPFLG,
  MST.SHPPFX,
  MST.SHPSTA,
  MST.SHPTYP,
  MST.UBRNUM,
  MST.CONFLG,
  MST.HSEFINFLG,
	ACC.IATCOD,
  MST.DOCOWRIDR,
  CNT.CNSACCNUM,
  MST.CNSADRONE,
  CNT.CNSADRTWO,
  MST.CNSCOD,
  CNT.CNSCTR,
  CNT.CNSCTY,
  CNT.CNSMALIDR,
  MST.CNSNAM,
  CNT.CNSPRTNFNFLG,
  CNT.CNSPSTCOD,
  CNT.CNSSTT,
  CNT.CNSTELNUM,
  CNT.SHPACCNUM,
  MST.SHPADRONE,
  CNT.SHPADRTWO,
  MST.SHPCOD,
  CNT.SHPCTR,
  CNT.SHPCTY,
  CNT.SHPMALIDR,
  MST.SHPNAM,
  CNT.SHPPSTCOD,
  CNT.SHPSTT,
  CNT.SHPTELNUM,
  CNT.NFYACCNUM,
  CNT.NFYADRONE,
  CNT.NFYADRTWO,
  MST.NFYCOD,
  CNT.NFYCTR,
  CNT.NFYCTY,
  CNT.NFYMALIDR,
  MST.NFYNAM,
  CNT.NFYPSTCOD,
  CNT.NFYSTT,
  CNT.NFYTELNUM,
  MST.AGTCOD,
  MST.AGTNAM,
ACC.CASCOD,
  MST.SCCCOD,
  MST.DTACPTFLG,
  MST.STDDISWGT,
  MST.STDPCS,
  MST.STDWGT,
  MST.STDWGTCOD,
  MST.HDLINF,
  MST.SHPDES,
  MST.ORGCOD,
  MST.DSTCOD,
  MST.SPTRATIDR,
  MST.PAYTYP MSTPAYTYP,
  ACC.DVLCUS,
  ACC.DVLCAR,
  MST.CURCOD,
  MST.EXEUSRCOD,
  MST.EXESTN,
  MST.EXEFLG,
  MST.EXEDAT,
  ACC.ACCINF,
  ACC.INSMINAMT,
  ACC.INSAMT,
  mst.PRDNAM,
  mst.PRDPRT,
ACC.RATCONIDR,
  mst.PRDCOD,
ACC.SRVCRGCLS,
  ACC.TOTDUECARPPCHG,
  ACC.TOTDUECARCCCHG,
  ACC.TOTDUEAGTPPCHG,
  ACC.TOTDUEAGTCCCHG,
  ACC.WGTPPCHG,
  ACC.WGTCCCHG,
  ACC.VALPPCHG,
  ACC.VALCCCHG,
  ACC.TAXPPD,
  ACC.TAXCCF,
   MST.GRSVOL,
  MST.GRSDISVOL,
  MST.GRSVOLUNT,
  ACC.TOTPPD,
  ACC.TOTCCF,
  ACC.CSHFLG,
  MST.OWRCOD,
  ACC.SPTRAT,
  ACC.SPTRATAPRDAT,
  ACC.SPTRATREQDAT,
  ACC.SPTRATSTA,
  ACC.CMSPPD,
  ACC.CMSCCF,
MST.SLCPCS SLCPCS,
  ACC.UNQREFONE UNQREFONE,
	  ACC.UNQREFTWO UNQREFTWO,
	  ACC.UNQREFTHR UNQREFTHR,
	  ACC.UNQREFFOR UNQREFFOR,
	  ACC.UNQREFFIV UNQREFFIV,
	  ACC.HGRWGTBRK,
	  CHG.CHGHEDIDR,
CHG.CHGAMT,
CHG.PAYTYP CHGPAYTYP,
CHG.DUECARFLG,
CHG.DUEAGTFLG,
CHG.CHGRMK,
CHG.CHGHED,
CHG.CMPCOD 

CHGCMPCOD,
CHG.DOCOWRIDR CHGDOCOWRIDR,
CHG.MSTDOCNUM CHGMSTDOCNUM,
CHG.DUPNUM CHGDUPNUM,
CHG.SEQNUM 
CHGSEQNUM,
CHG.CHDCOD,
CHG.TAX 
CHDTAX,
  MST.SRCIND,
  MST.TRGPNT,
  MST.MISMTH,
  MST.STKHLDCOD,
  MST.CAOFLG,
  MST.LSTUPDTIM MSTLSTUPDTIM,
  MST.LSTUPDUSR MSTLSTUPDUSR,
  MST.CHGCOD,
ACC.RATCONSTA,
DENSE_RANK()OVER (ORDER BY MSTCMPCOD,MSTDOCOWRIDR,MST.MSTDOCNUM,MSTDUPNUM,MSTSEQNUM,MST.VERNUM DESC) AS RANK,
RAT.SEQNUM RATSEQNUM,
RAT.RATLINSERNUM RATRATLINSERNUM,
RAT.NUMPCS RATNUMPCS,
GRSWGT 
RATGRSWGT,
  RAT.GRSVOL RATGRSVOL,
  CMDITMNUM,
  CMDITMNAM,
  IATRATCLS,
  ACTRATCLS,
  ARLRATCLS,
  IATRAT,
  ARLRAT,
  CHGWGT,
  RATDES,
  ARLRATLINIDR,
  IATRATLINIDR,
   RAT.SCCCOD RATSCCCOD,
RAT.TAX,
		 RAT.ARLTRFNAM,
		  RAT.IATTRFNAM,
		  RAT.ARLTRFSERNUM,
		  RAT.IATTRFSERNUM,
		  RAT.ARLTRFRATSERNUM,
		  RAT.IATTRFRATSERNUM,
		  RAT.IATULDTYP IATULDTYP,
		  RAT.CRTREF,
		  RAT.NUMULD NUMULD,
		  RAT.SRVCOD,
		  RAT.RCP,
		   RAT.HRMCMDCOD,
			  RAT.IATRATTYP,
			   MST.CHGGRPCOD,
  MST.VODFLG MSTVODFLG,
  MST.RDYCRGFLG,
  MST.RATLINRMK MSTRATLINRMK,
  MST.PRGCLSDAT MSTPRGCLSDAT,
  MST.PAYDUEFLG MSTPAYDUEFLG,
  MST.MSTCLSTIM 
MSTMSTCLSTIM,
  MST.INTFLG MSTINTFLG,
  MST.FRCCLSRMK MSTFRCCLSRMK,
  MST.FRCCLSFLG MSTFRCCLSFLG,
  MST.CPTDATUTC 
MSTCPTDATUTC,
  MST.CPTDAT MSTCPTDAT,
	  CHG.ACTCHGAMT CHGACTCHGAMT,
	  CHG.TAXPCT CHGTAXPCT,
	  CHG.VERNUM 
CHGVERNUM,
	  CHG.MNLUPDFLG CHGMNLUPDFLG,
	  CHG.PAYMOD CHGPAYMOD,
	  CHG.CHDGRSAMT CHGCHDGRSAMT,
	  CHG.ETYSUBCOD CHGETYSUBCOD,
	  CHG.CUSTYP CHGCUSTYP,
	  CHG.CUSCOD CHGCUSCOD,
  RAT.ACTALNCHG RATACTALNCHG,
  RAT.ACTARLRAT RATACTARLRAT,
  RAT.ACTCHGWGT RATACTCHGWGT,
  RAT.ACTCMDITMNUM RATACTCMDITMNUM,
  RAT.ACTGRSVOL 
RATACTGRSVOL,
  RAT.ACTIATCHG RATACTIATCHG,
  RAT.ACTIATRAT RATACTIATRAT,
  RAT.ACTNETCHG RATACTNETCHG,
  RAT.AGTCMS RATAGTCMS,
  RAT.ALNBSECHG ALNBSECHG,
  RAT.ALNCHG ALNCHG,
  RAT.ARLRATTYP RATARLRATTYP,
  RAT.CMPCOD RATCMPCOD,
  RAT.CONFLG RATCONFLG,
  RAT.CTRORG RATCTRORG,
  RAT.DOCOWRIDR RATDOCOWRIDR,
  RAT.DSCPCT RATDSCPCT,
  RAT.DUPNUM RATDUPNUM,
  RAT.GRSDISWGT RATGRSDISWGT,
  RAT.GRSWGTCOD RATGRSWGTCOD,
  RAT.IATBSECHG IATBSECHG,
  RAT.IATCHG IATCHG,
  RAT.IATCOD RATIATCOD,
  RAT.LSTUPDTIM RATLSTUPDTIM,
  RAT.LSTUPDUSR RATLSTUPDUSR,
  RAT.MIPCOMNUM RATMIPCOMNUM,
  RAT.MIPCONDES RATMIPCONDES,
  RAT.MIPCTRORN 
RATMIPCTRORN,
  RAT.MIPGODDES RATMIPGODDES,
  RAT.MIPGRSVOL RATMIPGRSVOL,
  RAT.MIPGRSWGTCOD RATMIPGRSWGTCOD,
  RAT.MIPHRMCMDCOD RATMIPHRMCMDCOD,
  RAT.MIPRATCLS RATMIPRATCLS,
  RAT.MIPSLAC RATMIPSLAC,
  RAT.MIPSRVCOD 
RATMIPSRVCOD,
  RAT.MIPULDNUM RATMIPULDNUM,
  RAT.MIPVOLCOD RATMIPVOLCOD,
  RAT.MSTDOCNUM RATMSTDOCNUM,
  RAT.NETCHG NETCHG,
  RAT.OVRFLWFLG RATOVRFLWFLG,
  RAT.PARSERNUM RATPARSERNUM,
  RAT.RATLINSEQNUM RATRATLINSEQNUM,
  RAT.RATUSEFLG RATRATUSEFLG,
  RAT.SHPTAXPCT RATSHPTAXPCT,
  RAT.TAXBSSVAL RATTAXBSSVAL,
  RAT.TAXPCT RATTAXPCT,
  RAT.VERNUM RATVERNUM,
   CNT.AGTADR CNTAGTADR,
  CNT.AGTCTR 
CNTAGTCTR,
  CNT.AGTCTY CNTAGTCTY,
  CNT.AGTPSTCOD CNTAGTPSTCOD,
  CNT.AGTSTT CNTAGTSTT,
  CNT.CMPCOD 
CNTCMPCOD,
  CNT.CNSERINUM CNTCNSERINUM,
  CNT.DOCOWRIDR CNTDOCOWRIDR,
  CNT.DUPNUM CNTDUPNUM,
  CNT.MSTDOCNUM 
CNTMSTDOCNUM,
  CNT.NFYERINUM CNTNFYERINUM,
  CNT.POA CNTPOA,
  CNT.SEQNUM CNTSEQNUM,
  CNT.SHPERINUM 
CNTSHPERINUM,
  CNT.SHPREFNUM CNTSHPREFNUM,
  CNT.VERNUM CNTVERNUM,
  ACC.ACTCMSCCF ACCACTCMSCCF,
  ACC.ACTCMSPPD 
ACCACTCMSPPD,
  ACC.ACTTAXCCF ACCACTTAXCCF,
  ACC.ACTTAXPPD ACCACTTAXPPD,
  ACC.ACTTOTCCF 
ACCACTTOTCCF,
  ACC.ACTTOTDUEAGTCCCHG ACCACTTOTDUEAGTCCCHG,
  ACC.ACTTOTDUEAGTPPCHG ACCACTTOTDUEAGTPPCHG,
  ACC.ACTTOTDUECARCCCHG 
ACCACTTOTDUECARCCCHG,
  ACC.ACTTOTDUECARPPCHG ACCACTTOTDUECARPPCHG,
  ACC.ACTTOTPPD 
ACCACTTOTPPD,
  ACC.ACTVALCCCHG 
ACCACTVALCCCHG,
  ACC.ACTVALPPCHG ACCACTVALPPCHG,
  ACC.ACTWGTCCCHG 
ACCACTWGTCCCHG,
  ACC.ACTWGTPPCHG 
ACCACTWGTPPCHG,
  ACC.AGTACCNUM ACCAGTACCNUM,
  ACC.ATOCMTTAX ACCATOCMTTAX,
  ACC.CMPCOD ACCCMPCOD,
  ACC.CMSAMT ACCCMSAMT,
  ACC.CMSCASIND ACCCMSCASIND,
  ACC.CMSPCT ACCCMSPCT,
  ACC.CONCHG ACCCONCHG,
  ACC.CONRAT ACCCONRAT,
  ACC.DOCOWRIDR ACCDOCOWRIDR,
  ACC.DSTCCFCHG ACCDSTCCFCHG,
  ACC.DSTCHG ACCDSTCHG,
  ACC.DSTCNVRAT ACCDSTCNVRAT,
  ACC.DSTCURCOD ACCDSTCURCOD,
  ACC.DUPNUM ACCDUPNUM,
  ACC.INSPCT ACCINSPCT,
  ACC.MIPDESCURCOD ACCMIPDESCURCOD,
  ACC.MNLCPTFLG ACCMNLCPTFLG,
  ACC.MSTDOCNUM 
ACCMSTDOCNUM,
  ACC.OTHPAYTYP 
ACCOTHPAYTYP,
  ACC.RATCONAPRDAT ACCRATCONAPRDAT,
  ACC.RATCONREQDAT ACCRATCONREQDAT,
  ACC.SALINCAMT 
ACCSALINCAMT,
  ACC.SALINCCASIND ACCSALINCCASIND,
  ACC.SEQNUM ACCSEQNUM,
  ACC.SHPREFNUM 
ACCSHPREFNUM,
  ACC.SPTCHG ACCSPTCHG,
  ACC.TOTDSTCCFCHG 
ACCTOTDSTCCFCHG,
  ACC.VALTAX ACCVALTAX,
  ACC.VERNUM ACCVERNUM,
  ACC.VFYEXEFLG ACCVFYEXEFLG,
  ACC.PAYMOD 
ACCPAYMOD,
   ACC.TOTARLCHG,
  ACC.JNTREV,
  ACC.GSCCMS,
  ACC.GSCADLCMS,
  ACC.DSTEXGRATBSS 
ACCDSTEXGRATBSS,
  ACC.DSTCURCNVDAT ACCDSTCURCNVDAT,
  CNT.AGTSTN AGTSTACOD,
  CNT.SHPSTN SHPSTNCOD,
  CNT.CNSSTN CNSSTNCOD,
  ULD.CMPCOD ULDCMPCOD,ULD.DOCOWRIDR ULDDOCOWRIDR,ULD.MSTDOCNUM ULDMSTDOCNUM,
  ULD.DUPNUM ULDDUPNUM,ULD.SEQNUM ULDSEQNUM,ULD.RATLINSERNUM ULDRATLINSERNUM,
  ULD.SERNUM ULDSERNUM, ULD.ULDNUM ULDNUM,ULD.SLCPCS ULDSLCPCS
  FROM OPRSHPMSTHIS MST,
  OPRSHPCHGDTLHIS CHG,
  OPRSHPMSTACCHIS ACC,
  OPRSHPMSTCNTHIS CNT,
  OPRSHPRATDTLHIS RAT, 
  OPRSHPRATULD ULD
WHERE MST.CMPCOD     = ACC.CMPCOD
AND MST.DOCOWRIDR    
= ACC.DOCOWRIDR
AND MST.MSTDOCNUM    
= ACC.MSTDOCNUM
AND MST.DUPNUM       = ACC.DUPNUM
AND MST.SEQNUM       
= ACC.SEQNUM
AND MST.vernum       
= acc.vernum
AND MST.CMPCOD       = CNT.CMPCOD
AND MST.DOCOWRIDR    
= CNT.DOCOWRIDR
AND MST.MSTDOCNUM    
= CNT.MSTDOCNUM
AND MST.DUPNUM       = CNT.DUPNUM
AND MST.SEQNUM       
= CNT.SEQNUM
AND MST.vernum       
= cnt.vernum
AND MST.DOCOWRIDR    = CHG.DOCOWRIDR(+)
AND MST.MSTDOCNUM    
= CHG.MSTDOCNUM(+)
AND MST.DUPNUM       
= CHG.DUPNUM(+)
AND MST.SEQNUM       = CHG.SEQNUM(+)
AND MST.vernum       
= chg.vernum(+)
AND MST.CMPCOD       
= RAT.CMPCOD(+)
AND MST.DOCOWRIDR    = RAT.DOCOWRIDR(+)
AND MST.MSTDOCNUM    
= RAT.MSTDOCNUM(+)
AND MST.DUPNUM       
= RAT.DUPNUM(+)
AND MST.SEQNUM       = RAT.SEQNUM(+)
AND MST.vernum       
= RAT.vernum(+)
AND RAT.CMPCOD      =ULD.CMPCOD(+)
		AND RAT.DOCOWRIDR   =ULD.DOCOWRIDR(+)
		AND RAT.MSTDOCNUM   =ULD.MSTDOCNUM(+)
		AND RAT.DUPNUM      =ULD.DUPNUM(+)
		AND RAT.SEQNUM      =ULD.SEQNUM(+)
		AND RAT.RATLINSERNUM=ULD.RATLINSERNUM(+) 
				]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>357</QRY:Id>
		<QRY:Source Name="operations.shipment.findworkdetailsforshipment" Type="OBJECT">
			<![CDATA[
				SELECT shipmentWork from
				com.ibsplc.icargo.business.operations.shipment.work.ShipmentWork as shipmentWork ,
				com.ibsplc.icargo.business.operations.shipment.work.ShipmentWorkDetail as shipmentWorkDetail
	WHERE		
				shipmentWork.shipmentWorkPK.companyCode=shipmentWorkDetail.shipmentWorkDetailPK.companyCode AND
				shipmentWork.shipmentWorkPK.workSerialNumber=shipmentWorkDetail.shipmentWorkDetailPK.workSerialNumber AND
				shipmentWork.shipmentWorkPK.versionNumber=shipmentWorkDetail.shipmentWorkDetailPK.versionNumber AND
					shipmentWork.overallworkStatus ='A' AND
					shipmentWork.shipmentWorkPK.companyCode=? AND
		shipmentWork.masterDocumentNumber=? AND
					shipmentWork.ownerId=? AND
		shipmentWork.sequenceNumber=? AND
		shipmentWork.duplicateNumber=?
				]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	    <QRY:Id>358</QRY:Id>
	    <QRY:Source Name="operation.shipment.findShipmentMasterHistoryObjects" Type="OBJECT">
	      <![CDATA[     	
	      SELECT shipmentHistory from
		com.ibsplc.icargo.business.operations.shipment.ShipmentMasterHistory as shipmentHistory
		WHERE
		shipmentHistory.shipmentMasterHistoryPk.companyCode=? 
	      ]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	    <QRY:Id>359</QRY:Id>
	    <QRY:Source Name="operation.shipment.findShipmentHistoryForPrint_part1" Type="NATIVE">
	      <![CDATA[ 
		  SELECT MST.SHPPFX,
    MST.CMPCOD,
    PKG_FRMWRK_DATE.FUN_GET_LOCALDATE(MST.CMPCOD,?,(PKG_FRMWRK_DATE.FUN_GET_UTCDATE(MST.CMPCOD,SHPAUD.STNCOD,SHPAUD.updtxntim))) TXNDATATSTN,
    PKG_FRMWRK_DATE.FUN_GET_UTCDATE(MST.CMPCOD,SHPAUD.STNCOD,SHPAUD.updtxntim) LSTUPDTIMUTC,
    shpaud.updtxntimutc TXNDATUTC,
    shpaud.updtxntim TXNDAT,
    shpaud.updtxntim LSTUPDTIM,
    MST.DOCOWRIDR,
    MST.MSTDOCNUM,
    MST.DUPNUM,
    MST.SEQNUM,
    NULL SERNUM,
    SHPAUD.STNCOD ARPCOD,
    SHPAUD.ACTCOD,
    CASE
      WHEN ONETIM.FLDVAL IS NOT NULL
      THEN ONETIM.FLDDES
      ELSE SHPAUD.ACTCOD
    END TXNDES,
    MST.ORGCOD,
    MST.DSTCOD,
    SHPAUD.ADLINF ,
    0 TXNPCS,
    0 TXNWGT,
    0 TXNVOL,
    MST.STDPCS,
    MST.STDWGT,
    MST.GRSVOL,
    MST.SHPDES,
    MST.PRDCOD,
    MST.PRDNAM,
    MST.SCCCOD,
    NULL TXNREFONE,
    NULL TXNREFTWO,
    NULL TXNREFTHR,
    NULL TXNREFFOR,
    NULL TXNREFFIV,
    NULL TXNREFSIX,
    NULL TXNREFSEV,
    SHPAUD.TRGPNT SRCIND,
    SHPAUD.UPDUSR LSTUPDUSR,
    NULL TXNREFFIFTEN,
    NULL TXNREFEGT,
    NULL TXNREFEIN,
    NULL TXNREFELV,
    NULL TXNREFNIN,
    NULL TXNREFNUM,
    NULL TXNREFTEN,
    NULL TXNREFTLV,
    NULL TXNREFTTN,
    NULL TXNREFFTN
  FROM OPRSHPMST MST ,
    OPRSHPAUD SHPAUD ,
    SHRONETIM ONETIM 
  WHERE MST.CMPCOD     = SHPAUD.CMPCOD
  AND SHPAUD.MSTDOCNUM = MST.MSTDOCNUM
  AND SHPAUD.DOCOWRIDR = MST.DOCOWRIDR
  AND SHPAUD.DUPNUM    = MST.DUPNUM
  AND SHPAUD.SEQNUM    = MST.SEQNUM
  AND SHPAUD.CMPCOD    = ONETIM.CMPCOD
  AND SHPAUD.ACTCOD    = ONETIM.FLDVAL
  AND ONETIM.FLDTYP    = 'operations.shipment.auditactioncode'
		   ]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	    <QRY:Id>360</QRY:Id>
	    <QRY:Source Name="operation.shipment.findShipmentHistoryForPrint_part2" Type="NATIVE">
	      <![CDATA[  
		  UNION
		  SELECT MST.SHPPFX,
    MST.CMPCOD,
    PKG_FRMWRK_DATE.FUN_GET_LOCALDATE(MST.CMPCOD,?,(PKG_FRMWRK_DATE.FUN_GET_UTCDATE(MST.CMPCOD,HIS.ARPCOD,HIS.LSTUPDTIM))) TXNDATATSTN,
    PKG_FRMWRK_DATE.FUN_GET_UTCDATE(MST.CMPCOD,HIS.ARPCOD,HIS.LSTUPDTIM) LSTUPDTIMUTC,
    HIS.TXNDATUTC TXNDATUTC,
    HIS.TXNDAT TXNDAT,
    HIS.LSTUPDTIM LSTUPDTIM,    
    MST.DOCOWRIDR,
    MST.MSTDOCNUM,
    MST.DUPNUM,
    MST.SEQNUM,
    HIS.SERNUM,
    HIS.ARPCOD,
    HIS.TXNCOD ACTCOD,
    HIS.TXNDES,
    MST.DSTCOD,
    MST.ORGCOD,
    NULL ADLINF ,
    HIS.TXNPCS,
    HIS.TXNWGT,
    HIS.TXNVOL,
    MST.STDPCS,
    MST.STDWGT,
    MST.GRSVOL,
    MST.SHPDES,
    MST.PRDCOD,
    MST.PRDNAM,
    MST.SCCCOD,
    HIS.TXNREFONE,
    HIS.TXNREFTWO,
    HIS.TXNREFTHR,
    HIS.TXNREFFOR,
    HIS.TXNREFFIV,
    HIS.TXNREFSIX,
    HIS.TXNREFSEV,
    HIS.SRCIND,
    HIS.LSTUPDUSR,
    HIS.TXNREFFIFTEN,
    HIS.TXNREFEGT,
    HIS.TXNREFEIN,
    HIS.TXNREFELV,
    HIS.TXNREFNIN,
    HIS.TXNREFNUM,
    HIS.TXNREFTEN,
    HIS.TXNREFTLV,
    HIS.TXNREFTTN,
    HIS.TXNREFFTN
  FROM OPRSHPMST MST,
    OPRSHPHIS HIS
  WHERE HIS.CMPCOD  = MST.CMPCOD
  AND HIS.DOCOWRIDR = MST.DOCOWRIDR
  AND HIS.MSTDOCNUM = MST.MSTDOCNUM
  AND HIS.DUPNUM    = MST.DUPNUM
  AND HIS.SEQNUM    = MST.SEQNUM  
	      ]]>
		</QRY:Source>
	</QRY:Definition>
	<!--Added for ICRD-103056 by A-5163 ends-->
	<QRY:Definition>
	    <QRY:Id>361</QRY:Id>
		<QRY:Source Name="operations.shipment.findOtherCustomsInformation" Type="OBJECT">
	      <![CDATA[     	
				SELECT 	OCI.CUSINF,
						OCI.SRCIND,
						OCI.CNTCOD,
						OCI.INFIDF,
						OCI.CUSINFIDF,
						OCI.SERNUM
				FROM OPRSHPOCI OCI
				WHERE CMPCOD  = ?
					AND DOCOWRIDR = ?
					AND MSTDOCNUM = ?
					AND DUPNUM    = ?
					AND SEQNUM    = ?
					
	      ]]>
		</QRY:Source>
	</QRY:Definition>
	<!--Added for ICRD-103056 by A-5163 ends-->
	<QRY:Definition>
	    <QRY:Id>362</QRY:Id>
		<QRY:Source Name="operations.shipment.fetchshipmentsapplicableforiqajob" Type="NATIVE">
	      <![CDATA[     	
				SELECT SHP.CMPCOD, 
				SHP.DOCOWRIDR, 
				SHP.MSTDOCNUM, 
				SHP.SEQNUM, 
				SHP.DUPNUM 
				FROM OPRSHPMST SHP 
				INNER JOIN OPRSHPHIS HIS 
				ON SHP.CMPCOD = HIS.CMPCOD 
				AND SHP.DOCOWRIDR = HIS.DOCOWRIDR 
				AND SHP.MSTDOCNUM = HIS.MSTDOCNUM 
				AND SHP.SEQNUM = HIS.SEQNUM 
				AND SHP.DUPNUM = HIS.DUPNUM 
and shp.dstcod = his.arpcod 
and shp.seqnum = 1 
left outer join cshqltasrmst mst ON 
his.cmpcod= mst.cmpcod
and his.mstdocnum= mst.mstdocnum
AND his.SEQNUM = mst.SEQNUM
and his.dupnum = mst.dupnum 
AND his.DOCOWRIDR = mst.DOCOWRIDR
				WHERE HIS.TXNCOD = 'RCF' 
AND ( mst.qltasrsta is null OR mst.qltasrsta='O')
and shp.cmpcod =?
and his.txndatutc >?
				AND HIS.TXNDATUTC <= ?
				AND ( 
				(EXISTS 
				(SELECT 1
				FROM SHRUSEARPPAR PAR
				WHERE PAR.CMPCOD = SHP.CMPCOD
				AND PAR.ARPCOD   = SHP.DSTCOD
				AND PAR.PARCOD  IN ( 'shared.area.airport.isautoiqajobenabled' )
and par.parval = 'Y')))
				group by SHP.CMPCOD, 
				SHP.DOCOWRIDR, 
				SHP.MSTDOCNUM, 
shp.seqnum, 
shp.dupnum
	      ]]>
		</QRY:Source>
	</QRY:Definition>
	 <QRY:Definition>
	    <QRY:Id>363</QRY:Id>
		<QRY:Source Name="operations.shipment.findBUMDetails" Type="NATIVE">
	      <![CDATA[     	
				SELECT BUM.DOCOWRIDR,
				  BUM.MSTDOCNUM,
				  BUM.DUPNUM,
				  BUM.SEQNUM,
				  BUM.SHPPFX,
				  BUM.TXNTIM,
				  BUM.REQRESIND,
				  BUM.ATHORGCOD,
				  BUM.ATHDSTCOD,
				  BUM.ATHPCS,
				  BUM.ATHWGT,
				  BUM.ATHVOL,
				  BUM.ATHPRDCOD,
				  BUM.ATHPRDPTY,
				  BUM.ATHPRDTRAMOD,
				  BUM.ATHPRDSRVOD,
				  BUM.ATHSHPDES,
				  BUM.ATHCMDCOD,
				  BUM.ATHSCCCOD,
				  BUM.ATHAGTCOD,
				  BUM.ATHAGTNAM,
				  BUM.ATHSHPCOD,
				  BUM.ATHSHPLAVLSVNUM,
				--BUM.ATHSHPNAM,
				--BUM.ATHSHPPSTCOD,
				  BUM.ATHCNSCOD,
				  BUM.ATHCNSLAVLSVNUM,
				--BUM.ATHCNSNAM,
				--BUM.ATHCNSPSTCOD,
				  BUM.ATHSCICOD,
				  BUM.ATHNETCHG,
				  BUM.ATHVALCHG,
				  BUM.ATHPAYMOD,
				  BUM.ATHPAYTYP,
				  BUM.ATHARLRATTYP,
				  BUM.ATHARLTRFNAM,
				  BUM.ATHARLRATLINIDR,
				  BUM.ATHPRMTYP,
				  BUM.ATHLSTEVLDAT,
				  BUM.ATHGSCAMT,
				  BUM.ATHDISAMT,
				  BUM.ATHJNTREV,
				  BUM.ATHEVLTYP,
				  BUM.ATHSPTRATIDR,
				  BUM.ATHQTNREVNUM,
				  BUM.BKDORGCOD,
				  BUM.BKDDSTCOD,
				  BUM.BKDPCS,
				  BUM.BKDWGT,
				  BUM.BKDVOL,
				  BUM.BKDPRDCOD,
				  BUM.BKDPRDPTY,
				  BUM.BKDPRDTRAMOD,
				  BUM.BKDPRDSRVOD,
				  BUM.BKDSHPDES,
				  BUM.BKDCMDCOD,
				  BUM.BKDSCCCOD,
				  BUM.BKDAGTCOD,
				  BUM.BKDAGTNAM,
				  BUM.BKDSHPCOD,
				  BUM.BKDSHPLAVLSVNUM,
				--BUM.BKDSHPNAM,
				--BUM.BKDSHPPSTCOD,
				  BUM.BKDCNSCOD,
				  BUM.BKDCNSLAVLSVNUM,
				--BUM.BKDCNSNAM,
				--BUM.BKDCNSPSTCOD,
				  BUM.BKDSCICOD,
				  BUM.BKDNETCHG,
				  BUM.BKDVALCHG,
				  BUM.BKDPAYMOD,
				  BUM.BKDPAYTYP,
				  BUM.BKDARLRATTYP,
				  BUM.BKDARLTRFNAM,
				  BUM.BKDARLRATLINIDR,
				  BUM.BKDPRMTYP,
				  BUM.BKDLSTEVLDAT,
				  BUM.BKDGSCAMT,
				  BUM.BKDDISAMT,
				  BUM.BKDJNTREV,
				  BUM.BKDEVLTYP,
				  BUM.BKDSPTRATIDR,
				  BUM.BKDQTNREVNUM,
				  BUM.ATHRSNCOD,
				  BUM.ISSATHBKGSYN,
				  BUM.PCSINNSYN,
				  BUM.WGTINNSYN,
				  BUM.VOLINNSYN,
				  BUM.ORGINNSYN,
				  BUM.DSTINNSYN,
				  BUM.SCCINNSYN,
				  BUM.AGTCODINNSYN,
				  BUM.SHPCODINNSYN,
				  BUM.CNSCODINNSYN,
				  BUM.SHPLAVINNSYN,
				  BUM.CNSLAVINNSYN,
				--BUM.SHPNAMINNSYN,
				--BUM.CNSNAMINNSYN,
				--BUM.SHPPSTCODINNSYN,
				--BUM.CNSPSTCODINNSYN,
				  BUM.ISSBUMTRG,
				  BUM.BUMRSNCOD,
				  BUM.STLMAKFLT,
				  BUM.ACPPCSPAR,
				  BUM.RESEXTAPPPAR,
				  BUM.ORGDSTDIFPAR,
				  BUM.RESPFXPAR,
				  BUM.RESSCRPAR,
				  BUM.RTNCOD,
				  BUM.RTNTXT,
				  BUM.PRCORG,
				  BUM.PRCACTTYP,
				  BUM.PRCACTNAM,
				  BUM.PRCCMP
				FROM OPRSHPBUMDTL BUM
				LEFT OUTER JOIN SHRSYSPAR SYSPAR
				ON (SYSPAR.CMPCOD = BUM.CMPCOD
				AND SYSPAR.PARCOD = 'operations.shipment.acceptancefinalization.excludescc')
				WHERE BUM.CMPCOD  = ?
				AND BUM.MSTDOCNUM = ?
				AND BUM.DOCOWRIDR = ?
				AND BUM.DUPNUM    = ?
				AND BUM.SEQNUM    = ?				
	      ]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>406</QRY:Id>
		<QRY:Source Name="operations.shipment.findNoShowIrregularities" Type="NATIVE">
			<![CDATA[				
				 SELECT MST.CMPCOD,
							MST.DOCOWRIDR,
							MST.MSTDOCNUM,
							MST.UBRNUM,
							MST.DUPNUM,
							MST.SEQNUM,
							MST.ORGCOD,
							ARP.ACPDAT,
							ARP.APRFLG,
							MST.EXEFLG,
							MST.EXEDAT,
							BKG.SHPRDYTIM,
						 BKG.UBRNUM,
							FLTDTL.FLTCARCOD,
							FLTDTL.FLTNUM,
							FLTDTL.FLTDAT,
							FLTDTL.FLTSEQNUM,	
							CASE WHEN ((SYS_EXTRACT_UTC(BKG.SHPRDYTIM)) + ((select PARVAL FROM SHRSYSPAR WHERE CMPCOD= ? AND PARCOD='operations.shipment.tolerancetimeforlat')/1440)) < SYS_EXTRACT_UTC(SYSTIMESTAMP) 
						    THEN 'Y'
						    ELSE 'N'
						    END as CANACTBKG,						 
							CASE 	WHEN (NVL(ARP.APRFLG,'N') = 'N') THEN 'LAT-ACP'
							WHEN (ARP.APRFLG = 'Y') THEN 'LATMIS-DOC'
							END as LATMIS
						FROM OPRSHPMST MST ,
						OPRSHPDTL ARP , CAPBKGMST BKG,CAPBKGFLTDTL FLTDTL,
						SHRUSEARPPAR ARPPAR
						WHERE MST.CMPCOD    = ARP.CMPCOD(+)
						 AND MST.DUPNUM    = ARP.DUPNUM(+)
						 AND MST.SEQNUM    = ARP.SEQNUM(+)
						 AND MST.DOCOWRIDR = ARP.DOCOWRIDR(+)
						 AND MST.MSTDOCNUM = ARP.MSTDOCNUM(+)
						 AND MST.DUPNUM    = BKG.DUPNUM(+)
						 AND MST.SEQNUM    = BKG.SEQNUM(+)
						 AND MST.DOCOWRIDR = BKG.DOCOWRIDR(+)
						 AND MST.CMPCOD    = BKG.CMPCOD(+)
						 AND MST.MSTDOCNUM = BKG.MSTDOCNUM(+)
						 AND BKG.CMPCOD = FLTDTL.CMPCOD(+)
						 AND BKG.UBRNUM = FLTDTL.UBRNUM(+)
						 AND MST.UBRNUM IS NOT NULL          
						 AND ARPPAR.ARPCOD = MST.ORGCOD
						 AND ARPPAR.PARCOD ='shared.airport.physicalacceptanceperformed'
						 AND ARPPAR.PARVAL = 'Y'  
						 AND MST.CMPCOD = ?
						 AND MST.DOCOWRIDR = ?           
						 AND SYS_EXTRACT_UTC(BKG.SHPRDYTIM) < SYS_EXTRACT_UTC(SYSTIMESTAMP) 
						 AND SYS_EXTRACT_UTC(BKG.SHPRDYTIM) >= (SYS_EXTRACT_UTC(SYSTIMESTAMP)-(2/24))
						 AND (nvl(ARP.APRFLG,'N') = 'N'
						 OR (ARP.APRFLG = 'Y'
						 AND MST.EXEFLG ='N'))				
	]]>
		</QRY:Source>
	</QRY:Definition>
	
	
	<QRY:Definition>
		<QRY:Id>409</QRY:Id>
		<QRY:Source Name="operations.shipment.findshipmentdetailsforhandling" Type="NATIVE">
			<![CDATA[				
				 SELECT DISTINCT
			  ARPCOD,
			  CMPCOD,
			  DOCOWRIDR,
			  MSTDOCNUM,
			  DUPNUM,
			  SEQNUM,
			  MIN(CASE WHEN TXNCOD='DEP' THEN TXNDAT end) OVER (PARTITION BY ARPCOD) PREMIN,
			  MIN(CASE WHEN TXNCOD='RCF' THEN TXNDAT end) OVER (PARTITION BY ARPCOD) RCFMIN,
			  MAX(CASE WHEN TXNCOD='RCF' THEN TXNDAT end) OVER (PARTITION BY ARPCOD) RCFMAX,
			  NVL(SUM(CASE WHEN TXNCOD='DEP' THEN TXNWGT END) OVER (PARTITION BY ARPCOD),0) DEPWGT

			  
			FROM OPRSHPHIS HIS

			WHERE HIS.cmpcod = ?
			AND HIS.MSTDOCNUM = ?
			AND HIS.DOCOWRIDR = ?
			AND HIS.SEQNUM = ?
			AND HIS.DUPNUM = ?
			AND HIS.TXNCOD IN ('DEP','RCF')
			
	]]>
		</QRY:Source>
	</QRY:Definition>
	
	<QRY:Definition>
		<QRY:Id>410</QRY:Id>
		<QRY:Source Name="operations.shipment.findcreditnumber" Type="NATIVE">
			<![CDATA[				
			   SELECT (CASE WHEN (CUS.CTLLOCFLG ='Y') OR (CUS.CTLLOCFLG IS NULL)
			THEN CUS.SALCOD
			ELSE (SELECT CUSMST.SALCOD
			 FROM SHRCUSMST CUSMST
			 WHERE CUSMST.CMPCOD = CUS.CMPCOD
			 AND CUSMST.CUSCOD   =CUS.CTLCUSCOD
			 AND CUS.CUSCOD      = ?
			)
			END) AS CRDCOD
			FROM OPRSHPMST MST,
               SHRCUSMST CUS,
			   SHRCUSCRDMST CRD
			WHERE CRD.CUSCOD   = CUS.CUSCOD
			   AND CRD.CMPCOD = CUS.CMPCOD
			   AND CRD.CMPCOD = MST.CMPCOD
			   AND CRD.CUSCOD = MST.AGTCOD
			   AND CUS.CTLCUSCOD IN
			  (SELECT MAX(CUSCOD)FROM SHRCUSCRDTXN WHERE TXNREFONE = ?
			   )
			   AND CUS.CUSCOD    = ?
			   AND MST.MSTDOCNUM = ?
			
	]]>
		</QRY:Source>
	</QRY:Definition>
	
	
	<QRY:Definition>
		<QRY:Id>411</QRY:Id>
		<QRY:Source Name="operations.shipment.cto.findCTODeliveryDetailsforUld" Type="NATIVE">
			<![CDATA[				
			   SELECT SHP.DOCOWRIDR,
		  SHP.MSTDOCNUM,
		  SHP.DUPNUM,
		  SHP.SEQNUM ,
		  SHP.ULDNUM ,
		  MST.DOCNUM,
		  MST.CNSNAM CNSCOD,
		  MST.SHPPFX,
		  MST.CONFLG,
		  ARPMSTDST.CNTCOD,
		  (SELECT DORDLVFLG
		  FROM OPRARPSHP
		  WHERE CMPCOD = MST.CMPCOD
		  AND DOCOWRIDR = MST.DOCOWRIDR
		  AND MSTDOCNUM = MST.MSTDOCNUM
		  AND DUPNUM = MST.DUPNUM
		  AND SEQNUM = MST.SEQNUM
		  AND ARPCOD = ULD.ARPCOD
		  ) DORDLVFLG,
		  DLVNOT.DLVNOTNUM,
		  DLVNOT.DLVNOTSTA,
		  DLVNOT.DLVNOTPCS,
		  DLVNOT.DLVNOTWGT,
		  DLVNOT.DLVPCS DLVNOTDLVPCS,
		  DLVNOT.DLVWGT DLVNOTDLVWGT,
		  DLVNOT.DNTISSDAT,
		  DLVNOT.PAYADVNUM,
		  DLVNOT.PAYADVISSDAT,
		  DLVNOT.PAYADVEXPDAT,
		  DECODE (CSTMAP.CSTAUTCOD, NULL, 0,
		  CASE
			WHEN ARPMSTDST.CNTCOD ='DE'
			AND NVL(CSTMAP.CSTCNTCOD,'1234') = 'DE'
			AND SCICOD IN ('T1','TD','TF')
			THEN
			  (SELECT DECODE (COUNT (DISTINCT CST.CSTAUTCOD), LENGTH (CSTMAP.CSTAUTCOD) - LENGTH (REPLACE (CSTMAP.CSTAUTCOD, ',')) + 1, 1000, 100 )
			  FROM CSTARPSHP CST,
				CSTARPTXNMAP_VW
			  WHERE CST.CMPCOD = CSTMAP.CMPCOD
			  AND CST.ARPCOD = CSTMAP.ARPCOD
			  AND CST.DOCOWRIDR = MST.DOCOWRIDR
			  AND CST.MSTDOCNUM = MST.MSTDOCNUM
			  AND CST.DUPNUM = MST.DUPNUM
			  AND CST.SEQNUM = MST.SEQNUM
			  AND INSTR (CSTMAP.CSTAUTCOD, CST.CSTAUTCOD) > 0
			  AND CST.CSTSTA IN ('S','CC')
			  )
			WHEN NVL(ORGCTY.EURNONEURIND,'N') = 'N'
			AND NVL(DSTCTY.EURNONEURIND,'N') = 'E'
			THEN
			  (SELECT DECODE (COUNT (DISTINCT CST.CSTAUTCOD), LENGTH (CSTMAP.CSTAUTCOD) - LENGTH (REPLACE (CSTMAP.CSTAUTCOD, ',')) + 1, 1000, 100 )
			  FROM CSTARPSHP CST,
				CSTARPTXNMAP_VW
			  WHERE CST.CMPCOD = CSTMAP.CMPCOD
			  AND CST.ARPCOD = CSTMAP.ARPCOD
			  AND CST.DOCOWRIDR = MST.DOCOWRIDR
			  AND CST.MSTDOCNUM = MST.MSTDOCNUM
			  AND CST.DUPNUM = MST.DUPNUM
			  AND CST.SEQNUM = MST.SEQNUM
			  AND INSTR (CSTMAP.CSTAUTCOD, CST.CSTAUTCOD) > 0
			  AND CST.CSTSTA IN ('S','CC')
			  )
			WHEN ARPMSTORG.CNTCOD <> ARPMSTDST.CNTCOD
			AND ARPMSTDST.CNTCOD <> 'DE'
			AND NVL(DSTCTY.EURNONEURIND,'N') = 'N'
			THEN
			  (SELECT DECODE (COUNT (DISTINCT CST.CSTAUTCOD), LENGTH (CSTMAP.CSTAUTCOD) - LENGTH (REPLACE (CSTMAP.CSTAUTCOD, ',')) + 1, 1000, 100 )
			  FROM CSTARPSHP CST
			  WHERE CST.CMPCOD = CSTMAP.CMPCOD
			  AND CST.ARPCOD = CSTMAP.ARPCOD
			  AND CST.DOCOWRIDR = MST.DOCOWRIDR
			  AND CST.MSTDOCNUM = MST.MSTDOCNUM
			  AND CST.DUPNUM = MST.DUPNUM
			  AND CST.SEQNUM = MST.SEQNUM
			  AND INSTR (CSTMAP.CSTAUTCOD, CST.CSTAUTCOD) > 0
			  AND CST.CSTSTA IN ('S','CC')
			  )
		  END ) CSTSTA,
		  MIS.SCICOD
		FROM OPRULDSHP ULD
		INNER JOIN OPRULDSHP SHP
		ON ULD.CMPCOD = SHP.CMPCOD
		AND ULD.ULDNUM = SHP.ULDNUM
		
		INNER JOIN OPRSHPMST MST
		ON SHP.CMPCOD = MST.CMPCOD
		AND SHP.DOCOWRIDR = MST.DOCOWRIDR
		AND SHP.MSTDOCNUM = MST.MSTDOCNUM
		AND SHP.DUPNUM = MST.DUPNUM
		AND SHP.SEQNUM = MST.SEQNUM
		
		LEFT OUTER JOIN OPRSHPDLVNOT DLVNOT
		ON SHP.CMPCOD = DLVNOT.CMPCOD
		AND SHP.DOCOWRIDR = DLVNOT.DOCOWRIDR
		AND SHP.MSTDOCNUM = DLVNOT.MSTDOCNUM
		AND SHP.DUPNUM = DLVNOT.DUPNUM
		AND SHP.SEQNUM = DLVNOT.SEQNUM
		AND SHP.ULDNUM = NVL(DLVNOT.ULDNUM,'BULK')
		AND DLVNOT.DLVNOTSTA <> 'C'
		
		LEFT OUTER JOIN OPRSHPMSTMIS MIS
		ON SHP.DOCOWRIDR = MIS.DOCOWRIDR
		AND SHP.MSTDOCNUM = MIS.MSTDOCNUM
		AND SHP.DUPNUM = MIS.DUPNUM
		AND SHP.SEQNUM = MIS.SEQNUM
		AND SHP.CMPCOD = MIS.CMPCOD
		
		LEFT OUTER JOIN SHRARPMST ARPMSTORG
		ON MST.CMPCOD = ARPMSTORG.CMPCOD
		AND MST.ORGCOD = ARPMSTORG.ARPCOD
		
		LEFT OUTER JOIN SHRCTYMST ORGCTY
		ON ARPMSTORG.CMPCOD = ORGCTY.CMPCOD
		AND ARPMSTORG.CTYCOD = ORGCTY.CTYCOD
		
		LEFT OUTER JOIN SHRARPMST ARPMSTDST
		ON MST.CMPCOD = ARPMSTDST.CMPCOD
		AND MST.DSTCOD = ARPMSTDST.ARPCOD
		
		LEFT OUTER JOIN SHRCTYMST DSTCTY
		ON ARPMSTDST.CMPCOD = DSTCTY.CMPCOD
		AND ARPMSTDST.CTYCOD = DSTCTY.CTYCOD
		
		LEFT OUTER JOIN CSTARPTXNMAP_VW CSTMAP
		ON MST.CMPCOD = CSTMAP.CMPCOD
		AND MST.DSTCOD = CSTMAP.ARPCOD
		AND MST.DOCOWRIDR = CSTMAP.ARLIDR
		
		WHERE ULD.CMPCOD = ?
		AND ULD.ARPCOD = ?
		AND ULD.ULDNUM = ?
			
	]]>
		</QRY:Source>
	</QRY:Definition>
	
		   
<QRY:Definition>
		<QRY:Id>412</QRY:Id>
		<QRY:Source Name="operations.shipment.findshipmentdetailsforexportpayment" Type="NATIVE">
			<![CDATA[				
			   SELECT MST.CMPCOD, 
MST.DOCOWRIDR, 
MST.MSTDOCNUM, 
MST.SHPPFX,
MST.DOCNUM, 
MST.DUPNUM, 
MST.SEQNUM, 
MST.ORGCOD, 
MST.DSTCOD, 
MST.CURCOD, 
MST.AGTCOD, 
MST.SHPCOD, 
MST.OWRCOD, 
MST.CNSCOD, 
MST.CNSNAM MSTCNSNAM, 
MST.PRDCOD, 
MST.PRDNAM, 
MST.PAYTYP MSTPAYTYP, 
MST.CHGCOD, 
MST.SHPSTA, 
MST.EXEDAT, 
MST.EXESTN, 
MST.EXEFLG, 
MST.STDPCS, 
MST.STDWGT, 
MST.GRSVOL, 
MST.SCCCOD, 
MST.DOMFLG, 
MST.DTACPTSRC,
MST.RATCUSCOD,
MSTAWB.ORGCOD MAWBORGCOD, 
MSTAWB.DSTCOD MAWBDSTCOD, 
ARP.MFTPCS, 
ARP.MFTWGT, 
ARP.AVLPCS, 
ARP.AVLWGT, 
ARP.MFTVOL, 
ARP.AVLVOL, 
DTL.TOTACPPCS, 
DTL.TOTACPWGT, 
DTL.TOTDLVPCS, 
DTL.EXEPAYADVNUM,
DTL.CHGCLDFLG, 
DTL.CTOCHGCOLFLG, 
CHG.CHGHEDIDR, 
CHG.CHGHED, 
CHG.CHDCOD, 
CHG.CHGAMT, 
CHG.PAYTYP, 
CHG.DUECARFLG, 
CHG.DUEAGTFLG, 
RAT.RATLINSERNUM , 
RAT.CMDITMNAM, 
RAT.SCCCOD RATSCCCODE, 
RAT.TAX RATTAX, 
RAT.CHGWGT, 
RAT.GRSWGT, 
RAT.IATCHG RATIATACHG, 
RAT.NETCHG, 
ACC.TOTCCF, 
(CASE WHEN MST.PAYTYP='CC' then ACC.WGTCCCHG + ACC.VALCCCHG 
ELSE ACC.WGTPPCHG + ACC.VALPPCHG 
END)TOTCHG, 
ACC.VALCCCHG, 
ACC.VALPPCHG, 
ACC.UNQREFONE, 
MIS.SCICOD, 
ARP.DCSREQFLG, 
MST.SHPNAM, 
CUS.CUSCOD, 
CUS.CUSNAM, 
AGT.OWNFLG, 
SEGSHP.FLTCARIDR, 
SEGSHP.FLTNUM, 
SEGSHP.FLTSEQNUM, 
ADLCNT.CNTTYP, 
ADLCNT.CTTCUSCOD, 
ADLCNT.CTTCUSNAM , 
MST.CONFLG, 
ADLCNT.CTTCUSCOD,ADLCNT.CTTCUSNAM, 
DGR.UNIIDR, 
DGR.RDOACTFLG, 
MST.SRCIND, 
(SELECT MIN(TXNDAT) DAT 
FROM OPRSHPHIS HIS 
WHERE HIS.CMPCOD = MST.CMPCOD 
AND HIS.MSTDOCNUM = MST.MSTDOCNUM 
AND HIS.DOCOWRIDR = MST.DOCOWRIDR 
AND HIS.DUPNUM = MST.DUPNUM 
 AND HIS.ARPCOD    = MST.ORGCOD
AND (HIS.TXNCOD ='RCS' OR 
HIS.TXNCOD = 'FOH') 
) ACPSTRTIM, 

 (SELECT MAX(FLTLEG.STD) 
FROM OPRSEGSHP SEGSHP, 
OPRFLTSEG FLTSEG, 
FLTOPRLEG FLTLEG 
WHERE FLTLEG.CMPCOD = FLTSEG.CMPCOD 
AND FLTLEG.FLTCARIDR = FLTSEG.FLTCARIDR 
AND FLTLEG.FLTNUM = FLTSEG.FLTNUM 
AND FLTLEG.FLTSEQNUM = FLTSEG.FLTSEQNUM 
AND FLTLEG.LEGORG = ARP.ARPCOD

AND FLTSEG.CMPCOD = SEGSHP.CMPCOD 
AND FLTSEG.FLTCARIDR = SEGSHP.FLTCARIDR 
AND FLTSEG.FLTNUM = SEGSHP.FLTNUM 
AND FLTSEG.FLTSEQNUM = SEGSHP.FLTSEQNUM 
AND FLTSEG.SEGSERNUM = SEGSHP.SEGSERNUM 

AND SEGSHP.CMPCOD = MST.CMPCOD 
AND SEGSHP.DOCOWRIDR = MST.DOCOWRIDR 
AND SEGSHP.MSTDOCNUM = MST.MSTDOCNUM 
AND SEGSHP.SEQNUM = MST.SEQNUM 
AND SEGSHP.DUPNUM = MST.DUPNUM 

) DEPDAT ,
MST.ORGCOD AS ARPCOD ,
MSTMIS.SHPBNDFLG,
ACC.JRNDAT,
ACPSHPDTL.ACPIDR,
  ACPSHPDTL.SCCCOD SHPSCC,
  ACPSHPDTL.ACPWGT,
  ACPSHPDTL.ACPPCS,
  ACPSHPDTL.ACPWGTCOD
   
FROM OPRSHPMST MST, 
OPRSHPDTL DTL, 
OPRARPSHP ARP, 
OPRSHPCHGDTL CHG, 
OPRSHPRATDTL RAT, 
OPRSHPMSTACC ACC, 
OPRSHPMSTMIS MIS, 
OPRSHPADLCNT ADLCNT, 
OPRSEGSHP SEGSHP, 
SHRAGTMST AGT, 
SHRCUSMST CUS, 
OPRSHPMST MSTAWB, 
OPRSHPDGR DGR ,
OPRSHPMSTMIS MSTMIS,
OPRSHPACPDTL  ACPSHPDTL  
WHERE MST.CMPCOD = ARP.CMPCOD(+) 
AND MST.MSTDOCNUM = ARP.MSTDOCNUM(+) 
AND MST.DOCOWRIDR = ARP.DOCOWRIDR(+) 
AND MST.SEQNUM = ARP.SEQNUM(+) 
AND MST.DUPNUM = ARP.DUPNUM(+) 
AND MST.ORGCOD = ARP.ARPCOD(+)

AND MST.CMPCOD = DTL.CMPCOD(+) 
AND MST.MSTDOCNUM = DTL.MSTDOCNUM(+) 
AND MST.DOCOWRIDR = DTL.DOCOWRIDR(+) 
AND MST.SEQNUM = DTL.SEQNUM(+) 
AND MST.DUPNUM = DTL.DUPNUM(+) 

AND MST.CMPCOD = ACC.CMPCOD 
AND MST.MSTDOCNUM = ACC.MSTDOCNUM 
AND MST.DOCOWRIDR = ACC.DOCOWRIDR 
AND MST.SEQNUM = ACC.SEQNUM 
AND MST.DUPNUM = ACC.DUPNUM 

AND MST.MSTDOCNUM = CHG.MSTDOCNUM(+) 
AND MST.DOCOWRIDR = CHG.DOCOWRIDR(+) 
AND MST.SEQNUM = CHG.SEQNUM(+) 
AND MST.DUPNUM = CHG.DUPNUM(+) 
AND MST.CMPCOD = CHG.CMPCOD(+) 

AND MST.CMPCOD = RAT.CMPCOD(+) 
AND MST.MSTDOCNUM = RAT.MSTDOCNUM(+) 
AND MST.DOCOWRIDR = RAT.DOCOWRIDR(+) 
AND MST.SEQNUM = RAT.SEQNUM(+) 
AND MST.DUPNUM = RAT.DUPNUM(+) 

AND MST.CMPCOD = MIS.CMPCOD(+) 
AND MST.MSTDOCNUM = MIS.MSTDOCNUM(+) 
AND MST.DOCOWRIDR = MIS.DOCOWRIDR(+) 
AND MST.SEQNUM = MIS.SEQNUM(+) 
AND MST.DUPNUM = MIS.DUPNUM(+) 

AND MST.CMPCOD = ADLCNT.CMPCOD(+) 
AND MST.MSTDOCNUM = ADLCNT.MSTDOCNUM(+) 
AND MST.DOCOWRIDR = ADLCNT.DOCOWRIDR(+) 
AND MST.SEQNUM = ADLCNT.SEQNUM(+) 
AND MST.DUPNUM = ADLCNT.DUPNUM(+) 

AND MST.MSTDOCNUM = SEGSHP.MSTDOCNUM (+) 
AND MST.DOCOWRIDR = SEGSHP.DOCOWRIDR (+) 
AND MST.SEQNUM = SEGSHP.SEQNUM (+) 
AND MST.DUPNUM = SEGSHP.DUPNUM (+) 
AND MST.CMPCOD = SEGSHP.CMPCOD (+) 

AND MST.CMPCOD = AGT.CMPCOD(+) 
AND MST.AGTCOD = AGT.AGTCOD(+) 

AND AGT.CMPCOD = CUS.CMPCOD(+) 
AND AGT.CUSCOD = CUS.CUSCOD(+) 

AND MSTAWB.CMPCOD = MST.CMPCOD 
AND MSTAWB.MSTDOCNUM = MST.MSTDOCNUM 
AND MSTAWB.DOCOWRIDR = MST.DOCOWRIDR 
AND MSTAWB.SEQNUM = 1 
AND MSTAWB.DUPNUM = MST.DUPNUM 

AND MST.CMPCOD = DGR.CMPCOD(+) 
AND MST.MSTDOCNUM = DGR.MSTDOCNUM(+) 
AND MST.DOCOWRIDR = DGR.DOCOWRIDR(+) 
AND MST.SEQNUM = DGR.SEQNUM(+) 
AND MST.DUPNUM = DGR.DUPNUM(+) 
AND MSTAWB.CMPCOD       = MSTMIS.CMPCOD(+)
AND MSTAWB.MSTDOCNUM    = MSTMIS.MSTDOCNUM(+)
AND MSTAWB.DOCOWRIDR    = MSTMIS.DOCOWRIDR(+)
AND MSTAWB.SEQNUM       = MSTMIS.SEQNUM(+)
AND MSTAWB.DUPNUM       = MSTMIS.DUPNUM(+)


AND MST.CMPCOD  = ACPSHPDTL.CMPCOD(+)
AND MST.MSTDOCNUM = ACPSHPDTL.MSTDOCNUM(+)
AND MST.DOCOWRIDR = ACPSHPDTL.DOCOWRIDR(+)
AND MST.SEQNUM    = ACPSHPDTL.SEQNUM(+)
AND MST.DUPNUM    = ACPSHPDTL.DUPNUM(+)


AND 
			
	]]>
		</QRY:Source>
	</QRY:Definition>
	
	<QRY:Definition>
		<QRY:Id>413</QRY:Id>
		<QRY:Source Name="operations.shipment.findDeliveryStatusDetails" Type="NATIVE">
			<![CDATA[				
     SELECT cmpcod,
        arpcod,
        whscod,
        shppfx,
        DUPNUM,
        MSTDOCNUM,
        DOCOWRIDR,
        SEQNUM,
        Status,
        refnum,
        DLVDAT,
        ULD,
        HAWB,
        cnsnam,
        txntim,
        TIM,
        cnscod,
        orgcod,
        elapsedmin
      FROM
        (SELECT DISTINCT cmpcod,
          arpcod,
          whscod,
          shppfx,
          DLVDAT,
          DUPNUM,
          MSTDOCNUM,
          DOCOWRIDR,
          SEQNUM,
          DECODE(Priority,'1','DELIVERED','2','VERIFICATION IN PROGRESS','3','RELOCATION IN PROGRESS','4','INITIATED') Status,
          refnum,
          (SELECT DISTINCT listagg(pcklst.stucod, ',') within GROUP (
          ORDER BY pcklst.cmpcod,pcklst.arpcod,pcklst.whscod,pcklst.refnum)over(partition BY pcklst.cmpcod,pcklst.arpcod,pcklst.whscod,pcklst.refnum)
          FROM WHSSHPPCKLST pcklst ,
            WHSSTUMST stu
          WHERE pcklst.cmpcod=a.cmpcod
          AND pcklst.arpcod  =a.arpcod
          AND pcklst.whscod  =a.whscod
          AND pcklst.refnum  =a.refnum
         AND pcklst.mstdocnum =a.mstdocnum
         AND pcklst.dupnum    =a.dupnum
         AND pcklst.seqnum    =a.seqnum
          AND pcklst.DOCOWRIDR =a.DOCOWRIDR
          AND pcklst.cmpcod  =stu.cmpcod
          AND pcklst.arpcod  =stu.arpcod
          AND pcklst.whscod  =stu.whscod
          AND pcklst.stucod  =STU.stucod
          AND STU.STUTYPNAM  ='ULD'
          ) ULD,
          (SELECT DISTINCT listagg(shpmst.docnum, ',') within GROUP (
          ORDER BY shpmst.cmpcod,shpmst.docowridr,shpmst.mstdocnum,shpmst.dupnum)over(partition BY shpmst.cmpcod,shpmst.docowridr,shpmst.mstdocnum,shpmst.dupnum)
          FROM OPRSHPMST shpmst,
            OPRSHPDLVNOT dlvnot
          WHERE shpmst.cmpcod  =a.cmpcod
          AND shpmst.docowridr =a.docowridr
          AND shpmst.mstdocnum =a.mstdocnum
          AND shpmst.dupnum    =a.dupnum
          AND shpmst.cmpcod    =dlvnot.cmpcod
          AND shpmst.docowridr =dlvnot.docowridr
          AND shpmst.mstdocnum =dlvnot.mstdocnum
          AND shpmst.dupnum    =dlvnot.dupnum
          AND shpmst.seqnum    =dlvnot.seqnum
          AND shpmst.mstdocnum<>shpmst.docnum
          AND TRUNC(DNTISSDAT) = TRUNC(a.txntim)
          )HAWB,
          cnsnam,
          cnscod,
          orgcod,
          TO_CHAR(txntim,'hh24:mi') TIM,
          txntim,
          ROUND(to_number(sysdate-txntim)*24*60) elapsedmin
        FROM
          (SELECT cmpcod,
            arpcod,
            whscod,
            shppfx,
            DUPNUM,
            MSTDOCNUM,
            DOCOWRIDR,
            SEQNUM,
            priority,
            refnum,
            DLVDAT,
            txntim,
            cnsnam,
            cnscod,
            orgcod,
            MIN(Priority) over(partition BY a.cmpcod,a.arpcod,a.whscod,a.docowridr,a.mstdocnum,a.dupnum,a.seqnum order by a.cmpcod,a.arpcod,a.whscod,a.docowridr,a.mstdocnum,a.dupnum,a.seqnum) minpriority
          FROM
            (SELECT lstmst.cmpcod,
              lstmst.arpcod,
              lstmst.whscod,
              lstmst.refnum,
              lst.shppfx,
              lst.ACTPCS,
              lst.ACTWGT,
              lst.AVLPCS,
              lst.AVLWGT,
              lst.DUPNUM,
              lst.LOCCOD,
              lst.MSTDOCNUM,
              lst.DOCOWRIDR,
              lst.SEQNUM,
              prc.msgtyp,
              prc.msgidr,
              prc.seqnum prcseqnum,
              prc.wrkflonam,
              ROUND(to_number(TO_DATE(?, 'DD/MM/YYYY HH24:MI:SS')-DLVDAT)*24*60*60) DLVDAT,
              prc.insidr,
              CASE
                WHEN dlv.mstdocnum IS NOT NULL
                THEN '1'
                ELSE
                  CASE
                    WHEN prc.msgtyp ='DLVRLCMSG'
                    AND prc.msgsta  ='ACD'
                    THEN '3'
                    ELSE '4'
                  END
              END Priority,
              lstmst.txntim,
              shpmst.cnsnam,
              shpmst.cnscod,
              shpmst.orgcod
            FROM WHSPCKLSTMST lstmst
            INNER JOIN WHSSHPPCKLST lst
            ON lstmst.refnum  = lst.refnum
            AND lstmst.whscod = lst.whscod
            AND LSTMST.ARPCOD = LST.ARPCOD
            AND lstmst.cmpcod = lst.cmpcod
            INNER JOIN OPRSHPMST shpmst
            ON shpmst.docowridr  = lst.docowridr
            AND shpmst.mstdocnum = lst.mstdocnum
            AND shpmst.dupnum    = LST.dupnum
            AND shpmst.seqnum    = lst.seqnum
            AND shpmst.cmpcod    =lst.cmpcod
            INNER JOIN WRKFLOMSGPRCPAR arp
            ON lst.cmpcod     = arp.cmpcod
            AND lst.arpcod    = arp.parval
            AND arp.parcod    = 'ARPCOD'
            AND arp.wrkflonam = 'DLVRLC'
            INNER JOIN WRKFLOMSGPRCPAR whs
            ON lst.cmpcod     = whs.cmpcod
            AND lst.whscod    = whs.parval
            AND whs.parcod    = 'WHSCOD'
            AND whs.wrkflonam = 'DLVRLC'
            INNER JOIN WRKFLOMSGPRCPAR pck
            ON lst.cmpcod     = pck.cmpcod
            AND lst.REFnum    = pck.parval
            AND pck.parcod    = 'PCKLSTIDR'
            AND pck.wrkflonam = 'DLVRLC'
            INNER JOIN WRKFLOMSGPRCPAR stu
            ON lst.cmpcod     = stu.cmpcod
            AND lst.stucod    = stu.parval
            AND stu.parcod    = 'STU'
            AND stu.wrkflonam = 'DLVRLC'
            INNER JOIN WRKFLOMSGPRC prc
            ON arp.cmpcod     = prc.cmpcod
            AND arp.wrkflonam = prc.wrkflonam
            AND arp.seqnum    = prc.seqnum
            AND arp.MSGTYP    = prc.MSGTYP
            AND arp.MSGIDR    = prc.MSGIDR
            AND arp.INSIDR    = prc.INSIDR
            AND whs.cmpcod    = prc.cmpcod
            AND whs.wrkflonam = prc.wrkflonam
            AND whs.seqnum    = prc.seqnum
            AND whs.MSGTYP    = prc.MSGTYP
            AND whs.MSGIDR    = prc.MSGIDR
            AND whs.INSIDR    = prc.INSIDR
            AND pck.cmpcod    = prc.cmpcod
            AND pck.wrkflonam = prc.wrkflonam
            AND pck.seqnum    = prc.seqnum
            AND pck.MSGTYP    = prc.MSGTYP
            AND pck.MSGIDR    = prc.MSGIDR
            AND pck.INSIDR    = prc.INSIDR
            AND stu.cmpcod    = prc.cmpcod
            AND stu.wrkflonam = prc.wrkflonam
            AND stu.seqnum    = prc.seqnum
            AND stu.MSGTYP    = prc.MSGTYP
            AND stu.MSGIDR    = prc.MSGIDR
            AND stu.INSIDR    = prc.INSIDR
            LEFT OUTER JOIN OPRSHPDLVDTL DLV
            ON lst.docowridr  =dlv.docowridr
            AND lst.mstdocnum =dlv.mstdocnum
            AND lst.dupnum    =dlv.dupnum
            AND lst.seqnum    =dlv.seqnum
            UNION ALL
            SELECT lstmst.cmpcod,
              lstmst.arpcod,
              lstmst.whscod,
              lstmst.refnum,
              lst.shppfx,
              lst.ACTPCS,
              lst.ACTWGT,
              lst.AVLPCS,
              lst.AVLWGT,
              lst.DUPNUM,
              lst.LOCCOD,
              lst.MSTDOCNUM,
              lst.DOCOWRIDR,
              lst.SEQNUM,
              prc.msgtyp,
              prc.msgidr,
              prc.seqnum prcseqnum,
              prc.wrkflonam,
              ROUND(to_number(TO_DATE(?, 'DD/MM/YYYY HH24:MI:SS')-DLVDAT)*24*60*60) DLVDAT,
              prc.insidr,
              CASE
                WHEN dlv.mstdocnum IS NOT NULL
                THEN '1'
                ELSE
                  CASE
                    WHEN prc.msgtyp ='DLVVRFMSG'
                    THEN '2'
                  END
              END Priority,
              lstmst.txntim,
              shpmst.cnsnam,
              shpmst.cnscod,
              shpmst.orgcod
            FROM WHSPCKLSTMST lstmst
            INNER JOIN WHSSHPPCKLST lst
            ON lstmst.refnum  = lst.refnum
            AND lstmst.whscod = lst.whscod
            AND LSTMST.ARPCOD = LST.ARPCOD
            AND lstmst.cmpcod = lst.cmpcod
            INNER JOIN OPRSHPMST shpmst
            ON shpmst.docowridr  = lst.docowridr
            AND shpmst.mstdocnum = lst.mstdocnum
            AND shpmst.dupnum    = LST.dupnum
            AND shpmst.seqnum    = lst.seqnum
            AND shpmst.cmpcod    =lst.cmpcod
            INNER JOIN WRKFLOMSGPRCPAR arp
            ON lst.cmpcod     = arp.cmpcod
            AND lst.arpcod    = arp.parval
            AND arp.parcod    = 'ARPCOD'
            AND arp.wrkflonam = 'DLVRLC'
            INNER JOIN WRKFLOMSGPRCPAR whs
            ON lst.cmpcod     = whs.cmpcod
            AND lst.whscod    = whs.parval
            AND whs.parcod    = 'WHSCOD'
            AND whs.wrkflonam = 'DLVRLC'
            INNER JOIN WRKFLOMSGPRCPAR doc
            ON lst.cmpcod     = doc.cmpcod
            AND lst.DOCOWRIDR = doc.parval
            AND doc.parcod    = 'DOCOWRIDR'
            AND doc.wrkflonam = 'DLVRLC'
            INNER JOIN WRKFLOMSGPRCPAR awb
            ON lst.cmpcod     = awb.cmpcod
            AND lst.MSTDOCNUM = awb.parval
            AND awb.parcod    = 'MSTDOCNUM'
            AND awb.wrkflonam = 'DLVRLC'
            INNER JOIN WRKFLOMSGPRCPAR dup
            ON lst.cmpcod     = dup.cmpcod
            AND lst.DUPNUM    = dup.parval
            AND dup.parcod    = 'DUPNUM'
            AND dup.wrkflonam = 'DLVRLC'
            INNER JOIN WRKFLOMSGPRCPAR seq
            ON lst.cmpcod     = seq.cmpcod
            AND lst.SEQNUM    = seq.parval
            AND seq.parcod    = 'SEQNUM'
            AND seq.wrkflonam = 'DLVRLC'
            INNER JOIN WRKFLOMSGPRC prc
            ON arp.cmpcod     = prc.cmpcod
            AND arp.wrkflonam = prc.wrkflonam
            AND arp.seqnum    = prc.seqnum
            AND arp.MSGTYP    = prc.MSGTYP
            AND arp.MSGIDR    = prc.MSGIDR
            AND arp.INSIDR    = prc.INSIDR
            AND whs.cmpcod    = prc.cmpcod
            AND whs.wrkflonam = prc.wrkflonam
            AND whs.seqnum    = prc.seqnum
            AND whs.MSGTYP    = prc.MSGTYP
            AND whs.MSGIDR    = prc.MSGIDR
            AND whs.INSIDR    = prc.INSIDR
            AND doc.cmpcod    = prc.cmpcod
            AND doc.wrkflonam = prc.wrkflonam
            AND doc.seqnum    = prc.seqnum
            AND doc.MSGTYP    = prc.MSGTYP
            AND doc.MSGIDR    = prc.MSGIDR
            AND doc.INSIDR    = prc.INSIDR
            AND awb.cmpcod    = prc.cmpcod
            AND awb.wrkflonam = prc.wrkflonam
            AND awb.seqnum    = prc.seqnum
            AND awb.MSGTYP    = prc.MSGTYP
            AND awb.MSGIDR    = prc.MSGIDR
            AND awb.INSIDR    = prc.INSIDR
            AND dup.cmpcod    = prc.cmpcod
            AND dup.wrkflonam = prc.wrkflonam
            AND dup.seqnum    = prc.seqnum
            AND dup.MSGTYP    = prc.MSGTYP
            AND dup.MSGIDR    = prc.MSGIDR
            AND dup.INSIDR    = prc.INSIDR
            AND seq.cmpcod    = prc.cmpcod
            AND seq.wrkflonam = prc.wrkflonam
            AND seq.seqnum    = prc.seqnum
            AND seq.MSGTYP    = prc.MSGTYP
            AND seq.MSGIDR    = prc.MSGIDR
            AND seq.INSIDR    = prc.INSIDR
            LEFT OUTER JOIN OPRSHPDLVDTL DLV
            ON lst.docowridr  =dlv.docowridr
            AND lst.mstdocnum =dlv.mstdocnum
            AND lst.dupnum    =dlv.dupnum
            AND lst.seqnum    =dlv.seqnum
            ) a
          ) a
        WHERE a.priority = a.minpriority
        )
WHERE 1=
        CASE
          WHEN status='DELIVERED'
          AND DLVDAT<= 30
          THEN '1'
          WHEN status<>'DELIVERED'
          THEN '1'
        END
       
	]]>
		</QRY:Source>
	</QRY:Definition>

<QRY:Definition>
		<QRY:Id>414</QRY:Id>
		<QRY:Source Name="operations.shipment.firstFlightDate" Type="NATIVE">
		<![CDATA[	
			SELECT Z.FLTNUM
			  ||'~'
			  || Z.FLTDAT
			  ||'~'
			  || Z.FLTOPRSTA FLTDTLMFT
			FROM
			  (SELECT FLT.FLTCARCOD
				|| '-'
				|| FLT.FLTNUM FLTNUM,
				TO_CHAR( FLT.FLTDAT , 'DD-MON-YYYY' ) FLTDAT,
				FLT.FLTOPRSTA,
				ROW_NUMBER() OVER (PARTITION BY FLT.ARPCOD ORDER BY FLT.FLTDAT) ROWCNT
			  FROM OPRSEGSHP SEGSHP,
				OPRARPEXPFLT FLT
			  WHERE SEGSHP.CMPCOD  = FLT.CMPCOD
			  AND SEGSHP.FLTNUM    = FLT.FLTNUM
			  AND SEGSHP.FLTSEQNUM = FLT.FLTSEQNUM
			  AND SEGSHP.FLTCARIDR = FLT.FLTCARIDR
			  AND SEGSHP.CMPCOD    = ?
			  AND SEGSHP.DOCOWRIDR = ?
			  AND SEGSHP.MSTDOCNUM = ?
			  AND SEGSHP.DUPNUM    = ?
			  AND SEGSHP.SEQNUM    = ?
			  AND FLT.ARPCOD       = ?
			  AND SEGSHP.MFTPCS    > 0
			  )Z
			WHERE Z.ROWCNT = 1
	]]>
		</QRY:Source>
	</QRY:Definition>

<QRY:Definition>
<QRY:Id>329</QRY:Id>
<QRY:Source Name="operations.shipment.fetchshipmentsforgroupexecutionforgroupid" Type="NATIVE">
<![CDATA[		
                SELECT SHP.MSTDOCNUM,SHP.DUPNUM,SHP.CMPCOD,GRP.GRPIDR ,SHP.SEQNUM,SHP.DOCOWRIDR,
				GRP.ARPCOD,GRP.CMPCOD,GRP.GRPIDR,GRP.INVREFNUM,GRP.GENDAT,GRP.GRPSTA,GRP.CUSCOD,GRP.CUSNAM,GRP.CUSIDRTYP,
				GRP.CUSIDRDTL,GRP.CUSTAXOFF,GRP.CUSTAXREGNUM,GRP.LSTUPDUSR,PAYADV.PAYADVNUM,MST.SHPSTA,MST.VODFLG,MST.AGTCOD,
				MST.AGTNAM,MST.CNSNAM,MST.SHPNAM,MST.CNSNAM,MST.STDPCS,MST.STDWGT,MST.STDWGTCOD,MST.ORGCOD,MST.DSTCOD,MST.SHPPFX,
				MST.conflg,MST.HSEFINFLG,SRV.SRVCOD,SRV.SRVNAM,CHD.CHDCOD,CHD.CHDNAM,CHD.CURCOD,CHD.CHDAMT,	CHD.GSTAMT,CHD.CHDNETAMT,MST.DOMFLG,CHD.PAYTYP,PAYADV.CASDRWIDR   ,
(CASE WHEN AGT.OWNFLG='Y' then MST.SHPCOD
				ELSE AGT.CUSCOD 
				END)CUSCODSHP
				from 
				CSHPAYADV PAYADV,
				OPRGRPEXESHP SHP,
				OPRSHPMST MST,
				OPRGRPEXE GRP,
				CSHPAYADVSRV SRV,
				CSHSRVCHD CHD	,
SHRAGTMST AGT
				WHERE GRP.CMPCOD  = SHP.CMPCOD 
				AND GRP.ARPCOD =SHP.ARPCOD
				AND GRP.GRPIDR =SHP.GRPIDR	
			    AND SHP.CMPCOD =PAYADV.CMPCOD(+)
                AND SHP.MSTDOCNUM =PAYADV.MSTDOCNUM(+)	
                AND SHP.DOCOWRIDR =PAYADV.DOCOWRIDR(+)
			    AND SHP.DUPNUM =PAYADV.DUPNUM(+)	
				AND SHP.SEQNUM =PAYADV.SEQNUM(+)
				AND PAYADV.CMPCOD=SRV.CMPCOD(+)
				AND PAYADV.STNCOD=SRV.STNCOD(+)
				AND PAYADV.IMPEXPFLG(+) = 'E' 
				AND PAYADV.PAYADVNUM=SRV.PAYADVNUM(+)
				AND SRV.CMPCOD=CHD.CMPCOD(+)
				AND SRV.STNCOD=CHD.STNCOD(+)
				AND SRV.PAYADVNUM=CHD.PAYADVNUM(+)
				AND SRV.SRVCOD=CHD.SRVCOD(+)
                AND MST.CMPCOD=SHP.CMPCOD
				AND MST.MSTDOCNUM=SHP.MSTDOCNUM
				AND MST.DOCOWRIDR=SHP.DOCOWRIDR
				AND MST.DUPNUM=SHP.DUPNUM
				AND MST.SEQNUM=SHP.SEQNUM	
                AND MST.AGTCOD=AGT.AGTCOD
				AND MST.CMPCOD=AGT.CMPCOD 	
                AND GRP.GRPSTA  <> 'X'				
				AND GRP.GRPIDR = ?
				AND GRP.CMPCOD = ?
				]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>332</QRY:Id>
<QRY:Source Name="operations.shipment.fetchshipmentsforgroupexecution" Type="NATIVE">
<![CDATA[		
                SELECT MST.MSTDOCNUM,MST.DUPNUM,MST.CMPCOD,MST.SEQNUM,MST.DOCOWRIDR,MST.SHPPFX,
				MST.ORGCOD,MST.CMPCOD,PAYADV.PAYADVNUM,MST.SHPSTA,MST.DSTCOD,MST.AGTCOD,MST.AGTNAM,MST.SHPNAM,
				MST.CNSNAM,MST.STDPCS,MST.STDWGT,MST.STDWGTCOD,SRV.SRVCOD,SRV.SRVNAM,CHD.CHDCOD,CHD.CHDNAM,CHD.CURCOD,
				CHD.GSTAMT,CHD.CHDNETAMT,MST.DOMFLG,CHD.PAYTYP,
				MST.RATCUSCOD CUSCOD
				from 
				OPRSHPMST MST,
				CSHPAYADV PAYADV,
				CSHPAYADVSRV SRV,
				CSHSRVCHD CHD
			   where MST.CMPCOD=PAYADV.CMPCOD(+)
				AND  MST.MSTDOCNUM=PAYADV.MSTDOCNUM(+)
				AND  MST.DOCOWRIDR=PAYADV.DOCOWRIDR(+)
				AND  MST.DUPNUM=PAYADV.DUPNUM(+)
				AND  MST.SEQNUM=PAYADV.SEQNUM(+)
				AND  PAYADV.CMPCOD=SRV.CMPCOD(+)
				AND  PAYADV.STNCOD=SRV.STNCOD(+)
				AND  PAYADV.PAYADVNUM=SRV.PAYADVNUM(+)
			    AND PAYADV.IMPEXPFLG(+) = 'E' 
				AND  SRV.CMPCOD=CHD.CMPCOD(+)
				AND  SRV.STNCOD=CHD.STNCOD(+)
				AND  SRV.PAYADVNUM=CHD.PAYADVNUM(+)
				AND  SRV.SRVCOD=CHD.SRVCOD(+)
				AND NOT EXISTS
				  (SELECT 1
					 FROM OPRGRPEXESHP SHP, OPRGRPEXE GRP
					  WHERE  MST.MSTDOCNUM =SHP.MSTDOCNUM
					  AND MST.DOCOWRIDR =SHP.DOCOWRIDR
					  AND MST.DUPNUM   =SHP.DUPNUM
					  AND MST.SEQNUM    = SHP.SEQNUM
					  AND MST.CMPCOD   =SHP.CMPCOD
					  AND GRP.CMPCOD  = SHP.CMPCOD 
				      AND GRP.ARPCOD =SHP.ARPCOD
				      AND GRP.GRPIDR =SHP.GRPIDR	
					  AND GRP.GRPSTA <> 'X'	
				  )
				AND MST.SHPSTA NOT IN ('E','V','R')	
				AND  MST.CMPCOD=?
				AND  MST.DTACPTFLG='Y'
				]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>331</QRY:Id>
<QRY:Source Name="operations.shipment.listgroupexecutiondetails" Type="NATIVE">
<![CDATA[		
                SELECT SHP.MSTDOCNUM,SHP.DUPNUM,SHP.DOCOWRIDR,GRP.ARPCOD,GRP.GRPIDR,GRP.INVREFNUM,GRP.GENDAT,
				GRP.GRPSTA,MST.SHPSTA,MST.STDPCS,MST.STDWGT,MST.STDWGTCOD,MST.ORGCOD,MST.DSTCOD,
				MST.SHPPFX ,PAYADV.FNLAMT
				  FROM OPRGRPEXE GRP,
				  OPRGRPEXESHP SHP,
				  OPRSHPMST MST,
				  CSHPAYADV PAYADV
				WHERE GRP.CMPCOD  = SHP.CMPCOD(+)
				AND GRP.ARPCOD    =SHP.ARPCOD(+)
				AND GRP.GRPIDR    =SHP.GRPIDR(+)
				AND SHP.CMPCOD    =MST.CMPCOD(+)
				AND SHP.MSTDOCNUM =MST.MSTDOCNUM(+)
				AND SHP.DOCOWRIDR =MST.DOCOWRIDR(+)
				AND SHP.DUPNUM    =MST.DUPNUM(+)
				AND SHP.SEQNUM    =MST.SEQNUM(+)
				AND MST.CMPCOD=PAYADV.CMPCOD(+)
				AND  MST.MSTDOCNUM=PAYADV.MSTDOCNUM(+)
				AND  MST.DOCOWRIDR=PAYADV.DOCOWRIDR(+)
				AND  MST.DUPNUM=PAYADV.DUPNUM(+)
				AND  MST.SEQNUM=PAYADV.SEQNUM(+)				
                AND PAYADV.IMPEXPFLG(+) = 'E' 
				AND PAYADV.STNCOD(+) = ?			
				AND GRP.CMPCOD  =?
				]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>332</QRY:Id>
<QRY:Source Name="operations.shipment.findgroupidfortheshipment" Type="NATIVE">
<![CDATA[		
                                SELECT GRP.GRPIDR
                                FROM OPRGRPEXESHP SHP,
                                  OPRGRPEXE GRP
                                WHERE GRP.CMPCOD      = SHP.CMPCOD
                                AND GRP.ARPCOD      =SHP.ARPCOD
                                AND GRP.GRPIDR      =SHP.GRPIDR
                                AND GRP.GRPSTA     <> 'X'
                                AND SHP.MSTDOCNUM   = ?
                                AND SHP.DOCOWRIDR   = ?
                                AND SHP.SEQNUM      = ?
                                AND SHP.DUPNUM      = ?
                                AND SHP.CMPCOD      = ? 
				]]>
</QRY:Source>
</QRY:Definition>  
<QRY:Definition>
<QRY:Id>332</QRY:Id>
<QRY:Source Name="operations.shipment.findawbgroupiddetails" Type="NATIVE">
<![CDATA[		
        SELECT GRPIDR,
        CUSNAM,
        GRPSTA,
        ARPCOD
      FROM OPRGRPEXE
      WHERE cmpcod = ?
      AND arpcod = ?

				]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>333</QRY:Id>
<QRY:Source Name="operations.shipment.foundShipmentDetails" Type="NATIVE">
<![CDATA[	
SELECT FNDRES.CMPCOD,
    FNDRES.OWRIDR,
    FNDRES.MSTDOCNUM,
    NULL STDPCS,
    FNDRES.SEQNUM SEQNUM,
    FNDRES.DUPNUM DUPNUM,
    FNDRES.SHPPFX SHPPFX,
    NULL STDWGT,
    NULL SHPTYP,
    NULL SCCCOD,
    NULL SHPDES,
    NULL PRDNAM,
    NULL ORGCOD,
    NULL DST,
    NULL ARPCOD,
    NULL DISMSTDOCNUM,
    NULL DISCOD,
    NULL DOCNUM,
    NULL CRTTIM,
    NULL CLSDAT,
    NULL DISSTA,
    NULL DISRMK,
    0 DISSEQNUM,
    NULL FLTDISDISCOD,
    NULL FLTDISCRTTIM,
    NULL FLTDISARP,
    0 DISPCS,
    0 DISWGT,
    NULL FLTDISCLSDAT,
	NULL FLTDISRMK,
    NULL FLTDISSTA,
    NULL DMGCOD,
    NULL DMGDISSRCIND,
    NULL CDSSTA,
    NULL DMGARP,
    NULL DMGSEQNUM,
    NULL DMGDISDAT,
    'O' DMGDISSTA,
    NULL DMGRMK,
    NULL DMGPCS,
    0 MFTPCS,
    0 MFTWGT,
    0 RCVPCS,
    0 RCVWGT,
    0 FLTCARIDR,
    NULL DISFLTCARCOD,
    NULL DISFLTNUM,
    NULL DISFLTDAT,
    NULL FLTDISFLTCARCOD,
    NULL FLTDISFLTNUM,
    NULL FLTDISFLTDAT,
    0 FLTDISFLTSEQNUM,
    NULL DISARPCOD,
    NULL FLTDISARPCOD,
    NULL DMGARPCOD,
    FNDBLB.clmdocnam IMGPTH,
    FNDBLB.FNDSHPIMG IMG,
    FNDBLB.clmdocnam FILNAM,
    FNDSHP.FNDSHPNUM,
	FNDBLB.LSTUPDTIM UPLDTIM,
    FNDBLB.LSTUPDUSR UPLDUSR,
    FNDBLB.ARPCOD UPLDSTN,
	 FNDBLB.SERNUM IMGSEQNUM,
	 NULL PLTUSEFLG,
	 NULL DTLPLTFLG,
	 0 FLTDISFLTCARIDR
  FROM OPRFNDSHP FNDSHP,
    OPRFNDSHPRES FNDRES,
    OPRFNDSHPBLB FNDBLB
  WHERE FNDSHP.CMPCOD  = FNDRES.CMPCOD
  AND FNDSHP.FNDSHPNUM = FNDRES.FNDSHPNUM
  AND FNDSHP.ARPCOD    = FNDRES.ARPCOD
  AND FNDRES.FNDSHPNUM = FNDBLB.FNDSHPNUM(+)
  AND FNDRES.CMPCOD    = FNDBLB.CMPCOD(+)
  AND FNDRES.ARPCOD    = FNDBLB.ARPCOD(+)
  AND FNDRES.CMPCOD    = ?
  AND FNDRES.OWRIDR    = ?
  AND FNDRES.MSTDOCNUM = ?
  AND FNDRES.DUPNUM    = ?
  AND FNDRES.SEQNUM    = ?
				]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>334</QRY:Id>
<QRY:Source Name="operations.shipment.findRegulatoryPartyDetails" Type="NATIVE">
<![CDATA[		
 SELECT DISTINCT OCI.cmpcod,
  OCI.docowridr,
  OCI.mstdocnum,
  OCI.dupnum,
  OCI.seqnum,
  OCI.cntcod,
  OCI.infidf,
  OCI.cusinfidf ,
  OCI.srcind,
  SEG.pol,
  FLTMST.flttyp,
  (OCI.cntcod
  ||'/'
  ||'ACC3'||'/'|| ARPPOL.cntcod||OPRLEG.legorg||'-'||
 coalesce( (DECODE (FLTMST.flttyp,'C', UPPER(
  (SELECT parval
  FROM SHRARLPAR
  WHERE cmpcod = FLTMST.cmpcod
  AND arlidr   = COALESCE (
    (SELECT arlidr FROM SHRARLMST_VW WHERE TWOAPHCOD = OPRLEG.OPRFLTCARCOD
    ) ,
    (SELECT arlidr
    FROM SHRARLMST_VW
    WHERE TWOAPHCOD   = OPRREF.REFCARCOD
    AND OPRREF.OPRREF = 'Y'
    ),
    (SELECT arlidr FROM SHRARLMST_VW WHERE TWOAPHCOD = FLTMST.fltown
    ) )
  AND parcod ='shared.airline.ACC3CarrierCodeforCargoonlyAircraft'
  )), UPPER(
  (SELECT parval
  FROM SHRARLPAR
  WHERE cmpcod = FLTMST.cmpcod
  AND arlidr   = COALESCE (
    (SELECT arlidr FROM SHRARLMST_VW WHERE TWOAPHCOD = OPRLEG.OPRFLTCARCOD
    ) ,
    (SELECT arlidr
    FROM SHRARLMST_VW
    WHERE TWOAPHCOD   = OPRREF.REFCARCOD
    AND OPRREF.OPRREF = 'Y'
    ),
    (SELECT arlidr FROM SHRARLMST_VW WHERE TWOAPHCOD = FLTMST.fltown
    ) )
  AND parcod ='shared.airline.ACC3CarrierCodeforPassengerAircraft'
  )))),fltmst.fltown)
  ) RCDTL
FROM OPRSHPOCI OCI ,
  OPRSEGSHP SHP,
  OPRFLTSEG SEG,
  FLTOPRLEG OPRLEG,
  FLTOPRMST FLTMST,
  SHRARPMST ARPPOL,
  SHRARPMST ARPPOU,
  SHRCTYMST CTYPOL ,
  SHRCTYMST CTYPOU ,
  FLTOPROPRREF OPRREF
WHERE OCI.cmpcod         = SHP.cmpcod
AND OCI.docowridr        = SHP.docowridr
AND OCI.mstdocnum        = SHP.mstdocnum
AND OCI.DUPNUM           = SHP.dupnum
AND OCI.seqnum           = SHP.seqnum
AND SHP.cmpcod           = SEG.cmpcod
AND SHP.fltcaridr        = SEG.fltcaridr
AND SHP.fltnum           = SEG.fltnum
AND SHP.fltseqnum        = SEG.fltseqnum
AND SHP.segsernum        = SEG.segsernum
AND SEG.cmpcod           = OPRLEG.cmpcod
AND SEG.fltcaridr        = OPRLEG.fltcaridr
AND SEG.fltnum           = OPRLEG.fltnum
AND SEG.fltseqnum        = OPRLEG.fltseqnum
AND OPRREF.cmpcod (+)    = OPRLEG.cmpcod
AND OPRREF.fltcaridr (+) = OPRLEG.fltcaridr
AND OPRREF.fltnum (+)    = OPRLEG.fltnum
AND OPRREF.fltseqnum (+) = OPRLEG.fltseqnum
AND OPRREF.legsernum (+) = OPRLEG.legsernum
AND OPRLEG.cmpcod        = FLTMST.cmpcod
AND OPRLEG.fltcaridr     = FLTMST.fltcaridr
AND OPRLEG.fltnum        = FLTMST.fltnum
AND OPRLEG.fltseqnum     = FLTMST.fltseqnum
AND FLTMST.FLTTYP       <> 'T'
AND OPRLEG.legdst        = ARPPOU.arpcod
AND OPRLEG.cmpcod        = ARPPOU.cmpcod
AND ARPPOU.cmpcod        = CTYPOU.cmpcod
AND ARPPOU.ctycod        = CTYPOU.ctycod
AND CTYPOU.EURNONEURIND  = 'E'
AND OPRLEG.legorg        = ARPPOL.arpcod
AND OPRLEG.cmpcod        = ARPPOL.cmpcod
AND ARPPOL.cmpcod        = CTYPOL.cmpcod
AND ARPPOL.ctycod        = CTYPOL.ctycod
AND CTYPOL.EURNONEURIND != 'E'
AND OCI.CUSINFIDF        ='RC'
		AND SHP.MSTDOCNUM   = ?
		AND SHP.DOCOWRIDR   = ?
		AND SHP.DUPNUM      = ?
		AND SHP.SEQNUM      = ?		
		AND SHP.CMPCOD      = ? 
		AND ROWNUM <= 4
				]]>
</QRY:Source>
</QRY:Definition>
<!--Added by A-4772 for ICRD-129157 starts here-->
<QRY:Definition>
<QRY:Id>335</QRY:Id>
<QRY:Source Name="operations.shipment.findDiscrepancyFlight" Type="NATIVE">
<![CDATA[		
  SELECT  MST.CMPCOD, 
                MST.DOCOWRIDR,
                MST.MSTDOCNUM , 
                MST.SEQNUM,
                MST.DUPNUM,
				 MST.SHPPFX,
                FLTDIS.DISCOD,
                FLTDIS.DISPCS,
                FLTDIS.DISWGT,
                FLTDIS.DISSTA,
                DIS.DISCOD AWBDIS, 
                DIS.DISSTA AWBDISSTA, 
                MST.STDPCS         AS SUMSTDPCS,
                MST.STDWGT         AS SUMSTDWGT,
                NVL(SEGULD.BDNCPLFLG,'N') BDNCPLFLG,
                SUM(ULDSHP.MFTPCS) AS SUMMFTPCS,
                SUM(ULDSHP.MFTWGT) AS SUMMFTWGT,
                SUM(ULDSHP.RCVPCS) AS SUMRCVPCS,
                SUM(ULDSHP.RCVWGT) AS SUMRCVWGT
              FROM OPRSEGULDSHP ULDSHP INNER JOIN OPRSHPMST MST ON 
              ULDSHP.CMPCOD       = MST.CMPCOD
              AND ULDSHP.DOCOWRIDR    = MST.DOCOWRIDR
              AND ULDSHP.MSTDOCNUM    = MST.MSTDOCNUM
              AND ULDSHP.DUPNUM       = MST.DUPNUM
              AND ULDSHP.SEQNUM       = MST.SEQNUM
              INNER JOIN   OPRSEGULD SEGULD ON
              ULDSHP.Fltcaridr    =Seguld.Fltcaridr
              AND ULDSHP.Fltnum       =Seguld.Fltnum
              AND ULDSHP.Fltseqnum    =Seguld.Fltseqnum
              AND ULDSHP.Segsernum    =Seguld.Segsernum
              AND ULDSHP.CMPCOD       =SEGULD.CMPCOD
			 AND ULDSHP.ULDNUM       =SEGULD.ULDNUM
              LEFT OUTER JOIN  OPRSHPFLTDIS FLTDIS ON
              ULDSHP.CMPCOD       = FLTDIS.CMPCOD
              AND ULDSHP.DOCOWRIDR    = FLTDIS.DOCOWRIDR
              AND ULDSHP.MSTDOCNUM    = FLTDIS.MSTDOCNUM
              AND ULDSHP.DUPNUM       = FLTDIS.DUPNUM
              AND ULDSHP.SEQNUM       = FLTDIS.SEQNUM
              AND FLTDIS.Fltcaridr    =Seguld.Fltcaridr
              AND FLTDIS.Fltnum       =Seguld.Fltnum
              AND FLTDIS.Fltseqnum    =Seguld.Fltseqnum
              AND FLTDIS.CMPCOD       =SEGULD.CMPCOD
               AND FLTDIS.ARPCOD      = ?
              LEFT OUTER JOIN  OPRSHPDIS DIS ON
              ULDSHP.CMPCOD       = DIS.CMPCOD
              AND ULDSHP.DOCOWRIDR    = DIS.DOCOWRIDR
              AND ULDSHP.MSTDOCNUM    = DIS.MSTDOCNUM
              AND ULDSHP.DUPNUM       = DIS.DUPNUM
              AND ULDSHP.SEQNUM       = DIS.SEQNUM 
              AND DIS.ARPCOD      = ?
              AND DIS.DISCOD = 'MSCAW' 
              WHERE MST.CMPCOD = ?
              
             
				]]>
</QRY:Source>
</QRY:Definition>
<!--Added by A-5117 for ICRD-129514 starts -->
<QRY:Definition>
<QRY:Id>336</QRY:Id>
<QRY:Source Name="operations.shipment.findopendiscrepencydetailstoclose" Type="NATIVE">
<![CDATA[		
  SELECT a.cmpcod, a.fltcaridr, a.fltnum,a.fltseqnum,A.legsernum, a.dissta,
  a.arpcod , 
  b.dstcod, 
  b.stdpcs, 
  a.dispcs, 
  a.discod, 
  (PKG_FRMWRK_DATE.FUN_GET_UTCDATE(b.CMPCOD,a.arpcod,a.crttim)) utccrttim , 
  A.crttim , 
  b.mstdocnum , 
  b.seqnum , 
  b.dupnum , 
  b.docowridr, 
  c.rcvpcs, 
  c.totdlvpcs dlvpcs, 
  'N' TOTDLVTXNFLG 
FROM OPRSHPFLTDIS a, 
  OPRSHPMST b, 
  OPRARPSHP c, 
  SHRUSEARP d 
WHERE a.cmpcod = b.cmpcod 
AND a.docowridr = b.docowridr 
AND a.mstdocnum = b.mstdocnum 
AND a.DUPNUM = b.dupnum 
AND a.seqnum = b.seqnum 
AND b.cmpcod = c.cmpcod 
AND b.docowridr = c.docowridr 
AND b.mstdocnum = c.mstdocnum 
AND b.DUPNUM = c.dupnum 
AND b.seqnum = c.seqnum 
AND b.dstcod = c.arpcod 
AND (b.stdpcs  = c.RCVPCS 
OR b.stdpcs = c.totdlvPCS) 
AND a.discod IN ('MSCA','FDCA') 
AND a.dissta = 'O' 
AND d.cmpcod = b.cmpcod 
AND d.arpcod = b.dstcod 
AND D.OFLFLG = 'N' 
 AND a.cmpcod = ?
AND (PKG_FRMWRK_DATE.FUN_GET_UTCDATE(b.CMPCOD,a.arpcod,a.crttim)) BETWEEN Pkg_Frmwrk_Date.fun_get_sysdateutc()- ?/24 AND Pkg_Frmwrk_Date.fun_get_sysdateutc() 
UNION 
SELECT * 
FROM 
  (SELECT a.cmpcod, a.fltcaridr, a.fltnum,a.fltseqnum,A.legsernum, a.dissta,
    a.arpcod , 
    b.dstcod, 
    b.stdpcs, 
    a.dispcs, 
    a.discod, 
    (PKG_FRMWRK_DATE.FUN_GET_UTCDATE(b.CMPCOD,a.arpcod,a.crttim)) utccrttim , 
    A.crttim , 
    b.mstdocnum , 
    b.seqnum , 
    b.dupnum , 
    b.docowridr, 
    NVL( 
    (SELECT SUM(txnpcs) rcvpcs 
    FROM OPRSHPHIS c 
    WHERE c.cmpcod = b.cmpcod 
    AND c.docowridr = b.docowridr 
    AND c.mstdocnum = b.mstdocnum 
    AND c.dupnum = b.dupnum 
    AND c.seqnum = b.seqnum 
    AND c.arpcod = b.dstcod 
    AND c.TXNCOD = 'RCF' 
    ),0)rcvpcs, 
    NVL( 
    (SELECT SUM(txnpcs) rcvpcs 
    FROM OPRSHPHIS c 
    WHERE c.cmpcod = b.cmpcod 
    AND c.docowridr = b.docowridr 
    AND c.mstdocnum = b.mstdocnum 
    AND c.dupnum = b.dupnum 
    AND c.seqnum = b.seqnum 
    AND c.arpcod = b.dstcod 
    AND c.TXNCOD = 'DLV' 
    ),0)dlvpcs, 
    NVL( 
    (SELECT MAX('Y') rcvpcs 
    FROM OPRSHPHIS c 
    WHERE c.cmpcod = b.cmpcod 
    AND c.docowridr = b.docowridr 
    AND c.mstdocnum = b.mstdocnum 
    AND c.dupnum = b.dupnum 
    AND c.seqnum = b.seqnum 
    AND c.arpcod = b.dstcod 
    AND c.TXNCOD = 'DLV' 
    AND c.txnpcs = b.stdpcs 
    ),'N') TOTDLVTXNFLG 
  FROM OPRSHPFLTDIS a, 
    OPRSHPMST b, 
    SHRUSEARP d 
  WHERE a.cmpcod = b.cmpcod 
  AND a.docowridr = b.docowridr 
  AND a.mstdocnum = b.mstdocnum 
  AND a.DUPNUM = b.dupnum 
  AND a.seqnum = b.seqnum 
  AND a.discod IN ('MSCA','FDCA') 
  AND a.dissta = 'O' 
  AND d.cmpcod = b.cmpcod 
  AND d.arpcod = b.dstcod 
  AND d.oflflg = 'Y' 
   AND a.cmpcod = ?
  AND (PKG_FRMWRK_DATE.FUN_GET_UTCDATE(b.CMPCOD,a.arpcod,a.crttim)) BETWEEN Pkg_Frmwrk_Date.fun_get_sysdateutc()- ?/24 AND Pkg_Frmwrk_Date.fun_get_sysdateutc() 
  ) 
WHERE stdpcs = rcvpcs 
OR STDPCS = DLVPCS 
OR TOTDLVTXNFLG = 'Y' 
]]>
</QRY:Source>
</QRY:Definition>
<!--Added by A-5117 for ICRD-129514 ends -->
<!--Added by A-4772 for ICRD-129563 starts here-->
<QRY:Definition>
<QRY:Id>337</QRY:Id>
<QRY:Source Name="operations.shipment.findBlockDetailsForShipments" Type="NATIVE">
<![CDATA[		
			  SELECT LVL.CMPCOD,
				LVL.BLKAUT,
				LVL.BLKTXN,
				LVL.CHKTYP,
				BLK.MSTDOCNUM,
				BLK.SEQNUM,
				BLK.DUPNUM,
				BLK.DOCOWRIDR,
				BLK.sernum
				FROM OPRTXNBLKLVL LVL INNER JOIN OPRSHPBLK BLK ON
				BLK.BLKAUT = LVL.BLKAUT AND
				
				BLK.CMPCOD = LVL.CMPCOD
              WHERE BLK.CMPCOD = ?
              
             
				]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
	<QRY:Id>339</QRY:Id>
		<QRY:Source Name="operations.shipment.findmaximumduplicatenumberofawb" Type="NATIVE">
		<![CDATA[
			SELECT NVL(MAX(IDX.DUPNUM),0) as MAXDUPNUM
			FROM OPRSHPIDX IDX
			WHERE IDX.CMPCOD =?
			AND IDX.MSTDOCNUM= ?
			AND IDX.DOCOWRIDR=?
		  ]]>
		</QRY:Source>
  </QRY:Definition>
    <QRY:Definition>
        <QRY:Id>340</QRY:Id>
        <QRY:Source Name="operations.shipment.findshipmentothercustominformation" Type="NATIVE">
            <![CDATA[
            SELECT CMPCOD,
              DOCOWRIDR,
              MSTDOCNUM,
              DUPNUM,
              SEQNUM,
              SERNUM,
              CNTCOD,
              INFIDF,
              CUSINFIDF,
              CUSINF,
              SRCIND,
              PARSERNUM
            FROM OPRSHPOCI
            WHERE CMPCOD  =?            
            AND DOCOWRIDR =?
			AND MSTDOCNUM =?
            AND DUPNUM    =?
            AND SEQNUM    =?
            ORDER BY SERNUM
            ]]>
        </QRY:Source>
    </QRY:Definition>
    <QRY:Definition>
        <QRY:Id>341</QRY:Id>
        <QRY:Source Name="operations.shipment.findshipmentaccountDetails" Type="NATIVE">
            <![CDATA[
            SELECT CMPCOD,
              DOCOWRIDR,
              MSTDOCNUM,
              DUPNUM,
              SEQNUM,
              ACCINFIDR,
              ACCINF,
              SERNUM
            FROM OPRSHPACCDTL
            WHERE CMPCOD  =?
            AND DOCOWRIDR =?
			AND MSTDOCNUM =?
            AND DUPNUM    =?
            AND SEQNUM    =? 
			ORDER BY CMPCOD,DOCOWRIDR,MSTDOCNUM,DUPNUM,SEQNUM,ACCINFIDR,SERNUM
            ]]>
        </QRY:Source>
    </QRY:Definition>
    <QRY:Definition>
        <QRY:Id>342</QRY:Id>
        <QRY:Source Name="operations.shipment.findshipmentcontacts" Type="NATIVE">
            <![CDATA[
        SELECT CMPCOD,
          DOCOWRIDR,
          MSTDOCNUM,
          DUPNUM,
          SEQNUM,
          SERNUM,
          CNTIDR,
          CNTTYP,
          CNTVAL
        FROM OPRSHPCNT
        WHERE CMPCOD  =?
        AND MSTDOCNUM =?
        AND DOCOWRIDR =?
        AND DUPNUM    =?
        AND SEQNUM    =?
        AND CNTIDR    = 'VT'
        AND CNTTYP   IN ('A','S','C')
            ]]>
        </QRY:Source>
    </QRY:Definition>
<QRY:Definition>
<QRY:Id>333</QRY:Id>
<QRY:Source Name="operations.shipment.findBreakDownEndTimeForShipments" Type="NATIVE">
<![CDATA[		
       SELECT MAX(TXNDAT) DAT 
          FROM OPRSHPHIS HIS 
          WHERE  HIS.CMPCOD = ?
          AND HIS.TXNCOD ='RCF' 
          AND HIS.MSTDOCNUM = ?
          AND HIS.DUPNUM = ?
          AND HIS.DOCOWRIDR = ?
          AND HIS.ARPCOD =? 

				]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>334</QRY:Id>
<QRY:Source Name="operations.shipment.findSpecialLoadSCCsforShipment" Type="NATIVE">
<![CDATA[		
SELECT (RTRIM ( XMLAGG (XMLELEMENT (e, T.SCCCOD
  || ',') ).extract ('//text()'), ','))OSLSCCCOD
FROM
  (SELECT SCC.SCCCOD
  FROM SHRSCCMST SCC,
    (SELECT col scccod
    FROM oprshpmst ,
      TABLE(Fun_Tokeniser(Scccod))
    WHERE Mstdocnum =?
    AND Docowridr   =?
    AND Seqnum      =?
    AND Dupnum      =?
    AND Cmpcod      =?
    )mst
  WHERE Scc.Scccod = Mst.scccod
  AND SCC.NTCIND   ='Y'
  AND scc.dgrind   ='N'
  AND scc.cmpcod   =?
  )T 
				]]>
</QRY:Source>
</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>335</QRY:Id>
		<QRY:Source Name="operations.shipment.findshipmentdetailsforpayment" Type="NATIVE">
			<![CDATA[				
		SELECT MST.CMPCOD,
			  MST.DOCOWRIDR,
			  MST.MSTDOCNUM,
			  MST.DUPNUM,
			  MST.SEQNUM,
			  MST.ORGCOD,
			  MST.DSTCOD,
			  MST.SHPSTA,
  MST.DOMFLG,
MST.SHPPFX,  
  MST.OWRCOD,
		  (SELECT SHPBNDFLG
		  FROM OPRSHPMSTMIS MSTMIS
		  WHERE MST.CMPCOD  = MSTMIS.CMPCOD
		  AND MST.MSTDOCNUM = MSTMIS.MSTDOCNUM
		  AND MST.DOCOWRIDR = MSTMIS.DOCOWRIDR
		  AND MST.DUPNUM    = MSTMIS.DUPNUM
		  AND MSTMIS.SEQNUM = 1
		  )SHPBNDFLG
		FROM OPRSHPMST MST
		WHERE MST.CMPCOD  = ?
			AND MST.MSTDOCNUM = ?
			AND MST.DOCOWRIDR = ?
			AND MST.SEQNUM    = ?
			AND MST.DUPNUM    = ?
	]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>336</QRY:Id>
		<QRY:Source Name="operations.shipment.oprshrccaobjectquery" Type="NATIVE">
			<![CDATA[				
			SELECT
				CCA
		FROM
				com.ibsplc.icargo.business.operations.shipment.CCA AS CCA
		WHERE
				CCA.ccaPk.companyCode = ?
			AND	CCA.ccaPk.ownerId = ?
			AND	CCA.ccaPk.masterDocumentNumber = ?
			AND CCA.ccaPk.duplicateNumber = ?
			AND CCA.ccaPk.sequenceNumber = ?
				]]>
</QRY:Source>
</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>337</QRY:Id>
		<QRY:Source Name="operations.shipment.finddeliveryoperationdetails" Type="NATIVE">
			<![CDATA[				
			SELECT SHPLOC.CMPCOD,
			  SHPLOC.WHSCOD,
			  SHPLOC.STUCOD,
			  SHPLOC.ARPCOD,
			  SHPLOC.DOCOWRIDR,
			  SHPLOC.MSTDOCNUM,
			  SHPLOC.DUPNUM,
			  SHPLOC.SEQNUM,
			  SYSPAR.PARVAL,
			  SHPLOC.LOCCOD,
			  SHPMST.SHPPFX,
			  SHPMST.SCCCOD,
			  AGTCOD,
			  SHPMST.ORGCOD,
			  SHPMST.DSTCOD,
			  COLSHP.ULDNUM
			FROM WHSOPRSHPLOC SHPLOC
			INNER JOIN OPRCOLLSTSHP COLSHP
			ON SHPLOC.CMPCOD     = COLSHP.CMPCOD
			AND SHPLOC.MSTDOCNUM = COLSHP.MSTDOCNUM
			AND SHPLOC.DOCOWRIDR = COLSHP.DOCOWRIDR
			AND SHPLOC.DUPNUM    = COLSHP.DUPNUM
			AND SHPLOC.SEQNUM    = COLSHP.SEQNUM
			INNER JOIN OPRCOLLST COLLST
			ON SHPLOC.CMPCOD  = COLSHP.CMPCOD
			AND COLSHP.DLVIDR = COLLST.DLVIDR
			INNER JOIN OPRSHPMST SHPMST
			ON COLSHP.CMPCOD     = SHPMST.CMPCOD
			AND COLSHP.MSTDOCNUM = SHPMST.MSTDOCNUM
			AND COLSHP.DOCOWRIDR = SHPMST.DOCOWRIDR
			AND COLSHP.DUPNUM    = SHPMST.DUPNUM
			AND COLSHP.SEQNUM    = SHPMST.SEQNUM
			INNER JOIN SHRSYSPAR SYSPAR
			ON SHPLOC.CMPCOD    = SYSPAR.CMPCOD
			AND SYSPAR.PARCOD   = 'warehouse.defaults.defaultStorageUnit'
			AND COLLST.COLLSTSTA = 'ACT'
			WHERE SHPLOC.CMPCOD = ?
			AND SHPLOC.ARPCOD   = ?
			
	]]>
		</QRY:Source>
	</QRY:Definition>
	
<QRY:Definition>
<QRY:Id>337</QRY:Id>
<QRY:Source Name="operations.shipment.findshipmentsinulds" Type="NATIVE">
<![CDATA[

		SELECT SHP.ARPCOD SHPARPCOD,
		  SHP.CMPCOD SHPCMPCOD,
		  SHP.DOCOWRIDR SHPDOCOWRIDR,
		  SHP.DUPNUM SHPDUPNUM,
		  SHP.MSTDOCNUM SHPMSTDOCNUM,
		  SHP.NUMPCS SHPNUMPCS,
		  SHP.SEQNUM SHPSEQNUM,
		  SHP.ULDNUM SHPULDNUM,
		  SHP.WGT,
		  SHP.VOL,
		  ARPULD.ARPCOD ULDARPCOD,
		  ARPULD.CMPCOD ULDCMPCOD,
		  ARPULD.GRSWGT,
		  ARPULD.NETWGT,
		  ARPULD.TARWGT,
		  ARPULD.ULDNUM ULDULDNUM,
		  ARPULD.ULDCTR ULDCTR,
		  ARPULD.ACTWGT,
		  MST.SHPPFX,
		  MST.SHPDES,
		  MST.SCCCOD,
		  MST.PRDPRT,
		  MST.PRDNAM,
		  MST.ORGCOD,
		  MST.DSTCOD,
		  RTG.SERNUM,
		  RTG.ULDNUM,
		  RTG.ARPCOD,
		  RTG.CMPCOD,
		  RTG.THRCARIDR,
		  RTG.THRCARCOD,
		  ARPULD.ULDBKGIDR,
		  ARPULD.ALTIDR,
		  ARPULD.BUPFLG,
		  ARPULD.BKGTYP,
		  RTG.THRFLTNUM,
		  RTG.THRFLTDAT,
		  RTG.THRDSTCOD,
		  MST.STDPCS,
		  MST.STDWGT,
		  MST.GRSVOL,
		  ARPSHP.AVLPCS,
		  ARPSHP.AVLWGT,
		  ARPSHP.LSTUPDTIM ARPSHPLSTUPDTIM,
		  ARPSHP.LSTUPDUSR ARPSHPLSTUPDUSR,
		  ARPULD.LSTUPDTIM ARPULDLSTUPDTIM,
		  ARPULD.LSTUPDUSR ARPULDLSTUPDUSR,
		  MST.LSTUPDTIM MSTLSTUPDTIM,
		  MST.LSTUPDUSR MSTLSTUPDUSR,
		  DTL.LSTUPDTIM DTLLSTUPDTIM,
		  DTL.LSTUPDUSR DTLLSTUPDUSR,
		  MST.RDYCRGFLG,
		  MST.STDWGTCOD,
		  SEGSHP.LSTUPDUSR SEGSHPLSTUPDUSR,
		  SEGSHP.LSTUPDTIM SEGSHPLSTUPDTIM,
		  ARPULD.POU ARPULDPOU,
		  MST.EXEFLG,
		  MST.EFTAWBFLG,
		  MST.CONFLG,
		  ARPDGR.ULDNUM DGRULDNUM,
		  ARPDGR.SERNUM ARPDGRSERNUM,
		  ARPDGR.SCCCOD DGRSCCCOD,
		  ARPDGR.UNIIDR,
		  ARPDGR.PKGGRP,
		  ARPDGR.PKGINS,
		  ARPDGR.NUMPKG,
		  ARPDGR.PARSERNUM,
		  ARPDGR.DGRSERNUM,
		  ARPDGR.BDPPCS,
		  ARPDGR.PROSHPNAM,
		  ARPDGR.RMC,
		  ARPDGR.SHPCLS,
		  ARPDGR.SUBRSKTWO,
		  ARPDGR.SUBRSKTHR,
		  ARPDGR.SUBRSKONE,
		  ARPDGR.TECNAM,
		  ARPDGR.ALLPCKSERNUM,
		  ARPDGR.OVRPCKSERNUM,
		  ARPDGR.PKGHGT,
		  ARPDGR.ERGCOD,
		  ARPDGR.PCSINNULD,
		  DRYICE.NETQTY,
		  DRYICE.POU,
		  DRYICE.ULDNUM DRYICEULDNUM,
		  SPLLOD.NUMPKG,
		  SPLLOD.NETQTY,
		  SPLLOD.SUPINF,
		  SPLLOD.RMK,
		  SPLLOD.ULDNUM SPLULDNUM,
		  ARPULD.RMK ULDRMK,
		  MIS.SCICOD SCICOD
		FROM OPRARPULD ARPULD,
		  OPRULDSHP SHP,
		  OPRSHPMST MST,
		  OPRARPTHRRTG RTG,
		  OPRSHPDTL DTL,
		  OPRARPSHP ARPSHP,
		  OPRSEGSHP SEGSHP,
		  OPRARPDGR ARPDGR,
		  OPRARPSPLLOD SPLLOD,
		  OPRARPDRYICE DRYICE,
		  OPRSHPMSTMIS MIS
		WHERE SHP.ULDNUM  = ARPULD.ULDNUM
		AND SHP.ARPCOD    = ARPULD.ARPCOD
		AND SHP.CMPCOD    = ARPULD.CMPCOD
		AND ARPULD.ULDNUM = RTG.ULDNUM(+)
		AND ARPULD.ARPCOD = RTG.ARPCOD(+)
		AND ARPULD.CMPCOD = RTG.CMPCOD(+)
		AND SHP.MSTDOCNUM = MST.MSTDOCNUM
		AND SHP.DOCOWRIDR = MST.DOCOWRIDR
		AND SHP.DUPNUM    = MST.DUPNUM
		AND SHP.SEQNUM    = MST.SEQNUM
		AND SHP.CMPCOD    = MST.CMPCOD
		AND MST.CMPCOD    = DTL.CMPCOD
		AND MST.DOCOWRIDR = DTL.DOCOWRIDR
		AND MST.MSTDOCNUM = DTL.MSTDOCNUM
		AND MST.SEQNUM    = DTL.SEQNUM
		AND MST.DUPNUM    = DTL.DUPNUM
		AND SHP.MSTDOCNUM = ARPSHP.MSTDOCNUM
		AND SHP.DOCOWRIDR = ARPSHP.DOCOWRIDR
		AND SHP.DUPNUM    = ARPSHP.DUPNUM
		AND SHP.SEQNUM    = ARPSHP.SEQNUM
		AND SHP.CMPCOD    = ARPSHP.CMPCOD
		AND SHP.ARPCOD    = ARPSHP.ARPCOD
		AND SHP.CMPCOD    = SEGSHP.CMPCOD(+)
		AND SHP.MSTDOCNUM = SEGSHP.MSTDOCNUM(+)
		AND SHP.DOCOWRIDR = SEGSHP.DOCOWRIDR(+)
		AND SHP.DUPNUM    = SEGSHP.DUPNUM(+)
		AND SHP.SEQNUM    = SEGSHP.SEQNUM(+)
		AND SHP.CMPCOD    =ARPDGR.CMPCOD(+)
		AND SHP.DOCOWRIDR =ARPDGR.DOCOWRIDR(+)
		AND SHP.MSTDOCNUM =ARPDGR.MSTDOCNUM(+)
		AND SHP.DUPNUM    =ARPDGR.DUPNUM(+)
		AND SHP.SEQNUM    =ARPDGR.SEQNUM(+)
		AND SHP.ARPCOD    =ARPDGR.ARPCOD(+)
		AND SHP.ULDNUM    =ARPDGR.ULDNUM(+)
		AND SHP.CMPCOD    =SPLLOD.CMPCOD(+)
		AND SHP.DOCOWRIDR =SPLLOD.DOCOWRIDR(+)
		AND SHP.MSTDOCNUM =SPLLOD.MSTDOCNUM(+)
		AND SHP.DUPNUM    =SPLLOD.DUPNUM(+)
		AND SHP.SEQNUM    =SPLLOD.SEQNUM(+)
		AND SHP.ARPCOD    =SPLLOD.ARPCOD(+)
		AND SHP.ULDNUM    =SPLLOD.ULDNUM(+)
		AND ARPULD.CMPCOD =DRYICE.CMPCOD(+)
		AND ARPULD.ARPCOD =DRYICE.ARPCOD(+)
		AND ARPULD.ULDNUM =DRYICE.ULDNUM(+)
		AND MST.CMPCOD    = MIS.CMPCOD(+)
		AND MST.MSTDOCNUM = MIS.MSTDOCNUM(+)
		AND MST.DOCOWRIDR = MIS.DOCOWRIDR(+)
		AND MST.DUPNUM    = MIS.DUPNUM(+)
		AND MST.SEQNUM    = MIS.SEQNUM(+)
		AND SHP.CMPCOD    = ?
		AND SHP.ARPCOD    = ?
		AND SHP.ULDNUM    IN (

       ]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>338</QRY:Id>
<QRY:Source Name="operations.shipment.findconsolidatedshipmentatairportdetails" Type="NATIVE">
	<![CDATA[
	
	SELECT MST.CMPCOD,MST.MSTDOCNUM,MST.SEQNUM,MST.DOCNUM,MST.DUPNUM,MST.DOCOWRIDR,
	ARPSHP.ARPCOD, ARPSHP.AVLPCS, ARPSHP.AVLWGT, 
	NVL(SUM(ULDSHP.NUMPCS),0) ULDSHPPCS, NVL(SUM(ULDSHP.WGT),0) ULDSHPWGT,
	(AVLPCS - NVL(SUM(ULDSHP.NUMPCS),0)) REMPCS, 
	(AVLWGT - NVL(SUM(ULDSHP.WGT),0)) REMWGT, ARPSHP.PLTUSEFLG
	FROM OPRARPSHP ARPSHP, OPRSHPMST MST, OPRULDSHP ULDSHP
	WHERE
	MST.CMPCOD = ARPSHP.CMPCOD
	AND MST.MSTDOCNUM = ARPSHP.MSTDOCNUM
	AND MST.SEQNUM = ARPSHP.SEQNUM
	AND MST.DUPNUM = ARPSHP.DUPNUM
	AND MST.DOCOWRIDR = ARPSHP.DOCOWRIDR
	AND ARPSHP.CMPCOD = ULDSHP.CMPCOD (+)
	AND ARPSHP.MSTDOCNUM = ULDSHP.MSTDOCNUM (+)
	AND ARPSHP.SEQNUM = ULDSHP.SEQNUM (+)
	AND ARPSHP.DUPNUM = ULDSHP.DUPNUM (+)
	AND ARPSHP.DOCOWRIDR = ULDSHP.DOCOWRIDR (+)
	AND ARPSHP.ARPCOD = ULDSHP.ARPCOD (+)
	AND MST.CMPCOD = ?
	AND MST.MSTDOCNUM = ?
	AND MST.DUPNUM = ?
	AND MST.DOCOWRIDR = ?


	]]>
</QRY:Source>
</QRY:Definition>
<!-- A-5273 Added for ICRD-79464  Start-->
<QRY:Definition>
<QRY:Id>339</QRY:Id>
	<QRY:Source Name="operations.shipment.findShipmentHistoryforINCustoms" Type="NATIVE">
		<![CDATA[
			SELECT MSTHIS.VERNUM,
				  MSTHIS. CMPCOD,
				  MSTHIS.DOCOWRIDR,
				  MSTHIS.MSTDOCNUM,
				  MSTHIS.DUPNUM,
				  MSTHIS.SEQNUM,
				  MSTHIS.DOCNUM,
				  MSTHIS.ORGCOD,
				  MSTHIS.DSTCOD,
				  MSTHIS.STDPCS,
				  MSTHIS.STDWGT,
				  MSTHIS.SHPDES
				FROM OPRSHPMSTHIS MSTHIS
				WHERE MSTHIS.VERNUM=
				  (SELECT MAX(VERNUM)
				  FROM OPRSHPMSTHIS
				  WHERE OPRSHPMSTHIS.CMPCOD  = MSTHIS.CMPCOD
				  AND OPRSHPMSTHIS.DOCOWRIDR = MSTHIS.DOCOWRIDR
				  AND OPRSHPMSTHIS.MSTDOCNUM = MSTHIS.MSTDOCNUM
				  AND OPRSHPMSTHIS.DUPNUM    = MSTHIS.DUPNUM
				  AND OPRSHPMSTHIS.SEQNUM    = MSTHIS.SEQNUM
				  AND OPRSHPMSTHIS.VERNUM    < ?
				  )
				AND MSTHIS.MSTDOCNUM = ?
				AND MSTHIS.DOCOWRIDR = ?
				AND MSTHIS.SEQNUM    = ?			
				AND MSTHIS.DUPNUM    = ?
				AND MSTHIS.CMPCOD    = ?
		]]>
	</QRY:Source>
</QRY:Definition>
<!-- A-5273 Added for ICRD-79464  End-->
  <QRY:Definition>
    <QRY:Id>340</QRY:Id>
    <QRY:Source Name="operations.shipment.changehawbdetails" Type="PROCEDURE">
    <![CDATA[
     CALL PKG_OPR_FLT_CHG_HSEAWB.SPR_CHG_HSE_AWB (
							?,
							?,
							?,
							?,
							?,
              ?,
              ?,
              ?,
              ?,
              ?,
              ?,
              ?,
              ?
            )   

       ]]>
    </QRY:Source>
  </QRY:Definition>



<QRY:Definition>
<QRY:Id>375</QRY:Id>
<QRY:Source Name="operations.shipment.findshipmentpublishdetails" Type="NATIVE">
	<![CDATA[
	SELECT AWBCLS.CMPCOD MSTCMPCOD,
    AWBCLS.SERNUM,
    AWBCLS.DOCOWRIDR MSTDOCOWRIDR,
    AWBCLS.MSTDOCNUM,
    AWBCLS.DUPNUM MSTDUPNUM,
    AWBCLS.SEQNUM MSTSEQNUM,
    AWBCLS.SHPPFX,
    AWBCLS.ORGCOD,
    AWBCLS.DSTCOD,
    AWBCLS.IATCOD,
    AWBCLS.EXEDAT,
    AWBCLS.CPTDAT MSTCPTDAT,
    AWBCLS.AGTCOD ,
    AWBCLS.CNSCOD,
    AWBCLS.SHPCOD,
    AWBCLS.SHPSTA,
    AWBCLS.UBRNUM,
    AWBCLS.LSTSHPSRC MISLSTSHPSRC,
    AWBCLS.PRGCLSDAT,
    AWBCLS.LSTUPDTIM MSTLSTUPDTIM,
    AWBCLS.LSTUPDUSR MSTLSTUPDUSR
 FROM OPRAWBCLS AWBCLS
 WHERE AWBCLS.CMPCOD = ?
	]]>
</QRY:Source>
</QRY:Definition>


<QRY:Definition>
	<QRY:Id>385</QRY:Id>
	<QRY:Source Name="operations.shipment.updateAWBCloseStatus" Type="NATIVE">
	<![CDATA[
		
		UPDATE OPRAWBCLS SET PUBMSGFLG = 'Y'
		WHERE CMPCOD = ? 
		AND SERNUM BETWEEN ? AND ?
		
			]]>
		</QRY:Source>
	</QRY:Definition>
  
 <!-- Added by A-6800 on 25-Feb-2016 for ICRD-139896:starts-->
<QRY:Definition>
<QRY:Id>348</QRY:Id>
	<QRY:Source Name="operations.shipment.findflightdiscrepancyforhousedetailsrequired" Type="NATIVE">
		<![CDATA[
			SELECT FLTSEG.CMPCOD,
				  FLTSEG.FLTNUM ,
				  FLTSEG.FLTCARIDR ,
				  FLTSEG.FLTSEQNUM ,
				  MST.CONFLG,
				  (
				  CASE
					WHEN MST.PARSEQNUM > 0
					THEN MST.SHPPFX
					ELSE MST.SHPPFX
				  END) SHPPFX ,
				  MST.DOCOWRIDR,
				  (
				  CASE
					WHEN MST.PARSEQNUM > 0
					THEN MST.MSTDOCNUM
					  ||'/'
					  ||MST.DOCNUM
					ELSE MST.MSTDOCNUM
				  END) MSTDOCNUM ,
				   (
				  CASE
					WHEN MST.PARSEQNUM > 0
					THEN MST.DOCNUM
					  ||'(H)'
					ELSE MST.MSTDOCNUM
					  ||'(M)'
				  END) DOCNUM,				
				  MST.SEQNUM ,
				  MST.DUPNUM ,
				  MST.ORGCOD,
				  MST.DSTCOD,
				  MST.STDPCS AS SUMSTDPCS,
				  MST.STDWGT AS SUMSTDWGT,
				  LEG.ATA ,
				  FLT.FLTROU ,
				  FLT.FLTDAT ,
				  MST.SHPDES ,
				  MST.SCCCOD ,
				  IMPFLT.ARPCOD ,
				  IMPFLT.FLTCARCOD ,
				  IMPFLT.FLTOPRSTA,
				  (
					  CASE
						WHEN MST.PARSEQNUM > 0
						THEN SUM(TXNHSE.PCS)
						ELSE SEG.MFTPCS
					  END) MFTPCS ,
					  (
					  CASE
						WHEN MST.PARSEQNUM > 0
						THEN SUM(TXNHSE.WGT)
						ELSE SEG.MFTWGT
					  END) MFTWGT ,
				  SEG.RCVPCS RCVPCS,
				  SEG.RCVWGT RCVWGT,
				  IMPFLT.FLTCHGNAM
	FROM
	  (SELECT MST1.CONFLG,
					MST1.PARSEQNUM,
					MST1.SHPPFX,
					MST1.MSTDOCNUM,
					MST1.DOCNUM,
					MST1.DOCOWRIDR,
					MST1.SEQNUM,
					MST1.DUPNUM,
					MST1.ORGCOD,
					MST1.DSTCOD,
					MST1.STDPCS,
					MST1.STDWGT,
					MST1.SHPDES,
					MST1.SCCCOD,
		MST1.CMPCOD,
		MST2.FLTCARIDR,
		MST2.FLTNUM,
		MST2.FLTSEQNUM,
		MST2.SEGSERNUM,
		MST2.ARPCOD
				  FROM
		(SELECT MST2.CONFLG,
					  MST2.PARSEQNUM,
					  MST2.SHPPFX,
					  MST2.MSTDOCNUM,
					  MST2.DOCNUM,
					  MST2.DOCOWRIDR,
					  MST2.SEQNUM,
					  MST2.DUPNUM,
					  MST2.ORGCOD,
					  MST2.DSTCOD,
					  MST2.STDPCS,
					  MST2.STDWGT,
					  MST2.SHPDES,
					  MST2.SCCCOD,
		  MST2.CMPCOD,
		  SEG1.FLTCARIDR,
		  SEG1.FLTNUM,
		  SEG1.FLTSEQNUM,
		  SEG1.SEGSERNUM,
		  ARP.ARPCOD
					FROM OPRSHPMST MST2
					INNER JOIN OPRARPSHP ARP
					ON MST2.CMPCOD     = ARP.CMPCOD
					AND MST2.MSTDOCNUM = ARP.MSTDOCNUM
					AND MST2.DOCOWRIDR = ARP.DOCOWRIDR
					AND MST2.SEQNUM    = ARP.SEQNUM
					AND MST2.DUPNUM    = ARP.DUPNUM
					AND MST2.SEQNUM    =1
					INNER JOIN OPRSEGSHP SEG1
					ON MST2.CMPCOD     = SEG1.CMPCOD
					AND MST2.MSTDOCNUM = SEG1.MSTDOCNUM
					AND MST2.DOCOWRIDR = SEG1.DOCOWRIDR
					AND MST2.SEQNUM    = SEG1.SEQNUM
					AND MST2.DUPNUM    = SEG1.DUPNUM
					WHERE MST2.CONFLG  ='Y'
					AND MST2.STDPCS    >SEG1.RCVPCS
					AND ARP.DCSREQFLG  ='Y'
					AND SEG1.FLTCARIDR=?
					AND SEG1.FLTNUM   =?
					AND SEG1.FLTSEQNUM=?
		AND MST2.CMPCOD    =?
		AND ARP.ARPCOD     = ?
					) MST2,
					OPRSHPMST MST1
				  WHERE MST2.CMPCOD  = MST1.CMPCOD
				  AND MST2.MSTDOCNUM = MST1.MSTDOCNUM
				  AND MST2.DOCOWRIDR = MST1.DOCOWRIDR
				  AND MST2.DUPNUM    = MST1.DUPNUM
	  )MST,
	  OPRSEGSHP SEG,
	  OPRFLTSEG FLTSEG ,
	  OPRARPIMPFLT IMPFLT,
	  OPRTXNHSE TXNHSE,
	  FLTOPRLEG LEG,
	  FLTOPRMST FLT
	WHERE MST.CMPCOD     = FLTSEG.CMPCOD
	AND MST.FLTNUM       = FLTSEG.FLTNUM
	AND MST.FLTSEQNUM    = FLTSEG.FLTSEQNUM
	AND MST.FLTCARIDR    = FLTSEG.FLTCARIDR
	AND MST.SEGSERNUM    = FLTSEG.SEGSERNUM
	AND FLTSEG.POU       = MST.ARPCOD
	AND FLTSEG.CMPCOD    = LEG.CMPCOD
	AND FLTSEG.FLTCARIDR = LEG.FLTCARIDR
	AND FLTSEG.FLTNUM    = LEG.FLTNUM
	AND FLTSEG.FLTSEQNUM = LEG.FLTSEQNUM
	AND FLTSEG.POU       = LEG.LEGDST
	AND LEG.CMPCOD       = FLT.CMPCOD
	AND LEG.FLTCARIDR    = FLT.FLTCARIDR
	AND LEG.FLTNUM       = FLT.FLTNUM
	AND LEG.FLTSEQNUM    = FLT.FLTSEQNUM
				AND FLTSEG.CMPCOD    = IMPFLT.CMPCOD
				AND FLTSEG.FLTNUM    = IMPFLT.FLTNUM
				AND FLTSEG.FLTSEQNUM = IMPFLT.FLTSEQNUM
				AND FLTSEG.FLTCARIDR = IMPFLT.FLTCARIDR
				AND FLTSEG.POU       = IMPFLT.ARPCOD
	AND MST.CMPCOD       = SEG.CMPCOD(+)
	AND MST.DOCOWRIDR    = SEG.DOCOWRIDR(+)
	AND MST.MSTDOCNUM    = SEG.MSTDOCNUM(+)
	AND MST.DUPNUM       = SEG.DUPNUM(+)
	AND MST.SEQNUM       = SEG.SEQNUM(+)
				AND MST.FLTNUM       = SEG.FLTNUM(+)
				AND MST.FLTSEQNUM    = SEG.FLTSEQNUM(+)
				AND MST.FLTCARIDR    = SEG.FLTCARIDR(+)
				AND MST.SEGSERNUM    = SEG.SEGSERNUM(+)
				AND MST.DOCOWRIDR    = TXNHSE.DOCOWRIDR(+)
				AND MST.MSTDOCNUM    = TXNHSE.MSTDOCNUM(+)
				AND MST.DUPNUM       = TXNHSE.DUPNUM(+)
				AND MST.SEQNUM       = TXNHSE.SEQNUM(+)
				AND MST.CMPCOD       = TXNHSE.CMPCOD(+)
				AND MST.FLTNUM       = TXNHSE.TXNREFTHR(+)
				AND MST.FLTSEQNUM    = TXNHSE.TXNREFFIV(+)
				AND MST.FLTCARIDR    = TXNHSE.TXNREFTWO(+)
				AND TXNHSE.TXNCOD(+) = 'MFT'
				GROUP BY MST.CONFLG,
				  MST.STDPCS,
				  MST.STDWGT,
				  IMPFLT.FLTCARCOD,
				  LEG.ATA,
				  FLT.FLTROU,
				  FLT.FLTDAT,
				  MST.SHPPFX,
				  IMPFLT.ARPCOD,
				  MST.DOCOWRIDR,
				  MST.MSTDOCNUM,
				  MST.SEQNUM,
				  MST.DUPNUM,
				  MST.ORGCOD,
				  MST.DSTCOD,
				  MST.SHPDES,
				  MST.SCCCOD,
				  FLTSEG.CMPCOD,
				  FLTSEG.FLTNUM,
				  FLTSEG.FLTCARIDR,
				  FLTSEG.FLTSEQNUM,
				  IMPFLT.FLTOPRSTA,
				  MST.PARSEQNUM ,
				  MST.DOCNUM,
				  MFTPCS ,
				  MFTWGT ,
				  SEG.RCVPCS,
				  SEG.RCVWGT,
				  IMPFLT.FLTCHGNAM
				ORDER BY MSTDOCNUM
 		]]>
	</QRY:Source>
</QRY:Definition>
 <!-- Added by A-6800 on 25-Feb-2016 for ICRD-139896:ends-->
 <QRY:Definition>
<QRY:Id>349</QRY:Id>
	<QRY:Source Name="operations.shipment.findshipmentdetailsforpaymentadvice" Type="NATIVE">
		<![CDATA[
			SELECT MST.CMPCOD, 
			 MST.DOCOWRIDR, 
			 MST.MSTDOCNUM, 
			 MST.DUPNUM, 
			 MST.SEQNUM, 
			 MST.ORGCOD, 
			 MST.DSTCOD, 
			 MST.SHPSTA, 
			 MST.DOMFLG, 
			 MST.SHPPFX, 
			 MST.OWRCOD, 
			 MST.SCCCOD,
			 MST.STDWGT,
			 MST.STDPCS,
			 MST.SHPDES
 		]]>
	</QRY:Source>
</QRY:Definition>
 <QRY:Definition>
<QRY:Id>350</QRY:Id>
	<QRY:Source Name="operations.shipment.findmessagesequencenumberforFWBandXFWB" Type="NATIVE">
		<![CDATA[
			SELECT OPRSHPMSTMISHIS.MSGSEQNUM ,OPRSHPMSTMISHIS.VERNUM ,OPRSHPMSTMISHIS.LSTSHPSRC FROM OPRSHPMSTMISHIS 
			WHERE CMPCOD = ?
			AND MSTDOCNUM = ?
			AND DOCOWRIDR = ?
			AND DUPNUM = ?
			AND SEQNUM = ?
			AND MSGORG = ?
			ORDER BY VERNUM DESC
			
			
 		]]>
	</QRY:Source>
</QRY:Definition>
	<!--Added by A-5956 as part of ICRD-157412 starts-->
	<QRY:Definition>
<QRY:Id>381</QRY:Id>
		<QRY:Source Name="operations.shipment.findflightdiscrepancyfornotfinalized_part3" Type="NATIVE">
			<![CDATA[
			SELECT IMPFLT.CMPCOD,
  IMPFLT.FLTNUM ,
  IMPFLT.FLTCARIDR ,
  IMPFLT.FLTSEQNUM ,
  FNDRES.SHPPFX ,
  FNDRES.OWRIDR,
  FNDRES.MSTDOCNUM ,
  FNDRES.SEQNUM ,
  FNDRES.DUPNUM ,
  NULL DISCOD ,
  NULL CRTTIM ,
  NULL CLSDAT ,
  NULL ORGCOD,
  NULL DSTCOD,
  NULL SUMSTDPCS,
  NULL SUMSTDWGT,
  NULL DMGCOD ,
NULL DMGDISDAT ,
  NULL DMGRMK ,
  NULL DMGDISSTA ,
  FNDDMG.DMGPCS ,
  FNDSHP.FNDSHPNUM ,
  FNDSHP.TOTDISPCS FSTOTDISPCS,
  FNDSHP.TOTDISWGT FSTOTDISWGT,
  FNDSHP.TOTRSLPCS FSTOTRSLPCS,
  FNDSHP.TOTRSLWGT FSTOTRSLWGT,
FNDDMG.DMGCOD FSDMGCOD ,
  FNDSHP.DISDAT FSDISDAT ,
  FNDDTL.ORGCOD FSORGCOD,
  FNDDTL.DSTCOD FSDSTCOD,
NULL ATA ,
  NULL FLTROU ,
  NULL FLTDAT ,
  NULL DISSTA ,
  NULL DMGSEQNUM ,
  NULL SHPDES ,
  NULL SCCCOD ,
  IMPFLT.ARPCOD ,
  IMPFLT.FLTCARCOD ,
  IMPFLT.FLTOPRSTA,
  IMPFLT.FLTCHGNAM,
  NULL IMGPTH,
NULL CDSSTA,
  NULL bdncplflg,
  0 SUMMFTPCS,
  0 SUMMFTWGT,
  0 SUMRCVPCS,
  0 SUMRCVWGT,
  0 IMGSEQNUM,
   NULL PLTUSEFLG,
  NULL DTLPLTFLG,
  NULL PLTFLG
FROM OPRARPIMPFLT IMPFLT,
  OPRFNDSHP FNDSHP ,
  OPRFNDSHPDTL FNDDTL,
  OPRFNDSHPDMG FNDDMG,
  OPRFNDSHPRES FNDRES
WHERE FNDSHP.CMPCOD(+)  = IMPFLT.CMPCOD
AND FNDSHP.FLTNUM(+)    = IMPFLT.FLTNUM
AND FNDSHP.FLTSEQNUM(+) = IMPFLT.FLTSEQNUM
AND FNDSHP.FLTCARIDR(+) = IMPFLT.FLTCARIDR
AND FNDSHP.ARPCOD (+)   = IMPFLT.ARPCOD
AND FNDSHP.CMPCOD       = FNDDTL.CMPCOD
AND FNDSHP.FNDSHPNUM    = FNDDTL.FNDSHPNUM
AND FNDSHP.ARPCOD       = FNDDTL.ARPCOD
AND FNDRES.CMPCOD(+)    = FNDSHP.CMPCOD
AND FNDRES.ARLIDR(+)    = FNDSHP.FLTCARIDR
AND FNDRES.FLTSEQNUM(+) = FNDSHP.FLTSEQNUM
AND FNDRES.FLTNUM(+)    = FNDSHP.FLTNUM
AND FNDRES.ARPCOD(+)    = FNDSHP.ARPCOD
AND FNDRES.FNDSHPNUM(+) = FNDSHP.FNDSHPNUM
AND FNDSHP.CMPCOD       = FNDDMG.CMPCOD(+)
AND FNDSHP.FNDSHPNUM    = FNDDMG.FNDSHPNUM(+)
AND FNDDMG.ARPCOD(+)     = ?
AND IMPFLT.FLTCARIDR     = ?
AND IMPFLT.FLTNUM        = ?
AND IMPFLT.FLTSEQNUM     = ?
AND IMPFLT.LEGSERNUM     = ?
AND IMPFLT.ARPCOD        = ?
AND IMPFLT.CMPCOD        = ?
		]]>
	</QRY:Source>
</QRY:Definition>
<QRY:Definition>
	<QRY:Definition>
<QRY:Id>1124</QRY:Id>
	<QRY:Source Name="operations.shipment.findShipmentHandlingHistoryForArchive" Type="NATIVE">
	<![CDATA[
SELECT CMPCOD,
DOCOWRIDR,
MSTDOCNUM,
DUPNUM,
SEQNUM,
SERNUM,
ARPCOD,
TXNCOD,
TXNDAT,
TXNDATUTC,
TXNDES,
TXNPCS,
TXNWGT,
TXNVOL,
TXNREFONE,
TXNREFTWO,
TXNREFTHR,
TXNREFFOR,
TXNREFFIV,
TXNREFSIX,
TXNREFSEV,
LSTUPDTIM,
LSTUPDUSR,
SRCIND,
TXNREFNIN,
TXNREFEGT,
TXNREFNUM,
TXNREFTEN,
TXNREFELV,
TXNREFTLV,
TXNREFTTN,
TXNREFEIN,
ARCFLG,
TXNREFFTN,
TXNREFFIFTEN
FROM OPRSHPHIS HIS
WHERE HIS.CMPCOD=?
AND HIS.ARCFLG IS NULL
AND ROWNUM <=?
			]]>
		</QRY:Source>
	</QRY:Definition>
<QRY:Id>421</QRY:Id>
	<QRY:Source Name="operations.shipment.findShipmentPiecesGroupDetails" Type="NATIVE">
		<![CDATA[
			SELECT SHPGRP.CMPCOD, SHPGRP.DOCOWRIDR, SHPGRP.MSTDOCNUM, SHPGRP.DUPNUM, SHPGRP.SEQNUM, SHPMST.SHPPFX, 
			SHPGRP.GRPIDR, SHPGRP.NUMPCS, SHPGRP.PCSWGT, SHPGRP.PCSVOL, SHPGRP.SCCCOD, SHPGRP.DOCNUM, SHPGRP.GRPSTA, 
			SHPGRPDIM.PCSLEN, SHPGRPDIM.PCSWID, SHPGRPDIM.PCSHGT, SHPPCS.PCSIDR, TXNGRP.TXNREFSIX, TXNGRP.TXNREFSEV, TXNGRP.ARPCOD,TXNGRP.TXNREFEGT,TXNGRP.TXNCOD,
			TXNGRPHIS.TXNHISIDR,TXNGRPHIS.TXNREFONE,TXNGRPHIS.TXNREFTWO,TXNGRPHIS.TXNREFTHR,TXNGRP.TXNREFFIV,TXNGRP.TXNREFFOR,TXNGRP.TXNREFTEN,
			SHPGRP.BLKRMK,SHPGRP.BLKUSRCOD,SHPGRP.BLKCRTDAT,TXNGRP.LSTUPDTIM LSTUPDTIMFORTXN ,SHPGRPDIM.LSTUPDTIM LSTUPDTIMFORTXNFORDIM,SHPGRP.LSTUPDTIM LSTUPDTIMFORSHPGRP,SHPPCS.LSTUPDTIM LSTUPDTIMFORSHPPCS,TXNGRP.TXNREFNIN
			FROM OPRSHPPCSGRP SHPGRP 
			INNER JOIN OPRSHPMST SHPMST 
			ON SHPGRP.CMPCOD = SHPMST.CMPCOD 
			AND SHPGRP.DOCOWRIDR = SHPMST.DOCOWRIDR 
			AND SHPGRP.MSTDOCNUM = SHPMST.MSTDOCNUM 
			AND SHPGRP.DUPNUM = SHPMST.DUPNUM 
			AND SHPGRP.SEQNUM = SHPMST.SEQNUM 
			LEFT OUTER JOIN OPRSHPPCS SHPPCS 
			ON SHPGRP.CMPCOD = SHPPCS.CMPCOD 
			AND SHPGRP.DOCOWRIDR = SHPPCS.DOCOWRIDR 
			AND SHPGRP.MSTDOCNUM = SHPPCS.MSTDOCNUM 
			AND SHPGRP.DUPNUM = SHPPCS.DUPNUM 
			AND SHPGRP.SEQNUM = SHPPCS.SEQNUM 
			AND SHPGRP.GRPIDR = SHPPCS.GRPIDR 
			LEFT OUTER JOIN OPRSHPPCSGRPDIM SHPGRPDIM 
			ON SHPGRP.CMPCOD = SHPGRPDIM.CMPCOD 
			AND SHPGRP.DOCOWRIDR = SHPGRPDIM.DOCOWRIDR 
			AND SHPGRP.MSTDOCNUM = SHPGRPDIM.MSTDOCNUM 
			AND SHPGRP.DUPNUM = SHPGRPDIM.DUPNUM 
			AND SHPGRP.SEQNUM = SHPGRPDIM.SEQNUM 
			AND SHPGRP.GRPIDR = SHPGRPDIM.GRPIDR 
			LEFT OUTER JOIN OPRSHPTXNPCSGRP TXNGRP 
			ON SHPGRP.CMPCOD = TXNGRP.CMPCOD 
			AND SHPGRP.DOCOWRIDR = TXNGRP.DOCOWRIDR 
			AND SHPGRP.MSTDOCNUM = TXNGRP.MSTDOCNUM 
			AND SHPGRP.DUPNUM = TXNGRP.DUPNUM 
			AND SHPGRP.SEQNUM = TXNGRP.SEQNUM 
			AND SHPGRP.GRPIDR = TXNGRP.GRPIDR 
			<placeholder1>
			LEFT OUTER JOIN OPRSHPTXNPCSGRPHIS TXNGRPHIS 
			ON SHPGRP.CMPCOD = TXNGRPHIS.CMPCOD 
			AND SHPGRP.DOCOWRIDR = TXNGRPHIS.DOCOWRIDR 
			AND SHPGRP.MSTDOCNUM = TXNGRPHIS.MSTDOCNUM 
			AND SHPGRP.DUPNUM = TXNGRPHIS.DUPNUM 
			AND SHPGRP.SEQNUM = TXNGRPHIS.SEQNUM 
			AND SHPGRP.GRPIDR = TXNGRPHIS.GRPIDR 
			WHERE 
			
 		]]>
	</QRY:Source>
</QRY:Definition>
 <QRY:Definition>
<QRY:Id>422</QRY:Id>
	<QRY:Source Name="operations.shipment.findShipmentPieceDetails" Type="NATIVE">
		<![CDATA[
			SELECT SHPPCS.CMPCOD,
  SHPPCS.DOCOWRIDR,
  SHPPCS.MSTDOCNUM,
  SHPPCS.DUPNUM,
  SHPPCS.SEQNUM,
  SHPMST.SHPPFX,
  SHPPCS.PCSIDR,
  SHPPCS.WGT,
  SHPPCS.VOL,
  SHPPCS.NUMPCS,
  SHPPCS.LSTUPDUSR,
  PCSDIM.PCSLEN,
  PCSDIM.PCSWID,
  PCSDIM.PCSHGT,
  PCSDIM.PCSLEN,
  PCSDIM.PCSWID,
  PCSDIM.PCSHGT,
  PCSDIM.WGT,
  PCSDIM.WGTCOD,
  PCSDIM.PCSVOL,
  PCSDIM.VOLCOD,
  PCSDIM.LSTUPDTIM,
  PCSDIM.MSRUNT,
  PCSDIM.DISWGT,
  PCSDIM.DISVOL,
  SHPPCS.SCCCOD
FROM OPRSHPPCS SHPPCS
INNER JOIN OPRSHPMST SHPMST
ON SHPPCS.CMPCOD     = SHPMST.CMPCOD
AND SHPPCS.DOCOWRIDR = SHPMST.DOCOWRIDR
AND SHPPCS.MSTDOCNUM = SHPMST.MSTDOCNUM
AND SHPPCS.DUPNUM    = SHPMST.DUPNUM
AND SHPPCS.SEQNUM    = SHPMST.SEQNUM
LEFT OUTER JOIN OPRSHPPCSDIM PCSDIM
ON SHPPCS.CMPCOD     = PCSDIM.CMPCOD
AND SHPPCS.DOCOWRIDR = PCSDIM.DOCOWRIDR
AND SHPPCS.MSTDOCNUM = PCSDIM.MSTDOCNUM
AND SHPPCS.DUPNUM    = PCSDIM.DUPNUM
AND SHPPCS.SEQNUM    = PCSDIM.SEQNUM
AND SHPPCS.PCSIDR    = PCSDIM.PCSIDR 
WHERE SHPPCS.CMPCOD = ? 
AND SHPPCS.DOCOWRIDR = ? 
AND SHPPCS.MSTDOCNUM = ? 
AND SHPPCS.DUPNUM = ? 
AND SHPPCS.SEQNUM = ? 
 		]]>
	</QRY:Source>
</QRY:Definition>
<!--Added by A-5956 as part of ICRD-154941 starts-->
<QRY:Definition>
<QRY:Id>380</QRY:Id>
	<QRY:Source Name="operations.shipment.findflightdiscrepancyforfinalized_part2" Type="NATIVE">
		<![CDATA[
			SELECT MST.CMPCOD,
  DMG.ARPCOD,
  (
  CASE
    WHEN MST.PARSEQNUM > 0
    THEN ''
    ELSE MST.SHPPFX
  END) SHPPFX,
  MST.DOCOWRIDR,
  (
  CASE
    WHEN MST.PARSEQNUM > 0
    THEN MST.MSTDOCNUM
      ||'/'
      ||MST.DOCNUM
    ELSE MST.MSTDOCNUM
  END) MSTDOCNUM,
  MST.DOCNUM DOCNUM,
  MST.SEQNUM,
  MST.DUPNUM,
  MST.ORGCOD,
  MST.DSTCOD,
  IMPFLT.FLTCARIDR,
  IMPFLT.FLTNUM,
  IMPFLT.FLTSEQNUM,
  IMPFLT.LEGSERNUM,
  NULL FLTCHGNAM,
  NULL FLTDISRMK,
  DMG.DISSEQNUM,
  NULL DISCOD,
  NULL CLSDAT,
  NULL CRTTIM,
  IMPFLT.FLTCARCOD,
  NULL FLTDISMSTDOCNUM,
  NULL DISPCS,
  NULL DISWGT,
  NULL DISSTA,
  DMG.DMGPCS,
  DMG.DMGCOD,
  DMG.DISDAT DMGDISDAT,
  DMG.RMK DMGRMK,
  DMG.DISSEQNUM DMGSEQNUM,
  DMG.DISSTA DMGDISSTA,
  NULL FNDSHPNUM,
  NULL FSTOTDISPCS,
  NULL FSTOTDISWGT,
  NULL FSTOTRSLPCS,
  NULL FSDISDAT,
  NULL FSTOTRSLWGT,
  NULL FNDSHPSTA,
  NULL FSDMGCOD,
  NULL FSORGCOD,
  NULL FSDSTCOD,
  NULL ATA,
  NULL FLTROU,
  IMPFLT.FLTDAT,
  MST.SHPDES,
  MST.SCCCOD,
  NULL AWBDIS,
 NULL AWBCRTTIM,
  NULL SHPTYP,
 NULL AWBDISSTA,
 NULL AWBDISRMK,
  DMG.MSTDOCNUM AWBMSTDOCNUM,
  MST.STDPCS AS SUMSTDPCS,
  MST.STDWGT AS SUMSTDWGT,
  0 SUMMFTPCS,
  0 SUMMFTWGT,
  0 SUMRCVPCS,
  0 SUMRCVWGT,
  IMPFLT.FLTOPRSTA,
  DMG.IMGPTH ,
  (
  CASE
    WHEN DMGSRY.CDSSTA = 'I'
    THEN 'ISSUED'
    ELSE 'PENDING'
  END) CDSSTA,
  DISBLB.IMGSEQNUM,
  MST.ORGCOD,
  MST.DSTCOD,
  NULL FNDSHPRMK
FROM OPRARPIMPFLT IMPFLT,
  OPRSHPMST MST,
  OPRDMGDIS DMG,
  OPRDMGSRYDTL DMGSRY,
  OPRDMGDISBLB DISBLB
WHERE MST.CMPCOD        = DMG.CMPCOD
AND MST.DOCOWRIDR       = DMG.DOCOWRIDR
AND MST.MSTDOCNUM       = DMG.MSTDOCNUM
AND MST.DUPNUM          = DMG.DUPNUM
AND MST.SEQNUM          = DMG.SEQNUM
AND DMGSRY.CMPCOD(+)    = DMG.CMPCOD
AND DMGSRY.DOCOWRIDR(+) = DMG.DOCOWRIDR
AND DMGSRY.MSTDOCNUM(+) = DMG.MSTDOCNUM
AND DMGSRY.SEQNUM(+)    = DMG.SEQNUM
AND DMGSRY.DUPNUM(+)    = DMG.DUPNUM
AND DMGSRY.DISSEQNUM(+) = DMG.DISSEQNUM
AND DMGSRY.ARPCOD(+)    = ?
AND IMPFLT.CMPCOD       = DMG.CMPCOD
AND IMPFLT.FLTNUM       = DMG.FLTNUM
AND IMPFLT.FLTSEQNUM    = DMG.FLTSEQNUM
AND IMPFLT.FLTCARIDR    = DMG.FLTCARIDR
AND DMG.CMPCOD          = DISBLB.CMPCOD(+)
AND DMG.DOCOWRIDR       = DISBLB.DOCOWRIDR(+)
AND DMG.MSTDOCNUM       = DISBLB.MSTDOCNUM(+)
AND DMG.SEQNUM          = DISBLB.SEQNUM(+)
AND DMG.DUPNUM          = DISBLB.DUPNUM(+)
AND DMG.ARPCOD          = DISBLB.ARPCOD(+)
AND DMG.DISSEQNUM       = DISBLB.DISSEQNUM(+)
AND DMG.ARPCOD(+)       = ?
AND IMPFLT.FLTCARIDR    = ?
AND IMPFLT.FLTNUM       = ?
AND IMPFLT.FLTSEQNUM    = ?
AND IMPFLT.LEGSERNUM    = ?
AND IMPFLT.ARPCOD       = ?
AND IMPFLT.CMPCOD       = ?
AND DMG.DMGCOD(+)      <> ?
		]]>
	</QRY:Source>
</QRY:Definition>
<!--Added by A-5956 as part of ICRD-154941 ends-->

<QRY:Definition>
<QRY:Id>382</QRY:Id>
	<QRY:Source Name="operations.shipment.findflightdiscrepancyforfinalized_part3" Type="NATIVE">
		<![CDATA[
			SELECT FNDSHP.CMPCOD,
  FNDSHP.ARPCOD,
  FNDRES.SHPPFX,
  FNDRES.OWRIDR,
  FNDRES.MSTDOCNUM,
  NULL DOCNUM,
  FNDRES.SEQNUM,
  FNDRES.DUPNUM,
  NULL ORGCOD,
  NULL DSTCOD,
  FNDSHP.FLTCARIDR,
  FNDSHP.FLTNUM,
  FNDSHP.FLTSEQNUM,
  IMPFLT.LEGSERNUM,
  NULL FLTCHGNAM,
  NULL FLTDISRMK,
  NULL DISSEQNUM,
  NULL DISCOD,
  NULL CLSDAT,
  NULL CRTTIM,
  IMPFLT.FLTCARCOD,
  NULL FLTDISMSTDOCNUM,
  NULL DISPCS,
  NULL DISWGT,
  NULL DISSTA,
  FNDDMG.DMGPCS,
  NULL DMGCOD,
  NULL DMGDISDAT,
  NULL DMGRMK,
  NULL DMGSEQNUM,
  NULL DMGDISSTA,
  FNDSHP.FNDSHPNUM,
  FNDSHP.TOTDISPCS FSTOTDISPCS,
  FNDSHP.TOTDISWGT FSTOTDISWGT,
  FNDSHP.TOTRSLPCS FSTOTRSLPCS,
  FNDSHP.DISDAT FSDISDAT,
  FNDSHP.TOTRSLWGT FSTOTRSLWGT,
  FNDSHP.FNDSHPSTA,
  FNDDMG.DMGCOD FSDMGCOD,
  FNDDTL.ORGCOD FSORGCOD,
  FNDDTL.DSTCOD FSDSTCOD,
  NULL ATA,
  NULL FLTROU,
  NULL FLTDAT,
  NULL SHPDES,
  NULL SCCCOD,
  NULL AWBDIS,
  NULL AWBCRTTIM,
  NULL SHPTYP,
  NULL AWBDISSTA,
  NULL AWBDISRMK,
  NULL AWBMSTDOCNUM,
  NULL SUMSTDPCS,
  NULL SUMSTDWGT,
  0 SUMMFTPCS,
  0 SUMMFTWGT,
  0 SUMRCVPCS,
  0 SUMRCVWGT,
  IMPFLT.FLTOPRSTA,
  NULL IMGPTH ,
  NULL CDSSTA,
  NULL IMGSEQNUM,
  NULL ORGCOD,
  NULL DSTCOD,
  FNDDTL.RMK FNDSHPRMK
FROM OPRARPIMPFLT IMPFLT,
  OPRFNDSHP FNDSHP,
  OPRFNDSHPDMG FNDDMG,
  OPRFNDSHPDTL FNDDTL,
  OPRFNDSHPRES FNDRES
WHERE FNDSHP.CMPCOD(+)  = IMPFLT.CMPCOD
AND FNDSHP.FLTNUM(+)    = IMPFLT.FLTNUM
AND FNDSHP.FLTSEQNUM(+) = IMPFLT.FLTSEQNUM
AND FNDSHP.FLTCARIDR(+) = IMPFLT.FLTCARIDR
AND FNDSHP.ARPCOD (+)   = IMPFLT.ARPCOD
AND FNDSHP.CMPCOD       = FNDDTL.CMPCOD
AND FNDSHP.FNDSHPNUM    = FNDDTL.FNDSHPNUM
AND FNDSHP.ARPCOD       = FNDDTL.ARPCOD
AND FNDRES.CMPCOD(+)    = FNDSHP.CMPCOD
AND FNDRES.ARLIDR(+)    = FNDSHP.FLTCARIDR
AND FNDRES.FLTSEQNUM(+) = FNDSHP.FLTSEQNUM
AND FNDRES.FLTNUM(+)    = FNDSHP.FLTNUM
AND FNDRES.ARPCOD(+)    = FNDSHP.ARPCOD
AND FNDRES.FNDSHPNUM(+) = FNDSHP.FNDSHPNUM
AND FNDSHP.CMPCOD       = FNDDMG.CMPCOD(+)
AND FNDSHP.FNDSHPNUM    = FNDDMG.FNDSHPNUM(+)
AND FNDDMG.ARPCOD(+)    = ?
AND IMPFLT.CMPCOD       = ?
AND IMPFLT.ARPCOD(+)    = ?
AND IMPFLT.FLTNUM       = ?
AND IMPFLT.FLTSEQNUM    = ?
AND IMPFLT.FLTCARIDR    = ?
AND IMPFLT.LEGSERNUM    = ?
		]]>
	</QRY:Source>
</QRY:Definition>
<!--Added by A-5956 as part of ICRD-157412 ends-->
<!--Added by A-5956 as part of ICRD-159328 starts-->
<QRY:Definition>
<QRY:Id>383</QRY:Id>
	<QRY:Source Name="operations.shipment.findflightdiscrepancyforfinalized_part4" Type="NATIVE">
		<![CDATA[
			SELECT DIS.CMPCOD,
  DIS.ARPCOD,
  MST.SHPPFX,
  DIS.DOCOWRIDR,
  DIS.MSTDOCNUM,
  DIS.DOCNUM,
  DIS.SEQNUM,
  DIS.DUPNUM,
  MST.ORGCOD,
  MST.DSTCOD,
  IMPFLT.FLTCARIDR,
  IMPFLT.FLTNUM,
  IMPFLT.FLTSEQNUM,
  IMPFLT.LEGSERNUM,
  NULL FLTCHGNAM,
  NULL FLTDISRMK,
  NULL DISSEQNUM,
  DIS.DISCOD,
  NULL CLSDAT,
  NULL CRTTIM,
  IMPFLT.FLTCARCOD,
  NULL FLTDISMSTDOCNUM,
  DIS.DISPCS,
  DIS.DISWGT,
  DIS.DISSTA,
  NULL DMGPCS,
  NULL DMGCOD,
  NULL DMGDISDAT,
  NULL DMGRMK,
  NULL DMGSEQNUM,
  NULL DMGDISSTA,
  NULL FNDSHPNUM,
  NULL FSTOTDISPCS,
  NULL FSTOTDISWGT,
  NULL FSTOTRSLPCS,
  NULL FSDISDAT,
  NULL FSTOTRSLWGT,
  NULL FNDSHPSTA,
  NULL FSDMGCOD,
  NULL FSORGCOD,
  NULL FSDSTCOD,
  NULL ATA,
  NULL FLTROU,
  IMPFLT.FLTDAT,
  MST.SHPDES,
  MST.SCCCOD,
  DIS.DISCOD AWBDIS,
  DIS.CRTTIM AWBCRTTIM,
  DIS.SHPTYP,
  DIS.DISSTA AWBDISSTA,
  DIS.DISRMK AWBDISRMK,
  DIS.MSTDOCNUM AWBMSTDOCNUM,
  MST.STDPCS         AS SUMSTDPCS,
  MST.STDWGT        AS SUMSTDWGT,
  0 SUMMFTPCS,
  0 SUMMFTWGT,
  0 SUMRCVPCS,
  0 SUMRCVWGT,
  IMPFLT.FLTOPRSTA,
  NULL IMGPTH ,
  NULL CDSSTA,
  NULL IMGSEQNUM,
  MST .ORGCOD,
  MST.DSTCOD,
  NULL FNDSHPRMK
FROM OPRARPIMPFLT IMPFLT,
  OPRSHPMST MST,
  OPRSHPDIS DIS
WHERE MST.CMPCOD     = DIS.CMPCOD
AND MST.DOCOWRIDR    = DIS.DOCOWRIDR
AND MST.MSTDOCNUM    = DIS.MSTDOCNUM
AND MST.DUPNUM       = DIS.DUPNUM
AND MST.SEQNUM       = DIS.SEQNUM
AND IMPFLT.CMPCOD    = DIS.CMPCOD
AND IMPFLT.FLTNUM    = DIS.FLTNUM
AND IMPFLT.FLTSEQNUM = DIS.FLTSEQNUM
AND IMPFLT.FLTCARIDR = DIS.FLTCARIDR
AND IMPFLT.ARPCOD    = DIS.ARPCOD
AND IMPFLT.FLTCARIDR = ?
AND IMPFLT.FLTNUM    = ?
AND IMPFLT.FLTSEQNUM = ?
AND IMPFLT.LEGSERNUM = ?
AND IMPFLT.ARPCOD    = ?
AND IMPFLT.CMPCOD    = ?
		]]>
	</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>384</QRY:Id>
	<QRY:Source Name="operations.shipment.findflightdiscrepancyfornotfinalized_part4" Type="NATIVE">
		<![CDATA[
			SELECT IMPFLT.CMPCOD,
  IMPFLT.FLTNUM ,
  IMPFLT.FLTCARIDR ,
  IMPFLT.FLTSEQNUM ,
  (
  CASE
    WHEN MST.PARSEQNUM > 0
    THEN ''
    ELSE MST.SHPPFX
  END) SHPPFX ,
  MST.DOCOWRIDR,
  (
  CASE
    WHEN MST.PARSEQNUM > 0
    THEN MST.MSTDOCNUM
      ||'/'
      ||MST.DOCNUM
    ELSE MST.MSTDOCNUM
  END) MSTDOCNUM ,
  MST.SEQNUM ,
  MST.DUPNUM ,
  DIS.DISCOD ,
  DIS.CRTTIM ,
  DIS.CLSDAT ,
  MST.ORGCOD,
  MST.DSTCOD,
  MST.STDPCS AS SUMSTDPCS,
  MST.STDWGT AS SUMSTDWGT,
  NULL DMGCOD ,
  NULL DMGDISDAT ,
  NULL DMGRMK ,
  NULL DMGDISSTA ,
  NULL DMGPCS ,
  NULL FNDSHPNUM ,
  NULL FSTOTDISPCS,
  NULL FSTOTDISWGT,
  NULL FSTOTRSLPCS,
  NULL FSTOTRSLWGT,
  NULL FSDMGCOD ,
  NULL FSDISDAT ,
  NULL FSORGCOD,
  NULL FSDSTCOD,
  NULL ATA ,
  NULL FLTROU ,
  NULL FLTDAT ,
  NULL DISSTA ,
  NULL DMGSEQNUM ,
  MST.SHPDES ,
  MST.SCCCOD ,
  IMPFLT.ARPCOD ,
  IMPFLT.FLTCARCOD ,
  IMPFLT.FLTOPRSTA,
  IMPFLT.FLTCHGNAM,
  NULL IMGPTH,
  NULL CDSSTA,
  NULL bdncplflg,
  0 SUMMFTPCS,
  0 SUMMFTWGT,
  0 SUMRCVPCS,
  0 SUMRCVWGT,
  NULL IMGSEQNUM,
  NULL PLTUSEFLG,
 NULL DTLPLTFLG,
  MST.PLTFLG PLTFLG
FROM OPRARPIMPFLT IMPFLT,
  OPRSHPMST MST,
  OPRSHPDIS DIS
WHERE MST.CMPCOD     = DIS.CMPCOD
AND MST.DOCOWRIDR    = DIS.DOCOWRIDR
AND MST.MSTDOCNUM    = DIS.MSTDOCNUM
AND MST.DUPNUM       = DIS.DUPNUM
AND MST.SEQNUM       = DIS.SEQNUM
AND IMPFLT.CMPCOD    = DIS.CMPCOD
AND IMPFLT.FLTNUM    = DIS.FLTNUM
AND IMPFLT.FLTSEQNUM = DIS.FLTSEQNUM
AND IMPFLT.FLTCARIDR = DIS.FLTCARIDR
AND IMPFLT.ARPCOD    = DIS.ARPCOD
AND IMPFLT.FLTCARIDR = ?
AND IMPFLT.FLTNUM    = ?
AND IMPFLT.FLTSEQNUM = ?
AND IMPFLT.LEGSERNUM = ?
AND IMPFLT.ARPCOD    = ?
AND IMPFLT.CMPCOD    = ?
		]]>
	</QRY:Source>
</QRY:Definition>
<!--Added by A-5956 as part of ICRD-159328 ends-->
<QRY:Definition>
<QRY:Id>385</QRY:Id>
	<QRY:Source Name="operations.shipment.cto.findgatepassdetailsforlist" Type="NATIVE">
		<![CDATA[
SELECT (
  CASE
    WHEN SHPMST.SEQNUM >1
    THEN SHPMST.DOCNUM
    ELSE NULL
  END)DOCNUM,
  DLV.DLVDTLSEQNUM,
  DLV.DLVPCS,
  DLV.DLVWGT,
  DLV.DLVDAT,
  COALESCE(DLV.CNSNAM,DLV.DLVRTO) DLVRTO,
  DLV.VCLNUM,
  DLV.CNSADD,
  DLV.RMK,
  DLV.ARPCOD,
  DLV.DOCOWRIDR,
  DLV.MSTDOCNUM,
  SHPMST.SHPPFX,
  DLV.SEQNUM,
  DLV.DUPNUM,
  DLV.CMPCOD,
  DLV.LSTUPDTIM,
  DLV.LSTUPDUSR,
  SHPMST.ORGCOD,
  SHPMST.SHPDES,
  SHPMST.SCCCOD,
  SHPMST.STDPCS,
  SHPMST.STDWGT,
  SHPMST.CNSNAM
   ${addlCols}
FROM OPRSHPDLVDTL DLV,
  OPRSHPMST SHPMST
WHERE DLV.DOCOWRIDR=SHPMST.DOCOWRIDR
AND DLV.MSTDOCNUM  =SHPMST.MSTDOCNUM
AND DLV.DUPNUM     =SHPMST.DUPNUM
AND DLV.SEQNUM     =SHPMST.SEQNUM
AND DLV.CMPCOD     =SHPMST.CMPCOD
AND DLV.MSTDOCNUM  = ?
AND DLV.DOCOWRIDR  = ?
AND DLV.DUPNUM     = ?
AND DLV.CMPCOD     = ? 
AND DLV.ARPCOD     = ? 
		]]>
	</QRY:Source>
	<QRY:Extensions>
			<QRY:Extension CompanyCode="DNATA">
				<QRY:Token Name="addlCols">
					,DLV.SRNNUM
				</QRY:Token>
			</QRY:Extension>
			<QRY:Extension CompanyCode="4ALL">
				<QRY:Token Name="addlCols"/>
			</QRY:Extension>
		</QRY:Extensions>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>386</QRY:Id>
<QRY:Source Name="operations.shipment.cto.findgatepassenquirydetails.part1" Type="NATIVE">
	<![CDATA[
	SELECT DLV.*,
  DLVNOTFLT.FLTCARIDR,
  DLVNOTFLT.FLTNUM,
  (SELECT RTRIM ( XMLAGG ( XMLELEMENT (NOTULD,NOTULD.ULDNUM
    || ',' ) ) .EXTRACT ( '//text()' ), ',' ) ULD
  FROM OPRSHPDLVNOTULD NOTULD
  WHERE dlv.CMPCOD  = NOTULD.CMPCOD
  AND dlv.ARPCOD    = NOTULD.ARPCOD
  AND dlv.DLVNOTNUM = NOTULD.DLVNOTNUM
  )ULDNUM,
  DLVNOT.ADLINFONE,
  DLVNOT.DLVNOTPCS,
  DLVNOT.DLVNOTWGT,
  OPRLEG.STA FLTDAT,
  CASE
    WHEN ALRMST.APHCODUSE=3
    THEN ALRMST.THRAPHCOD
    ELSE ALRMST.TWOAPHCOD
  END CARCOD
FROM
  (SELECT DISTINCT DLV.DLVDTLSEQNUM,
    DLV.DLVPCS,DLV.DLVSTF,
    DLV.DLVWGT,
    DLV.DLVDAT,
    COALESCE(DLV.CNSNAM,DLV.DLVRTO) DLVRTO,
    DLV.VCLNUM,
    DLV.CNSADD,
    DLV.RMK,
    DLV.ARPCOD,
    DLV.DOCOWRIDR,
    DLV.MSTDOCNUM,
    SHPMST.SHPPFX,
    DLV.SEQNUM,
    DLV.DUPNUM,
    DLV.CMPCOD,
    DLV.LSTUPDTIM,
    DLV.LSTUPDUSR,
    SHPMST.DOCNUM,
    SHPMST.ORGCOD,
    SHPMST.SHPDES,
    SHPMST.SCCCOD,
    SHPMST.STDPCS,
    SHPMST.STDWGT,
    COL DLVNOTNUM,
    MAX(DLV.DLVDTLSEQNUM) OVER(PARTITION BY DLV.MSTDOCNUM,DLV.DOCOWRIDR,DLV.SEQNUM,DLV.DUPNUM,DLV.CMPCOD,DLV.ARPCOD) MAXDLVDTLSEQNUM,
	SHPMST.CNSNAM
  FROM OPRSHPDLVDTL DLV,
    OPRSHPMST SHPMST,
    TABLE
    (SELECT Fun_Tokeniser(DLVNOTNUM)FROM DUAL
    )
  WHERE SHPMST.CMPCOD  = DLV.CMPCOD
  AND SHPMST.DUPNUM    = DLV.DUPNUM
  AND SHPMST.MSTDOCNUM = DLV.MSTDOCNUM
  AND SHPMST.SEQNUM    = DLV.SEQNUM
  AND SHPMST.DOCOWRIDR = DLV.DOCOWRIDR
  AND DLV.MSTDOCNUM    = ?
  AND DLV.DOCOWRIDR    = ?
  AND DLV.SEQNUM       = ?
  AND DLV.DUPNUM       = ?
  AND DLV.CMPCOD       = ?
 	]]>
</QRY:Source>
</QRY:Definition> 
<QRY:Definition>
<QRY:Id>387</QRY:Id>
<QRY:Source Name="operations.shipment.cto.findgatepassenquirydetails.part2" Type="NATIVE">
	<![CDATA[
  ) DLV,
  OPRSHPDLVNOT DLVNOT,
  OPRSHPDLVNOTFLT DLVNOTFLT,
  SHRARLMST ALRMST,
  FLTOPRLEG OPRLEG
WHERE DLV.CMPCOD        = DLVNOT.CMPCOD(+)
AND DLV.DLVNOTNUM       = DLVNOT.DLVNOTNUM(+)
AND DLV.ARPCOD          = DLVNOT.ARPCOD(+)
AND DLV.CMPCOD          = DLVNOTFLT.CMPCOD(+)
AND DLV.DLVNOTNUM       = DLVNOTFLT.DLVNOTNUM(+)
AND DLV.ARPCOD          = DLVNOTFLT.ARPCOD(+)
AND DLVNOTFLT.CMPCOD    = OPRLEG.CMPCOD(+)
AND DLVNOTFLT.FLTCARIDR = OPRLEG.FLTCARIDR(+)
AND DLVNOTFLT.FLTNUM    = OPRLEG.FLTNUM(+)
AND DLVNOTFLT.FLTSEQNUM = OPRLEG.FLTSEQNUM(+)
AND DLVNOTFLT.ARPCOD    = OPRLEG.LEGDST(+)
AND OPRLEG.CMPCOD       = ALRMST.CMPCOD(+)
AND OPRLEG.FLTCARIDR    = ALRMST.ARLIDR(+)
 		]]>
	</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>423</QRY:Id>
	<QRY:Source Name="operations.shipment.findImportManifestDetailsForPieceGroup" Type="NATIVE">
		<![CDATA[
			SELECT FLTSEG.CMPCOD, FLTSEG.FLTCARIDR, FLTSEG.FLTNUM, FLTSEG.FLTSEQNUM, FLTSEG.POU,FLTSEG.SEGSERNUM,
			SHPMST.DOCOWRIDR, SHPMST.MSTDOCNUM, SHPMST.DUPNUM, SHPMST.SEQNUM, SHPMST.SHPPFX,
			(CASE WHEN (SELECT COUNT(GRPIDR) FROM OPRSHPPCSGRP PCSGRP 
			WHERE SHPMST.CMPCOD     = PCSGRP.CMPCOD
			AND SHPMST.DOCOWRIDR = PCSGRP.DOCOWRIDR
			AND SHPMST.MSTDOCNUM = PCSGRP.MSTDOCNUM
			AND SHPMST.DUPNUM    = PCSGRP.DUPNUM
			AND SHPMST.SEQNUM    = PCSGRP.SEQNUM GROUP BY PCSGRP.CMPCOD,PCSGRP.DOCOWRIDR,PCSGRP.MSTDOCNUM,PCSGRP.DUPNUM,PCSGRP.SEQNUM) > 0 
			THEN 'Y' ELSE 'N'END)PLTASG,
			(CASE WHEN (SELECT COUNT(*) FROM OPRSHPTXNPCSGRPHIS PCSGRP 
			WHERE ULDSHP.CMPCOD     = PCSGRP.CMPCOD
			AND ULDSHP.DOCOWRIDR = PCSGRP.DOCOWRIDR
			AND ULDSHP.MSTDOCNUM = PCSGRP.MSTDOCNUM
			AND ULDSHP.DUPNUM    = PCSGRP.DUPNUM
			AND ULDSHP.SEQNUM    = PCSGRP.SEQNUM 
			AND ULDSHP.FLTCARIDR = PCSGRP.TXNREFTWO
			AND ULDSHP.FLTNUM = PCSGRP.TXNREFTHR
			AND ULDSHP.FLTSEQNUM = PCSGRP.TXNREFFOR
			AND PCSGRP.TXNREFONE = ULDSHP.ULDNUM
			AND PCSGRP.TXNCOD IN ('MFT','DEP')
			AND FLTSEG.POU = PCSGRP.TXNREFEGT GROUP BY PCSGRP.CMPCOD,PCSGRP.DOCOWRIDR,PCSGRP.MSTDOCNUM,PCSGRP.DUPNUM,PCSGRP.SEQNUM,
			PCSGRP.TXNREFTWO,PCSGRP.TXNREFTHR,PCSGRP.TXNREFFOR,PCSGRP.TXNREFONE,PCSGRP.TXNREFEGT)  > 0 
			THEN 'Y' ELSE 'N'END)PLTCHK,
			ULDSHP.ULDNUM,ULDSHP.SHPBDNITN
			FROM OPRFLTSEG FLTSEG
			INNER JOIN OPRSEGULDSHP ULDSHP
			ON FLTSEG.CMPCOD     = ULDSHP.CMPCOD
			AND FLTSEG.FLTCARIDR = ULDSHP.FLTCARIDR
			AND FLTSEG.FLTNUM    = ULDSHP.FLTNUM
			AND FLTSEG.FLTSEQNUM = ULDSHP.FLTSEQNUM
			AND FLTSEG.SEGSERNUM = ULDSHP.SEGSERNUM
			INNER JOIN OPRSHPMST SHPMST
			ON ULDSHP.CMPCOD     = SHPMST.CMPCOD
			AND ULDSHP.DOCOWRIDR = SHPMST.DOCOWRIDR
			AND ULDSHP.MSTDOCNUM = SHPMST.MSTDOCNUM
			AND ULDSHP.DUPNUM    = SHPMST.DUPNUM
			AND ULDSHP.SEQNUM    = SHPMST.SEQNUM
			WHERE FLTSEG.CMPCOD = ?
			AND FLTSEG.FLTCARIDR = ?
			AND FLTSEG.FLTNUM = ?
			AND FLTSEG.FLTSEQNUM = ?
			AND FLTSEG.POU = ?
			
 		]]>
	</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>424</QRY:Id>
	<QRY:Source Name="operations.shipment.plt.findoperationalshipmentforaudit" Type="NATIVE">
	<![CDATA[SELECT PCSGRPAUD.CMPCOD,
				PCSGRPAUD.MSTDOCNUM,
				PCSGRPAUD.DOCOWRIDR,
				PCSGRPAUD.SEQNUM,
				PCSGRPAUD.DUPNUM,
				PCSGRPAUD.ADLINF,
				PCSGRPAUD.AUDRMK,
				PCSGRPAUD.SERNUM,
				PCSGRPAUD.STNCOD,
				PCSGRPAUD.TRGPNT,
				PCSGRPAUD.DOCNUM,
				PCSGRPAUD.ACTCOD,
				PCSGRPAUD.UPDTXNTIM,
				PCSGRPAUD.UPDUSR,
				CFG.TXNHISFLG
			FROM OPRSHPPCSGRPAUD PCSGRPAUD
			JOIN OPRSHPMST MST
			ON PCSGRPAUD.CMPCOD = MST.CMPCOD
			AND PCSGRPAUD.DOCOWRIDR = MST.DOCOWRIDR
			AND PCSGRPAUD.MSTDOCNUM = MST.MSTDOCNUM
			AND PCSGRPAUD.DUPNUM = MST.DUPNUM
			AND PCSGRPAUD.SEQNUM = MST.SEQNUM
			LEFT OUTER JOIN  SHRAUDTXNCFG CFG ON 
			PCSGRPAUD.CMPCOD      = CFG.CMPCOD
			AND PCSGRPAUD.ACTCOD    = CFG.TXNCOD
			WHERE PCSGRPAUD.UPDTXNTIMUTC >= ?
			AND  PCSGRPAUD.UPDTXNTIMUTC <= ?
			]]>
		</QRY:Source>
	</QRY:Definition>
<QRY:Definition>
	<QRY:Id>425</QRY:Id>
		<QRY:Source Name="operations.shipment.plt.findtrackingidslinkedtodg" Type="NATIVE">
		<![CDATA[
		SELECT CMPCOD,DOCOWRIDR,MSTDOCNUM,
		DUPNUM,SEQNUM,DGRSERNUM,
		GRPIDR,LSTUPDTIM,LSTUPDUSR 
		FROM OPRSHPDGRPCSGRP 
		WHERE 
		]]>
		</QRY:Source>
</QRY:Definition>
<QRY:Definition>
	<QRY:Id>426</QRY:Id>
		<QRY:Source Name="operations.shipment.plt.removetrackingidslinkedtodg" Type="NATIVE">
		<![CDATA[
			DELETE FROM OPRSHPDGRPCSGRP WHERE
			CMPCOD = ?	
			AND DOCOWRIDR = ?
			AND MSTDOCNUM = ?
			AND DUPNUM = ?
			AND SEQNUM = ?
			AND GRPIDR = ?
 		]]>
	</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>424</QRY:Id>
	<QRY:Source Name="operations.shipment.findAwbDetailsForExport" Type="NATIVE">
		<![CDATA[
			SELECT *
FROM
  (SELECT ROW_NUMBER() OVER(PARTITION BY MSTDOCNUM,DOCOWRIDR,SEQNUM,CMPCOD,DUPNUM, RATLINSERNUM,CHDCOD ORDER BY FLTDAT,A NULLS LAST) SLNO1,
    K.*
  FROM
    (SELECT 
	SHPACC.CMSPCT,
	MIS.PPTCOD,
	MIS.PPTCTY,
	MIS.SNDDSG,
	MIS.SNDCMPDSG,
	MIS.SNDCTY,
	RTG.DSTCOD ONWDST,
	RTG.FLTCARCOD ONWCAR,
	SHPMST.EXEUSRCOD,
	OCI.CNTCOD,
      OCI.INFIDF,
      OCI.CUSINFIDF,
      OCI.CUSINF,
      MIS.SHPINFONE,
      MIS.SHPINFTWO,
      MIS.NOMHDLPTY,
      MIS.NOMHDLPTYPLC,
      CNT.SHPREFNUM,
      SHPACC.DSTCNVRAT,
      SHPACC.DSTCURCOD,
      SHPACC.DSTCCFCHG,
      SHPACC.DSTCHG,
      SHPACC.TOTDSTCCFCHG,
      SHPACC.CMSAMT,
      SHPACC.CMSCASIND,
      SHPACC.CMSCCF,
      SHPACC.SALINCAMT,
      SHPMST.ORGCOD ,
      SHPMST.AGTNAM ,
      SHPMST.MSTDOCNUM ,
      SHPMST.DOCOWRIDR ,
      SHPMST.SEQNUM ,
      SHPMST.CMPCOD ,
      SHPMST.DUPNUM ,
      SHPMST.SHPPFX ,
      SHPMST.DSTCOD ,
      SHPMST.EXEDAT ,
      SHPMST.STDWGTCOD,
      RATDTL.GRSVOL,
      SHPMST.GRSVOLUNT,
      SHPMST.SHPADRONE,
      SHPMST.CNSADRONE,
      SHPACC.IATCOD,
      SHPMST.PAYTYP,
      SHPACC.DVLCAR,
      SHPACC.DVLCUS,
      SHPACC.INSAMT,
      CNT.SHPACCNUM,
      CNT.SHPTELNUM,
      CNT.CNSACCNUM,
      CNT.CNSTELNUM,
      SHPACC.AGTACCNUM,
      SHPACC.CASCOD,
	  NFY.NFYNAM,
      NFY.NFYACCNUM,
      NFY.NFYADRONE,
      NFY.NFYADRTWO,
      NFY.NFYCTY,
      NFY.NFYCTR,
      NFY.NFYMALIDR,
      NFY.NFYPSTCOD,
      NFY.NFYSTT,
      SHPCNT.CNTVAL  NFYTELNUM,
      ACC.ACCINF,
      RATDTL.CMDITMNUM,
	  RATDTL.CMDITMNAM,
      SHPMST.SLCPCS,
      RATDTL.HRMCMDCOD,
      RATDTL.CTRORG,
      RATDTL.SRVCOD,
      NVL(SHPMST.SCCCOD,BKGDTL.SCCCOD) SCCCOD ,
      SHPMST.EXESTN ,
      SHPMST.SHPDES ,
      COALESCE(SHPMST.CURCOD ,
      (SELECT SYSPAR.PARVAL
      FROM SHRSYSPAR SYSPAR
      WHERE SYSPAR.PARCOD='system.defaults.unit.currency'
      AND SYSPAR.CMPCOD  =SHPMST.CMPCOD
      )) CURCOD ,
      SHPMST.SHPNAM ,
      SHPMST.CNSNAM ,
      CHGDTL.TAX CHGDTLTAX ,
      CHGDTL.CHDCOD ,
      CHGDTL.CHGAMT,
      CHGDTL.CHGHED ,
      CHGDTL.DUECARFLG ,
      CHGDTL.DUEAGTFLG ,
      RATDTL.TAX RATDTLTAX ,
      RATDTL.RATLINSERNUM ,
      RATDTL.NUMPCS ,
      RATDTL.GRSWGT ,
      RATDTL.CHGWGT ,
      RATDTL.NETCHG ,
      RATDTL.IATRAT ,
      RATDTL.IATCHG ,
      RATDTL.IATRATCLS ,
      RATDTL.ARLRAT ,
      RATDTL.ARLRATCLS ,
      SHPACC.VALCCCHG,
      SHPACC.VALPPCHG,
      SHPACC.TAXCCF,
      SHPACC.TAXPPD,
      MIS.SHPSIG,
	  MIS.SCICOD,
	  MIS.AGTREF,
	  COALESCE (EXPFLT.FLTCARCOD, BKGFLTDTL.FLTCARCOD,FLTBOK.CARCOD) FLTCARCOD,
      COALESCE(EXPFLT.FLTNUM , BKGFLTDTL.FLTNUM , FLTBOK.FLTNUM) FLTNUM ,
      EXPFLT.FLTNUM A ,
      BKGFLTDTL.FLTNUM B ,
      COALESCE (EXPFLT.FLTDAT ,BKGFLTDTL.FLTDAT ,FLTBOK.FLTDAT) FLTDAT ,
      EXPFLT.FLTSEQNUM ,
      EXPFLT.FLTSEQNUM C ,
      BKGFLTDTL.FLTSEQNUM D ,
      EXPFLT.FLTCARIDR ,
      EXPFLT.LEGSERNUM ,
      (
      CASE
        WHEN FLTSEG.POL IS NOT NULL
        THEN FLTSEG.POL
          ||'-'
          ||FLTSEG.POU
        ELSE BKGFLTDTL.FLTORG
          ||'-'
          ||BKGFLTDTL.FLTDST
      END ) ROUTE ,
      NVL(SHPACC.ACCINF,BKGMST.SHPRMK) RMK,
      ACC.ACCINFIDR,
      MIS.AGTPLC,
      DIM.NUMPCS DIMNUMPCS,
      DIM.PCSHGT DIMPCSHGT,
      DIM.PCSLEN DIMPCSLEN,
      DIM.PCSVOL DIMPCSVOL,
      DIM.PCSWID DIMPCSWID,
      (SELECT LISTAGG(SRV.OTHSRVINF, ';') WITHIN GROUP (
      ORDER BY SRV.OTHSRVINF DESC)
      FROM OPRSHPOTHSRV SRV
      WHERE SHPMST.MSTDOCNUM =SRV.MSTDOCNUM
      AND SHPMST.DOCOWRIDR   =SRV.DOCOWRIDR
      AND SHPMST.DUPNUM      =SRV.DUPNUM
      AND SHPMST.SEQNUM      =SRV.SEQNUM
      AND SHPMST.CMPCOD      =SRV.CMPCOD
      ) OTHSRVINF,
      (SELECT LISTAGG(SRVREQ.SPLSRVREQ,';') WITHIN GROUP (
      ORDER BY SRVREQ.SPLSRVREQ)
      FROM OPRSHPSPLSRVREQ SRVREQ
      WHERE SHPMST.MSTDOCNUM =SRVREQ.MSTDOCNUM
      AND SHPMST.DOCOWRIDR   =SRVREQ.DOCOWRIDR
      AND SHPMST.DUPNUM      =SRVREQ.DUPNUM
      AND SHPMST.SEQNUM      =SRVREQ.SEQNUM
      AND SHPMST.CMPCOD      =SRVREQ.CMPCOD
      ) SPLSRVREQ,
      (SELECT LISTAGG(DIM.PCSLEN
        || '-'
        || DIM.PCSWID
        || '-'
        || DIM.PCSHGT
        || '/'
        || DIM.NUMPCS
		|| '/'
		|| DIM.WGT    
        ,';;') WITHIN GROUP (
      ORDER BY DIM.NUMPCS)
      FROM OPRSHPDIMDTL DIM
      WHERE SHPMST.MSTDOCNUM  =DIM.MSTDOCNUM
      AND SHPMST.DOCOWRIDR    =DIM.DOCOWRIDR
      AND SHPMST.DUPNUM       =DIM.DUPNUM
      AND SHPMST.SEQNUM       =DIM.SEQNUM
      AND RATDTL.RATLINSERNUM =DIM.RATLINSERNUM
      AND SHPMST.CMPCOD       =DIM.CMPCOD
      ) DIMENSION,
	  OTHPPT.CMPDSG OTHCMPDSG,
      OTHPPT.OFFCTY OTHOFFCTY,
      OTHPPT.OFFDSG OTHOFFDSG,
      OTHPPT.OFFFILREF OTHOFFFILREF,
      OTHPPT.PPTCOD OTHPPTCOD,
      OTHPPT.PPTCTY OTHPPTCTY,
      OTHPPT.PPTNAM OTHPPTNAM,
	  (SELECT LISTAGG( DSTCOD,'-') WITHIN GROUP(ORDER BY RTGSERNUM)
	FROM OPRSHPRTG SHPRTG
	WHERE SHPMST.MSTDOCNUM  =SHPRTG.MSTDOCNUM
    AND SHPMST.DOCOWRIDR =SHPRTG.DOCOWRIDR
    AND SHPMST.DUPNUM    =SHPRTG.DUPNUM
    AND SHPMST.SEQNUM    =SHPRTG.SEQNUM
    AND SHPMST.CMPCOD    =SHPRTG.CMPCOD) AWBROUTE,
	(SELECT LISTAGG(CHG.CHDCOD, ';') WITHIN GROUP (
      ORDER BY CHG.CHGHEDIDR DESC)
      FROM OPRSHPCHGDTL CHG
      WHERE SHPMST.MSTDOCNUM =CHG.MSTDOCNUM
      AND SHPMST.DOCOWRIDR   =CHG.DOCOWRIDR
      AND SHPMST.DUPNUM      =CHG.DUPNUM
      AND SHPMST.SEQNUM      =CHG.SEQNUM
      AND SHPMST.CMPCOD      =CHG.CMPCOD
      ) CHARGNAM,
	  (SELECT LISTAGG( SHPRTG.DSTCOD || SHPRTG.FLTCARCOD,'/') WITHIN GROUP(
      ORDER BY RTGSERNUM)
      FROM OPRSHPRTG SHPRTG
      WHERE SHPMST.MSTDOCNUM =SHPRTG.MSTDOCNUM
      AND SHPMST.DOCOWRIDR   =SHPRTG.DOCOWRIDR
      AND SHPMST.DUPNUM      =SHPRTG.DUPNUM
      AND SHPMST.SEQNUM      =SHPRTG.SEQNUM
      AND SHPMST.CMPCOD      =SHPRTG.CMPCOD
      ) ONWARDDSTCAR
    FROM OPRSHPMST SHPMST
    JOIN OPRSHPRATDTL RATDTL
    ON ( SHPMST.DOCOWRIDR =RATDTL.DOCOWRIDR
    AND SHPMST.MSTDOCNUM  =RATDTL.MSTDOCNUM
    AND SHPMST.CMPCOD     = RATDTL.CMPCOD
    AND SHPMST.DUPNUM     = RATDTL.DUPNUM
    AND SHPMST.SEQNUM     = RATDTL.SEQNUM)
    JOIN OPRSHPMSTACC SHPACC
    ON(SHPMST.DOCOWRIDR  =SHPACC.DOCOWRIDR
    AND SHPMST.MSTDOCNUM =SHPACC.MSTDOCNUM
    AND SHPMST.CMPCOD    = SHPACC.CMPCOD
    AND SHPMST.DUPNUM    = SHPACC.DUPNUM
    AND SHPMST.SEQNUM    = SHPACC.SEQNUM )
	LEFT OUTER JOIN OPRSHPNFY NFY
    ON(SHPMST.DOCOWRIDR  = NFY.DOCOWRIDR
    AND SHPMST.MSTDOCNUM = NFY.MSTDOCNUM
    AND SHPMST.CMPCOD    = NFY.CMPCOD
    AND SHPMST.DUPNUM    = NFY.DUPNUM
    AND SHPMST.SEQNUM    = NFY.SEQNUM)
	LEFT OUTER JOIN OPRSHPOTHPPT OTHPPT
    ON(SHPMST.DOCOWRIDR  = OTHPPT.DOCOWRIDR
    AND SHPMST.MSTDOCNUM = OTHPPT.MSTDOCNUM
    AND SHPMST.CMPCOD    = OTHPPT.CMPCOD
    AND SHPMST.DUPNUM    = OTHPPT.DUPNUM
    AND SHPMST.SEQNUM    = OTHPPT.SEQNUM)
    LEFT OUTER JOIN OPRSHPOCI OCI
    ON(SHPMST.MSTDOCNUM  = OCI.MSTDOCNUM
    AND SHPMST.DOCOWRIDR = OCI.DOCOWRIDR
    AND SHPMST.DUPNUM    = OCI.DUPNUM
    AND SHPMST.SEQNUM    = OCI.SEQNUM
    AND SHPMST.CMPCOD    = OCI.CMPCOD)
	LEFT OUTER JOIN OPRSHPFLTBOK FLTBOK
    ON(SHPMST.MSTDOCNUM  = FLTBOK.MSTDOCNUM
    AND SHPMST.DOCOWRIDR = FLTBOK.DOCOWRIDR
    AND SHPMST.DUPNUM    = FLTBOK.DUPNUM
    AND SHPMST.SEQNUM    = FLTBOK.SEQNUM
    AND SHPMST.CMPCOD    = FLTBOK.CMPCOD)
    LEFT OUTER JOIN OPRSHPACCDTL ACC
    ON(SHPMST.MSTDOCNUM  = ACC.MSTDOCNUM
    AND SHPMST.DOCOWRIDR = ACC.DOCOWRIDR
    AND SHPMST.DUPNUM    = ACC.DUPNUM
    AND SHPMST.SEQNUM    = ACC.SEQNUM
    AND SHPMST.CMPCOD    = ACC.CMPCOD)
    LEFT OUTER JOIN OPRSHPMSTMIS MIS
    ON(SHPMST.MSTDOCNUM  = MIS.MSTDOCNUM
    AND SHPMST.DOCOWRIDR = MIS.DOCOWRIDR
    AND SHPMST.DUPNUM    = MIS.DUPNUM
    AND SHPMST.SEQNUM    = MIS.SEQNUM
    AND SHPMST.CMPCOD    = MIS.CMPCOD)
    LEFT OUTER JOIN OPRSHPDIMDTL DIM
    ON(SHPMST.MSTDOCNUM     =DIM.MSTDOCNUM
    AND SHPMST.DOCOWRIDR    =DIM.DOCOWRIDR
    AND SHPMST.DUPNUM       =DIM.DUPNUM
    AND SHPMST.SEQNUM       =DIM.SEQNUM
    AND RATDTL.RATLINSERNUM =DIM.RATLINSERNUM
    AND SHPMST.CMPCOD       =DIM.CMPCOD)
	LEFT OUTER JOIN OPRSHPRTG RTG
    ON(SHPMST.MSTDOCNUM  =RTG.MSTDOCNUM
    AND SHPMST.DOCOWRIDR =RTG.DOCOWRIDR
    AND SHPMST.DUPNUM    =RTG.DUPNUM
    AND SHPMST.SEQNUM    =RTG.SEQNUM
    AND SHPMST.CMPCOD    =RTG.CMPCOD)
    LEFT OUTER JOIN OPRSHPMSTCNT CNT
    ON(SHPMST.MSTDOCNUM  =CNT.MSTDOCNUM
    AND SHPMST.DOCOWRIDR =CNT.DOCOWRIDR
    AND SHPMST.DUPNUM    =CNT.DUPNUM
    AND SHPMST.SEQNUM    =CNT.SEQNUM
    AND SHPMST.CMPCOD    =CNT.CMPCOD)
    LEFT OUTER JOIN OPRSHPCHGDTL CHGDTL
    ON(SHPMST.DOCOWRIDR  = CHGDTL.DOCOWRIDR
    AND SHPMST.MSTDOCNUM = CHGDTL.MSTDOCNUM
    AND SHPMST.CMPCOD    = CHGDTL.CMPCOD
    AND SHPMST.DUPNUM    = CHGDTL.DUPNUM
    AND SHPMST.SEQNUM    = CHGDTL.SEQNUM)
    LEFT OUTER JOIN OPRSEGSHP SEGSHP
    ON( SHPMST.DOCOWRIDR =SEGSHP.DOCOWRIDR
    AND SHPMST.MSTDOCNUM =SEGSHP.MSTDOCNUM
    AND SHPMST.CMPCOD    = SEGSHP.CMPCOD
    AND SHPMST.DUPNUM    = SEGSHP.DUPNUM
    AND SHPMST.SEQNUM    = SEGSHP.SEQNUM)
    LEFT OUTER JOIN OPRFLTSEG FLTSEG
    ON(SEGSHP.FLTNUM     = FLTSEG.FLTNUM
    AND SEGSHP.FLTCARIDR =FLTSEG.FLTCARIDR
    AND SEGSHP.FLTSEQNUM =FLTSEG.FLTSEQNUM
    AND SEGSHP.SEGSERNUM = FLTSEG.SEGSERNUM
    AND SEGSHP.CMPCOD    = FLTSEG.CMPCOD
    AND SHPMST.ORGCOD    = FLTSEG.POL)
    LEFT OUTER JOIN OPRARPEXPFLT EXPFLT
    ON(FLTSEG.FLTNUM     = EXPFLT.FLTNUM
    AND FLTSEG.FLTCARIDR = EXPFLT.FLTCARIDR
    AND FLTSEG.FLTSEQNUM = EXPFLT.FLTSEQNUM
    AND FLTSEG.CMPCOD    = EXPFLT.CMPCOD
    AND SHPMST.ORGCOD    = EXPFLT.ARPCOD )
    LEFT OUTER JOIN CAPBKGMST BKGMST
    ON (SHPMST.CMPCOD = BKGMST.CMPCOD
    AND SHPMST.UBRNUM =BKGMST.UBRNUM)
    LEFT OUTER JOIN CAPBKGDTL BKGDTL
    ON( SHPMST.CMPCOD = BKGDTL.CMPCOD
    AND SHPMST.UBRNUM =BKGDTL.UBRNUM)
    LEFT OUTER JOIN CAPBKGFLTDTL BKGFLTDTL
    ON(SHPMST.CMPCOD    = BKGFLTDTL.CMPCOD
    AND SHPMST.UBRNUM   =BKGFLTDTL.UBRNUM
    AND SHPMST.ORGCOD   =BKGFLTDTL.FLTORG)
	LEFT OUTER JOIN OPRSHPCNT SHPCNT
    ON (SHPMST.DOCOWRIDR =SHPCNT.DOCOWRIDR
    AND SHPMST.MSTDOCNUM =SHPCNT.MSTDOCNUM
    AND SHPMST.CMPCOD    = SHPCNT.CMPCOD
    AND SHPMST.DUPNUM    = SHPCNT.DUPNUM
    AND SHPMST.SEQNUM    = SHPCNT.SEQNUM)
    WHERE (SHPCNT.CNTTYP  ='N' OR SHPCNT.CNTTYP IS NULL)
	AND SHPMST.CMPCOD = ?
			
 		]]>
	</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>425</QRY:Id>
	<QRY:Source Name="operations.shipment.findAwbDetailsForExportByTransportationDate" Type="NATIVE">
		<![CDATA[
			SELECT *
FROM
  (SELECT ROW_NUMBER() OVER(PARTITION BY MSTDOCNUM,DOCOWRIDR,SEQNUM,CMPCOD,DUPNUM, RATLINSERNUM,CHDCOD ORDER BY expfltdat,expfltnum nulls last ) SLNO1,
    K.*
  FROM
    (SELECT SHPACC.CMSPCT,
  MIS.PPTCOD,
  MIS.PPTCTY,
  MIS.SNDDSG,
  MIS.SNDCMPDSG,
  MIS.SNDCTY,
  RTG.DSTCOD ONWDST,
  RTG.FLTCARCOD ONWCAR,
  SHPMST.EXEUSRCOD,
  OCI.CNTCOD,
  OCI.INFIDF,
  OCI.CUSINFIDF,
  OCI.CUSINF,
  MIS.SHPINFONE,
  MIS.SHPINFTWO,
  MIS.NOMHDLPTY,
  MIS.NOMHDLPTYPLC,
  CNT.SHPREFNUM,
  SHPACC.DSTCNVRAT,
  SHPACC.DSTCURCOD,
  SHPACC.DSTCCFCHG,
  SHPACC.DSTCHG,
  SHPACC.TOTDSTCCFCHG,
  SHPACC.CMSAMT,
  SHPACC.CMSCASIND,
  SHPACC.CMSCCF,
  SHPACC.SALINCAMT,
  SHPMST.ORGCOD ,
  SHPMST.AGTNAM ,
  SHPMST.MSTDOCNUM ,
  SHPMST.DOCOWRIDR ,
  SHPMST.SEQNUM ,
  SHPMST.CMPCOD ,
  SHPMST.DUPNUM ,
  SHPMST.SHPPFX ,
  SHPMST.DSTCOD ,
  SHPMST.EXEDAT ,
  SHPMST.STDWGTCOD,
  RATDTL.GRSVOL,
  SHPMST.GRSVOLUNT,
  SHPMST.SHPADRONE,
  SHPMST.CNSADRONE,
  SHPACC.IATCOD,
  SHPMST.PAYTYP,
  SHPACC.DVLCAR,
  SHPACC.DVLCUS,
  SHPACC.INSAMT,
  CNT.SHPACCNUM,
  CNT.SHPTELNUM,
  CNT.CNSACCNUM,
  CNT.CNSTELNUM,
  SHPACC.AGTACCNUM,
  SHPACC.CASCOD,
  NFY.NFYNAM,
  NFY.NFYACCNUM,
  NFY.NFYADRONE,
  NFY.NFYADRTWO,
  NFY.NFYCTY,
  NFY.NFYCTR,
  NFY.NFYMALIDR,
  NFY.NFYPSTCOD,
  NFY.NFYSTT,
  SHPCNT.CNTVAL  NFYTELNUM,
  ACC.ACCINF,
  RATDTL.CMDITMNUM,
  RATDTL.CMDITMNAM,
  SHPMST.SLCPCS,
  RATDTL.HRMCMDCOD,
  RATDTL.CTRORG,
  RATDTL.SRVCOD,
  SHPMST.SCCCOD SCCCOD ,
  SHPMST.EXESTN ,
  SHPMST.SHPDES ,
  COALESCE(SHPMST.CURCOD ,
  (SELECT SYSPAR.PARVAL
  FROM SHRSYSPAR SYSPAR
  WHERE SYSPAR.PARCOD='system.defaults.unit.currency'
  AND SYSPAR.CMPCOD  =SHPMST.CMPCOD
  )) CURCOD ,
  SHPMST.SHPNAM ,
  SHPMST.CNSNAM ,
  CHGDTL.TAX CHGDTLTAX ,
  CHGDTL.CHDCOD ,
  CHGDTL.CHGAMT,
  CHGDTL.CHGHED ,
  CHGDTL.DUECARFLG ,
  CHGDTL.DUEAGTFLG ,
  RATDTL.TAX RATDTLTAX ,
  RATDTL.RATLINSERNUM ,
  RATDTL.NUMPCS ,
  RATDTL.GRSWGT ,
  RATDTL.CHGWGT ,
  RATDTL.NETCHG ,
  RATDTL.IATRAT ,
  RATDTL.IATCHG ,
  RATDTL.IATRATCLS ,
  RATDTL.ARLRAT ,
  RATDTL.ARLRATCLS ,
  SHPACC.VALCCCHG,
  SHPACC.VALPPCHG,
  SHPACC.TAXCCF,
  SHPACC.TAXPPD,
  MIS.SHPSIG,
  MIS.SCICOD,
  MIS.AGTREF,
  COALESCE ( EXPFLT.FLTCARCOD,FLTBOK.CARCOD) EXPFLTCARCOD,
  COALESCE(EXPFLT.FLTNUM , FLTBOK.FLTNUM) EXPFLTNUM ,
  COALESCE (EXPFLT.FLTDAT ,FLTBOK.FLTDAT) EXPFLTDAT ,
  EXPFLT.FLTSEQNUM EXPFLTSEQNUM,
  EXPFLT.FLTCARIDR EXPFLTCAIDR,
  FLTSEG.POL
  ||'-'
  ||FLTSEG.POU EXPROUTE ,
  NULL BKGFLTCARCOD,
  NULL BKGFLTNUM,
  NULL BKGFLTDAT,
  NULL BKGFLTSEQNUM,
  NULL BKGFLTCARIDR,
  NULL BKGROUTE,
  SHPACC.ACCINF RMK,
  ACC.ACCINFIDR,
  MIS.AGTPLC,
  (SELECT LISTAGG(SRV.OTHSRVINF, ';') WITHIN GROUP (
  ORDER BY SRV.OTHSRVINF DESC)
  FROM OPRSHPOTHSRV SRV
  WHERE SHPMST.MSTDOCNUM =SRV.MSTDOCNUM
  AND SHPMST.DOCOWRIDR   =SRV.DOCOWRIDR
  AND SHPMST.DUPNUM      =SRV.DUPNUM
  AND SHPMST.SEQNUM      =SRV.SEQNUM
  AND SHPMST.CMPCOD      =SRV.CMPCOD
  ) OTHSRVINF,
  (SELECT LISTAGG(SRVREQ.SPLSRVREQ,';') WITHIN GROUP (
  ORDER BY SRVREQ.SPLSRVREQ)
  FROM OPRSHPSPLSRVREQ SRVREQ
  WHERE SHPMST.MSTDOCNUM =SRVREQ.MSTDOCNUM
  AND SHPMST.DOCOWRIDR   =SRVREQ.DOCOWRIDR
  AND SHPMST.DUPNUM      =SRVREQ.DUPNUM
  AND SHPMST.SEQNUM      =SRVREQ.SEQNUM
  AND SHPMST.CMPCOD      =SRVREQ.CMPCOD
  ) SPLSRVREQ,
  (SELECT LISTAGG(DIM.PCSLEN
    || '-'
    || DIM.PCSWID
    || '-'
    || DIM.PCSHGT
    || '/'
    || DIM.NUMPCS
    || '/'
    || DIM.WGT ,';;') WITHIN GROUP (
  ORDER BY DIM.NUMPCS)
  FROM OPRSHPDIMDTL DIM
  WHERE SHPMST.MSTDOCNUM  =DIM.MSTDOCNUM
  AND SHPMST.DOCOWRIDR    =DIM.DOCOWRIDR
  AND SHPMST.DUPNUM       =DIM.DUPNUM
  AND SHPMST.SEQNUM       =DIM.SEQNUM
  AND RATDTL.RATLINSERNUM =DIM.RATLINSERNUM
  AND SHPMST.CMPCOD       =DIM.CMPCOD
  ) DIMENSION,
  OTHPPT.CMPDSG OTHCMPDSG,
  OTHPPT.OFFCTY OTHOFFCTY,
  OTHPPT.OFFDSG OTHOFFDSG,
  OTHPPT.OFFFILREF OTHOFFFILREF,
  OTHPPT.PPTCOD OTHPPTCOD,
  OTHPPT.PPTCTY OTHPPTCTY,
  OTHPPT.PPTNAM OTHPPTNAM,
  (SELECT LISTAGG( DSTCOD,'-') WITHIN GROUP(
  ORDER BY RTGSERNUM)
  FROM OPRSHPRTG SHPRTG
  WHERE SHPMST.MSTDOCNUM =SHPRTG.MSTDOCNUM
  AND SHPMST.DOCOWRIDR   =SHPRTG.DOCOWRIDR
  AND SHPMST.DUPNUM      =SHPRTG.DUPNUM
  AND SHPMST.SEQNUM      =SHPRTG.SEQNUM
  AND SHPMST.CMPCOD      =SHPRTG.CMPCOD
  ) AWBROUTE,
  (SELECT LISTAGG(CHG.CHDCOD, ';') WITHIN GROUP (
  ORDER BY CHG.CHGHEDIDR DESC)
  FROM OPRSHPCHGDTL CHG
  WHERE SHPMST.MSTDOCNUM =CHG.MSTDOCNUM
  AND SHPMST.DOCOWRIDR   =CHG.DOCOWRIDR
  AND SHPMST.DUPNUM      =CHG.DUPNUM
  AND SHPMST.SEQNUM      =CHG.SEQNUM
  AND SHPMST.CMPCOD      =CHG.CMPCOD
  ) CHARGNAM,
  (SELECT LISTAGG( SHPRTG.DSTCOD
    || SHPRTG.FLTCARCOD,'/') WITHIN GROUP(
  ORDER BY RTGSERNUM)
  FROM OPRSHPRTG SHPRTG
  WHERE SHPMST.MSTDOCNUM =SHPRTG.MSTDOCNUM
  AND SHPMST.DOCOWRIDR   =SHPRTG.DOCOWRIDR
  AND SHPMST.DUPNUM      =SHPRTG.DUPNUM
  AND SHPMST.SEQNUM      =SHPRTG.SEQNUM
  AND SHPMST.CMPCOD      =SHPRTG.CMPCOD
  ) ONWARDDSTCAR
FROM OPRSHPMST SHPMST
JOIN OPRSHPRATDTL RATDTL
ON ( SHPMST.DOCOWRIDR =RATDTL.DOCOWRIDR
AND SHPMST.MSTDOCNUM  =RATDTL.MSTDOCNUM
AND SHPMST.CMPCOD     = RATDTL.CMPCOD
AND SHPMST.DUPNUM     = RATDTL.DUPNUM
AND SHPMST.SEQNUM     = RATDTL.SEQNUM)
JOIN OPRSHPMSTACC SHPACC
ON(SHPMST.DOCOWRIDR  =SHPACC.DOCOWRIDR
AND SHPMST.MSTDOCNUM =SHPACC.MSTDOCNUM
AND SHPMST.CMPCOD    = SHPACC.CMPCOD
AND SHPMST.DUPNUM    = SHPACC.DUPNUM
AND SHPMST.SEQNUM    = SHPACC.SEQNUM )
LEFT OUTER JOIN OPRSHPNFY NFY
ON(SHPMST.DOCOWRIDR  = NFY.DOCOWRIDR
AND SHPMST.MSTDOCNUM = NFY.MSTDOCNUM
AND SHPMST.CMPCOD    = NFY.CMPCOD
AND SHPMST.DUPNUM    = NFY.DUPNUM
AND SHPMST.SEQNUM    = NFY.SEQNUM)
LEFT OUTER JOIN OPRSHPOTHPPT OTHPPT
ON(SHPMST.DOCOWRIDR  = OTHPPT.DOCOWRIDR
AND SHPMST.MSTDOCNUM = OTHPPT.MSTDOCNUM
AND SHPMST.CMPCOD    = OTHPPT.CMPCOD
AND SHPMST.DUPNUM    = OTHPPT.DUPNUM
AND SHPMST.SEQNUM    = OTHPPT.SEQNUM)
LEFT OUTER JOIN OPRSHPOCI OCI
ON(SHPMST.MSTDOCNUM  = OCI.MSTDOCNUM
AND SHPMST.DOCOWRIDR = OCI.DOCOWRIDR
AND SHPMST.DUPNUM    = OCI.DUPNUM
AND SHPMST.SEQNUM    = OCI.SEQNUM
AND SHPMST.CMPCOD    = OCI.CMPCOD)
LEFT OUTER JOIN OPRSHPFLTBOK FLTBOK
ON(SHPMST.MSTDOCNUM  = FLTBOK.MSTDOCNUM
AND SHPMST.DOCOWRIDR = FLTBOK.DOCOWRIDR
AND SHPMST.DUPNUM    = FLTBOK.DUPNUM
AND SHPMST.SEQNUM    = FLTBOK.SEQNUM
AND SHPMST.CMPCOD    = FLTBOK.CMPCOD)
LEFT OUTER JOIN OPRSHPACCDTL ACC
ON(SHPMST.MSTDOCNUM  = ACC.MSTDOCNUM
AND SHPMST.DOCOWRIDR = ACC.DOCOWRIDR
AND SHPMST.DUPNUM    = ACC.DUPNUM
AND SHPMST.SEQNUM    = ACC.SEQNUM
AND SHPMST.CMPCOD    = ACC.CMPCOD)
LEFT OUTER JOIN OPRSHPMSTMIS MIS
ON(SHPMST.MSTDOCNUM  = MIS.MSTDOCNUM
AND SHPMST.DOCOWRIDR = MIS.DOCOWRIDR
AND SHPMST.DUPNUM    = MIS.DUPNUM
AND SHPMST.SEQNUM    = MIS.SEQNUM
AND SHPMST.CMPCOD    = MIS.CMPCOD)
LEFT OUTER JOIN OPRSHPRTG RTG
ON(SHPMST.MSTDOCNUM  =RTG.MSTDOCNUM
AND SHPMST.DOCOWRIDR =RTG.DOCOWRIDR
AND SHPMST.DUPNUM    =RTG.DUPNUM
AND SHPMST.SEQNUM    =RTG.SEQNUM
AND SHPMST.CMPCOD    =RTG.CMPCOD)
LEFT OUTER JOIN OPRSHPMSTCNT CNT
ON(SHPMST.MSTDOCNUM  =CNT.MSTDOCNUM
AND SHPMST.DOCOWRIDR =CNT.DOCOWRIDR
AND SHPMST.DUPNUM    =CNT.DUPNUM
AND SHPMST.SEQNUM    =CNT.SEQNUM
AND SHPMST.CMPCOD    =CNT.CMPCOD)
LEFT OUTER JOIN OPRSHPCHGDTL CHGDTL
ON(SHPMST.DOCOWRIDR  = CHGDTL.DOCOWRIDR
AND SHPMST.MSTDOCNUM = CHGDTL.MSTDOCNUM
AND SHPMST.CMPCOD    = CHGDTL.CMPCOD
AND SHPMST.DUPNUM    = CHGDTL.DUPNUM
AND SHPMST.SEQNUM    = CHGDTL.SEQNUM)
LEFT OUTER JOIN OPRSHPCNT SHPCNT
ON (SHPMST.DOCOWRIDR =SHPCNT.DOCOWRIDR
AND SHPMST.MSTDOCNUM =SHPCNT.MSTDOCNUM
AND SHPMST.CMPCOD    = SHPCNT.CMPCOD
AND SHPMST.DUPNUM    = SHPCNT.DUPNUM
AND SHPMST.SEQNUM    = SHPCNT.SEQNUM)
JOIN OPRSEGSHP SEGSHP
ON( SHPMST.DOCOWRIDR =SEGSHP.DOCOWRIDR
AND SHPMST.MSTDOCNUM =SEGSHP.MSTDOCNUM
AND SHPMST.CMPCOD    = SEGSHP.CMPCOD
AND SHPMST.DUPNUM    = SEGSHP.DUPNUM
AND SHPMST.SEQNUM    = SEGSHP.SEQNUM)
JOIN OPRFLTSEG FLTSEG
ON( SEGSHP.FLTNUM    = FLTSEG.FLTNUM
AND SEGSHP.FLTCARIDR =FLTSEG.FLTCARIDR
AND SEGSHP.FLTSEQNUM =FLTSEG.FLTSEQNUM
AND SEGSHP.SEGSERNUM = FLTSEG.SEGSERNUM
AND SEGSHP.CMPCOD    = FLTSEG.CMPCOD
AND SHPMST.ORGCOD    = FLTSEG.POL )
JOIN OPRARPEXPFLT EXPFLT
ON( FLTSEG.FLTNUM    = EXPFLT.FLTNUM
AND FLTSEG.FLTCARIDR = EXPFLT.FLTCARIDR
AND FLTSEG.FLTSEQNUM = EXPFLT.FLTSEQNUM
AND FLTSEG.CMPCOD    = EXPFLT.CMPCOD
AND SHPMST.ORGCOD    = EXPFLT.ARPCOD)
AND (SHPCNT.CNTTYP  ='N' OR SHPCNT.CNTTYP IS NULL)
AND SHPMST.CMPCOD  = ?
AND EXPFLT.FLTDAT >= ?
AND EXPFLT.FLTDAT <= ?
UNION
SELECT SHPACC.CMSPCT,
  MIS.PPTCOD,
  MIS.PPTCTY,
  MIS.SNDDSG,
  MIS.SNDCMPDSG,
  MIS.SNDCTY,
  RTG.DSTCOD ONWDST,
  RTG.FLTCARCOD ONWCAR,
  SHPMST.EXEUSRCOD,
  OCI.CNTCOD,
  OCI.INFIDF,
  OCI.CUSINFIDF,
  OCI.CUSINF,
  MIS.SHPINFONE,
  MIS.SHPINFTWO,
  MIS.NOMHDLPTY,
  MIS.NOMHDLPTYPLC,
  CNT.SHPREFNUM,
  SHPACC.DSTCNVRAT,
  SHPACC.DSTCURCOD,
  SHPACC.DSTCCFCHG,
  SHPACC.DSTCHG,
  SHPACC.TOTDSTCCFCHG,
  SHPACC.CMSAMT,
  SHPACC.CMSCASIND,
  SHPACC.CMSCCF,
  SHPACC.SALINCAMT,
  SHPMST.ORGCOD ,
  SHPMST.AGTNAM ,
  SHPMST.MSTDOCNUM ,
  SHPMST.DOCOWRIDR ,
  SHPMST.SEQNUM ,
  SHPMST.CMPCOD ,
  SHPMST.DUPNUM ,
  SHPMST.SHPPFX ,
  SHPMST.DSTCOD ,
  SHPMST.EXEDAT ,
  SHPMST.STDWGTCOD,
  RATDTL.GRSVOL,
  SHPMST.GRSVOLUNT,
  SHPMST.SHPADRONE,
  SHPMST.CNSADRONE,
  SHPACC.IATCOD,
  SHPMST.PAYTYP,
  SHPACC.DVLCAR,
  SHPACC.DVLCUS,
  SHPACC.INSAMT,
  CNT.SHPACCNUM,
  CNT.SHPTELNUM,
  CNT.CNSACCNUM,
  CNT.CNSTELNUM,
  SHPACC.AGTACCNUM,
  SHPACC.CASCOD,
  NFY.NFYNAM,
  NFY.NFYACCNUM,
  NFY.NFYADRONE,
  NFY.NFYADRTWO,
  NFY.NFYCTY,
  NFY.NFYCTR,
  NFY.NFYMALIDR,
  NFY.NFYPSTCOD,
  NFY.NFYSTT,
  SHPCNT.CNTVAL  NFYTELNUM,
  ACC.ACCINF,
  RATDTL.CMDITMNUM,
  RATDTL.CMDITMNAM,
  SHPMST.SLCPCS,
  RATDTL.HRMCMDCOD,
  RATDTL.CTRORG,
  RATDTL.SRVCOD,
  NVL(SHPMST.SCCCOD,BKGDTL.SCCCOD) SCCCOD ,
  SHPMST.EXESTN ,
  SHPMST.SHPDES ,
  COALESCE(SHPMST.CURCOD ,
  (SELECT SYSPAR.PARVAL
  FROM SHRSYSPAR SYSPAR
  WHERE SYSPAR.PARCOD='system.defaults.unit.currency'
  AND SYSPAR.CMPCOD  =SHPMST.CMPCOD
  )) CURCOD ,
  SHPMST.SHPNAM ,
  SHPMST.CNSNAM ,
  CHGDTL.TAX CHGDTLTAX ,
  CHGDTL.CHDCOD ,
  CHGDTL.CHGAMT,
  CHGDTL.CHGHED ,
  CHGDTL.DUECARFLG ,
  CHGDTL.DUEAGTFLG ,
  RATDTL.TAX RATDTLTAX ,
  RATDTL.RATLINSERNUM ,
  RATDTL.NUMPCS ,
  RATDTL.GRSWGT ,
  RATDTL.CHGWGT ,
  RATDTL.NETCHG ,
  RATDTL.IATRAT ,
  RATDTL.IATCHG ,
  RATDTL.IATRATCLS ,
  RATDTL.ARLRAT ,
  RATDTL.ARLRATCLS ,
  SHPACC.VALCCCHG,
  SHPACC.VALPPCHG,
  SHPACC.TAXCCF,
  SHPACC.TAXPPD,
  MIS.SHPSIG,
  MIS.SCICOD,
  MIS.AGTREF,
  NULL EXPFLTCARCOD,
  NULL EXPFLTNUM ,
  NULL EXPFLTDAT ,
  NULL EXPFLTSEQNUM,
  NULL EXPFLTCARIDR,
  NULL EXPROUTE ,
  COALESCE ( BKGFLTDTL.FLTCARCOD,FLTBOK.CARCOD) BKGFLTCARCOD,
  COALESCE(BKGFLTDTL.FLTNUM , FLTBOK.FLTNUM) BKGFLTNUM ,
  COALESCE (BKGFLTDTL.FLTDAT ,FLTBOK.FLTDAT) BKGFLTDAT ,
  BKGFLTDTL.FLTSEQNUM BKGFLTSEQNUM ,
  BKGFLTDTL.FLTCARIDR BKGFLTCARIDR,
  BKGFLTDTL.FLTORG
  ||'-'
  ||BKGFLTDTL.FLTDST BKGROUTE ,
  NVL(SHPACC.ACCINF,BKGMST.SHPRMK) RMK,
  ACC.ACCINFIDR,
  MIS.AGTPLC,
  (SELECT LISTAGG(SRV.OTHSRVINF, ';') WITHIN GROUP (
  ORDER BY SRV.OTHSRVINF DESC)
  FROM OPRSHPOTHSRV SRV
  WHERE SHPMST.MSTDOCNUM =SRV.MSTDOCNUM
  AND SHPMST.DOCOWRIDR   =SRV.DOCOWRIDR
  AND SHPMST.DUPNUM      =SRV.DUPNUM
  AND SHPMST.SEQNUM      =SRV.SEQNUM
  AND SHPMST.CMPCOD      =SRV.CMPCOD
  ) OTHSRVINF,
  (SELECT LISTAGG(SRVREQ.SPLSRVREQ,';') WITHIN GROUP (
  ORDER BY SRVREQ.SPLSRVREQ)
  FROM OPRSHPSPLSRVREQ SRVREQ
  WHERE SHPMST.MSTDOCNUM =SRVREQ.MSTDOCNUM
  AND SHPMST.DOCOWRIDR   =SRVREQ.DOCOWRIDR
  AND SHPMST.DUPNUM      =SRVREQ.DUPNUM
  AND SHPMST.SEQNUM      =SRVREQ.SEQNUM
  AND SHPMST.CMPCOD      =SRVREQ.CMPCOD
  ) SPLSRVREQ,
  (SELECT LISTAGG(DIM.PCSLEN
    || '-'
    || DIM.PCSWID
    || '-'
    || DIM.PCSHGT
    || '/'
    || DIM.NUMPCS
    || '/'
    || DIM.WGT ,';;') WITHIN GROUP (
  ORDER BY DIM.NUMPCS)
  FROM OPRSHPDIMDTL DIM
  WHERE SHPMST.MSTDOCNUM  =DIM.MSTDOCNUM
  AND SHPMST.DOCOWRIDR    =DIM.DOCOWRIDR
  AND SHPMST.DUPNUM       =DIM.DUPNUM
  AND SHPMST.SEQNUM       =DIM.SEQNUM
  AND RATDTL.RATLINSERNUM =DIM.RATLINSERNUM
  AND SHPMST.CMPCOD       =DIM.CMPCOD
  ) DIMENSION,
  OTHPPT.CMPDSG OTHCMPDSG,
  OTHPPT.OFFCTY OTHOFFCTY,
  OTHPPT.OFFDSG OTHOFFDSG,
  OTHPPT.OFFFILREF OTHOFFFILREF,
  OTHPPT.PPTCOD OTHPPTCOD,
  OTHPPT.PPTCTY OTHPPTCTY,
  OTHPPT.PPTNAM OTHPPTNAM,
  (SELECT LISTAGG( DSTCOD,'-') WITHIN GROUP(
  ORDER BY RTGSERNUM)
  FROM OPRSHPRTG SHPRTG
  WHERE SHPMST.MSTDOCNUM =SHPRTG.MSTDOCNUM
  AND SHPMST.DOCOWRIDR   =SHPRTG.DOCOWRIDR
  AND SHPMST.DUPNUM      =SHPRTG.DUPNUM
  AND SHPMST.SEQNUM      =SHPRTG.SEQNUM
  AND SHPMST.CMPCOD      =SHPRTG.CMPCOD
  ) AWBROUTE,
  (SELECT LISTAGG(CHG.CHDCOD, ';') WITHIN GROUP (
  ORDER BY CHG.CHGHEDIDR DESC)
  FROM OPRSHPCHGDTL CHG
  WHERE SHPMST.MSTDOCNUM =CHG.MSTDOCNUM
  AND SHPMST.DOCOWRIDR   =CHG.DOCOWRIDR
  AND SHPMST.DUPNUM      =CHG.DUPNUM
  AND SHPMST.SEQNUM      =CHG.SEQNUM
  AND SHPMST.CMPCOD      =CHG.CMPCOD
  ) CHARGNAM,
  (SELECT LISTAGG( SHPRTG.DSTCOD
    || SHPRTG.FLTCARCOD,'/') WITHIN GROUP(
  ORDER BY RTGSERNUM)
  FROM OPRSHPRTG SHPRTG
  WHERE SHPMST.MSTDOCNUM =SHPRTG.MSTDOCNUM
  AND SHPMST.DOCOWRIDR   =SHPRTG.DOCOWRIDR
  AND SHPMST.DUPNUM      =SHPRTG.DUPNUM
  AND SHPMST.SEQNUM      =SHPRTG.SEQNUM
  AND SHPMST.CMPCOD      =SHPRTG.CMPCOD
  ) ONWARDDSTCAR
FROM OPRSHPMST SHPMST
JOIN OPRSHPRATDTL RATDTL
ON ( SHPMST.DOCOWRIDR =RATDTL.DOCOWRIDR
AND SHPMST.MSTDOCNUM  =RATDTL.MSTDOCNUM
AND SHPMST.CMPCOD     = RATDTL.CMPCOD
AND SHPMST.DUPNUM     = RATDTL.DUPNUM
AND SHPMST.SEQNUM     = RATDTL.SEQNUM)
JOIN OPRSHPMSTACC SHPACC
ON(SHPMST.DOCOWRIDR  =SHPACC.DOCOWRIDR
AND SHPMST.MSTDOCNUM =SHPACC.MSTDOCNUM
AND SHPMST.CMPCOD    = SHPACC.CMPCOD
AND SHPMST.DUPNUM    = SHPACC.DUPNUM
AND SHPMST.SEQNUM    = SHPACC.SEQNUM )
LEFT OUTER JOIN OPRSHPOTHPPT OTHPPT
ON(SHPMST.DOCOWRIDR  = OTHPPT.DOCOWRIDR
AND SHPMST.MSTDOCNUM = OTHPPT.MSTDOCNUM
AND SHPMST.CMPCOD    = OTHPPT.CMPCOD
AND SHPMST.DUPNUM    = OTHPPT.DUPNUM
AND SHPMST.SEQNUM    = OTHPPT.SEQNUM)
LEFT OUTER JOIN OPRSHPOCI OCI
ON(SHPMST.MSTDOCNUM  = OCI.MSTDOCNUM
AND SHPMST.DOCOWRIDR = OCI.DOCOWRIDR
AND SHPMST.DUPNUM    = OCI.DUPNUM
AND SHPMST.SEQNUM    = OCI.SEQNUM
AND SHPMST.CMPCOD    = OCI.CMPCOD)
LEFT OUTER JOIN OPRSHPFLTBOK FLTBOK
ON(SHPMST.MSTDOCNUM  = FLTBOK.MSTDOCNUM
AND SHPMST.DOCOWRIDR = FLTBOK.DOCOWRIDR
AND SHPMST.DUPNUM    = FLTBOK.DUPNUM
AND SHPMST.SEQNUM    = FLTBOK.SEQNUM
AND SHPMST.CMPCOD    = FLTBOK.CMPCOD)
LEFT OUTER JOIN OPRSHPACCDTL ACC
ON(SHPMST.MSTDOCNUM  = ACC.MSTDOCNUM
AND SHPMST.DOCOWRIDR = ACC.DOCOWRIDR
AND SHPMST.DUPNUM    = ACC.DUPNUM
AND SHPMST.SEQNUM    = ACC.SEQNUM
AND SHPMST.CMPCOD    = ACC.CMPCOD)
LEFT OUTER JOIN OPRSHPNFY NFY
ON(SHPMST.DOCOWRIDR  = NFY.DOCOWRIDR
AND SHPMST.MSTDOCNUM = NFY.MSTDOCNUM
AND SHPMST.CMPCOD    = NFY.CMPCOD
AND SHPMST.DUPNUM    = NFY.DUPNUM
AND SHPMST.SEQNUM    = NFY.SEQNUM)
LEFT OUTER JOIN OPRSHPMSTMIS MIS
ON(SHPMST.MSTDOCNUM  = MIS.MSTDOCNUM
AND SHPMST.DOCOWRIDR = MIS.DOCOWRIDR
AND SHPMST.DUPNUM    = MIS.DUPNUM
AND SHPMST.SEQNUM    = MIS.SEQNUM
AND SHPMST.CMPCOD    = MIS.CMPCOD)
LEFT OUTER JOIN OPRSHPRTG RTG
ON(SHPMST.MSTDOCNUM  =RTG.MSTDOCNUM
AND SHPMST.DOCOWRIDR =RTG.DOCOWRIDR
AND SHPMST.DUPNUM    =RTG.DUPNUM
AND SHPMST.SEQNUM    =RTG.SEQNUM
AND SHPMST.CMPCOD    =RTG.CMPCOD)
LEFT OUTER JOIN OPRSHPMSTCNT CNT
ON(SHPMST.MSTDOCNUM  =CNT.MSTDOCNUM
AND SHPMST.DOCOWRIDR =CNT.DOCOWRIDR
AND SHPMST.DUPNUM    =CNT.DUPNUM
AND SHPMST.SEQNUM    =CNT.SEQNUM
AND SHPMST.CMPCOD    =CNT.CMPCOD)
LEFT OUTER JOIN OPRSHPCHGDTL CHGDTL
ON(SHPMST.DOCOWRIDR  = CHGDTL.DOCOWRIDR
AND SHPMST.MSTDOCNUM = CHGDTL.MSTDOCNUM
AND SHPMST.CMPCOD    = CHGDTL.CMPCOD
AND SHPMST.DUPNUM    = CHGDTL.DUPNUM
AND SHPMST.SEQNUM    = CHGDTL.SEQNUM)
LEFT OUTER JOIN OPRSHPCNT SHPCNT
ON (SHPMST.DOCOWRIDR =SHPCNT.DOCOWRIDR
AND SHPMST.MSTDOCNUM =SHPCNT.MSTDOCNUM
AND SHPMST.CMPCOD    = SHPCNT.CMPCOD
AND SHPMST.DUPNUM    = SHPCNT.DUPNUM
AND SHPMST.SEQNUM    = SHPCNT.SEQNUM)
JOIN CAPBKGDTL BKGDTL
ON( BKGDTL.CMPCOD = shpmst.CMPCOD
AND BKGDTL.UBRNUM =SHPMST.UBRNUM )
JOIN CAPBKGMST BKGMST
ON( bkgmst.CMPCOD = shpmst.CMPCOD
AND bkgmst.ubrnum =shpmst.ubrnum )
JOIN CAPBKGFLTDTL BKGFLTDTL
ON( SHPMST.CMPCOD     = BKGFLTDTL.CMPCOD
AND SHPMST.MSTDOCNUM  =BKGFLTDTL.MSTDOCNUM
AND SHPMST.DOCOWRIDR  =BKGFLTDTL.DOCOWRIDR
AND SHPMST.SEQNUM     =BKGFLTDTL.SEQNUM
AND SHPMST.DUPNUM     =BKGFLTDTL.DUPNUM)
AND (SHPCNT.CNTTYP  ='N' OR SHPCNT.CNTTYP IS NULL)
AND SHPMST.CMPCOD  = ?
AND BKGFLTDTL.FLTDAT >= ?
and BKGFLTDTL.FLTDAT<= ?
			
	]]>
		</QRY:Source>
	</QRY:Definition>
<QRY:Definition>
	<QRY:Id>426</QRY:Id>
	<QRY:Source Name="operations.shipment.cto.findactualclearingagent" Type="NATIVE">
		<![CDATA[
			SELECT N.CUSAGTCOD
			FROM
			  (SELECT L.CMPCOD,
				L.DOCOWRIDR,
				L.MSTDOCNUM,
				L.DUPNUM,
				L.SEQNUM,
				L.CUSAGTCOD,
				COUNT(*) OVER( PARTITION BY L.MSTDOCNUM, L.DOCOWRIDR, L.SEQNUM, L.DUPNUM, L.CMPCOD) TOTALCOUNT
			  FROM
				(SELECT K.CMPCOD,
				  K.DOCOWRIDR,
				  K.MSTDOCNUM,
				  K.DUPNUM,
				  K.SEQNUM,
				  K.AGTCOD,
				  K.SCCCOD,
				  K.CNSCOD,
				  K.CNSNAM,
				  K.SCCMATVAL,
				  K.CUSSCCCOD,
				  K.CUSAGTCOD,
				  K.CUSCOD,
				  K.CUSPRI,
				  K.CUSMAXPRI
				FROM
				  (SELECT M.CMPCOD,
					M.DOCOWRIDR,
					M.MSTDOCNUM,
					M.DUPNUM,
					M.SEQNUM,
					M.AGTCOD,
					M.SCCCOD,
					M.CNSCOD,
					M.CNSNAM,
					M.SCCMATVAL,
					M.CUSSCCCOD,
					M.CUSAGTCOD,
					M.CUSCOD,
					M.CUSPRI,
					MAX(M.CUSPRI) OVER(PARTITION BY M.MSTDOCNUM, M.DOCOWRIDR, M.SEQNUM, M.DUPNUM, M.CMPCOD) CUSMAXPRI
				  FROM
					(SELECT Q.CMPCOD,
					  Q.DOCOWRIDR,
					  Q.MSTDOCNUM,
					  Q.DUPNUM,
					  Q.SEQNUM,
					  Q.AGTCOD,
					  Q.SCCCOD,
					  Q.CNSCOD,
					  Q.CNSNAM,
					  Q.SCCMATVAL,
					  Q.CUSSCCCOD,
					  Q.CUSAGTCOD,
					  Q.CUSCOD,
					  CASE
						WHEN Q.SCCMATVAL > 0
						AND Q.CUSSCCCOD IS NOT NULL
						THEN 2
						WHEN Q.CUSSCCCOD IS NULL
						THEN 0
						ELSE -1
					  END CUSPRI
					FROM
					  (SELECT shpmst.CMPCOD,
						shpmst.DOCOWRIDR,
						shpmst.MSTDOCNUM,
						SHPMST.DUPNUM,
						SHPMST.SEQNUM,
						Pkg_Frmwrk.Fun_String_Check(SHPMST.SCCCOD,CUSAGT.SCCCOD,',') SCCMATVAL,
						CUSAGT.SCCCOD CUSSCCCOD,
						CUSAGT.AGTCOD CUSAGTCOD,
						CUSAGT.CUSCOD,
						SHPMST.AGTCOD,
						SHPMST.SCCCOD,
						SHPMST.CNSCOD,
						SHPMST.CNSNAM
					  FROM oprshpmst shpmst
					  INNER JOIN OPRARPSHP ARPSHP
					  ON SHPMST.CMPCOD     = ARPSHP.CMPCOD
					  AND SHPMST.DOCOWRIDR = ARPSHP.DOCOWRIDR
					  AND SHPMST.MSTDOCNUM = ARPSHP.MSTDOCNUM
					  AND SHPMST.DUPNUM    = ARPSHP.DUPNUM
					  AND SHPMST.SEQNUM    = ARPSHP.SEQNUM
					  LEFT OUTER JOIN SHRCUSAGT CUSAGT
					  ON SHPMST.CMPCOD                                                                          = CUSAGT.CMPCOD
					  AND SHPMST.CNSCOD                                                                         = CUSAGT.CUSCOD
					  AND CUSAGT.IMPFLG                                                                         = 'Y'
					  AND COALESCE(CUSAGT.STNCOD, ARPSHP.ARPCOD)                                                = ARPSHP.ARPCOD
					  AND Pkg_Frmwrk.Fun_String_Check(SHPMST.SCCCOD,COALESCE(CUSAGT.SCCCOD, SHPMST.SCCCOD),',') > 0
					  WHERE shpmst.cmpcod                                                                       = ?
					  AND arpshp.arpcod                                                                         = ?
					  AND SHPMST.DOCOWRIDR                                                                      = ?
					  AND SHPMST.MSTDOCNUM                                                                      = ?
					  AND SHPMST.DUPNUM                                                                         = ?
					  )Q
					)M
				  ) K
				WHERE K.CUSMAXPRI = K.CUSPRI
				)L
			  )N
			WHERE N.TOTALCOUNT = 1
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	 <QRY:Id>427</QRY:Id>
	 <QRY:Source Name="operations.shipment.findshipmentblockdetailswithairportcode" Type="NATIVE">
	 	<![CDATA[
		SELECT BLK.TRKNUM,BLK.ARPCOD,MST.CMPCOD,MST.DOCOWRIDR,MST.MSTDOCNUM,MST.DUPNUM,
			MST.SEQNUM,MST.DOCNUM,BLK.SERNUM,BLK.BLKAUT,BLK.BLKSTRDAT,BLK.BLKSERNUM,
			BLK.BLKEXPDAT,BLK.BLKSTA,BLK.BLKUSR,BLK.BLKRMK,BLK.LSTUPDTIM,BLK.LSTUPDUSR,BLK.AUTNAM,
			MST.ORGCOD,MST.DSTCOD,MST.SCCCOD,MST.STDPCS,MST.CONFLG, MST.STDWGT,MST.STDWGTCOD,MST.SHPDES,BLK.BLKTXNCOD,BLK.RELDAT,MST.SHPPFX,MST.PRDNAM,MST.AGTCOD,MST.CNSCOD,MST.SHPCOD
		FROM OPRSHPMST  MST,
		(SELECT B.CMPCOD,B.DOCOWRIDR,B.MSTDOCNUM,B.DUPNUM,B.SEQNUM,B.SERNUM,
			B.ARPCOD,B.BLKAUT,B.BLKSTRDAT,B.BLKEXPDAT,B.BLKSTA,B.BLKUSR,
			B.BLKRMK,B.LSTUPDTIM,B.LSTUPDUSR,A.AUTNAM,B.TRKNUM,B.BLKTXNCOD,B.BLKSERNUM,B.RELDAT
		FROM OPRSHPBLK B,OPRBLKAUT A
		WHERE  A.CMPCOD = B.CMPCOD
		AND A.AUTCOD = B.BLKAUT
		]]>
	 </QRY:Source>
	</QRY:Definition>
</QRY:Definitions>
