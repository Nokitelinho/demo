<?xml version="1.0"?>
<QRY:Definitions xmlns:QRY="http://www.ibsplc.com/xibase/persistence/queries" module="operations.cooltool">
	
	<QRY:Definition>
	<QRY:Id>1</QRY:Id>
	<QRY:Source Name="operations.cooltool.findCommercialCoolShipmentDetails" Type="NATIVE">
		<![CDATA[ 
					SELECT MST.CMPCOD,
						MST.MSTDOCNUM,
						MST.DOCOWRIDR,
						MST.DUPNUM,
						MST.SEQNUM,
						MST.SHPPFX COMSHPPFX,
						MST.ORGCOD,
						MST.DSTCOD,
						MST.PRDCOD,
						MST.PRDNAM,
						MST.SHPCOD,
						MST.SHPNAM,
						BKG.CUSNAM,
						MST.SCCCOD,
						MST.SHPDES,
						MST.STDPCS,
						MST.STDWGT,
						MST.CPTDAT SHPCPTDAT,
						BKG.SHPRDYTIM PLNLAT,
						BKG.SHPDLVTIM PLNTOA,
						OTH.OTHSRVINF,
						COLSHP.SEQNUM COLSEQNUM,
						COALESCE (COLSHP.COMMSTDOCNUM,MST.MSTDOCNUM) COMMSTDOCNUM,
						COALESCE (COLSHP.COMDOCOWRIDR,MST.DOCOWRIDR) COMDOCOWRIDR,
						COALESCE (COLSHP.COMDUPNUM,MST.DUPNUM) COMDUPNUM,
						COALESCE (COLSHP.COMSEQNUM,MST.SEQNUM) COMSEQNUM,						
						COLSHP.POSSHPPFX,
						COLSHP.POSMSTDOCNUM,
						COLSHP.POSDOCOWRIDR,
						COLSHP.POSDUPNUM,
						COLSHP.POSSEQNUM,
						COLSHP.REPSHPPFX,
						COLSHP.REPMSTDOCNUM,
						COLSHP.REPDOCOWRIDR,
						COLSHP.REPDUPNUM,
						COLSHP.REPSEQNUM,
						COLSHP.COLRMK,
						COLDTL.CMPCOD COLDTLCMPCOD,
						COLDTL.COLSEQNUM COLDTLSEQNUM, 
						COLDTL.SERNUM COLDTLSERNUM, 
						COLDTL.DATREF003, COLDTL.DATREF010, 
						COLDTL.DATREF009,    
						COLDTL.DATREF001,
						COLDTL.DATREF007,
						COLDTL.DATREF002,
						COLDTL.DATREF008,
						COLDTL.DATREF004,
						COLDTL.DATREF005,
						COLDTL.DATREF006,
						COLSHP.ARLSOLDAT,      
						COLSHP.CUSSOLDAT,      
						COLSHP.ARLEOLDAT,     
						COLSHP.CUSEOLDAT, 
						COLSHP.LSTUPDUSR,
						COLSHP.LSTUPDTIM,
						COLSHP.CRTTIM,
						COLSHP.CRTUSR, 
						COLSHP.CRTSTN,
						COLSHP.SHPNAM COOLSHIPPER,
						COLSHP.SPRVSNFLG,
						COLSHP.MAXRAPDRYICEWGT,
						COLSHP.MAXRKNDRYICEWGT,
						COLSHP.CTTNAM,
						COLSHP.CTTPHNNUM,
						COLSHP.CTTEMLADR,
						BKG.BKGSTA,
						BKG.HDLINF, 
						BKG.SHPRMK,
						AUT.AUTNAM,
						BLK.BLKAUT,
						BLK.ARPCOD,
						BLK.BLKSTA,
						BLK.BLKEXPDAT,
						BLK.BLKRMK,
						BLK.SERNUM BLKSERNUM,
						DTL.ACPARPCOD,
						MVTDTL.CMPCOD MVTCMPCOD,
						MVTDTL.SEQNUM MVTSEQNUM,
						MVTDTL.SERNUM MVTSERNUM,
						MVTDTL.MVTTYP, 
						MVTDTL.ULDBKGIDR MVTULDBKGIDR,
						MVTDTL.SHPPFX MVTSHPPFX,
						MVTDTL.MSTDOCNUM MVTMSTDOCNUM,
						MVTDTL.DOCOWRIDR MVTDOCOWRIDR,
						MVTDTL.DUPNUM MVTDUPNUM,
						MVTDTL.SHPSEQNUM MVTSHPSEQNUM,
						MVTDTL.ASNTIM MVTASNTIM,
						MVTDTL.ASNUSR MVTASNUSR,					
						( SELECT MAX(HIS.TXNDAT) from OPRSHPHIS HIS
						WHERE HIS.CMPCOD = MST.CMPCOD
						AND HIS.MSTDOCNUM = MST.MSTDOCNUM
						AND HIS.SEQNUM = MST.SEQNUM
						AND HIS.DUPNUM = MST.DUPNUM
						AND HIS.DOCOWRIDR = MST.DOCOWRIDR
						AND HIS.TXNCOD='FOH'  
						GROUP BY 
						HIS.CMPCOD, 
						HIS.MSTDOCNUM ,
						HIS.SEQNUM ,
						HIS.DUPNUM ,
						HIS.DOCOWRIDR
						)ACTLAT,
						DTL.DLVARPCOD,
						( SELECT MIN(HIS.TXNDAT) from OPRSHPHIS HIS
						WHERE HIS.CMPCOD = MST.CMPCOD
						AND HIS.MSTDOCNUM = MST.MSTDOCNUM
						AND HIS.SEQNUM = MST.SEQNUM
						AND HIS.DUPNUM = MST.DUPNUM
						AND HIS.DOCOWRIDR = MST.DOCOWRIDR
						AND HIS.TXNCOD='NFD'  
						GROUP BY 
						HIS.CMPCOD, 
						HIS.MSTDOCNUM ,
						HIS.SEQNUM ,
						HIS.DUPNUM ,
						HIS.DOCOWRIDR
						)ACTTOA,
						(SELECT *
						FROM
						(SELECT 
						  (MINTPT
						  ||'~'
						  || MAXTPT) AS TPTVAL      
						FROM OPRCOLSCCTPTCFG TPTCFG
						INNER JOIN
						  (SELECT DISTINCT new_str SCCCOD
						  FROM
							(SELECT SCCSTR,
							  new_str,
							  ',' AS DELIMITER
							FROM
							  (SELECT SCCMST.CMPCOD,
								SCCMST.SCCCOD
								||
								CASE
								  WHEN SCCMST.SCCCOD IS NOT NULL
								  THEN ','
								  ELSE NULL
								END SCCSTR
							  FROM OPRSHPMST SCCMST         
							  WHERE SCCMST.CMPCOD  = ?
							AND SCCMST.MSTDOCNUM = ?
							AND SCCMST.DOCOWRIDR = ?
							AND SCCMST.DUPNUM    = ?
							AND SCCMST.SEQNUM    = ?
							  ),
							  xmltable('r/c' passing xmltype('<r><c>'
							  || REPLACE(SCCSTR,',','</c><c>')
							  || '</c></r>') columns new_str VARCHAR2(10) path '.')
							)
						  WHERE new_str IS NOT NULL
						  ) SCC
						ON TPTCFG.scccod    = SCC.SCCCOD
						WHERE TPTCFG.CMPCOD = 'LH'
						ORDER BY SCCPRY
						)Z
						WHERE ROWNUM=1
						) AS TPTDTL
					FROM OPRSHPMST MST
					INNER JOIN CAPBKGMST BKG
					ON MST.CMPCOD     = BKG.CMPCOD
					AND MST.MSTDOCNUM = BKG.MSTDOCNUM
					AND MST.DOCOWRIDR = BKG.DOCOWRIDR
					AND MST.DUPNUM    = BKG.DUPNUM
					AND MST.SEQNUM    = BKG.SEQNUM
					LEFT OUTER JOIN OPRSHPDTL DTL
					ON MST.CMPCOD     = DTL.CMPCOD
					AND MST.MSTDOCNUM = DTL.MSTDOCNUM
					AND MST.DOCOWRIDR = DTL.DOCOWRIDR
					AND MST.DUPNUM    = DTL.DUPNUM
					AND MST.SEQNUM    = DTL.SEQNUM
					LEFT OUTER JOIN OPRSHPOTHSRV OTH
					ON MST.CMPCOD     = OTH.CMPCOD
					AND MST.MSTDOCNUM = OTH.MSTDOCNUM
					AND MST.DOCOWRIDR = OTH.DOCOWRIDR
					AND MST.DUPNUM    = OTH.DUPNUM
					AND MST.SEQNUM    = OTH.SEQNUM
					LEFT OUTER JOIN OPRSHPBLK BLK
					ON MST.CMPCOD     = BLK.CMPCOD
					AND MST.MSTDOCNUM = BLK.MSTDOCNUM
					AND MST.DOCOWRIDR = BLK.DOCOWRIDR
					AND MST.DUPNUM    = BLK.DUPNUM
					AND MST.SEQNUM    = BLK.SEQNUM
					AND BLK.BLKSTA <> 'R'
					LEFT OUTER JOIN OPRBLKAUT AUT
					ON BLK.CMPCOD  = AUT.CMPCOD
					AND BLK.BLKAUT = AUT.AUTCOD
					LEFT OUTER JOIN OPRCOLSHPMST COLSHP
					ON MST.CMPCOD     = COLSHP.CMPCOD
					AND MST.MSTDOCNUM = COLSHP.COMMSTDOCNUM
					AND MST.DOCOWRIDR = COLSHP.COMDOCOWRIDR
					AND MST.DUPNUM    = COLSHP.COMDUPNUM
					AND MST.SEQNUM    = COLSHP.COMSEQNUM
					LEFT OUTER JOIN OPRCOLSHPDTL COLDTL
					ON COLSHP.CMPCOD     = COLDTL.CMPCOD
					AND COLSHP.SEQNUM = COLDTL.COLSEQNUM
					LEFT OUTER JOIN OPRCOLSHPMVTDTL MVTDTL 
					ON MVTDTL.CMPCOD = COLSHP.CMPCOD 
					AND MVTDTL.SEQNUM = COLSHP.SEQNUM
					WHERE MST.CMPCOD  = ?
					AND MST.MSTDOCNUM = ?
					AND MST.DOCOWRIDR = ?
					AND MST.DUPNUM    = ?
					AND MST.SEQNUM    = ?
		]]>
	</QRY:Source>
	</QRY:Definition>
	
	<QRY:Definition>
	<QRY:Id>2</QRY:Id>
	<QRY:Source Name="operations.cooltool.findPositioningCoolShipmentDetails" Type="NATIVE">
		<![CDATA[ 
					SELECT MST.CMPCOD,
							MST.MSTDOCNUM,
							MST.DOCOWRIDR,
							MST.DUPNUM,
							MST.SEQNUM,
							MST.SHPPFX,
							MST.ORGCOD,
							MST.DSTCOD,
							MST.PRDCOD,
							MST.PRDNAM,
							MST.SHPCOD,
							MST.SHPNAM,
							MST.SCCCOD,
							MST.SHPDES,
							MST.STDPCS,
							MST.STDWGT,
							MST.CPTDAT SHPCPTDAT,
							BKG.SHPRMK,
							COLSHP.SEQNUM COLSEQNUM,
							COLSHP.COMMSTDOCNUM,
							COLSHP.COMDOCOWRIDR,
							COLSHP.COMDUPNUM,
							COLSHP.COMSEQNUM,
							COLSHP.POSSHPPFX,
							COLSHP.POSMSTDOCNUM,
							COLSHP.POSDOCOWRIDR,
							COLSHP.POSDUPNUM,
							COLSHP.POSSEQNUM,
							COLSHP.REPSHPPFX,
							COLSHP.REPMSTDOCNUM,
							COLSHP.REPDOCOWRIDR,
							COLSHP.REPDUPNUM,
							COLSHP.REPSEQNUM,
							COLSHP.COLRMK,
							COLDTL.CMPCOD COLDTLCMPCOD,
						    COLDTL.COLSEQNUM COLDTLSEQNUM, 
						    COLDTL.SERNUM COLDTLSERNUM, 
						    COLDTL.DATREF003, COLDTL.DATREF010, 
						    COLDTL.DATREF009,    
						    COLDTL.DATREF001,
						    COLDTL.DATREF007,
						    COLDTL.DATREF002,
						    COLDTL.DATREF008,
						    COLDTL.DATREF004,
						    COLDTL.DATREF005,
							COLDTL.DATREF006,
							COLSHP.ARLSOLDAT,      
							COLSHP.CUSSOLDAT,      
							COLSHP.ARLEOLDAT,     
							COLSHP.CUSEOLDAT, 
							COLSHP.LSTUPDUSR,
							COLSHP.LSTUPDTIM,
							COLSHP.CRTTIM,
							COLSHP.CRTUSR,
							COLSHP.CRTSTN,
							MVTDTL.CMPCOD MVTCMPCOD,
							MVTDTL.SEQNUM MVTSEQNUM,
							MVTDTL.SERNUM MVTSERNUM,
							MVTDTL.MVTTYP, 
							MVTDTL.ULDBKGIDR MVTULDBKGIDR,
							MVTDTL.SHPPFX MVTSHPPFX,
							MVTDTL.MSTDOCNUM MVTMSTDOCNUM,
							MVTDTL.DOCOWRIDR MVTDOCOWRIDR,
							MVTDTL.DUPNUM MVTDUPNUM,
							MVTDTL.SHPSEQNUM MVTSHPSEQNUM,
							MVTDTL.ASNTIM MVTASNTIM,
							MVTDTL.ASNUSR MVTASNUSR
						FROM OPRSHPMST MST
						INNER JOIN CAPBKGMST BKG
						ON MST.CMPCOD     = BKG.CMPCOD
						AND MST.MSTDOCNUM = BKG.MSTDOCNUM
						AND MST.DOCOWRIDR = BKG.DOCOWRIDR
						AND MST.DUPNUM    = BKG.DUPNUM
						AND MST.SEQNUM    = BKG.SEQNUM
						LEFT OUTER JOIN OPRCOLSHPMVTDTL MVTDTL 
						ON MST.CMPCOD = MVTDTL.CMPCOD 
						AND MST.MSTDOCNUM = MVTDTL.MSTDOCNUM 
						AND MST.DOCOWRIDR = MVTDTL.DOCOWRIDR 
						AND MST.DUPNUM = MVTDTL.DUPNUM 
						AND MST.SEQNUM = MVTDTL.SHPSEQNUM 
						AND MVTDTL.MVTTYP = 'PA' 
						LEFT OUTER JOIN OPRCOLSHPMST COLSHP
						ON MST.CMPCOD     = COLSHP.CMPCOD
						AND MVTDTL.SEQNUM = COLSHP.SEQNUM 
						LEFT OUTER JOIN OPRCOLSHPDTL COLDTL
						ON COLSHP.CMPCOD     = COLDTL.CMPCOD
						AND COLSHP.SEQNUM = COLDTL.COLSEQNUM
						WHERE MST.CMPCOD  = ?
						AND MST.MSTDOCNUM = ?
						AND MST.DOCOWRIDR = ?
						AND MST.DUPNUM    = ?
						AND MST.SEQNUM    = ?
						UNION 
						SELECT MST.CMPCOD,
							MST.MSTDOCNUM,
							MST.DOCOWRIDR,
							MST.DUPNUM,
							MST.SEQNUM,
							MST.SHPPFX,
							MST.ORGCOD,
							MST.DSTCOD,
							MST.PRDCOD,
							MST.PRDNAM,
							MST.SHPCOD,
							MST.SHPNAM,
							MST.SCCCOD,
							MST.SHPDES,
							MST.STDPCS,
							MST.STDWGT,
							MST.CPTDAT SHPCPTDAT,
							BKG.SHPRMK,
							COLSHP.SEQNUM COLSEQNUM,
							COLSHP.COMMSTDOCNUM,
							COLSHP.COMDOCOWRIDR,
							COLSHP.COMDUPNUM,
							COLSHP.COMSEQNUM,
							COLSHP.POSSHPPFX,
							COLSHP.POSMSTDOCNUM,
							COLSHP.POSDOCOWRIDR,
							COLSHP.POSDUPNUM,
							COLSHP.POSSEQNUM,
							COLSHP.REPSHPPFX,
							COLSHP.REPMSTDOCNUM,
							COLSHP.REPDOCOWRIDR,
							COLSHP.REPDUPNUM,
							COLSHP.REPSEQNUM,
							COLSHP.COLRMK,
							COLDTL.CMPCOD COLDTLCMPCOD,
						    COLDTL.COLSEQNUM COLDTLSEQNUM, 
						    COLDTL.SERNUM COLDTLSERNUM, 
						    COLDTL.DATREF003, COLDTL.DATREF010, 
						    COLDTL.DATREF009,    
						    COLDTL.DATREF001,
						    COLDTL.DATREF007,
						    COLDTL.DATREF002,
						    COLDTL.DATREF008,
						    COLDTL.DATREF004,
						    COLDTL.DATREF005,
							COLDTL.DATREF006,
							COLSHP.ARLSOLDAT,      
							COLSHP.CUSSOLDAT,      
							COLSHP.ARLEOLDAT,     
							COLSHP.CUSEOLDAT, 
							COLSHP.LSTUPDUSR,
							COLSHP.LSTUPDTIM,
							COLSHP.CRTTIM,
							COLSHP.CRTUSR,
							COLSHP.CRTSTN,
							NULL MVTCMPCOD,
							NULL MVTSEQNUM,
							NULL MVTSERNUM,
							NULL MVTTYP, 
							NULL MVTULDBKGIDR,
							NULL MVTSHPPFX,
							NULL MVTMSTDOCNUM,
							NULL MVTDOCOWRIDR,
							NULL MVTDUPNUM,
							NULL MVTSHPSEQNUM,
							NULL MVTASNTIM,
							NULL MVTASNUSR
							FROM OPRSHPMST MST
							INNER JOIN CAPBKGMST BKG
							ON MST.CMPCOD     = BKG.CMPCOD
							AND MST.MSTDOCNUM = BKG.MSTDOCNUM
							AND MST.DOCOWRIDR = BKG.DOCOWRIDR
							AND MST.DUPNUM    = BKG.DUPNUM
							AND MST.SEQNUM    = BKG.SEQNUM
							LEFT OUTER JOIN OPRCOLSHPMST COLSHP
							ON MST.CMPCOD     = COLSHP.CMPCOD
							AND MST.MSTDOCNUM = COLSHP.POSMSTDOCNUM
							AND MST.DOCOWRIDR = COLSHP.POSDOCOWRIDR
							AND MST.DUPNUM    = COLSHP.POSDUPNUM
							AND MST.SEQNUM    = COLSHP.POSSEQNUM
							LEFT OUTER JOIN OPRCOLSHPDTL COLDTL
						    ON COLSHP.CMPCOD     = COLDTL.CMPCOD
						    AND COLSHP.SEQNUM = COLDTL.COLSEQNUM
							WHERE MST.CMPCOD  = ?
							AND MST.MSTDOCNUM = ?
							AND MST.DOCOWRIDR = ?
							AND MST.DUPNUM    = ?
							AND MST.SEQNUM    = ?
		]]>
	</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>2</QRY:Id>
	<QRY:Source Name="operations.cooltool.findPositioningULDBookingDetails" Type="NATIVE">
		<![CDATA[ 
					SELECT SHPMST.CMPCOD, 
						SHPMST.MSTDOCNUM, 
						SHPMST.DOCOWRIDR, 
						SHPMST.DUPNUM, 
						SHPMST.SEQNUM, 
						SHPMST.SHPPFX COMSHPPFX,	
						SHPMST.ORGCOD, 
						SHPMST.DSTCOD,							
						SHPMST.SCCCOD, 
						SHPMST.SHPDES, 
						SHPMST.STDPCS, 
						SHPMST.STDWGT, 
						SHPMST.CPTDAT SHPCPTDAT, 						 
						COLSHP.SEQNUM COLSEQNUM, 
						COLSHP.COMMSTDOCNUM, 
						COLSHP.COMDOCOWRIDR, 
						COLSHP.COMDUPNUM, 
						COLSHP.COMSEQNUM, 
						MVTDTLRES.MVTTYP, 
						MVTDTLRES.ULDBKGIDR MVTULDBKGIDR, 
						MVTDTLRES.SEQNUM MVTSEQNUM,
						MVTDTLRES.SERNUM MVTSERNUM,
						MVTDTLRES.CMPCOD MVTCMPCOD,
						COLSHP.COLRMK, 
						COLDTL.CMPCOD COLDTLCMPCOD,
						COLDTL.COLSEQNUM COLDTLSEQNUM, 
						COLDTL.SERNUM COLDTLSERNUM, 
						COLDTL.DATREF003, COLDTL.DATREF010, 
						COLDTL.DATREF009,    
						COLDTL.DATREF001,
						COLDTL.DATREF007,
						COLDTL.DATREF002,
						COLDTL.DATREF008,
						COLDTL.DATREF004,
						COLDTL.DATREF005,
						COLDTL.DATREF006,
						COLSHP.ARLSOLDAT, 
						COLSHP.CUSSOLDAT, 
						COLSHP.ARLEOLDAT, 
						COLSHP.CUSEOLDAT, 
						COLSHP.LSTUPDUSR, 
						COLSHP.LSTUPDTIM, 
						COLSHP.CRTTIM, 
						COLSHP.CRTUSR, 
						COLSHP.CRTSTN 
					FROM CAPULDBKGMST MST	
						INNER JOIN OPRCOLSHPMVTDTL MVTDTL 
						ON MST.CMPCOD = MVTDTL.CMPCOD 
						AND MST.ULDBKGIDR = MVTDTL.ULDBKGIDR 
						INNER JOIN OPRCOLSHPMVTDTL MVTDTLRES 
						ON MVTDTLRES.CMPCOD = MVTDTL.CMPCOD 
						AND MVTDTLRES.SEQNUM = MVTDTL.SEQNUM	
						INNER JOIN OPRCOLSHPMST COLSHP 
						ON COLSHP.CMPCOD = MVTDTL.CMPCOD 
						AND COLSHP.SEQNUM = MVTDTL.SEQNUM	
						LEFT OUTER JOIN OPRCOLSHPDTL COLDTL
					    ON COLSHP.CMPCOD     = COLDTL.CMPCOD
					    AND COLSHP.SEQNUM = COLDTL.COLSEQNUM
						INNER JOIN OPRSHPMST SHPMST 
						ON SHPMST.CMPCOD = COLSHP.CMPCOD 
						AND SHPMST.MSTDOCNUM = COLSHP.COMMSTDOCNUM 
						AND SHPMST.DOCOWRIDR = COLSHP.COMDOCOWRIDR 
						AND SHPMST.DUPNUM = COLSHP.COMDUPNUM 
						AND SHPMST.SEQNUM = COLSHP.COMSEQNUM 
					WHERE MST.CMPCOD = ? 
						AND MST.ULDBKGIDR = ? 
		]]>
	</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>2</QRY:Id>
	<QRY:Source Name="operations.cooltool.findstockmovementuldbookingdetails" Type="NATIVE">
		<![CDATA[ 
					SELECT MST.CMPCOD,	
						MST.ORGCOD ULDBKGORG, 
						MST.DSTCOD ULDBKGDST,	
						(SELECT CUSNAM 
								FROM SHRCUSMST CUSMST 
								WHERE CUSMST.CMPCOD=MST.CMPCOD 
								AND CUSMST.CUSCOD = MST.CUSCOD 
								)CUSNAM,	
						MST.SCCCOD,	
						MST.BKGSTA ULDBKGSTA,
						COLSHP.SEQNUM COLSEQNUM,	
						COLSHP.ULDBKGIDR,	
						MVTDTL.MVTTYP, 
						MVTDTL.ULDBKGIDR MVTULDBKGIDR,
						MVTDTL.SEQNUM MVTSEQNUM,
						MVTDTL.SERNUM MVTSERNUM,
						MVTDTL.CMPCOD MVTCMPCOD,
						COLSHP.COLRMK, 
						COLDTL.CMPCOD COLDTLCMPCOD,
						COLDTL.COLSEQNUM COLDTLSEQNUM, 
						COLDTL.SERNUM COLDTLSERNUM, 
						COLDTL.DATREF003, COLDTL.DATREF010, 
						COLDTL.DATREF009,    
						COLDTL.DATREF001,
						COLDTL.DATREF007,
						COLDTL.DATREF002,
						COLDTL.DATREF008,
						COLDTL.DATREF004,
						COLDTL.DATREF005,
						COLDTL.DATREF006,
						COLSHP.ARLSOLDAT, 
						COLSHP.CUSSOLDAT, 
						COLSHP.ARLEOLDAT, 
						COLSHP.CUSEOLDAT, 
						COLSHP.LSTUPDUSR, 
						COLSHP.LSTUPDTIM, 
						COLSHP.CRTTIM, 
						COLSHP.CRTUSR, 
						COLSHP.CRTSTN 
					FROM CAPULDBKGMST MST	
						LEFT OUTER JOIN OPRCOLSHPMST COLSHP 
						ON MST.CMPCOD = COLSHP.CMPCOD 
						AND MST.ULDBKGIDR = COLSHP.ULDBKGIDR							
						LEFT OUTER JOIN OPRCOLSHPDTL COLDTL
						ON COLSHP.CMPCOD     = COLDTL.CMPCOD
						AND COLSHP.SEQNUM = COLDTL.COLSEQNUM
						LEFT OUTER JOIN OPRCOLSHPMVTDTL MVTDTL 
						ON COLSHP.CMPCOD = MVTDTL.CMPCOD 
						AND COLSHP.SEQNUM = MVTDTL.SEQNUM	
					WHERE MST.CMPCOD = ? 
						AND MST.ULDBKGIDR = ? 
		]]>
	</QRY:Source>
	</QRY:Definition> 
	<QRY:Definition>
	<QRY:Id>2</QRY:Id>
	<QRY:Source Name="operations.cooltool.findflightdetailsforUldBookingID" Type="NATIVE">
		<![CDATA[ 
					SELECT DISTINCT MST.CMPCOD, 
					  NULL AS MSTDOCNUM,
					  NULL AS SEQNUM,
					  NULL AS DUPNUM,
					  NULL AS DOCOWRIDR,
					  MST.ULDBKGIDR, 
					  FLTDTL.FLTNUM, 
					  FLTDTL.FLTSEQNUM, 
					  FLTDTL.SEGORG FLTORG, 
					  FLTDTL.SEGDST FLTDST, 
					  FLTDTL.FLTCARCOD, 
					  FLTLEG2.STA, 
					  FLTLEG1.STD, 
					  FLTLEG2.ATA, 
					  FLTLEG1.ATD, 
					  POL.ULDNUM, 
					  POL.POS, 
					  FLTDTL.LWRDCKONEPOS LWRDCKONE, 
					  FLTDTL.LWRDCKTWOPOS LWRDCKTWO, 
					  FLTDTL.UPRDCKONEPOS UPRDCKONE, 
					  FLTDTL.UPRDCKTWOPOS UPRDCKTWO, 
					  FLTDTL.FLTDAT,
					  NULL AS SHPMSTDOCNUM,
					  NULL AS SHPSEQNUM,
					  NULL AS SHPDUPNUM,
					  NULL AS SHPDOCOWRIDR,
					  MVTDTL.MVTTYP AS MVTTYP,
					  ULD.ULDREFNUM AS ULDREFNUM
					FROM CAPULDBKGMST MST 
					INNER JOIN CAPULDBKGFLTDTL FLTDTL 
					ON MST.CMPCOD = FLTDTL.CMPCOD 
					AND MST.ULDBKGIDR = FLTDTL.ULDBKGIDR 
					AND (MST.CMPCOD,MST.ULDBKGIDR) IN REPLACESTRING					
					INNER JOIN FLTOPRLEG FLTLEG1 
					ON FLTDTL.CMPCOD = FLTLEG1.CMPCOD 
					AND FLTDTL.FLTNUM = FLTLEG1.FLTNUM 
					AND FLTDTL.FLTCARIDR = FLTLEG1.FLTCARIDR 
					AND FLTDTL.FLTSEQNUM = FLTLEG1.FLTSEQNUM 
					AND FLTDTL.SEGORG = FLTLEG1.LEGORG 
					INNER JOIN FLTOPRLEG FLTLEG2 
					ON FLTDTL.CMPCOD = FLTLEG2.CMPCOD 
					AND FLTDTL.FLTNUM = FLTLEG2.FLTNUM 
					AND FLTDTL.FLTCARIDR = FLTLEG2.FLTCARIDR 
					AND FLTDTL.FLTSEQNUM = FLTLEG2.FLTSEQNUM 
					AND FLTDTL.SEGDST = FLTLEG2.LEGDST 
					LEFT OUTER JOIN OPRCOLSHPMVTDTL MVTDTL
					ON MST.CMPCOD = MVTDTL.CMPCOD
					AND MST.ULDBKGIDR = MVTDTL.ULDBKGIDR
					LEFT OUTER JOIN OPRLODPLNULD ULD 
					ON ULD.CMPCOD = FLTDTL.CMPCOD 
					AND ULD.FLTCARIDR = FLTDTL.FLTCARIDR 
					AND ULD.FLTNUM = FLTDTL.FLTNUM 
					AND ULD.FLTSEQNUM = FLTDTL.FLTSEQNUM 
					LEFT OUTER JOIN OPRLODPLNPOSPOL POL 
					ON POL.CMPCOD =FLTDTL.CMPCOD 
					AND POL.FLTCARIDR =FLTDTL.FLTCARIDR 
					AND POL.FLTNUM =FLTDTL.FLTNUM 
					AND POL.FLTSEQNUM =FLTDTL.FLTSEQNUM 
					AND ULD.POSNUM = pol.pos 
					AND COALESCE (POL.ULDNUM,'BULK') <> 'BULK' 
					AND MST.BKGSTA <> 'XX'
		]]>
	</QRY:Source>
	</QRY:Definition> 
	<QRY:Definition>
	    <QRY:Id>24</QRY:Id>
	    <QRY:Source Name="operations.cooltool.findUldBookingIDs" Type="NATIVE">
	      <![CDATA[ 
				SELECT ULDBKGIDR,CMPCOD,ORGCOD,DSTCOD from CAPULDBKGMST 
				WHERE CMPCOD=?
				AND ULDBKGIDR IN 
		]]>
	</QRY:Source>
	</QRY:Definition>
	
	<QRY:Definition>
	<QRY:Id>3</QRY:Id>
	<QRY:Source Name="operations.cooltool.findflightDetailsforcoolShipment" Type="NATIVE">
		<![CDATA[ 
			SELECT DISTINCT MST.CMPCOD,
					MST.MSTDOCNUM,
					MST.SEQNUM,
					MST.DUPNUM,
					MST.DOCOWRIDR,
					NULL AS ULDBKGIDR,
					FLTDTL.FLTNUM,
					FLTDTL.FLTSEQNUM,
					FLTDTL.FLTORG,
					FLTDTL.FLTDST,
					FLTDTL.FLTCARCOD,
					FLTLEG2.STA,
					FLTLEG1.STD,
					FLTLEG2.ATA,
  					FLTLEG1.ATD,
					POL.ULDNUM, 
					POL.POS, 
					FLTDTL.LWRDCKONE,
					FLTDTL.LWRDCKTWO,
					FLTDTL.UPRDCKONE,
					FLTDTL.UPRDCKTWO,
					FLTDTL.FLTDAT,
				  PLNSHP.MSTDOCNUM SHPMSTDOCNUM, 
				  PLNSHP.SEQNUM SHPSEQNUM, 
				  PLNSHP.DUPNUM SHPDUPNUM, 
				  PLNSHP.DOCOWNIDR SHPDOCOWRIDR ,
				  NVL(MVTDTL.MVTTYP,'C') AS MVTTYP,
				  NULL AS ULDREFNUM
				FROM CAPBKGMST MST
				INNER JOIN CAPBKGFLTDTL FLTDTL
				ON MST.CMPCOD     = FLTDTL.CMPCOD
				AND MST.UBRNUM    = FLTDTL.UBRNUM
				AND MST.MSTDOCNUM = FLTDTL.MSTDOCNUM
				AND MST.DOCOWRIDR = FLTDTL.DOCOWRIDR
				AND MST.DUPNUM    = FLTDTL.DUPNUM
				AND MST.SEQNUM    = FLTDTL.SEQNUM
				AND (MST.CMPCOD,MST.MSTDOCNUM,MST.DOCOWRIDR, MST.DUPNUM, MST.SEQNUM) IN 
		]]>
	</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>3</QRY:Id>
	<QRY:Source Name="operations.cooltool.findflightDetailsforcoolShipmentPart2" Type="NATIVE">
		<![CDATA[ 
				SELECT DISTINCT MST.CMPCOD,
					  MST.MSTDOCNUM,
					  MST.SEQNUM,
					  MST.DUPNUM,
					  MST.DOCOWRIDR,
					  NULL AS ULDBKGIDR,
					  FLTDTL.FLTNUM,
					  FLTDTL.FLTSEQNUM,
					  FLTDTL.FLTORG,
					  FLTDTL.FLTDST,
					  FLTDTL.FLTCARCOD,
					  FLTLEG2.STA,
					  FLTLEG1.STD,
					  FLTLEG2.ATA,
  					  FLTLEG1.ATD,
					  POL.ULDNUM,
					  POL.POS,
					  FLTDTL.LWRDCKONE,
					  FLTDTL.LWRDCKTWO,
					  FLTDTL.UPRDCKONE,
					  FLTDTL.UPRDCKTWO,
					  FLTDTL.FLTDAT,
					  PLNSHP.MSTDOCNUM SHPMSTDOCNUM,
					  PLNSHP.SEQNUM SHPSEQNUM,
					  PLNSHP.DUPNUM SHPDUPNUM,
					  PLNSHP.DOCOWNIDR SHPDOCOWRIDR,
					  NVL(MVTDTL.MVTTYP,'C') AS MVTTYP,
					  NULL AS ULDREFNUM
					FROM CAPBKGMST MST
					INNER JOIN CAPBKGFLTDTL FLTDTL
					ON MST.CMPCOD     = FLTDTL.CMPCOD
					AND MST.UBRNUM    = FLTDTL.UBRNUM
					AND MST.MSTDOCNUM = FLTDTL.MSTDOCNUM
					AND MST.DOCOWRIDR = FLTDTL.DOCOWRIDR
					AND MST.DUPNUM    = FLTDTL.DUPNUM
					AND MST.SEQNUM    = FLTDTL.SEQNUM
				    AND (MST.CMPCOD,MST.MSTDOCNUM,MST.DOCOWRIDR,MST.DUPNUM, MST.SEQNUM) IN			
				
		]]>
	</QRY:Source>
	</QRY:Definition>
	
	<QRY:Definition>
	    <QRY:Id>4</QRY:Id>
	    <QRY:Source Name="operations.cooltool.findcommunicationinfo" Type="OBJECT">
	      <![CDATA[     	
			  SELECT coolShipmentAdditionalInfo from
				com.ibsplc.icargo.business.operations.cooltool.CoolShipmentAdditionalInfo as coolShipmentAdditionalInfo			
			WHERE
				coolShipmentAdditionalInfo.coolShipmentAdditionalInfoCommonPK.companyCode=? AND 
				coolShipmentAdditionalInfo.coolShipmentAdditionalInfoCommonPK.sequenceNumber=? 			
			]]>    
		</QRY:Source>
	</QRY:Definition>
	
	<QRY:Definition>
	<QRY:Id>5</QRY:Id>
	<QRY:Source Name="operations.cooltool.findcoolshipmentulddetails" Type="NATIVE">
		<![CDATA[ 
					SELECT MST.CMPCOD,MST.COMMSTDOCNUM,
						  MST.COMSEQNUM,
						  MST.COMDUPNUM,
						  MST.COMDOCOWRIDR,
						  ULD.ULDNUM,
						  ARPULD.ARPCOD 
					FROM OPRCOLSHPMST MST
					INNER JOIN OPRCOLSHPULD ULD
						ON MST.CMPCOD     = ULD.CMPCOD
						AND MST.SEQNUM = ULD.SEQNUM
					LEFT OUTER JOIN OPRARPULD ARPULD
						ON ULD.CMPCOD     = ARPULD.CMPCOD
						AND ULD.ULDNUM    = ARPULD.ULDNUM
		]]>
	</QRY:Source>
	</QRY:Definition>
	
	<QRY:Definition>
	<QRY:Id>14</QRY:Id>
	<QRY:Source Name="operations.cooltool.findPostSearchDetails" Type="NATIVE">
	<![CDATA[ 
		SELECT Wrk.Cmpcod,
  Wrk.VERNUM,
  Wrk.MSTDOCNUM,
  Wrk.DOCOWRIDR,
  Wrk.DUPNUM,
  Wrk.SEQNUM,Wrk.wrksernum,
  SUM(
  CASE
    WHEN Wrk.Wrkflonam in (SELECT Syspar.PARVAL
      FROM Shrsyspar Syspar
      WHERE Syspar.CMPCOD = Wrk.Cmpcod
      AND Syspar.Parcod IN ('operations.cooltool.workflowforrelocateto0QUERPHA420','operations.cooltool.workflowforwarehouseareanotpharma')
      )
    AND Wrkdtl.Wrksta <>'C'
    THEN 1
    ELSE 0
  END ) OPENCHKOUTWRK,
   SUM(
  CASE
    WHEN Wrk.Wrkflonam IN
      (SELECT Syspar.PARVAL
      FROM Shrsyspar Syspar
      WHERE Syspar.CMPCOD = Wrk.Cmpcod
      AND Syspar.Parcod  IN ('operations.cooltool.workflowforrelocateto0QUERPHA420','operations.cooltool.workflowforwarehouseareanotpharma')
      )
    THEN 1
    ELSE 0
  END ) RELOCATIONWRKCOUNT,
  SUM(
  CASE
    WHEN Wrkdtl.Wrksta   ='O'
    AND Wrkdtl.wrkflonam IN
      (SELECT GRP.GRPENT
      FROM SHRGENMSTGRPDTL GRP
      WHERE GRP.CMPCOD = Wrk.Cmpcod
      AND GRP.GRPTYP   ='WRKFLOGRP'
      AND GRP.GRPCATCOD='GEN'
      AND GRP.GRPNAM   = 'COOLWRKHNDL'
      )
    THEN 1
    ELSE 0
  END ) SHPWRK,
  FLTDTL.FLTNUM,
  FLTDTL.FLTCARIDR,
  FLTDTL.FLTSEQNUM
FROM Oprshpwrk Wrk
INNER JOIN OPRSHPWRKDTL wrkdtl
ON Wrk.Cmpcod     = Wrkdtl.Cmpcod
AND Wrk.Wrksernum = Wrkdtl.Wrksernum
AND Wrk.Vernum    = Wrkdtl.Vernum
INNER JOIN CAPBKGFLTDTL FLTDTL
ON Wrk.CMPCOD     = FLTDTL.CMPCOD
AND Wrk.MSTDOCNUM = FLTDTL.MSTDOCNUM
AND Wrk.SEQNUM    = FLTDTL.SEQNUM
AND Wrk.DUPNUM    = FLTDTL.DUPNUM
AND Wrk.DOCOWRIDR = FLTDTL.DOCOWRIDR
WHERE Wrk.Cmpcod = ?
AND Wrk.Arpcod   = ?
AND Wrk.Mstdocnum  = ?
AND Wrk.Docowridr  = ?
AND Wrk.Dupnum     = ?
AND Wrk.seqnum     = ?

	]]>
	</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>14</QRY:Id>
	<QRY:Source Name="operations.cooltool.listcoolshipmentdetails.offloadshipments" Type="NATIVE">
		<![CDATA[ 
		 SELECT SHPMST.CMPCOD,SHPMST.SHPPFX,'C' AS SHPTYP,
		 SHPMST.DOCOWRIDR,
		 SHPMST.MSTDOCNUM,
		 SHPMST.DUPNUM,
		 SHPMST.SEQNUM,
		 SHPMST.UBRNUM,
		 FLTSEG.POL,
		 FLTSEG.POU,
		 OFLDTL.ULDNUM,OFLDTL.OFLTYP,
		 SHPMST.ORGCOD,
		 SHPMST.DSTCOD,
		 SHPMST.PRDNAM,
		 SHPMST.SCCCOD,
		 (SELECT RTRIM(XMLAGG(XMLELEMENT(E, MVTDTL.ULDBKGIDR || ',')
		 ORDER BY MVTDTL.ULDBKGIDR).EXTRACT('//text()'), ',') ULDBKGIDR
		 FROM OPRCOLSHPMVTDTL MVTDTL
		 WHERE MVTDTL.CMPCOD = COLSHP.CMPCOD
		 AND MVTDTL.SEQNUM = COLSHP.SEQNUM
		 )ULDMVTDTL,
		 (SELECT DISTINCT 'Y' AS TRMCPTFLG
		 FROM OPRCOLSHPFLTULD FTLULD
		 WHERE COLSHP.CMPCOD = FTLULD.CMPCOD
		 AND COLSHP.SEQNUM = FTLULD.SEQNUM		 
		 AND OFLDTL.FLTNUM = FTLULD.FLTNUM
		 AND OFLDTL.FLTSEQNUM = FTLULD.FLTSEQNUM
		 AND FTLULD.ORDNUM IS NOT NULL
		 ) TRMCPTFLG,
		 COLDTL.DATREF002 MAXSHPTPT,
		 COLDTL.DATREF001 MINSHPTPT,
		 FLTMST.FLTCARIDR,
		 FLTMST.FLTNUM,
		 FLTMST.FLTSEQNUM,
		 FLTMST.FLTDAT,
		 BDPLEG.STD,
		 (	CASE ARLMST.APHCODUSE
			WHEN 2
			THEN ARLMST.TWOAPHCOD
			ELSE ARLMST.THRAPHCOD
			END ) FLTCARCOD,
		 DENSE_RANK() OVER (ORDER BY FLTMST.FLTCARIDR,FLTMST.FLTNUM,FLTMST.FLTDAT,BDPLEG.STD,FLTMST.FLTSEQNUM,SHPMST.CMPCOD,SHPMST.MSTDOCNUM,SHPMST.SEQNUM,SHPMST.DUPNUM,SHPMST.DOCOWRIDR DESC) AS RANK
		 FROM OPROFLDTL OFLDTL
		 INNER JOIN OPRFLTSEG FLTSEG
		 ON OFLDTL.CMPCOD = FLTSEG.CMPCOD
		 AND OFLDTL.FLTCARIDR = FLTSEG.FLTCARIDR
		 AND OFLDTL.FLTNUM = FLTSEG.FLTNUM
		 AND OFLDTL.FLTSEQNUM = FLTSEG.FLTSEQNUM
		 AND OFLDTL.SEGSERNUM = FLTSEG.SEGSERNUM
		 INNER JOIN FLTOPRLEG OFLLEG
		 ON FLTSEG.CMPCOD = OFLLEG.CMPCOD
		 AND FLTSEG.FLTCARIDR = OFLLEG.FLTCARIDR
		 AND FLTSEG.FLTNUM = OFLLEG.FLTNUM
		 AND FLTSEG.FLTSEQNUM = OFLLEG.FLTSEQNUM
		 AND FLTSEG.POL = OFLLEG.LEGORG
		 INNER JOIN OPRSHPMST SHPMST
		 ON OFLDTL.CMPCOD = SHPMST.CMPCOD
		 AND OFLDTL.DOCOWRIDR = SHPMST.DOCOWRIDR
		 AND OFLDTL.MSTDOCNUM = SHPMST.MSTDOCNUM
		 AND OFLDTL.DUPNUM = SHPMST.DUPNUM
		 AND OFLDTL.SEQNUM = SHPMST.SEQNUM
		 INNER JOIN PRDMST
		 ON SHPMST.CMPCOD = PRDMST.CMPCOD
		 AND SHPMST.PRDCOD = PRDMST.PRDCOD
		 INNER JOIN OPRCOLSHPMST COLSHP
		 ON SHPMST.CMPCOD = COLSHP.CMPCOD
		 AND SHPMST.DOCOWRIDR = COLSHP.COMDOCOWRIDR
		 AND SHPMST.MSTDOCNUM = COLSHP.COMMSTDOCNUM
		 AND SHPMST.DUPNUM = COLSHP.COMDUPNUM
		 AND SHPMST.SEQNUM = COLSHP.COMSEQNUM
		 LEFT OUTER JOIN OPRCOLSHPDTL COLDTL
		 ON COLSHP.CMPCOD     = COLDTL.CMPCOD
		 AND COLSHP.SEQNUM = COLDTL.COLSEQNUM
		 LEFT OUTER JOIN OPRSEGSHP SEGSHP
		 ON OFLDTL.CMPCOD = SEGSHP.CMPCOD
		 AND OFLDTL.DOCOWRIDR = SEGSHP.DOCOWRIDR
		 AND OFLDTL.MSTDOCNUM = SEGSHP.MSTDOCNUM
		 AND OFLDTL.DUPNUM = SEGSHP.DUPNUM
		 AND OFLDTL.SEQNUM = SEGSHP.SEQNUM
		 AND (OFLDTL.FLTCARIDR ||OFLDTL.FLTNUM ||OFLDTL.FLTSEQNUM) <>
		 (SEGSHP.FLTCARIDR ||SEGSHP.FLTNUM ||SEGSHP.FLTSEQNUM)
		 AND SEGSHP.MFTPCS-SEGSHP.OFLPCS > 0
		 LEFT OUTER JOIN OPRFLTSEG BDPSEG
		 ON SEGSHP.CMPCOD = BDPSEG.CMPCOD
		 AND SEGSHP.FLTCARIDR = BDPSEG.FLTCARIDR
		 AND SEGSHP.FLTNUM = BDPSEG.FLTNUM
		 AND SEGSHP.FLTSEQNUM = BDPSEG.FLTSEQNUM
		 AND SEGSHP.SEGSERNUM = BDPSEG.SEGSERNUM
		 AND OFLLEG.LEGORG = BDPSEG.POL
		 LEFT OUTER JOIN FLTOPRMST FLTMST
		 ON SEGSHP.CMPCOD = FLTMST.CMPCOD
		 AND SEGSHP.FLTCARIDR = FLTMST.FLTCARIDR
		 AND SEGSHP.FLTNUM = FLTMST.FLTNUM
		 AND SEGSHP.FLTSEQNUM = FLTMST.FLTSEQNUM
		 LEFT OUTER JOIN FLTOPRLEG BDPLEG
		 ON BDPSEG.CMPCOD = BDPLEG.CMPCOD
		 AND BDPSEG.FLTCARIDR = BDPLEG.FLTCARIDR
		 AND BDPSEG.FLTNUM = BDPLEG.FLTNUM
		 AND BDPSEG.FLTSEQNUM = BDPLEG.FLTSEQNUM
		 AND BDPSEG.POL = BDPLEG.LEGORG
		 LEFT OUTER JOIN SHRARLMST ARLMST
		 ON BDPSEG.CMPCOD     = ARLMST.CMPCOD
		 AND BDPSEG.FLTCARIDR = ARLMST.ARLIDR
		 WHERE OFLLEG.CMPCOD = ?
		 AND OFLLEG.LEGORG = ?
		 AND OFLLEG.STD BETWEEN ? AND ?
		 AND BDPLEG.ATD IS NULL
		]]>
	</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>6</QRY:Id>
	<QRY:Source Name="operations.cooltool.listcoolshipmentdetails.commercialpartone" Type="NATIVE">
		<![CDATA[ 
					WITH SHPDTL AS
					  ( SELECT Z.* FROM
						(SELECT 'C' AS SHPTYP,
					  LEG1.LEGORG,
					  LEG2.LEGDST,
					  FLTDTL.FLTORG,
					  FLTDTL.FLTDST,
					  LEG1.ATD,LEG1.ETD,
					  LEG2.ATA,LEG2.ETA,
					  ARP.ACPPCS,
					  ARP.AVLPCS,
					  ARP.RCVPCS,
					  ARP.TOTDLVPCS,
					  ARP.ARPCOD,
						SHPMST.CMPCOD, 
						SHPMST.MSTDOCNUM, 
						SHPMST.SHPPFX, 
						SHPMST.SEQNUM, 
						SHPMST.DUPNUM , 
						SHPMST.DOCOWRIDR, 
						SHPMST.SCCCOD, 
						SHPMST.PRDNAM, 
						SHPMST.SHPNAM, 
						SHPMST.SHPCOD, 
						SHPMST.ORGCOD, 
						SHPMST.DSTCOD, 
						FLTDTL.FLTCARCOD, 
						FLTDTL.FLTNUM, 
						FLTDTL.FLTDAT,
						FLTDTL.FLTCARIDR, 
						FLTDTL.FLTSEQNUM, 
						FLTDTL.FLTBKGSTA,
						LEG1.STD, 
						LEG2.STA,NVL(COLMST.SEQNUM,0) COLSEQNUM,
						BKGMST.BKGSTA, 
                        BKGMST.CUSNAM,						
						COLDTL.DATREF002 MAXSHPTPT,
						COLDTL.DATREF001 MINSHPTPT,
						COLMST.SPRVSNFLG,
						CASE
						  WHEN (COLULD.ULDCAT = 'ACT'
						  OR (COLULD.ULDCAT  IN ('PAS','VAL','PER')
						  AND SEGULD.THRUNT   = 'Y'))
						  THEN COLULD.ULDNUM
						  ELSE NULL
						END ULDNUM,
						  (SELECT RTRIM(XMLAGG(XMLELEMENT(E, MVTDTL.ULDBKGIDR
							|| ',')
						  ORDER BY MVTDTL.ULDBKGIDR).EXTRACT('//text()'), ',') ULDBKGIDR
						  FROM OPRCOLSHPMVTDTL MVTDTL
						  WHERE MVTDTL.CMPCOD = COLMST.CMPCOD
						  AND MVTDTL.SEQNUM   = COLMST.SEQNUM
						  )ULDMVTDTL,
					  (SELECT RTRIM(XMLAGG(XMLELEMENT(E, SEGULDSHP.ULDNUM
						  || ',')
						ORDER BY SEGULDSHP.ULDNUM).EXTRACT('//text()'), ',') ULD
						FROM OPRSEGULDSHP SEGULDSHP
						WHERE SEGULDSHP.CMPCOD  = SHPMST.CMPCOD
						AND SEGULDSHP.MSTDOCNUM = SHPMST.MSTDOCNUM
						AND SEGULDSHP.SEQNUM    = SHPMST.SEQNUM
						AND SEGULDSHP.DOCOWRIDR = SHPMST.DOCOWRIDR
						AND SEGULDSHP.DUPNUM    = SHPMST.DUPNUM
						AND SEGULDSHP.FLTNUM    = FLTDTL.FLTNUM
						AND SEGULDSHP.FLTSEQNUM = FLTDTL.FLTSEQNUM
						AND SEGULDSHP.FLTCARIDR = FLTDTL.FLTCARIDR
						AND SEGULDSHP.SEGSERNUM = FLTSEG.SEGSERNUM
						AND SEGULDSHP.ULDNUM <>'BULK'
						)MFTULD,
						(SELECT SUBSTR(RTRIM(XMLAGG(XMLELEMENT(E, SCCCOD
						||'#'
						||SCCPRY
						||'#'
						||TPTCFG.MAXTPT
						||'#'
						|| TPTCFG.MINTPT
						|| '~')
					  ORDER BY SCCPRY).EXTRACT('//text()')), 0, INSTR(RTRIM(XMLAGG(XMLELEMENT(E, SCCCOD
						||'#'
						||SCCPRY
						||'#'
						||TPTCFG.MAXTPT
						||'#'
						|| TPTCFG.MINTPT
						|| '~')
					  ORDER BY SCCPRY).EXTRACT('//text()')),'~',1,1)) TMP
					  FROM OPRCOLSCCTPTCFG TPTCFG
					  WHERE TPTCFG.CMPCOD = SHPMST.CMPCOD
						  AND INSTR(SHPMST.SCCCOD,TPTCFG.SCCCOD) > 0
						  ) AS ENVTPT,
						  (SELECT DISTINCT 'Y' AS TRMCPTFLG
						  FROM OPRCOLSHPFLTULD FTLULD
						  WHERE COLMST.CMPCOD  = FTLULD.CMPCOD
							AND COLMST.SEQNUM = FTLULD.SEQNUM
							AND FTLULD.FLTNUM = FLTDTL.FLTNUM
							AND FTLULD.FLTSEQNUM = FLTDTL.FLTSEQNUM        
						  AND FTLULD.ORDNUM   IS NOT NULL
						  ) TRMCPTFLG,PMST.PRDCTG
					  FROM FLTOPRLEG LEG 
					  INNER JOIN CAPBKGFLTDTL FLTDTL 
					ON LEG.CMPCOD     = FLTDTL.CMPCOD
					AND LEG.FLTNUM    = FLTDTL.FLTNUM
					    AND LEG.FLTSEQNUM = FLTDTL.FLTSEQNUM 
					    AND LEG.FLTCARIDR = FLTDTL.FLTCARIDR 
						 INNER JOIN  FLTOPRLEG LEG1
						  ON   FLTDTL.CMPCOD     = LEG1.CMPCOD
						  AND FLTDTL.FLTNUM    = LEG1.FLTNUM
						  AND FLTDTL.FLTSEQNUM = LEG1.FLTSEQNUM
						  AND FLTDTL.FLTCARIDR = LEG1.FLTCARIDR
						 AND FLTDTL.FLTORG    = LEG1.LEGORG    
						  INNER JOIN  FLTOPRLEG LEG2
						  ON   FLTDTL.CMPCOD     = LEG2.CMPCOD
						  AND FLTDTL.FLTNUM    = LEG2.FLTNUM
						  AND FLTDTL.FLTSEQNUM = LEG2.FLTSEQNUM
						  AND FLTDTL.FLTCARIDR = LEG2.FLTCARIDR    
						  AND FLTDTL.FLTDST    = LEG2.LEGDST
						 INNER JOIN FLTOPRSEG FLTSEG
					  ON FLTSEG.CMPCOD     = FLTDTL.CMPCOD
					  AND FLTSEG.FLTNUM    = FLTDTL.FLTNUM
					  AND FLTSEG.FLTSEQNUM = FLTDTL.FLTSEQNUM
					  AND FLTSEG.FLTCARIDR = FLTDTL.FLTCARIDR
					  AND FLTSEG.SEGORG = FLTDTL.FLTORG
					  AND FLTSEG.SEGDST = FLTDTL.FLTDST
					  AND FLTSEG.SEGSTA <> 'D'
                      AND FLTSEG.SEGSERNUM = FLTDTL.SEGSERNUM
					  INNER JOIN CAPBKGMST BKGMST 
					ON FLTDTL.CMPCOD  = BKGMST.CMPCOD
					    AND FLTDTL.UBRNUM = BKGMST.UBRNUM 
					  INNER JOIN OPRSHPMST SHPMST 
					ON FLTDTL.CMPCOD     = SHPMST.CMPCOD
						AND FLTDTL.MSTDOCNUM = SHPMST.MSTDOCNUM 
					AND FLTDTL.SEQNUM    = SHPMST.SEQNUM
					AND FLTDTL.DUPNUM    = SHPMST.DUPNUM
						AND FLTDTL.DOCOWRIDR = SHPMST.DOCOWRIDR 
					  INNER JOIN PRDMST PMST 
					ON SHPMST.CMPCOD  = PMST.CMPCOD
						AND SHPMST.PRDNAM = PMST.PRDNAM 
						AND PKG_FRMWRK.Fun_String_Check(PMST.PRDCTG,?,',') > 0
					  LEFT OUTER JOIN OPRCOLSHPMST COLMST 
					ON FLTDTL.CMPCOD     = COLMST.CMPCOD
						AND FLTDTL.MSTDOCNUM = COLMST.COMMSTDOCNUM 
					AND FLTDTL.DUPNUM    = COLMST.COMDUPNUM
					AND FLTDTL.SEQNUM    = COLMST.COMSEQNUM
						AND FLTDTL.DOCOWRIDR = COLMST.COMDOCOWRIDR 
						LEFT OUTER JOIN OPRCOLSHPDTL COLDTL
					  ON COLMST.CMPCOD     = COLDTL.CMPCOD
					  AND COLMST.SEQNUM = COLDTL.COLSEQNUM
					  LEFT OUTER JOIN OPRARPSHP ARP
					ON SHPMST.CMPCOD          = ARP.CMPCOD
					AND SHPMST.MSTDOCNUM      = ARP.MSTDOCNUM
					AND SHPMST.DUPNUM         = ARP.DUPNUM
					AND SHPMST.SEQNUM         = ARP.SEQNUM
					AND SHPMST.DOCOWRIDR      = ARP.DOCOWRIDR
						AND NVL(ARP.ARPCOD,?) = ?
					  LEFT OUTER JOIN OPRCOLSHPULD COLULD 
					ON COLMST.CMPCOD  = COLULD.CMPCOD
					    AND COLMST.SEQNUM = COLULD.SEQNUM 
						LEFT OUTER JOIN OPRSEGULD SEGULD
						  ON COLULD.CMPCOD  = SEGULD.CMPCOD
						  AND COLULD.ULDNUM = SEGULD.ULDNUM
					WHERE LEG.CMPCOD    = ? 
						AND ( (LEG.LEGORG = ?
						AND TO_NUMBER(TO_CHAR(LEG.STD,'YYYYMMDDhh24miss')) BETWEEN ? AND ?
						AND LEG.LEGORG = FLTDTL.FLTORG )
						OR (LEG.LEGDST = ?
						AND TO_NUMBER(TO_CHAR(LEG.STA,'YYYYMMDDhh24miss')) BETWEEN ? AND ?
						AND LEG.LEGDST = FLTDTL.FLTDST ) )
						AND EXISTS
						  (SELECT 1
						  FROM FLTOPRMST FLTMST ,
							FLTOPRSEG SEG
						  WHERE FLTMST.CMPCOD  = FLTDTL.CMPCOD
						  AND FLTMST.FLTNUM    = FLTDTL.FLTNUM
						  AND FLTMST.FLTSEQNUM = FLTDTL.FLTSEQNUM
						  AND FLTMST.FLTCARIDR = FLTDTL.FLTCARIDR
						  AND SEG.CMPCOD       = FLTDTL.CMPCOD
						  AND SEG.FLTNUM       = FLTDTL.FLTNUM
						  AND SEG.FLTSEQNUM    = FLTDTL.FLTSEQNUM
						  AND SEG.FLTCARIDR    = FLTDTL.FLTCARIDR
						  AND SEG.SEGORG       = FLTDTL.FLTORG
						  AND SEG.SEGDST       = FLTDTL.FLTDST
						  AND SUBSTR(FLTMST.FLTROU, INSTR(FLTMST.FLTROU,SEG.SEGORG), INSTR(FLTMST.FLTROU,SEG.SEGDST)-INSTR(FLTMST.FLTROU,SEG.SEGORG)+3 ) LIKE ?
					)
		]]>
	</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>7</QRY:Id>
	<QRY:Source Name="operations.cooltool.listcoolshipmentdetails.commercialpositioning" Type="NATIVE">
		<![CDATA[ 
			POSSHPDTL AS 
			(SELECT  'P' AS SHPTYP,
				  LEG1.LEGORG,
				  LEG2.LEGDST,
				  FLTDTL.FLTORG,
				  FLTDTL.FLTDST,
				  LEG1.ATD,LEG1.ETD,
				  LEG2.ATA,LEG2.ETA,
				  NULL AS ACPPCS,
				  NULL AS AVLPCS,
				  NULL AS RCVPCS,
				  NULL AS TOTDLVPCS,
				  NULL AS ARPCOD,
			  SHPMST.CMPCOD, 
			  SHPMST.MSTDOCNUM, 
			  SHPMST.SHPPFX, 
			  SHPMST.SEQNUM, 
			  SHPMST.DUPNUM , 
			  SHPMST.DOCOWRIDR, 
			  SHPMST.SCCCOD, 
			  SHPMST.PRDNAM,
			  SHPMST.SHPNAM, 
			  SHPMST.SHPCOD, 
			  SHPMST.ORGCOD, 
			  SHPMST.DSTCOD, 
			  FLTDTL.FLTCARCOD, 
			  FLTDTL.FLTNUM, 
			  FLTDTL.FLTDAT,
			  FLTDTL.FLTCARIDR, 
			  FLTDTL.FLTSEQNUM, 
			  FLTDTL.FLTBKGSTA,
			  LEG1.STD, 
			  LEG2.STA, NVL(COLMST.SEQNUM,0) COLSEQNUM,
			  BKGMST.BKGSTA, 
			  BKGMST.CUSNAM,
			  NULL AS MAXSHPTPT, 
			  NULL AS MINSHPTPT, 
			  NULL AS SPRVSNFLG,
				  NULL AS ULDNUM,
				  NULL AS MFTULD,
			  NULL AS ENVTPT ,
				(SELECT DISTINCT 'Y' AS TRMCPTFLG FROM OPRCOLSHPFLTULD FTLULD WHERE
					COLMST.CMPCOD  = FTLULD.CMPCOD
					AND COLMST.SEQNUM = FTLULD.SEQNUM
					AND FTLULD.FLTNUM = FLTDTL.FLTNUM
					AND FTLULD.FLTSEQNUM = FLTDTL.FLTSEQNUM        
					AND FTLULD.ORDNUM IS NOT NULL) TRMCPTFLG	
			FROM SHPDTL DTL 
			INNER JOIN OPRCOLSHPMST COLMST 
				ON DTL.CMPCOD     = COLMST.CMPCOD
			AND DTL.MSTDOCNUM = COLMST.COMMSTDOCNUM 
				AND DTL.DUPNUM    = COLMST.COMDUPNUM
				AND DTL.SEQNUM    = COLMST.COMSEQNUM
			AND DTL.DOCOWRIDR = COLMST.COMDOCOWRIDR 
			INNER JOIN CAPBKGFLTDTL FLTDTL 
				ON COLMST.CMPCOD        = FLTDTL.CMPCOD
			AND COLMST.POSMSTDOCNUM = FLTDTL.MSTDOCNUM 
				AND COLMST.POSSEQNUM    = FLTDTL.SEQNUM
				AND COLMST.POSDUPNUM    = FLTDTL.DUPNUM
			AND COLMST.POSDOCOWRIDR = FLTDTL.DOCOWRIDR 
			INNER JOIN CAPBKGMST BKGMST 
				ON FLTDTL.CMPCOD  = BKGMST.CMPCOD
			AND FLTDTL.UBRNUM = BKGMST.UBRNUM 
			INNER JOIN FLTOPRLEG LEG 
				ON FLTDTL.CMPCOD     = LEG.CMPCOD
				AND FLTDTL.FLTNUM    = LEG.FLTNUM
			AND FLTDTL.FLTSEQNUM = LEG.FLTSEQNUM 
			AND FLTDTL.FLTCARIDR = LEG.FLTCARIDR 
			 INNER JOIN  FLTOPRLEG LEG1
			  ON   FLTDTL.CMPCOD     = LEG1.CMPCOD
			  AND FLTDTL.FLTNUM    = LEG1.FLTNUM
			  AND FLTDTL.FLTSEQNUM = LEG1.FLTSEQNUM
			  AND FLTDTL.FLTCARIDR = LEG1.FLTCARIDR
			 AND FLTDTL.FLTORG    = LEG1.LEGORG    
			  INNER JOIN  FLTOPRLEG LEG2
			  ON   FLTDTL.CMPCOD     = LEG2.CMPCOD
			  AND FLTDTL.FLTNUM    = LEG2.FLTNUM
			  AND FLTDTL.FLTSEQNUM = LEG2.FLTSEQNUM
			  AND FLTDTL.FLTCARIDR = LEG2.FLTCARIDR    
			  AND FLTDTL.FLTDST    = LEG2.LEGDST
			INNER JOIN OPRSHPMST SHPMST 
				ON COLMST.CMPCOD        = SHPMST.CMPCOD
			AND COLMST.POSMSTDOCNUM = SHPMST.MSTDOCNUM 
				AND COLMST.POSSEQNUM    = SHPMST.SEQNUM
			AND COLMST.POSDOCOWRIDR = SHPMST.DOCOWRIDR 
				AND COLMST.POSDUPNUM    = SHPMST.DUPNUM
		]]>
	</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>8</QRY:Id>
	<QRY:Source Name="operations.cooltool.listcoolshipmentdetails.commercialrepositioning" Type="NATIVE">
		<![CDATA[ 
			REPSHPDTL AS 
			(SELECT 'R' AS SHPTYP , 
			  LEG1.LEGORG,
			  LEG2.LEGDST,
			  FLTDTL.FLTORG,
			  FLTDTL.FLTDST,
			  LEG1.ATD,LEG1.ETD,
			  LEG2.ATA,LEG2.ETA,
			  NULL AS ACPPCS,
			  NULL AS AVLPCS,
			  NULL AS RCVPCS,
			  NULL AS TOTDLVPCS,
			  NULL AS ARPCOD,
			  SHPMST.CMPCOD, 
			  SHPMST.MSTDOCNUM, 
			  SHPMST.SHPPFX, 
			  SHPMST.SEQNUM, 
			  SHPMST.DUPNUM , 
			  SHPMST.DOCOWRIDR, 
			  SHPMST.SCCCOD, 
			  SHPMST.PRDNAM, 
			  SHPMST.SHPNAM, 
			  SHPMST.SHPCOD, 
			  SHPMST.ORGCOD, 
			  SHPMST.DSTCOD, 
			  FLTDTL.FLTCARCOD, 
			  FLTDTL.FLTNUM, 
			  FLTDTL.FLTDAT,
			  FLTDTL.FLTCARIDR, 
			  FLTDTL.FLTSEQNUM, 
			  FLTDTL.FLTBKGSTA,
			  LEG1.STD, 
			  LEG2.STA,NVL(COLMST.SEQNUM,0) COLSEQNUM,
			  BKGMST.BKGSTA, 
              BKGMST.CUSNAM,			  
			  NULL AS MAXSHPTPT, 
			  NULL AS MINSHPTPT, 
			  NULL AS SPRVSNFLG,
			  NULL AS ULDNUM,
			  NULL AS MFTULD,
			  NULL AS ENVTPT,
			  (SELECT DISTINCT 'Y' AS TRMCPTFLG FROM OPRCOLSHPFLTULD FTLULD WHERE
			  	COLMST.CMPCOD  = FTLULD.CMPCOD
				AND COLMST.SEQNUM = FTLULD.SEQNUM
				AND FTLULD.FLTNUM = FLTDTL.FLTNUM
				AND FTLULD.FLTSEQNUM = FLTDTL.FLTSEQNUM        
				AND FTLULD.ORDNUM IS NOT NULL) TRMCPTFLG
			FROM SHPDTL DTL 
			INNER JOIN OPRCOLSHPMST COLMST 
			ON DTL.CMPCOD     = COLMST.CMPCOD
			AND DTL.MSTDOCNUM = COLMST.COMMSTDOCNUM 
			AND DTL.DUPNUM    = COLMST.COMDUPNUM
			AND DTL.SEQNUM    = COLMST.COMSEQNUM
			AND DTL.DOCOWRIDR = COLMST.COMDOCOWRIDR 
			INNER JOIN CAPBKGFLTDTL FLTDTL 
			ON COLMST.CMPCOD        = FLTDTL.CMPCOD
			AND COLMST.REPMSTDOCNUM = FLTDTL.MSTDOCNUM 
			AND COLMST.REPSEQNUM    = FLTDTL.SEQNUM
			AND COLMST.REPDUPNUM    = FLTDTL.DUPNUM
			AND COLMST.REPDOCOWRIDR = FLTDTL.DOCOWRIDR 
			INNER JOIN CAPBKGMST BKGMST 
			ON FLTDTL.CMPCOD  = BKGMST.CMPCOD
			AND FLTDTL.UBRNUM = BKGMST.UBRNUM 
			INNER JOIN FLTOPRLEG LEG 
			ON FLTDTL.CMPCOD     = LEG.CMPCOD
			AND FLTDTL.FLTNUM    = LEG.FLTNUM
			AND FLTDTL.FLTSEQNUM = LEG.FLTSEQNUM 
			AND FLTDTL.FLTCARIDR = LEG.FLTCARIDR 
			 INNER JOIN  FLTOPRLEG LEG1
			  ON   FLTDTL.CMPCOD     = LEG1.CMPCOD
			  AND FLTDTL.FLTNUM    = LEG1.FLTNUM
			  AND FLTDTL.FLTSEQNUM = LEG1.FLTSEQNUM
			  AND FLTDTL.FLTCARIDR = LEG1.FLTCARIDR
			 AND FLTDTL.FLTORG    = LEG1.LEGORG    
			  INNER JOIN  FLTOPRLEG LEG2
			  ON   FLTDTL.CMPCOD     = LEG2.CMPCOD
			  AND FLTDTL.FLTNUM    = LEG2.FLTNUM
			  AND FLTDTL.FLTSEQNUM = LEG2.FLTSEQNUM
			  AND FLTDTL.FLTCARIDR = LEG2.FLTCARIDR    
			  AND FLTDTL.FLTDST    = LEG2.LEGDST
			INNER JOIN OPRSHPMST SHPMST 
			ON COLMST.CMPCOD        = SHPMST.CMPCOD
			AND COLMST.REPMSTDOCNUM = SHPMST.MSTDOCNUM 
			AND COLMST.REPSEQNUM    = SHPMST.SEQNUM
			AND COLMST.REPDOCOWRIDR = SHPMST.DOCOWRIDR 
			AND COLMST.REPDUPNUM    = SHPMST.DUPNUM
		]]>
	</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>9</QRY:Id>
	<QRY:Source Name="operations.cooltool.listcoolshipmentdetails.commercialcombine" Type="NATIVE">
		<![CDATA[ 
			CMPCOD,MSTDOCNUM,SEQNUM,DUPNUM,DOCOWRIDR) AS RANK
			  FROM (
				(    
				SELECT DISTINCT MIL.* 
				FROM(
				SELECT COM.*,HIS.TXNDES MILSTNCOD, 
					DENSE_RANK() OVER (PARTITION BY COM.CMPCOD,COM.DOCOWRIDR,COM.MSTDOCNUM,COM.SEQNUM,COM.DUPNUM ORDER BY HIS.TXNDATUTC DESC ) RNK
				FROM OPRSHPHIS HIS ,
					  COMBSHPDTL COM
					WHERE HIS.CMPCOD  = COM.CMPCOD
					AND HIS.MSTDOCNUM = COM.MSTDOCNUM
					AND HIS.SEQNUM    = COM.SEQNUM
					AND HIS.DUPNUM    = COM.DUPNUM
					AND HIS.DOCOWRIDR = COM.DOCOWRIDR
					AND HIS.TXNCOD <> 'STD'
		]]>
	</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>12</QRY:Id>
	<QRY:Source Name="operations.cooltool.listcoolshipmentdetails.movementpartone" Type="NATIVE">
		<![CDATA[ 
			WITH POSSHPDTL AS 
			  (SELECT 'P' AS SHPTYP, 
				LEG1.LEGORG,
				LEG2.LEGDST,
				FLTDTL.FLTORG,
				FLTDTL.FLTDST,
				LEG1.ATD,LEG1.ETD,
				LEG2.ATA,LEG2.ETA,
				NULL AS ACPPCS,
				NULL AS AVLPCS,
				NULL AS RCVPCS,
				NULL AS TOTDLVPCS,
				NULL AS ARPCOD,
				SHPMST.CMPCOD, 
				SHPMST.MSTDOCNUM, 
				SHPMST.SHPPFX, 
				SHPMST.SEQNUM, 
				SHPMST.DUPNUM , 
				SHPMST.DOCOWRIDR, 
				SHPMST.SCCCOD, 
				SHPMST.PRDNAM, 
				SHPMST.SHPNAM, 
				SHPMST.SHPCOD, 
				SHPMST.ORGCOD, 
				SHPMST.DSTCOD, 
				FLTDTL.FLTCARCOD, 
				FLTDTL.FLTNUM, 
				FLTDTL.FLTDAT,
				FLTDTL.FLTCARIDR, 
				FLTDTL.FLTSEQNUM, 
				FLTDTL.FLTBKGSTA,				
				LEG1.STD, 
				LEG2.STA, 
				BKGMST.BKGSTA, 
                BKGMST.CUSNAM,				
				NULL AS MAXSHPTPT, 
				NULL AS MINSHPTPT, 
				COLMST.SPRVSNFLG,
				NULL AS ULDNUM, 
				NULL AS MFTULD,
				NULL AS ENVTPT,
				COLMST.COMMSTDOCNUM, 
				COLMST.COMDUPNUM, 
				COLMST.COMSEQNUM, 
				COLMST.COMDOCOWRIDR, 
				COLMST.SEQNUM COLSEQNUM,
				(SELECT DISTINCT 'Y' AS TRMCPTFLG FROM OPRCOLSHPFLTULD FTLULD WHERE
			  	COLMST.CMPCOD  = FTLULD.CMPCOD
				AND COLMST.SEQNUM = FTLULD.SEQNUM
				AND FTLULD.FLTNUM = FLTDTL.FLTNUM
				AND FTLULD.FLTSEQNUM = FLTDTL.FLTSEQNUM        
				AND FTLULD.ORDNUM IS NOT NULL) TRMCPTFLG
			  FROM OPRCOLSHPMST COLMST 
			  INNER JOIN OPRSHPMST SHPMST 
			  ON COLMST.CMPCOD = SHPMST.CMPCOD 
			  AND COLMST.POSMSTDOCNUM = SHPMST.MSTDOCNUM 
			  AND COLMST.POSSEQNUM = SHPMST.SEQNUM 
			  AND COLMST.POSDOCOWRIDR = SHPMST.DOCOWRIDR 
			  AND COLMST.POSDUPNUM = SHPMST.DUPNUM 
			  INNER JOIN CAPBKGFLTDTL FLTDTL 
			  ON COLMST.CMPCOD = FLTDTL.CMPCOD 
			  AND COLMST.POSMSTDOCNUM = FLTDTL.MSTDOCNUM 
			  AND COLMST.POSSEQNUM = FLTDTL.SEQNUM 
			  AND COLMST.POSDUPNUM = FLTDTL.DUPNUM 
			  AND COLMST.POSDOCOWRIDR = FLTDTL.DOCOWRIDR 
			  INNER JOIN CAPBKGMST BKGMST 
			  ON FLTDTL.CMPCOD = BKGMST.CMPCOD 
			  AND FLTDTL.UBRNUM = BKGMST.UBRNUM 
			  INNER JOIN FLTOPRLEG LEG 
			  ON FLTDTL.CMPCOD = LEG.CMPCOD 
			  AND FLTDTL.FLTNUM = LEG.FLTNUM 
			  AND FLTDTL.FLTSEQNUM = LEG.FLTSEQNUM 
			  AND FLTDTL.FLTCARIDR = LEG.FLTCARIDR 
			   INNER JOIN  FLTOPRLEG LEG1
			  ON   FLTDTL.CMPCOD     = LEG1.CMPCOD
			  AND FLTDTL.FLTNUM    = LEG1.FLTNUM
			  AND FLTDTL.FLTSEQNUM = LEG1.FLTSEQNUM
			  AND FLTDTL.FLTCARIDR = LEG1.FLTCARIDR
			 AND FLTDTL.FLTORG    = LEG1.LEGORG    
			  INNER JOIN  FLTOPRLEG LEG2
			  ON   FLTDTL.CMPCOD     = LEG2.CMPCOD
			  AND FLTDTL.FLTNUM    = LEG2.FLTNUM
			  AND FLTDTL.FLTSEQNUM = LEG2.FLTSEQNUM
			  AND FLTDTL.FLTCARIDR = LEG2.FLTCARIDR    
			  AND FLTDTL.FLTDST    = LEG2.LEGDST
			  AND SHPMST.CMPCOD = ? 
		]]>
	</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>13</QRY:Id>
	<QRY:Source Name="operations.cooltool.listcoolshipmentdetails.movementparttwo" Type="NATIVE">
		<![CDATA[ 
			WITH AWBMOVDTL AS 
				 (SELECT   
MVTTYP AS SHPTYP, 
				LEG1.LEGORG,
				LEG2.LEGDST,
				FLTDTL.FLTORG,
				FLTDTL.FLTDST,
				LEG1.ATD,LEG1.ETD,
				LEG2.ATA,LEG2.ETA,
				NULL AS ACPPCS,
				NULL AS AVLPCS,
				NULL AS RCVPCS,
				NULL AS TOTDLVPCS,
				NULL AS ARPCOD,
				SHPMST.CMPCOD, 
				SHPMST.MSTDOCNUM, 
				SHPMST.SHPPFX, 
				SHPMST.SEQNUM, 
				SHPMST.DUPNUM , 
				SHPMST.DOCOWRIDR, 
				SHPMST.SCCCOD, 
				SHPMST.PRDNAM, 
				SHPMST.SHPNAM, 
				SHPMST.SHPCOD, 
				SHPMST.ORGCOD, 
				SHPMST.DSTCOD, 
				FLTDTL.FLTCARCOD, 
				FLTDTL.FLTNUM, 
				FLTDTL.FLTDAT,
				FLTDTL.FLTCARIDR, 
				FLTDTL.FLTSEQNUM, 
				FLTDTL.FLTBKGSTA,
				LEG1.STD, 
				LEG2.STA, 
				BKGMST.BKGSTA, 
                BKGMST.CUSNAM,				
				NULL AS MAXSHPTPT, 
				NULL AS MINSHPTPT, 
				COLMST.SPRVSNFLG,
				NULL AS ULDNUM, 
				NULL AS MFTULD,
				NULL AS ENVTPT,
				COLMST.COMMSTDOCNUM, 
				COLMST.COMDUPNUM, 
				COLMST.COMSEQNUM, 
				COLMST.COMDOCOWRIDR, 
				COLMST.SEQNUM COLSEQNUM,
				   (SELECT DISTINCT 'Y' AS TRMCPTFLG 
				   FROM OPRCOLSHPFLTULD FTLULD 
				   WHERE COLMST.CMPCOD = FTLULD.CMPCOD 
				AND COLMST.SEQNUM = FTLULD.SEQNUM
				AND FTLULD.FLTNUM = FLTDTL.FLTNUM
				AND FTLULD.FLTSEQNUM = FLTDTL.FLTSEQNUM        
				   AND FTLULD.ORDNUM IS NOT NULL 
				   ) TRMCPTFLG 
				 FROM OPRCOLSHPMVTDTL MVTDTL 
			  INNER JOIN OPRSHPMST SHPMST 
				 ON MVTDTL.CMPCOD = SHPMST.CMPCOD 
				 AND MVTDTL.MSTDOCNUM = SHPMST.MSTDOCNUM 
				 AND MVTDTL.SHPSEQNUM = SHPMST.SEQNUM 
				 AND MVTDTL.DOCOWRIDR = SHPMST.DOCOWRIDR 
				 AND MVTDTL.DUPNUM = SHPMST.DUPNUM 
				 INNER JOIN OPRCOLSHPMST COLMST 
				 ON COLMST.CMPCOD = MVTDTL.CMPCOD 
				 AND COLMST.SEQNUM = MVTDTL.SEQNUM 
			  INNER JOIN CAPBKGFLTDTL FLTDTL 
				 ON MVTDTL.CMPCOD = FLTDTL.CMPCOD 
				 AND MVTDTL.MSTDOCNUM = FLTDTL.MSTDOCNUM 
				 AND MVTDTL.SHPSEQNUM = FLTDTL.SEQNUM 
				 AND MVTDTL.DUPNUM = FLTDTL.DUPNUM 
				 AND MVTDTL.DOCOWRIDR = FLTDTL.DOCOWRIDR 
			  INNER JOIN CAPBKGMST BKGMST 
			  ON FLTDTL.CMPCOD = BKGMST.CMPCOD 
			  AND FLTDTL.UBRNUM = BKGMST.UBRNUM 
			  INNER JOIN FLTOPRLEG LEG 
			  ON FLTDTL.CMPCOD = LEG.CMPCOD 
			  AND FLTDTL.FLTNUM = LEG.FLTNUM 
			  AND FLTDTL.FLTSEQNUM = LEG.FLTSEQNUM 
			  AND FLTDTL.FLTCARIDR = LEG.FLTCARIDR 
			   INNER JOIN  FLTOPRLEG LEG1
			  ON   FLTDTL.CMPCOD     = LEG1.CMPCOD
			  AND FLTDTL.FLTNUM    = LEG1.FLTNUM
			  AND FLTDTL.FLTSEQNUM = LEG1.FLTSEQNUM
			  AND FLTDTL.FLTCARIDR = LEG1.FLTCARIDR
			 AND FLTDTL.FLTORG    = LEG1.LEGORG    
			  INNER JOIN  FLTOPRLEG LEG2
			  ON   FLTDTL.CMPCOD     = LEG2.CMPCOD
			  AND FLTDTL.FLTNUM    = LEG2.FLTNUM
			  AND FLTDTL.FLTSEQNUM = LEG2.FLTSEQNUM
			  AND FLTDTL.FLTCARIDR = LEG2.FLTCARIDR    
			  AND FLTDTL.FLTDST    = LEG2.LEGDST
			  AND SHPMST.CMPCOD = ? 
		]]>
	</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>14</QRY:Id>
	<QRY:Source Name="operations.cooltool.listcoolshipmentdetails.movementpartthree" Type="NATIVE">
		<![CDATA[ 
			COMSHPDTL AS 
			  (SELECT * FROM AWBMOVDTL 
			  UNION 
			  SELECT Z.* FROM
			  (SELECT 'C' AS SHPTYP,
				LEG1.LEGORG,
				LEG2.LEGDST,
				FLTDTL.FLTORG,
				FLTDTL.FLTDST,
				LEG1.ATD,LEG1.ETD,
				LEG2.ATA,LEG2.ETA,
				ARP.ACPPCS,
				ARP.AVLPCS,
				ARP.RCVPCS,
				ARP.TOTDLVPCS,
				ARP.ARPCOD,
				SHPMST.CMPCOD, 
				SHPMST.MSTDOCNUM, 
				SHPMST.SHPPFX, 
				SHPMST.SEQNUM, 
				SHPMST.DUPNUM , 
				SHPMST.DOCOWRIDR, 
				SHPMST.SCCCOD, 
				SHPMST.PRDNAM, 
				SHPMST.SHPNAM, 
				SHPMST.SHPCOD, 
				SHPMST.ORGCOD, 
				SHPMST.DSTCOD, 
				FLTDTL.FLTCARCOD, 
				FLTDTL.FLTNUM, 
				FLTDTL.FLTDAT,
				FLTDTL.FLTCARIDR, 
				FLTDTL.FLTSEQNUM, 
				FLTDTL.FLTBKGSTA,
				LEG1.STD, 
				LEG2.STA, 
				BKGMST.BKGSTA, 
                BKGMST.CUSNAM,				
				COLDTL.DATREF002 MAXSHPTPT,
				COLDTL.DATREF001 MINSHPTPT,
				COLMST.SPRVSNFLG,
				CASE
				  WHEN (COLULD.ULDCAT = 'ACT'
				  OR (COLULD.ULDCAT  IN ('PAS','VAL','PER')
				  AND SEGULD.THRUNT   = 'Y'))
				  THEN COLULD.ULDNUM
				  ELSE NULL
				END ULDNUM,
				(SELECT RTRIM(XMLAGG(XMLELEMENT(E, SEGULDSHP.ULDNUM
				  || ',')
				ORDER BY SEGULDSHP.ULDNUM).EXTRACT('//text()'), ',') ULD
				FROM OPRSEGULDSHP SEGULDSHP
				WHERE SEGULDSHP.CMPCOD  = SHPMST.CMPCOD
				AND SEGULDSHP.MSTDOCNUM = SHPMST.MSTDOCNUM
				AND SEGULDSHP.SEQNUM    = SHPMST.SEQNUM
				AND SEGULDSHP.DOCOWRIDR = SHPMST.DOCOWRIDR
				AND SEGULDSHP.DUPNUM    = SHPMST.DUPNUM
				AND SEGULDSHP.FLTNUM    = FLTDTL.FLTNUM
				AND SEGULDSHP.FLTSEQNUM = FLTDTL.FLTSEQNUM
				AND SEGULDSHP.FLTCARIDR = FLTDTL.FLTCARIDR
				AND SEGULDSHP.SEGSERNUM = FLTSEG.SEGSERNUM
				AND SEGULDSHP.ULDNUM <>'BULK'
				)MFTULD,
				(SELECT SUBSTR(RTRIM(XMLAGG(XMLELEMENT(E, SCCCOD
				||'#'
				||SCCPRY
				||'#'
				||TPTCFG.MAXTPT
				||'#'
				|| TPTCFG.MINTPT
				|| '~')
			  ORDER BY SCCPRY).EXTRACT('//text()')), 0, INSTR(RTRIM(XMLAGG(XMLELEMENT(E, SCCCOD
				||'#'
				||SCCPRY
				||'#'
				||TPTCFG.MAXTPT
				||'#'
				|| TPTCFG.MINTPT
				|| '~')
			  ORDER BY SCCPRY).EXTRACT('//text()')),'~',1,1)) TMP
			  FROM OPRCOLSCCTPTCFG TPTCFG
			  WHERE TPTCFG.CMPCOD = SHPMST.CMPCOD
			  AND INSTR(SHPMST.SCCCOD,TPTCFG.SCCCOD) > 0) AS ENVTPT,
				NULL AS COMMSTDOCNUM, 
				NULL AS COMDUPNUM, 
				NULL AS COMSEQNUM, 
				NULL AS COMDOCOWRIDR, 
				NULL AS COLSEQNUM,
				(SELECT DISTINCT 'Y' AS TRMCPTFLG FROM OPRCOLSHPFLTULD FTLULD WHERE
			  	COLMST.CMPCOD  = FTLULD.CMPCOD
				AND COLMST.SEQNUM = FTLULD.SEQNUM
				AND FTLULD.FLTNUM = FLTDTL.FLTNUM
				AND FTLULD.FLTSEQNUM = FLTDTL.FLTSEQNUM        
				AND FTLULD.ORDNUM IS NOT NULL) TRMCPTFLG
			  FROM FLTOPRLEG LEG
			  INNER JOIN CAPBKGFLTDTL FLTDTL
			  ON LEG.CMPCOD     = FLTDTL.CMPCOD
			  AND LEG.FLTNUM    = FLTDTL.FLTNUM
			  AND LEG.FLTSEQNUM = FLTDTL.FLTSEQNUM
			  AND LEG.FLTCARIDR = FLTDTL.FLTCARIDR
			   INNER JOIN  FLTOPRLEG LEG1
			  ON   FLTDTL.CMPCOD     = LEG1.CMPCOD
			  AND FLTDTL.FLTNUM    = LEG1.FLTNUM
			  AND FLTDTL.FLTSEQNUM = LEG1.FLTSEQNUM
			  AND FLTDTL.FLTCARIDR = LEG1.FLTCARIDR
			 AND FLTDTL.FLTORG    = LEG1.LEGORG    
			  INNER JOIN  FLTOPRLEG LEG2
			  ON   FLTDTL.CMPCOD     = LEG2.CMPCOD
			  AND FLTDTL.FLTNUM    = LEG2.FLTNUM
			  AND FLTDTL.FLTSEQNUM = LEG2.FLTSEQNUM
			  AND FLTDTL.FLTCARIDR = LEG2.FLTCARIDR    
			  AND FLTDTL.FLTDST    = LEG2.LEGDST
			   INNER JOIN FLTOPRSEG FLTSEG
			  ON FLTSEG.CMPCOD     = FLTDTL.CMPCOD
			  AND FLTSEG.FLTNUM    = FLTDTL.FLTNUM
			  AND FLTSEG.FLTSEQNUM = FLTDTL.FLTSEQNUM
			  AND FLTSEG.FLTCARIDR = FLTDTL.FLTCARIDR
			  AND FLTSEG.SEGORG = FLTDTL.FLTORG
			  AND FLTSEG.SEGDST = FLTDTL.FLTDST
			  INNER JOIN CAPBKGMST BKGMST
			  ON FLTDTL.CMPCOD  = BKGMST.CMPCOD
			  AND FLTDTL.UBRNUM = BKGMST.UBRNUM
			INNER JOIN OPRSHPMST SHPMST 
			  ON FLTDTL.CMPCOD     = SHPMST.CMPCOD
			  AND FLTDTL.MSTDOCNUM = SHPMST.MSTDOCNUM
			  AND FLTDTL.SEQNUM    = SHPMST.SEQNUM
			  AND FLTDTL.DUPNUM    = SHPMST.DUPNUM
			  AND FLTDTL.DOCOWRIDR = SHPMST.DOCOWRIDR
			  INNER JOIN AWBMOVDTL MOVDTL
			  ON MOVDTL.CMPCOD        = SHPMST.CMPCOD
			  AND MOVDTL.COMMSTDOCNUM = SHPMST.MSTDOCNUM 
			  AND MOVDTL.COMSEQNUM    = SHPMST.SEQNUM
			  AND MOVDTL.COMDUPNUM    = SHPMST.DUPNUM
			  AND MOVDTL.COMDOCOWRIDR = SHPMST.DOCOWRIDR 
			INNER JOIN PRDMST PMST 
			  ON SHPMST.CMPCOD  = PMST.CMPCOD
			  AND SHPMST.PRDNAM = PMST.PRDNAM 
			  AND PKG_FRMWRK.Fun_String_Check(PMST.PRDCTG,?,',') > 0
			  LEFT OUTER JOIN OPRCOLSHPMST COLMST
			  ON FLTDTL.CMPCOD     = COLMST.CMPCOD
			  AND FLTDTL.MSTDOCNUM = COLMST.COMMSTDOCNUM
			  AND FLTDTL.DUPNUM    = COLMST.COMDUPNUM
			  AND FLTDTL.SEQNUM    = COLMST.COMSEQNUM
			  AND FLTDTL.DOCOWRIDR = COLMST.COMDOCOWRIDR
			  LEFT OUTER JOIN OPRCOLSHPDTL COLDTL
			  ON COLMST.CMPCOD     = COLDTL.CMPCOD
			  AND COLMST.SEQNUM = COLDTL.COLSEQNUM
			  LEFT OUTER JOIN OPRARPSHP ARP
			  ON SHPMST.CMPCOD          = ARP.CMPCOD
			  AND SHPMST.MSTDOCNUM      = ARP.MSTDOCNUM
			  AND SHPMST.DUPNUM         = ARP.DUPNUM
			  AND SHPMST.SEQNUM         = ARP.SEQNUM
			  AND SHPMST.DOCOWRIDR      = ARP.DOCOWRIDR
			  AND NVL(ARP.ARPCOD,?) = ?
			LEFT OUTER JOIN OPRCOLSHPULD COLULD 
			  ON COLMST.CMPCOD  = COLULD.CMPCOD
			  AND COLMST.SEQNUM = COLULD.SEQNUM 
			  LEFT OUTER JOIN OPRSEGULD SEGULD
			  ON COLULD.CMPCOD  = SEGULD.CMPCOD
			  AND COLULD.ULDNUM = SEGULD.ULDNUM
			  WHERE LEG.CMPCOD    = ?
			  AND ( (LEG.LEGORG = ?
			  AND TO_NUMBER(TO_CHAR(LEG.STD,'YYYYMMDDhh24miss')) BETWEEN ? AND ?
			  AND LEG.LEGORG = FLTDTL.FLTORG
			  )
			  OR (LEG.LEGDST = ?
			  AND TO_NUMBER(TO_CHAR(LEG.STA,'YYYYMMDDhh24miss')) BETWEEN ? AND ?
			  AND LEG.LEGDST = FLTDTL.FLTDST
			  ) )
			  AND EXISTS
				(SELECT 1
				FROM FLTOPRMST FLTMST ,
				  FLTOPRSEG SEG
				WHERE FLTMST.CMPCOD  = FLTDTL.CMPCOD
				AND FLTMST.FLTNUM    = FLTDTL.FLTNUM
				AND FLTMST.FLTSEQNUM = FLTDTL.FLTSEQNUM
				AND FLTMST.FLTCARIDR = FLTDTL.FLTCARIDR
				AND SEG.CMPCOD       = FLTDTL.CMPCOD
				AND SEG.FLTNUM       = FLTDTL.FLTNUM
				AND SEG.FLTSEQNUM    = FLTDTL.FLTSEQNUM
				AND SEG.FLTCARIDR    = FLTDTL.FLTCARIDR
				AND SEG.SEGORG       = FLTDTL.FLTORG
				AND SEG.SEGDST       = FLTDTL.FLTDST
				AND SUBSTR(FLTMST.FLTROU, INSTR(FLTMST.FLTROU,SEG.SEGORG), INSTR(FLTMST.FLTROU,SEG.SEGDST)-INSTR(FLTMST.FLTROU,SEG.SEGORG)+3 ) LIKE ?
				)			  
		]]>
	</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>15</QRY:Id>
	<QRY:Source Name="operations.cooltool.listcoolshipmentdetails.movementpartfour" Type="NATIVE">
		<![CDATA[ 
			  CMPCOD,MSTDOCNUM,SEQNUM,DUPNUM,DOCOWRIDR) AS RANK
			  FROM (
				(    
				SELECT DISTINCT MIL.* 
				FROM(
				SELECT COM.*,HIS.TXNDES MILSTNCOD, 
					DENSE_RANK() OVER (PARTITION BY COM.CMPCOD,COM.DOCOWRIDR,COM.MSTDOCNUM,COM.SEQNUM,COM.DUPNUM ORDER BY HIS.TXNDATUTC DESC ) RNK
				  FROM OPRSHPHIS HIS , 
					  COMSHPDTL COM
					WHERE HIS.CMPCOD  = COM.CMPCOD
					AND HIS.MSTDOCNUM = COM.MSTDOCNUM
					AND HIS.SEQNUM    = COM.SEQNUM
					AND HIS.DUPNUM    = COM.DUPNUM
					AND HIS.DOCOWRIDR = COM.DOCOWRIDR
					AND HIS.TXNCOD <> 'STD'
		]]>
	</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>18</QRY:Id>
	<QRY:Source Name="operations.cooltool.findrepositioningcoolshipmentdetails" Type="NATIVE">
		<![CDATA[ 
			SELECT COLMST.POSDOCOWRIDR,
			  COLMST.POSMSTDOCNUM,
			  COLMST.POSDUPNUM,
			  COLMST.POSSEQNUM,
			  COLMST.POSSHPPFX,
			  COLMST.COMDOCOWRIDR,
			  COLMST.COMMSTDOCNUM,
			  COLMST.COMDUPNUM,
			  COLMST.COMSEQNUM,
			  SHPMST.SHPPFX
			FROM OPRCOLSHPMST COLMST
			  INNER JOIN OPRSHPMST SHPMST 
			  ON COLMST.CMPCOD = SHPMST.CMPCOD 
			  AND COLMST.COMMSTDOCNUM = SHPMST.MSTDOCNUM 
			  AND COLMST.COMSEQNUM = SHPMST.SEQNUM 
			  AND COLMST.COMDOCOWRIDR = SHPMST.DOCOWRIDR 
			  AND COLMST.COMDUPNUM = SHPMST.DUPNUM 
			WHERE COLMST.CMPCOD = ?
			AND COLMST.REPDOCOWRIDR = ?
			AND COLMST.REPMSTDOCNUM   = ?
			AND COLMST.REPDUPNUM      = ?
			AND COLMST.REPSEQNUM      = ?
		]]>
	</QRY:Source>
	</QRY:Definition>
	<!-- Added for ICRD-91967 by A-6385 starts -->
	<QRY:Definition>
		<QRY:Id>19</QRY:Id>
			<QRY:Source Name="operations.cooltool.listcoolcheckcheetconfiguration" Type="NATIVE">
				<![CDATA[
				SELECT PARCOD,PARDES,WRKFLONAM FROM OPRCOLCHKSHTCFG MST 
				WHERE MST.CMPCOD = ?
				]]>
			</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>20</QRY:Id>
			<QRY:Source Name="operations.cooltool.findcoolchecksheetconfiguration" Type="NATIVE">
				<![CDATA[
				SELECT 
				coolCheckSheetConfiguration 
				FROM 
				com.ibsplc.icargo.business.operations.cooltool.CoolCheckSheetConfiguration AS coolCheckSheetConfiguration 
				WHERE 
				coolCheckSheetConfiguration.coolCheckSheetConfigurationPK.companyCode = ?
		]]>
	</QRY:Source>
	</QRY:Definition>		  
	<QRY:Definition>
	    <QRY:Id>21</QRY:Id>
	    <QRY:Source Name="operations.cooltool.finduldassignmentdetails" Type="OBJECT">
	      <![CDATA[     	
			  SELECT coolShipmentUld from com.ibsplc.icargo.business.operations.cooltool.CoolShipmentUld as coolShipmentUld 
			   WHERE coolShipmentUld.coolShipmentUldPK.companyCode=? AND coolShipmentUld.coolShipmentUldPK.sequenceNumber=? 	
			]]>    
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	    <QRY:Id>22</QRY:Id>
	    <QRY:Source Name="operations.cooltool.finduldorderdetails" Type="OBJECT">
	      <![CDATA[     	
			  SELECT coolShipmentUldType from com.ibsplc.icargo.business.operations.cooltool.CoolShipmentUldType as coolShipmentUldType 
			  WHERE coolShipmentUldType.coolShipmentUldTypePK.companyCode=? AND coolShipmentUldType.coolShipmentUldTypePK.sequenceNumber=?		
			]]>    
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	    <QRY:Id>23</QRY:Id>
	    <QRY:Source Name="operations.cooltool.checkifuldsintransaction" Type="NATIVE">
	      <![CDATA[  
				  SELECT ULD.CMPCOD CMPCOD,
				  ULD.ULDNUM,
				  ULD.POL,
				  ULD.POU,
				  ULD.FLTCARIDR,
				  ULD.FLTNUM,
				  ULD.FLTSEQNUM,
				  (
				  CASE ARLMST.APHCODUSE
					WHEN 2
					THEN ARLMST.TWOAPHCOD
					ELSE ARLMST.THRAPHCOD
				  END) FLTCARCOD,
				  FLT.STD FLTDAT
				FROM OPRULDDTL ULD
				INNER JOIN SHRARLMST ARLMST
				ON ULD.CMPCOD     = ARLMST.CMPCOD
				AND ULD.FLTCARIDR = ARLMST.ARLIDR
				LEFT OUTER JOIN FLTOPRLEG FLT
				ON ULD.CMPCOD                  =FLT.CMPCOD
				AND ULD.FLTNUM                 =FLT.FLTNUM
				AND ULD.FLTCARIDR              =FLT.FLTCARIDR
				AND ULD.FLTSEQNUM              =FLT.FLTSEQNUM
				AND ULD.LEGSERNUM              =FLT.LEGSERNUM
						WHERE (ULD.CMPCOD,ULD.ULDNUM) IN 			  	
			]]>    
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	    <QRY:Id>24</QRY:Id>
	    <QRY:Source Name="operations.cooltool.findoperationalulddetails" Type="NATIVE">
	      <![CDATA[ SELECT DISTINCT MST.CMPCOD,
					  MST. MSTDOCNUM ,
					  MST.SEQNUM ,
					  MST.DUPNUM ,
					  MST.DOCOWRIDR ,
						  FLTSEG.POL, 
						  FLTSEG.POU, 
						  SEGULDSHP.FLTNUM, 
						  SEGULDSHP.FLTSEQNUM, 
					  SEGULDSHP.FLTCARIDR,
					  (SELECT RTRIM(xmlagg(xmlelement(e, ACPDTL.ULDNUM
						|| ',')
					  ORDER BY ACPDTL.ULDNUM).EXTRACT('//text()'), ',') uld
					  FROM OPRULDACPDTL ACPDTL
					  WHERE ACPDTL.CMPCOD  = MST.CMPCOD
					  AND ACPDTL.MSTDOCNUM = MST.MSTDOCNUM
					  AND ACPDTL.DUPNUM    = MST.DUPNUM
					  AND ACPDTL.SEQNUM    = MST.SEQNUM
					  AND ACPDTL.DOCOWRIDR = MST.DOCOWRIDR
					  ) ACPULD,
					  (SELECT RTRIM(xmlagg(xmlelement(e, ULDFLT.ULDNUM
						|| ',')
						ORDER BY ULDFLT.ULDNUM).EXTRACT('//text()'), ',') ULD
						FROM OPRSEGULDSHP ULDFLT
					  WHERE ULDFLT.CMPCOD  =SEGULDSHP.CMPCOD
					  AND ULDFLT.FLTCARIDR =SEGULDSHP.FLTCARIDR
					  AND ULDFLT.FLTNUM    =SEGULDSHP.FLTNUM
					  AND ULDFLT.FLTSEQNUM =SEGULDSHP.FLTSEQNUM
					  AND ULDFLT.SEGSERNUM =SEGULDSHP.SEGSERNUM
					  AND ULDFLT.MSTDOCNUM =SEGULDSHP.MSTDOCNUM
					  AND ULDFLT.DUPNUM =SEGULDSHP.DUPNUM
					  AND ULDFLT.SEQNUM =SEGULDSHP.SEQNUM
				      AND ULDFLT.DOCOWRIDR =SEGULDSHP.DOCOWRIDR 
					  AND COALESCE (ULDFLT.ULDNUM,'BULK')                                     <> 'BULK'
					  )MFTULD
					FROM OPRSHPMST MST,
					  OPRSEGULDSHP SEGULDSHP,
					  OPRSEGULD ULD,
					  OPRFLTSEG FLTSEG
					WHERE MST.CMPCOD                                                      = SEGULDSHP.CMPCOD(+)
					AND MST.MSTDOCNUM                                                     = SEGULDSHP.MSTDOCNUM(+)
					AND MST.DUPNUM                                                        = SEGULDSHP.DUPNUM(+)
					AND MST.SEQNUM                                                        = SEGULDSHP.SEQNUM(+)
					AND MST.DOCOWRIDR                                                     = SEGULDSHP.DOCOWRIDR(+)
					AND SEGULDSHP.CMPCOD                                                  =ULD.CMPCOD(+)
					AND SEGULDSHP.FLTCARIDR                                               =ULD.FLTCARIDR(+)
					AND SEGULDSHP.FLTNUM                                                  =ULD.FLTNUM(+)
					AND SEGULDSHP.FLTSEQNUM                                               =ULD.FLTSEQNUM(+)
					AND SEGULDSHP.SEGSERNUM                                               =ULD.SEGSERNUM(+)
					AND ULD.ULDNUM (+)                                <> 'BULK'
					AND SEGULDSHP.CMPCOD                                                  =FLTSEG.CMPCOD(+)
					AND SEGULDSHP.FLTCARIDR                                               =FLTSEG.FLTCARIDR(+)
					AND SEGULDSHP.FLTNUM                                                  =FLTSEG.FLTNUM(+)
					AND SEGULDSHP.FLTSEQNUM                                               =FLTSEG.FLTSEQNUM(+)
					AND SEGULDSHP.SEGSERNUM                                               =FLTSEG.SEGSERNUM(+)
					AND (MST.CMPCOD,MST.MSTDOCNUM,MST.DOCOWRIDR, MST.DUPNUM, MST.SEQNUM) IN
			]]>    
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	    <QRY:Id>25</QRY:Id>
	    <QRY:Source Name="operations.cooltool.listcoolshipmentdetails.commercialinboundcondtn" Type="NATIVE">
	      <![CDATA[     	
			  WHERE 
				(Z.LEGORG = ?
				AND Z.FLTORG = ?
				AND Z.ORGCOD = ?
				AND Z.ACPPCS IS NULL 
				AND Z.ATD IS NULL) 
				OR 
				(Z.LEGDST = ?)
			]]>    
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	    <QRY:Id>26</QRY:Id>
	    <QRY:Source Name="operations.cooltool.listcoolshipmentdetails.commercialoutboundcondtn" Type="NATIVE">
	      <![CDATA[     	
			  WHERE
				(Z.LEGORG = ?
				AND Z.FLTORG = ?
				AND Z.ORGCOD = ?
				AND Z.ATD IS NULL)
				OR
				(Z.LEGORG = ?
				AND Z.FLTORG = ?
				AND Z.ORGCOD <> ?
				AND Z.ATD IS NULL)
				OR
				(Z.LEGDST = ?
				AND Z.FLTDST = ?
				AND Z.DSTCOD = ?
				AND (COALESCE(Z.AVLPCS,1) <> 0) 
				AND (Z.TOTDLVPCS IS NULL OR Z.TOTDLVPCS < Z.RCVPCS))
				OR
				(Z.LEGORG = ?
				AND Z.ATD IS NULL)
		   ]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
			<QRY:Id>27</QRY:Id>
				<QRY:Source Name="operations.cooltool.listcoolworkconfiguration" Type="NATIVE">
					<![CDATA[
					SELECT WRKFLONAM,DATTYP,POSVAL,VALUNT FROM OPRCOLWRKCFG CFG
					WHERE CFG.CMPCOD = ?
					]]>
				</QRY:Source>
		</QRY:Definition>
		<QRY:Definition>
			<QRY:Id>28</QRY:Id>
				<QRY:Source Name="operations.cooltool.findcoolworkconfigurationdetails" Type="OBJECT">
					<![CDATA[
					SELECT
					coolWorkConfiguration
					FROM
					com.ibsplc.icargo.business.operations.cooltool.CoolWorkConfiguration AS coolWorkConfiguration
					WHERE
					coolWorkConfiguration.coolWorkConfigurationPK.companyCode = ?
			]]>    
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>28</QRY:Id>
	<QRY:Source Name="operations.cooltool.listcoolshipmentdetails.shipmentmovementdetails" Type="NATIVE">
		<![CDATA[ 
			SHPMOVDTL AS 
			(SELECT MVTDTL.MVTTYP AS SHPTYP, 
			  LEG1.LEGORG, 
			  LEG2.LEGDST, 
			  FLTDTL.FLTORG, 
			  FLTDTL.FLTDST, 
			  LEG1.ATD, LEG1.ETD,
			  LEG2.ATA, LEG2.ETA,
			  NULL AS ACPPCS, 
			  NULL AS AVLPCS, 
			  NULL AS RCVPCS, 
			  NULL AS TOTDLVPCS, 
			  NULL AS ARPCOD, 
			  SHPMST.CMPCOD, 
			  SHPMST.MSTDOCNUM, 
			  SHPMST.SHPPFX, 
			  SHPMST.SEQNUM, 
			  SHPMST.DUPNUM , 
			  SHPMST.DOCOWRIDR, 
			  SHPMST.SCCCOD, 
			  SHPMST.PRDNAM, 
			  SHPMST.SHPNAM, 
			  SHPMST.SHPCOD, 
			  SHPMST.ORGCOD, 
			  SHPMST.DSTCOD, 
			  FLTDTL.FLTCARCOD, 
			  FLTDTL.FLTNUM, 
			  FLTDTL.FLTDAT, 
			  FLTDTL.FLTCARIDR, 
			  FLTDTL.FLTSEQNUM, 
			  FLTDTL.FLTBKGSTA, 
			  LEG1.STD, 
			  LEG2.STA, NVL(COLMST.SEQNUM,0) COLSEQNUM,
			  BKGMST.BKGSTA, 
			  BKGMST.CUSNAM, 
			  NULL AS MAXSHPTPT, 
			  NULL AS MINSHPTPT, 
			  NULL AS SPRVSNFLG, 
			  NULL AS ULDNUM, 
			  NULL as ULDMVTDTL, 
			  NULL AS MFTULD, 
			  NULL AS ENVTPT , 
			  (SELECT DISTINCT 'Y' AS TRMCPTFLG 
			  FROM OPRCOLSHPFLTULD FTLULD 
			  WHERE COLMST.CMPCOD = FTLULD.CMPCOD 
			  AND COLMST.SEQNUM = FTLULD.SEQNUM 
			  AND FTLULD.FLTNUM = FLTDTL.FLTNUM 
			  AND FTLULD.FLTSEQNUM = FLTDTL.FLTSEQNUM 
			  AND FTLULD.ORDNUM IS NOT NULL 
			  ) TRMCPTFLG , NULL AS PRDCTG
			FROM SHPDTL DTL 
			INNER JOIN OPRCOLSHPMST COLMST 
			ON DTL.CMPCOD = COLMST.CMPCOD 
			AND DTL.MSTDOCNUM = COLMST.COMMSTDOCNUM 
			AND DTL.DUPNUM = COLMST.COMDUPNUM 
			AND DTL.SEQNUM = COLMST.COMSEQNUM 
			AND DTL.DOCOWRIDR = COLMST.COMDOCOWRIDR 
			 INNER JOIN OPRCOLSHPMVTDTL MVTDTL 
			ON MVTDTL.CMPCOD = COLMST.CMPCOD 
			AND MVTDTL.SEQNUM = COLMST.SEQNUM 
			INNER JOIN CAPBKGFLTDTL FLTDTL 
			ON MVTDTL.CMPCOD = FLTDTL.CMPCOD 
			AND MVTDTL.MSTDOCNUM = FLTDTL.MSTDOCNUM 
			AND MVTDTL.SHPSEQNUM = FLTDTL.SEQNUM 
			AND MVTDTL.DUPNUM = FLTDTL.DUPNUM 
			AND MVTDTL.DOCOWRIDR = FLTDTL.DOCOWRIDR 
			INNER JOIN CAPBKGMST BKGMST 
			ON FLTDTL.CMPCOD = BKGMST.CMPCOD 
			AND FLTDTL.UBRNUM = BKGMST.UBRNUM 
			INNER JOIN FLTOPRLEG LEG 
			ON FLTDTL.CMPCOD = LEG.CMPCOD 
			AND FLTDTL.FLTNUM = LEG.FLTNUM 
			AND FLTDTL.FLTSEQNUM = LEG.FLTSEQNUM 
			AND FLTDTL.FLTCARIDR = LEG.FLTCARIDR 
			 INNER JOIN  FLTOPRLEG LEG1
			  ON   FLTDTL.CMPCOD     = LEG1.CMPCOD
			  AND FLTDTL.FLTNUM    = LEG1.FLTNUM
			  AND FLTDTL.FLTSEQNUM = LEG1.FLTSEQNUM
			  AND FLTDTL.FLTCARIDR = LEG1.FLTCARIDR
			 AND FLTDTL.FLTORG    = LEG1.LEGORG    
			  INNER JOIN  FLTOPRLEG LEG2
			  ON   FLTDTL.CMPCOD     = LEG2.CMPCOD
			  AND FLTDTL.FLTNUM    = LEG2.FLTNUM
			  AND FLTDTL.FLTSEQNUM = LEG2.FLTSEQNUM
			  AND FLTDTL.FLTCARIDR = LEG2.FLTCARIDR    
			  AND FLTDTL.FLTDST    = LEG2.LEGDST
			INNER JOIN OPRSHPMST SHPMST 
			ON MVTDTL.CMPCOD = SHPMST.CMPCOD 
			AND MVTDTL.MSTDOCNUM = SHPMST.MSTDOCNUM 
			AND MVTDTL.SHPSEQNUM = SHPMST.SEQNUM 
			AND MVTDTL.DOCOWRIDR = SHPMST.DOCOWRIDR 
			AND MVTDTL.DUPNUM = SHPMST.DUPNUM 
		]]>
	</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>13</QRY:Id>
		<QRY:Source Name="operations.cooltool.listcoolshipmentdetails.uldbookingpartone" Type="NATIVE">
			<![CDATA[ 
					WITH AWBMOVDTL AS 
					(SELECT 
					MVTDTL.MVTTYP AS SHPTYP,
					LEG1.LEGORG, 
					  LEG2.LEGDST, 
					  FLTDTL.SEGORG AS FLTORG, 
					  FLTDTL.SEGDST AS FLTDST, 
					  LEG1.ATD, LEG1.ETD,
					  LEG2.ATA, LEG2.ETA,
					  BKGMST.CMPCOD, 
					  BKGMST.SCCCOD, 
					  BKGMST.ORGCOD, 
					  BKGMST.DSTCOD, 
					  FLTDTL.FLTCARCOD, 
					  FLTDTL.FLTNUM, 
					  FLTDTL.FLTDAT, 
					  FLTDTL.FLTCARIDR, 
					  FLTDTL.FLTSEQNUM, 
					  FLTDTL.SEGSTA AS FLTBKGSTA, 
					  LEG1.STD, 
					  LEG2.STA, 
					  BKGMST.BKGSTA, 
					  (SELECT CUSNAM 
					  FROM SHRCUSMST CUSMST 
					  WHERE CUSMST.CMPCOD= BKGMST.CMPCOD 
					  AND CUSMST.CUSCOD = BKGMST.CUSCOD 
					  )CUSNAM, 
					  NULL AS MAXSHPTPT, 
					  NULL AS MINSHPTPT, 
					  NULL AS SPRVSNFLG, 
					  NULL AS MFTULD, 
					  COLULD.ULDNUM, 
					  NULL AS ENVTPT, 
					  COLMST.COMMSTDOCNUM AS MSTDOCNUM, 
					  COLMST.COMDUPNUM AS DUPNUM, 
					  COLMST.COMSEQNUM AS SEQNUM, 
					  COLMST.COMDOCOWRIDR AS DOCOWRIDR, 
					  SHPMST.SHPPFX,
					  COLMST.SEQNUM COLSEQNUM, 
					  (SELECT DISTINCT 'Y' AS TRMCPTFLG 
					  FROM OPRCOLSHPFLTULD FTLULD 
					  WHERE COLMST.CMPCOD = FTLULD.CMPCOD 
					  AND COLMST.SEQNUM = FTLULD.SEQNUM 
					  AND FTLULD.FLTNUM = FLTDTL.FLTNUM 
					  AND FTLULD.FLTSEQNUM = FLTDTL.FLTSEQNUM 
					  AND FTLULD.ORDNUM IS NOT NULL 
					  ) TRMCPTFLG, 
					  MVTDTL.ULDBKGIDR AS ULDMVTDTL
					FROM FLTOPRLEG LEG 
					INNER JOIN CAPULDBKGFLTDTL FLTDTL 
					ON LEG.CMPCOD = FLTDTL.CMPCOD 
					AND LEG.FLTNUM = FLTDTL.FLTNUM 
					AND LEG.FLTSEQNUM = FLTDTL.FLTSEQNUM 
					AND LEG.FLTCARIDR = FLTDTL.FLTCARIDR 
					 INNER JOIN  FLTOPRLEG LEG1
					  ON   FLTDTL.CMPCOD     = LEG1.CMPCOD
					  AND FLTDTL.FLTNUM    = LEG1.FLTNUM
					  AND FLTDTL.FLTSEQNUM = LEG1.FLTSEQNUM
					  AND FLTDTL.FLTCARIDR = LEG1.FLTCARIDR
					 AND FLTDTL.SEGORG    = LEG1.LEGORG    
					  INNER JOIN  FLTOPRLEG LEG2
					  ON   FLTDTL.CMPCOD     = LEG2.CMPCOD
					  AND FLTDTL.FLTNUM    = LEG2.FLTNUM
					  AND FLTDTL.FLTSEQNUM = LEG2.FLTSEQNUM
					  AND FLTDTL.FLTCARIDR = LEG2.FLTCARIDR    
					  AND FLTDTL.SEGDST    = LEG2.LEGDST
					INNER JOIN FLTOPRSEG FLTSEG 
					ON FLTSEG.CMPCOD = FLTDTL.CMPCOD 
					AND FLTSEG.FLTNUM = FLTDTL.FLTNUM 
					AND FLTSEG.FLTSEQNUM = FLTDTL.FLTSEQNUM 
					AND FLTSEG.FLTCARIDR = FLTDTL.FLTCARIDR 
					AND FLTSEG.SEGORG = FLTDTL.SEGORG 
					AND FLTSEG.SEGDST = FLTDTL.SEGDST 
					INNER JOIN CAPULDBKGMST BKGMST 
					ON FLTDTL.CMPCOD = BKGMST.CMPCOD 
					AND FLTDTL.ULDBKGIDR = BKGMST.ULDBKGIDR 
					INNER JOIN OPRCOLSHPMVTDTL MVTDTL 
					ON MVTDTL.CMPCOD = BKGMST.CMPCOD 
					AND MVTDTL.ULDBKGIDR = BKGMST.ULDBKGIDR 
					INNER JOIN OPRCOLSHPMST COLMST 
					ON COLMST.CMPCOD = MVTDTL.CMPCOD 
					AND COLMST.SEQNUM = MVTDTL.SEQNUM 
					INNER JOIN OPRSHPMST SHPMST 
					ON COLMST.CMPCOD = SHPMST.CMPCOD 
					AND COLMST.COMMSTDOCNUM = SHPMST.MSTDOCNUM 
					AND COLMST.COMSEQNUM = SHPMST.SEQNUM 
					AND COLMST.COMDUPNUM = SHPMST.DUPNUM 
					AND COLMST.COMDOCOWRIDR = SHPMST.DOCOWRIDR 
					LEFT OUTER JOIN OPRCOLSHPULD COLULD 
					ON COLMST.CMPCOD = COLULD.CMPCOD 
					AND COLMST.SEQNUM = COLULD.SEQNUM 
					WHERE BKGMST.CMPCOD = ?
					AND ( (LEG.LEGORG = ?
					AND LEG.LEGORG = FLTDTL.SEGORG ) 
					OR (LEG.LEGDST = ?
					AND LEG.LEGDST = FLTDTL.SEGDST ) ) 
					AND ( (LEG.LEGORG = ? 
					AND TO_NUMBER(TO_CHAR(LEG.STD,'YYYYMMDDhh24miss')) BETWEEN ? AND ?
					AND LEG.LEGORG = FLTDTL.SEGORG ) 
					OR (LEG.LEGDST = ?
					AND TO_NUMBER(TO_CHAR(LEG.STA,'YYYYMMDDhh24miss')) BETWEEN ? AND ?
					AND LEG.LEGDST = FLTDTL.SEGDST ) ) 
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>13</QRY:Id>
		<QRY:Source Name="operations.cooltool.listcoolshipmentdetails.uldbookingparttwo" Type="NATIVE">
			<![CDATA[ 
					COMSHPDTL AS 
					(SELECT * FROM AWBMOVDTL 
					UNION 
					SELECT Z.* 
					FROM 
					  (SELECT 
						'SP' AS SHPTYP,
						LEG1.LEGORG, 
						LEG2.LEGDST, 
						FLTDTL.SEGORG, 
						FLTDTL.SEGDST, 
						LEG1.ATD, LEG1.ETD,
						LEG2.ATA, LEG2.ETA,
						BKGMST.CMPCOD, 
						BKGMST.SCCCOD, 
						BKGMST.ORGCOD, 
						BKGMST.DSTCOD, 
						FLTDTL.FLTCARCOD, 
						FLTDTL.FLTNUM, 
						FLTDTL.FLTDAT, 
						FLTDTL.FLTCARIDR, 
						FLTDTL.FLTSEQNUM, 
						FLTDTL.SEGSTA AS FLTBKGSTA, 
						LEG1.STD, 
						LEG2.STA, COLMST.SEQNUM COLSEQNUM,
						BKGMST.BKGSTA, 
						(SELECT CUSNAM 
						FROM SHRCUSMST CUSMST 
						WHERE CUSMST.CMPCOD=BKGMST.CMPCOD 
						AND CUSMST.CUSCOD = BKGMST.CUSCOD 
						)CUSNAM, 
						COLDTL.DATREF002 MAXSHPTPT,
						COLDTL.DATREF001 MINSHPTPT,
						COLMST.SPRVSNFLG, 
						NULL AS MFTULD, 
						CASE
						  WHEN (COLULD.ULDCAT = 'ACT'
						  OR (COLULD.ULDCAT  IN ('PAS','VAL','PER')
						  AND SEGULD.THRUNT   = 'Y'))
						  THEN COLULD.ULDNUM
						  ELSE NULL
						END ULDNUM,
						(SELECT SUBSTR(RTRIM(XMLAGG(XMLELEMENT(E, SCCCOD 
						  ||'#' 
						  ||SCCPRY 
						  ||'#' 
						  ||TPTCFG.MAXTPT 
						  ||'#' 
						  || TPTCFG.MINTPT 
						  || '~') 
						ORDER BY SCCPRY).EXTRACT('//text()')), 0, INSTR(RTRIM(XMLAGG(XMLELEMENT(E, SCCCOD 
						  ||'#' 
						  ||SCCPRY 
						  ||'#' 
						  ||TPTCFG.MAXTPT 
						  ||'#' 
						  || TPTCFG.MINTPT 
						  || '~') 
						ORDER BY SCCPRY).EXTRACT('//text()')),'~',1,1)) TMP 
						FROM OPRCOLSCCTPTCFG TPTCFG 
						WHERE TPTCFG.CMPCOD = BKGMST.CMPCOD 
						AND INSTR(BKGMST.SCCCOD,TPTCFG.SCCCOD) > 0 
						) AS ENVTPT, 
						NULL AS MSTDOCNUM, 
						NULL AS DUPNUM, 
						NULL AS SEQNUM, 
						NULL AS DOCOWRIDR, 
						NULL AS SHPPFX,
						NULL AS COLSEQNUM, 
						(SELECT DISTINCT 'Y' AS TRMCPTFLG 
						FROM OPRCOLSHPFLTULD FTLULD 
						WHERE COLMST.CMPCOD = FTLULD.CMPCOD 
						AND COLMST.SEQNUM = FTLULD.SEQNUM 
						AND FTLULD.FLTNUM = FLTDTL.FLTNUM 
						AND FTLULD.FLTSEQNUM = FLTDTL.FLTSEQNUM 
						AND FTLULD.ORDNUM IS NOT NULL 
						) TRMCPTFLG, 
						COLMST.ULDBKGIDR AS ULDMVTDTL
					  FROM FLTOPRLEG LEG 
					  INNER JOIN CAPULDBKGFLTDTL FLTDTL 
					  ON LEG.CMPCOD = FLTDTL.CMPCOD 
					  AND LEG.FLTNUM = FLTDTL.FLTNUM 
					  AND LEG.FLTSEQNUM = FLTDTL.FLTSEQNUM 
					  AND LEG.FLTCARIDR = FLTDTL.FLTCARIDR 
					   INNER JOIN  FLTOPRLEG LEG1
					  ON   FLTDTL.CMPCOD     = LEG1.CMPCOD
					  AND FLTDTL.FLTNUM    = LEG1.FLTNUM
					  AND FLTDTL.FLTSEQNUM = LEG1.FLTSEQNUM
					  AND FLTDTL.FLTCARIDR = LEG1.FLTCARIDR
					 AND FLTDTL.SEGORG    = LEG1.LEGORG    
					  INNER JOIN  FLTOPRLEG LEG2
					  ON   FLTDTL.CMPCOD     = LEG2.CMPCOD
					  AND FLTDTL.FLTNUM    = LEG2.FLTNUM
					  AND FLTDTL.FLTSEQNUM = LEG2.FLTSEQNUM
					  AND FLTDTL.FLTCARIDR = LEG2.FLTCARIDR    
					  AND FLTDTL.SEGDST    = LEG2.LEGDST
					  INNER JOIN FLTOPRSEG FLTSEG 
					  ON FLTSEG.CMPCOD = FLTDTL.CMPCOD 
					  AND FLTSEG.FLTNUM = FLTDTL.FLTNUM 
					  AND FLTSEG.FLTSEQNUM = FLTDTL.FLTSEQNUM 
					  AND FLTSEG.FLTCARIDR = FLTDTL.FLTCARIDR 
					  AND FLTSEG.SEGORG = FLTDTL.SEGORG 
					  AND FLTSEG.SEGDST = FLTDTL.SEGDST 
					  INNER JOIN CAPULDBKGMST BKGMST 
					  ON FLTDTL.CMPCOD = BKGMST.CMPCOD 
					  AND FLTDTL.ULDBKGIDR = BKGMST.ULDBKGIDR 
					  INNER JOIN OPRCOLSHPMST COLMST 
					  ON FLTDTL.CMPCOD = COLMST.CMPCOD 
					  AND FLTDTL.ULDBKGIDR = COLMST.ULDBKGIDR 
					  LEFT OUTER JOIN OPRCOLSHPDTL COLDTL
					  ON COLMST.CMPCOD     = COLDTL.CMPCOD
					  AND COLMST.SEQNUM = COLDTL.COLSEQNUM
					  LEFT OUTER JOIN OPRCOLSHPULD COLULD 
					  ON COLMST.CMPCOD = COLULD.CMPCOD 
					  AND COLMST.SEQNUM = COLULD.SEQNUM 
					  LEFT OUTER JOIN OPRSEGULD SEGULD
					  ON COLULD.CMPCOD  = SEGULD.CMPCOD
					  AND COLULD.ULDNUM = SEGULD.ULDNUM
					  WHERE BKGMST.CMPCOD = ?
					  AND ( (LEG.LEGORG = ? 
					  AND LEG.LEGORG = FLTDTL.SEGORG ) 
					  OR (LEG.LEGDST = ? 
					  AND LEG.LEGDST = FLTDTL.SEGDST ) ) 
					  AND ( (LEG.LEGORG = ? 
					  AND TO_NUMBER(TO_CHAR(LEG.STD,'YYYYMMDDhh24miss')) BETWEEN ? AND ?
					  AND LEG.LEGORG = FLTDTL.SEGORG ) 
					  OR (LEG.LEGDST = ?
					  AND TO_NUMBER(TO_CHAR(LEG.STA,'YYYYMMDDhh24miss')) BETWEEN ? AND ?
					  AND LEG.LEGDST = FLTDTL.SEGDST ) ) 
					  
			]]>    
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>16</QRY:Id>
		<QRY:Source Name="operations.cooltool.specialshipmentdetails.findspecialuldassignmentDetails" Type="NATIVE">
			<![CDATA[ 
			SELECT DISTINCT COLULD.CMPCOD,
				  COLULD.SEQNUM,
				  COLULD.ULDNUM,
				  TO_CHAR(COLULD.ASNDAT,'dd-MON-yyyy') ASNDAT,
				  COLULD.CLSFLG,
				  COLULD.ULDCAT
				FROM OPRCOLSHPMST COLMST
				INNER JOIN OPRCOLSHPULD COLULD
				ON COLMST.CMPCOD  = COLULD.CMPCOD
				AND COLMST.SEQNUM = COLULD.SEQNUM
				LEFT OUTER JOIN OPRSEGULD SEGULD
				ON COLULD.CMPCOD   = SEGULD.CMPCOD
				AND COLULD.ULDNUM  = SEGULD.ULDNUM
				WHERE COLMST.CMPCOD = ?
				AND COLMST.SEQNUM  = ?
				AND (ULDCAT        = 'ACT'
				OR (ULDCAT        IN ('PAS','VAL','PER')
				AND SEGULD.THRUNT  = 'Y'))
			]]>    
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>29</QRY:Id>
		<QRY:Source Name="operations.cooltool.findoperationalcoolshipmentforaudit" Type="NATIVE">
			<![CDATA[ 
			SELECT SHPAUD.CMPCOD,
					 SHPAUD.COMMSTDOCNUM,
					 SHPAUD.COMDOCOWRIDR,
					 SHPAUD.COMSEQNUM,
					 SHPAUD.COMDUPNUM,
					 SHPAUD.ADLINF,
					 SHPAUD.AUDRMK,
					 SHPAUD.SERNUM,
					 SHPAUD.STNCOD,
					 SHPAUD.TRGPNT,
					 SHPAUD.ACTCOD,
					 SHPAUD.UPDTXNTIM,
					 SHPAUD.UPDUSR
					 FROM OPRCOLSHPAUD SHPAUD
					 WHERE
					 SHPAUD.UPDTXNTIMUTC >= ?
					 AND SHPAUD.UPDTXNTIMUTC <= ?
					 AND SHPAUD.COMMSTDOCNUM = ?
					 AND SHPAUD.COMDOCOWRIDR = ?
					 AND SHPAUD.CMPCOD = ?
					 AND SHPAUD.COMDUPNUM = ?
					 AND SHPAUD.COMSEQNUM = ?
					 ORDER BY SHPAUD.UPDTXNTIM DESC 
			]]>     
		</QRY:Source>
	</QRY:Definition>
</QRY:Definitions>
