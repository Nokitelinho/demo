<?xml version="1.0"?>
<QRY:Definitions xmlns:QRY="http://www.ibsplc.com/xibase/persistence/queries" module="mail.operations">
	<QRY:Definition>
	<QRY:Id>1</QRY:Id>
		<QRY:Source Name="mail.operations.findmldconfigurations" Type="NATIVE">
			<![CDATA[
				SELECT CFG.CMPCOD,CFG.CARIDR,CFG.ARPCOD,CFG.ALLREQFLG,CFG.UPLREQFLG,CFG.DLVREQFLG,CFG.HNDREQFLG,CFG.RECREQFLG,CFG.STGREQFLG,CFG.NSTREQFLG
,CFG.RCFREQFLG,CFG.TFDREQFLG,CFG.RCTREQFLG,CFG.RETREQFLG,CFG.MLDVER FROM
				MALMLDCFG CFG
				WHERE
				CFG.CMPCOD = ? 
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>2</QRY:Id>
		<QRY:Source Name="mail.operations.findflightassignedmailsinuld" Type="NATIVE">
			<![CDATA[
						SELECT CON.CMPCOD, 
					  CON.FLTCARIDR,
					  CON.FLTNUM,
					  CON.CONNUM,
					  CON.FLTSEQNUM,
					  CON.LEGSERNUM,
					  CON.ASGPRT,
					  CON.CONTYP,
					  CON.SEGSERNUM,
					  CON.CNTIDR,
					  CON.POU,
					  CON.POAFLG,
					  MALMST.MALSRVLVL MALSRVLVL,
					  MALMST.ORGCOD ORGCOD,
					  MALMST.DSTCOD DSTCOD,
					  MALMST.DSN,
					  MALMST.ORGEXGOFC,
					  MALMST.DSTEXGOFC,
					  MALMST.YER,
					  MALMST.MALCTG MALCTGCOD,
					  MALMST.MALSUBCLS,
					  MALMST.RSN,
					  MALMST.HSN,
					  MALMST.REGIND,
					  MALMST.MALCLS,
					  MALMST.MALTYP,
					  MALMST.MALRMK,
					  MALMST.WGT,
					  MALMST.DSPWGT,
					  MALMST.DSPWGTUNT,
					  MALMST.CSGDOCNUM CSGDOCNUM,
					  MALMST.CSGSEQNUM CSGSEQNUM,
					  MALMST.POACOD POACOD,
					  CSGMST.CSGDAT CSGDAT,
					  MALMST.DSPDAT ACPDAT,
					  MALSEG.ACPWGT CSGACPWGT,
					  MALSEG.ACPBAG CSGACPBAG,
					  MALSEG.STDBAG CSGSTDBAG,
					  MALSEG.STDWGT CSGSTDWGT,
					  NULL ACPUSR,
					  MALMST.MALIDR MALIDR,
					  MALMST.MALSEQNUM MALSEQNUM,
					  MALSEG.DMGFLG DMGFLG,
				      MALMST.SELNUM,
					  MALSEG.ARRSELNUM,
					  MALSEG.FRMCARCOD MALFRMCARCOD,
					  MALMST.VOL,
					  MALMST.VOLUNT,
					  0 STDVOL,
					  0 ACPVOL,
					  MALMST.CSGDOCNUM MALCSGDOCNUM,
					  MALMST.CSGSEQNUM MALCSGDOCSEQ,
					  MALMST.POACOD MALPOACOD,
					  MALMST.MALCMPCOD MALCMPCOD,
					  MALMST.SCNPRT SCNPRT,
					  MALMST.MALSTA MALSTA,
					  MALMST.OPRSTA OPRSTA,
                      MALMST.MSTDOCNUM MSTDOCNUM,
                      MALMST.DOCOWRIDR DOCOWRIDR,
                      MALMST.SHPPFX SHPPFX,
					  MALMST.DUPNUM DUPNUM,
					  MALMST.SEQNUM SEQNUM,
					  CON.ULDFULIND,
					  CON.ULDREFNUM,
					  CASE
						WHEN EXISTS
						  (SELECT 1
						  FROM MALHIS HIS
						  WHERE HIS.CMPCOD = MALMST.CMPCOD
						  AND HIS.MALSEQNUM=MALMST.MALSEQNUM
						  AND HIS.MALSTA  IN ('ARR')
						  )
						THEN 'Y'
						ELSE 'N'
					  END ARRSTA,
					  DMGMAL.DMGCOD,
					  DMGMAL.DMGDAT,
					  DMGMAL.ARPCOD,
					  DMGMAL.DMGDES,
					  DMGMAL.RMK,
					  MALMST.SCNDAT SCNDAT,
					  MALMST.LSTUPDTIM MALLSTUPDTIM,
					  NULL BLYCRTIDR,
					  MALMST.ACPPOACONNUM ACPPOACONNUM,
					  MALMST.ACPARPCOD ACPARPCOD,
					  MALMST.SECSTACOD SECSTACOD
					FROM MALFLTCON CON
					INNER JOIN MALULDSEGDTL MALSEG
					ON CON.CMPCOD     = MALSEG.CMPCOD
					AND CON.FLTCARIDR = MALSEG.FLTCARIDR
					AND CON.FLTNUM    = MALSEG.FLTNUM
					AND CON.FLTSEQNUM = MALSEG.FLTSEQNUM
					AND CON.SEGSERNUM = MALSEG.SEGSERNUM
					AND CON.CONNUM    = MALSEG.ULDNUM
					AND MALSEG.ACPSTA = 'Y'
					LEFT OUTER JOIN MALMST MALMST
					ON MALSEG.MALSEQNUM = MALMST.MALSEQNUM
					AND MALSEG.CMPCOD   = MALMST.CMPCOD
					LEFT OUTER JOIN MALDMGDTL DMGMAL
					ON MALMST.MALSEQNUM = DMGMAL.MALSEQNUM
					AND MALMST.CMPCOD   = DMGMAL.CMPCOD
					LEFT OUTER JOIN MALCSGMST CSGMST
					ON CSGMST.CMPCOD     = MALMST.CMPCOD
					AND CSGMST.CSGDOCNUM = MALMST.CSGDOCNUM
					AND CSGMST.POACOD    = MALMST.POACOD
					AND CSGMST.CSGSEQNUM = MALMST.CSGSEQNUM
					WHERE CON.CMPCOD    = ?
					AND CON.FLTCARIDR   = ?
					AND CON.FLTNUM      = ?
					AND CON.FLTSEQNUM   = ?
					AND CON.LEGSERNUM   = ?
					AND CON.ASGPRT      = ?
					AND CON.CONNUM      = ?
					AND CON.CONTYP      = 'U'
					ORDER BY DSN,
					  ORGEXGOFC,
					  DSTEXGOFC,
					  YER,
					  MALCTGCOD,
					  MALSUBCLS,
					  CSGDOCNUM,
					  CSGSEQNUM,
					  POACOD
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>3</QRY:Id>
		<QRY:Source Name="mail.operations.findflightassignedmailsinbulk" Type="NATIVE">
			<![CDATA[
					SELECT CON.CMPCOD,
					CON.FLTCARIDR,
					CON.FLTNUM,
					CON.CONNUM,
					CON.FLTSEQNUM,
					CON.LEGSERNUM,
					CON.ASGPRT,
					CON.CONTYP,
					CON.SEGSERNUM,
					CON.CNTIDR,
					CON.POU,
					CON.POAFLG,
					MALMST.MALSRVLVL MALSRVLVL,
					MALMST.ORGCOD ORGCOD,
					MALMST.DSTCOD DSTCOD,
					MALMST.DSN,
					MALMST.ORGEXGOFC,
					MALMST.DSTEXGOFC,
					MALMST.YER,
					MALMST.MALCTG MALCTGCOD,
					MALMST.MALSUBCLS,
					MALMST.MALCLS,
					MALMST.RSN,
					MALMST.HSN,
					MALMST.REGIND,
					MALMST.MALTYP,
					MALMST.MALRMK,
					MALMST.WGT,
					MALMST.DSPWGT,
					MALMST.DSPWGTUNT,
					MALMST.CSGDOCNUM CSGDOCNUM,
					MALMST.CSGSEQNUM CSGSEQNUM,
					MALMST.POACOD POACOD,
					CSGMST.CSGDAT CSGDAT,
					MALMST.DSPDAT ACPDAT,
					MALSEG.ACPWGT CSGACPWGT,
					MALSEG.ACPBAG CSGACPBAG,
					MALSEG.STDBAG CSGSTDBAG,
					MALSEG.STDWGT CSGSTDWGT,
					NULL ACPUSR,
					MALMST.MALIDR MALIDR,
					MALMST.MALSEQNUM MALSEQNUM,
					MALSEG.DMGFLG DMGFLG,
					MALMST.SELNUM,
					MALSEG.ARRSELNUM,
					MALSEG.FRMCARCOD MALFRMCARCOD,
					MALMST.VOL,
					MALMST.VOLUNT,
					0 STDVOL,
					0 ACPVOL,
					MALMST.CSGDOCNUM MALCSGDOCNUM,
					MALMST.CSGSEQNUM MALCSGDOCSEQ,
					MALMST.POACOD MALPOACOD,
					MALMST.MALCMPCOD MALCMPCOD,
					MALMST.SCNPRT SCNPRT,
					MALMST.MALSTA MALSTA,
					MALMST.OPRSTA OPRSTA,
					CON.ULDFULIND,
					CON.ULDREFNUM,
					CASE
					WHEN EXISTS
					(SELECT 1
					FROM MALHIS HIS
					WHERE HIS.CMPCOD  = MALMST.CMPCOD
					AND HIS.MALSEQNUM = MALMST.MALSEQNUM
					AND HIS.MALSTA   IN ('ARR')
					)
					THEN 'Y'
					ELSE 'N'
					END ARRSTA,
					DMGMAL.DMGCOD,
					DMGMAL.DMGDAT,
					DMGMAL.ARPCOD,
					DMGMAL.DMGDES,
					DMGMAL.RMK,
					MALMST.SCNDAT SCNDAT,
					MALMST.LSTUPDTIM MALLSTUPDTIM,
					NULL BLYCRTIDR,
					MALMST.ACPPOACONNUM ACPPOACONNUM,
					MALMST.ACPARPCOD ACPARPCOD,
					MALMST.MSTDOCNUM MSTDOCNUM,
                    MALMST.DOCOWRIDR DOCOWRIDR,
                    MALMST.SHPPFX SHPPFX,
					MALMST.SECSTACOD SECSTACOD,
					MALMST.DUPNUM DUPNUM,
+					MALMST.SEQNUM SEQNUM
					FROM MALFLTCON CON
					LEFT OUTER JOIN MALULDSEGDTL MALSEG
					ON CON.CMPCOD     = MALSEG.CMPCOD
					AND CON.FLTCARIDR = MALSEG.FLTCARIDR
					AND CON.FLTNUM    = MALSEG.FLTNUM
					AND CON.FLTSEQNUM = MALSEG.FLTSEQNUM
					AND CON.SEGSERNUM = MALSEG.SEGSERNUM
					AND CON.CONNUM    = MALSEG.CONNUM
					AND MALSEG.ACPSTA = 'Y'
					LEFT OUTER JOIN MALMST MALMST
					ON MALSEG.CMPCOD    =MALMST.CMPCOD
					AND MALSEG.MALSEQNUM=MALMST.MALSEQNUM
					LEFT OUTER JOIN MALDMGDTL DMGMAL
					ON MALMST.CMPCOD     = DMGMAL.CMPCOD
					AND MALMST.MALSEQNUM = DMGMAL.MALSEQNUM
					LEFT OUTER JOIN MALCSGMST CSGMST
					ON CSGMST.CMPCOD     = MALMST.CMPCOD
					AND CSGMST.CSGDOCNUM = MALMST.CSGDOCNUM
					AND CSGMST.POACOD    = MALMST.POACOD
					AND CSGMST.CSGSEQNUM = MALMST.CSGSEQNUM
					WHERE CON.CMPCOD     = ?
					AND CON.FLTCARIDR    = ?
					AND CON.FLTNUM       = ?
					AND CON.FLTSEQNUM    = ?
					AND CON.LEGSERNUM    = ?
					AND CON.ASGPRT       = ?
					AND CON.CONNUM       = ?
					AND CON.CONTYP       = 'B'
					ORDER BY DSN,
					ORGEXGOFC,
					DSTEXGOFC,
					YER,
					MALCTGCOD,
					MALSUBCLS,
					CSGDOCNUM,
					CSGSEQNUM,
					POACOD
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>4</QRY:Id>
		<QRY:Source Name="mail.operations.findcarrierassignedmailsinuld" Type="NATIVE">
				<![CDATA[
					SELECT MST.CMPCOD CMPCOD ,
					MST.CONNUM CONNUM ,
					MST.FLTCARIDR FLTCARIDR,
					MST.FLTNUM FLTNUM,
					MST.ASGPRT ASGPRT,
					MST.FLTSEQNUM FLTSEQNUM,
					MST.LEGSERNUM LEGSERNUM,
					MST.SEGSERNUM SEGSERNUM,
					MST.CONTYP,
					MALMST.DSN,
					MALMST.ORGEXGOFC,
					MALMST.DSTEXGOFC,
					MALMST.YER,
					MALMST.MALCTG MALCTGCOD,
					MALMST.MALSUBCLS,
					MALMST.RSN,
					MALMST.HSN,
					MALMST.REGIND,
					MALMST.MALCLS,
					MALMST.MALTYP,
					MALMST.MALRMK,
					MALMST.DSPWGT,
					MALMST.DSPWGTUNT,
					MALMST.CSGDOCNUM CSGDOCNUM,
					MALMST.CSGSEQNUM CSGSEQNUM,
					MALMST.POACOD POACOD,
					CSGMST.CSGDAT CSGDAT,
					MALMST.DSPDAT ACPDAT,
					ARPULD.ACPBAG CSGACPBAG,
					ARPULD.ACPWGT CSGACPWGT,
					ARPULD.STDBAG CSGSTDBAG,
					ARPULD.STDWGT CSGSTDWGT,
					NULL ACPUSR,
					ARPULD.DMGFLG,
					COALESCE(MALULD.FRMCARCOD,ARPULD.FRMCARCOD) AS MALTRFCAR,
					MALMST.MALIDR,
					MALMST.MALSEQNUM MALSEQNUM,
					MALMST.SCNDAT,
					MALMST.SCNPRT,
					MALMST.OPRSTA,
					MALMST.POU,
					MALMST.RSN,
					MALMST.WGT,
					MALMST.HSN,
					MALMST.REGIND,
					MALMST.LSTUPDTIM MALLSTUPDTIM,
					MALMST.VOL,
					MALMST.VOLUNT,
					0 STDVOL,
					0 ACPVOL,
					MALMST.CSGDOCNUM MALCSGDOCNUM,
					MALMST.MALCMPCOD MALCMPCOD,
					MALMST.MALSTA MALSTA,
					MST.ULDFULIND ULDFULIND,
					MST.ULDREFNUM ULDREFNUM,
					CASE
					WHEN EXISTS
					  (SELECT 1
					  FROM MALHIS HIS
					  WHERE HIS.CMPCOD  = MALMST.CMPCOD
					  AND HIS.MALSEQNUM = MALMST.MALSEQNUM
					  AND HIS.MALSTA   IN ('ARR')
					  )
					THEN 'Y'
					ELSE 'N'
					END ARRSTA,
					DMGMAL.DMGCOD,
					DMGMAL.DMGDAT,
					DMGMAL.ARPCOD,
					DMGMAL.DMGDES,
					DMGMAL.RMK,
					NULL BLYCRTIDR,
					0 SELNUM,
					0 ARRSELNUM,
					MALMST.ACPPOACONNUM ACPPOACONNUM,
					MALMST.ACPARPCOD ACPARPCOD,
					MALMST.MSTDOCNUM MSTDOCNUM,
                    MALMST.DOCOWRIDR DOCOWRIDR,
                    MALMST.SHPPFX SHPPFX
					FROM MALFLTCON MST
					LEFT OUTER JOIN MALARPULD MALULD
					ON MST.CMPCOD     = MALULD.CMPCOD
					AND MST.CONNUM    = MALULD.ULDNUM
					AND MST.ASGPRT    = MALULD.ARPCOD
					AND MST.FLTCARIDR = MALULD.FLTCARIDR
					LEFT OUTER JOIN MALARPULDDTL ARPULD
					ON MALULD.CMPCOD     = ARPULD.CMPCOD
					AND MALULD.ULDNUM    = ARPULD.ULDNUM
					AND MALULD.ARPCOD    = ARPULD.ARPCOD
					AND MALULD.FLTCARIDR = ARPULD.FLTCARIDR
					INNER JOIN MALMST MALMST
					ON MALULD.CMPCOD     = MALMST.CMPCOD
					AND ARPULD.MALSEQNUM = MALMST.MALSEQNUM
					AND ARPULD.CONNUM=MALMST.CONNUM
					LEFT OUTER JOIN MALDMGDTL DMGMAL
					ON MALMST.CMPCOD     = DMGMAL.CMPCOD
					AND MALMST.MALSEQNUM = DMGMAL.MALSEQNUM
					LEFT OUTER JOIN MALCSGMST CSGMST
					ON CSGMST.CMPCOD     = MALMST.CMPCOD
					AND CSGMST.CSGDOCNUM = MALMST.CSGDOCNUM
					AND CSGMST.POACOD    = MALMST.POACOD
					AND CSGMST.CSGSEQNUM = MALMST.CSGSEQNUM
					WHERE MST.CMPCOD     = ?
					AND MST.FLTCARIDR    =?
					AND MST.FLTNUM       = ?
					AND MST.FLTSEQNUM    =?
					AND MST.LEGSERNUM    = ?
					AND MST.ASGPRT       = ?
					AND MST.CONNUM       = ?
					AND MST.CONTYP       = 'U'
					ORDER BY DSN,
					ORGEXGOFC,
					DSTEXGOFC,
					YER,
					MALCTGCOD,
					MALSUBCLS,
					CSGDOCNUM,
					CSGSEQNUM,
					POACOD
				]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>5</QRY:Id>
		<QRY:Source Name="mail.operations.findcarrierassignedmailsinbulk" Type="NATIVE">
				<![CDATA[
						SELECT MST.CMPCOD CMPCOD ,
						MST.CONNUM CONNUM ,
						MST.FLTCARIDR FLTCARIDR,
						MST.FLTNUM FLTNUM,
						MST.ASGPRT ASGPRT,
						MST.FLTSEQNUM FLTSEQNUM,
						MST.LEGSERNUM LEGSERNUM,
						MST.SEGSERNUM SEGSERNUM,
						MST.CONTYP,
						MALMST.DSN,
						MALMST.ORGEXGOFC,
						MALMST.DSTEXGOFC,
						MALMST.YER,
						MALMST.MALCTG MALCTGCOD,
						MALMST.MALSUBCLS,
						MALMST.MALCLS,
						MALMST.MALTYP,
						MALMST.MALRMK,
						MALMST.DSPWGT,
					    MALMST.DSPWGTUNT,
						MALMST.CSGDOCNUM CSGDOCNUM,
						MALMST.CSGSEQNUM CSGSEQNUM,
						MALMST.POACOD POACOD,
						CSGMST.CSGDAT CSGDAT,
						MALMST.DSPDAT ACPDAT,
						ARPULD.ACPBAG CSGACPBAG,
						ARPULD.ACPWGT CSGACPWGT,
						ARPULD.STDBAG CSGSTDBAG,
						ARPULD.STDWGT CSGSTDWGT,
						NULL ACPUSR,
						MALMST.DMGFLG,
						0 SELNUM,
						0 ARRSELNUM,
						COALESCE(MALULD.FRMCARCOD,ARPULD.FRMCARCOD) AS MALTRFCAR,
						MALMST.MALIDR,
						MALMST.MALSEQNUM MALSEQNUM,
						MALMST.SCNDAT,
						MALMST.SCNPRT,
						MALMST.OPRSTA,
						MALMST.POU,
						MALMST.RSN,
						MALMST.WGT,
						MALMST.HSN,
						MALMST.REGIND,
						MALMST.MALCMPCOD,
						MALMST.MALSTA MALSTA,
						MST.ULDFULIND ULDFULIND,
						MST.ULDREFNUM ULDREFNUM,
						CASE
						WHEN EXISTS
						(SELECT 1
						FROM MALHIS HIS
						WHERE HIS.CMPCOD  = MALMST.CMPCOD
						AND HIS.MALSEQNUM = MALMST.MALSEQNUM
						AND HIS.MALSTA   IN ('ARR')
						)
						THEN 'Y'
						ELSE 'N'
						END ARRSTA,
						DMGMAL.DMGCOD,
						DMGMAL.DMGDAT,
						DMGMAL.ARPCOD,
						DMGMAL.DMGDES,
						DMGMAL.RMK,
						MALMST.LSTUPDTIM MALLSTUPDTIM,
						MALMST.VOL,
						MALMST.VOLUNT,
						0 STDVOL,
						0 ACPVOL,
						NULL BLYCRTIDR,
						MALMST.ACPPOACONNUM ACPPOACONNUM,
						MALMST.ACPARPCOD ACPARPCOD,
						MALMST.MSTDOCNUM MSTDOCNUM,
                        MALMST.DOCOWRIDR DOCOWRIDR,
                        MALMST.SHPPFX SHPPFX
						FROM MALFLTCON MST
            LEFT OUTER JOIN MALARPULDDTL ARPULD
						ON MST.CMPCOD     = ARPULD.CMPCOD
            AND MST.CONNUM    = ARPULD.CONNUM
						AND MST.ASGPRT    = ARPULD.ARPCOD
						AND MST.FLTCARIDR = ARPULD.FLTCARIDR
						LEFT OUTER JOIN MALARPULD MALULD
						ON ARPULD.CMPCOD     = MALULD.CMPCOD
						AND ARPULD.ARPCOD    = MALULD.ARPCOD
						AND ARPULD.FLTCARIDR = MALULD.FLTCARIDR
						AND MALULD.ULDNUM    = ARPULD.ULDNUM

						LEFT OUTER JOIN MALMST MALMST
						ON ARPULD.CMPCOD     = MALMST.CMPCOD
						AND ARPULD.MALSEQNUM = MALMST.MALSEQNUM
						AND ARPULD.CONNUM    = MALMST.CONNUM
						LEFT OUTER JOIN MALDMGDTL DMGMAL
						ON MALMST.CMPCOD     = DMGMAL.CMPCOD
						AND MALMST.MALSEQNUM = DMGMAL.MALSEQNUM
						LEFT OUTER JOIN MALCSGMST CSGMST
						ON CSGMST.CMPCOD     = MALMST.CMPCOD
						AND CSGMST.CSGDOCNUM = MALMST.CSGDOCNUM
						AND CSGMST.POACOD    = MALMST.POACOD
						AND CSGMST.CSGSEQNUM = MALMST.CSGSEQNUM
						WHERE MST.CMPCOD     = ?
						AND MST.FLTCARIDR    =?
						AND MST.FLTNUM       = ?
						AND MST.FLTSEQNUM    =?
						AND MST.LEGSERNUM    = ?
						AND MST.ASGPRT       = ?
						AND MST.CONNUM       = ?
						AND MST.CONTYP       = 'B'
						ORDER BY DSN,
						ORGEXGOFC,
						DSTEXGOFC,
						YER,
						MALCTGCOD,
						MALSUBCLS,
						CSGDOCNUM,
						CSGSEQNUM,
						POACOD
				]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>6</QRY:Id>
		<QRY:Source Name="mail.operations.findmailresditeventsflightdetails" Type="NATIVE">
			<![CDATA[
					SELECT FLTCARIDR,FLTNUM,FLTSEQNUM,SEGSERNUM,RDTSND,MALIDR,EVTCOD,EVTPRT,PROSTA,SEQNUM,CMPCOD
					FROM MALRDT
					WHERE CMPCOD = ?
					AND EVTCOD= ?
			]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>7</QRY:Id>
		<QRY:Source Name="mail.operations.checkresditExistsFromReassign" Type="NATIVE">
			<![CDATA[
					SELECT MAX (MMR.SEQNUM) SEQNUM
					FROM MALRDT MMR,MALMST MALMST
					WHERE MMR.CMPCOD  = MALMST.CMPCOD
					AND MMR.MALSEQNUM = MALMST.MALSEQNUM
					AND MMR.CMPCOD = ?
					AND MMR.MALSEQNUM = ?
					AND MMR.EVTPRT = ?
					AND MMR.FLTNUM = ?
					AND MMR.FLTSEQNUM = ?
			]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>8</QRY:Id>
		<QRY:Source Name="mail.operations.findmailbagsforupliftedresdit" Type="NATIVE">
			<![CDATA[
					WITH restrictedpasfordeviationresdits AS (
    SELECT
        parval,
        cmpcod FROM
		shrsyspar
    WHERE
        parcod = 'mail.operations.restrictedPAsfordeviationresdits'
), mal AS (
    SELECT
        mst.malidr,
        mst.malseqnum,
        mst.segsernum,
        segdtl.scndat,
        segdtl.connum uldnum,
        segdtl.scnprt,
        mst.contyp,
        mst.malsta,
        mst.pou,
        mst.orgexgofc,
        mst.dstexgofc,
        mst.malctg,
        mst.malsubcls,
        mst.poacod,
        fltseg.pol,
		mst.orgcod,
        mst.dstcod
    FROM
        maluldsegdtl segdtl,
        malfltseg    fltseg, malmst       mst
        LEFT OUTER JOIN restrictedpasfordeviationresdits ON mst.cmpcod = restrictedpasfordeviationresdits.cmpcod
    WHERE
            fltseg.cmpcod = segdtl.cmpcod
        AND fltseg.fltcaridr = segdtl.fltcaridr
        AND fltseg.fltnum = segdtl.fltnum
        AND fltseg.fltseqnum = segdtl.fltseqnum
        AND fltseg.segsernum = segdtl.segsernum
        AND mst.cmpcod = segdtl.cmpcod
        AND mst.malseqnum = segdtl.malseqnum
        AND CASE
            WHEN restrictedpasfordeviationresdits.parval IS NOT NULL
                 AND ( restrictedpasfordeviationresdits.parval = '*'
                       OR instr(restrictedpasfordeviationresdits.parval, mst.poacod, 1) > 0 )
                 AND NOT EXISTS (
                SELECT
                    1
                FROM
                    malhis
                WHERE
                        cmpcod = mst.cmpcod
                    AND malseqnum = mst.malseqnum
                    AND cmpcod = fltseg.cmpcod
                    AND fltcaridr = fltseg.fltcaridr
                    AND fltnum = fltseg.fltnum
                    AND fltseqnum = fltseg.fltseqnum
                    AND segsernum = fltseg.segsernum
                    AND malsta = 'ASG'
                    AND malsrc = 'MTK060'
                    AND addinf = 'Asg. from Dev.Panel'
            ) THEN
                1
            WHEN ( restrictedpasfordeviationresdits.parval IS NULL
                   OR restrictedpasfordeviationresdits.parval = 'NA' ) THEN
                1
            ELSE
                0
            END = 1
        AND segdtl.acpsta = 'Y'
                    AND FLTSEG.CMPCOD       = ?
                    AND FLTSEG.FLTCARIDR    = ?
                    AND FLTSEG.FLTNUM       = ?
                    and FLTSEG.FLTSEQNUM    =?
					
			 ]]>
		  </QRY:Source>
	  </QRY:Definition>

	  <QRY:Definition>
	  <QRY:Id>9</QRY:Id>
			<QRY:Source Name="mail.operations.findCarditDetailsOfMailbag" Type="NATIVE">
				<![CDATA[
						SELECT MALMST.MALIDR,
						MALMST.DSTEXGOFC,
						MALMST.DSN,
						MALMST.RSN,
						MALMST.WGT,
						MALMST.MALRMK,
						MALMST.MALCTG,
                        MALMST.MALSUBCLS,
                        MALMST.ORGEXGOFC,
                        MALMST.YER,
                        MALMST.REQDLVTIM,
						CDTMST.CDTRCVDAT,
						CDTMST.STNCOD,
						MALMST.CMPCOD,
						MALMST.MALSEQNUM,
						MALMST.ACTWGT,
						MALMST.MALSRVLVL,
						MALMST.ORGCOD,
						MALMST.DSTCOD,
						MALMST.CSGDOCNUM,
						MALMST.DSPDAT CSGDAT,
						MALMST.TRPSRVENDTIM,
					TRT.FLTNUM,
						TRT.CARCOD FLTCARCOD,
						CDTMST.CDTRCVDAT,
						TRT.DEPTIM  FLTDAT,
						TRT.CARIDR CARIDR,
						TRT.FLTSEQNUM FLTSEQNUM,
						TRT.SEGSERNUM SEGSERNUM,
						MALMST.POU,
						CDTMST.LSTUPDUSR SCNUSR
						FROM MALMST MALMST
						INNER JOIN MALCDTRCP CDTRCP
						ON MALMST.CMPCOD  = CDTRCP.CMPCOD
						AND MALMST.MALIDR = CDTRCP.RCPIDR
						INNER JOIN MALCDTMST CDTMST
						ON CDTRCP.CMPCOD  = CDTMST.CMPCOD
						AND CDTRCP.CDTKEY = CDTMST.CDTKEY
            LEFT OUTER JOIN MALCDTTRT TRT
            	ON CDTMST.CMPCOD  = TRT.CMPCOD
				AND CDTMST.CDTKEY = TRT.CDTKEY
				 AND CDTMST.CMPCOD=TRT.CARCOD
		    INNER JOIN  MALPOAMST POAMST
                ON POAMST.CMPCOD=MALMST.CMPCOD
                AND POAMST.POACOD=MALMST.POACOD
              AND (ABS(TO_NUMBER(TO_CHAR(TRUNC(CDTMST.CDTRCVDAT) - TRUNC(MALMST.DSPDAT)))) <= POAMST.DUPMALPRD
              OR POAMST.DUPMALPRD  = 0)
						WHERE MALMST.CMPCOD  = ?


				]]>
			</QRY:Source>
	 </QRY:Definition>

	<QRY:Definition>
	<QRY:Id>10</QRY:Id>
		<QRY:Source Name="mail.operations.findmailbaghistories" Type="NATIVE">
			<![CDATA[
					SELECT HIS.CMPCOD,
  MST.MALIDR,
					MST.MALSEQNUM,
					HIS.SCNDAT,
					HIS.MALSTA,
					HIS.SCNPRT,
					HIS.FLTNUM,
					HIS.FLTDAT,
					HIS.FLTCARCOD,
					HIS.CONNUM,
					HIS.POU,
					HIS.SCNUSR,
					HIS.UTCSCNDAT,
					HIS.MSGTIM,
  MST.DSTEXGOFC,
  MST.DSN,
  MST.RSN,
  MST.WGT,
  MST.MALRMK,
					HIS.MALHISIDR,
  MST.POACOD,
  MST.MALCTG,
  MST.MALSUBCLS,
  MST.ORGEXGOFC,
  MST.YER,
  MST.REQDLVTIM,
  MST.ONNTIMDLVFLG,
  MST.ACTWGT,
  MST.MALSRVLVL,
  MST.ORGCOD ORG,
  MST.DSTCOD DST,
  MST.CSGDOCNUM,
  MST.DSPDAT CSGDAT,
  MST.TRPSRVENDTIM,
					HIS.FLTSEQNUM,
					HIS.CONTYP,
					HIS.ADDINF,

	(
		SELECT
			COALESCE(MAX(poaflg), 'N')
		  FROM
			malfltcon
		 WHERE
			connum      = his.connum
			   AND fltnum      = his.fltnum
			   AND fltseqnum   = his.fltseqnum
			   AND fltcaridr   = his.fltcaridr
			   AND asgprt      = his.scnprt
			   AND cmpcod      = his.cmpcod
	)
						 AS POAULDFLG,
					 CASE
						WHEN HIS.MALSRC LIKE '%JOB%' THEN 'JOB'
						WHEN HIS.MALSRC LIKE '%Webservice%' THEN 'Webservice'
						ELSE HIS.MALSRC

					END MALSRC,
					MST.ACPPOACONNUM,
					HIS.STGUNT,HIS.SCRUSR

					FROM MALHIS HIS,
					MALMST MST
					WHERE HIS.CMPCOD  = MST.CMPCOD
					AND HIS.MALSEQNUM = MST.MALSEQNUM
					AND HIS.CMPCOD    = ?

			]]>
		</QRY:Source>
        <QRY:Extensions>
	        <QRY:Extension CompanyCode="DNATA">
	            <QRY:Token Name="addlCols">
	                          ,HIS.STGUNT,HIS.SCRUSR
	            </QRY:Token>
	        </QRY:Extension>
	        <QRY:Extension CompanyCode="4ALL">
	                       <QRY:Token Name="addlCols"/>
	        </QRY:Extension>
      </QRY:Extensions>
		
	</QRY:Definition>

 	<QRY:Definition>
	<QRY:Id>11</QRY:Id>
		<QRY:Source Name="mail.operations.findmailandcontainerdetails" Type="NATIVE">
			<![CDATA[
					SELECT MALMST.MALIDR,
					MST.CONNUM,
					SEG.ULDNUM,
					MST.ASGPRT,
					MST.POU,
					MST.DSTCOD,
					MST.ARRSTA,
					MST.DLVFLG,
					MST.ACPFLG,
					MST.CONTYP
					FROM MALULDSEGDTL SEG,
					MALFLTCON MST,MALMST MALMST
					WHERE MST.CMPCOD  = SEG.CMPCOD
					AND MST.FLTCARIDR = SEG.FLTCARIDR
					AND MST.FLTNUM    = SEG.FLTNUM
					AND MST.FLTSEQNUM = SEG.FLTSEQNUM
					AND MST.ASGPRT    = SEG.SCNPRT
					AND MST.CONNUM    = SEG.CONNUM
					AND SEG.CMPCOD = MALMST.CMPCOD
          AND SEG.MALSEQNUM=MALMST.MALSEQNUM
					AND SEG.ARRSTA    = 'N'
					AND SEG.CMPCOD    = ?
					AND SEG.FLTCARIDR = ?
					AND SEG.FLTNUM    = ?
					AND SEG.FLTSEQNUM = ?
			]]>
		</QRY:Source>
 	</QRY:Definition>

 	<QRY:Definition>
	<QRY:Id>12</QRY:Id>
		<QRY:Source Name="mail.operations.findmailbagdetailsfordeliveryforgha" Type="NATIVE">
			<![CDATA[
					SELECT MST.MALIDR,
					MST.CONNUM,
					NULL ULDNUM,
					NULL ASGPRT,
					MST.POU,
					NULL DSTCOD,
					NULL ARRSTA,
					NULL DLVFLG,
					NULL ACPFLG,
					NULL CONTYP
					FROM MALMST MST
					WHERE MALSTA <> 'DLV'
					AND CMPCOD    = ?
					AND CONNUM    = ?
					AND POU       =?
			]]>
		</QRY:Source>
 	</QRY:Definition>

 	<QRY:Definition>
	<QRY:Id>13</QRY:Id>
		<QRY:Source Name="mail.operations.findairportcityformld" Type="NATIVE">
			<![CDATA[
					SELECT SRVARPCOD ARPCOD FROM SHRCTYMST WHERE CTYCOD=? AND CMPCOD=?
					UNION
					SELECT ARPCOD FROM SHRARPMST WHERE ARPCOD=? AND CMPCOD=?
			]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>14</QRY:Id>
		<QRY:Source Name="mail.operations.finduldarrivaldetails" Type="NATIVE">
			<![CDATA[
					SELECT CON.CONNUM,
					CON.FLTCARIDR,
					CON.FLTCARCOD,
					CON.FLTNUM,
					CON.FLTSEQNUM,
					CON.LEGSERNUM,
					CON.SEGSERNUM,
					CON.ACPFLG,
					CON.DSTCOD,
					CON.ARRSTA,
					CON.TRAFLG,
					FLT.FLTDAT,
					CON.ASGPRT,
					CON.CONJRNIDR,
					CON.POACOD SBCODE
					FROM MALFLT FLT,
					MALFLTCON CON
					WHERE CON.CMPCOD = ?
					AND CON.CONNUM   = ?
					AND POU          = ?
					AND FLT.FLTDAT   =
					(SELECT MAX (FLTDAT)
					FROM MALFLT FLT1,
					MALFLTCON CON1
					WHERE FLT1.CMPCOD  = CON1.CMPCOD
					AND FLT1.FLTNUM    = CON1.FLTNUM
					AND FLT1.FLTSEQNUM = CON1.FLTSEQNUM
					AND FLT1.ARPCOD    = CON1.POU
					AND FLT1.FLTCARIDR = CON1.FLTCARIDR
					AND CON1.CMPCOD    = CON.CMPCOD
					AND CON1.CONNUM    = CON.CONNUM
					AND CON1.POU       = CON.POU
					AND FLT1.IMPCLSFLG IS NOT NULL
					)
					AND FLT.IMPCLSFLG IS NOT NULL
					AND FLT.CMPCOD    = CON.CMPCOD
					AND FLT.FLTNUM    = CON.FLTNUM
					AND FLT.FLTSEQNUM = CON.FLTSEQNUM
					AND FLT.ARPCOD    = CON.POU
					AND FLT.FLTCARIDR = CON.FLTCARIDR
			]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>15</QRY:Id>
		<QRY:Source Name="mail.operations.findAlreadyAssignedTrolleyNumberForMLDWithCarrier" Type="NATIVE">
			<![CDATA[
					SELECT CONNUM
					FROM MALFLTCON CONMST
					WHERE CONMST.FLTNUM = ?
					AND CONMST.ASGPRT   = ?
					AND CONMST.DSTCOD   = ?
					AND CONMST.CONTYP   ='B'
					AND CONMST.FLTCARCOD= ?
					AND CONMST.CMPCOD   = ?
					AND CONMST.CONNUM LIKE '%XX%'
			]]>
		</QRY:Source>
	</QRY:Definition>

  	<QRY:Definition>
	<QRY:Id>16</QRY:Id>
		<QRY:Source Name="mail.operations.findAlreadyAssignedTrolleyNumberForMLDWithFlight" Type="NATIVE">
			<![CDATA[
					SELECT CONNUM
					FROM MALFLTCON CONMST
					INNER JOIN MALFLT ASGFLT
					ON ASGFLT.FLTCARIDR    = CONMST.FLTCARIDR
					AND ASGFLT.FLTNUM      = CONMST.FLTNUM
					AND ASGFLT.FLTSEQNUM   = CONMST.FLTSEQNUM
					AND ASGFLT.ARPCOD      = CONMST.ASGPRT
					AND ASGFLT.CMPCOD      = CONMST.CMPCOD
					WHERE ASGFLT.FLTCARCOD = ?
					AND ASGFLT.FLTNUM      = ?
					%s
					AND ASGFLT.EXPCLSFLG     = 'O'
					AND ASGFLT.ARPCOD      = ?
					AND CONMST.DSTCOD      = ?
					AND CONMST.CMPCOD      = ?
					AND CONMST.CONTYP      ='B'

			]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>17</QRY:Id>
		<QRY:Source Name="mail.operations.finduldsforupliftedresdit" Type="NATIVE">
			<![CDATA[
					SELECT MST.CONNUM,
					MST.SEGSERNUM,
					MST.ASGDAT,
					MST.ASGPRT,
					MST.CONJRNIDR,
					MST.POACOD SBCODE
					FROM MALFLT FLT ,
					MALFLTCON MST
					WHERE FLT.FLTCARIDR =MST.FLTCARIDR
					AND FLT.FLTNUM      =MST.FLTNUM
					AND FLT.FLTSEQNUM   =MST.FLTSEQNUM
					AND FLT.ARPCOD      =MST.ASGPRT
					AND FLT.CMPCOD      =MST.CMPCOD
					AND FLT.LEGSERNUM   =MST.LEGSERNUM
					AND MST.POAFLG      = 'Y'
					AND MST.ACPFLG      = 'Y'
					AND MST.CMPCOD      = ?
					AND MST.FLTCARIDR   =?
					AND MST.FLTNUM      =?
					AND MST.FLTSEQNUM   =?
					AND FLT.LEGSERNUM   =?
					AND MST.ASGPRT      =?
					AND MST.CONTYP      =?
			 ]]>
		  </QRY:Source>
	  </QRY:Definition>

	<QRY:Definition>
	<QRY:Id>18</QRY:Id>
		<QRY:Source Name="mail.operations.findmailbagarrivaldetails" Type="NATIVE">
			<![CDATA[
					SELECT HIS.FLTCARIDR,
					HIS.FLTNUM,
					HIS.FLTSEQNUM,
					HIS.SEGSERNUM,
					HIS.CONNUM,
					HIS.CONTYP,
					HIS.FLTDAT,
					HIS.FLTCARCOD,
					HIS.POU,
					SEG.ARRSTA,
					SEG.DLVSTA,
					SEG.TRAFLG,
					HIS.SCNPRT,
					MALMST.ORGEXGOFC,
					MALMST.DSTEXGOFC,
					MALMST.MALCTG MALCTGCOD,
					MALMST.MALCLS,
					MALMST.DSN,
					MALMST.MALSUBCLS,
					MALMST.MALIDR,
					MALMST.YER
					FROM MALHIS HIS,
					MALULDSEGDTL SEG,
					MALMST MALMST
					WHERE HIS.CMPCOD  = ?
					AND MALMST.MALIDR    = ?
					AND HIS.SCNPRT    = ?
					AND HIS.CMPCOD    = SEG.CMPCOD
					AND HIS.FLTCARIDR = SEG.FLTCARIDR
					AND HIS.FLTNUM    = SEG.FLTNUM
					AND HIS.FLTSEQNUM = SEG.FLTSEQNUM
					AND HIS.SEGSERNUM = SEG.SEGSERNUM
					AND HIS.CONNUM    = SEG.CONNUM
					AND HIS.CMPCOD    =MALMST.CMPCOD
					AND HIS.MALSEQNUM = MALMST.MALSEQNUM
					AND HIS.FLTCARIDR = MALMST.FLTCARIDR
					AND HIS.FLTNUM    = MALMST.FLTNUM
					AND HIS.FLTSEQNUM = MALMST.FLTSEQNUM
					AND HIS.SEGSERNUM = MALMST.SEGSERNUM
					AND HIS.CONNUM    = MALMST.CONNUM
					AND HIS.MALHISIDR =
					(SELECT MAX ( MALHISIDR)
					FROM MALHIS
					WHERE MALSEQNUM = HIS.MALSEQNUM
					AND CMPCOD      = HIS.CMPCOD
					)
					AND HIS.MALHISIDR =
					(SELECT MAX ( MALHISIDR)
					FROM MALHIS
					WHERE MALSEQNUM = HIS.MALSEQNUM
					AND CMPCOD      = HIS.CMPCOD
					AND MALSTA      = 'ARR'
					)
			]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>19</QRY:Id>
		<QRY:Source Name="mail.operations.isexchangevalid" Type="NATIVE">
			<![CDATA[
					SELECT CTYCOD,
					EXGOFCCOD,
					EXGCODDES,
					CNTCOD,
					OFCCOD,
					POACOD,
					ARPCOD
					FROM MALEXGOFCMST
					WHERE CMPCOD  =?
					AND EXGOFCCOD = ?
					AND ACTFLG    ='A'

			]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>20</QRY:Id>
		<QRY:Source Name="mail.operations.findpltmodeofdsn" Type="NATIVE">
			<![CDATA[

			]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>21</QRY:Id>
		<QRY:Source Name="mail.operations.findlatestflightdetailsofmailbag" Type="NATIVE">
			<![CDATA[
					SELECT MST.FLTCARCOD FLTCARCOD,
					MST.FLTDAT FLTDAT,
					MST.FLTNUM FLTNUM,
					MST.MALHISIDR MALHISIDR,
					MST.FLTSEQNUM FLTSEQNUM,
					MST.SCNPRT SCNPRT
					FROM MALHIS MST,MALMST MALMST
					WHERE MALMST.MALSEQNUM  = ?
					AND MST.MALSTA   IN(?,?)
					AND MST.CMPCOD    = ?
					AND MST.CMPCOD    =MALMST.CMPCOD
					AND MST.MALSEQNUM = MALMST.MALSEQNUM
					AND MST.FLTCARIDR = MALMST.FLTCARIDR
					AND MST.FLTNUM    = MALMST.FLTNUM
					AND MST.FLTSEQNUM = MALMST.FLTSEQNUM
					AND MST.SEGSERNUM = MALMST.SEGSERNUM
					AND MST.CONNUM    = MALMST.CONNUM
					AND MST.MALHISIDR =
					(SELECT MAX (MALHISIDR)
					FROM MALHIS
					WHERE MST.MALSEQNUM  = MALSEQNUM
					AND MST.CMPCOD    = CMPCOD
					AND MST.MALSTA=MALSTA
					)
			]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>22</QRY:Id>
		<QRY:Source Name="mail.operations.ismailbagalreadyarrived" Type="NATIVE">
			<![CDATA[
					SELECT 1 FLG
					FROM MALHIS HIS,
					MALMST MALMST
					WHERE MALMST.CMPCOD      = ?
					AND MALMST.MALIDR = ?
					AND HIS.CMPCOD    =MALMST.CMPCOD
					AND HIS.MALSEQNUM = MALMST.MALSEQNUM
					AND HIS.FLTCARIDR = MALMST.FLTCARIDR
					AND HIS.FLTNUM    = MALMST.FLTNUM
					AND HIS.FLTSEQNUM = MALMST.FLTSEQNUM
					AND HIS.SEGSERNUM = MALMST.SEGSERNUM
					AND HIS.CONNUM    = MALMST.CONNUM
					AND MALMST.SCNPRT       IN
					(SELECT ARPCOD
					FROM SHRARPMST
					WHERE CTYCOD=
					(SELECT CTYCOD FROM SHRARPMST WHERE ARPCOD= ? AND CMPCOD=?
					)
					)
				]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>23</QRY:Id>
		<QRY:Source Name="mail.operations.findlastassignedresditforuld" Type="NATIVE">
			<![CDATA[
					SELECT SEQNUM,
					RDTSND
					FROM MALULDRDT
					WHERE CMPCOD=?
					AND EVTPRT  =?
					AND ULDNUM  =?
					AND EVTCOD  =?
					AND SEQNUM  =
					(SELECT MAX(SEQNUM)
					FROM MALULDRDT
					WHERE CMPCOD=?
					AND EVTPRT  =?
					AND ULDNUM  =?
					AND EVTCOD  =?
					)
			]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>25</QRY:Id>
		<QRY:Source Name="mail.operations.findPAForMailbags" Type="NATIVE">
			<![CDATA[
					SELECT MST.MALIDR MALORULD,
					COALESCE ( CDT.SDRIDR,EXG.POACOD ,NULL) POACOD
                    FROM MALMST MST    
                    LEFT OUTER JOIN MALCDTRCP RCP
                    ON MST.CMPCOD = RCP.CMPCOD
                    AND MST.MALIDR = RCP.RCPIDR
                    LEFT OUTER JOIN MALCDTMST CDT
                    ON RCP.CMPCOD = CDT.CMPCOD
                    AND RCP.CDTKEY = CDT.CDTKEY
                    LEFT OUTER JOIN MALEXGOFCMST EXG
                    ON MST.CMPCOD = EXG.CMPCOD
                    AND MST.ORGEXGOFC = EXG.EXGOFCCOD
                    INNER JOIN MALPOAMST POAMST
                    ON POAMST.CMPCOD=MST.CMPCOD
                    AND POAMST.POACOD=MST.POACOD
					AND (TO_NUMBER(to_Date(TO_CHAR(current_date,'YYYYMMDD'),'YYYYMMDD')-to_Date(TO_CHAR(MST.DSPDAT,'YYYYMMDD'),'YYYYMMDD'))<=(POAMST.DUPMALPRD))
                    WHERE 
                    MST.CMPCOD    = ?
			]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>26</QRY:Id>
		<QRY:Source Name="mail.operations.findmailresditflightdetails" Type="NATIVE">
			<![CDATA[
					SELECT MMR.EVTPRT,MMR.FLTCARIDR,MMR.FLTNUM,MMR.FLTSEQNUM,MMR.SEGSERNUM,MMR.RDTSND
					FROM MALRDT MMR,MALMST MST
					WHERE MMR.MALSEQNUM = MST.MALSEQNUM
					AND MMR.CMPCOD   = MST.CMPCOD
					AND MMR.CMPCOD = ?
					AND MST.MALIDR= ?
					AND MMR.EVTCOD= ?
			]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>27</QRY:Id>
		<QRY:Source Name="mail.operations.iscarditpresentformail" Type="NATIVE">
			<![CDATA[
					SELECT MCR.RCPIDR RCPIDR,MCR.CDTKEY
					FROM MALCDTRCP MCR,MALMST MST
					WHERE MCR.RCPIDR = MST.MALIDR
					AND MCR.CMPCOD   = MST.CMPCOD
					AND MCR.CMPCOD = ?
					AND MST.MALIDR = ?
			]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>28</QRY:Id>
		<QRY:Source Name="mail.operations.isflightsameascardit" Type="NATIVE">
			<![CDATA[
					SELECT MCR.RCPIDR RCPIDR
					FROM MALCDTTRT MCT, MALCDTRCP MCR,MALMST MST
					WHERE MCR.RCPIDR = MST.MALIDR
					AND MCR.CMPCOD   = MST.CMPCOD
					AND MCT.CMPCOD = ?
					AND MCT.CDTKEY = MCR.CDTKEY
					AND MST.MALIDR = ?
					AND MCT.CARIDR = ?
					AND MCT.FLTNUM = ?
					AND MCT.FLTSEQNUM = ?
					AND MCT.ORGCOD = ?
			]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>29</QRY:Id>
		<QRY:Source Name="mail.operations.finduldincardit" Type="NATIVE">
			<![CDATA[
					SELECT   CON.CMPCOD,
					CON.NETWGT      ,
					CON.CONNUM      ,
					COUNT (RCP.RCPIDR ) NETCOUNT
					FROM MALCDTTRT TRT
					INNER JOIN MALCDTCON CON
					 ON TRT.CMPCOD =CON.CMPCOD
					AND TRT.CDTKEY     =CON.CDTKEY
					LEFT OUTER JOIN MALCDTRCP RCP
					 ON RCP.CMPCOD =CON.CMPCOD
					AND RCP.CDTKEY     =CON.CDTKEY
					AND RCP.DSPIDR     = CON.CONJRNIDR
					WHERE TRT.CMPCOD = ?
					AND TRT.CARIDR     = ?
					AND TRT.FLTNUM     = ?
					AND TRT.FLTSEQNUM  = ?
					AND TRT.LEGSERNUM  = ?
					AND TRT.ORGCOD     = ?
					GROUP BY CON.CMPCOD,
					CON.NETWGT       ,
					CON.CONNUM
			]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>30</QRY:Id>
		<QRY:Source Name="mail.operations.findmailbagsincardit" Type="NATIVE">
			<![CDATA[
					SELECT SUM(MALMST.WGT) RCPWGT,
						  MALMST.ORGEXGOFC ORGEXGOFF,
						  MALMST.DSTEXGOFC DSTEXGOFF,
						  MALMST.MALCTG MALCTGCOD,
						  CSGDTL.ULDNUM CONNUM,
						  COUNT(MALMST.MALSEQNUM) COUNT
						FROM MALCSGMST CSGMST
						INNER JOIN MALCSGDTL CSGDTL
						ON CSGMST.CMPCOD     = CSGDTL.CMPCOD
						AND CSGMST.CSGDOCNUM = CSGDTL.CSGDOCNUM
						AND CSGMST.CSGSEQNUM = CSGDTL.CSGSEQNUM
						AND CSGMST.POACOD    = CSGDTL.POACOD
						INNER JOIN MALMST MALMST
						ON MALMST.CMPCOD     = CSGDTL.CMPCOD
						AND MALMST.MALSEQNUM = CSGDTL.MALSEQNUM
						AND MALMST.CSGSEQNUM = CSGDTL.CSGSEQNUM
						AND MALMST.CSGDOCNUM = CSGDTL.CSGDOCNUM
						AND MALMST.POACOD    = CSGDTL.POACOD
					INNER JOIN MALEXGOFCMST OFC
						ON MALMST.CMPCOD     = OFC.CMPCOD
						AND MALMST.ORGEXGOFC =OFC.EXGOFCCOD
						INNER JOIN MALCSGRTG TRT
						ON CSGMST.CMPCOD     = TRT.CMPCOD
						AND CSGMST.CSGDOCNUM = TRT.CSGDOCNUM
						AND CSGMST.CSGSEQNUM =TRT.CSGSEQNUM
						AND CSGMST.POACOD    =TRT.POACOD
					WHERE OFC.ACTFLG   = 'A'
						AND CSGMST.CMPCOD    = ?
						AND TRT.FLTCARIDR    = ?
						AND TRT.FLTNUM     = ?
						AND TRT.FLTSEQNUM  = ?
						AND TRT.POL          = ?

			]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>31</QRY:Id>
		<QRY:Source Name="mail.operations.finddecription" Type="NATIVE">
			<![CDATA[
				   SELECT EXGCODDES FROM MALEXGOFCMST WHERE EXGOFCCOD = ?  AND ACTFLG='A'

			]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>32</QRY:Id>
		<QRY:Source Name="mail.operations.iscarditpresentforuld" Type="NATIVE">
			<![CDATA[
					SELECT CON.CONNUM CONNUM
					FROM MALCDTCON CON
					WHERE  CON.CMPCOD = ?
					AND CON.CONNUM = ?
			]]>
		</QRY:Source>
	</QRY:Definition>


	<QRY:Definition>
	<QRY:Id>33</QRY:Id>
		<QRY:Source Name="mail.operations.isflightsameascarditforuld" Type="NATIVE">
			<![CDATA[
					SELECT CON.CONNUM  CONNUM
					FROM MALCDTTRT MCT, MALCDTCON  CON
					WHERE MCT.CDTKEY = CON.CDTKEY
					AND  MCT.CMPCOD = ?
					AND CON.CONNUM = ?
					AND MCT.CARIDR = ?
					AND MCT.FLTNUM = ?
					AND MCT.FLTSEQNUM = ?
					AND MCT.SEGSERNUM = ?
					AND MCT.ORGCOD = ?
			]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>34</QRY:Id>
		<QRY:Source Name="mail.operations.findcarditdetailsforresdit" Type="NATIVE">
			<![CDATA[
					SELECT CDT.SDRIDR, CDT.RCTIDR, CDT.TSTIND,CDT.CDTKEY
					FROM MALCDTMST CDT
					WHERE CDT.CMPCOD = ? AND CDT.CSGDOCNUM = ?
			]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>35</QRY:Id>
		<QRY:Source Name="mail.operations.findcarditcontainercount" Type="NATIVE">
			<![CDATA[
					SELECT COUNT (1) CDTCONCNT
					FROM MALCDTCON CON, MALCDTMST MST
					WHERE CON.CDTKEY = MST.CDTKEY
					AND MST.CMPCOD = ?
					AND MST.CSGDOCNUM = ?
			]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>36</QRY:Id>
		<QRY:Source Name="mail.operations.findcarditreceptaclecount" Type="NATIVE">
			<![CDATA[
					SELECT COUNT (1) CDTRCPCNT
					FROM MALCDTRCP RCP, MALCDTMST MST
					WHERE RCP.CDTKEY = MST.CDTKEY
					AND MST.CMPCOD = ?
					AND MST.CSGDOCNUM = ?
			]]>
		</QRY:Source>
	</QRY:Definition>


	<QRY:Definition>
	<QRY:Id>37</QRY:Id>
		<QRY:Source Name="mail.operations.findcarditdetailsformailbag" Type="NATIVE">
			<![CDATA[
					SELECT MALMST.MALIDR,
					MALMST.CONNUM,
					CDTMST.SDRIDR,
					CDTMST.CSGDOCNUM,
					CDTMST.CSGCMPDAT,
					RDT2.EVTCOD,
					RDT2.EVTPRT,
					RDT2.RDTSND,
					CDTMST.RCTIDR,
					RDT.EVTDATUTC,
					RDT.EVTPRT AS RDTEVTPRT,
					RDT.FLTCARIDR,
					RDT.FLTNUM,
					RDT.FLTSEQNUM,
					RDT.POACARCOD,
					RDT.SEGSERNUM,
					RDT.SEQNUM,
					SHR.TWOAPHCOD FLTCARCOD
					FROM MALMST MALMST
					LEFT OUTER JOIN MALRDT RDT2
					ON RDT2.CMPCOD  = MALMST.CMPCOD
					AND RDT2.MALSEQNUM = MALMST.MALSEQNUM
					AND RDT2.RDTSND = 'S'
                    INNER JOIN  MALPOAMST POAMST
                    ON POAMST.CMPCOD=MALMST.CMPCOD
                    AND POAMST.POACOD=MALMST.POACOD
                    AND to_number(sysdate-MALMST.DSPDAT) <=POAMST.DUPMALPRD,
					MALCDTRCP CDTRCP,
					MALCDTMST CDTMST,
					MALCDTTRT TRT,
					MALRDT RDT,
					SHRARLMST SHR
					WHERE CDTRCP.CMPCOD = MALMST.CMPCOD
					AND CDTRCP.RCPIDR   = MALMST.MALIDR
					AND CDTRCP.CMPCOD   = CDTMST.CMPCOD
					AND CDTRCP.CDTKEY   = CDTMST.CDTKEY
					AND TRT.CMPCOD      = CDTMST.CMPCOD
					AND TRT.CDTKEY      = CDTMST.CDTKEY
					AND RDT.CMPCOD      = MALMST.CMPCOD
					AND RDT.MALSEQNUM      = MALMST.MALSEQNUM
					AND RDT.RDTSND     <> 'S'
					AND RDT.FLTCARIDR   = SHR.ARLIDR
					AND CDTMST.CMPCOD   = ?
					AND TRT.CARIDR      = ?
					AND TRT.FLTNUM      = ?
					AND TRT.FLTSEQNUM   = ?
					AND TRT.LEGSERNUM   = ?
					AND RDT.EVTCOD      = ?
			]]>
		 </QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>38</QRY:Id>
		<QRY:Source Name="mail.operations.findcarditdetailsforallmailbags" Type="NATIVE">
			<![CDATA[
					SELECT CDTRCP.RCPIDR MALIDR,
					CDTMST.SDRIDR,
					CDTMST.CSGDOCNUM,
					CDTMST.CSGCMPDAT,
					MALMST.MALIDR
					FROM MALCDTRCP CDTRCP,
					MALCDTMST CDTMST,
					MALCDTTRT TRT,
                    MALMST MST,
                    MALPOAMST POAMST
					WHERE CDTMST.CMPCOD = CDTRCP.CMPCOD
					AND CDTMST.CDTKEY   = CDTRCP.CDTKEY
					AND CDTMST.CMPCOD   = MALMST.CMPCOD
					AND CDTMST.MALSEQNUM = MST.MALSEQNUM
					AND CDTMST.CMPCOD   = TRT.CMPCOD
					AND CDTMST.CDTKEY   = TRT.CDTKEY
                    AND POAMST.CMPCOD=MST.CMPCOD
                    AND POAMST.POACOD=MST.POACOD
                    AND to_number(sysdate-MST.DSPDAT) <=POAMST.DUPMALPRD
					AND CDTMST.CMPCOD   = ?
					AND TRT.CARIDR      = ?
					AND TRT.FLTNUM      = ?
					AND TRT.FLTSEQNUM   = ?
					AND TRT.LEGSERNUM   = ?

			]]>
		 </QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>40</QRY:Id>
		<QRY:Source Name="mail.operations.findcarditmaildetailsforopflight" Type="NATIVE">
			<![CDATA[
				SELECT MALMST.MALIDR,
			  MALMST.CONNUM,
			  CDTMST.SDRIDR,
			  CDTMST.CSGDOCNUM,
			  RDT2.EVTCOD,
			  RDT2.EVTPRT,
			  CDTMST.CSGCMPDAT,
			  RDT2.RDTSND,
			  CDTMST.CSGCMPDAT,
			  CDTMST.RCTIDR,
			  RDT.EVTDATUTC,
			  RDT.EVTPRT AS RDTEVTPRT,
			  RDT.FLTCARIDR,
			  RDT.FLTNUM,
			  RDT.FLTSEQNUM,
			  RDT.POACARCOD,
			  RDT.SEGSERNUM,
			  RDT.SEQNUM,
			  SHR.TWOAPHCOD FLTCARCOD
			FROM MALCDTRCP CDTRCP,
			  MALMST MALMST
			LEFT OUTER JOIN   MALRDT RDT2
			ON RDT2.CMPCOD  = MALMST.CMPCOD
			AND RDT2.MALSEQNUM = MALMST.MALSEQNUM
			AND RDT2.RDTSND = 'S'
			INNER JOIN  MALPOAMST POAMST
            ON POAMST.CMPCOD=MALMST.CMPCOD
            AND POAMST.POACOD=MALMST.POACOD
            AND to_number(sysdate-MALMST.DSPDAT) <=POAMST.DUPMALPRD,
			  MALFLT ASGFLT,
			  MALCDTMST CDTMST,
			  MALRDT RDT,
			  SHRARLMST SHR
			WHERE ASGFLT.CMPCOD  = MALMST.CMPCOD
			AND ASGFLT.FLTCARIDR = MALMST.FLTCARIDR
			AND ASGFLT.FLTNUM    = MALMST.FLTNUM
			AND ASGFLT.FLTSEQNUM = MALMST.FLTSEQNUM
			AND MALMST.CMPCOD    = CDTRCP.CMPCOD
			AND MALMST.MALIDR = CDTRCP.RCPIDR
			AND CDTMST.CMPCOD    = CDTRCP.CMPCOD
			AND CDTMST.CDTKEY    = CDTRCP.CDTKEY
			AND RDT.CMPCOD       = MALMST.CMPCOD
			AND RDT.MALSEQNUM    = MALMST.MALSEQNUM
			AND RDT.RDTSND      <> 'S'
			AND RDT.FLTCARIDR    = SHR.ARLIDR
			AND ASGFLT.CMPCOD    = ?
			AND ASGFLT.FLTCARIDR = ?
			AND ASGFLT.FLTNUM    = ?
			AND ASGFLT.FLTSEQNUM = ?
			AND ASGFLT.LEGSERNUM = ?
			AND RDT.EVTCOD       = ?
		  ]]>
		 </QRY:Source>
	</QRY:Definition>




	<QRY:Definition>
	<QRY:Id>41</QRY:Id>
		<QRY:Source Name="mail.operations.findcarditmaildetailsforinboundopflight" Type="NATIVE">
			<![CDATA[
				SELECT MALMST.MALIDR,
				  MALMST.CONNUM,
				  CDTMST.SDRIDR,
				  CDTMST.CSGDOCNUM,
				  RDT2.EVTCOD,
				  RDT2.EVTPRT,
				  CDTMST.CSGCMPDAT,
				  RDT2.RDTSND,
				  CDTMST.CSGCMPDAT,
				  CDTMST.RCTIDR,
				  RDT.EVTDATUTC,
				  RDT.EVTPRT AS RDTEVTPRT,
				  RDT.FLTCARIDR,
				  RDT.FLTNUM,
				  RDT.FLTSEQNUM,
				  RDT.POACARCOD,
				  RDT.SEGSERNUM,
				  RDT.SEQNUM,
				  SHR.TWOAPHCOD FLTCARCOD
				FROM MALCDTRCP CDTRCP,
				  MALMST MALMST
				LEFT OUTER JOIN MALRDT RDT2
				ON RDT2.CMPCOD  = MALMST.CMPCOD
				AND RDT2.MALSEQNUM = MALMST.MALSEQNUM
				AND RDT2.RDTSND = 'S'
				INNER JOIN  MALPOAMST POAMST
                ON POAMST.CMPCOD=MALMST.CMPCOD
                AND POAMST.POACOD=MALMST.POACOD
                AND to_number(sysdate-MALMST.DSPDAT) <=POAMST.DUPMALPRD,
				  MALFLT INBFLT,
				  MALCDTMST CDTMST,
				  MALRDT RDT,
				  SHRARLMST SHR
				WHERE INBFLT.CMPCOD  = MALMST.CMPCOD
				AND INBFLT.FLTCARIDR = MALMST.FLTCARIDR
				AND INBFLT.FLTNUM    = MALMST.FLTNUM
				AND INBFLT.FLTSEQNUM = MALMST.FLTSEQNUM
				AND INBFLT.ARPCOD    = MALMST.SCNPRT
				AND MALMST.CMPCOD    = CDTRCP.CMPCOD
				AND MALMST.MALIDR = CDTRCP.RCPIDR
				AND CDTMST.CMPCOD    = CDTRCP.CMPCOD
				AND CDTMST.CDTKEY    = CDTRCP.CDTKEY
				AND RDT.CMPCOD       = MALMST.CMPCOD
				AND RDT.MALSEQNUM    = MALMST.MALSEQNUM
				AND RDT.RDTSND      <> 'S'
				AND RDT.FLTCARIDR    = SHR.ARLIDR
				AND INBFLT.CMPCOD    = ?
				AND INBFLT.FLTCARIDR = ?
				AND INBFLT.FLTNUM    = ?
				AND INBFLT.FLTSEQNUM = ?
				AND INBFLT.LEGSERNUM = ?
				AND RDT.EVTCOD       = ?
				AND INBFLT.IMPCLSFLG IS NOT NULL
		  ]]>
		 </QRY:Source>
	</QRY:Definition>


		<QRY:Definition>
	<QRY:Id>42</QRY:Id>
	<QRY:Source Name="mail.operations.findcarditcontainerdetails" Type="OBJECT">
			<![CDATA[
 			     SELECT CDTMST.CMPCOD,
				  CDTMST.SDRIDR,
				  CDTMST.CSGDOCNUM,
				  CDTMST.CDTKEY,
				  CDTMST.CSGCMPDAT,
				  CDTMST.RCTIDR,
				  CDTCON.CONNUM,
				  CDTCON.EQPQLF,
				  CDTCON.TYPCOD,
				  CDTCON.NETWGT,
				  CDTCON.TYPCODLSTAGY,
				  CDTCON.NUMCODLSTAGY,
				  CDTCON.MMTDMN,
				  CDTCON.CONSELNUM,
				  ULDRDT.EVTPRT RDTEVTPRT,
				  ULDRDT.EVTCOD RDTEVTCOD
				FROM MALCDTMST CDTMST
				INNER JOIN MALCDTTRT TRT
				ON CDTMST.CMPCOD  = TRT.CMPCOD
				AND CDTMST.CDTKEY = TRT.CDTKEY
				INNER JOIN MALCDTCON CDTCON
				ON CDTMST.CMPCOD  = CDTCON.CMPCOD
				AND CDTMST.CDTKEY = CDTCON.CDTKEY
				LEFT OUTER JOIN MALULDRDT ULDRDT
				ON CDTCON.CMPCOD    = ULDRDT.CMPCOD
				AND CDTCON.CDTKEY   = ULDRDT.CDTKEY
				AND CDTCON.CONNUM   = ULDRDT.ULDNUM
				AND ULDRDT.RDTSND   ='S'
				WHERE CDTMST.CMPCOD =?
				AND TRT.CARIDR      =?
				AND TRT.FLTNUM      =?
				AND TRT.FLTSEQNUM   =?
			]]>
		</QRY:Source>
	</QRY:Definition>


	<QRY:Definition>
		<QRY:Id>43</QRY:Id>
			<QRY:Source Name="mail.operations.findcarditdetailsfordocument" Type="NATIVE">
			<![CDATA[
			SELECT CDTMST.SDRIDR,
			  CDTMST.CSGDOCNUM,
			  CDTMST.CSGCMPDAT
			FROM MALCDTMST CDTMST,
			  MALCDTTRT TRT
			WHERE TRT.CMPCOD  = CDTMST.CMPCOD
			AND TRT.CDTKEY    = CDTMST.CDTKEY
			AND CDTMST.CMPCOD = ?
			AND TRT.CARIDR    = ?
			AND TRT.FLTNUM    = ?
			AND TRT.FLTSEQNUM = ?
			AND TRT.LEGSERNUM = ?
			AND EXISTS
			  (SELECT 1
			  FROM MALMST MALMST,
				MALCDTRCP CDTRCP,
				MALRDT RDT
            INNER JOIN  MALPOAMST POAMST
            ON POAMST.CMPCOD=MALMST.CMPCOD
            AND POAMST.POACOD=MALMST.POACOD
            AND to_number(sysdate-MALMST.DSPDAT) <=POAMST.DUPMALPRD
			  WHERE CDTRCP.CMPCOD  = CDTMST.CMPCOD
			  AND CDTRCP.CDTKEY    = CDTMST.CDTKEY
			  AND MALMST.CMPCOD    = CDTRCP.CMPCOD
			  AND MALMST.MALSEQNUM = CDTRCP.MALSEQNUM
			  AND CDTRCP.CMPCOD    = RDT.CMPCOD
			  AND CDTRCP.MALSEQNUM = RDT.MALSEQNUM
			  AND RDT.RDTSND      <> 'S'
			  AND RDT.EVTCOD       = ?
					  )
			]]>
			 </QRY:Source>
	</QRY:Definition>

	 <QRY:Definition>
	<QRY:Id>44</QRY:Id>
		<QRY:Source Name="mail.operations.findcarditdetailsforalldocuments" Type="NATIVE">
			<![CDATA[
                SELECT CDTMST.SDRIDR, CDTMST.CSGDOCNUM, CDTMST.CSGCMPDAT
			  FROM MALCDTMST CDTMST, MALCDTTRT TRT
			 WHERE TRT.CMPCOD = CDTMST.CMPCOD
			   AND TRT.CDTKEY = CDTMST.CDTKEY
			   AND CDTMST.CMPCOD = ?
			   AND TRT.CARIDR = ?
			   AND TRT.FLTNUM = ?
			   AND TRT.FLTSEQNUM = ?
			   AND TRT.LEGSERNUM = ?


		  ]]>
		 </QRY:Source>
	</QRY:Definition>


	       <QRY:Definition>
	<QRY:Id>45</QRY:Id>
		<QRY:Source Name="mail.operations.findcarditdetailsforopflight" Type="NATIVE">
			<![CDATA[
			SELECT CDTMST.SDRIDR,
		  CDTMST.CSGDOCNUM,
		  CDTMST.CSGCMPDAT
		FROM MALCDTMST CDTMST,
		  MALFLT ASGFLT
		WHERE CDTMST.CMPCOD  = ASGFLT.CMPCOD
		AND ASGFLT.CMPCOD    = ?
		AND ASGFLT.FLTCARIDR = ?
		AND ASGFLT.FLTNUM    = ?
		AND ASGFLT.FLTSEQNUM = ?
		AND ASGFLT.LEGSERNUM = ?
		AND EXISTS
		  (SELECT 1
		  FROM MALMST MALMST,
			MALCDTRCP CDTRCP,
			MALRDT RDT,
			MALFLTSEG FLTSEG
		  WHERE MALMST.CMPCOD  = CDTRCP.CMPCOD
		  AND MALMST.MALSEQNUM = CDTRCP.MALSEQNUM
		  AND CDTRCP.CMPCOD    = CDTMST.CMPCOD
		  AND CDTRCP.CDTKEY    = CDTMST.CDTKEY
		  AND CDTRCP.CMPCOD    = RDT.CMPCOD
		  AND CDTRCP.MALSEQNUM = RDT.MALSEQNUM
		  AND FLTSEG.CMPCOD    = ASGFLT.CMPCOD
		  AND FLTSEG.FLTCARIDR = ASGFLT.FLTCARIDR
		  AND FLTSEG.FLTNUM    = ASGFLT.FLTNUM
		  AND FLTSEG.FLTSEQNUM = ASGFLT.FLTSEQNUM
		  AND FLTSEG.POL       = ASGFLT.ARPCOD
		  AND MALMST.CMPCOD    = FLTSEG.CMPCOD
		  AND MALMST.FLTCARIDR = FLTSEG.FLTCARIDR
		  AND MALMST.FLTNUM    = FLTSEG.FLTNUM
		  AND MALMST.FLTSEQNUM = FLTSEG.FLTSEQNUM
		  AND MALMST.SEGSERNUM = FLTSEG.SEGSERNUM
		  AND RDT.RDTSND      <> 'S'
		  AND RDT.EVTCOD       = ?
		  )
		  ]]>
		 </QRY:Source>
	</QRY:Definition>


	   <QRY:Definition>
	<QRY:Id>46</QRY:Id>
		<QRY:Source Name="mail.operations.findcarditdetailsforinboundopflight" Type="NATIVE">
			<![CDATA[

			  SELECT CDTMST.SDRIDR,
			  CDTMST.CSGDOCNUM,
			  CDTMST.CSGCMPDAT
			FROM MALCDTMST CDTMST,
			  MALFLT INBFLT
			WHERE CDTMST.CMPCOD   = INBFLT.CMPCOD
			AND INBFLT.CMPCOD     = ?
			AND INBFLT.FLTCARIDR  = ?
			AND INBFLT.FLTNUM     = ?
			AND INBFLT.FLTSEQNUM  = ?
			AND INBFLT.LEGSERNUM  = ?
			AND INBFLT.IMPCLSFLG IS NOT NULL
			AND EXISTS
			  (SELECT 1
			  FROM MALMST MALMST,
				MALCDTRCP CDTRCP,
				MALMALRDT RDT,
				MALFLTSEG FLTSEG
			  WHERE MALMST.CMPCOD  = CDTRCP.CMPCOD
			  AND MALMST.MALSEQNUM = CDTRCP.MALSEQNUM
			  AND CDTRCP.CMPCOD    = CDTMST.CMPCOD
			  AND CDTRCP.CDTKEY    = CDTMST.CDTKEY
			  AND CDTRCP.CMPCOD    = RDT.CMPCOD
			  AND CDTRCP.MALSEQNUM = RDT.MALSEQNUM
			  AND FLTSEG.CMPCOD    = INBFLT.CMPCOD
			  AND FLTSEG.FLTCARIDR = INBFLT.FLTCARIDR
			  AND FLTSEG.FLTNUM    = INBFLT.FLTNUM
			  AND FLTSEG.FLTSEQNUM = INBFLT.FLTSEQNUM
			  AND FLTSEG.POL       = INBFLT.ARPCOD
			  AND MALMST.CMPCOD    = FLTSEG.CMPCOD
			  AND MALMST.FLTCARIDR = FLTSEG.FLTCARIDR
			  AND MALMST.FLTNUM    = FLTSEG.FLTNUM
			  AND MALMST.FLTSEQNUM = FLTSEG.FLTSEQNUM
			  AND MALMST.SEGSERNUM = FLTSEG.SEGSERNUM
			  AND RDT.RDTSND      <> 'S'
			  AND RDT.EVTCOD       = ?
			  )
		  ]]>
		 </QRY:Source>
	</QRY:Definition>



	<QRY:Definition>
		<QRY:Id>47</QRY:Id>
			<QRY:Source Name="mail.operations.findcarditdespatchdetails" Type="NATIVE">
				<![CDATA[
				SELECT DISTINCT MALMST.ORGEXGOFC,
		  MALMST.DSTEXGOFC,
		  MALMST.MALCTG MALCTGCOD,
		  MALMST.YER,
		  MALMST.DSN,
		  CDTMST.SDRIDR,
		  CDTMST.CSGDOCNUM,
		  CDTMST.CSGCMPDAT
		FROM MALMST MALMST,
		  MALCDTRCP CDTRCP,
		  MALCDTMST CDTMST,
		  MALCDTTRT TRT,
		  MALRDT RDT
		WHERE MALMST.CMPCOD  = CDTRCP.CMPCOD
		AND MALMST.MALSEQNUM = CDTRCP.MALSEQNUM
		AND CDTRCP.CMPCOD    = CDTMST.CMPCOD
		AND CDTRCP.CDTKEY    = CDTMST.CDTKEY
		AND TRT.CMPCOD       = CDTMST.CMPCOD
		AND TRT.CDTKEY       = CDTMST.CDTKEY
		AND RDT.CMPCOD       = MALMST.CMPCOD
		AND RDT.MALSEQNUM    = MALMST.MALSEQNUM
		AND RDT.RDTSND      <> 'S'
		AND CDTMST.CMPCOD    = ?
		AND TRT.CARIDR       = ?
		AND TRT.FLTNUM       = ?
		AND TRT.FLTSEQNUM    = ?
		AND TRT.LEGSERNUM    = ?
		AND RDT.EVTCOD       = ?
			  ]]>
			 </QRY:Source>
	</QRY:Definition>


		<QRY:Definition>
	<QRY:Id>48</QRY:Id>
		<QRY:Source Name="mail.operations.findcarditdetailsforalldespatches" Type="NATIVE">
			<![CDATA[
				SELECT DISTINCT CDTRCP.ORGEXGOFF ORGEXGOFC ,
			  CDTRCP.DSTEXGOFF DSTEXGOFC ,
			  CDTRCP.MALCTGCOD,
			  CDTRCP.DSPYER YER ,
			  CDTRCP.DSPSRLNUM DSN,
			  CDTMST.SDRIDR,
			  CDTMST.CSGDOCNUM,
			  CDTMST.CSGCMPDAT
			FROM MALCDTRCP CDTRCP,
			  MALCDTMST CDTMST,
			  MALCDTTRT TRT
			WHERE CDTMST.CMPCOD = CDTRCP.CMPCOD
			AND CDTMST.CDTKEY   = CDTRCP.CDTKEY
			AND CDTMST.CMPCOD   = TRT.CMPCOD
			AND CDTMST.CDTKEY   = TRT.CDTKEY
			AND CDTMST.CMPCOD   = ?
			AND TRT.CARIDR      = ?
			AND TRT.FLTNUM      = ?
			AND TRT.FLTSEQNUM   = ?
			AND TRT.LEGSERNUM   = ?


		  ]]>
		 </QRY:Source>
	</QRY:Definition>



	<QRY:Definition>
	<QRY:Id>49</QRY:Id>
		<QRY:Source Name="mail.operations.findcarditdespatchdetailsforinboundopflight" Type="NATIVE">
			<![CDATA[
				SELECT DISTINCT MALMST.ORGEXGOFC,
		  MALMST.DSTEXGOFC,
		  MALMST.MALCTG MALCTGCOD,
		  MALMST.MALSUBCLS,
		  MALMST.MALCLS,
		  MALMST.YER,
		  MALMST.DSN,
		  CDTMST.SDRIDR,
		  CDTMST.CSGDOCNUM,
		  CDTMST.CSGCMPDAT
		FROM MALCDTRCP CDTRCP,
		  MALMST MALMST,
		  MALFLT INBFLT,
		  MALCDTMST CDTMST,
		  MALRDT RDT
		WHERE INBFLT.CMPCOD   = MALMST.CMPCOD
		AND INBFLT.FLTCARIDR  = MALMST.FLTCARIDR
		AND INBFLT.FLTNUM     = MALMST.FLTNUM
		AND INBFLT.FLTSEQNUM  = MALMST.FLTSEQNUM
		AND INBFLT.ARPCOD     = MALMST.SCNPRT
		AND MALMST.CMPCOD     = CDTRCP.CMPCOD
		AND MALMST.MALSEQNUM  = CDTRCP.MALSEQNUM
		AND CDTMST.CMPCOD     = CDTRCP.CMPCOD
		AND CDTMST.CDTKEY     = CDTRCP.CDTKEY
		AND RDT.CMPCOD        = MALMST.CMPCOD
		AND RDT.MALSEQNUM     = MALMST.MALSEQNUM
		AND RDT.RDTSND       <> 'S'
		AND INBFLT.CMPCOD     = ?
		AND INBFLT.FLTCARIDR  = ?
		AND INBFLT.FLTNUM     = ?
		AND INBFLT.FLTSEQNUM  = ?
		AND INBFLT.LEGSERNUM  = ?
		AND RDT.EVTCOD        = ?
		AND INBFLT.IMPCLSFLG IS NOT NULL
		  ]]>
		 </QRY:Source>
	</QRY:Definition>

		<QRY:Definition>
		<QRY:Id>50</QRY:Id>
		<QRY:Source Name="mail.operations.findcardittransportation" Type="NATIVE">
			<![CDATA[
			SELECT TRT.ORGCOD,
			  TRT.DSTCOD,
			  TRT.DEPTIM,
			  TRT.CARIDR,
			  TRT.FLTNUM,
			  TRT.FLTSEQNUM,
			  TRT.LEGSERNUM,
			  TRT.TRTMOD,
			  TRT.TRTSTGQLF,
			  TRT.TRTSERNUM,
			  TRT.SEGSERNUM
			FROM MALCDTTRT TRT
			WHERE TRT.CMPCOD = ?
			AND TRT.CDTKEY   = ?
			ORDER BY TRT.TRTSERNUM
			 ]]>
		</QRY:Source>
	</QRY:Definition>

		<QRY:Definition>
		<QRY:Id>51</QRY:Id>
		<QRY:Source Name="mail.operations.findcarditdetailsforallmails" Type="NATIVE">
			<![CDATA[
			SELECT CDTMST.CMPCOD,
			  CDTMST.CDTKEY,
			  CDTMST.CSGDOCNUM,
			  CDTMST.CDTSEQNUM,
			  CDTMST.STNCOD
			FROM MALCDTRCP CDTRCP ,
			  MALCDTMST CDTMST,
			  MALMST MALMST
			WHERE CDTRCP.CMPCOD  = CDTMST.CMPCOD
			AND CDTRCP.CDTKEY    = CDTMST.CDTKEY
			AND CDTRCP.CMPCOD    = MALMST.CMPCOD
			AND CDTRCP.MALSEQNUM = MALMST.MALSEQNUM
			AND CDTRCP.CMPCOD    = ?
			AND CDTRCP.MALSEQNUM = ?
			 ]]>
		</QRY:Source>
	</QRY:Definition>


		<QRY:Definition>
				<QRY:Id>52</QRY:Id>
				<QRY:Source Name="mail.operations.findtransferfrominfo.fromcardit.formailbags" Type="NATIVE">
				<![CDATA[

--SELECT TRT.CARCOD RCVCARCOD,
--				  TRT.DEPTIM RCVDAT,TRT.FLTNUM
--				FROM MALCDTMST MST
--				INNER JOIN MALCDTRCP RCP
--				ON MST.CMPCOD =RCP.CMPCOD
--				AND MST.CDTKEY=RCP.CDTKEY
--				INNER JOIN MALCDTTRT TRT
--				ON MST.CMPCOD    =TRT.CMPCOD
--				AND MST.CDTKEY   =TRT.CDTKEY
--				WHERE MST.CDTTYP<>'1'
--				AND TRT.TRTSTGQLF='10'
--				AND MST.CMPCOD   =?
--				AND RCP.RCPIDR   =?
SELECT RTG.FLTCARCOD RCVCARCOD,
  RTG.FLTDAT RCVDAT,
  RTG.FLTNUM,
  RTG.FLTSEQNUM,
  RTG.POU
FROM MALCSGMST CSGMST,
  MALCSGDTL DTL,
  MALCSGRTG RTG,
  FLTOPRMST FLTMST,
  MALMST MST
WHERE MST.CMPCOD  =DTL.CMPCOD
AND CSGMST.POACOD    = DTL.POACOD
AND CSGMST.CSGDOCNUM =DTL.CSGDOCNUM
AND CSGMST.CSGSEQNUM = DTL.CSGSEQNUM
AND CSGMST.CMPCOD    =RTG.CMPCOD
AND CSGMST.POACOD    = RTG.POACOD
AND CSGMST.CSGDOCNUM =RTG.CSGDOCNUM
AND CSGMST.CSGSEQNUM = RTG.CSGSEQNUM
AND RTG.RTGSERNUM =
  (SELECT MIN(CSGRTG.RTGSERNUM)
  FROM MALCSGRTG CSGRTG
  WHERE CSGRTG.CMPCOD  =RTG.CMPCOD
  AND CSGRTG.POACOD    = RTG.POACOD
  AND CSGRTG.CSGDOCNUM =RTG.CSGDOCNUM
  AND CSGRTG.CSGSEQNUM = RTG.CSGSEQNUM
  )
AND RTG.CMPCOD    = FLTMST.CMPCOD
AND RTG.FLTCARIDR = FLTMST.FLTCARIDR
AND RTG.FLTNUM    = FLTMST.FLTNUM
AND RTG.FLTSEQNUM = FLTMST.FLTSEQNUM
AND MST.CMPCOD=DTL.CMPCOD
AND MST.MALSEQNUM=DTL.MALSEQNUM
AND FLTMST.CMPCOD = ?
AND FLTMST.FLTTYP = 'T'
AND MST.MALIDR    = ?


    					]]>
    			</QRY:Source>
		</QRY:Definition>


	<QRY:Definition>
	<QRY:Id>53</QRY:Id>
		<QRY:Source Name="mail.operations.findcarditdespatchdetailsforopflight" Type="NATIVE">
			<![CDATA[
				SELECT DISTINCT MALMST.ORGEXGOFC,
			  MALMST.DSTEXGOFC,
			  MALMST.MALCTG MALCTGCOD,
			  MALMST.MALSUBCLS,
			  MALMST.MALCLS,
			  MALMST.YER,
			  MALMST.DSN,
			  CDTMST.SDRIDR,
			  CDTMST.CSGDOCNUM,
			  CDTMST.CSGCMPDAT
			FROM MALCDTRCP CDTRCP,
			  MALMST MALMST,
			  MALFLT ASGFLT,
			  MALCDTMST CDTMST,
			  MALRDT RDT
			WHERE ASGFLT.CMPCOD  = MALMST.CMPCOD
			AND ASGFLT.FLTCARIDR = MALMST.FLTCARIDR
			AND ASGFLT.FLTNUM    = MALMST.FLTNUM
			AND ASGFLT.FLTSEQNUM = MALMST.FLTSEQNUM
			AND ASGFLT.ARPCOD    = MALMST.SCNPRT
			AND MALMST.CMPCOD    = CDTRCP.CMPCOD
			AND MALMST.MALSEQNUM = CDTRCP.MALSEQNUM
			AND CDTMST.CMPCOD    = CDTRCP.CMPCOD
			AND CDTMST.CDTKEY    = CDTRCP.CDTKEY
			AND RDT.CMPCOD       = MALMST.CMPCOD
			AND RDT.MALSEQNUM    = MALMST.MALSEQNUM
			AND RDT.RDTSND      <> 'S'
			AND ASGFLT.CMPCOD    = ?
			AND ASGFLT.FLTCARIDR = ?
			AND ASGFLT.FLTNUM    = ?
			AND ASGFLT.FLTSEQNUM = ?
			AND ASGFLT.LEGSERNUM = ?
			AND RDT.EVTCOD       = ?
		  ]]>
		 </QRY:Source>
	</QRY:Definition>



	<QRY:Definition>
		<QRY:Id>54</QRY:Id>
				<QRY:Source Name="mail.operations.findcarditpreadvisedetails" Type="NATIVE">
					<![CDATA[
						SELECT T.CMPCOD,T.FLT FLT,
				  T.DST DST,COUNT(*) BAGCNT,SUM(RCP.RCPWGT) BAGWGT
				FROM
				  (
				  SELECT CMPCOD,CDTKEY,CAR1||FLT1||
						CASE WHEN FLT2 IS NOT NULL THEN '\'||CAR2||FLT2 ELSE '' END||
						CASE WHEN FLT3 IS NOT NULL THEN '\'||CAR3||FLT3 ELSE '' END||
						CASE WHEN FLT4 IS NOT NULL THEN '\'||CAR4||FLT4 ELSE '' END||
						CASE WHEN FLT5 IS NOT NULL THEN '\'||CAR5||FLT5 ELSE '' END||
						CASE WHEN FLT6 IS NOT NULL THEN '\'||CAR6||FLT6 ELSE '' END FLT,
						DST1||
						CASE WHEN DST2 IS NOT NULL THEN '\'||DST2 ELSE '' END||
						CASE WHEN DST3 IS NOT NULL THEN '\'||DST3 ELSE '' END||
						CASE WHEN DST4 IS NOT NULL THEN '\'||DST4 ELSE '' END||
						CASE WHEN DST5 IS NOT NULL THEN '\'||DST5 ELSE '' END||
						CASE WHEN DST6 IS NOT NULL THEN '\'||DST6 ELSE '' END DST
						FROM (

					SELECT CMPCOD,CDTKEY,
						  FIRST_VALUE (CARCOD) OVER (PARTITION BY CDTKEY ORDER BY DEPDATUTC) CAR1,
						  LEAD (CARCOD,1) OVER (PARTITION BY CDTKEY ORDER BY DEPDATUTC) CAR2     ,
						  LEAD (CARCOD,2) OVER (PARTITION BY CDTKEY ORDER BY DEPDATUTC) CAR3     ,
						  LEAD (CARCOD,3) OVER (PARTITION BY CDTKEY ORDER BY DEPDATUTC) CAR4     ,
						  LEAD(CARCOD,4) OVER (PARTITION BY CDTKEY ORDER BY DEPDATUTC) CAR5      ,
						  LEAD(CARCOD,5) OVER (PARTITION BY CDTKEY ORDER BY DEPDATUTC) CAR6      ,
						  FIRST_VALUE (FLTNUM) OVER (PARTITION BY CDTKEY ORDER BY DEPDATUTC) FLT1,
						  LEAD (FLTNUM,1) OVER (PARTITION BY CDTKEY ORDER BY DEPDATUTC) FLT2     ,
						  LEAD (FLTNUM,2) OVER (PARTITION BY CDTKEY ORDER BY DEPDATUTC) FLT3     ,
						  LEAD (FLTNUM,3) OVER (PARTITION BY CDTKEY ORDER BY DEPDATUTC) FLT4     ,
						  LEAD(FLTNUM,4) OVER (PARTITION BY CDTKEY ORDER BY DEPDATUTC) FLT5      ,
						  LEAD(FLTNUM,5) OVER (PARTITION BY CDTKEY ORDER BY DEPDATUTC) FLT6      ,
						  FIRST_VALUE (DSTCOD) OVER (PARTITION BY CDTKEY ORDER BY DEPDATUTC) DST1,
						  LEAD (DSTCOD,1) OVER (PARTITION BY CDTKEY ORDER BY DEPDATUTC) DST2     ,
						  LEAD (DSTCOD,2) OVER (PARTITION BY CDTKEY ORDER BY DEPDATUTC) DST3     ,
						  LEAD (DSTCOD,3) OVER (PARTITION BY CDTKEY ORDER BY DEPDATUTC) DST4     ,
						  LEAD(DSTCOD,4) OVER (PARTITION BY CDTKEY ORDER BY DEPDATUTC) DST5      ,
						  LEAD(DSTCOD,5) OVER (PARTITION BY CDTKEY ORDER BY DEPDATUTC) DST6      ,
						  ROW_NUMBER () OVER (PARTITION BY CDTKEY ORDER BY DEPDATUTC) LIMITER
				   FROM (

				   SELECT CDTTRT1.CMPCOD,CDTTRT1.CDTKEY,CDTTRT1.DEPDATUTC,
							CDTTRT1.ORGCOD,CDTTRT1.DSTCOD,CDTTRT1.CARCOD,CDTTRT1.FLTNUM
							FROM
								(
							  SELECT CDTTRT.CMPCOD,CDTTRT.CDTKEY,CDTTRT.DEPDATUTC,CDTTRT.ORGCOD,CDTTRT.DSTCOD
							     FROM MALCDTTRT CDTTRT
							    WHERE CDTTRT.TRTSTGQLF IN (20,30)
							    AND CDTTRT.CMPCOD = ?

							  AND TRUNC(CDTTRT.DEPTIM)         = ?
							 ORDER BY CDTTRT.DEPDATUTC
				  ) Z
				INNER JOIN MALCDTTRT CDTTRT1
							     ON Z.CMPCOD = CDTTRT1.CMPCOD
							     AND Z.CDTKEY       = CDTTRT1.CDTKEY
				WHERE CDTTRT1.DEPDATUTC >= Z.DEPDATUTC

				AND Z.ORGCOD       =?
				ORDER BY CDTTRT1.DEPDATUTC
				)
				) WHERE LIMITER =1
				)T
				INNER JOIN MALCDTRCP RCP
							     ON T.CMPCOD = RCP.CMPCOD
							     AND T.CDTKEY = RCP.CDTKEY
				GROUP BY T.CMPCOD,T.FLT, T.DST
				ORDER BY T.FLT, T.DST
						]]>
		</QRY:Source>
	</QRY:Definition>


	<QRY:Definition>
		<QRY:Id>55</QRY:Id>
		<QRY:Source Name="mail.operations.getcarditorigin" Type="NATIVE">
		<![CDATA[
			SELECT RFF.REFNUM RFFNUM FROM MALCDTREF RFF,MALCDTMST MST,MALCDTRCP RCP
			WHERE
			MST.CMPCOD =RCP.CMPCOD
			AND MST.CDTKEY =RCP.CDTKEY
			AND MST.CMPCOD=RFF.CMPCOD
			AND MST.CDTKEY=RFF.CDTKEY
			AND RFF.REFQLF='ERN'
			AND MST.CMPCOD=?
			AND RCP.MALSEQNUM=?

		]]>
	</QRY:Source>
	</QRY:Definition>



		<QRY:Definition>
		<QRY:Id>56</QRY:Id>
		<QRY:Source Name="mail.operations.finduldresditstatus" Type="NATIVE">
			<![CDATA[
				SELECT RDTSND, PROSTA
				FROM MALULDRDT
				WHERE CMPCOD = ?
				 AND ULDNUM = ?
				 AND EVTCOD = ?
				 AND EVTPRT = ?
				 AND FLTCARIDR = ?
				 AND FLTNUM = ?
				 AND FLTSEQNUM = ?
				AND SEGSERNUM = ?
			]]>
		</QRY:Source>
	</QRY:Definition>


			<QRY:Definition>
	<QRY:Id>57</QRY:Id>
	<QRY:Source Name="mail.operations.findpaforshipperbuiltuldsfromcardit" Type="NATIVE">
	<![CDATA[
			SELECT CON.CONNUM MALORULD,
		  MST.SDRIDR POACOD
		FROM MALCDTMST MST ,
		  MALCDTCON CON
		WHERE MST.CMPCOD  = CON.CMPCOD
		AND MST.CDTKEY    = CON.CDTKEY
		AND MST.CSGCMPDAT > SYSDATE -7
		AND MST.CMPCOD    = ?

	]]>
	</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>58</QRY:Id>
	<QRY:Source Name="mail.operations.findofficeofexchangecodes" Type="NATIVE">
	<![CDATA[

	SELECT CMPCOD, ACTFLG, CTYCOD, EXGOFCCOD, EXGCODDES, CNTCOD, OFCCOD, POACOD,ARPCOD, LSTUPDUSR, LSTUPDTIM,MALBOXIDR MALBOXID
      FROM MALEXGOFCMST
      WHERE CMPCOD = ?
	]]>
	</QRY:Source>
	</QRY:Definition>


	<QRY:Definition>
	<QRY:Id>59</QRY:Id>
	<QRY:Source Name="mail.operations.findpacodeforexchangeoffice" Type="NATIVE">
		<![CDATA[
		SELECT MST.POACOD
		  FROM MALEXGOFCMST MST
		 WHERE MST.CMPCOD = ?
		 AND MST.EXGOFCCOD = ? AND  MST.ACTFLG='A'
		]]>
	</QRY:Source>
	</QRY:Definition>

	 <QRY:Definition>
	<QRY:Id>60</QRY:Id>
	<QRY:Source Name="mail.operations.findpartyidforpostalauthority" Type="NATIVE">
		<![CDATA[

		SELECT DTL.PTYIDR PTYIDR
		FROM MALPOADTL DTL
		WHERE DTL.CMPCOD = ?
		AND DTL.POACOD   = ?
		AND DTL.PARCOD   ='UPUCOD'
		AND TRUNC(current_date) BETWEEN TRUNC(DTL.VLDFRM) AND TRUNC(DTL.VLDTOO)

			]]>
	</QRY:Source>
  </QRY:Definition>

  <QRY:Definition>
		<QRY:Id>61</QRY:Id>
		<QRY:Source Name="mail.operations.findresditconfiguration" Type="NATIVE">
			<![CDATA[
			SELECT CFG.TXNCOD,
			  CFG.RCVRDTFLG,
			  CFG.ASGRDTFLG,
			  CFG.UPLRDTFLG,
			  CFG.DEPRDTFLG,
			  CFG.HNDOVRFLG,
			  CFG.HNDOVRRCVFLG,
			  CFG.LSTUPDTIM,
			  CFG.LSTUPDUSR,
			  CFG.DLVRDTFLG,
			  CFG.RETRDTFLG ,
			  CFG.RDYDLVRDTFLG,
			  CFG.TRTCPLRDTFLG,
			  CFG.ARRRDTFLG
			FROM MALRDTCFG CFG
			WHERE CFG.CMPCOD = ?
			AND CFG.CARIDR   = ?
			 ]]>
		</QRY:Source>
	</QRY:Definition>

		<QRY:Definition>
		<QRY:Id>62</QRY:Id>
		<QRY:Source Name="mail.operations.findresditconfigfortxn" Type="NATIVE">
			<![CDATA[
			SELECT CFG.RCVRDTFLG,
		  CFG.ASGRDTFLG,
		  CFG.UPLRDTFLG,
		  CFG.DEPRDTFLG,
		  CFG.HNDOVRFLG,
		  CFG.HNDOVRRCVFLG,
		  CFG.RETRDTFLG,
		  CFG.DLVRDTFLG
		FROM MALRDTCFG CFG
		WHERE CFG.CMPCOD = ?
		AND CFG.CARIDR   = ?
		AND CFG.TXNCOD   = ?
			 ]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>63</QRY:Id>
	<QRY:Source Name="mail.operations.findexistingmailbags" Type="NATIVE">
		<![CDATA[
			SELECT DISTINCT MST.CMPCOD,
			  MST.CONNUM ULDNUM,
			  MST.CONTYP,
			  MST.MALSTA,
			  MST.SCNPRT,
			  MST.DSN,
			  MST.YER,
			  MST.MALSUBCLS,
			  MST.MALCTG MALCTGCOD,
			  MST.ORGEXGOFC,
			  MST.DSTEXGOFC,
			  MST.FLTCARIDR,
			  MST.FLTNUM,
			  MST.FLTSEQNUM,
			  MST.SEGSERNUM,
			  FLT.LEGSERNUM,
			  MST.MALIDR,
			  FLT.FLTCARCOD,
			  FLT.EXPCLSFLG CLSFLG,
			  FLT.FLTDAT
			FROM MALMST MST
			LEFT OUTER JOIN MALFLT FLT
			ON MST.CMPCOD     = FLT.CMPCOD
			AND MST.SCNPRT    = FLT.ARPCOD
			AND MST.FLTCARIDR = FLT.FLTCARIDR
			AND MST.FLTNUM    = FLT.FLTNUM
			AND MST.FLTSEQNUM = FLT.FLTSEQNUM
			LEFT OUTER JOIN MALULDSEGDTL ULDSEG
			ON ( ULDSEG.CMPCOD   = MST.CMPCOD
			AND ULDSEG.ULDNUM    = MST.CONNUM
			AND ULDSEG.MALSEQNUM =MST.MALSEQNUM
			AND ULDSEG.FLTCARIDR = MST.FLTCARIDR
			AND ULDSEG.FLTNUM    = MST.FLTNUM
			AND ULDSEG.FLTSEQNUM = MST.FLTSEQNUM
			AND ULDSEG.SEGSERNUM = MST.SEGSERNUM )
			WHERE MST.CMPCOD  = ?
			AND MST.MALSEQNUM = ?
	]]>	</QRY:Source>
	</QRY:Definition>

			<QRY:Definition>
				<QRY:Id>64</QRY:Id>
				<QRY:Source Name="mail.operations.findpoacode" Type="NATIVE">
				<![CDATA[
				SELECT POACOD FROM MALEXGOFCMST WHERE CMPCOD = ? AND EXGOFCCOD = ?
				]]>
				</QRY:Source>
			</QRY:Definition>

				<QRY:Definition>
				<QRY:Id>65</QRY:Id>
				<QRY:Source Name="mail.operations.findacceptancetodepartureservicetime" Type="NATIVE">
				<![CDATA[
				SELECT SLADTL.SRVTIM,
				  CTRDTL.SLAACTONE SLAIDR
				FROM MALCTRDTL CTRDTL,
				  MALCTRMST CTRMST,
				  MALSLADTL SLADTL
				WHERE CTRMST.CMPCOD  = CTRDTL.CMPCOD
				AND CTRMST.CTRREFNUM = CTRDTL.CTRREFNUM
				AND CTRDTL.SLAACTONE = SLADTL.SLAIDR
				AND ? BETWEEN CTRMST.VLDFRMDAT AND CTRMST.VLDTOODAT
				AND CTRMST.AGRSTA    = 'A'
				AND CTRMST.CMPCOD    = ?
				AND CTRMST.GPACOD    = ?
				AND CTRDTL.ORGCOD    = ?
				AND CTRDTL.DSTCOD    = ?
				AND SLADTL.MALCTGCOD = ?
				]]>
				</QRY:Source>
			</QRY:Definition>

				<QRY:Definition>
				<QRY:Id>66</QRY:Id>
				<QRY:Source Name="mail.operations.findarrivaltodeliveryservicetime" Type="NATIVE">
				<![CDATA[
				SELECT SLADTL.SRVTIM,
				  CTRDTL.SLAACTTWO SLAIDR
				FROM MALCTRDTL CTRDTL,
				  MALCTRMST CTRMST,
				  MALSLADTL SLADTL
				WHERE CTRMST.CMPCOD  = CTRDTL.CMPCOD
				AND CTRMST.CTRREFNUM = CTRDTL.CTRREFNUM
				AND CTRDTL.SLAACTTWO = SLADTL.SLAIDR
				AND CTRMST.CMPCOD    = ?
				AND CTRMST.GPACOD    = ?
				AND CTRDTL.ORGCOD    = ?
				AND CTRDTL.DSTCOD    = ?
				AND SLADTL.MALCTGCOD = ?
				]]>
				</QRY:Source>
			</QRY:Definition>

				<QRY:Definition>
		<QRY:Id>67</QRY:Id>
		<QRY:Source Name="mail.operations.findcitycodeforexchangeoffices" Type="NATIVE">
			<![CDATA[
				SELECT EXG.CTYCOD,EXG.EXGOFCCOD,COALESCE(EXG.ARPCOD,CTYMST.SRVARPCOD) ARPCOD
				         FROM MALEXGOFCMST EXG,SHRCTYMST CTYMST
				        WHERE  EXG.CTYCOD = CTYMST.CTYCOD
				        AND EXG.CMPCOD = CTYMST.CMPCOD
				        AND EXG.CMPCOD = ?
			]]>
		</QRY:Source>
	</QRY:Definition>

		<QRY:Definition>
		<QRY:Id>68</QRY:Id>
			<QRY:Source Name="mail.operations.findLatestContainerAssignment" Type="NATIVE">
				<![CDATA[
					SELECT MST.CMPCOD,
					  MST.POAFLG,
					  MST.CONNUM,
					  MST.ASGPRT,
					  MST.FLTCARIDR,
					  MST.FLTNUM,
					  MST.FLTSEQNUM,
					  MST.SEGSERNUM,
					  MST.LEGSERNUM,
					  MST.FLTCARCOD,
					  MST.DSTCOD,
					  MST.ACPFLG,
					  FLT.FLTDAT,
					  FLT.EXPCLSFLG CLSFLG,
					  MST.POU,
					  MST.CONTYP,
					  MST.ARRSTA,
					  MST.LSTUPDTIM,
					  MST.TXNCOD,
					  ULDSEG.RELFLG,
					  MST.RMK,
					  MST.TRNFLG,
					  MST.OFLFLG,
					  MST.ACTULDWGT,
					  MST.ASGDAT,
					  MST.ULDFULIND,
					  MST.ULDREFNUM
					FROM MALFLTCON MST
					LEFT OUTER JOIN MALFLT FLT
					ON MST.CMPCOD     = FLT.CMPCOD
					AND MST.ASGPRT    = FLT.ARPCOD
					AND MST.FLTCARIDR = FLT.FLTCARIDR
					AND MST.FLTNUM    = FLT.FLTNUM
					AND MST.FLTSEQNUM = FLT.FLTSEQNUM
					AND MST.LEGSERNUM = FLT.LEGSERNUM
					LEFT OUTER JOIN MALULDSEG ULDSEG
					ON MST.CMPCOD     = ULDSEG.CMPCOD
					AND MST.FLTCARIDR = ULDSEG.FLTCARIDR
					AND MST.FLTNUM    = ULDSEG.FLTNUM
					AND MST.FLTSEQNUM = ULDSEG.FLTSEQNUM
					AND MST.SEGSERNUM = ULDSEG.SEGSERNUM
					AND MST.CONNUM    = ULDSEG.ULDNUM
					WHERE MST.CMPCOD  = ?
					AND MST.CONNUM    = ?
					AND MST.ASGDATUTC =(SELECT MAX (ASGDATUTC) FROM MALFLTCON WHERE CMPCOD = ?
                    AND CONNUM = ?)
					

					]]>
			</QRY:Source>
	</QRY:Definition>

  <QRY:Definition>
<QRY:Id>69</QRY:Id>
<QRY:Source Name="mail.operations.findcontainerassignment" Type="NATIVE">
	<![CDATA[

			SELECT MST.CMPCOD,
			  MST.CONNUM,
			  MST.ASGPRT,
			  MST.FLTCARIDR,
			  MST.FLTNUM,
			  MST.FLTSEQNUM,
			  MST.SEGSERNUM,
			  MST.LEGSERNUM,
			  MST.FLTCARCOD,
			  MST.DSTCOD,
			  MST.ACPFLG,
			  FLT.FLTDAT,
			  FLT.EXPCLSFLG CLSFLG,
			  MST.POU,
			  MST.CONTYP,
			  MST.ARRSTA,
			  MST.LSTUPDTIM,
			  MST.TRNFLG,
			  MST.TRAFLG,
			  MST.ULDFULIND,
			  MST.ULDREFNUM
			FROM MALFLTCON MST
			LEFT OUTER JOIN MALFLT FLT
			ON MST.CMPCOD    =FLT.CMPCOD
			AND MST.ASGPRT   =FLT.ARPCOD
			AND MST.FLTCARIDR=FLT.FLTCARIDR
			AND MST.FLTNUM   =FLT.FLTNUM
			AND MST.FLTSEQNUM=FLT.FLTSEQNUM
			AND MST.LEGSERNUM=FLT.LEGSERNUM
			WHERE MST.CMPCOD = ?
			AND MST.CONNUM   =?
			AND MST.ASGPRT   =?
			AND MST.ASGDAT   =
			  (SELECT MAX(ASGDAT) FROM MALFLTCON WHERE CMPCOD= ? AND CONNUM=? AND ASGPRT=?
			  )







]]>
</QRY:Source>
</QRY:Definition>


<QRY:Definition>
<QRY:Id>70</QRY:Id>
<QRY:Source Name="mail.operations.ismailsubclassvalid" Type="NATIVE">
	<![CDATA[
			SELECT SUBCLSCOD FROM MALSUBCLSMST WHERE CMPCOD= ? AND SUBCLSCOD = ?
	]]>
</QRY:Source>
</QRY:Definition>



	<QRY:Definition>
	<QRY:Id>71</QRY:Id>
		<QRY:Source Name="mail.operations.findMailDiscrepancies" Type="NATIVE">
			<![CDATA[

			    SELECT malseg.cmpcod cmpcod,
				  mst.malidr malidr,
				  malseg.uldnum uldnum,
				  COALESCE(malseg.acpsta,'N') acpsta,
				  COALESCE(malseg.arrsta,'N') arrsta
				FROM MALFLTSEG fltseg,
				  MALULDSEGDTL malseg,MALMST mst
				WHERE fltseg.fltcaridr           = malseg.fltcaridr
				AND fltseg.fltnum                = malseg.fltnum
				AND fltseg.fltseqnum             = malseg.fltseqnum
				AND fltseg.cmpcod                = malseg.cmpcod
				AND fltseg.segsernum             = malseg.segsernum
				AND mst.cmpcod                   = malseg.cmpcod
				AND mst.malseqnum                = malseg.malseqnum
				AND malseg.fltcaridr             = ?
				AND malseg.fltnum                = ?
				AND malseg.fltseqnum             = ?
				AND malseg.cmpcod                = ?
				AND fltseg.pou                   = ?
				AND ( (malseg.acpsta             = 'Y'
				AND COALESCE(malseg.arrsta,'N')  = 'N')
				OR ( COALESCE(malseg.acpsta,'N') = 'N'
				AND malseg.arrsta                = 'Y' ) )

			]]>
		</QRY:Source>
	</QRY:Definition>


		 <QRY:Definition>
			<QRY:Id>72</QRY:Id>
			<QRY:Source Name="mail.operations.finduldsininboundflight" Type="NATIVE">
				<![CDATA[
					SELECT DISTINCT uld.uldnum connum,
					  fltseg.pol asgprt,
					  fltseg.pou,
					  COALESCE(mst.LEGSERNUM,flt.legsernum) LEGSERNUM
					FROM MALFLT flt
					INNER JOIN MALFLTSEG fltseg
					ON flt.cmpcod     = fltseg.cmpcod
					AND flt.fltcaridr = fltseg.fltcaridr
					AND flt.fltnum    = fltseg.fltnum
					AND flt.fltseqnum = fltseg.fltseqnum
					AND flt.arpcod    = fltseg.pou
					INNER JOIN MALULDSEG uld
					ON fltseg.cmpcod               = uld.cmpcod
					AND fltseg.fltcaridr           = uld.fltcaridr
					AND fltseg.fltnum              = uld.fltnum
					AND fltseg.fltseqnum           = uld.fltseqnum
					AND fltseg.segsernum           = uld.segsernum
					AND SUBSTR (ULD.ULDNUM, 0, 4) <> 'BULK'
					LEFT OUTER JOIN MALFLTCON mst
					ON mst.cmpcod        = uld.cmpcod
					AND mst.fltcaridr    = uld.fltcaridr
					AND mst.fltnum       = uld.fltnum
					AND mst.fltseqnum    = uld.fltseqnum
					AND mst.segsernum    = uld.segsernum
					AND mst.POU          = flt.arpcod
					WHERE flt.IMPCLSFLG IS NOT NULL
					AND flt.cmpcod       = ?
					AND flt.fltcaridr    = ?
					AND flt.fltnum       = ?
					AND flt.fltseqnum    = ?
					AND flt.arpcod       = ?

				 ]]>
			</QRY:Source>
		</QRY:Definition>



			<QRY:Definition>
		<QRY:Id>73</QRY:Id>
		<QRY:Source Name="mail.operations.findmailbagdetailsforupload" Type="NATIVE">
			<![CDATA[
			SELECT MAL.CMPCOD,
            COALESCE(ULD.FLTCARIDR,MAL.FLTCARIDR) FLTCARIDR, 
            COALESCE(ULD.FLTNUM,MAL.FLTNUM)FLTNUM,
	        COALESCE(ULD.FLTSEQNUM,MAL.FLTSEQNUM)FLTSEQNUM,
            COALESCE(ULD.SEGSERNUM,MAL.SEGSERNUM)SEGSERNUM, 
			SEG.POL,MAL.POU DST,
			  MAL.CONTYP,
			  COALESCE(ULD.ULDNUM,MAL.CONNUM) ULDNUM,
		COALESCE(ULD.CONNUM,MAL.CONNUM) CONNUM,
			  MAL.OPRSTA,
	    COALESCE(FLT.FLTCARCOD,INBFLT.FLTCARCOD,ARLMST.TWOAPHCOD) FLTCARCOD,
	    COALESCE(FLT.LEGSERNUM ,INBFLT.LEGSERNUM) LEGSERNUM,
		CASE when MAL.OPRSTA='O' then FLT.FLTDAT 
         when MAL.OPRSTA='I' then INBFLT.FLTDAT
        else FLT.FLTDAT end FLTDAT,
		--COALESCE(FLT.FLTDAT,INBFLT.FLTDAT) FLTDAT,
			  MAL.MALSTA,
		SEG.POU, MAL.CSGDOCNUM ,MAL.POACOD ,ULD.ARRSTA,
		MAL.CSGSEQNUM,ULD.TRAFLG,MAL.SCNPRT,MAL.DMGFLG,MAL.DSPDAT,
		ARP.ULDNUM INVULDNUM,null INVCONNUM,FLT.EXPCLSFLG CLSFLG
  FROM MALMST MAL LEFT OUTER JOIN MALFLTSEG SEG ON
  		MAL.CMPCOD = SEG.CMPCOD
			AND MAL.FLTCARIDR = SEG.FLTCARIDR
			AND MAL.FLTSEQNUM = SEG.FLTSEQNUM
			AND MAL.FLTNUM    = SEG.FLTNUM
			AND MAL.SEGSERNUM = SEG.SEGSERNUM
  		LEFT OUTER JOIN MALULDSEGDTL ULD ON
  		MAL.CONNUM = ULD.CONNUM
			AND SEG.CMPCOD    = ULD.CMPCOD
			AND SEG.FLTCARIDR = ULD.FLTCARIDR
			AND SEG.FLTSEQNUM = ULD.FLTSEQNUM
			AND SEG.FLTNUM    = ULD.FLTNUM
			AND SEG.SEGSERNUM = ULD.SEGSERNUM

  		LEFT OUTER JOIN MALFLT FLT ON
  		FLT.CMPCOD = MAL.CMPCOD
			AND FLT.FLTCARIDR = MAL.FLTCARIDR
			AND FLT.FLTSEQNUM = MAL.FLTSEQNUM
			AND FLT.FLTNUM    = MAL.FLTNUM
			AND FLT.ARPCOD    = SEG.POL
      AND FLT.EXPCLSFLG is not null
		LEFT OUTER JOIN MALFLT INBFLT
			 ON INBFLT.CMPCOD = MAL.CMPCOD
		AND INBFLT.FLTCARIDR  = MAL.FLTCARIDR
		AND INBFLT.FLTSEQNUM  = MAL.FLTSEQNUM
		AND INBFLT.FLTNUM     = MAL.FLTNUM
		AND INBFLT.ARPCOD     = SEG.POU
    AND INBFLT.IMPCLSFLG is not null
			LEFT OUTER JOIN MALARPULD ARP
			ON MAL.CMPCOD     = ARP.CMPCOD
			AND MAL.FLTCARIDR = ARP.FLTCARIDR
			AND MAL.SCNPRT    = ARP.ARPCOD
		AND MAL.CONNUM        = ARP.ULDNUM
			LEFT OUTER JOIN SHRARLMST ARLMST
			ON MAL.FLTCARIDR  = ARLMST.ARLIDR
			AND MAL.CMPCOD    = ARLMST.CMPCOD
			INNER JOIN MALPOAMST POAMST
            ON MAL.CMPCOD  =POAMST.CMPCOD
            AND MAL.POACOD =POAMST.POACOD
			WHERE MAL.CMPCOD  = ?
			AND MAL.MALIDR = ?
            AND ((TO_NUMBER(TO_CHAR(current_date,'YYYYMMDD'))) - (TO_NUMBER(TO_CHAR(MAL.DSPDAT,'YYYYMMDD'))) <= POAMST.DUPMALPRD
            OR POAMST.DUPMALPRD = 0)


			]]>
		</QRY:Source>
	</QRY:Definition>


	<QRY:Definition>
<QRY:Id>74</QRY:Id>
<QRY:Source Name="mail.operations.findpartnercarriers" Type="NATIVE">
	<![CDATA[

	SELECT MTK.CMPCOD,
	MTK.OWNCARCOD ,
	MTK.ARPCOD ,
	MTK.PRTCARCOD ,
	MTK.PRTCARIDR ,
	MTK.PRTCARNAM,
	MTK.LSTUPDTIM ,
	MTK.LSTUPDUSR
	FROM MALPRTCAR MTK
	WHERE MTK.CMPCOD  = ?
		AND MTK.OWNCARCOD = ?
AND MTK.ARPCOD    = ?

]]>
</QRY:Source>
</QRY:Definition>


<QRY:Definition>
<QRY:Id>76</QRY:Id>
<QRY:Source Name="mail.operations.findMailSequenceNumber" Type="NATIVE">
	<![CDATA[
		SELECT MALSEQNUM
		FROM MALCSGDTL
		WHERE CMPCOD  = ?
		AND CSGDOCNUM = ?
		AND POACOD    = ?
		AND CSGSEQNUM = ?

]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>77</QRY:Id>
<QRY:Source Name="mail.operations.checkConsignmentDocumentExists" Type="NATIVE">
	<![CDATA[
		SELECT cmpcod, csgdocnum, poacod, csgseqnum
		FROM MALCSGMST
		WHERE cmpcod =   ?  AND csgdocnum = ? AND poacod = ? AND
		TRUNC(csgdat) = ?
	]]>
</QRY:Source>
</QRY:Definition>


<QRY:Definition>
<QRY:Id>78</QRY:Id>
<QRY:Source Name="mail.operations.findconsignmentdetailsformailbag" Type="NATIVE">
	<![CDATA[

     	SELECT MAL.CMPCOD,
		  MAL.CSGDOCNUM,
		  MAL.POACOD,
		  MAL.MALSEQNUM,
		  MAL.CSGSEQNUM
		FROM MALCSGMST MST,
		  MALCSGDTL MAL,
                             MALMST MALMST,
                             MALPOAMST POAMST
		WHERE MALMST.MALSEQNUM=MAL.MALSEQNUM
		AND MALMST.CMPCOD     =MAL.CMPCOD
		AND MST.CMPCOD        = MAL.CMPCOD
		AND MST.CSGDOCNUM     = MAL.CSGDOCNUM
		AND MST.POACOD        = MAL.POACOD
		AND MST.CSGSEQNUM     = MAL.CSGSEQNUM
                             AND MST.CMPCOD = POAMST.CMPCOD
                             AND MST.POACOD = POAMST.POACOD
							 --AND poamst.dupmalprd >= to_number(SYSDATE - malmst.dspdat)
							 AND poamst.dupmalprd >= (TO_NUMBER(TO_CHAR(current_date,'YYYYMMDD'))-TO_NUMBER(TO_CHAR(MALMST.DSPDAT,'YYYYMMDD')))
                             AND MALMST.CMPCOD        = ?
]]>
</QRY:Source>
</QRY:Definition>



	<QRY:Definition>
	<QRY:Id>79</QRY:Id>
	<QRY:Source Name="mail.operations.findConsignmentRoutingInfos" Type="NATIVE">
		<![CDATA[


			SELECT CSG.CMPCOD CMPCOD,
			  CSG.CSGDOCNUM CSGDOCNUM,
			  CSG.POACOD POACOD      ,
			  CSG.CSGSEQNUM CSGSEQNUM,
			  CSG.CSGDAT CSGDAT      ,
			  CSG.OPRTYP OPRTYP      ,
			  CSG.LSTUPDTIM          ,
			  CSG.LSTUPDUSR          ,
			  CSG.CSGTYP CSGTYP      ,
			  CSG.SUBTYP SUBTYP      ,
			  CSG.RMK RMK            ,
			  CSG.STDBAG STDBAG      ,
			  CSG.STDWGT STDWGT      ,
			  CSG.ARPCOD ARPCOD      ,
			  CSG.SUBTYP SUBTYP,
			  CSG.MSTDOCNUM MSTDOCNUM,
			  RTG.RTGSERNUM RTGSERNUM,
			  RTG.FLTCARCOD FLTCARCOD,
			  RTG.FLTNUM FLTNUM      ,
			  RTG.FLTDAT FLTDAT      ,
			  RTG.FLTCARIDR FLTCARIDR,
			  RTG.POU POU            ,
			  RTG.POL POL			 ,
			  RTG.TRSSTG TRSSTG
			 FROM MALCSGMST CSG
			LEFT OUTER JOIN MALCSGRTG RTG
			ON CSG.CMPCOD = RTG.CMPCOD
			AND CSG.CSGDOCNUM  = RTG.CSGDOCNUM
			AND CSG.POACOD     = RTG.POACOD
			AND CSG.CSGSEQNUM  = RTG.CSGSEQNUM
			WHERE CSG.CMPCOD = ?
			AND CSG.CSGDOCNUM  = ?
			AND CSG.POACOD     = ?
			ORDER BY RTG.RTGSERNUM
		]]>
	</QRY:Source>
</QRY:Definition>


<QRY:Definition>
<QRY:Id>80</QRY:Id>
<QRY:Source Name="mail.operations.findConsignmentDocumentDetails" Type="NATIVE">
	<![CDATA[


		SELECT MAL.CMPCOD ,
		  MST.DSN DSN ,
		  MST.ORGEXGOFC ORGEXGOFC,
		  MST.DSTEXGOFC DSTEXGOFC,
		  MST.MALCLS MALCLS ,
		  MST.YER YER ,
		  MAL.MALSEQNUM MALSEQNUM,
		  MST.MALIDR MALIDR ,
		  MST.MALCTG MALCTGCOD,
		  MST.MALSUBCLS MALSUBCLS,
		  MST.HSN HSN ,
		  MST.RSN RSN ,
		  MST.REGIND REGIND ,
		  MST.WGT WGT ,
		  MST.DSPWGT DSPWGT,
		  MST.DSPWGTUNT DSPWGTUNT,
		  MST.DUPNUM,
		  MST.SEQNUM,
		  MST.DOCOWRIDR,
		  MAL.ULDNUM ULDNUM ,
		  MAL.BAGCNT BAGCNT ,
		  MAL.CSGDOCNUM ,
		  MAL.POACOD ,
		  MAL.DCLVAL ,
		  MAL.CURCOD ,
		  MAL.CSGSEQNUM ,
		  MST.TRPSRVENDTIM  ,
		  MST.REQDLVTIM,
		  MST.ORGCOD,
          MST.DSTCOD,
		  MST.MALSRVLVL,
		  MST.MSTDOCNUM MSTDOCNUM ,
		  MST.SHPPFX SHPPFX,
          MST.MALSTA MALSTA,
		  DENSE_RANK() OVER ( ORDER BY MAL.CSGDOCNUM,MAL.CSGSEQNUM,MAL.POACOD, MST.DSN,MST.ORGEXGOFC,MST.DSTEXGOFC,MST.MALCTG,MST.MALSUBCLS, MST.MALSEQNUM,MST.YER,MST.CMPCOD) AS RANK
         FROM MALCSGMST CSG
		INNER JOIN  MALCSGDTL MAL
		ON CSG.CMPCOD     = MAL.CMPCOD
		AND CSG.CSGDOCNUM = MAL.CSGDOCNUM
		AND CSG.POACOD    = MAL.POACOD
		AND CSG.CSGSEQNUM = MAL.CSGSEQNUM
		INNER JOIN MALMST MST
		ON MST.CMPCOD     =MAL.CMPCOD
		AND MST.MALSEQNUM =MAL.MALSEQNUM
		WHERE CSG.CMPCOD  = ?
		AND CSG.CSGDOCNUM = ?
		AND CSG.POACOD    = ?
	]]>
</QRY:Source>
</QRY:Definition>


<QRY:Definition>
<QRY:Id>81</QRY:Id>
<QRY:Source Name="mail.operations.checkMailAccepted" Type="NATIVE">
	<![CDATA[

			SELECT CMPCOD
			FROM MALMST
			WHERE CMPCOD = ?
			AND MALIDR=?
			AND MALSTA not in ('NEW','CAN')


]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
	<QRY:Id>82</QRY:Id>
		<QRY:Source Name="mail.operations.findMailbagDetailsForReport" Type="NATIVE">
			<![CDATA[
					SELECT MAL.CMPCOD,
					MST.DSN,
					MST.MALIDR MALIDR,
					MST.ORGEXGOFC ORGEXGOFC,
					MAL.CNTDOCNUM CNTDOCNUM,
					MST.DSTEXGOFC DSTEXGOFC,
					MST.MALCTGCOD MALCTGCOD,
					MST.MALSUBCLS MALSUBCLS,
					MST.MALCLS MALCLS,
					MAL.WGT WGT,
					ASGFLT.POL POL,
					MAL.ULDNUM ULDNUM,
					ASGFLT.POU POU,
					ORG.SRVARPCOD ORGARPCOD,
					DST.SRVARPCOD DSTARPCOD,
					DSTARP.ARPNAM DSTARPNAM,
					ORGEXG.CTYCOD ORGCTY,
					DSTEXG.CTYCOD DSTCTY
					FROM MALULDSEGDTL MAL,
					MALFLTSEG ASGFLT,
					MALMST MST,
					SHRCTYMST ORG,
					SHRCTYMST DST,
					MALEXGOFCMST ORGEXG,
					MALEXGOFCMST DSTEXG,
					SHRARPMST DSTARP
					WHERE MAL.CMPCOD     = ASGFLT.CMPCOD
					AND MAL.FLTCARIDR    = ASGFLT.FLTCARIDR
					AND MAL.FLTNUM       = ASGFLT.FLTNUM
					AND MAL.FLTSEQNUM    = ASGFLT.FLTSEQNUM
					AND MAL.SEGSERNUM    = ASGFLT.SEGSERNUM
					AND MAL.MALSEQNUM = MST.MALSEQNUM
					AND MAL.CMPCOD   = MST.CMPCOD
					AND ORGEXG.CMPCOD    = MST.CMPCOD
					AND ORGEXG.EXGOFCCOD = MST.ORGEXGOFC
					AND DSTEXG.CMPCOD    = MST.CMPCOD
					AND DSTEXG.EXGOFCCOD = MST.DSTEXGOFC
					AND ORG.CMPCOD       = ASGFLT.CMPCOD
					AND ORG.CTYCOD       = ORGEXG.CTYCOD
					AND DST.CTYCOD       = DSTEXG.CTYCOD
					AND DST.CMPCOD       = DSTARP.CMPCOD
					AND DST.SRVARPCOD    = DSTARP.ARPCOD
					AND MAL.CNTDOCNUM   IS NOT NULL
					AND MAL.CMPCOD       = ?
					AND MAL.FLTCARIDR    = ?
					AND MAL.FLTNUM       = ?
					AND MAL.FLTSEQNUM    = ?
			 ]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>83</QRY:Id>
		<QRY:Source Name="mail.operations.findconsignmentdetailsfordespatchdetails" Type="NATIVE">
			<![CDATA[
SELECT CSGMAL.CSGDOCNUM,
					CSGMAL.POACOD,
					MALMST.DSN,
					MALMST.ORGEXGOFC,
					MALMST.DSTEXGOFC,
					MALMST.MALCTG MALCTGCOD,
					MALMST.MALSUBCLS,
					MALMST.YER,
					CSGMST.STDBAG STDBAG,
					MALMST.WGT STDWGT,
					CSGMST.CSGDAT
					FROM MALCSGMST CSGMST
					INNER JOIN MALCSGDTL CSGMAL
					ON CSGMAL.CMPCOD     = CSGMST.CMPCOD
					AND CSGMAL.CSGDOCNUM = CSGMST.CSGDOCNUM
					AND CSGMAL.CSGSEQNUM = CSGMST.CSGSEQNUM
					AND CSGMAL.POACOD    = CSGMST.POACOD
					INNER JOIN MALMST MALMST
					ON CSGMAL.CMPCOD     = MALMST.CMPCOD
					AND CSGMAL.MALSEQNUM = MALMST.MALSEQNUM
					WHERE CSGMAL.CMPCOD  = ?
					AND CSGMAL.CSGDOCNUM = ?
					AND CSGMAL.CSGSEQNUM = ?
					AND CSGMAL.POACOD    = ?
					AND CSGMAL.MALSEQNUM = ?

			]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>84</QRY:Id>
		<QRY:Source Name="mail.operations.generateconsignmentdetailsreport" Type="NATIVE">
			<![CDATA[
					SELECT CSG.CMPCOD CMPCOD,
					CSG.CSGDOCNUM CSGDOCNUM,
					CSG.POACOD POACOD,
					CSG.CSGSEQNUM CSGSEQNUM,
					CSG.CSGDAT CSGDAT,
					CSG.OPRTYP OPRTYP ,
					CSG.LSTUPDTIM,
					CSG.LSTUPDUSR,
					CSG.CSGTYP CSGTYP,
					CSG.RMK RMK,
					CSG.STDBAG STDBAG,
					CSG.STDWGT STDWGT,
					CSG.ARPCOD ARPCOD,
					CSG.SUBTYP,
				    CSG.OPRORG,
				    CSG.OPRDST,
					(SELECT EXGCODDES FROM MALEXGOFCMST
						WHERE CMPCOD = CSG.CMPCOD
						AND EXGOFCCOD = ORGEXGOFC
					)ORGEXGOFCDES,
					(SELECT EXGCODDES FROM MALEXGOFCMST
						WHERE CMPCOD = CSG.CMPCOD
						AND EXGOFCCOD = DSTEXGOFC
					)DSTEXGOFCDES,
				    CSG.TRPMNS,
				    CSG.CSGPRI,
				    CSG.FLTDTL,
				    CSG.FLTRUT,
				    CSG.FSTFLTDEPDAT,
				    CSG.ARLCOD,
					MALMST.DSN DSN,
					MALMST.ORGEXGOFC ORGEXGOFC,
					MALMST.DSTEXGOFC DSTEXGOFC,
					MALMST.MALCLS MALCLS,
					MALMST.YER YER,
					MALMST.MALSEQNUM MALSEQNUM,
					MALMST.MALIDR MALIDR,
					MALMST.MALCTG MALCTGCOD,
					MALMST.MALSUBCLS MALSUBCLS,
					MALMST.HSN HSN,
					MALMST.RSN RSN,
					MALMST.REGIND REGIND,
					MALMST.WGT WGT,
					MAL.ULDNUM ULDNUM,
					MAL.DCLVAL DCLVAL,
					MAL.CURCOD CURCOD,
					MAL.BAGCNT BAGCNT,
					RTG.RTGSERNUM RTGSERNUM,
					RTG.FLTCARCOD FLTCARCOD,
					RTG.FLTNUM FLTNUM,
					RTG.FLTDAT FLTDAT,
					RTG.FLTCARIDR FLTCARIDR,
					RTG.POU POU,
					RTG.POL POL
					FROM MALCSGMST CSG
					INNER JOIN MALCSGDTL MAL
					ON CSG.CMPCOD     = MAL.CMPCOD
					AND CSG.CSGDOCNUM = MAL.CSGDOCNUM
					AND CSG.POACOD    = MAL.POACOD
					AND CSG.CSGSEQNUM = MAL.CSGSEQNUM
					INNER JOIN MALMST MALMST
					ON MAL.CMPCOD     = MALMST.CMPCOD
					AND MAL.MALSEQNUM = MALMST.MALSEQNUM
					LEFT OUTER JOIN MALCSGRTG RTG
					ON CSG.CMPCOD     = RTG.CMPCOD
					AND CSG.CSGDOCNUM = RTG.CSGDOCNUM
					AND CSG.POACOD    = RTG.POACOD
					AND CSG.CSGSEQNUM = RTG.CSGSEQNUM
					WHERE CSG.CMPCOD  = ?
					AND CSG.CSGDOCNUM = ?
					AND CSG.POACOD    = ?
					ORDER BY MALMST.DSN ,
					MALMST.ORGEXGOFC ,
					MALMST.DSTEXGOFC ,
					MALMST.MALSUBCLS ,
					MALMST.MALCTG,
					MALMST.YER ,
					MALMST.RSN ,
					MALMST.MALSEQNUM,
					RTG.RTGSERNUM

			]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>85</QRY:Id>
		<QRY:Source Name="mail.operations.findmlddetails" Type="NATIVE">
			<![CDATA[
				SELECT MST.* FROM MALMLDMST MST WHERE MST.PROSTA = 'NEW' AND MST.CMPCOD = ?
				%s
			]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>86</QRY:Id>
		<QRY:Source Name="mail.operations.findcarditmails" Type="NATIVE">
			<![CDATA[
		SELECT MAX(MALMST.MALIDR) MALIDR,
  MAX(TRT.FLTNUM) FLTNUM,
  MAX(TRT.FLTDAT) DEPTIM,
  MAX(TRT.FLTCARCOD) CARCOD,
  MAX(TRT.FLTCARIDR) FLTCARIDR,
  MAX(TRT.FLTSEQNUM) FLTSEQNUM,
  MAX(TRT.POU) POU,
  MAX(TRT.POL) POL,
  MAX(MALMST.ORGEXGOFC) ORGEXGOFF,
  MAX(MALMST.DSTEXGOFC) DSTEXGOFF,
  MAX(MALMST.YER) DSPYER,
  MAX(MALMST.DSN) DSPSRLNUM,
  MAX(MALMST.RSN) RCPSRLNUM,
  MAX(MALMST.MALCTG) MALCTGCOD,
  MAX(MALMST.MALSUBCLS) MALSUBCOD,
  MAX(MALMST.REGIND) RCPRGDINS,
  MAX(MALMST.HSN) HSTRCPNUM,
  MAX(MALMST.WGT) RCPWGT,
  MAX(MALMST.DSPWGTUNT) RCPWGTUNT,
  MAX(MALMST.CMPCOD) CMPCOD,
  MAX(MALMST.SHPPFX) SHPPFX,
  MAX(MALMST.MSTDOCNUM) MSTDOCNUM,
  MAX(MALMST.ORGCOD) ORGCOD,
  MAX(MALMST.DSTCOD) DSTCOD,
  MAX(MALMST.MALSEQNUM) MALSEQNUM,
  MAX(MALMST.VOL) VOL,
  MAX(MALMST.VOLUNT) VOLUNT,
  MAX(CSGMST.CSGDOCNUM) CSGDOCNUM,
  MAX(CSGMST.CSGDAT )CSGCMPDAT,
  MAX(CSGMST.CSGDAT) CDTRCVDAT,
  MAX(MALMST.POACOD) AS SDRIDR,
  MAX(CSGDTL.ULDNUM) CONNUM,
  MAX(MALMST.MALSTA) MALSTA,
  MAX(MALMST.MALSRC) MALSRC,
  CASE
        WHEN 'MTK060' =  ?
            THEN
                (
				  SELECT
                    MAX('Y')
                    FROM
                    MALHIS
                    WHERE
                    MALSEQNUM = MALMST.MALSEQNUM
                    AND CMPCOD = MALMST.CMPCOD
                    AND MALSTA IN (
                    'ACP',
                    'ASG',
					'TRA'
                    )
                    AND SCNPRT = COALESCE(?,MALMST.ORGCOD)
                )
         ELSE
            CASE 	WHEN MALMST.MALSTA = 'NEW'   THEN 'N'
                    WHEN MALMST.MALSTA = 'BKD'   THEN 'N'
                    WHEN MALMST.MALSTA = 'CAN'   THEN 'N'
                    WHEN MALMST.MALSTA = 'OFL'   THEN 'N'
                ELSE 'Y'
            END
    END ACP,
    MAX((
        SELECT
        MAX(SCNDAT) SCNDAT
        FROM
        MALSCNDTL SCNDTL
        WHERE
        SCNDTL.CMPCOD = MALMST.CMPCOD
        AND SCNDTL.MALIDR = MALMST.MALIDR
        AND SCNDTL.SCNPRT =  COALESCE(?, MALMST.ORGCOD)
        AND (TO_NUMBER(TO_CHAR(current_date,'YYYYMMDD'))) - (TO_NUMBER(TO_CHAR(SCNDTL.SCNDAT,'YYYYMMDD'))) <= 30
        GROUP BY
        SCNPRT
    )) SCNDAT,
  MAX(MALMST.DUPNUM) DUPNUM,
  MAX(MALMST.SEQNUM) SEQNUM,
  MAX(MALMST.DOCOWRIDR) DOCOWRIDR,
  MAX(MALMST.REQDLVTIM) REQDLVTIM,
  MAX(MALMST.TRPSRVENDTIM) TRPSRVENDTIM,
  MAX(MALMST.MALSRVLVL) MALSRVLVL
      FROM MALCSGMST CSGMST
      INNER JOIN  MALCSGDTL CSGDTL
      ON CSGMST.CMPCOD     = CSGDTL.CMPCOD
      AND CSGMST.CSGDOCNUM = CSGDTL.CSGDOCNUM
      AND CSGMST.CSGSEQNUM = CSGDTL.CSGSEQNUM
      AND CSGMST.POACOD    = CSGDTL.POACOD
      INNER JOIN MALMST MALMST
      ON MALMST.CMPCOD  = CSGDTL.CMPCOD
      AND MALMST.MALSEQNUM = CSGDTL.MALSEQNUM
      AND MALMST.CSGSEQNUM = CSGDTL.CSGSEQNUM
      AND MALMST.CSGDOCNUM = CSGDTL.CSGDOCNUM
      AND MALMST.POACOD = CSGDTL.POACOD
     LEFT OUTER JOIN MALCSGRTG TRT
      ON CSGMST.CMPCOD  = TRT.CMPCOD
      AND CSGMST.CSGDOCNUM = TRT.CSGDOCNUM
      AND CSGMST.CSGSEQNUM=TRT.CSGSEQNUM
      AND CSGMST.POACOD=TRT.POACOD
			]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>87</QRY:Id>
		<QRY:Source Name="mail.operations.getcarditmailbagdetails" Type="NATIVE">
			<![CDATA[
					SELECT DISTINCT
						MST.MALIDR,
						MST.MALSEQNUM,
						MST.ORGEXGOFC,
						MST.DSTEXGOFC,
						MST.MALCTG,
						MST.MALSUBCLS,
						MST.YER,
						MST.DSN,
						MST.RSN,
						MST.HSN,
						MST.REGIND,
						MST.WGT,
						MST.ORGCOD,
						MST.DSTCOD,
						MST.SCNDAT,
						MST.MALSEQNUM,
						MST.CMPCOD
					FROM
						MALMST      MST
						INNER JOIN MALCSGMST   CSGMST ON CSGMST.CMPCOD = MST.CMPCOD
													   AND CSGMST.CSGDOCNUM = MST.CSGDOCNUM
													   AND CSGMST.CSGSEQNUM = MST.CSGSEQNUM
													   AND CSGMST.POACOD = MST.POACOD
						INNER JOIN MALCSGDTL   CSGDTL ON CSGDTL.CMPCOD = CSGMST.CMPCOD
													   AND CSGDTL.CSGDOCNUM = CSGMST.CSGDOCNUM
													   AND CSGDTL.CSGSEQNUM = CSGMST.CSGSEQNUM
													   AND CSGDTL.POACOD = CSGMST.POACOD
													   AND CSGDTL.MALSEQNUM = MST.MALSEQNUM
					WHERE
						CSGDTL.CMPCOD = ?
						AND MST.MALSTA = 'NEW'
						AND TO_NUMBER(TO_CHAR(TRUNC(CSGMST.CSGDAT), 'YYYYMMDD')) >= TO_NUMBER(TO_CHAR(TO_DATE(?), 'YYYYMMDD'))
						AND TO_NUMBER(TO_CHAR(TRUNC(CSGMST.CSGDAT), 'YYYYMMDD')) <= TO_NUMBER(TO_CHAR(TO_DATE(?), 'YYYYMMDD'))
			]]>
		</QRY:Source>
	</QRY:Definition>

	 <QRY:Definition>
	 <QRY:Id>88</QRY:Id>
		<QRY:Source Name="mail.operations.findduplicatemailbagsincardit" Type="NATIVE">
		<![CDATA[
			SELECT RCP.CDTKEY CDTKEY,RCP.CDTTYP CDTTYP FROM MALCDTRCP RCP,MALMST MST,MALPOAMST POAMST
			WHERE RCP.RCPIDR = MST.MALIDR
        AND RCP.CMPCOD   = MST.CMPCOD
        AND  POAMST.CMPCOD=MST.CMPCOD
        AND POAMST.POACOD=MST.POACOD
		AND (TO_NUMBER(TO_CHAR(current_date,'YYYYMMDD'))) - (TO_NUMBER(TO_CHAR(MST.DSPDAT,'YYYYMMDD'))) <= 30
        AND RCP.CMPCOD=? AND RCP.RCPIDR=?
		]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>89</QRY:Id>
		<QRY:Source Name="mail.operations.checktransportexistsforcardit" Type="OBJECT">
			<![CDATA[
				SELECT CDTKEY FROM MALCDTTRT WHERE  CMPCOD = ?   AND
				CDTKEY = ?    AND
				CARCOD = ?
			]]>
		</QRY:Source>
	</QRY:Definition>




<QRY:Definition>
<QRY:Id>90</QRY:Id>
<QRY:Source Name="mail.operations.findmailsequencenumberfrommailidr" Type="NATIVE">
	<![CDATA[

			SELECT MALSEQNUM,
			ORGCOD, DSTCOD
		   FROM MALMST MST
INNER JOIN MALPOAMST POAMST
ON MST.CMPCOD  =POAMST.CMPCOD
AND MST.POACOD =POAMST.POACOD
WHERE MST.CMPCOD =?
		 AND MST.MALIDR=?
--AND ( to_Number(to_char(now()-MST.DSPDAT)) <= POAMST.DUPMALPRD
AND (TO_NUMBER(TO_CHAR(current_date,'YYYYMMDD'))-TO_NUMBER(TO_CHAR(MST.DSPDAT,'YYYYMMDD')) <= POAMST.DUPMALPRD
OR POAMST.DUPMALPRD = 0 )

]]>
</QRY:Source>
</QRY:Definition>



	<QRY:Definition>
	<QRY:Id>91</QRY:Id>
	<QRY:Source Name="mail.operations.findmailtype" Type="NATIVE">
		<![CDATA[
			SELECT MALMST.MALTYP
				FROM MALMST
				WHERE MALMST.CMPCOD  = ?
				AND MALMST.MALSEQNUM = ?
	]]>	</QRY:Source>
	</QRY:Definition>


		<QRY:Definition>
	<QRY:Id>92</QRY:Id>
		<QRY:Source Name="mail.operations.findlocalpas" Type="NATIVE">
			<![CDATA[
				SELECT CMPCOD, POACOD, POANAM, POAADR, CNTCOD
				FROM MALPOAMST
				WHERE CMPCOD = ?
				AND  CNTCOD = ?
		]]>
		</QRY:Source>
	</QRY:Definition>


	  <QRY:Definition>
	<QRY:Id>93</QRY:Id>
	<QRY:Source Name="mail.operations.findContainerDetailsForMRD" Type="NATIVE">
		<![CDATA[

			SELECT MST.CMPCOD,
			  MST.CONNUM,
			  MST.ASGPRT,
			  MST.POU,
			  MST.CONTYP
			FROM MALFLTCON MST
			INNER JOIN MALMST MALMST
			ON MST.CMPCOD     = MALMST.CMPCOD
			AND MST.FLTNUM    = MALMST.FLTNUM
			AND MST.FLTCARIDR = MALMST.FLTCARIDR
			AND MST.FLTSEQNUM = MALMST.FLTSEQNUM
			AND MST.CONNUM    = MALMST.CONNUM
			WHERE MST.CMPCOD  = ?
			AND MST.FLTNUM    = ?
			AND MST.FLTCARCOD = ?
			AND MST.FLTSEQNUM = ?
			AND MALMST.POU    = ?
			AND MALMST.MALIDR = ?
			]]>
	</QRY:Source>
  </QRY:Definition>


  <QRY:Definition>
<QRY:Id>94</QRY:Id>
<QRY:Source Name="mail.operations.findvalidmailbagsforupliftedresdit" Type="NATIVE">
	<![CDATA[

           SELECT MALIDR FROM MALRDT
                     WHERE
                     CMPCOD = ?

]]>
</QRY:Source>
</QRY:Definition>

	<QRY:Definition>
		<QRY:Id>95</QRY:Id>
		<QRY:Source Name="mail.operations.validatemailbagforupl" Type="NATIVE">
			<![CDATA[
				SELECT MALIDR
				FROM MALMST
				WHERE CMPCOD =?
				AND FLTCARIDR=?
				AND FLTSEQNUM=?
				AND FLTNUM   =?
			]]>
		</QRY:Source>
	</QRY:Definition>




		<QRY:Definition>
	<QRY:Id>96</QRY:Id>
		<QRY:Source Name="mail.operations.findinventorymailbagsforreassigninuldwithflight" Type="NATIVE">
			<![CDATA[
			SELECT DISTINCT MALMST.CMPCOD,
			  MALMST.MALIDR,
			  MALMST.ORGEXGOFC,
			  MALMST.DSTEXGOFC,
			  MALMST.YER,
			  MALMST.DSN,
			  MALMST.MALCLS,
			  MALMST.MALCTG MALCTGCOD,
			  MALMST.MALSUBCLS,
			  MALMST.SCNPRT,
			  MALMST.SCNDAT,
			  MALMST.CONNUM,
			  MALMST.SCNUSR,
			  MALMST.MALSTA,
			  MALMST.OPRSTA,
			  MALMST.CONTYP,
			  MALMST.POU,
			  MALMST.WGT,
			  MALMST.CSGDOCNUM,
			  MALMST.CSGSEQNUM,
			  MALMST.POACOD,
			  MALMST.DMGFLG,
			  MALMST.FLTCARIDR,
			  MALMST.FLTSEQNUM,
			  MALMST.FLTNUM,
			  MALMST.SEGSERNUM,
			  ARPULD.FLTCARCOD,
			  MALHIS.FLTNUM INBFLTNUM ,
			  MALHIS.FLTSEQNUM INBFLTSEQNUM ,
			  MALHIS.SEGSERNUM INBSEGSERNUM ,
			  MALHIS.FLTDAT INBFLTDAT ,
			  MALHIS.CONTYP INBCONTYP ,
			  MALHIS.CONNUM INBCONNUM
			FROM MALMST MALMST
			INNER JOIN MALARPULD ARPULD
			ON MALMST.CMPCOD    = ARPULD.CMPCOD
			AND MALMST.FLTCARIDR=ARPULD.FLTCARIDR
			AND MALMST.SCNPRT   =ARPULD.ARPCOD
			AND MALMST.CONNUM   = ARPULD.ULDNUM
			LEFT OUTER JOIN MALEXGOFCMST EXGOFC
			ON MALMST.CMPCOD     = EXGOFC.CMPCOD
			AND MALMST.ORGEXGOFC =EXGOFC.EXGOFCCOD
			LEFT OUTER JOIN MALPOAMST ORGPA
			ON EXGOFC.CMPCOD  = ORGPA.CMPCOD
			AND EXGOFC.POACOD = ORGPA.POACOD
			INNER JOIN MALHIS MALHIS
			ON MALMST.CMPCOD     =MALHIS.CMPCOD
			AND MALMST.MALSEQNUM =MALHIS.MALSEQNUM
			AND MALMST.SCNPRT    = MALHIS.SCNPRT

					]]>
		</QRY:Source>
	</QRY:Definition>



	<QRY:Definition>
	<QRY:Id>97</QRY:Id>
		<QRY:Source Name="mail.operations.findinventorymailbagsforreassigninuld" Type="NATIVE">
			<![CDATA[
			 SELECT DISTINCT MALMST.CMPCOD,
			  MALMST.MALIDR,
			  MALMST.ORGEXGOFC,
			  MALMST.DSTEXGOFC,
			  MALMST.YER,
			  MALMST.DSN,
			  MALMST.MALCLS,
			  MALMST.MALCTG MALCTGCOD,
			  MALMST.MALSUBCLS,
			  MALMST.SCNPRT,
			  MALMST.SCNDAT,
			  MALMST.CONNUM,
			  MALMST.SCNUSR,
			  MALMST.MALSTA,
			  MALMST.OPRSTA,
			  MALMST.CONTYP,
			  MALMST.POU,
			  MALMST.WGT,
			  MALMST.CSGDOCNUM,
			  MALMST.CSGSEQNUM,
			  MALMST.POACOD,
			  MALMST.DMGFLG,
			  MALMST.FLTCARIDR,
			  MALMST.FLTSEQNUM,
			  MALMST.FLTNUM,
			  MALMST.SEGSERNUM,
			  ARPULD.FLTCARCOD
			FROM MALMST MALMST
			INNER JOIN MALARPULD ARPULD
			ON MALMST.CMPCOD    = ARPULD.CMPCOD
			AND MALMST.FLTCARIDR=ARPULD.FLTCARIDR
			AND MALMST.SCNPRT   =ARPULD.ARPCOD
			AND MALMST.CONNUM   = ARPULD.ULDNUM
			LEFT OUTER JOIN MALEXGOFCMST EXGOFC
			ON MALMST.CMPCOD     = EXGOFC.CMPCOD
			AND MALMST.ORGEXGOFC =EXGOFC.EXGOFCCOD
			LEFT OUTER JOIN MALPOAMST ORGPA
			ON EXGOFC.CMPCOD  = ORGPA.CMPCOD
			AND EXGOFC.POACOD = ORGPA.POACOD
					]]>
		</QRY:Source>
	</QRY:Definition>


		<QRY:Definition>
	<QRY:Id>98</QRY:Id>
		<QRY:Source Name="mail.operations.findinventorymailbagsforreassigninbulkwithflight" Type="NATIVE">
			<![CDATA[

				SELECT DISTINCT MALMST.CMPCOD,
			  MALMST.MALIDR,
			  MALMST.ORGEXGOFC,
			  MALMST.DSTEXGOFC,
			  MALMST.YER,
			  MALMST.DSN,
			  MALMST.MALCLS,
			  MALMST.MALCTG MALCTGCOD,
			  MALMST.MALSUBCLS,
			  MALMST.SCNPRT,
			  MALMST.SCNDAT,
			  MALMST.CONNUM,
			  MALMST.SCNUSR,
			  MALMST.MALSTA,
			  MALMST.OPRSTA,
			  MALMST.CONTYP,
			  MALMST.POU,
			  MALMST.WGT,
			  MALMST.CSGDOCNUM,
			  MALMST.CSGSEQNUM,
			  MALMST.POACOD,
			  MALMST.DMGFLG,
			  MALMST.FLTCARIDR,
			  MALMST.FLTSEQNUM,
			  MALMST.FLTNUM,
			  MALMST.SEGSERNUM,
			  ARPULD.FLTCARCOD,
			  MALHIS.FLTNUM INBFLTNUM ,
			  MALHIS.FLTSEQNUM INBFLTSEQNUM ,
			  MALHIS.SEGSERNUM INBSEGSERNUM ,
			  MALHIS.FLTDAT INBFLTDAT ,
			  MALHIS.CONTYP INBCONTYP ,
			  MALHIS.CONNUM INBCONNUM
			FROM MALARPULD ARPULD
			INNER JOIN MALMST MALMST
			ON ARPULD.FLTCARIDR =MALMST.FLTCARIDR
			AND ARPULD.ARPCOD   =MALMST.SCNPRT
			AND ARPULD. ULDNUM  =MALMST. CONNUM
			AND ARPULD.CMPCOD   =MALMST.CMPCOD
			LEFT OUTER JOIN MALEXGOFCMST EXGOFC
			ON MALMST.CMPCOD     = EXGOFC.CMPCOD
			AND MALMST.ORGEXGOFC =EXGOFC.EXGOFCCOD
			LEFT OUTER JOIN MALPOAMST ORGPA
			ON EXGOFC.CMPCOD  = ORGPA.CMPCOD
			AND EXGOFC.POACOD = ORGPA.POACOD
			INNER JOIN MALHIS MALHIS
			ON MALMST.CMPCOD     =MALHIS.CMPCOD
			AND MALMST.MALSEQNUM =MALHIS.MALSEQNUM
			AND MALMST.SCNPRT    = MALHIS.SCNPRT

			]]>
		</QRY:Source>
	</QRY:Definition>



		<QRY:Definition>
	<QRY:Id>99</QRY:Id>
		<QRY:Source Name="mail.operations.findinventorymailbagsforreassigninbulk" Type="NATIVE">
			<![CDATA[
			SELECT DISTINCT MALMST.CMPCOD,
		  MALMST.MALIDR,
		  MALMST.ORGEXGOFC,
		  MALMST.DSTEXGOFC,
		  MALMST.YER,
		  MALMST.DSN,
		  MALMST.MALCLS,
		  MALMST.MALCTG MALCTGCOD,
		  MALMST.MALSUBCLS,
		  MALMST.SCNPRT,
		  MALMST.SCNDAT,
		  MALMST.CONNUM,
		  MALMST.SCNUSR,
		  MALMST.MALSTA,
		  MALMST.OPRSTA,
		  MALMST.CONTYP,
		  MALMST.POU,
		  MALMST.WGT,
		  MALMST.CSGDOCNUM,
		  MALMST.CSGSEQNUM,
		  MALMST.POACOD,
		  MALMST.DMGFLG,
		  MALMST.FLTCARIDR,
		  MALMST.FLTSEQNUM,
		  MALMST.FLTNUM,
		  MALMST.SEGSERNUM,
		  ARPULD.FLTCARCOD
		FROM MALARPULD ARPULD
		INNER JOIN MALMST MALMST
		ON ARPULD.FLTCARIDR =MALMST.FLTCARIDR
		AND ARPULD.ARPCOD   =MALMST.SCNPRT
		AND ARPULD. ULDNUM  =MALMST. CONNUM
		AND ARPULD.CMPCOD   =MALMST.CMPCOD
		LEFT OUTER JOIN MALEXGOFCMST EXGOFC
		ON MALMST.CMPCOD     = EXGOFC.CMPCOD
		AND MALMST.ORGEXGOFC =EXGOFC.EXGOFCCOD
		LEFT OUTER JOIN MALPOAMST ORGPA
		ON EXGOFC.CMPCOD  = ORGPA.CMPCOD
		AND EXGOFC.POACOD = ORGPA.POACOD

			]]>
		</QRY:Source>
	</QRY:Definition>



	<QRY:Definition>
	<QRY:Id>100</QRY:Id>
	<QRY:Source Name="mail.operations.findarrivedmailbagdetailsininventory" Type="NATIVE">
			<![CDATA[
						SELECT HIS.CMPCOD,
			  MALMST.MALIDR,
			  HIS.FLTCARIDR,
			  HIS.FLTNUM,
			  HIS.FLTSEQNUM,
			  HIS.SEGSERNUM,
			  HIS.SCNPRT,
			  HIS.CONNUM,
			  HIS.CONTYP,
			  MALMST.MALSTA,
			  MALMST.DSN,
			  MALMST.ORGEXGOFC,
			  MALMST.DSTEXGOFC,
			  MALMST.MALCLS,
			  MALMST.YER,
			  HIS.SCNUSR,
			  HIS.FLTDAT,
			  HIS.FLTCARCOD,
			  HIS.POU,
			  HIS.UTCSCNDAT,
			  MALMST.MALSUBCLS,
			  MALMST.MALCTG
			FROM MALHIS HIS
			INNER JOIN MALMST MALMST
			ON HIS.CMPCOD     = MALMST.CMPCOD
			AND HIS.MALSEQNUM = MALMST.MALSEQNUM
			LEFT OUTER JOIN MALEXGOFCMST EXGOFC
			ON HIS.CMPCOD     = EXGOFC.CMPCOD
			AND HIS.ORGEXGOFC = EXGOFC.EXGOFCCOD
			LEFT OUTER JOIN MALPOAMST ORGPA
			ON EXGOFC.CMPCOD  = ORGPA.CMPCOD
			AND EXGOFC.POACOD = ORGPA.POACOD
			LEFT OUTER JOIN MALEXGOFCMST DSTEXG
			ON DSTEXG.CMPCOD     = HIS.CMPCOD
			AND DSTEXG.EXGOFCCOD = HIS.DSTEXGOFC
			WHERE HIS.CMPCOD     = ?
			AND HIS.SCNPRT       = ?
			AND MALMST.MALSTA    = ?
			AND DSTEXG.CTYCOD    = ?
			AND MALMST.FLTCARIDR = ?
			AND MALMST.CONNUM    = ?
			AND MALMST.CONTYP    = ?


		]]>
	</QRY:Source>
	</QRY:Definition>


	<QRY:Definition>
<QRY:Id>101</QRY:Id>
<QRY:Source Name="mail.operations.findflightlegsernumforcontainer" Type="NATIVE">
	<![CDATA[
	SELECT CON.LEGSERNUM
	  FROM MALFLTCON CON
	 WHERE CON.CMPCOD = ?
	   AND CON.FLTCARIDR = ?
	   AND CON.FLTNUM = ?
	   AND CON.FLTSEQNUM = ?
	   AND CON.ASGPRT = ?
	   AND CON.CONNUM = ?

]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>102</QRY:Id>
<QRY:Source Name="mail.operations.checkresditExists" Type="NATIVE">
	<![CDATA[
				SELECT MAX (MMR.SEQNUM) SEQNUM
				  FROM MALRDT MMR
				 WHERE MMR.CMPCOD = ?
 					AND  MMR.MALSEQNUM = ?




	]]>
</QRY:Source>
</QRY:Definition>

	<QRY:Definition>
		<QRY:Id>103</QRY:Id>
			<QRY:Source Name="mail.operations.findDeliveryBill" Type="NATIVE">
			<![CDATA[

				SELECT  DISTINCT ORGOFC.EXGCODDES ORGDSC ,DSTOFC.EXGCODDES DSTDSC, TO_CHAR(ULDSEG.SCNDAT,'dd-MON-yyyy' )SCNDAT,
				ULDSEG.ORGEXGOFC ORGEXGOFC, ULDSEG.DSTEXGOFC DSTEXGOFC,ULDSEG.MALCTGCOD,ULDSEG.MALSUBCLS,ULDSEG.YER
				,ULDSEG.DSN, ULDSEG.WGT,CTY1.CTYNAM ORGCTY,CTY2.CTYNAM DSTCTY,CTY1.SRVARPCOD ARPCODE,
				RTG.ONWCARCOD,RTG.ONWFLTNUM,TO_CHAR (RTG.ONWFLTDAT, 'dd-MON-yyyy') ONWFLTDAT,
				ULDSEG.SCNPRT ScannedPorts,MALIDR,ULDNUM,FLTSEG.POU
				FROM   MALFLTSEG FLTSEG

						  INNER JOIN MALULDSEG ULDSEG  ON
							FLTSEG.CMPCOD = ULDSEG.CMPCOD
						  AND   FLTSEG.FLTCARIDR = ULDSEG.FLTCARIDR
						  AND   FLTSEG.FLTNUM = ULDSEG.FLTNUM
						  AND   FLTSEG.FLTSEQNUM = ULDSEG.FLTSEQNUM
						  AND   FLTSEG.SEGSERNUM = ULDSEG.SEGSERNUM
						   INNER JOIN MALEXGOFCMST ORGOFC
						  ON    ULDSEG.CMPCOD = ORGOFC.CMPCOD
						  AND   ULDSEG.ORGEXGOFC = ORGOFC.EXGOFCCOD
						  INNER JOIN MALEXGOFCMST DSTOFC
						  ON   ULDSEG.CMPCOD = DSTOFC.CMPCOD
						  AND   ULDSEG.DSTEXGOFC = DSTOFC.EXGOFCCOD
						  INNER JOIN  SHRCTYMST CTY1
						  ON  ULDSEG.CMPCOD = CTY1.CMPCOD
						  AND CTY1.CTYCOD = (SELECT CTYCOD
							FROM MALEXGOFCMST
							WHERE CMPCOD = ULDSEG.CMPCOD
							AND EXGOFCCOD = ULDSEG.ORGEXGOFC)
						  INNER JOIN  SHRCTYMST CTY2
						  ON ULDSEG.CMPCOD = CTY2.CMPCOD
						     AND CTY2.CTYCOD = (SELECT CTYCOD
							FROM MALEXGOFCMST
							WHERE CMPCOD = ULDSEG.CMPCOD
							AND EXGOFCCOD = ULDSEG.DSTEXGOFC)
						  LEFT OUTER JOIN MALONWRTGSEG  RTG
						    ON    ULDSEG.CMPCOD = RTG.CMPCOD
						  AND   ULDSEG.FLTCARIDR = RTG.FLTCARIDR
						  AND   ULDSEG.FLTNUM = RTG.FLTNUM
						  AND   ULDSEG.FLTSEQNUM = RTG.FLTSEQNUM
						  AND   ULDSEG.SEGSERNUM = RTG.SEGSERNUM
						  AND   ULDSEG.ULDNUM = RTG.ULDNUM

					]]>
			</QRY:Source>
	</QRY:Definition>



	  	  <QRY:Definition>
 <QRY:Id>104</QRY:Id>
  	<QRY:Source Name="mail.operations.findconsignmentdetailsfordsn" Type="NATIVE">
			<![CDATA[
			SELECT MAL.CMPCOD,
  MAL.CSGDOCNUM,
			  MAL.POACOD,
			  MAL.CSGSEQNUM,
			  MALMST.MALIDR
			FROM MALCSGMST MST
			INNER JOIN MALCSGDTL MAL
			ON MAL.CMPCOD     = MST.CMPCOD
			AND MAL.CSGDOCNUM = MST.CSGDOCNUM
			AND MAL.CSGSEQNUM = MST.CSGSEQNUM
			AND MAL.POACOD    = MST.POACOD
			INNER JOIN MALMST MALMST
			ON MALMST.CMPCOD     =MAL.CMPCOD
			AND MALMST.MALSEQNUM =MAL.MALSEQNUM
			WHERE MAL.CMPCOD     = ?
			AND MAL.CSGSEQNUM    = ?
			AND MAL.POACOD       = ?
			AND MALMST.DSN       = ?
			AND MALMST.ORGEXGOFC = ?
			AND MALMST.DSTEXGOFC = ?
			AND MALMST.MALCTG = ?
			AND MALMST.MALSUBCLS = ?
			AND MALMST.YER       = ?
			]]>
	</QRY:Source>
  </QRY:Definition>

	<QRY:Definition>
	<QRY:Id>105</QRY:Id>
		<QRY:Source Name="mail.operations.validateMailFlight" Type="NATIVE">
			<![CDATA[
				SELECT DISTINCT FLT.FLTNUM,FLT.FLTDAT,FLT.LEGSERNUM,FLT.FLTCARIDR,FLT.FLTCARCOD,FLT.FLTSEQNUM,FLT.CMPCOD,FLT.ARPCOD
				FROM MALFLT FLT, MALFLTSEG FLTSEG
				WHERE FLT.FLTCARIDR  =FLTSEG.FLTCARIDR
				AND FLT.FLTNUM    =FLTSEG.FLTNUM
				AND FLT.FLTSEQNUM =FLTSEG.FLTSEQNUM
				AND FLT.CMPCOD    =FLTSEG.CMPCOD
				AND FLT.ARPCOD = FLTSEG.POL
				AND FLT.CMPCOD       = ?
				AND FLT.FLTCARIDR    = ?
				AND FLT.FLTNUM       = ?
				AND FLT.FLTDAT = ?
				AND FLT.ARPCOD = ?
			]]>
		</QRY:Source>
	</QRY:Definition>


	<QRY:Definition>
	<QRY:Id>106</QRY:Id>
		<QRY:Source Name="mail.operations.findcarrieracceptancedetailsinuld" Type="OBJECT">
			<![CDATA[
 			     (
				 SELECT MST.CMPCOD CMPCOD,
				  MST.CONNUM CONNUM,
				  MST.FLTCARIDR FLTCARIDR,
				  MST.FLTNUM FLTNUM,
				  MST.ASGPRT ASGPRT,
				  MST.FLTSEQNUM FLTSEQNUM,
				  MST.LEGSERNUM LEGSERNUM,
				  MST.SEGSERNUM SEGSERNUM,
				  MST.DSTCOD DSTCOD,
				  MST.POAFLG POAFLG,
				  MST.ACPFLG ACPFLG,
				  MST.OFLFLG OFLFLG,
				  MST.FLTCARCOD FLTCARCOD,
				  MST.CONTYP,
				  MST.LSTUPDTIM CONLSTUPDTIM,
				  MST.CONJRNIDR,
				  MST.POACOD,
				  MST.TRNFLG,
				  MST.CNTIDR,
				  ULD.ACPBAG ULDBAGCNT,
				  ULD.ACPWGT ULDBAGWGT,
				  MST.RMK RMK,
				  ULD.WHSCOD WHSCOD,
				  ULD.LOCCOD LOCCOD,
				  ULD.FRMCARCOD FRMCARCOD,
				  ULD.LSTUPDTIM ULDLSTUPDTIM,
				  MALMST.DSN DSN,
				  MALMST.MALCLS MALCLS,
				  MALMST.MALSUBCLS MALSUBCLS,
				  MALMST.MALCTG MALCTGCOD,
				  MALMST.ORGEXGOFC ORGEXGOFC,
				  MALMST.DSTEXGOFC DSTEXGOFC,
				  MALMST.YER YER,
				  MALMST.MALSEQNUM MALSEQNUM,
				  ARPULD.STDBAG DSNSTDBAG,
				  ARPULD.ACPBAG DSNACPBAG,
				  ARPULD.STDWGT DSNSTDWGT,
				  ARPULD.ACPWGT DSNACPWGT,
				(
				CASE
				WHEN MALMST.MALTYP = 'M'
				THEN 'Y'
				ELSE 'N'
				END) AS PLTENBFLG
				FROM MALFLTCON MST
				INNER JOIN MALARPULD ULD
				ON MST.CMPCOD     = ULD.CMPCOD
				AND MST.ASGPRT    = ULD.ARPCOD
				AND MST.FLTCARIDR = ULD.FLTCARIDR
				AND MST.CONNUM    = ULD.ULDNUM
				LEFT OUTER JOIN MALARPULDDTL ARPULD
				ON ULD.CMPCOD = ARPULD.CMPCOD
				AND ULD.ULDNUM = ARPULD.ULDNUM
				AND ULD.ARPCOD = ARPULD.ARPCOD
				AND ULD.FLTCARIDR = ARPULD.FLTCARIDR
				INNER JOIN MALMST MALMST
				ON ARPULD.CMPCOD     = MALMST.CMPCOD
				AND ARPULD.MALSEQNUM    = MALMST.MALSEQNUM
				AND ARPULD.CONNUM    = MALMST.CONNUM
				WHERE MST.CMPCOD  =?
				AND MST.FLTCARIDR = ?
				AND MST.ASGPRT    = ?
				AND MST.CONTYP    = 'U'
				AND MST.TXNCOD    = 'ASG'
				AND MST.FLTSEQNUM = '-1'
			]]>
		</QRY:Source>
	</QRY:Definition>

		<QRY:Definition>
	<QRY:Id>107</QRY:Id>
	<QRY:Source Name="mail.operations.findflightacceptancedetails" Type="OBJECT">
			<![CDATA[
					(SELECT CON.CMPCOD CMPCOD,
					CON.FLTCARIDR FLTCARIDR,
					CON.FLTNUM FLTNUM,
					CON.FLTSEQNUM FLTSEQNUM,
					CON.LEGSERNUM LEGSERNUM,
					CON.SEGSERNUM SEGSERNUM,
					CON.CONNUM CONNUM,
					CON.POU POU,
					CON.CNTIDR CNTIDR,
					CON.ASGPRT ASGPRT,
					CON.DSTCOD DSTCOD,
					CON.POAFLG POAFLG,
					CON.ACPFLG ACPFLG,
					CON.ARRSTA ARRSTA,
					CON.OFLFLG OFLFLG,
					CON.TRNFLG,
					CON.CONTYP,
					CON.LSTUPDTIM AS CONLSTUPDTIM,
					CON.CONJRNIDR,
					CON.POACOD,
					(
					CASE
					WHEN CON.CONTYP = 'B'
					THEN 0
					ELSE RTG.RTGSERNUM
					END) AS RTGSERNUM,
					(
					CASE
					WHEN CON.CONTYP = 'B'
					THEN ''
					ELSE TO_CHAR (RTG.ONWFLTDAT, 'DD-MON-YYYY' )
					END) AS ONWFLTDAT,
					(
					CASE
					WHEN CON.CONTYP = 'B'
					THEN ''
					ELSE RTG.ONWFLTNUM
					END) AS ONWFLTNUM,
					(
					CASE
					WHEN CON.CONTYP = 'B'
					THEN ''
					ELSE RTG.ONWFLTCARCOD
					END) AS ONWFLTCARCOD,
					(
					CASE
					WHEN CON.CONTYP = 'B'
					THEN ''
					ELSE RTG.POU
					END) AS RTGPOU,
					(
					CASE
					WHEN CON.CONTYP = 'B'
					THEN 0
					ELSE RTG.ONWFLTCARIDR
					END) ONWFLTCARIDR,
					(
					CASE
					WHEN CON.CONTYP = 'B'
					THEN 0
					ELSE ULD.BAGCNT
					END) AS ULDBAGCNT,
					(
					CASE
					WHEN CON.CONTYP = 'B'
					THEN 0
					ELSE ULD.BAGWGT
					END) AS ULDBAGWGT,
					ULD.WHSCOD WHSCOD,
					ULD.LOCCOD LOCCOD,
					CON.RMK RMK,
					ULD.FRMCARCOD ULDFRMCARCOD,
					ULD.LSTUPDTIM AS ULDLSTUPDTIM,
					MALMST.DSN DSN,
					MALMST.ORGEXGOFC ORGEXGOFC,
					MALMST.DSTEXGOFC DSTEXGOFC,
					MALMST.MALCLS MALCLS,
					MALMST.MALSUBCLS MALSUBCLS,
					MALMST.MALCTG MALCTGCOD,
					MALMST.YER YER,
					MALMST.MALSEQNUM MALSEQNUM,
					MAL.ACPBAG DSNACPBAG,
					MAL.ACPWGT DSNACPWGT,
					(
					CASE
					WHEN MALMST.MALTYP = 'M'
					THEN 'Y'
					ELSE 'N'
					END) AS PLTENBFLG,
					MAL.STDBAG DSNSTDBAG,
					MAL.STDWGT DSNSTDWGT,
				  --MAL.UBRNUM,
					'' MALRAT,
					'' CURCOD
					--,
					--BKGMST.LSTUPDTIM BKGLSTUPDTIM,
					--FLTDTL.LSTUPDTIM BKGFLTUPDTIM
					FROM MALFLTCON CON
					LEFT OUTER JOIN MALFLTCONRTG RTG
					ON CON.CMPCOD     = RTG.CMPCOD
					AND CON.ASGPRT    = RTG.ASGPRT
					AND CON.CONNUM    = RTG.CONNUM
					AND CON.FLTCARIDR = RTG.FLTCARIDR
					AND CON.FLTNUM    = RTG.FLTNUM
					AND CON.FLTSEQNUM = RTG.FLTSEQNUM
					AND CON.LEGSERNUM = RTG.LEGSERNUM
					LEFT OUTER  JOIN MALULDSEG ULD
					ON CON.CMPCOD     = ULD.CMPCOD
					AND CON.FLTCARIDR = ULD.FLTCARIDR
					AND CON.FLTNUM    = ULD.FLTNUM
					AND CON.FLTSEQNUM = ULD.FLTSEQNUM
					AND CON.SEGSERNUM = ULD.SEGSERNUM
					AND CON.CONNUM    = ULD.ULDNUM
					LEFT OUTER JOIN MALULDSEGDTL MAL
					ON ULD.CMPCOD     = MAL.CMPCOD
					AND ULD.FLTCARIDR = MAL.FLTCARIDR
					AND ULD.FLTNUM    = MAL.FLTNUM
					AND ULD.FLTSEQNUM = MAL.FLTSEQNUM
					AND ULD.SEGSERNUM = MAL.SEGSERNUM
					AND ULD.ULDNUM    = MAL.ULDNUM
					--LEFT OUTER JOIN CAPBKGMST BKGMST
					--ON BKGMST.CMPCOD  = MAL.CMPCOD
				  --AND BKGMST.UBRNUM = MAL.UBRNUM
					--LEFT OUTER JOIN CAPBKGFLTDTL FLTDTL
					--ON FLTDTL.CMPCOD  = BKGMST.CMPCOD
					--AND FLTDTL.UBRNUM = BKGMST.UBRNUM
					LEFT OUTER  JOIN MALMST MALMST
					ON MALMST.CMPCOD     = MAL.CMPCOD
					AND MALMST.MALSEQNUM = MAL.MALSEQNUM
					WHERE CON.CMPCOD     =?
					AND CON.FLTCARIDR    =?
					AND CON.FLTNUM       = ?
					AND CON.FLTSEQNUM    =?
					AND CON.ASGPRT       =?
					AND CON.CONTYP       ='U'
					)
					UNION
					(SELECT CON.CMPCOD CMPCOD,
					CON.FLTCARIDR FLTCARIDR,
					CON.FLTNUM FLTNUM,
					CON.FLTSEQNUM FLTSEQNUM,
					CON.LEGSERNUM LEGSERNUM,
					CON.SEGSERNUM SEGSERNUM,
					CON.CONNUM CONNUM,
					CON.POU POU,
					CON.CNTIDR CNTIDR,
					CON.ASGPRT ASGPRT,
					CON.DSTCOD DSTCOD,
					CON.POAFLG POAFLG,
					CON.ACPFLG ACPFLG,
					CON.ARRSTA ARRSTA,
					CON.OFLFLG OFLFLG,
					CON.TRNFLG,
					CON.CONTYP,
					CON.LSTUPDTIM AS CONLSTUPDTIM,
					CON.CONJRNIDR,
					CON.POACOD,
					(
					CASE
					WHEN CON.CONTYP = 'B'
					THEN 0
					ELSE RTG.RTGSERNUM
					END) AS RTGSERNUM,
					(
					CASE
					WHEN CON.CONTYP = 'B'
					THEN ''
					ELSE TO_CHAR (RTG.ONWFLTDAT, 'DD-MON-YYYY' )
					END) AS ONWFLTDAT,
					(
					CASE
					WHEN CON.CONTYP = 'B'
					THEN ''
					ELSE RTG.ONWFLTNUM
					END) AS ONWFLTNUM,
					(
					CASE
					WHEN CON.CONTYP = 'B'
					THEN ''
					ELSE RTG.ONWFLTCARCOD
					END) AS ONWFLTCARCOD,
					(
					CASE
					WHEN CON.CONTYP = 'B'
					THEN ''
					ELSE RTG.POU
					END) AS RTGPOU,
					(
					CASE
					WHEN CON.CONTYP = 'B'
					THEN 0
					ELSE RTG.ONWFLTCARIDR
					END) ONWFLTCARIDR,
					(
					CASE
					WHEN CON.CONTYP = 'B'
					THEN 0
					ELSE ULD.BAGCNT
					END) AS ULDBAGCNT,
					(
					CASE
					WHEN CON.CONTYP = 'B'
					THEN 0
					ELSE ULD.BAGWGT
					END) AS ULDBAGWGT,
					ULD.WHSCOD WHSCOD,
					ULD.LOCCOD LOCCOD,
					CON.RMK RMK,
					ULD.FRMCARCOD ULDFRMCARCOD,
					ULD.LSTUPDTIM AS ULDLSTUPDTIM,
					MALMST.DSN DSN,
					MALMST.ORGEXGOFC ORGEXGOFC,
					MALMST.DSTEXGOFC DSTEXGOFC,
					MALMST.MALCLS MALCLS,
					MALMST.MALSUBCLS MALSUBCLS,
					MALMST.MALCTG MALCTGCOD,
					MALMST.YER YER,
					MALMST.MALSEQNUM MALSEQNUM,
					MAL.ACPBAG DSNACPBAG,
					MAL.ACPWGT DSNACPWGT,
					(
					CASE
					WHEN MALMST.MALTYP = 'M'
					THEN 'Y'
					ELSE 'N'
					END) AS PLTENBFLG,
					MAL.STDBAG DSNSTDBAG,
					MAL.STDWGT DSNSTDWGT,
				  --MAL.UBRNUM,
					'' MALRAT,
					'' CURCOD
					--,
					--BKGMST.LSTUPDTIM BKGLSTUPDTIM,
					--FLTDTL.LSTUPDTIM BKGFLTUPDTIM
					FROM MALFLTCON CON
					LEFT OUTER JOIN MALFLTCONRTG RTG
					ON CON.CMPCOD     = RTG.CMPCOD
					AND CON.ASGPRT    = RTG.ASGPRT
					AND CON.CONNUM    = RTG.CONNUM
					AND CON.FLTCARIDR = RTG.FLTCARIDR
					AND CON.FLTNUM    = RTG.FLTNUM
					AND CON.FLTSEQNUM = RTG.FLTSEQNUM
					AND CON.LEGSERNUM = RTG.LEGSERNUM
					LEFT OUTER  JOIN MALULDSEG ULD
					ON CON.CMPCOD     = ULD.CMPCOD
					AND CON.FLTCARIDR = ULD.FLTCARIDR
					AND CON.FLTNUM    = ULD.FLTNUM
					AND CON.FLTSEQNUM = ULD.FLTSEQNUM
					AND CON.SEGSERNUM = ULD.SEGSERNUM
					LEFT OUTER JOIN MALULDSEGDTL MAL
					ON ULD.CMPCOD     = MAL.CMPCOD
					AND ULD.FLTCARIDR = MAL.FLTCARIDR
					AND ULD.FLTNUM    = MAL.FLTNUM
					AND ULD.FLTSEQNUM = MAL.FLTSEQNUM
					AND ULD.SEGSERNUM = MAL.SEGSERNUM
					AND ULD.ULDNUM    = MAL.ULDNUM
					AND CON.CONNUM    = MAL.CONNUM
					--LEFT OUTER JOIN CAPBKGMST BKGMST
					--ON BKGMST.CMPCOD  = MAL.CMPCOD
				  --AND BKGMST.UBRNUM = MAL.UBRNUM
					--LEFT OUTER JOIN CAPBKGFLTDTL FLTDTL
					--ON FLTDTL.CMPCOD  = BKGMST.CMPCOD
					--AND FLTDTL.UBRNUM = BKGMST.UBRNUM
					LEFT OUTER  JOIN MALMST MALMST
					ON MALMST.CMPCOD     = MAL.CMPCOD
					AND MALMST.MALSEQNUM = MAL.MALSEQNUM
					WHERE CON.CMPCOD     =?
					AND CON.FLTCARIDR    =?
					AND CON.FLTNUM       = ?
					AND CON.FLTSEQNUM    =?
					AND CON.ASGPRT       =?
					AND CON.CONTYP       ='B'
					)
					ORDER BY CONNUM,
					DSN,
					ORGEXGOFC,
					DSTEXGOFC,
					MALCLS,
					MALSUBCLS,
					MALCTGCOD,
					YER
			]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>108</QRY:Id>
	<QRY:Source Name="mail.operations.findcarrieracceptancedetailsinbulk" Type="OBJECT">
			<![CDATA[
				 (SELECT MST.CMPCOD CMPCOD ,
				  MST.CONNUM CONNUM ,
				  MST.FLTCARIDR FLTCARIDR,
				  MST.FLTNUM FLTNUM,
				  MST.ASGPRT ASGPRT,
				  MST.FLTSEQNUM FLTSEQNUM,
				  MST.LEGSERNUM LEGSERNUM,
				  MST.SEGSERNUM SEGSERNUM,
				  MST.DSTCOD DSTCOD,
				  MST.POAFLG POAFLG,
				  MST.ACPFLG ACPFLG,
				  MST.OFLFLG OFLFLG,
				  MST.FLTCARCOD FLTCARCOD,
				  MST.CONTYP,
				  MST.LSTUPDTIM CONLSTUPDTIM,
				  MST.CONJRNIDR,
				  MST.POACOD,
				  MST.TRNFLG,
				  MST.CNTIDR,
				  0 ULDBAGCNT,
				  0 ULDBAGWGT,
				  MST.RMK RMK ,
				  ULD.WHSCOD WHSCOD,
				  ULD.LOCCOD LOCCOD,
				  '' FRMCARCOD,
				  NULL ULDLSTUPDTIM,
				  DSNMST.DSN DSN,
				  DSNMST.MALCLS MALCLS,
				  DSNMST.MALSUBCLS MALSUBCLS,
				  DSNMST.MALCTG MALCTGCOD,
				  DSNMST.ORGEXGOFC ORGEXGOFC,
				  DSNMST.DSTEXGOFC DSTEXGOFC,
				  DSNMST.YER YER,
				  DSNMST.MALSEQNUM MALSEQNUM,
				  CONARP.STDBAG DSNSTDBAG ,
				  CONARP.ACPBAG DSNACPBAG,
				  CONARP.STDWGT DSNSTDWGT ,
				  CONARP.ACPWGT DSNACPWGT,
				  (
				  CASE
					WHEN DSNMST.MALTYP = 'M'
					THEN 'Y'
					ELSE 'N'
				  END) AS PLTENBFLG
				FROM MALFLTCON MST
				INNER JOIN MALARPULD ULD
				ON MST.CMPCOD     = ULD.CMPCOD
				AND MST.ASGPRT    = ULD.ARPCOD
				AND MST.FLTCARIDR = ULD.FLTCARIDR
				INNER JOIN MALARPULDDTL CONARP
				ON ULD.CMPCOD     = CONARP.CMPCOD
				AND ULD.FLTCARIDR = CONARP.FLTCARIDR
				AND ULD.ARPCOD    =CONARP.ARPCOD
				AND ULD.ULDNUM    =CONARP.ULDNUM
				AND MST.CONNUM    = CONARP.CONNUM
				INNER JOIN MALMST DSNMST
				ON CONARP.CMPCOD     =DSNMST.CMPCOD
				 AND CONARP.FLTCARIDR =DSNMST.FLTCARIDR
				AND CONARP.MALSEQNUM = DSNMST.MALSEQNUM
				WHERE MST.CMPCOD     = ?
				AND MST.FLTCARIDR    = ?
				AND MST.ASGPRT       = ?
				AND MST.CONTYP       ='B'
				AND MST.TXNCOD       = 'ASG'
				AND MST.FLTSEQNUM    = '-1'
			]]>
		</QRY:Source>
	</QRY:Definition>

	   	<QRY:Definition>
	<QRY:Id>109</QRY:Id>
	<QRY:Source Name="mail.operations.findcarrieracceptancedetailsinemptycontainers" Type="OBJECT">
			<![CDATA[
				 (SELECT MST.CMPCOD CMPCOD,
				  MST.CONNUM CONNUM,
				  MST.FLTCARIDR FLTCARIDR,
				  MST.FLTNUM FLTNUM,
				  MST.ASGPRT ASGPRT,
				  MST.FLTSEQNUM FLTSEQNUM,
				  MST.LEGSERNUM LEGSERNUM,
				  MST.SEGSERNUM SEGSERNUM,
				  MST.DSTCOD DSTCOD,
				  MST.POAFLG POAFLG,
				  MST.ACPFLG ACPFLG,
				  MST.OFLFLG OFLFLG,
				  MST.FLTCARCOD FLTCARCOD,
				  MST.CONTYP,
				  MST.LSTUPDTIM AS CONLSTUPDTIM,
				  MST.CONJRNIDR,
				  MST.POACOD,
				  MST.TRNFLG,
				  MST.CNTIDR,
				  0 ULDBAGCNT,
				  0 ULDBAGWGT,
				  '' RMK,
				  ULD.WHSCOD WHSCOD,
				  ULD.LOCCOD LOCCOD,
				  '' FRMCARCOD,
				 NULL ULDLSTUPDTIM,
				  '' DSN,
				  '' MALCLS,
				  '' MALSUBCLS,
				  '' MALCTGCOD,
				  '' ORGEXGOFC,
				  '' DSTEXGOFC,
				  0 YER,
				  0 MALSEQNUM,
				  0 DSNSTDBAG,
				  0 DSNACPBAG,
				  0 DSNSTDWGT,
				  0 DSNACPWGT,
				  '' PLTENBFLG
				FROM MALFLTCON MST
				LEFT OUTER JOIN MALARPULDDTL CONARP
				ON MST.CMPCOD     = CONARP.CMPCOD
				AND MST.FLTCARIDR = CONARP.FLTCARIDR
				AND MST.ASGPRT    =CONARP.ARPCOD
				AND MST.CONNUM    =CONARP.CONNUM
				LEFT OUTER  JOIN MALARPULD ULD
				ON CONARP.CMPCOD     = ULD.CMPCOD
				AND CONARP.FLTCARIDR = ULD.FLTCARIDR
				AND CONARP.CONNUM    = ULD.ULDNUM
				WHERE MST.CMPCOD     = ?
				AND MST.FLTCARIDR    = ?
				AND MST.ASGPRT       = ?
				AND MST.TXNCOD       = 'ASG'
				AND MST.FLTSEQNUM    = '-1'
			]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
		<QRY:Id>189</QRY:Id>
		<QRY:Source Name="mail.operations.findroutingsformailbags" Type="NATIVE">
			<![CDATA[
				SELECT COUNT (1) ROUTE
				 FROM maluldsegdtl seg,
				  malmst mst,
				  malcsgdtl mal,
				  malcsgrtg rtg
				WHERE mst.cmpcod  = seg.cmpcod
				AND mst.malseqnum = seg.malseqnum
				AND seg.cmpcod    = ?
				AND seg.fltcaridr = ?
				AND seg.fltnum    = ?
				AND seg.fltseqnum = ?
				AND seg.uldnum    = ?
				AND mst.dsn       = ?
				AND mst.orgexgofc = ?
				AND mst.dstexgofc = ?
				AND mst.yer       = ?
				AND mst.malctg    = ?
				AND mst.malsubcls = ?
				AND seg.cmpcod    = mal.cmpcod
				AND seg.malseqnum = mal.malseqnum
				AND mal.cmpcod    = rtg.cmpcod
				AND mal.csgdocnum = rtg.csgdocnum
				AND mal.poacod    = rtg.poacod
			]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>190</QRY:Id>
	<QRY:Source Name="mail.operations.findofficeofexchangelov" Type="NATIVE">
		<![CDATA[

		SELECT CMPCOD, EXGOFCCOD, EXGCODDES, ARPCOD, POACOD
		  FROM MALEXGOFCMST
		  WHERE CMPCOD = ? AND  ACTFLG='A'


	]]>
	</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>190</QRY:Id>
	<QRY:Source Name="mail.operations.findmailsubclasscodes" Type="NATIVE">
		<![CDATA[

		SELECT MTK.CMPCOD,MTK.DES,MTK.SUBCLSCOD,MTK.SUBCLSGRP,MTK.LSTUPDUSR,MTK.LSTUPDTIM
		  FROM MALSUBCLSMST MTK
		  WHERE MTK.CMPCOD = ?



	]]>
	</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>200</QRY:Id>
	<QRY:Source Name="mail.operations.findpacode" Type="NATIVE">
		<![CDATA[

			  SELECT POA.CMPCOD,
			  POA.POACOD,
			  POA.ACCNUM ACCNO,
			  POA.POANAM,
			  POA.POAADR,
			  POA.CNTCOD,
			--  POA.MSGENBFLG,
--			  MAL.MALCTG MALCTGCOD,
--			  MAL.MALSUBCLS SUBCLSCOD,
--			  MAL.ASGFLG,
--			  MAL.HNDOVRFLG,
--			  MAL.PNDFLG,
--			  MAL.RCVFLG,
--			  MAL.RTNFLG,
--			  MAL.UPLFLG,
--			  MAL.DLVFLG,
--			  MAL.LODFLG,
--			  MAL.HNDOVRRCVFLG,
--			  MAL.HNDOVRONLFLG,
--			  MAL.RDYDLVFLG,
--			  MAL.TRTCPLFLG,
--			  MAL.ARRFLG,
		--	  POA.PRTRDT,
		--	  POA.MSGEVTLOC,
			  POA.GIBFLG,
			  POA.BASTYP,
			  POA.LSTUPDTIM,
			  POA.LSTUPDUSR,
			  POA.CONPSN CONPERSON,
			  POA.CTYNAM CITY,
			  POA.STANAM STATE,
			  POA.CNTNAM COUNTRY,
			  POA.MOBNUM MOBILE,
			  POA.POSCOD,
			  POA.PHNONE PHONE1,
			  POA.PHNTWO PHONE2,
			  POA.FAX,
			  POA.EMLADR,
			  POA.AUTEMLREQ,
			  POA.DBTINVCOD,
			  POA.RMK,
			  POA.ACTFLG,
			  NULL PARCOD ,
			  NULL SERNUM,
			  NULL BLGSRC,
			  NULL BLGFRQ,
			  NULL PFMAINV,
			  NULL STLCUR,
			  NULL VLDFRM,
			  NULL VLDTOO,
			 -- RDTVERNUM,
			  POA.LATVALLVL,
			  POA.VATNUM,
			  NULL PARVAL,
			  NULL DTLRMK,
			  NULL PARTYP,
			  NULL PTYIDR,
			  POA.DUEDAY,
			  POA.PROINVREQ,
			 -- POA.RDTSNDPRD,
			  POA.STLLVL,
              POA.STLTOLMAXVAL,
              POA.STLTOLPER,
              POA.STLTOLVAL,
			  POA.DUPMALPRD,
			  POA.SECEMLADRONE,
			  POA.SECEMLADRTWO
			FROM MALPOAMST POA
--			LEFT OUTER JOIN MALEVT MAL
--			ON POA.CMPCOD    = MAL.CMPCOD
--			AND POA.POACOD   = MAL.POACOD
			WHERE POA.CMPCOD = ?
			AND POA.POACOD = ?
			UNION
			SELECT POA.CMPCOD,
			  POA.POACOD,
			  POA.ACCNUM ACCNO,
			  POA.POANAM,
			  POA.POAADR,
			  POA.CNTCOD,
		--	  POA.MSGENBFLG,
--			  NULL,
--			  NULL,
--			  NULL,
--			  NULL,
--			  NULL,
--			  NULL,
--			  NULL,
--			  NULL,
--			  NULL,
--			  NULL,
--			  NULL,
--			  NULL,
--			  NULL,
--			  NULL,
--			  NULL,
			--  POA.PRTRDT,
			--  POA.MSGEVTLOC,
			  POA.GIBFLG,
			  POA.BASTYP,
			  POA.LSTUPDTIM,
			  POA.LSTUPDUSR,
			  POA.CONPSN CONPERSON,
			  POA.CTYNAM CITY,
			  POA.STANAM STATE,
			  POA.CNTNAM COUNTRY,
			  POA.MOBNUM MOBILE,
			  POA.POSCOD,
			  POA.PHNONE PHONE1,
			  POA.PHNTWO PHONE2,
			  POA.FAX,
			  POA.EMLADR,
			  POA.AUTEMLREQ,
			  POA.DBTINVCOD,
			  POA.RMK,
			  POA.ACTFLG,
			  DTL.PARCOD PARCOD ,
			  DTL.SERNUM ,
			  DTL.BLGSRC,
			  DTL.BLGFRQ,
			  NULL PFMAINV,
			  DTL.STLCUR,
			  DTL.VLDFRM,
			  DTL.VLDTOO,
			--  RDTVERNUM,
			  POA.LATVALLVL,
			  POA.VATNUM,
			  DTL.PARVAL,
			  DTL.DTLRMK,
			  DTL.PARTYP,
			  DTL.PTYIDR,
			  POA.DUEDAY,
			  POA.PROINVREQ,
			--  POA.RDTSNDPRD,
			  POA.STLLVL,
              POA.STLTOLMAXVAL,
              POA.STLTOLPER,
              POA.STLTOLVAL,
			  POA.DUPMALPRD,
			  POA.SECEMLADRONE,
			  POA.SECEMLADRTWO
			FROM MALPOAMST POA
			LEFT OUTER JOIN MALPOADTL DTL
			ON POA.CMPCOD    = DTL.CMPCOD
			AND POA.POACOD   = DTL.POACOD
			WHERE POA.CMPCOD = ?
			AND POA.POACOD = ?
			ORDER BY PARCOD,
			  SERNUM


	]]>
	</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
			<QRY:Id>120</QRY:Id>
			<QRY:Source Name="mail.operations.finduldsinassignedflight" Type="NATIVE">
				<![CDATA[
					SELECT distinct uld.uldnum connum, fltseg.pol asgprt, fltseg.pou
					FROM MALFLT flt, MALFLTSEG fltseg, MALULDSEG uld
					WHERE  flt.cmpcod = fltseg.cmpcod
					AND flt.fltcaridr = fltseg.fltcaridr
					AND flt.fltnum = fltseg.fltnum
					AND flt.fltseqnum = fltseg.fltseqnum
					AND flt.arpcod = fltseg.pol
					AND fltseg.cmpcod = uld.cmpcod
					AND fltseg.fltcaridr = uld.fltcaridr
					AND fltseg.fltnum = uld.fltnum
					AND fltseg.fltseqnum = uld.fltseqnum
					AND fltseg.segsernum = uld.segsernum
					AND flt.cmpcod = ?
					AND flt.fltcaridr = ?
					AND flt.fltnum = ?
					AND flt.fltseqnum = ?
					AND flt.arpcod = ?
				 ]]>
			</QRY:Source>
		</QRY:Definition>

	<QRY:Definition>
		<QRY:Id>121</QRY:Id>
		<QRY:Source Name="mail.operations.findcontainersinflightformanifest" Type="NATIVE">
			<![CDATA[
					SELECT FLT.CMPCOD,
					FLT.FLTCARIDR,
					FLT.FLTNUM,
					FLT.FLTSEQNUM,
					FLT.SEGSERNUM,
					ULD.ULDNUM,
					MST.DSN,
					(CASE
						WHEN (CSGRTG.FLTNUM IS NOT NULL)
							THEN 'Y'
						ELSE
							'N'
						END
					) AS RTGAVL,
					MST.ORGEXGOFC,
					MST.DSTEXGOFC,
					MST.ORGCOD,
					MST.DSTCOD,
					MST.MALCLS,
					MST.MALSUBCLS,
					MST.MALCTG MALCTGCOD,
					MST.YER,
					MST.SHPPFX DOCOWRCOD,
				    MST.DOCOWRIDR,
				    MST.SEQNUM,
				    MST.DUPNUM,
				    MST.MSTDOCNUM,
					FLT.POL,
					FLT.POU,
					ULD.BAGCNT,
					ULD.BAGWGT,
					DSN.ACPBAG,
					DSN.ACPWGT,
					DSN.STDBAG,
					DSN.STDWGT,
					DSN.LSTUPDTIM DSNULDSEGTIM,
					(
					CASE
					WHEN MST.MALTYP = 'M'
					THEN 'Y'
					ELSE 'N'
					END) AS PLTENBFLG,
					CON.ARRSTA,
					CON.ACPFLG,
					COALESCE(CON.DSTCOD,BULKCON.DSTCOD) DSTCOD,
					CON.CONNUM,
					CON.POAFLG,
					MST.CONTYP,
					DSN.CONNUM BULKCONNUM,
					RTG.ONWCARCOD
					|| '-'
					|| RTG.ONWFLTNUM
					|| '-'
					|| TO_CHAR (RTG.ONWFLTDAT, 'dd-MON-yyyy')
					|| '-'
					|| RTG.POU AS ONWRTGSTR,
					MST.CSGDOCNUM CSGDOCNUM,
					MST.CSGSEQNUM,
					CSGMST.CSGDAT CSGDAT,
					MST.DSPDAT ACPDAT,
					MST.POACOD POACOD,
					NULL REMARKS
					FROM MALFLTSEG FLT
					INNER JOIN MALULDSEG ULD
					ON FLT.CMPCOD     = ULD.CMPCOD
					AND FLT.FLTCARIDR = ULD.FLTCARIDR
					AND FLT.FLTNUM    = ULD.FLTNUM
					AND FLT.FLTSEQNUM = ULD.FLTSEQNUM
					AND FLT.SEGSERNUM = ULD.SEGSERNUM
					LEFT OUTER JOIN MALONWRTGSEG RTG
					ON ULD.CMPCOD     = RTG.CMPCOD
					AND ULD.ULDNUM    = RTG.ULDNUM
					AND ULD.FLTCARIDR = RTG.FLTCARIDR
					AND ULD.FLTNUM    = RTG.FLTNUM
					AND ULD.FLTSEQNUM = RTG.FLTSEQNUM
					AND ULD.SEGSERNUM = RTG.SEGSERNUM
					LEFT OUTER JOIN MALFLTCON CON
					ON ULD.CMPCOD     = CON.CMPCOD
					AND ULD.FLTCARIDR = CON.FLTCARIDR
					AND ULD.FLTNUM    = CON.FLTNUM
					AND ULD.FLTSEQNUM = CON.FLTSEQNUM
					AND ULD.SEGSERNUM = CON.SEGSERNUM
					AND ULD.ULDNUM    = CON.CONNUM
					LEFT OUTER JOIN MALULDSEGDTL DSN
					ON ULD.CMPCOD     = DSN.CMPCOD
					AND ULD.FLTCARIDR = DSN.FLTCARIDR
					AND ULD.FLTNUM    = DSN.FLTNUM
					AND ULD.FLTSEQNUM = DSN.FLTSEQNUM
					AND ULD.SEGSERNUM = DSN.SEGSERNUM
					AND ULD.ULDNUM    = DSN.ULDNUM
					LEFT OUTER JOIN MALMST MST
					ON DSN.CMPCOD     = MST.CMPCOD
					AND DSN.MALSEQNUM = MST.MALSEQNUM
					LEFT OUTER JOIN MALCSGMST CSGMST
					ON CSGMST.CMPCOD     = MST.CMPCOD
					AND CSGMST.CSGDOCNUM = MST.CSGDOCNUM
					AND CSGMST.POACOD    = MST.POACOD
					AND CSGMST.CSGSEQNUM = MST.CSGSEQNUM
					LEFT OUTER JOIN MALCSGRTG CSGRTG
					ON CSGRTG.CMPCOD  = CSGMST.CMPCOD
					AND CSGRTG.CSGDOCNUM  = CSGMST.CSGDOCNUM
					AND CSGRTG.CSGSEQNUM  = CSGMST.CSGSEQNUM
					AND CSGRTG.POACOD     = CSGMST.POACOD
					AND CSGRTG.FLTNUM=FLT.FLTNUM
					AND CSGRTG.FLTSEQNUM=FLT.FLTSEQNUM
					AND CSGRTG.FLTCARIDR=FLT.FLTCARIDR
					AND SUBSTR(CSGMST.CSGDOCNUM,0,3) <> 'ACM'
					LEFT OUTER JOIN MALFLTCON BULKCON
					ON DSN.CMPCOD     = BULKCON.CMPCOD
					AND DSN.FLTCARIDR = BULKCON.FLTCARIDR
					AND DSN.FLTNUM    = BULKCON.FLTNUM
					AND DSN.FLTSEQNUM = BULKCON.FLTSEQNUM
					AND DSN.SEGSERNUM = BULKCON.SEGSERNUM
					AND DSN.CONNUM    = BULKCON.CONNUM
					LEFT OUTER JOIN
					(SELECT MALSEG.FLTCARIDR,
					MALSEG.CMPCOD ,
					MALSEG.FLTNUM ,
					MALSEG.FLTSEQNUM ,
					MALSEG.SEGSERNUM ,
					MALMST.DSN ,
					MALMST.ORGEXGOFC ,
					MALMST.DSTEXGOFC ,
					MALMST.MALSUBCLS ,
					MALMST.MALSEQNUM ,
					MALMST.YER ,
					MALMST.MALCTG MALCTGCOD,
					MALSEG.ULDNUM,
					MALMST.CSGDOCNUM ,
					MALMST.POACOD
					FROM MALULDSEGDTL MALSEG
					INNER JOIN MALMST MALMST
					ON MALSEG.CMPCOD                       = MALMST.CMPCOD
					AND MALSEG.MALSEQNUM                   = MALMST.MALSEQNUM
					WHERE MALSEG.CMPCOD                    = ?
					AND MALSEG.FLTCARIDR                   = ?
					AND MALSEG.FLTNUM                      = ?
					AND MALSEG.FLTSEQNUM                   = ?
					) MALCSGDTL ON MALCSGDTL.MALSEQNUM     = DSN.MALSEQNUM
					AND MALCSGDTL.CMPCOD                     = DSN.CMPCOD
					AND MALCSGDTL.FLTCARIDR                  = DSN.FLTCARIDR
					AND MALCSGDTL.FLTNUM                     = DSN.FLTNUM
					AND MALCSGDTL.FLTSEQNUM                  = DSN.FLTSEQNUM
					AND MALCSGDTL.SEGSERNUM                  = DSN.SEGSERNUM
					AND MALCSGDTL.ULDNUM                     = DSN.ULDNUM
					WHERE FLT.CMPCOD                         = ?
					AND FLT.FLTCARIDR                        = ?
					AND FLT.FLTNUM                           = ?
					AND FLT.FLTSEQNUM                        = ?
					AND FLT.POL                              = ?
					AND NOT ( CON.CONNUM                    IS NULL
					AND COALESCE(CON.DSTCOD,BULKCON.DSTCOD) IS NULL)
					ORDER BY ULD.ULDNUM,
					ULD.SEGSERNUM,
					MST.DSN,
					MST.ORGEXGOFC,
					MST.DSTEXGOFC,
					MST.MALSUBCLS,
					MST.MALCTG,
					MST.YER
			 ]]>
		  </QRY:Source>
	  </QRY:Definition>

	  	<QRY:Definition>
	<QRY:Id>157</QRY:Id>
	<QRY:Source Name="mail.operations.findmanifestedmailsinuld" Type="NATIVE">
		<![CDATA[
				 SELECT FLT.CMPCOD,
				  FLT.FLTNUM,
				  FLT.FLTSEQNUM,
				  FLT.FLTCARIDR,
				  FLT.SEGSERNUM,
				  FLT.POL,
				  ULD.ULDNUM,
				  MST.DSN,
				  MST.ORGEXGOFC,
				  MST.DSTEXGOFC,
				  MST.YER,
				  MST.MALCTG MALCTGCOD,
				  MST.MALSUBCLS,
				  MST.MALCLS,
				  MST.RSN,
				  MST.HSN,
				  MST.REGIND,
				  MST.WGT,
				  MST.DSPWGT,
				  MST.DSPWGTUNT,
				  MST.MALSTA,
				  (
				  CASE
					WHEN MST.MALTYP = 'M'
					THEN 'Y'
					ELSE 'N'
				  END) AS PLTENBFLG,
				  MST.CSGDOCNUM CSGDOCNUM,
				  MST.CSGSEQNUM CSGSEQNUM,
				  MST.POACOD POACOD,
				  CSGMST.CSGDAT CSGDAT,
				  MST.DSPDAT ACPDAT,
				  MALSEG.ACPWGT CSGACPWGT,
				  MALSEG.ACPBAG CSGACPBAG,
				  MALSEG.STDBAG CSGSTDBAG,
				  MALSEG.STDWGT CSGSTDWGT,
				  NULL ACPUSR,
				  MST.MALIDR MALIDR,
				  MALSEG.DMGFLG DMGFLG,
				  MALSEG.FRMCARCOD MALFRMCARCOD,
				  MALSEG.CONNUM,
				  'U' AS CONTYP,
				  (SELECT HIS.SCNDAT
				  FROM MALHIS HIS
				  WHERE HIS.CMPCOD  = MALSEG.CMPCOD
				  AND HIS.MALSEQNUM = MALSEG.MALSEQNUM
				  AND HIS.FLTCARIDR = MALSEG.FLTCARIDR
				  AND HIS.FLTNUM    = MALSEG.FLTNUM
				  AND HIS.FLTSEQNUM = MALSEG.FLTSEQNUM
				  AND HIS.SEGSERNUM = MALSEG.SEGSERNUM
				  AND HIS.CONNUM    = MALSEG.CONNUM
				  AND HIS.MALSTA   IN (?,?,?)
				  AND HIS.SCNPRT    = ?
				  AND HIS.MALHISIDR =
					(SELECT MAX (MALHISIDR)
					FROM MALHIS
					WHERE MALSEQNUM = HIS.MALSEQNUM
					AND MALSTA     IN (?,?,?)
					AND SCNPRT      = HIS.SCNPRT
					)
				  ) SCNDAT
				FROM MALFLTSEG FLT
				INNER JOIN MALULDSEG ULD
				ON FLT.CMPCOD     = ULD.CMPCOD
				AND FLT.FLTCARIDR = ULD.FLTCARIDR
				AND FLT.FLTNUM    = ULD.FLTNUM
				AND FLT.FLTSEQNUM = ULD.FLTSEQNUM
				AND FLT.SEGSERNUM = ULD.SEGSERNUM
				LEFT OUTER JOIN MALULDSEGDTL MALSEG
				ON ULD.CMPCOD     = MALSEG.CMPCOD
				AND ULD.FLTCARIDR = MALSEG.FLTCARIDR
				AND ULD.FLTNUM    = MALSEG.FLTNUM
				AND ULD.FLTSEQNUM = MALSEG.FLTSEQNUM
				AND ULD.SEGSERNUM = MALSEG.SEGSERNUM
				AND ULD.ULDNUM    = MALSEG.ULDNUM
				INNER JOIN MALMST MST
				ON MALSEG.CMPCOD     = MST.CMPCOD
				AND MALSEG.MALSEQNUM = MST.MALSEQNUM
				LEFT OUTER JOIN MALCSGMST CSGMST
				ON CSGMST.CMPCOD     = MST.CMPCOD
				AND CSGMST.CSGDOCNUM = MST.CSGDOCNUM
				AND CSGMST.POACOD    = MST.POACOD
				AND CSGMST.CSGSEQNUM = MST.CSGSEQNUM
				INNER JOIN MALFLTCON CON
				ON CON.CMPCOD     = MALSEG.CMPCOD
				AND CON.FLTCARIDR = MALSEG.FLTCARIDR
				AND CON.FLTNUM    = MALSEG.FLTNUM
				AND CON.FLTSEQNUM = MALSEG.FLTSEQNUM
				AND CON.SEGSERNUM = MALSEG.SEGSERNUM
				AND CON.CONNUM    = MALSEG.CONNUM
				AND MALSEG.ACPSTA    = 'Y'
				AND CON.CONTYP		 = 'U'
				WHERE ULD.CMPCOD     = ?
				AND ULD.FLTCARIDR    = ?
				AND ULD.FLTNUM       = ?
				AND ULD.FLTSEQNUM    = ?
				AND ULD.SEGSERNUM    = ?
				AND FLT.POL          = ?
				AND ULD.ULDNUM       = ?
				ORDER BY DSN,
				  ORGEXGOFC,
				  DSTEXGOFC,
				  YER,
				  MALCTGCOD,
				  MALSUBCLS,
				  MALIDR,
				  CSGDOCNUM,
				  CSGSEQNUM,
				  POACOD
		 ]]>
	  </QRY:Source>
	  </QRY:Definition>

	<QRY:Definition>
	<QRY:Id>158</QRY:Id>
	<QRY:Source Name="mail.operations.findmanifestedmailsinbulk" Type="NATIVE">
		<![CDATA[
				SELECT FLT.CMPCOD,
				  FLT.FLTNUM,
				  FLT.FLTSEQNUM,
				  FLT.FLTCARIDR,
				  FLT.SEGSERNUM,
				  FLT.POL,
				  ULD.ULDNUM,
				  MST.DSN,
				  MST.ORGEXGOFC,
				  MST.DSTEXGOFC,
				  MST.YER,
				  MST.MALCTG MALCTGCOD,
				  MST.MALSUBCLS,
				  MST.MALCLS,
				  MST.RSN,
				  MST.HSN,
				  MST.REGIND,
				  MST.WGT,
				  MST.DSPWGT,
				  MST.DSPWGTUNT,
				  MST.MALSTA,
				  (
				  CASE
					WHEN MST.MALTYP = 'M'
					THEN 'Y'
					ELSE 'N'
				  END) AS PLTENBFLG,
				  MST.CSGDOCNUM CSGDOCNUM,
				  MST.CSGSEQNUM CSGSEQNUM,
				  MST.POACOD POACOD,
				  CSGMST.CSGDAT CSGDAT,
				  MST.DSPDAT ACPDAT,
				  MALSEG.ACPWGT CSGACPWGT,
				  MALSEG.ACPBAG CSGACPBAG,
				  MALSEG.STDBAG CSGSTDBAG,
				  MALSEG.STDWGT CSGSTDWGT,
				  NULL ACPUSR,
				  MALSEG.CONNUM,
				  MST.MALIDR MALIDR,
				  'B' AS CONTYP,
				  MALSEG.DMGFLG DMGFLG,
				  MALSEG.FRMCARCOD MALFRMCARCOD,
				  MALSEG.CONNUM BULKCONNUM,
				  (SELECT HIS.SCNDAT
				  FROM MALHIS HIS
				  WHERE HIS.CMPCOD  = MALSEG.CMPCOD
				  AND HIS.MALSEQNUM = MALSEG.MALSEQNUM
				  AND HIS.FLTCARIDR = MALSEG.FLTCARIDR
				  AND HIS.FLTNUM    = MALSEG.FLTNUM
				  AND HIS.FLTSEQNUM = MALSEG.FLTSEQNUM
				  AND HIS.SEGSERNUM = MALSEG.SEGSERNUM
				  AND HIS.CONNUM    = MALSEG.CONNUM
				  AND HIS.MALSTA   IN (?,?,?)
				  AND HIS.SCNPRT    = ?
				  AND HIS.MALHISIDR =
					(SELECT MAX ( MALHISIDR)
					FROM MALHIS
					WHERE MALSEQNUM = HIS.MALSEQNUM
					AND MALSTA     IN (?, ?,?)
					AND SCNPRT      = HIS.SCNPRT
					)
				  ) SCNDAT
				FROM MALFLTSEG FLT
				INNER JOIN MALULDSEG ULD
				ON FLT.CMPCOD     = ULD.CMPCOD
				AND FLT.FLTCARIDR = ULD.FLTCARIDR
				AND FLT.FLTNUM    = ULD.FLTNUM
				AND FLT.FLTSEQNUM = ULD.FLTSEQNUM
				AND FLT.SEGSERNUM = ULD.SEGSERNUM
				LEFT OUTER JOIN MALULDSEGDTL MALSEG
				ON ULD.CMPCOD     = MALSEG.CMPCOD
				AND ULD.FLTCARIDR = MALSEG.FLTCARIDR
				AND ULD.FLTNUM    = MALSEG.FLTNUM
				AND ULD.FLTSEQNUM = MALSEG.FLTSEQNUM
				AND ULD.SEGSERNUM = MALSEG.SEGSERNUM
				AND ULD.ULDNUM    = MALSEG.ULDNUM
				INNER JOIN MALMST MST
				ON MALSEG.CMPCOD     = MST.CMPCOD
				AND MALSEG.MALSEQNUM = MST.MALSEQNUM
				LEFT OUTER JOIN MALCSGMST CSGMST
				ON CSGMST.CMPCOD     = MST.CMPCOD
				AND CSGMST.CSGDOCNUM = MST.CSGDOCNUM
				AND CSGMST.POACOD    = MST.POACOD
				AND CSGMST.CSGSEQNUM = MST.CSGSEQNUM
				INNER JOIN MALFLTCON CON
				ON CON.CMPCOD     = MALSEG.CMPCOD
				AND CON.FLTCARIDR = MALSEG.FLTCARIDR
				AND CON.FLTNUM    = MALSEG.FLTNUM
				AND CON.FLTSEQNUM = MALSEG.FLTSEQNUM
				AND CON.SEGSERNUM = MALSEG.SEGSERNUM
				AND CON.CONNUM    = MALSEG.CONNUM
				AND MALSEG.ACPSTA = 'Y'
				WHERE ULD.CMPCOD  = ?
				AND ULD.FLTCARIDR = ?
				AND ULD.FLTNUM    = ?
				AND ULD.FLTSEQNUM =?
				AND ULD.SEGSERNUM = ?
				AND FLT.POL       = ?
				AND ULD.ULDNUM    =?
				AND CON.CONTYP    ='B'
				ORDER BY DSN,
				  ORGEXGOFC,
				  DSTEXGOFC,
				  YER,
				  MALCTGCOD,
				  MALSUBCLS,
				  MALIDR,
				  CSGDOCNUM,
				  CSGSEQNUM,
				  POACOD

		 ]]>
	  </QRY:Source>
	  </QRY:Definition>

	<QRY:Definition>
			<QRY:Id>159</QRY:Id>
			<QRY:Source Name="mail.operations.findcontainersinassignedflight" Type="NATIVE">
				<![CDATA[
						SELECT MST.CMPCOD,
						  MST.CONNUM,
						  MST.FLTCARIDR,
						  MST.FLTNUM,
						  MST.FLTSEQNUM,
						  MST.LEGSERNUM,
						  MST.SEGSERNUM,
						  MST.ASGPRT,
						  MST.POU,
						  MST.RMK,
						  MST.USRCOD,
						  MST.ARRSTA,
						  MST.ASGDAT,
						  MST.POAFLG,
						  MST.DSTCOD,
						  MST.CONTYP,
						  MST.FLTCARCOD,
						  MST.ACPFLG,
						  MST.OFLFLG,
						  FLT.FLTDAT,
						  MST.POACOD SBCODE,
						  FLT.EXPCLSFLG CLSFLG
						FROM MALFLTCON MST
						INNER JOIN MALFLT FLT
						ON MST.FLTCARIDR  = FLT.FLTCARIDR
						AND MST.FLTNUM    = FLT.FLTNUM
						AND MST.FLTSEQNUM = FLT.FLTSEQNUM
						AND MST.LEGSERNUM = FLT.LEGSERNUM
						AND MST.ASGPRT    = FLT.ARPCOD
						WHERE MST.CMPCOD  = ?
						AND MST.FLTCARIDR = ?
						AND MST.FLTNUM    = ?
						AND MST.FLTSEQNUM = ?
						AND MST.ASGPRT    = ?
						AND MST.CONTYP    = 'B'
						ORDER BY MST.CMPCOD,
						  MST.CONNUM,
						  MST.ASGPRT,
						  MST.FLTCARIDR,
						  MST.FLTNUM,
						  MST.FLTSEQNUM,
						  MST.LEGSERNUM
				 ]]>
			</QRY:Source>
		</QRY:Definition>

		<QRY:Definition>
		<QRY:Id>160</QRY:Id>
		<QRY:Source Name="mail.operations.findAWBDetails" Type="NATIVE">
			<![CDATA[
					SELECT cmpcod,
					  docowridr,
					  mstdocnum,
					  dupnum,
					  seqnum
					FROM MALMST
					WHERE cmpcod  = ?
					AND uldnum    = ?
					AND docowridr = ?
					AND mstdocnum = ?

		]]>
		</QRY:Source>
		</QRY:Definition>

	   <QRY:Definition>
			<QRY:Id>161</QRY:Id>
			<QRY:Source Name="mail.operations.findmailbagsinclosedflight" Type="NATIVE">
			<![CDATA[
					SELECT MALMST.MALIDR
					FROM MALFLT ASG,
					  MALFLTSEG FLTSEG,
					  MALULDSEG ULDSEG,
					  MALULDSEGDTL SEGDTL,
					  MALMST MALMST
					WHERE ASG.CMPCOD     = FLTSEG.CMPCOD
					AND ASG.FLTCARIDR    = FLTSEG.FLTCARIDR
					AND ASG.FLTNUM       = FLTSEG.FLTNUM
					AND ASG.FLTSEQNUM    = FLTSEG.FLTSEQNUM
					AND ASG.ARPCOD       = FLTSEG.POL
					AND FLTSEG.CMPCOD    = ULDSEG.CMPCOD
					AND FLTSEG.FLTCARIDR = ULDSEG.FLTCARIDR
					AND FLTSEG.FLTNUM    = ULDSEG.FLTNUM
					AND FLTSEG.FLTSEQNUM = ULDSEG.FLTSEQNUM
					AND FLTSEG.SEGSERNUM = ULDSEG.SEGSERNUM
					AND ULDSEG.CMPCOD    = SEGDTL.CMPCOD
					AND ULDSEG.FLTCARIDR = SEGDTL.FLTCARIDR
					AND ULDSEG.FLTNUM    = SEGDTL.FLTNUM
					AND ULDSEG.FLTSEQNUM = SEGDTL.FLTSEQNUM
					AND ULDSEG.SEGSERNUM = SEGDTL.SEGSERNUM
					AND MALMST.CMPCOD    = SEGDTL.CMPCOD
					AND MALMST.MALSEQNUM = SEGDTL.MALSEQNUM
					AND ASG.CMPCOD       = ?
					AND ASG.FLTCARIDR    = ?
					AND ASG.FLTNUM       = ?
					AND ASG.FLTSEQNUM    = ?
					AND ASG.LEGSERNUM    = ?
					AND ASG.ARPCOD       = ?
					AND SEGDTL.ACPSTA    = 'Y'
			]]>
			</QRY:Source>
	 </QRY:Definition>

	<QRY:Definition>
	<QRY:Id>162</QRY:Id>
	<QRY:Source Name="mail.operations.findoffload" Type="NATIVE">
		<![CDATA[
SELECT MST.CMPCOD,
  MST.CONNUM,
  MST.ASGPRT,
  MST.FLTCARIDR,
  MST.FLTNUM,
  MST.FLTSEQNUM,
  MST.LEGSERNUM,
  MST.ACPFLG,
  MST.POAFLG,
  MST.SEGSERNUM,
  MST.CONTYP,
  MST.POU,
  MST.DSTCOD,

  MST.CONJRNIDR,
  MST.POACOD SBCODE ,
  MST.ULDFULIND,

		]]>
	</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>163</QRY:Id>
	<QRY:Source Name="mail.operations.findoffloadmailbags" Type="NATIVE">
		<![CDATA[

				SELECT MST.CMPCOD,
			  MST.CONNUM,
			  MST.ASGPRT,
			  MST.FLTCARIDR,
			  MST.FLTNUM,
			  MST.FLTSEQNUM,
			  MST.LEGSERNUM,
			  MST.ACPFLG,
			  MST.SEGSERNUM,
			  MST.CONTYP,
			  MST.POU,
			  MST.DSTCOD ,
			  MST.FLTCARCOD,
			  MST.LSTUPDTIM,
			  MAL.MALSTA,
			  MAL.WGT,
			  MAL.DSN,
			  MAL.CSGDOCNUM,
			  MAL.MALCLS,
			  MAL.MALSUBCLS,
			  MAL.MALCTG MALCTGCOD,
			  SEGDTL.ULDNUM,
			  MAL.ORGEXGOFC,
			  MAL.DSTEXGOFC,
			  MAL.YER,
			  MAL.MALIDR,
			  MAL.POACOD,
			  MAL.CSGSEQNUM,
			  MAL.OPRSTA,
			  MST.POAFLG,
			  ASG.FLTDAT
			FROM MALFLT ASG,
			 MALFLTSEG FLTSEG,
				MALULDSEGDTL SEGDTL,
			  MALFLTCON MST,
			  MALMST MAL
			WHERE ASG.CMPCOD    = FLTSEG.CMPCOD
			AND ASG.FLTCARIDR   =FLTSEG.FLTCARIDR
			AND ASG.FLTNUM      =FLTSEG.FLTNUM
			AND ASG.FLTSEQNUM   =FLTSEG.FLTSEQNUM
			AND ASG.ARPCOD      =FLTSEG.POL
			AND FLTSEG.CMPCOD   =SEGDTL.CMPCOD
			AND FLTSEG.FLTCARIDR=SEGDTL.FLTCARIDR
			AND FLTSEG.FLTNUM   =SEGDTL.FLTNUM
			AND FLTSEG.FLTSEQNUM=SEGDTL.FLTSEQNUM
			AND FLTSEG.SEGSERNUM=SEGDTL.SEGSERNUM
			AND MST.CMPCOD    = SEGDTL.CMPCOD
			AND MST.FLTCARIDR = SEGDTL.FLTCARIDR
			AND MST.FLTNUM    = SEGDTL.FLTNUM
			AND MST.FLTSEQNUM = SEGDTL.FLTSEQNUM
			AND MST.SEGSERNUM = SEGDTL.SEGSERNUM
			AND SEGDTL.CONNUM   =MST.CONNUM
			AND SEGDTL.CMPCOD   =MAL.CMPCOD
			AND SEGDTL.MALSEQNUM   = MAL.MALSEQNUM AND


		]]>
	</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
			<QRY:Id>164</QRY:Id>
				<QRY:Source Name="mail.operations.findcapturednotaccpetedmailbags" Type="NATIVE">
				<![CDATA[
					SELECT ROW_NUMBER() OVER(ORDER BY 1) AS RNK,
						  CSGMAL.CMPCOD,
						  CSGMST.CSGDAT SCNDAT,
						  CSGMAL.CSGDOCNUM,
						  CSGMAL.POACOD,
						  CSGMAL.CSGSEQNUM,
						  CSGMST.OPRTYP OPRSTA,
						  CSGMST.ARPCOD SCNPRT,
						  RTG.FLTCARCOD,
						  RTG.FLTCARIDR,
						  RTG.FLTNUM,
						  RTG.FLTDAT,
						  RTG.FLTSEQNUM,
						  MALMST.DSN,
						  MALMST.ORGEXGOFC,
						  MALMST.DSTEXGOFC,
						  MALMST.MALCLS,
						  MALMST.YER,
						  MALMST.MALSEQNUM,
						  MALMST.MALIDR,
						MALMST.MALCTG MALCTGCOD,
						  MALMST.MALSUBCLS,
						  MALMST.HSN,
						  MALMST.RSN,
						  MALMST.WGT WGT,
						  MALMST.REGIND,
						  MALMST.REQDLVTIM,
						  MALMST.VOl,
						  MALMST.VOLUNT,
						  MALMST.ONNTIMDLVFLG,
						CSGMST.STDWGT ACPWGT,
						  CSGMAL.ULDNUM CONNUM,
					   CSGMST.STDBAG ACPBAG,
						  CSGMST.CSGDAT,
						  MALMST.LSTUPDUSR SCNUSR,
						  MALMST.LSTUPDUSR,
						  'CAP' MALSTA,
						  MALMST.ORGCOD,
						  MALMST.DSTCOD
						FROM MALCSGMST CSGMST
						INNER JOIN MALCSGDTL CSGMAL
						ON CSGMAL.CMPCOD     = CSGMST.CMPCOD
						AND CSGMAL.CSGDOCNUM = CSGMST.CSGDOCNUM
						AND CSGMAL.POACOD    = CSGMST.POACOD
						AND CSGMAL.CSGSEQNUM = CSGMST.CSGSEQNUM
						INNER JOIN MALMST MALMST
						ON MALMST.CMPCOD  = CSGMAL.CMPCOD
						AND MALMST.MALSEQNUM = CSGMAL.MALSEQNUM
						AND COALESCE(MALMST.MALSTA,'N') ='NEW'
						INNER JOIN MALCSGRTG RTG
						ON RTG.CMPCOD     = CSGMST.CMPCOD
						AND RTG.CSGDOCNUM = CSGMST.CSGDOCNUM
						AND RTG.POACOD    = CSGMST.POACOD
						AND RTG.CSGSEQNUM = CSGMST.CSGSEQNUM
						AND RTG.RTGSERNUM =
						  (SELECT MIN(RTGSERNUM)
						  FROM MALCSGRTG
						  WHERE CMPCOD  = CSGMST.CMPCOD
						  AND CSGDOCNUM = CSGMST.CSGDOCNUM
						  AND POACOD    = CSGMST.POACOD
						  AND CSGSEQNUM = CSGMST.CSGSEQNUM


					    ]]>
				</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>165</QRY:Id>
		<QRY:Source Name="mail.operations.findmailbagsforinventory" Type="NATIVE">
			<![CDATA[

			   SELECT  DISTINCT ROW_NUMBER() OVER(ORDER BY null) AS RNK,MALMST.CMPCOD, MALMST.MALIDR, MALMST.ORGEXGOFC, MALMST.DSTEXGOFC, MALMST.YER, MALMST.DSN,
               MALMST.MALCLS, MALMST.MALCTG MALCTGCOD, MALMST.MALSUBCLS, MALMST.SCNPRT,
		       MALMST.SCNDAT, MALMST.CONNUM, MALMST.SCNUSR, MALMST.MALSTA, MALMST.OPRSTA, MALMST.CONTYP,
		       MALMST.POU, MALMST.WGT, MALMST.CSGDOCNUM, MALMST.CSGSEQNUM, MALMST.POACOD, MALMST.DMGFLG,
		       MALMST.FLTCARIDR, MALMST.FLTSEQNUM, MALMST.FLTNUM, MALMST.SEGSERNUM,ARPULD.FLTCARCOD,
		       MALMST.ORGCOD, MALMST.DSTCOD

			   FROM MALMST MALMST INNER JOIN MALARPULD ARPULD ON
               MALMST.CMPCOD = ARPULD.CMPCOD AND
		       MALMST.FLTCARIDR=ARPULD.FLTCARIDR AND
			   MALMST.SCNPRT=ARPULD.ARPCOD

			]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
<QRY:Id>166</QRY:Id>
<QRY:Source Name="mail.operations.findmailbags" Type="NATIVE">
	<![CDATA[

			SELECT DISTINCT ROW_NUMBER() OVER(ORDER BY null) AS RNK,
			MST.CMPCOD,
		  MST.MALIDR,
		  MST.MALSEQNUM,
		  MST.ORGEXGOFC,
		  MST.DSTEXGOFC,
		  MST.YER,
		  MST.DSN,
		  MST.RSN,
		  MST.HSN,
		  MST.REGIND,
		  MST.MALCLS,
		  MST.MALCTG MALCTGCOD,
		  MST.MALSUBCLS,
		  MST.SCNPRT,
		  MST.SCNDAT,
		  MST.CONNUM CONNUM,
		  MST.SCNUSR,
		  MST.MALSTA,
		  MST.OPRSTA,
		  MST.CONTYP,
		  MST.POU,
		  MST.WGT,
		  MST.DSPWGT,
		  MST.DSPWGTUNT,
		  MST.CSGDOCNUM,
		  MST.CSGSEQNUM,
		  MST.POACOD,
		  MST.DMGFLG,
		  MST.LSTUPDTIM,
		  MST.REQDLVTIM,
		  MST.MSTDOCNUM,
		  MST.SHPPFX,
		 -- MST.MALSEQNUM,
		  MST.ORGCOD, MST.DSTCOD,
		  MST.ACTWGT,
		  MST.ACTWGTDSP,
		  MST.ACTWGTDSPUNT,
		  MST.MALSRVLVL,
          MST.ONNTIMDLVFLG,
		  MST.VOl,
		  MST.VOLUNT,
		  MST.TRPSRVENDTIM



]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>167</QRY:Id>
<QRY:Source Name="mail.operations.findmailbagsforreturn" Type="NATIVE">
	<![CDATA[

			SELECT ROW_NUMBER() OVER(ORDER BY 1) AS RNK,
		  MST.CMPCOD,
		  MST.MALIDR,
		  MST.ORGEXGOFC,
		  MST.DSTEXGOFC,
		  MST.YER,
		  MST.DSN,
		  MST.MALCLS,
		  MST.MALCTG MALCTGCOD,
		  MST.MALSUBCLS,
		  MST.SCNPRT,
		  MST.SCNDAT,
		  MST.SCNUSR,
		  MST.MALSTA,
		  MST.OPRSTA,
		  MST.POU,
		  MST.WGT,
		  MST.CSGDOCNUM,
		  MST.CSGSEQNUM,
		  MST.POACOD,
		  MST.DMGFLG,
		  MST.LSTUPDTIM,
		  MST.REQDLVTIM,
		  MST.ORGCOD,
		  MST.DSTCOD,
		  MST.VOl,
		  MST.VOLUNT


]]>
</QRY:Source>
</QRY:Definition>

	<QRY:Definition>
		<QRY:Id>168</QRY:Id>
		<QRY:Source Name="mail.operations.findconsignmentdetails" Type="NATIVE">
		<![CDATA[
				SELECT DISTINCT MALMST.ORGEXGOFC, MALMST.DSTEXGOFC, MALMST.YER, MALMST.DSN, MALMST.RSN,
				MALMST.MALCTG MALCTGCOD, MALMST.MALSUBCLS, MALMST.REGIND, MALMST.MALIDR, MALMST.HSN,
				MALMST.WGT,MALMST.DSPWGT,MALMST.DSPWGTUNT, MST.CSGDOCNUM, MST.CSGDAT, MST.POACOD, MALMST.MALCLS,
				MALMST.CONNUM ULDNUM,
				CASE
				WHEN COALESCE(MALMST.MALSTA,
				'NULL') = 'NEW'
				THEN 'N'
				WHEN COALESCE(MALMST.MALSTA,
				'NULL') = 'BKD'
				THEN 'N'
				ELSE 'Y'
				END ACP
				FROM MALCSGMST MST
				INNER JOIN MALMST MALMST
				ON MALMST.CMPCOD = MST.CMPCOD
				  AND MALMST.CSGDOCNUM = MST.CSGDOCNUM
				AND MALMST.CSGSEQNUM = MST.CSGSEQNUM
				AND MALMST.POACOD = MST.POACOD
				]]>
		</QRY:Source>
		</QRY:Definition>

	<QRY:Definition>
		<QRY:Id>169</QRY:Id>
		<QRY:Source Name="mail.operations.finddespatchesinflightulds" Type="NATIVE">
			<![CDATA[

					SELECT CON.CMPCOD,
					  CON.FLTCARIDR,
					  CON.FLTCARCOD,
					  CON.FLTNUM,
					  FLT.FLTDAT,
					  CON.CONNUM,
					  CON.CONNUM ULDNUM,
					  CON.FLTSEQNUM,
					  CON.LEGSERNUM,
					  CON.ASGPRT,
					  CON.DSTCOD,
					  CON.POU,
					  CON.CONTYP,
					  CON.SEGSERNUM,
					  MALMST.DSN,
					  MALMST.ORGEXGOFC,
					  MALMST.DSTEXGOFC,
					  MALMST.YER,
					  MALMST.MALCTG MALCTGCOD,
					  MALMST.MALSUBCLS,
					  MALMST.MALCLS,
					  MALMST.CSGDOCNUM CSGDOCNUM,
					  MALMST.CSGSEQNUM CSGSEQNUM,
					  MALMST.POACOD POACOD,
					  CSGMST.CSGDAT CSGDAT,
					  MALMST.DSPDAT ACPDAT,
					  CSG.ACPWGT CSGACPWGT,
					  CSG.ACPBAG CSGACPBAG,
					  CSG.STDBAG CSGSTDBAG,
					  CSG.STDWGT CSGSTDWGT,
					  NULL ACPUSR,
					  BKGMST.UBRNUM,
					  BKGMST.LSTUPDTIM BKGLSTUPDTIM,
					  FLTDTL.LSTUPDTIM BKGFLTUPDTIM
					FROM MALFLTCON CON
					INNER JOIN MALFLT FLT
					ON FLT.CMPCOD     = CON.CMPCOD
					AND FLT.FLTCARIDR = CON.FLTCARIDR
					AND FLT.FLTNUM    = CON.FLTNUM
					AND FLT.FLTSEQNUM = CON.FLTSEQNUM
					AND FLT.ARPCOD    = CON.ASGPRT
					INNER JOIN MALULDSEG DSN
					ON CON.CMPCOD     = DSN.CMPCOD
					AND CON.FLTCARIDR = DSN.FLTCARIDR
					AND CON.FLTNUM    = DSN.FLTNUM
					AND CON.FLTSEQNUM = DSN.FLTSEQNUM
					AND CON.SEGSERNUM = DSN.SEGSERNUM
					AND CON.CONNUM    = DSN.ULDNUM
					LEFT OUTER JOIN MALULDSEGDTL CSG
					ON DSN.CMPCOD     = CSG.CMPCOD
					AND DSN.FLTCARIDR = CSG.FLTCARIDR
					AND DSN.FLTNUM    = CSG.FLTNUM
					AND DSN.FLTSEQNUM = CSG.FLTSEQNUM
					AND DSN.SEGSERNUM = CSG.SEGSERNUM
					AND DSN.ULDNUM    = CSG.ULDNUM
					INNER JOIN MALMST MALMST
					ON MALMST.CMPCOD     = CSG.CMPCOD
					AND MALMST.MALSEQNUM = CSG.MALSEQNUM
					LEFT OUTER JOIN MALCSGMST CSGMST
					ON CSGMST.CMPCOD     = MALMST.CMPCOD
					AND CSGMST.CSGDOCNUM = MALMST.CSGDOCNUM
					AND CSGMST.POACOD    = MALMST.POACOD
					AND CSGMST.CSGSEQNUM = MALMST.CSGSEQNUM
					LEFT OUTER JOIN CAPBKGMST BKGMST
					ON ( BKGMST.CMPCOD = DSN.CMPCOD
					AND BKGMST.UBRNUM  =CSG.UBRNUM )
					LEFT OUTER JOIN CAPBKGFLTDTL FLTDTL
					ON ( FLTDTL.CMPCOD = BKGMST.CMPCOD
					AND FLTDTL.UBRNUM  = BKGMST.UBRNUM )
					WHERE MALMST.CMPCOD   = ?
					AND MALMST.ORGEXGOFC  = ?
					AND MALMST.DSTEXGOFC  = ?
					AND MALMST.DSN        = ?
					AND MALMST.MALCTG  = ?
					AND MALMST.MALSUBCLS  = ?
					AND MALMST.CONNUM     = ?
					AND CON.CONTYP='U'


			]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
		<QRY:Id>170</QRY:Id>
		<QRY:Source Name="mail.operations.finddespatchesinflightbulk" Type="NATIVE">
			<![CDATA[
					SELECT CON.CMPCOD,
					  CON.FLTCARIDR,
					  CON.FLTNUM,
					  CONCSG.ULDNUM ULDNUM,
					  CON.CONNUM,
					  CON.FLTSEQNUM,
					  CON.LEGSERNUM,
					  CON.ASGPRT,
					  CON.CONTYP,
					  CON.SEGSERNUM,
					  CON.DSTCOD,
					  MALMST.DSN,
					  MALMST.ORGEXGOFC,
					  MALMST.DSTEXGOFC,
					  MALMST.YER,
					  MALMST.MALCTG MALCTGCOD,
					  MALMST.MALSUBCLS,
					  MALMST.MALCLS,
					  MALMST.CSGDOCNUM CSGDOCNUM,
					  MALMST.CSGSEQNUM CSGSEQNUM,
					  MALMST.POACOD POACOD,
					  CSGMST.CSGDAT CSGDAT,
					  MALMST.DSPDAT ACPDAT,
					  CONCSG.ACPWGT CSGACPWGT,
					  CONCSG.ACPBAG CSGACPBAG,
					  CONCSG.STDBAG CSGSTDBAG,
					  CONCSG.STDWGT CSGSTDWGT,
					  NULL ACPUSR,
					  0 STDVOL,
					  BKGMST.UBRNUM,
					  BKGMST.LSTUPDTIM BKGLSTUPDTIM,
					  FLTDTL.LSTUPDTIM BKGFLTUPDTIM
					FROM MALFLTCON CON
					INNER JOIN MALULDSEG CONSEG
					ON CON.CMPCOD     = CONSEG.CMPCOD
					AND CON.FLTCARIDR = CONSEG.FLTCARIDR
					AND CON.FLTNUM    = CONSEG.FLTNUM
					AND CON.FLTSEQNUM = CONSEG.FLTSEQNUM
					AND CON.SEGSERNUM = CONSEG.SEGSERNUM
					LEFT OUTER JOIN MALULDSEGDTL CONCSG
					ON CONSEG.CMPCOD     = CONCSG.CMPCOD
					AND CONSEG.FLTCARIDR = CONCSG.FLTCARIDR
					AND CONSEG.FLTNUM    = CONCSG.FLTNUM
					AND CONSEG.FLTSEQNUM = CONCSG.FLTSEQNUM
					AND CONSEG.SEGSERNUM = CONCSG.SEGSERNUM
					AND CONSEG.ULDNUM    = CONCSG.ULDNUM
					AND CON.CONNUM = CONCSG.CONNUM
					INNER JOIN MALMST MALMST
					ON MALMST.CMPCOD     = CONCSG.CMPCOD
					AND MALMST.MALSEQNUM = CONCSG.MALSEQNUM
					LEFT OUTER JOIN MALCSGMST CSGMST
					ON CSGMST.CMPCOD     = MALMST.CMPCOD
					AND CSGMST.CSGDOCNUM = MALMST.CSGDOCNUM
					AND CSGMST.POACOD    = MALMST.POACOD
					AND CSGMST.CSGSEQNUM = MALMST.CSGSEQNUM
					LEFT OUTER JOIN CAPBKGMST BKGMST
					ON ( BKGMST.CMPCOD = CONSEG.CMPCOD
					AND BKGMST.UBRNUM  =CONCSG.UBRNUM )
					LEFT OUTER JOIN CAPBKGFLTDTL FLTDTL
					ON ( FLTDTL.CMPCOD   = BKGMST.CMPCOD
					AND FLTDTL.UBRNUM    = BKGMST.UBRNUM )
					WHERE CONCSG.CMPCOD  = ?
					AND MALMST.ORGEXGOFC = ?
					AND MALMST.DSTEXGOFC = ?
					AND MALMST.DSN       = ?
					AND MALMST.MALCTG    = ?
					AND MALMST.MALSUBCLS = ?
					AND CONCSG.CONNUM    = ?
					AND CON.CONTYP       ='B'

			]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
		<QRY:Id>171</QRY:Id>
		<QRY:Source Name="mail.operations.finddespatchesincarrierulds" Type="NATIVE">
			<![CDATA[
						SELECT MST.CMPCOD CMPCOD,
						  MST.CONNUM CONNUM,
						  MST.CONNUM ULDNUM,
						  MST.FLTCARIDR FLTCARIDR,
						  MST.FLTNUM FLTNUM,
						  MST.ASGPRT ASGPRT,
						  MST.FLTSEQNUM FLTSEQNUM,
						  MST.LEGSERNUM LEGSERNUM,
						  MST.SEGSERNUM SEGSERNUM,
						  MST.CONTYP,
						  MALMST.DSN,
						  MALMST.ORGEXGOFC,
						  MALMST.DSTEXGOFC,
						  MALMST.YER,
						  MALMST.MALCTG MALCTGCOD,
						  MALMST.MALSUBCLS,
						  MALMST.MALCLS,
						  MALMST.CSGDOCNUM CSGDOCNUM,
						  MALMST.CSGSEQNUM CSGSEQNUM,
						  MALMST.POACOD POACOD,
						  CSGMST.CSGDAT CSGDAT,
						  MALMST.DSPDAT ACPDAT,
						  CSG.ACPBAG CSGACPBAG,
						  CSG.ACPWGT CSGACPWGT,
						  CSG.STDBAG CSGSTDBAG,
						  CSG.STDWGT CSGSTDWGT,
						  NULL ACPUSR,
						 0 STDVOL,
						  0 STDWGT,
						  MALMST.DSPDAT ACPDAT,
						  CSG.ARPCOD
						FROM MALFLTCON MST
						INNER JOIN MALARPULD ARPULD
						ON MST.CMPCOD     = ARPULD.CMPCOD
						AND MST.CONNUM    = ARPULD.ULDNUM
						AND MST.ASGPRT    = ARPULD.ARPCOD
						AND MST.FLTCARIDR = ARPULD.FLTCARIDR
						LEFT OUTER JOIN MALARPULDDTL CSG
						ON ARPULD.CMPCOD     = CSG.CMPCOD
						AND ARPULD.ULDNUM    = CSG.ULDNUM
						AND ARPULD.ARPCOD    = CSG.ARPCOD
						AND ARPULD.FLTCARIDR = CSG.FLTCARIDR
						INNER JOIN MALMST MALMST
						ON MALMST.CMPCOD     = CSG.CMPCOD
						AND MALMST.MALSEQNUM = CSG.MALSEQNUM
						LEFT OUTER JOIN MALCSGMST CSGMST
						ON CSGMST.CMPCOD     = MALMST.CMPCOD
						AND CSGMST.CSGDOCNUM = MALMST.CSGDOCNUM
						AND CSGMST.POACOD    = MALMST.POACOD
						AND CSGMST.CSGSEQNUM = MALMST.CSGSEQNUM
						WHERE CSG.CMPCOD     =?
						AND MALMST.ORGEXGOFC    = ?
						AND MALMST.DSTEXGOFC    = ?
						AND MALMST.DSN          = ?
						AND MALMST.MALCTG    = ?
						AND MALMST.MALSUBCLS    = ?
						AND CSG.ULDNUM       = ?
						AND MST.CONTYP       ='U'

			]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
		<QRY:Id>172</QRY:Id>
		<QRY:Source Name="mail.operations.finddespatchesincarrierbulk" Type="NATIVE">
			<![CDATA[
					SELECT MST.CMPCOD CMPCOD,
					  MST.CONNUM CONNUM,
					  CSG.ULDNUM ULDNUM,
					  MST.FLTCARIDR FLTCARIDR,
					  MST.FLTNUM FLTNUM,
					  MST.ASGPRT ASGPRT,
					  MST.FLTSEQNUM FLTSEQNUM,
					  MST.LEGSERNUM LEGSERNUM,
					  MST.SEGSERNUM SEGSERNUM,
					  MST.CONTYP,
					  MST.DSTCOD,
					  MALMST.DSN,
					  MALMST.ORGEXGOFC,
					  MALMST.DSTEXGOFC,
					  MALMST.YER,
					  MALMST.MALCTG MALCTGCOD,
					  MALMST.MALSUBCLS,
					  MALMST.MALCLS,
					  MALMST.CSGDOCNUM CSGDOCNUM,
					  MALMST.CSGSEQNUM CSGSEQNUM,
					  MALMST.POACOD POACOD,
					  CSGMST.CSGDAT CSGDAT,
					  MALMST.DSPDAT ACPDAT,
					  CSG.ACPBAG CSGACPBAG,
					  CSG.ACPWGT CSGACPWGT,
					  CSG.STDBAG CSGSTDBAG,
					  CSG.STDWGT CSGSTDWGT,
					  NULL ACPUSR,
					  0 STDVOL,
					  MALMST.DSPDAT ACPDAT,
					  CSG.ARPCOD
					FROM MALFLTCON MST
					INNER JOIN MALARPULD CONARP
					ON MST.CMPCOD     = CONARP.CMPCOD
					AND MST.FLTCARIDR = CONARP.FLTCARIDR
					AND MST.ASGPRT    = CONARP.ARPCOD
					LEFT OUTER JOIN MALARPULDDTL CSG
					ON CONARP.FLTCARIDR = CSG.FLTCARIDR
					AND CONARP.ULDNUM   = CSG.ULDNUM
					AND CONARP.ARPCOD   = CSG.ARPCOD
					AND CONARP.CMPCOD   = CSG.CMPCOD
					AND MST.CONNUM      = CSG.CONNUM
					INNER JOIN MALMST MALMST
					ON MALMST.CMPCOD     = CSG.CMPCOD
					AND MALMST.MALSEQNUM = CSG.MALSEQNUM
					LEFT OUTER JOIN MALCSGMST CSGMST
					ON CSGMST.CMPCOD     = MALMST.CMPCOD
					AND CSGMST.CSGDOCNUM = MALMST.CSGDOCNUM
					AND CSGMST.POACOD    = MALMST.POACOD
					AND CSGMST.CSGSEQNUM = MALMST.CSGSEQNUM
					WHERE CSG.CMPCOD     = ?
					AND MALMST.ORGEXGOFC = ?
					AND MALMST.DSTEXGOFC = ?
					AND MALMST.DSN       = ?
					AND MALMST.MALCTG    = ?
					AND MALMST.MALSUBCLS = ?
					AND CSG.CONNUM       = ?
					AND MST.CONTYP       ='B'

			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>173</QRY:Id>
	<QRY:Source Name="mail.operations.findcontainersfordestination" Type="NATIVE">
		<![CDATA[

					SELECT MST.CMPCOD,
			  MST.CONNUM,
			  MST.FLTCARIDR,
			  MST.FLTNUM,
			  MST.FLTSEQNUM,
			  MST.LEGSERNUM,
			  MST.SEGSERNUM,
			  MST.ASGPRT,
			  MST.FLTCARCOD,
			  MST.ARRSTA,
			  MST.ACPFLG,
			  MST.POU,
			  MST.RMK,
			  MST.USRCOD,
			  MST.ASGDAT,
			  MST.POAFLG,
			  MST.CONTYP,
			  MST.DSTCOD,
			  MST.OFLFLG,
			  MST.INTFLG,
			  ULD.ACPBAG,
			  ULD.ACPWGT,
			  ULD.WHSCOD,
			  ULD.LOCCOD,
			  MST.LSTUPDTIM,
			  MST.LSTUPDUSR,
			  ULD.LSTUPDTIM AS ULDLSTUPDTIM,
			  ULD.LSTUPDUSR AS ULDLSTUPDUSR,
			  MST.CONJRNIDR,
			  MST.TRNFLG,
			  MST.POACOD SBCODE
			FROM MALFLTCON MST
			LEFT OUTER JOIN MALARPULD ULD
			ON MST. CMPCOD    = ULD.CMPCOD
			AND MST.ASGPRT    = ULD.ARPCOD
			AND MST.FLTCARIDR = ULD.FLTCARIDR
			AND MST.CONNUM    = ULD.ULDNUM
			WHERE MST.CMPCOD  = ?
			AND MST.FLTCARIDR = ?
			AND MST.ASGPRT    = ?
			AND MST.TXNCOD    = 'ASG'
			AND MST.FLTNUM    = '-1'




	]]>
	</QRY:Source>
	</QRY:Definition>

<QRY:Definition>
<QRY:Id>174</QRY:Id>
<QRY:Source Name="mail.operations.findsumfordestination" Type="NATIVE">
	<![CDATA[

SELECT SUM (DTL.ACPBAG) ACPBAG,
  SUM (DTL.ACPWGT) ACPWGT,
  ULD.ULDNUM CONNUM,
  ULD.LOCCOD
FROM MALARPULD ULD,
  MALARPULDDTL DTL
WHERE ULD.CMPCOD  = DTL.CMPCOD
AND ULD.FLTCARIDR = DTL.FLTCARIDR
AND ULD.ARPCOD    =DTL.ARPCOD
AND ULD.ULDNUM    =DTL.ULDNUM
AND DTL.CMPCOD    = ?
AND ULD.ARPCOD    = ?
AND ULD.FLTCARIDR = ?
AND DTL.CONNUM    = ?
GROUP BY ULD.ULDNUM,
  ULD.LOCCOD

	]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>174</QRY:Id>
<QRY:Source Name="mail.operations.findcontainersforflight" Type="NATIVE">
	<![CDATA[
			SELECT MST.CMPCOD,
		  MST.CONNUM,
		  MST.FLTCARIDR,
		  MST.FLTNUM,
		  MST.FLTSEQNUM,
		  MST.LEGSERNUM,
		  MST.SEGSERNUM,
		  MST.ASGPRT,
		  MST.POU,
		  MST.RMK,
		  MST.USRCOD,
		  MST.ARRSTA,
		  MST.ASGDAT,
		  MST.POAFLG,
		  MST.DSTCOD,
		  MST.CONTYP,
		  MST.FLTCARCOD,
		  MST.ACPFLG,
		  MST.TRNFLG,
		  MST.OFLFLG,
		  TO_CHAR (RTG.ONWFLTDAT, 'DD-Mon-YYYY' ) ONWFLTDAT,
		  RTG.ONWFLTNUM,
		  RTG.POU RTGPOU,
		  RTG.RTGSERNUM,
		  RTG.ONWFLTCARCOD,
		  RTG.FLTCARIDR RTGFLTCARIDR,
		  RTG.ONWFLTCARIDR,
		  SUM(SEGDTL.ACPBAG) BAGCNT,
		  SUM(SEGDTL.ACPWGT) BAGWGT,
		  SEG.WHSCOD,
		  SEG.LOCCOD,
		  FLT.FLTDAT,
		  MST.LSTUPDTIM,
		  SEG.LSTUPDTIM AS ULDLSTUPDTIM,
		  SEG.LSTUPDUSR AS ULDLSTUPDUSR,
		  MST.CONJRNIDR,
		  MST.POACOD SBCODE
		FROM MALFLTCON MST
		LEFT OUTER JOIN MALFLTCONRTG RTG
		ON MST.CMPCOD     = RTG.CMPCOD
		AND MST.CONNUM    = RTG.CONNUM
		AND MST.ASGPRT    = RTG.ASGPRT
		AND MST.FLTCARIDR = RTG.FLTCARIDR
		AND MST.FLTNUM    = RTG.FLTNUM
		AND MST.FLTSEQNUM = RTG.FLTSEQNUM
		AND MST.LEGSERNUM = RTG.LEGSERNUM
		LEFT OUTER JOIN MALULDSEG SEG
		ON MST.CMPCOD     = SEG.CMPCOD
		AND MST.CONNUM    = SEG.ULDNUM
		AND MST.FLTCARIDR = SEG.FLTCARIDR
		AND MST.FLTNUM    = SEG.FLTNUM
		AND MST.FLTSEQNUM = SEG.FLTSEQNUM
		AND MST.SEGSERNUM = SEG.SEGSERNUM
		LEFT OUTER JOIN MALULDSEGDTL SEGDTL
		ON MST.CMPCOD     = SEGDTL.CMPCOD
		AND MST.CONNUM    = SEGDTL.CONNUM
		AND MST.FLTCARIDR = SEGDTL.FLTCARIDR
		AND MST.FLTNUM    = SEGDTL.FLTNUM
		AND MST.FLTSEQNUM = SEGDTL.FLTSEQNUM
		AND MST.SEGSERNUM = SEGDTL.SEGSERNUM
		INNER JOIN MALFLT FLT
		ON MST.FLTCARIDR     = FLT.FLTCARIDR
		AND MST.FLTNUM       = FLT.FLTNUM
		AND MST.FLTSEQNUM    = FLT.FLTSEQNUM
		AND MST.LEGSERNUM    = FLT.LEGSERNUM
		AND MST.ASGPRT       = FLT.ARPCOD
		WHERE MST.CMPCOD     = ?
		AND MST.FLTCARIDR    = ?
		AND MST.FLTNUM       = ?
		AND MST.FLTSEQNUM    = ?
		AND MST.ASGPRT       = ?
		AND NOT ((MST.ACPFLG = 'N'
		OR MST.ACPFLG       IS NULL)
		AND MST.ARRSTA       = 'Y')
		GROUP BY MST.CMPCOD, MST.CONNUM, MST.FLTCARIDR, MST.FLTNUM, MST.FLTSEQNUM,
		MST.LEGSERNUM, MST.SEGSERNUM, MST.ASGPRT, MST.RMK, MST.POU,
		MST.USRCOD, MST.ARRSTA, MST.ASGDAT, MST.POAFLG, MST.DSTCOD,
		MST.CONTYP, MST.FLTCARCOD, MST.ACPFLG, MST.TRNFLG, MST.OFLFLG,RTG.ONWFLTDAT,
		RTG.ONWFLTNUM, RTG.POU, RTG.RTGSERNUM, RTG.ONWFLTCARCOD,
		RTG.FLTCARIDR, RTG.ONWFLTCARIDR, SEG.WHSCOD, SEG.LOCCOD, FLT.FLTDAT,
		MST.LSTUPDTIM, SEG.LSTUPDTIM, SEG.LSTUPDUSR, MST.CONJRNIDR, MST.POACOD
		ORDER BY MST.CMPCOD,
		  MST.CONNUM,
		  MST.ASGPRT,
		  MST.FLTCARIDR,
		  MST.FLTNUM,
		  MST.FLTSEQNUM,
		  MST.LEGSERNUM,
		  RTG.RTGSERNUM
]]>
</QRY:Source>
</QRY:Definition>

	<QRY:Definition>
		<QRY:Id>175</QRY:Id>
		<QRY:Source Name="mail.operations.findbookingtimefordsnsincontainer" Type="NATIVE">
			<![CDATA[
						SELECT MST.CMPCOD,
			  MST.CONNUM,
			  MST.FLTCARIDR,
			  MST.FLTNUM,
			  MST.FLTSEQNUM,
			  MST.LEGSERNUM,
  MST.SEGSERNUM

			FROM MALFLTCON MST
			LEFT OUTER JOIN MALULDSEG ULDSEG
			ON ( ULDSEG.CMPCOD   = MST.CMPCOD
			AND ULDSEG.ULDNUM    = MST.CONNUM
			AND ULDSEG.FLTCARIDR = MST.FLTCARIDR
			AND ULDSEG.FLTNUM    = MST.FLTNUM
			AND ULDSEG.FLTSEQNUM = MST.FLTSEQNUM
			AND ULDSEG.SEGSERNUM = MST.SEGSERNUM )
			LEFT OUTER JOIN MALULDSEGDTL CONSEG
			ON ( CONSEG.CMPCOD   = MST.CMPCOD
			AND CONSEG.CONNUM    = MST.CONNUM
			AND CONSEG.SEGSERNUM = MST.SEGSERNUM
			AND CONSEG.FLTCARIDR = MST.FLTCARIDR
			AND CONSEG.FLTNUM    = MST.FLTNUM
			AND CONSEG.FLTSEQNUM = MST.FLTSEQNUM )



			]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>176</QRY:Id>
	<QRY:Source Name="mail.operations.findsumforflight" Type="NATIVE">
		<![CDATA[

			SELECT SUM (ULDDTL.ACPWGT) ACPWGT,
			  SUM (ULDDTL.ACPBAG) ACPBAG,
			  SUM (ULDDTL.RCVWGT) RCVWGT,
			  SUM (ULDDTL.RCVBAG) RCVBAG,
			  ULD.ULDNUM CONNUM,
			  ULD.LOCCOD
			FROM MALULDSEG ULD
			INNER JOIN MALULDSEGDTL ULDDTL
			ON ULD.CMPCOD     = ULDDTL.CMPCOD
			AND ULD.FLTCARIDR = ULDDTL.FLTCARIDR
			AND ULD.FLTNUM    = ULDDTL.FLTNUM
			AND ULD.FLTSEQNUM = ULDDTL.FLTSEQNUM
			AND ULD.SEGSERNUM = ULDDTL.SEGSERNUM
			AND ULD.ULDNUM    = ULDDTL.ULDNUM
			WHERE ULD.CMPCOD  = ?
			AND ULD.ULDNUM = ?
			AND ULD.FLTCARIDR = ?
			AND ULD.FLTNUM    = ?
			AND ULD.FLTSEQNUM = ?
			AND ULD.SEGSERNUM = ?
			GROUP BY ULD.ULDNUM,
  			ULD.LOCCOD
		]]>
	</QRY:Source>
	</QRY:Definition>

		<QRY:Definition>
	<QRY:Id>177</QRY:Id>
	<QRY:Source Name="mail.operations.findDSNMailbagManifest" Type="NATIVE">
		<![CDATA[
				SELECT FLT.CMPCOD,
				  FLT.FLTCARIDR,
				  FLT.FLTNUM,
				  FLT.FLTSEQNUM,
				  FLT.POL,
				  FLT.POU,
				  ULD.ULDNUM,
				  ULD.SEGSERNUM,
				  ULD.BAGCNT,
				  ULD.BAGWGT,
				  ULD.RCVBAG,
				  ULD.RCVWGT,
				  MALMST.DSN,
				  MALMST.ORGEXGOFC,
				  MALMST.DSTEXGOFC,
				  MALMST.MALCLS,
				  MALMST.YER,
				  MALMST.MALSUBCLS,
				  MALMST.MALCTG MALCTGCOD,
				  DSN.ACPBAG,
				  MALMST.SHPPFX DOCOWRCOD,
				  MALMST.DOCOWRIDR,
				  MALMST.MSTDOCNUM,
				  DSN.ACPWGT,
				  DSN.ULDNUM,
							  (
								  CASE
									WHEN MALMST.MALTYP = 'M'
									THEN 'Y'
									ELSE 'N'
								  END) AS PLTENBFLG,
				  MALMST.MALIDR,
				  DSN.WGT MALWGT,
				  CON.POAFLG,
				  CTY1.SRVARPCOD ORG,
				  CTY2.SRVARPCOD DST,
				  DSN.SCNDAT
				FROM MALFLTSEG FLT
				INNER JOIN MALULDSEG ULD
				ON FLT.FLTCARIDR  = ULD.FLTCARIDR
				AND FLT.FLTNUM    = ULD.FLTNUM
				AND FLT.FLTSEQNUM = ULD.FLTSEQNUM
				AND FLT.SEGSERNUM = ULD.SEGSERNUM
				AND FLT.CMPCOD    = ULD.CMPCOD
				LEFT OUTER JOIN MALFLTCON CON
				ON ULD.CMPCOD     = CON.CMPCOD
				AND ULD.FLTCARIDR = CON.FLTCARIDR
				AND ULD.FLTNUM    = CON.FLTNUM
				AND ULD.FLTSEQNUM = CON.FLTSEQNUM
				AND ULD.SEGSERNUM = CON.SEGSERNUM
				LEFT OUTER JOIN MALULDSEGDTL DSN
				ON ULD.CMPCOD     = DSN.CMPCOD
				AND ULD.FLTCARIDR = DSN.FLTCARIDR
				AND ULD.FLTNUM    = DSN.FLTNUM
				AND ULD.FLTSEQNUM = DSN.FLTSEQNUM
				AND ULD.SEGSERNUM = DSN.SEGSERNUM
				AND ULD.ULDNUM    = DSN.ULDNUM
				AND DSN.CONNUM    = CON.CONNUM
				LEFT OUTER JOIN MALMST MALMST
				ON MALMST.CMPCOD     = DSN.CMPCOD
				AND MALMST.MALSEQNUM = DSN.MALSEQNUM
				LEFT OUTER JOIN MALEXGOFCMST ORGEXG
				ON ORGEXG.CMPCOD     = MALMST.CMPCOD
				AND ORGEXG.EXGOFCCOD = MALMST.ORGEXGOFC
				LEFT OUTER JOIN SHRCTYMST CTY1
				ON CTY1.CMPCOD  = ORGEXG.CMPCOD
				AND CTY1.CTYCOD = ORGEXG.CTYCOD
				LEFT OUTER JOIN MALEXGOFCMST DSTEXG
				ON DSTEXG.CMPCOD     = MALMST.CMPCOD
				AND DSTEXG.EXGOFCCOD = MALMST.DSTEXGOFC
				LEFT OUTER JOIN SHRCTYMST CTY2
				ON CTY2.CMPCOD    = DSTEXG.CMPCOD
				AND CTY2.CTYCOD   = DSTEXG.CTYCOD
				WHERE DSN.ACPSTA  ='Y'
				AND FLT.CMPCOD    = ?
				AND FLT.FLTCARIDR = ?
				AND FLT.FLTNUM    = ?
				AND FLT.FLTSEQNUM = ?
				AND FLT.POL       = ?
				ORDER BY ULD.ULDNUM,
				  ULD.SEGSERNUM,
				  MALMST.DSN,
				  MALMST.ORGEXGOFC,
				  MALMST.DSTEXGOFC,
				  MALMST.YER,
				  MALMST.MALSUBCLS,
				  MALMST.MALCTG,
				  MALMST.MALIDR

	]]>
	</QRY:Source>
	</QRY:Definition>

<QRY:Definition>
	<QRY:Id>178</QRY:Id>
	<QRY:Source Name="mail.operations.findawbmanifestdetails" Type="NATIVE">
	<![CDATA[
				SELECT FLT.POL,
			  FLT.POU,
			  ULD.ULDNUM,
        UMST.TARWGT,
			  ULD.SEGSERNUM,
			 MALMST.DOCOWRIDR,
			 MALMST.SEQNUM,
			 MALMST.DUPNUM,
			 MALMST.MSTDOCNUM,
			   MALMST.SHPPFX,
			  OPRMST.SCCCOD,
			  OPRMST.SHPDES,
			  COALESCE(SUM (DSN.ACPBAG),0) CONBAGCNT,
			  COALESCE(SUM (DSN.ACPWGT),0) CONBAGWGT,
			  OPRMST.STDPCS SHPPCS,
			  OPRMST.STDWGT SHPWGT,
			  OPRMST.GRSDISVOL SHPVOL,
				COALESCE(SUM (DSN.ACPBAG),0) ACPBAG,
				COALESCE(SUM (DSN.ACPWGT),0) ACPWGT,
				COALESCE(SUM (DSN.STDBAG),0) STDBAG,
				COALESCE(SUM (DSN.STDWGT),0) STDWGT,

			0 ACPVOL,
			  CTY1.SRVARPCOD ORG,
			  CTY2.SRVARPCOD DST,
			  CON.POAFLG,
        CON.CONTYP,OPRSEGULD.ULDCTR
			FROM MALFLTSEG FLT
			INNER JOIN MALULDSEG ULD
			ON FLT.CMPCOD     = ULD.CMPCOD
			AND FLT.FLTCARIDR = ULD.FLTCARIDR
			AND FLT.FLTNUM    = ULD.FLTNUM
			AND FLT.FLTSEQNUM = ULD.FLTSEQNUM
			AND FLT.SEGSERNUM = ULD.SEGSERNUM
			LEFT OUTER JOIN MALULDSEGDTL DSN
			ON ULD.CMPCOD     = DSN.CMPCOD
			AND ULD.FLTCARIDR = DSN.FLTCARIDR
			AND ULD.FLTNUM    = DSN.FLTNUM
			AND ULD.FLTSEQNUM = DSN.FLTSEQNUM
			AND ULD.SEGSERNUM = DSN.SEGSERNUM
			AND ULD.ULDNUM    = DSN.ULDNUM
			INNER JOIN MALFLTCON CON
			ON ULD.CMPCOD     = CON.CMPCOD
			AND ULD.FLTCARIDR = CON.FLTCARIDR
			AND ULD.FLTNUM    = CON.FLTNUM
			AND ULD.FLTSEQNUM = CON.FLTSEQNUM
			AND ULD.SEGSERNUM = CON.SEGSERNUM
			AND DSN.CONNUM    = CON.CONNUM
			LEFT OUTER JOIN MALMST MALMST
			ON MALMST.CMPCOD = DSN.CMPCOD
			AND MALMST.MALSEQNUM    = DSN.MALSEQNUM
			LEFT OUTER JOIN MALEXGOFCMST ORGEXG
			ON ORGEXG.CMPCOD     = MALMST.CMPCOD
			AND ORGEXG.EXGOFCCOD = MALMST.ORGEXGOFC
			LEFT OUTER JOIN SHRCTYMST CTY1
			ON CTY1.CMPCOD  = ORGEXG.CMPCOD
			AND CTY1.CTYCOD = ORGEXG.CTYCOD
			LEFT OUTER JOIN MALEXGOFCMST DSTEXG
			ON DSTEXG.CMPCOD     = MALMST.CMPCOD
			AND DSTEXG.EXGOFCCOD = MALMST.DSTEXGOFC
			LEFT OUTER JOIN SHRCTYMST CTY2
			ON CTY2.CMPCOD  = DSTEXG.CMPCOD
			AND CTY2.CTYCOD = DSTEXG.CTYCOD
			LEFT OUTER JOIN OPRSHPMST OPRMST
			ON OPRMST.CMPCOD     = DSN.CMPCOD
			AND OPRMST.DOCOWRIDR = MALMST.DOCOWRIDR
			AND OPRMST.MSTDOCNUM = MALMST.MSTDOCNUM
			AND OPRMST.DUPNUM    = MALMST.DUPNUM
			AND OPRMST.SEQNUM    = MALMST.SEQNUM
			    LEFT OUTER JOIN OPRSEGULD OPRSEGULD
            ON ULD.CMPCOD     = OPRSEGULD.CMPCOD
			AND ULD.FLTCARIDR = OPRSEGULD.FLTCARIDR
			AND ULD.FLTNUM    = OPRSEGULD.FLTNUM
			AND ULD.FLTSEQNUM = OPRSEGULD.FLTSEQNUM
			AND ULD.SEGSERNUM = OPRSEGULD.SEGSERNUM
			AND ULD.ULDNUM    = OPRSEGULD.ULDNUM

      LEFT OUTER JOIN ULDMST UMST
      ON ULD.CMPCOD = UMST.CMPCOD
      AND ULD.ULDNUM = UMST.ULDNUM
			WHERE FLT.CMPCOD     = ?
			AND FLT.FLTCARIDR    = ?
			AND FLT.FLTNUM       = ?
			AND FLT.FLTSEQNUM    = ?
			AND FLT.POL          = ?
			GROUP BY FLT.POL,
			  FLT.POU,
			  ULD.ULDNUM,
        UMST.TARWGT,
			  ULD.SEGSERNUM,
			MALMST.DOCOWRIDR,
			MALMST.SEQNUM,
			MALMST.DUPNUM,
			MALMST.MSTDOCNUM,
			  MALMST.SHPPFX,
			  CTY1.SRVARPCOD,
			  CTY2.SRVARPCOD,
			  CON.POAFLG,
			  OPRMST.SCCCOD,
			  OPRMST.SHPDES,
			  ULD.BAGCNT,
			  ULD.BAGWGT,
			  OPRMST.STDPCS,
			  OPRMST.STDWGT,
			  OPRMST.GRSDISVOL,
        CON.CONTYP,OPRSEGULD.ULDCTR
			ORDER BY ULD.ULDNUM,
			  ULD.SEGSERNUM,
			  MALMST.DOCOWRIDR,
			  MALMST.SEQNUM,
			  MALMST.DUPNUM,
			  MALMST.MSTDOCNUM
	]]>
	</QRY:Source>
</QRY:Definition>
<QRY:Definition>
	<QRY:Id>179</QRY:Id>
	<QRY:Source Name="mail.operations.findmailbagmanifestdetails" Type="NATIVE">
		<![CDATA[
			SELECT FLT.CMPCOD,
			  FLT.FLTCARIDR,
			  FLT.FLTNUM,
			  FLT.FLTSEQNUM,
			  FLT.SEGSERNUM,
			  ULD.ULDNUM,
			  MALMST.MALIDR,
			  MALMST.MALCLS,
			  FLT.POL,
			  FLT.POU,
			  ULD.BAGCNT,
			  ULD.BAGWGT,
			  MALMST.DMGFLG,
			  MALMST.SCNDAT,
			  MALMST.RSN,
			  MALMST.HSN,
			  MALMST.REGIND,
			  MALMST.WGT AS MALWGT,
			  MALMST.DSPWGTUNT,
			  CON.POAFLG,
			  MALMST.ORGCOD,
			  MALMST.DSTCOD
			FROM MALFLTSEG FLT
			INNER JOIN MALULDSEG ULD
			ON FLT.CMPCOD     = ULD.CMPCOD
			AND FLT.FLTCARIDR = ULD.FLTCARIDR
			AND FLT.FLTNUM    = ULD.FLTNUM
			AND FLT.FLTSEQNUM = ULD.FLTSEQNUM
			AND FLT.SEGSERNUM = ULD.SEGSERNUM
			LEFT OUTER JOIN MALFLTCON CON
			ON ULD.CMPCOD     = CON.CMPCOD
			AND ULD.FLTCARIDR = CON.FLTCARIDR
			AND ULD.FLTNUM    = CON.FLTNUM
			AND ULD.FLTSEQNUM = CON.FLTSEQNUM
			AND ULD.SEGSERNUM = CON.SEGSERNUM
			LEFT OUTER JOIN MALULDSEGDTL MAL
			ON MAL.CMPCOD     = ULD.CMPCOD
			AND MAL.FLTCARIDR = ULD.FLTCARIDR
			AND MAL.FLTNUM    = ULD.FLTNUM
			AND MAL.FLTSEQNUM = ULD.FLTSEQNUM
			AND MAL.SEGSERNUM = ULD.SEGSERNUM
			AND MAL.ULDNUM    = ULD.ULDNUM
			AND MAL.CONNUM    = CON.CONNUM
			LEFT OUTER JOIN MALMST MALMST
			ON MAL.CMPCOD     = MALMST.CMPCOD
			AND MAL.MALSEQNUM = MALMST.MALSEQNUM
			WHERE MAL.ACPSTA  ='Y'
			AND FLT.CMPCOD    = ?
			AND FLT.FLTCARIDR = ?
			AND FLT.FLTNUM    = ?
			AND FLT.FLTSEQNUM = ?
			AND FLT.POL       = ?
			ORDER BY ULD.ULDNUM,
			  ULD.SEGSERNUM
		]]>
	</QRY:Source>
</QRY:Definition>

<QRY:Definition>
	<QRY:Id>180</QRY:Id>
	<QRY:Source Name="mail.operations.finddestnctgmanifestdetails" Type="NATIVE">
	<![CDATA[
			SELECT FLT.CMPCOD,
			  FLT.FLTCARIDR,
			  FLT.FLTNUM,
			  FLT.FLTSEQNUM,
			  FLT.SEGSERNUM,
			  ULD.ULDNUM,
			  MALMST.DSTEXGOFC,
			  MALMST.MALCTG MALCTGCOD,
			  FLT.POL,
			  FLT.POU,
			  ULD.BAGCNT,
			  ULD.BAGWGT,
			  DSN.ACPBAG,
			  DSN.ACPWGT,
			  DSN.STDBAG,
			  DSN.STDWGT,
			  (
			  CASE
				WHEN MALMST.MALTYP = 'M'
				THEN 'Y'
				ELSE 'N'
			  END) AS PLTENBFLG,
			  ORGPA.POANAM ORGPOA,
			  DSTPA.POANAM DSTPOA,
			  MALMST.MALCLS,
			  CON.POAFLG,
			  ORGOFC.CTYCOD ORGCTY,
			  DSTOFC.CTYCOD DSTCTY
			FROM MALFLTSEG FLT
			INNER JOIN MALULDSEG ULD
			ON FLT.CMPCOD     = ULD.CMPCOD
			AND FLT.FLTCARIDR = ULD.FLTCARIDR
			AND FLT.FLTNUM    = ULD.FLTNUM
			AND FLT.FLTSEQNUM = ULD.FLTSEQNUM
			AND FLT.SEGSERNUM = ULD.SEGSERNUM
			LEFT OUTER JOIN MALFLTCON CON
			ON ULD.CMPCOD     = CON.CMPCOD
			AND ULD.FLTCARIDR = CON.FLTCARIDR
			AND ULD.FLTNUM    = CON.FLTNUM
			AND ULD.FLTSEQNUM = CON.FLTSEQNUM
			AND ULD.SEGSERNUM = CON.SEGSERNUM
			AND ULD.ULDNUM    = CON.CONNUM
			LEFT OUTER JOIN MALULDSEGDTL DSN
			ON ULD.CMPCOD     = DSN.CMPCOD
			AND ULD.FLTCARIDR = DSN.FLTCARIDR
			AND ULD.FLTNUM    = DSN.FLTNUM
			AND ULD.FLTSEQNUM = DSN.FLTSEQNUM
			AND ULD.SEGSERNUM = DSN.SEGSERNUM
			AND ULD.ULDNUM    = DSN.ULDNUM
			LEFT OUTER JOIN MALMST MALMST
			ON DSN.CMPCOD     = MALMST.CMPCOD
			AND DSN.MALSEQNUM = MALMST.MALSEQNUM
			LEFT OUTER JOIN MALEXGOFCMST ORGOFC
			ON MALMST.CMPCOD     = ORGOFC.CMPCOD
			AND MALMST.ORGEXGOFC = ORGOFC.EXGOFCCOD
			LEFT OUTER JOIN MALPOAMST ORGPA
			ON ORGOFC.CMPCOD  = ORGPA.CMPCOD
			AND ORGOFC.POACOD = ORGPA.POACOD
			LEFT OUTER JOIN MALEXGOFCMST DSTOFC
			ON MALMST.CMPCOD     = DSTOFC.CMPCOD
			AND MALMST.DSTEXGOFC = DSTOFC.EXGOFCCOD
			LEFT OUTER JOIN MALPOAMST DSTPA
			ON DSTOFC.CMPCOD  = DSTPA.CMPCOD
			AND DSTOFC.POACOD = DSTPA.POACOD
			WHERE FLT.CMPCOD  = ?
			AND FLT.FLTCARIDR = ?
			AND FLT.FLTNUM    = ?
			AND FLT.FLTSEQNUM = ?
			AND FLT.POL       = ?
			ORDER BY ULD.ULDNUM,
			  ULD.SEGSERNUM,
			  MALMST.DSTEXGOFC,
			  MALMST.MALCLS,
			  MALMST.MALCTG
	]]>
	</QRY:Source>
</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>181</QRY:Id>
	<QRY:Source Name="mail.operations.finddamagemailreport" Type="NATIVE">
		<![CDATA[
					SELECT DMG.ARPCOD,
					  MST.MALIDR,
					  MST.DSTEXGOFC,
					  MST.ORGEXGOFC,
					  MST.DSN,
					  DMG.DMGDAT,
					  DMG.DMGCOD,
					  DMG.DMGDES,
					  DMG.RMK,
					  MST.FLTNUM,
					  ARL.TWOAPHCOD,
					  OPRMST.FLTDAT,
					  SUBSTR(OPRMST.FLTROU,0,4) POL,
					  OPRMST.FLTROU POU,
					  DMG.POACOD,
					  MST.MALSUBCLS,
					  CLSMST.SUBCLSGRP,
					  CLSMST.SUBCLSCOD,
					  CSGMAL.DCLVAL,
					  CASE
					  WHEN COALESCE(csgmal.dclval,0)=0
				      THEN 0
					  ELSE pkg_frmwrk.fun_convcurr (csgmal.cmpcod, csgmal.curcod,
					  (SELECT parval
					  FROM shrsyspar par
					  WHERE par.cmpcod = dmg.cmpcod
					  AND par.parcod   = 'shared.airline.basecurrency'
					  ), 'D', dmg.dmgdat, csgmal.dclval)
					  END dclvalconverted, 
					  (SELECT PARVAL
					  FROM SHRSYSPAR PAR
					  WHERE PAR.CMPCOD = DMG.CMPCOD
					  AND PAR.PARCOD   ='shared.airline.basecurrency'
					  )TOTDCLVALCUR,
					  CSGMAL.CURCOD,
					  MST.WGT
					FROM MALDMGDTL DMG
					INNER JOIN MALMST MST
					ON DMG.CMPCOD     = MST.CMPCOD
					AND DMG.MALSEQNUM    = MST.MALSEQNUM
					LEFT OUTER JOIN FLTOPRMST OPRMST
					ON MST.CMPCOD          = OPRMST.CMPCOD
					AND MST.FLTCARIDR      = OPRMST.FLTCARIDR
					AND MST.FLTNUM         = OPRMST.FLTNUM
					AND MST.FLTSEQNUM      = OPRMST.FLTSEQNUM
					AND OPRMST.FLTSTA NOT IN ('TBA','TBC','CAN')
					LEFT OUTER JOIN MALSUBCLSMST CLSMST
					ON MST.MALSUBCLS = CLSMST.SUBCLSCOD
					AND MST.CMPCOD   = CLSMST.CMPCOD
					LEFT OUTER JOIN MALCSGDTL CSGMAL
					ON MST.CMPCOD  = CSGMAL.CMPCOD
					AND MST.MALSEQNUM = CSGMAL.MALSEQNUM
					LEFT OUTER JOIN SHRARLMST ARL
					ON MST.CMPCOD     = ARL.CMPCOD
					AND MST.FLTCARIDR = ARL.ARLIDR
		]]>
	</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>182</QRY:Id>
	<QRY:Source Name="mail.operations.finddestnctgmanifestsummarydetails" Type="NATIVE">
		<![CDATA[
				SELECT
				  (SELECT CTYCOD
				  FROM MALEXGOFCMST
				  WHERE CMPCOD  = DSN.CMPCOD
				  AND EXGOFCCOD = MALMST.DSTEXGOFC
				  ) AS DST,
				  MALMST.MALCTG MALCTGCOD,
				  MALMST.MALCLS,
				  SUM ( DSN.ACPBAG) ACPBAGS,
				  SUM ( DSN.ACPWGT) ACPWGT
				FROM MALFLTSEG FLT
				INNER JOIN MALULDSEGDTL DSN
				ON FLT.CMPCOD     = DSN.CMPCOD
				AND FLT.FLTCARIDR = DSN.FLTCARIDR
				AND FLT.FLTNUM    = DSN.FLTNUM
				AND FLT.FLTSEQNUM = DSN.FLTSEQNUM
				AND FLT.SEGSERNUM = DSN.SEGSERNUM
				INNER JOIN MALMST MALMST
				ON MALMST.CMPCOD     = DSN.CMPCOD
				AND MALMST.MALSEQNUM = DSN.MALSEQNUM
				WHERE FLT.CMPCOD     = ?
				AND FLT.FLTCARIDR    = ?
				AND FLT.FLTNUM       = ?
				AND FLT.FLTSEQNUM    = ?
				AND FLT.POL          = ?
				GROUP BY DSN.CMPCOD,
				  MALMST.DSTEXGOFC,
				  MALMST.MALCLS,
				  MALMST.MALCTG
				ORDER BY DST,
				  MALMST.MALCLS,
				  MALMST.MALCTG
			]]>
	</QRY:Source>
	</QRY:Definition>

<QRY:Definition>
		<QRY:Id>183</QRY:Id>
			<QRY:Source Name="mail.operations.findawbdetailsforflight" Type="NATIVE">
				<![CDATA[
					SELECT
				  MALMST.DOCOWRIDR,
				  MALMST.SEQNUM,
				  MALMST.DUPNUM,
				  MALMST.MSTDOCNUM,
				  SUM ( DSN.ACPBAG) ACPBAG,
				  SUM ( ACPWGT) ACPWGT,
				  CTY1.SRVARPCOD ORG,
				  CTY2.SRVARPCOD DST
				FROM MALFLTSEG FLT
				INNER JOIN MALULDSEG ULD
				ON FLT.CMPCOD     = ULD.CMPCOD
				AND FLT.FLTCARIDR = ULD.FLTCARIDR
				AND FLT.FLTNUM    = ULD.FLTNUM
				AND FLT.FLTSEQNUM = ULD.FLTSEQNUM
				AND FLT.SEGSERNUM = ULD.SEGSERNUM
				LEFT OUTER JOIN MALULDSEGDTL DSN
				ON ULD.CMPCOD     = DSN.CMPCOD
				AND ULD.FLTCARIDR = DSN.FLTCARIDR
				AND ULD.FLTNUM    = DSN.FLTNUM
				AND ULD.FLTSEQNUM = DSN.FLTSEQNUM
				AND ULD.SEGSERNUM = DSN.SEGSERNUM
				AND ULD.ULDNUM    = DSN.ULDNUM
				INNER JOIN MALMST MALMST
				ON MALMST.CMPCOD     = DSN.CMPCOD
				AND MALMST.MALSEQNUM = MALMST.MALSEQNUM
				LEFT OUTER JOIN MALEXGOFCMST ORGEXG
				ON ORGEXG.CMPCOD     = DSN.CMPCOD
				AND ORGEXG.EXGOFCCOD = MALMST.ORGEXGOFC
				LEFT OUTER JOIN SHRCTYMST CTY1
				ON CTY1.CMPCOD  = ORGEXG.CMPCOD
				AND CTY1.CTYCOD = ORGEXG.CTYCOD
				LEFT OUTER JOIN MALEXGOFCMST DSTEXG
				ON DSTEXG.CMPCOD     = DSN.CMPCOD
				AND DSTEXG.EXGOFCCOD = MALMST.DSTEXGOFC
				LEFT OUTER JOIN SHRCTYMST CTY2
				ON CTY2.CMPCOD    = DSTEXG.CMPCOD
				AND CTY2.CTYCOD   = DSTEXG.CTYCOD
				WHERE FLT.CMPCOD  = ?
				AND FLT.FLTCARIDR = ?
				AND FLT.FLTNUM    = ?
				AND FLT.FLTSEQNUM = ?
				AND FLT.POL       = ?
				AND MALMST.DOCOWRIDR > 0
				GROUP BY
				 MALMST.DOCOWRIDR,
				 MALMST.SEQNUM,
				 MALMST.DUPNUM,
				 MALMST.MSTDOCNUM,
				  CTY1.SRVARPCOD,
				  CTY2.SRVARPCOD
				ORDER BY
				 MALMST.DOCOWRIDR,
				 MALMST.SEQNUM,
				 MALMST.DUPNUM,
				 MALMST.MSTDOCNUM
			  ]]>
			 </QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
<QRY:Id>184</QRY:Id>
<QRY:Source Name="mail.operations.findmailbagsfordespatch" Type="NATIVE">
	<![CDATA[

	SELECT MST.CMPCOD,
  MST.MALIDR,
  MST.MALSEQNUM,
  MST.DSNIDR,
  MST.ORGEXGOFC,
  MST.DSTEXGOFC,
  MST.YER,
  MST.DSN,
  MST.MALCLS,
  MST.MALCTG MALCTGCOD,
  MST.MALSUBCLS,
  MST.SCNPRT,
  MST.SCNDAT,
  MST.CONNUM ULDNUM,
  MST.SCNUSR,
  MST.MALSTA,
  MST.OPRSTA,
  MST.CONTYP,
  MST.POU,
  MST.WGT,
  MST.CSGDOCNUM,
  MST.CSGSEQNUM,
  MST.POACOD,
  MST.DMGFLG,
  MST.LSTUPDTIM
FROM MALMST MST
WHERE MST.CMPCOD=?
AND MST.SCNPRT  =?
AND MST.DSNIDR  =?


]]>
</QRY:Source>
</QRY:Definition>

	<QRY:Definition>
		<QRY:Id>185</QRY:Id>
		<QRY:Source Name="mail.operations.findmailtag" Type="OBJECT">
			<![CDATA[
			     SELECT MAL.FLTNUM, ARL.TWOAPHCOD,
						CTY.CTYNAM ORGCTYNAM, SUB.DES,
					   CTY1.CTYNAM DESTCTYNAM, CNT1.CNTNAM
				  FROM MALMST MAL LEFT OUTER JOIN MALSUBCLSMST SUB
					   ON MAL.CMPCOD = SUB.CMPCOD
					 AND MAL.MALSUBCLS = SUB.SUBCLSCOD
					   LEFT OUTER JOIN MALEXGOFCMST ORGEXG
					   ON ORGEXG.CMPCOD = MAL.CMPCOD
					 AND ORGEXG.EXGOFCCOD = MAL.ORGEXGOFC
					   LEFT OUTER JOIN SHRCTYMST CTY
					   ON CTY.CMPCOD = ORGEXG.CMPCOD
					 AND CTY.CTYCOD = ORGEXG.CTYCOD
					   LEFT OUTER JOIN SHRARLMST ARL
					   ON MAL.CMPCOD = ARL.CMPCOD
					 AND MAL.FLTCARIDR = ARL.ARLIDR
					   LEFT OUTER JOIN MALEXGOFCMST DSTEXG
					   ON DSTEXG.CMPCOD = MAL.CMPCOD
					 AND DSTEXG.EXGOFCCOD = MAL.DSTEXGOFC
					   LEFT OUTER JOIN SHRCTYMST CTY1
					   ON CTY1.CMPCOD = DSTEXG.CMPCOD
					 AND CTY1.CTYCOD = DSTEXG.CTYCOD
					   LEFT OUTER JOIN SHRCNTMST CNT1
					   ON MAL.CMPCOD = CNT1.CMPCOD
					 AND CTY1.CNTCOD = CNT1.CNTCOD
				 WHERE MAL.CMPCOD = ? AND MAL.MALIDR = ?

			]]>
		</QRY:Source>
	</QRY:Definition>

<QRY:Definition>
<QRY:Id>186</QRY:Id>
<QRY:Source Name="mail.operations.findmailboxidlov" Type="NATIVE">
	<![CDATA[
	SELECT MALBOX.CMPCOD,MALBOX.MALBOXIDR,MALBOX.MALBOXDES
    FROM MALMALBOX MALBOX
    WHERE MALBOX.CMPCOD = ?
]]>
</QRY:Source>
</QRY:Definition>

	<QRY:Definition>
<QRY:Id>187</QRY:Id>
<QRY:Source Name="mail.operations.findsumforflightsegments" Type="NATIVE">
	<![CDATA[

			SELECT SUM (SEGDTL.ACPBAG) ACPBAG,
	  SUM (SEGDTL.ACPWGT) ACPWGT,
	  SEGDTL.CONNUM,
	  SEG.LOCCOD
	FROM MALULDSEGDTL SEGDTL
	INNER JOIN MALULDSEG SEG
	ON SEGDTL.CMPCOD     = SEG.CMPCOD
	AND SEGDTL.ULDNUM    = SEG.ULDNUM
	AND SEGDTL.FLTCARIDR = SEG.FLTCARIDR
	AND SEGDTL.FLTNUM    = SEG.FLTNUM
	AND SEGDTL.FLTSEQNUM = SEG.FLTSEQNUM
	WHERE SEGDTL.CMPCOD  = ?
	AND SEGDTL.CONNUM           = ?
	AND SEGDTL.FLTCARIDR        = ?
	AND SEGDTL.FLTNUM           = ?
	AND SEGDTL.FLTSEQNUM        = ?
	GROUP BY SEGDTL.CONNUM,
	  SEG.LOCCOD
	]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
	<QRY:Id>188</QRY:Id>
	<QRY:Source Name="mail.operations.findtransfermanifest" Type="NATIVE">
		<![CDATA[

 		 SELECT  MFT.CMPCOD,  MFT.TRFMFTIDR,  MFT.ARPCOD,  MFT.TRFDAT,  MFT.ONWFLTNUM TOFLTNUM,  MFT.ONWCARCOD TOCARCOD,  MFT.FRMCARCOD,  MFT.FRMFLTNUM,  MFT.FRMFLTDAT FRMDAT,  MFT.ONWFLTDAT TODAT,MFT.TRFSTA,MFT.FRMFLTSEQNUM,MFT.FRMSEGSERNUM,
		SUM(DSN.BAGCNT) TOTBAG ,SUM(DSN.BAGWGT) TOTWGT
		 FROM  MALTRFMFT MFT  INNER JOIN  MALTRFMFTDTL DSN ON
		MFT.CMPCOD = DSN.CMPCOD  AND
		MFT.TRFMFTIDR = DSN.TRFMFTIDR
		INNER JOIN SHRARLMST arlmst
      ON (MFT.ONWCARCOD not in( arlmst.TWOAPHCOD)
	  OR MFT.ONWCARCOD NOT IN( arlmst.THRAPHCOD))
      AND MFT.cmpcod =arlmst.cmpcod
        INNER JOIN SHRSYSPAR syspar
      ON syspar.CMPCOD = arlmst.CMPCOD
				AND syspar.PARCOD   ='logonattributes.ownairlineidentifier'
		AND   COALESCE(DSN.TRFSTA,'N') <> 'TRFREJ'
       AND TO_NUMBER(syspar.PARVAL) = arlmst.arlidr
	]]>
	</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>189</QRY:Id>
	<QRY:Source Name="mail.operations.findtransfermanifestdsndetails" Type="NATIVE">
		<![CDATA[
			SELECT TRF.CMPCOD,
			  TRF.TRFMFTIDR,
			  TRF.ARPCOD,
			  TRF.TRFDAT,
			  TRF.ONWFLTNUM TOFLTNUM,
			  TRF.ONWCARCOD TOCARCOD,
			  TRF.ONWFLTDAT TODAT,
			  TRF.FRMCARCOD,
			  TRF.FRMFLTNUM,
			  TRF.FRMSEGSERNUM,
			  TRF.FRMFLTSEQNUM,
			  MALMST.DSN,
			  MALMST.ORGEXGOFC,
			  MALMST.DSTEXGOFC,
			  MALMST.MALSUBCLS,
			  MALMST.MALCTG MALCTGCOD,
			  MALMST.YER,
			  DSN.BAGCNT,
			  DSN.BAGWGT,
			  DSN.CONNUM,
			  DSN.MALSEQNUM,
              DSN.TRFSTA,
			  MALMST.MSTDOCNUM,
		      MALMST.SHPPFX,
			  MALMST.MALIDR,
			  MALMST.POACOD,
			  MALMST.ORGCOD,
			  MALMST.DSTCOD,
			  MALMST.CSGDOCNUM,
			  MALMST.DSPDAT
			FROM MALTRFMFT TRF
			LEFT OUTER JOIN MALTRFMFTDTL DSN
			   ON TRF.CMPCOD = DSN.CMPCOD
			 AND TRF.TRFMFTIDR = DSN.TRFMFTIDR
			LEFT OUTER JOIN MALMST MALMST
			ON DSN.CMPCOD     = MALMST.CMPCOD
			AND DSN.MALSEQNUM = MALMST.MALSEQNUM
			 WHERE TRF.CMPCOD = ?
			 AND TRF.TRFMFTIDR = ?
	]]>
	</QRY:Source>
	</QRY:Definition>

<QRY:Definition>
<QRY:Id>190</QRY:Id>
<QRY:Source Name="mail.operations.findmailbagdamages" Type="NATIVE">
	<![CDATA[

	    SELECT DMGDTL.ARPCOD, DMGDTL.CMPCOD, DMGDTL.DMGCOD, DMGDTL.DMGDAT, DMGDTL.DMGDES,
		MST.DSN,MST.DSTEXGOFC, MST.MALCLS,MST.MALIDR, DMGDTL.OPRTYP,
		MST.ORGEXGOFC, DMGDTL.RMK, DMGDTL.LSTUPDUSR USRCOD, MST.YER, DMGDTL.RTNFLG, DMGDTL.POACOD
		FROM MALDMGDTL DMGDTL
    INNER JOIN
  MALMST MST
ON DMGDTL.CMPCOD  = MST.CMPCOD
AND DMGDTL.MALSEQNUM = MST.MALSEQNUM
		WHERE DMGDTL.CMPCOD = ?
		AND MST.MALIDR = ?



	]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
		<QRY:Id>191</QRY:Id>
		<QRY:Source Name="mail.operations.findcontainerswithsubclassgrpfilter" Type="NATIVE">
			<![CDATA[
            SELECT 	CMPCOD,CONNUM,FLTCARIDR,FLTNUM,FLTSEQNUM,LEGSERNUM,ASGPRT,ACPFLG,POAFLG,POU ,RMK,USRCOD,ASGDAT,DSTCOD,CONTYP, MSTFLTCARCOD,
			SEGSERNUM,OFLFLG,ARRSTA,TRAFLG,LSTUPDTIM,LSTUPDUSR,CONJRNIDR,SBCODE,TRNFLG,ONWFLTDAT,ONWFLTNUM,POU RTGPOU,RTGSERNUM,ONWFLTCARCOD,
			RTGFLTCARIDR ,ONWFLTCARIDR,FLTDAT,BAGCNT,BAGWGT ,RELFLG ,ULDLSTUPDTIM,ULDLSTUPDUSR,SUBCLSGRP,SCNDAT,SCNPRT,CLSFLG, ULDFULIND,ULDREFNUM, PLNFLTNUM, PLNFLTDAT, PLNFLTCARCOD,POL,
			ACTULDWGT,PROCHG,RATEDCOUNT,BASCURCOD FROM(
			]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
<QRY:Id>192</QRY:Id>
<QRY:Source Name="mail.operations.findcontainers" Type="NATIVE">
	<![CDATA[

            SELECT   MST.CMPCOD,MST.CONNUM,MST.FLTCARIDR,MST.FLTNUM,MST.FLTSEQNUM,MST.LEGSERNUM,(case
					when MST.arrsta = 'Y' then MST.POU
					else MST.ASGPRT
				end ) as ASGPRT,MST.ACPFLG,MST.POAFLG,
            MST.POU ,MST.RMK,MST.USRCOD,MST.ASGDAT,MST.DSTCOD,MST.CONTYP,MST.FLTCARCOD MSTFLTCARCOD,MST.SEGSERNUM,
            MST.OFLFLG,MST.ARRSTA, MST.TRAFLG,MST.LSTUPDTIM,MST.LSTUPDUSR,MST.CONJRNIDR,MST.POACOD SBCODE,MST.TRNFLG,MST.CNTIDR,MST.ACTULDWGT,MST.ACTULDWGTDSP,MST.ACTULDWGTDSPUNT,MST.ULDFULIND


]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
		<QRY:Id>193</QRY:Id>
		<QRY:Source Name="mail.operations.findofflodedinfoforcontainer" Type="NATIVE">
			<![CDATA[
            SELECT OFLDTL.FLTCARCOD || ' ' ||OFLDTL.FLTNUM || ',' || TO_CHAR(MST.FLTDAT, 'DD-MON-YYYY') OFFLODDTL ,COUNT(1) OFFLODCNT FROM
			MALOFLDTL OFLDTL, FLTOPRMST MST
			WHERE OFLDTL.CMPCOD = MST.CMPCOD
			AND OFLDTL.FLTCARIDR = MST.FLTCARIDR
			AND OFLDTL.FLTNUM = MST.FLTNUM
			AND OFLDTL.FLTSEQNUM = MST.FLTSEQNUM
			AND OFLDTL.OFLTYP = 'F'
			AND
			( CASE WHEN (SELECT MAX(ASGDAT) FROM MALFLTCON CONMST
			WHERE  OFLDTL.CMPCOD = CONMST.CMPCOD
			AND OFLDTL.CONNUM = CONMST.CONNUM
			AND CONMST.ASGPRT= OFLDTL.ARPCOD
			AND TRNFLG = 'N')  IS NULL THEN current_date ELSE OFLDTL.OFLDAT END )
			>
			( CASE WHEN(SELECT MAX(ASGDAT) FROM MALFLTCON CONMST
			WHERE  OFLDTL.CMPCOD = CONMST.CMPCOD
			AND OFLDTL.CONNUM = CONMST.CONNUM
			AND CONMST.ASGPRT= OFLDTL.ARPCOD
			AND TRNFLG = 'N')  IS NULL THEN current_date-1 ELSE (SELECT MAX(ASGDAT) FROM MALFLTCON CONMST
			WHERE  OFLDTL.CMPCOD = CONMST.CMPCOD
			AND OFLDTL.CONNUM = CONMST.CONNUM
			AND CONMST.ASGPRT= OFLDTL.ARPCOD
			AND TRNFLG = 'N') END )
			AND OFLDTL.CMPCOD = ?
			AND OFLDTL.CONNUM = ?
			AND OFLDTL.ARPCOD = ?
			GROUP BY OFLDTL.FLTCARCOD ,OFLDTL.FLTNUM ,MST.FLTDAT
			]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>194</QRY:Id>
	<QRY:Source Name="mail.operations.mailsfortranshipmentflight" Type="NATIVE">
		<![CDATA[
				SELECT CDTTRT.ORGCOD AS POL,
				CDTTRT.DSTCOD AS POU,
				CDTTRT.FLTNUM ,
  MST.MALIDR MALIDR,
				CDTRCP.RCPWGT WGT,
				TO_DATE(TO_CHAR(CDTTRT.DEPTIM,'DD-MON-YYYY')) AS FLTDAT,
				CDTTRT.CARCOD FLTCARCOD,
				'Y' CDTAVL,
  SUBSTR(MST.MALIDR,17,4) DSN
				FROM MALCDTTRT CDTTRT
				INNER JOIN FLTOPRMST FLT
				ON CDTTRT.CMPCOD=FLT.CMPCOD
				AND CDTTRT.FLTSEQNUM=FLT.FLTSEQNUM
				AND CDTTRT.FLTNUM=FLT.FLTNUM
				AND CDTTRT.CARIDR=FLT.FLTCARIDR
			INNER JOIN MALCDTRCP CDTRCP
				ON CDTTRT.CMPCOD  = CDTRCP.CMPCOD
				AND CDTTRT.CDTKEY = CDTRCP.CDTKEY
				AND NOT EXISTS
				(SELECT 1
				  FROM MALMST MST
				  WHERE MST.CMPCOD =  CDTRCP.CMPCOD
  AND MST.MALIDR   = CDTRCP.RCPIDR
  AND MST.MALSTA <> 'NEW'
				 )
			AND CDTTRT.TRTSTGQLF <> '20'
INNER JOIN MALMST MST
ON MST.CMPCOD=CDTRCP.CMPCOD
AND MST.MALIDR=CDTRCP.RCPIDR


	]]>
	</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>195</QRY:Id>
	<QRY:Source Name="mail.operations.findmailswithoutcardits" Type="NATIVE">
		<![CDATA[
		SELECT HIS.FLTCARCOD, HIS.FLTNUM, HIS.FLTDAT,MST.MALSTA ,
		   MST.MALIDR, MST.CMPCOD, MST.DSN,
		   HIS.POU POU, 'N' CDTAVL,FLT.FLTORG POL, MST.WGT
	  FROM MALMST MST
	  INNER JOIN FLTOPRMST FLT
		ON MST.CMPCOD     = FLT.CMPCOD
		AND MST.FLTCARIDR = FLT.FLTCARIDR
		AND MST.FLTNUM = FLT.FLTNUM
		AND MST.FLTSEQNUM = FLT.FLTSEQNUM
	  INNER JOIN MALHIS HIS
		   ON MST.CMPCOD = HIS.CMPCOD
				 AND MST.MALSEQNUM = HIS.MALSEQNUM
		 AND MST.MALSTA = HIS.MALSTA
		 AND HIS.MALHISIDR =
					 (SELECT MAX (MALHISIDR)
						FROM MALHIS
					   WHERE CMPCOD = HIS.CMPCOD

						 AND MALSEQNUM = HIS.MALSEQNUM
						 AND MALSTA = HIS.MALSTA)

	]]>
	</QRY:Source>
	</QRY:Definition>


	<QRY:Definition>
	<QRY:Id>196</QRY:Id>
	<QRY:Source Name="mail.operations.mailstatus.carditnotaccepted" Type="NATIVE">
		<![CDATA[
		SELECT CDTTRT.ORGCOD POL, CDTTRT.DSTCOD POU,
       CDTTRT.CARCOD FLTCARCOD, CDTTRT.FLTNUM FLTNUM,
       CDTTRT.DEPTIM FLTDAT, CDTRCP.DSPSRLNUM DSN,
       CDTRCP.RCPIDR MALIDR, CDTRCP.RCPWGT WGT,''INFLTCARCOD ,'' INFLTNUM,'' INFLTDAT
	   FROM MALCDTMST CDTMST
	   INNER JOIN MALCDTTRT CDTTRT
       ON CDTMST.CMPCOD = CDTTRT.CMPCOD
	   AND CDTMST.CDTKEY = CDTTRT.CDTKEY
	   INNER JOIN FLTOPRMST FLT
	  ON CDTTRT.CMPCOD=FLT.CMPCOD
	  AND CDTTRT.FLTSEQNUM=FLT.FLTSEQNUM
	  AND CDTTRT.FLTNUM=FLT.FLTNUM
	  AND CDTTRT.CARIDR=FLT.FLTCARIDR
       INNER JOIN MALCDTRCP CDTRCP
       ON CDTMST.CMPCOD = CDTRCP.CMPCOD
	   AND CDTMST.CDTKEY = CDTRCP.CDTKEY
       AND NOT EXISTS (SELECT 1 FROM MALMST
                      WHERE MALIDR = CDTRCP.RCPIDR)
	   WHERE CDTTRT.CMPCOD=? AND FLT.FLTSTA NOT IN ('TBA','TBC','CAN') AND CDTTRT.DEPTIM BETWEEN TO_DATE(?, 'yyyy-MM-dd') AND TO_DATE(?, 'yyyy-MM-dd')
	]]>
	</QRY:Source>
	</QRY:Definition>

<QRY:Definition>
	<QRY:Id>197</QRY:Id>
	<QRY:Source Name="mail.operations.findmailsarrivedandnotdelivered" Type="NATIVE">
		<![CDATA[
				SELECT *
FROM
  (SELECT malexgofcmst.arpcod exgarpcod,
    mal.cmpcod,
    mal.malidr,
    COALESCE (asgflt.fltseqnum, inbflt.fltseqnum) fltseqnum,
    COALESCE (asgflt.fltnum, inbflt.fltnum) fltnum,
    COALESCE (asgflt.fltcaridr, inbflt.fltcaridr) fltcaridr ,
    mal.dsn,
    uld.fltnum infltnum,
    COALESCE (asgflt.fltcarcod, inbflt.fltcarcod) infltcarcod,
    CASE
      WHEN (cdtmst.csgdocnum) IS NOT NULL
      THEN 'Y'
      ELSE 'N'
    END cdtavl,
    mal.pou,
    uld.scnprt pol,
    uld.wgt,
    COALESCE (asgflt.fltdat, inbflt.fltdat) infltdat
  FROM malmst mal
  INNER JOIN maluldsegdtl uld
  ON mal.cmpcod     = uld.cmpcod
  AND mal.malseqnum = uld.malseqnum
  LEFT OUTER JOIN malflt inbflt
  ON inbflt.cmpcod     = uld.cmpcod
  AND inbflt.fltnum    = uld.fltnum
  AND inbflt.arpcod    = uld.scnprt
  AND inbflt.fltcaridr = uld.fltcaridr
  AND inbflt.fltseqnum = uld.fltseqnum
  AND impclsflg       IS NOT NULL
  LEFT OUTER JOIN malflt asgflt
  ON asgflt.cmpcod     = uld.cmpcod
  AND asgflt.fltnum    = uld.fltnum
  AND asgflt.arpcod    = uld.scnprt
  AND asgflt.fltcaridr = uld.fltcaridr
  AND asgflt.fltseqnum = uld.fltseqnum
  LEFT OUTER JOIN malcdtmst cdtmst
  ON mal.cmpcod     = cdtmst.cmpcod
  AND mal.csgdocnum = cdtmst.csgdocnum
  INNER JOIN malexgofcmst
  ON malexgofcmst.exgofccod                         = mal.dstexgofc
  AND malexgofcmst.cmpcod                           = mal.cmpcod
	]]>
	</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>198</QRY:Id>
	<QRY:Source Name="mail.operations.mailstatus.mailsdelivered" Type="NATIVE">
		<![CDATA[
		      SELECT  FLTSEG.POL POL,FLTSEG.POU POU,'' FLTCARCOD,'' FLTNUM,MALMST.DSN
		              DSN,MALMST.MALIDR MALIDR,ULDSEG.WGT WGT,ARLMST.TWOAPHCOD INFLTCARCOD,
					  CASE
						WHEN (CDTMST.CSGDOCNUM) IS NOT NULL
						THEN 'Y'
						ELSE 'N'
					  END CDTAVL
		              ,ULDSEG.FLTNUM INFLTNUM,FLTLEG.STA INFLTDAT
		      FROM   MALULDSEGDTL ULDSEG
           INNER JOIN MALMST MALMST
		                 ON ULDSEG.CMPCOD=MALMST.CMPCOD
		                 AND ULDSEG.MALSEQNUM=MALMST.MALSEQNUM
			          INNER JOIN MALFLTSEG FLTSEG
		                 ON ULDSEG.CMPCOD=FLTSEG.CMPCOD
		                 AND ULDSEG.FLTNUM=FLTSEG.FLTNUM
		                 AND ULDSEG.FLTCARIDR= FLTSEG.FLTCARIDR
		                 AND ULDSEG.FLTSEQNUM= FLTSEG.FLTSEQNUM
		                 AND ULDSEG.SEGSERNUM= FLTSEG.SEGSERNUM
						 INNER JOIN FLTOPRMST FLTMST
						  ON FLTSEG.CMPCOD=FLTMST.CMPCOD
						  AND FLTSEG.FLTSEQNUM=FLTMST.FLTSEQNUM
						  AND FLTSEG.FLTNUM=FLTMST.FLTNUM
						  AND FLTSEG.FLTCARIDR=FLTMST.FLTCARIDR
INNER JOIN FLTOPRLEG FLTLEG
ON FLTSEG.CMPCOD    =FLTLEG.CMPCOD
AND FLTSEG.FLTSEQNUM=FLTLEG.FLTSEQNUM
AND FLTSEG.FLTNUM   =FLTLEG.FLTNUM
AND FLTSEG.FLTCARIDR=FLTLEG.FLTCARIDR
AND FLTSEG.POU=FLTLEG.LEGDST

					 INNER JOIN SHRARLMST_VW ARLMST
						 ON ARLMST.CMPCOD     =FLTSEG.CMPCOD
						AND ARLMST.ARLIDR      = FLTSEG.FLTCARIDR
					LEFT OUTER JOIN MALCDTMST CDTMST
						ON MALMST.CMPCOD             = CDTMST.CMPCOD
						AND MALMST.CSGDOCNUM         = CDTMST.CSGDOCNUM
		     WHERE  ULDSEG.DLVSTA='Y'
		            AND ULDSEG.CMPCOD= ?
					AND FLTMST.FLTSTA NOT IN ('TBA','TBC','CAN')
			       AND TO_NUMBER(TO_CHAR(TRUNC(ULDSEG.SCNDAT),'YYYYMMDD')) >= ?
                   AND TO_NUMBER(TO_CHAR(TRUNC(ULDSEG.SCNDAT),'YYYYMMDD')) <= ?

	]]>
	</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>199</QRY:Id>
	<QRY:Source Name="mail.operations.mailsinflight" Type="NATIVE">

		<![CDATA[
	SELECT DISTINCT MALMST.MALIDR,
  FLTSEG.POL,
  FLTSEG.POU,
  FLTSEG.FLTNUM,
  MALULD.WGT,
  ASGFLT.FLTDAT,
  ASGFLT.FLTCARCOD,
  CASE
    WHEN (CDTMST.CSGDOCNUM) IS NOT NULL
    THEN 'Y'
    ELSE 'N'
  END CDTAVL,
   MALMST.DSN
FROM MALFLT ASGFLT
INNER JOIN FLTOPRMST FLT
ON ASGFLT.CMPCOD    =FLT.CMPCOD
AND ASGFLT.FLTSEQNUM=FLT.FLTSEQNUM
AND ASGFLT.FLTNUM   =FLT.FLTNUM
AND ASGFLT.FLTCARIDR=FLT.FLTCARIDR
INNER JOIN MALFLTSEG FLTSEG
ON ASGFLT.CMPCOD     = FLTSEG.CMPCOD
AND ASGFLT.FLTCARIDR = FLTSEG.FLTCARIDR
AND ASGFLT.FLTNUM    = FLTSEG.FLTNUM
AND ASGFLT.FLTSEQNUM = FLTSEG.FLTSEQNUM
AND ASGFLT.ARPCOD    = FLTSEG.POL
INNER JOIN FLTOPRLEG OPRLEG
ON FLTSEG.CMPCOD     = OPRLEG.CMPCOD
AND FLTSEG.FLTCARIDR = OPRLEG.FLTCARIDR
AND FLTSEG.FLTNUM    = OPRLEG.FLTNUM
AND FLTSEG.FLTSEQNUM = OPRLEG.FLTSEQNUM
AND FLTSEG.POL       = OPRLEG.LEGORG
INNER JOIN MALULDSEGDTL MALULD
ON FLTSEG.CMPCOD            = MALULD.CMPCOD
AND FLTSEG.FLTCARIDR        = MALULD.FLTCARIDR
AND FLTSEG.FLTNUM           = MALULD.FLTNUM
AND FLTSEG.FLTSEQNUM        = MALULD.FLTSEQNUM
AND FLTSEG.SEGSERNUM        = MALULD.SEGSERNUM
INNER JOIN MALMST MALMST
ON MALULD.CMPCOD            = MALMST.CMPCOD
AND MALULD.MALSEQNUM           = MALMST.MALSEQNUM
LEFT OUTER JOIN MALCDTMST CDTMST
ON MALMST.CMPCOD             = CDTMST.CMPCOD
AND MALMST.CSGDOCNUM         = CDTMST.CSGDOCNUM
	]]>
	</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>200</QRY:Id>
	<QRY:Source Name="mail.operations.notupliftedmailsincarrier" Type="NATIVE">
		<![CDATA[
		  SELECT MALULD.ARPCOD AS POL,
  '' POU,
  '-1' FLTNUM,
  MALMST.MALIDR,
  MALMST.WGT,
   NULL AS FLTDAT ,
  (SELECT (CASE WHEN APHCODUSE = 2  THEN TWOAPHCOD ELSE THRAPHCOD END)
  FROM SHRARLMST
  WHERE CMPCOD = MALULD.CMPCOD
  AND ARLIDR   = MALULD.FLTCARIDR
  ) FLTCARCOD
          FROM MALARPULDDTL MALULD
	]]>
	</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
		<QRY:Id>201</QRY:Id>
			<QRY:Source Name="mail.operations.acceptednotupliftedmailsinflight" Type="NATIVE">

				<![CDATA[
			SELECT FLTSEG.POL,
  FLTSEG.POU,
  FLTSEG.FLTNUM,
  MALMST.MALIDR,
  MALMST.WGT,
  ASGFLT.FLTDAT,
  ASGFLT.FLTCARCOD,
  MALULD.CONNUM,
  OPRLEG.STD,
  OPRLEG.LEGSTA,
  OPRMST.FLTROU
FROM MALFLT ASGFLT
INNER JOIN MALFLTSEG FLTSEG
ON ASGFLT.CMPCOD     = FLTSEG.CMPCOD
AND ASGFLT.FLTCARIDR = FLTSEG.FLTCARIDR
AND ASGFLT.FLTNUM    = FLTSEG.FLTNUM
AND ASGFLT.FLTSEQNUM = FLTSEG.FLTSEQNUM
AND ASGFLT.ARPCOD    = FLTSEG.POL
INNER JOIN FLTOPRLEG OPRLEG
ON FLTSEG.CMPCOD     = OPRLEG.CMPCOD
AND FLTSEG.FLTCARIDR = OPRLEG.FLTCARIDR
AND FLTSEG.FLTNUM    = OPRLEG.FLTNUM
AND FLTSEG.FLTSEQNUM = OPRLEG.FLTSEQNUM
AND FLTSEG.POL       = OPRLEG.LEGORG
INNER JOIN FLTOPRMST OPRMST
ON FLTSEG.CMPCOD     = OPRMST.CMPCOD
AND FLTSEG.FLTCARIDR = OPRMST.FLTCARIDR
AND FLTSEG.FLTNUM    = OPRMST.FLTNUM
AND FLTSEG.FLTSEQNUM = OPRMST.FLTSEQNUM
INNER JOIN MALULDSEGDTL MALULD
ON FLTSEG.CMPCOD            = MALULD.CMPCOD
AND FLTSEG.FLTCARIDR        = MALULD.FLTCARIDR
AND FLTSEG.FLTNUM           = MALULD.FLTNUM
AND FLTSEG.FLTSEQNUM        = MALULD.FLTSEQNUM
AND FLTSEG.SEGSERNUM        = MALULD.SEGSERNUM
INNER JOIN MALMST MALMST
ON MALMST.CMPCOD            = MALULD.CMPCOD
AND MALMST.FLTCARIDR        = MALULD.FLTCARIDR
AND MALMST.MALSEQNUM        = MALULD.MALSEQNUM
			]]>
		</QRY:Source>

	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>202</QRY:Id>
	<QRY:Source Name="mail.operations.mailstatus.mailsdeliveredwithoutcardit" Type="NATIVE">
		<![CDATA[
		SELECT  DISTINCT FLTSEG.POL POL, FLTSEG.POU POU,
                 '' FLTCARCOD, '' FLTNUM,
                 'N' CDTAVL, MALMST.DSN DSN,
                 MALMST.MALIDR MALIDR,
                 ULDSEG.WGT WGT,
				  ARLMST.FLTCARCOD INFLTCARCOD,
                 ULDSEG.FLTNUM INFLTNUM,
                 FLTLEG.STA INFLTDAT
           FROM  MALULDSEGDTL ULDSEG
             INNER JOIN MALMST MALMST
                      ON ULDSEG.CMPCOD = MALMST.CMPCOD
                      AND ULDSEG.MALSEQNUM = MALMST.MALSEQNUM
                      AND ULDSEG.FLTCARIDR = MALMST.FLTCARIDR
			        INNER JOIN MALFLTSEG FLTSEG
                      ON ULDSEG.CMPCOD = FLTSEG.CMPCOD
                      AND ULDSEG.FLTNUM = FLTSEG.FLTNUM
                      AND ULDSEG.FLTCARIDR = FLTSEG.FLTCARIDR
                      AND ULDSEG.FLTSEQNUM = FLTSEG.FLTSEQNUM
                      AND ULDSEG.SEGSERNUM = FLTSEG.SEGSERNUM
					  INNER JOIN FLTOPRMST FLTMST
					  ON FLTSEG.CMPCOD=FLTMST.CMPCOD
					  AND FLTSEG.FLTSEQNUM=FLTMST.FLTSEQNUM
					  AND FLTSEG.FLTNUM=FLTMST.FLTNUM
					  AND FLTSEG.FLTCARIDR=FLTMST.FLTCARIDR
INNER JOIN FLTOPRLEG FLTLEG
ON FLTSEG.CMPCOD    =FLTLEG.CMPCOD
AND FLTSEG.FLTSEQNUM=FLTLEG.FLTSEQNUM
AND FLTSEG.FLTNUM   =FLTLEG.FLTNUM
AND FLTSEG.FLTCARIDR=FLTLEG.FLTCARIDR
AND FLTSEG.POU=FLTLEG.LEGDST

						  INNER  JOIN  FLTARLMST ARLMST
                        ON     ARLMST.CMPCOD =FLTSEG.CMPCOD
                        AND   ARLMST.FLTCARIDR = FLTSEG.FLTCARIDR
INNER JOIN  MALPOAMST POAMST
ON POAMST.CMPCOD=MALMST.CMPCOD
AND POAMST.POACOD=MALMST.POACOD
AND TO_NUMBER(TO_CHAR(current_date,'DDMMYYYY'))-TO_NUMBER(TO_CHAR(MALMST.DSPDAT,'YYYYMMDD')) <= POAMST.DUPMALPRD
                         AND NOT EXISTS (
                                          SELECT 1
                                          FROM MALCDTRCP RCP
                                          WHERE RCP.RCPIDR = MALMST.MALIDR
			                            )
          WHERE  ULDSEG.DLVSTA = 'Y'
                 AND ULDSEG.CMPCOD = ?
				 AND FLTMST.FLTSTA NOT IN ('TBA','TBC','CAN')
                 AND TO_NUMBER(TO_CHAR(TRUNC(ULDSEG.SCNDAT),'YYYYMMDD')) >= ?
                 AND TO_NUMBER(TO_CHAR(TRUNC(ULDSEG.SCNDAT),'YYYYMMDD')) <= ?
	]]>
	</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>203</QRY:Id>
		<QRY:Source Name="mail.operations.acceptednotupliftedmailsincarrier" Type="NATIVE">
		<![CDATA[
		 SELECT MALULD.ARPCOD AS POL,
  MALMST.POU,
  '-1' FLTNUM,
  MALMST.MALIDR,
  MALMST.WGT,
NULL AS FLTDAT ,
  (SELECT (CASE WHEN APHCODUSE = 2  THEN TWOAPHCOD ELSE THRAPHCOD END)
  FROM SHRARLMST
  WHERE CMPCOD = MALULD.CMPCOD
  AND ARLIDR   = MALULD.FLTCARIDR
  ) FLTCARCOD ,
  MALULD.CONNUM,
  NULL AS STD,
  '' LEGSTA,
  '' FLTROU
FROM MALARPULDDTL MALULD
INNER JOIN MALMST MALMST
ON MALMST.CMPCOD            = MALULD.CMPCOD
AND MALMST.FLTCARIDR        = MALULD.FLTCARIDR
AND MALMST.MALSEQNUM        = MALULD.MALSEQNUM
			]]>
		</QRY:Source>
	</QRY:Definition>


		<QRY:Definition>
<QRY:Id>204</QRY:Id>
<QRY:Source Name="mail.operations.finduldsforarrival" Type="NATIVE">
	<![CDATA[

			SELECT DISTINCT FLT.CMPCOD,
			  FLT.FLTCARIDR,
			  FLT.FLTNUM,
			  FLT.FLTSEQNUM,
			  FLT.POL,
			  FLT.POU,
			  INBFLT.FLTDAT,
			  ULD.ULDNUM,
			  (
			  CASE
				WHEN (CSGRTG.FLTNUM IS NOT NULL)
				THEN 'Y'
				ELSE 'N'
			  END ) AS RTGAVL,
			  ULD.SEGSERNUM,
			  ULD.BAGCNT,
			  ULD.BAGWGT,
			  ULD.RCVBAG,
			  ULD.RCVWGT,
			  ULD.LSTUPDTIM SEGLSTUPDTIM,
			  COALESCE(CON.RMK,ULD.RMK) REMARK,
			  MALMST.DSN,
			  MALMST.ORGCOD,
			  MALMST.DSTCOD,
			  MALMST.ORGEXGOFC,
			  MALMST.DSTEXGOFC,
			  MALMST.MALCLS,
			  MALMST.YER,
			  MALMST.MALSUBCLS,
			  MALMST.MALSRVLVL,
			  MALMST.MALCTG MALCTGCOD,
			  MALMST.RSN,
			  MALMST.HSN,
			  MALMST.REGIND,
			  MALMST.WGT,
			  MALMST.DSPWGT,
			  MALMST.DSPWGTUNT,
			  MALMST.MALRMK,
			  MALMST.ONNTIMDLVFLG ONNTIMDLVFLG,
              MALMST.SCNWVDFLG SCNWVDFLG,
			  MAL.ACPBAG,
			  MAL.ACPWGT,
			  MAL.STDBAG,
			  MAL.STDWGT,
			  MAL.RCVBAG DSNRCVBAG,
			  MAL.RCVWGT DSNRCVWGT,
			  MAL.DLVBAG,
			  MAL.DLVWGT,
			  'Y' PLTENBFLG,
			  0 TRFBAG,
			  0.TRFWGT,
			  CON.POAFLG,
			  COALESCE(CON.DSTCOD,MAL.SCNPRT) DSTCOD,
			  COALESCE(CON.LEGSERNUM,INBFLT.LEGSERNUM)LEGSERNUM,
			  CON.TRAFLG    AS CONTRAFLG,
			  CON.LSTUPDTIM AS CONLSTUPDTIM,
			  CON.ARRSTA CONARRSTA,
			  CON.DLVFLG,
			  CON.ACPFLG,
			  CON.INTFLG,
			  CON.CONJRNIDR,
			  CON.POACOD SBCODE,
			  CON.TRNFLG,
			  MALMST.MALIDR,
			  MALMST.MALSEQNUM,
			  MAL.DLVSTA,
			  MAL.ACPSTA AS MALACPSTA,
			  MAL.ARRSTA,
			  MAL.TRAFLG AS MALTRAFLG,
			  MALMST.DMGFLG,
			  MALMST.SELNUM,
			  MAL.ARRSELNUM,
			  MAL.MRASTA MALMRASTA,
			  (SELECT MAX(HIS.SCNDAT)
			  FROM MALHIS HIS
			  WHERE HIS.CMPCOD  = MAL.CMPCOD
			  AND HIS.MALSEQNUM = MAL.MALSEQNUM
			  AND HIS.FLTCARIDR = MAL.FLTCARIDR
			  AND HIS.FLTNUM    = MAL.FLTNUM
			  AND HIS.FLTSEQNUM = MAL.FLTSEQNUM
			  AND HIS.SEGSERNUM = MAL.SEGSERNUM
			  AND HIS.CONNUM    = MAL.ULDNUM
			  AND HIS.MALSTA    = ?
			  AND HIS.SCNPRT    = ?
			  ) SCNDAT,
			  MALMST.SCNDAT SCNDATTIME,
			  MALMST.CSGDOCNUM ULDCSGDOCNUM,
			  MALMST.POACOD ULDPOACOD,
			  MALMST.CSGSEQNUM ULDCSGSEQNUM,
			  CSGMST.CSGDAT ULDCSGDAT,
			  MAL.STDBAG ULDSTDBAG,
			  MAL.STDWGT ULDSTDWGT,
			  MAL.ACPBAG ULDACPBAG,
			  MAL.ACPWGT ULDACPWGT,
			  NULL ULDACPDAT,
			  MAL.RCVBAG ULDRCVBAG,
			  MAL.RCVWGT ULDRCVWGT,
			  MAL.DLVBAG ULDDLVBAG ,
			  MAL.DLVWGT ULDDLVWGT,
			  MAL.TRAFLG CSGULDTRAFLG,
			  0 TDVOL,
			  0 BULKVOL,
			  MALMST.CSGDOCNUM CONCSGDOCNUM,
			  MALMST.POACOD CONPOACOD,
			  MALMST.CSGSEQNUM CONCSGSEQNUM ,
			  CSGMST.CSGDAT CONCSGDAT,
			  MAL.STDBAG CONSTDBAG,
			  MAL.STDWGT CONSTDWGT,
			  MAL.ACPBAG CONACPBAG,
			  MAL.ACPWGT CONACPWGT,
			  NULL CONACPDAT,
			  MAL.RCVBAG CONRCVBAG,
			  MAL.RCVWGT CONRCVWGT,
			  NULL CONRCVDAT,
			  MAL.DLVBAG CONDLVBAG,
			  MAL.DLVWGT CONDLVWGT,
			  MAL.CONNUM,
			  MAL.TRAFLG CSGCONTRAFLG,
			  MALMST.LSTUPDTIM MALLSTUPDTIM,
			  MALMST.MALCMPCOD MALCMPCOD,
			  ARPULD.ULDNUM INVULDNUM,
			  ARPULD.CONNUM INVCONNUM,
			  TO_CHAR(RTG.ONWFLTDAT,'DD-Mon-YYYY') ONWFLTDAT,
			  RTG.ONWFLTNUM,
			  RTG.POU RTGPOU,
			  RTG.RTGSERNUM,
			  RTG.ONWFLTCARCOD,
			  NULL CURCOD,
			  0 MALRAT,
			  ULD.RELFLG RELFLG,
			  MALMST.CSGDOCNUM CSGDOCNUM,
			  MALMST.POACOD POACOD,
			  NULL RMKS,
			  MALMST.MALSTA,
			  MALMST.SCNPRT,
			  MALMST.FLTNUM MALFLTNUM,
			  MALMST.FLTCARIDR MALFLTCARIDR,
			  MALMST.FLTSEQNUM MALFLTSEQNUM,
			  MALMST.VOL VOL,
			  MALMST.MALTYP MALTYP,
			  MALMST.DOCOWRIDR,
			  MALMST.MSTDOCNUM,
			  MALMST.DUPNUM,
			  MALMST.SHPPFX,
			  MALMST.SEQNUM,
			  MALMST.SELNUM,
			  DMGMAL.DMGCOD,
			  DMGMAL.DMGDAT,
			  DMGMAL.ARPCOD,
			  DMGMAL.DMGDES,
			  DMGMAL.RMK,
			  CASE
				WHEN INBFLT.IMPCLSFLG IS NULL
				THEN 'O'
				ELSE INBFLT.IMPCLSFLG
			  END CLSFLG
			FROM MALFLTSEG FLT
			INNER JOIN MALULDSEG ULD
			ON FLT.FLTCARIDR  =ULD.FLTCARIDR
			AND FLT.FLTNUM    = ULD.FLTNUM
			AND FLT.FLTSEQNUM =ULD.FLTSEQNUM
			AND FLT.SEGSERNUM =ULD.SEGSERNUM
			AND FLT.CMPCOD    = ULD.CMPCOD
			LEFT OUTER JOIN MALFLT INBFLT
			ON FLT.FLTCARIDR  =INBFLT.FLTCARIDR
			AND FLT.FLTNUM    = INBFLT.FLTNUM
			AND FLT.FLTSEQNUM =INBFLT.FLTSEQNUM
			AND FLT.POU       =INBFLT.ARPCOD
			LEFT OUTER JOIN MALULDSEGDTL MAL
			ON ULD.CMPCOD     =MAL.CMPCOD
			AND ULD.FLTCARIDR =MAL.FLTCARIDR
			AND ULD.FLTNUM    =MAL.FLTNUM
			AND ULD.FLTSEQNUM =MAL.FLTSEQNUM
			AND ULD.SEGSERNUM =MAL.SEGSERNUM
			AND ULD.ULDNUM    =MAL.ULDNUM
			LEFT OUTER JOIN MALFLTCON CON
			ON ULD.CMPCOD     =CON.CMPCOD
			AND ULD.FLTCARIDR =CON.FLTCARIDR
			AND ULD.FLTNUM    =CON.FLTNUM
			AND ULD.FLTSEQNUM =CON.FLTSEQNUM
			AND ULD.SEGSERNUM =CON.SEGSERNUM
			AND MAL.CONNUM    =CON.CONNUM
			LEFT OUTER JOIN MALMST MALMST
			ON MAL.MALSEQNUM = MALMST.MALSEQNUM
			AND MAL.CMPCOD   = MALMST.CMPCOD
			LEFT OUTER JOIN MALARPULDDTL ARPULD
			ON MAL.MALSEQNUM  = ARPULD.MALSEQNUM
			AND MAL.CMPCOD    = ARPULD.CMPCOD
			AND MAL.FLTCARIDR = ARPULD.FLTCARIDR
			AND ARPULD.ARPCOD = ?
			LEFT OUTER JOIN MALCSGMST CSGMST
			ON CSGMST.CMPCOD     = MALMST.CMPCOD
			AND CSGMST.CSGDOCNUM = MALMST.CSGDOCNUM
			AND CSGMST.POACOD    = MALMST.POACOD
			AND CSGMST.CSGSEQNUM = MALMST.CSGSEQNUM
			LEFT OUTER JOIN MALCSGRTG CSGRTG
			ON CSGRTG.CMPCOD                  = CSGMST.CMPCOD
			AND CSGRTG.CSGDOCNUM              = CSGMST.CSGDOCNUM
			AND CSGRTG.CSGSEQNUM              = CSGMST.CSGSEQNUM
			AND CSGRTG.POACOD                 = CSGMST.POACOD
			AND SUBSTR(CSGMST.CSGDOCNUM,0,3) <> 'ACM'
			LEFT OUTER JOIN MALFLTCONRTG RTG
			ON CON.CMPCOD     = RTG.CMPCOD
			AND CON.CONNUM    = RTG.CONNUM
			AND CON.ASGPRT    = RTG.ASGPRT
			AND CON.FLTCARIDR = RTG.FLTCARIDR
			AND CON.FLTNUM    = RTG.FLTNUM
			AND CON.FLTSEQNUM = RTG.FLTSEQNUM
			AND CON.LEGSERNUM = RTG.LEGSERNUM
			LEFT OUTER JOIN MALDMGDTL DMGMAL
			ON MALMST.MALSEQNUM = DMGMAL.MALSEQNUM
			AND MALMST.CMPCOD   = DMGMAL.CMPCOD

]]>
</QRY:Source>
</QRY:Definition>

	<QRY:Definition>
		<QRY:Id>205</QRY:Id>
		<QRY:Source Name="mail.operations.findmaildetailsforunsentresdits" Type="NATIVE">
			<![CDATA[
				  SELECT MALRDT.RDTSND,
				  MALMST.MALIDR,
				  MALMST.DSN,
				  MALMST.ORGEXGOFC,
				  MALMST.DSTEXGOFC,
				  MALMST.MALCTG,
				  MALMST.MALSUBCLS,
				  MALMST.YER,
				  MALMST.CMPCOD ,
				  MALRDT.FLTCARIDR,
				  MALRDT.FLTNUM,
				  MALRDT.FLTSEQNUM,
				  MALRDT.SEGSERNUM,
				  MALRDT.CONNUM,
				  MALRDT.EVTCOD,
				  MALRDT.msgseqnum,
				  MALRDT.EVTPRT,
				  MALRDT.POACARCOD,
				  MALRDT.EVTDATUTC,
				  SHR.TWOAPHCOD,
				  MALMST.POACOD SDRIDR,
				  CSGMST.CSGDOCNUM,
				  CDTMST.CDTKEY
				FROM MALCSGDTL CSGDTL
				INNER JOIN MALMST MALMST
				ON MALMST.CMPCOD     = CSGDTL.CMPCOD
				AND MALMST.MALSEQNUM = CSGDTL.MALSEQNUM
				INNER JOIN MALCSGMST CSGMST
				ON CSGMST.CMPCOD     = CSGDTL.CMPCOD
				AND CSGMST.CSGDOCNUM = CSGDTL.CSGDOCNUM
				AND CSGMST.POACOD    = CSGDTL.POACOD
				INNER JOIN MALRDT MALRDT
				ON MALRDT.MALSEQNUM = CSGDTL.MALSEQNUM
				LEFT OUTER JOIN SHRARLMST SHR
				ON SHR.CMPCOD        = MALRDT.CMPCOD
   				   AND SHR.ARLIDR = MALRDT.FLTCARIDR
				LEFT OUTER JOIN   MALCDTMST CDTMST
				ON CSGMST.CMPCOD  = CDTMST.CMPCOD
				AND CSGMST.CSGDOCNUM = CDTMST.CSGDOCNUM

				WHERE MALRDT.RDTSND <> 'G'
			 ]]>
		</QRY:Source>
	</QRY:Definition>

			<QRY:Definition>
			<QRY:Id>206</QRY:Id>
				<QRY:Source Name="mail.operations.findpartyname" Type="NATIVE">
				<![CDATA[

					 SELECT ARL.ARLNAM PTYNAM
   						FROM SHRARLMST ARL
						  WHERE ARL.CMPCOD = ?
							AND (ARL.TWOAPHCOD = ?
							OR ARL.THRAPHCOD = ?)

					UNION ALL

						 SELECT POA.POANAM PTYNAM
						   FROM MALPOAMST POA
						  WHERE POA.CMPCOD = ?
							AND POA.POACOD = ?

					    ]]>
				</QRY:Source>
	</QRY:Definition>


			<QRY:Definition>
		<QRY:Id>207</QRY:Id>
		<QRY:Source Name="mail.operations.findoffloadreasonformailbag" Type="NATIVE">
			<![CDATA[
				SELECT OFL.OFLRSNCOD
				  FROM MALOFLDTL OFL,MALMST MST

				 WHERE OFL.CMPCOD = ?
				 AND MST.MALIDR = ?
				 AND MST.CMPCOD=OFL.CMPCOD
				 AND MST.MALSEQNUM=OFL.MALSEQNUM
			   AND OFL.SERNUM = (SELECT MAX (SERNUM)
                   FROM MALOFLDTL OFL2
                  WHERE OFL2.MALSEQNUM = OFL.MALSEQNUM)
			]]>
		</QRY:Source>
	</QRY:Definition>


			<QRY:Definition>
		<QRY:Id>208</QRY:Id>
		<QRY:Source Name="mail.operations.findoffloadreasonforcontainer" Type="NATIVE">
			<![CDATA[
					SELECT OFL.OFLRSNCOD
					  FROM MALOFLDTL OFL
					 WHERE OFL.CMPCOD = ?
						 AND OFL.CONNUM = ?
					    AND OFL.SERNUM = (SELECT MAX (SERNUM)
                       FROM MALOFLDTL OFL2
                      WHERE OFL2.CONNUM = OFL.CONNUM)
			]]>
		</QRY:Source>
	</QRY:Definition>

		<QRY:Definition>
	<QRY:Id>209</QRY:Id>
		<QRY:Source Name="mail.operations.finddamagereasonformailbag" Type="NATIVE">
			<![CDATA[
					SELECT DMG.DMGCOD
					  FROM MALDMGDTL DMG,
					  MALMST MST
					 WHERE DMG.CMPCOD=MST.CMPCOD
						AND DMG.MALSEQNUM=MST.MALSEQNUM
						AND DMG.CMPCOD = ?
					   AND MST.MALIDR = ?
					   AND DMG.ARPCOD = ?
			]]>
		</QRY:Source>
	</QRY:Definition>

		<QRY:Definition>
		<QRY:Id>210</QRY:Id>
	<QRY:Source Name="mail.operations.findCCForSendResdit" Type="NATIVE">
	<![CDATA[
		SELECT
			TRT.CMPCOD,TRT.CDTKEY,TRT.ORGCOD,TRT.DSTCOD,TRT.CNTRFF, RFF.REFNUM AHIRFFNUM
	FROM
			MALCDTTRT TRT,MALCDTMST MST, MALCDTREF RFF
			WHERE TRT.CDTKEY = MST.CDTKEY
			And MST.CDTKEY = RFF.CDTKEY
			And MST.CMPCOD = RFF.CMPCOD
			And RFF.REFQLF = 'AHI'
	]]>
	</QRY:Source>
	</QRY:Definition>



	<QRY:Definition>
	<QRY:Id>211</QRY:Id>
	<QRY:Source Name="mail.operations.generatedailymailstationreport" Type="NATIVE">
		<![CDATA[

					SELECT MAX(CONMST.FLTCARCOD) CARCOD,
		  FLTSEG.FLTNUM FLTNUM,
		  FLTSEG.FLTSEQNUM FLTSEQNUM,
		  ULDSEG.ULDNUM ULDNUM,
		  CONMST.DSTCOD DEST,
		  SUM ( DSNSEG.ACPWGT) BAGWGT,
		  ( COALESCE ( COALESCE(ULDMST.TARWGT, TYPMST.TAREWGT), 0) + SUM ( DSNSEG.ACPWGT) ) TOTWGT,
		  SUM ( DSNSEG.ACPBAG)BAGCNT,
		  ULDSEG.RMK RMK
		FROM MALFLT ASGFLT
		INNER JOIN MALFLTSEG FLTSEG
		ON ASGFLT.CMPCOD     = FLTSEG.CMPCOD
		AND ASGFLT.FLTCARIDR = FLTSEG.FLTCARIDR
		AND ASGFLT.FLTNUM    = FLTSEG.FLTNUM
		AND ASGFLT.FLTSEQNUM = FLTSEG.FLTSEQNUM
		LEFT OUTER JOIN FLTOPRMST FLTMST
		ON FLTSEG.CMPCOD       =FLTMST.CMPCOD
		AND FLTSEG.FLTSEQNUM   =FLTMST.FLTSEQNUM
		AND FLTSEG.FLTNUM      =FLTMST.FLTNUM
		AND FLTSEG.FLTCARIDR   =FLTMST.FLTCARIDR
		AND FLTMST.FLTSTA NOT IN ('TBA','TBC','CAN')
		INNER JOIN MALULDSEG ULDSEG
		ON FLTSEG.CMPCOD     = ULDSEG.CMPCOD
		AND FLTSEG.FLTCARIDR = ULDSEG.FLTCARIDR
		AND FLTSEG.FLTNUM    = ULDSEG.FLTNUM
		AND FLTSEG.FLTSEQNUM = ULDSEG.FLTSEQNUM
		AND FLTSEG.SEGSERNUM = ULDSEG.SEGSERNUM
		LEFT OUTER JOIN MALULDSEGDTL DSNSEG
		ON ULDSEG.CMPCOD     = DSNSEG.CMPCOD
		AND ULDSEG.FLTCARIDR = DSNSEG.FLTCARIDR
		AND ULDSEG.FLTNUM    = DSNSEG.FLTNUM
		AND ULDSEG.FLTSEQNUM = DSNSEG.FLTSEQNUM
		AND ULDSEG.SEGSERNUM = DSNSEG.SEGSERNUM
		AND ULDSEG.ULDNUM    = DSNSEG.ULDNUM
		INNER JOIN MALMST MST
		ON DSNSEG.CMPCOD=MST.CMPCOD
		AND DSNSEG.MALSEQNUM=MST.MALSEQNUM
		INNER JOIN MALFLTCON CONMST
		ON ULDSEG.CMPCOD     = CONMST.CMPCOD
		AND ULDSEG.FLTCARIDR = CONMST.FLTCARIDR
		AND ULDSEG.FLTNUM    = CONMST.FLTNUM
		AND ULDSEG.FLTSEQNUM = CONMST.FLTSEQNUM
		AND dsnseg.connum = conmst.connum
		LEFT OUTER JOIN SHRULDTYPMST TYPMST
		ON ULDSEG.CMPCOD                   = TYPMST.CMPCOD
		AND (SUBSTR (ULDSEG.ULDNUM, 0, 3)) = TYPMST.ULDTYPCOD
		LEFT OUTER  JOIN ULDMST ULDMST
        ON MST.CMPCOD                      = ULDMST.CMPCOD
        AND MST.CONNUM                     = ULDMST.ULDNUM
        AND MST.CONTYP                     ='U'
		WHERE ULDSEG.CMPCOD                = ?
		AND ASGFLT.FLTDAT  BETWEEN TO_DATE(?, 'yyyy-MM-dd') AND TO_DATE(?, 'yyyy-MM-dd')
		AND ASGFLT.ARPCOD                  =?
		AND DSNSEG.ACPWGT                 <>0
		AND DSNSEG.ACPBAG                 <>0

	]]>
	</QRY:Source>
	</QRY:Definition>
		<QRY:Definition>
<QRY:Id>212</QRY:Id>
<QRY:Source Name="mail.operations.findpalov" Type="NATIVE">
	<![CDATA[

	SELECT CMPCOD, POACOD, POANAM
    FROM MALPOAMST
    WHERE CMPCOD = ?

]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
	<QRY:Id>213</QRY:Id>
	<QRY:Source Name="mail.operations.finddsnmailbagsforflight" Type="NATIVE">
		<![CDATA[
				SELECT MST.MALIDR, MST.ORGEXGOFC,MST.DSTEXGOFC,MST.MALCTG MALCTGCOD,
				MST.MALSUBCLS,MST.MALCLS,MST.YER,MST.WGT,MST.DSN, '1' BAGCNT,
				MST.RSN,MST.HSN,MST.REGIND,MST.CONNUM
				FROM MALULDSEG SEG,MALULDSEGDTL DTL, MALMST MST
				WHERE
				SEG.CMPCOD     = DTL.CMPCOD
				AND SEG.FLTCARIDR = DTL.FLTCARIDR
				AND SEG.FLTNUM    = DTL.FLTNUM
				AND SEG.FLTSEQNUM = DTL.FLTSEQNUM
				AND SEG.SEGSERNUM = DTL.SEGSERNUM
				AND SEG.ULDNUM    = DTL.ULDNUM
				AND DTL.CMPCOD= MST.CMPCOD
				AND DTL.MALSEQNUM = MST.MALSEQNUM
				AND SEG.CMPCOD = ?
				AND SEG.FLTCARIDR= ?
				AND SEG.FLTNUM = ?
				AND SEG.FLTSEQNUM = ?
				AND SEG.SEGSERNUM = ?
				AND MST.DSN = ?
				AND MST.ORGEXGOFC = ?
				AND MST.DSTEXGOFC = ?
				AND MST.MALCLS = ?
				AND MST.MALSUBCLS = ?
				AND MST.MALCTG = ?
		AND MST.YER = ?
		]]>
	  </QRY:Source>
	  </QRY:Definition>

	<QRY:Definition>
		<QRY:Id>214</QRY:Id>
		<QRY:Source Name="mail.operations.findallresdits" Type="NATIVE">
				<![CDATA[
				 SELECT mailResdit FROM MailResdit mailResdit
					 WHERE mailResdit.companyCode = ?1
					 AND mailResdit.mailSequenceNumber = ?2
		]]>
	  </QRY:Source>
	  </QRY:Definition>

	<QRY:Definition>
		<QRY:Id>215</QRY:Id>
		<QRY:Source Name="mail.operations.findPADetails" Type="NATIVE">
				<![CDATA[
				 SELECT POA.POACOD,
				  POA.BASTYP
				FROM MALEXGOFCMST OFC,
				  MALPOAMST POA
				WHERE POA.CMPCOD  = OFC.CMPCOD
				AND POA.POACOD    = OFC.POACOD
				AND OFC.CMPCOD    = ?
				AND OFC.EXGOFCCOD = ?
		]]>
	  </QRY:Source>
	  </QRY:Definition>

	<QRY:Definition>
		<QRY:Id>216</QRY:Id>
		<QRY:Source Name="mail.operations.validatepoadetails" Type="NATIVE">
				<![CDATA[
				 SELECT CMPCOD , POACOD, PARCOD, SERNUM, BLGSRC, BLGFRQ FROM MALPOADTL
				WHERE CMPCOD = ?
				AND POACOD = ?
				AND PARCOD = ?
				%s
		]]>
	  </QRY:Source>
	  </QRY:Definition>


	  	<QRY:Definition>
		<QRY:Id>217</QRY:Id>
		<QRY:Source Name="mail.operations.findallpoacodes" Type="NATIVE">
				<![CDATA[
				SELECT MST.CMPCOD,
					  MST.POACOD,
					  MST.POANAM,
					  MST.POAADR,
					  MST.AUTEMLREQ,
					  MST.CNTCOD,
					  MST.EMLADR,
					  MAX(DTL.BLGSRC)BLGSRC,
					  MAX(DTL.BLGFRQ)BLGFRQ,
                      MST.SECEMLADRONE,
                      MST.SECEMLADRTWO,
					  MST.STLCURCOD,
					  MST.PROINVREQ,
					  MAX(DTL.PARVAL)PARVAL
					FROM
					  MALPOAMST MST,
					  MALPOADTL DTL
					WHERE MST.CMPCOD = DTL.CMPCOD
					AND MST.POACOD = DTL.POACOD
					AND MST.CMPCOD = ?
					AND MST.ACTFLG='ACTIVE'
				    AND ((to_date(?, 'dd-MON-yyyy') BETWEEN DTL.VLDFRM AND DTL.VLDTOO) 
					AND (to_date(?, 'dd-MON-yyyy') BETWEEN DTL.VLDFRM AND DTL.VLDTOO))	
						AND DTL.PARCOD in ('PASBLGID','BLGINFO')
		  
		]]>
	  </QRY:Source>
	  </QRY:Definition>

	   <QRY:Definition>
 <QRY:Id>218</QRY:Id>
  	<QRY:Source Name="mail.operations.findScannedMailDetails" Type="NATIVE">
			<![CDATA[
				SELECT CMPCOD,SCNSTR,MALIDR,SERNUM,SCNPRT,SCNDAT FROM ( SELECT rownum rnum,SCNDTL.CMPCOD CMPCOD,SCNDTL.SCNSTR SCNSTR,SCNDTL.MALIDR MALIDR,SCNDTL.SERNUM SERNUM,SCNDTL.SCNPRT SCNPRT, SCNDAT FROM MALSCNDTL SCNDTL

                WHERE SCNDTL.UPLSTA='N' AND SCNDTL.CMPCOD = ? ORDER BY SCNDTL.SCNDAT ,SCNDTL.SERNUM) where ROWNUM <= ?


			]]>
	</QRY:Source>

  </QRY:Definition>
 <QRY:Definition>
		<QRY:Id>219</QRY:Id>
		<QRY:Source Name="mail.operations.performuploadcorrection" Type="PROCEDURE">
			<![CDATA[
				CALL PKG_MTK_UPLOAD_CORRECTIONS.SPR_MTK_UPLOADMAIL_JOB(
					?,
					?
				)
			]]>
		</QRY:Source>
	</QRY:Definition>
		<QRY:Definition>
	<QRY:Id>220</QRY:Id>
	<QRY:Source Name="mail.operations.findmailhandedovertocarrier" Type="NATIVE">
		<![CDATA[
				SELECT DISTINCT MST.MALIDR MALIDR,
		  MST.DSN DSN,
		  FLT.FLTNUM INBFLTNUM,
		  FLT.FLTCARCOD INBFLTCARCOD,
		  FLT.FLTDAT INBFLTDAT,
		  SEG.WGT,
		  SEG.SCNPRT,
		  HIS.FLTNUM ONWFLTNUM,
		  (SELECT TWOAPHCOD
		  FROM SHRARLMST
		  WHERE CMPCOD = HIS.CMPCOD
		  AND ARLIDR   = HIS.FLTCARIDR
		  ) ONWFLTCARCOD,
		  HIS.FLTDAT ONWFLTDAT,
		  CTY1.SRVARPCOD ORGARPCOD,
		  CTY2.SRVARPCOD DESARPCOD
		FROM MALFLT FLT,
		  MALULDSEGDTL SEG,
		  MALHIS HIS,
		  SHRCTYMST CTY1,
		  SHRCTYMST CTY2,
		  FLTOPRMST FLTMST,
		  MALMST MST
		WHERE FLT.CMPCOD  = SEG.CMPCOD
		AND FLT.FLTCARIDR = SEG.FLTCARIDR
		AND FLT.FLTNUM    = SEG.FLTNUM
		AND FLT.FLTSEQNUM = SEG.FLTSEQNUM
		AND FLTMST.CMPCOD = SEG.CMPCOD
		AND FLTMST.FLTCARIDR  = SEG.FLTCARIDR
		AND FLTMST.FLTSEQNUM  = SEG.FLTSEQNUM
		AND FLTMST.FLTNUM     = SEG.FLTNUM
		AND FLT.ARPCOD    = HIS.SCNPRT
		AND SEG.CMPCOD    = HIS.CMPCOD
		AND SEG.MALSEQNUM = HIS.MALSEQNUM
		AND MST.CMPCOD    = HIS.CMPCOD
		AND MST.MALSEQNUM = HIS.MALSEQNUM
		AND HIS.MALHISIDR =
		  (SELECT MAX(MALHISIDR)
		  FROM MALHIS
		  WHERE MALSEQNUM =HIS.MALSEQNUM
		  AND CMPCOD  = HIS.CMPCOD
		  AND MALSTA  = 'TRA'
		  )
		AND HIS.CMPCOD  = CTY1.CMPCOD
		AND CTY1.CTYCOD =
		  (SELECT CTYCOD
		  FROM MALEXGOFCMST
		  WHERE CMPCOD  = MST.CMPCOD
		  AND EXGOFCCOD = MST.ORGEXGOFC
		  )
		AND HIS.CMPCOD  = CTY2.CMPCOD
		AND CTY2.CTYCOD =
		  (SELECT CTYCOD
		  FROM MALEXGOFCMST
		  WHERE CMPCOD  = MST.CMPCOD
		  AND EXGOFCCOD = MST.DSTEXGOFC
		  )
		AND HIS.FLTCARIDR <> SEG.FLTCARIDR
	]]>	</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>221</QRY:Id>
	<QRY:Source Name="mail.operations.findmailhandedovertoflight" Type="NATIVE">
		<![CDATA[
					SELECT MST.MALIDR MALIDR,
			  MST.DSN DSN,
			  HIS.FLTNUM INBFLTNUM,
			  HIS.FLTCARCOD INBFLTCARCOD,
			  HIS.FLTDAT INBFLTDAT,
			  SEG.WGT,
			  SEG.SCNPRT,
			  FLT.FLTNUM ONWFLTNUM,
			  FLT.FLTCARCOD ONWFLTCARCOD,
			  FLT.FLTDAT ONWFLTDAT,
			  CTY1.SRVARPCOD ORGARPCOD,
			  CTY2.SRVARPCOD DESARPCOD
			FROM MALFLT FLT,
			  MALULDSEGDTL SEG,
			  MALHIS HIS,
			  SHRCTYMST CTY1,
			  SHRCTYMST CTY2,
			  FLTOPRMST FLTMST,
			  MALMST MST
			WHERE FLT.CMPCOD  = SEG.CMPCOD
			AND FLT.FLTCARIDR = SEG.FLTCARIDR
			AND FLT.FLTNUM    = SEG.FLTNUM
			AND FLT.FLTSEQNUM = SEG.FLTSEQNUM
			AND FLT.ARPCOD    = SEG.SCNPRT
			AND FLT.CMPCOD    = FLTMST.CMPCOD
			AND FLT.FLTCARIDR = FLTMST.FLTCARIDR
			AND FLT.FLTNUM    = FLTMST.FLTNUM
			AND FLT.FLTSEQNUM = FLTMST.FLTSEQNUM
			AND SEG.CMPCOD    = HIS.CMPCOD
			AND SEG.MALSEQNUM = HIS.MALSEQNUM
			AND SEG.SCNPRT    = HIS.SCNPRT
			AND HIS.CMPCOD    = CTY1.CMPCOD
			AND HIS.CMPCOD    =  MST.CMPCOD
			AND HIS.MALSEQNUM  = MST.MALSEQNUM
			AND CTY1.CTYCOD   =
			  (SELECT CTYCOD
			  FROM MALEXGOFCMST
			  WHERE CMPCOD  = MST.CMPCOD
			  AND EXGOFCCOD = MST.ORGEXGOFC
			  )
			AND HIS.CMPCOD  = CTY2.CMPCOD
			AND CTY2.CTYCOD =
			  (SELECT CTYCOD
			  FROM MALEXGOFCMST
			  WHERE CMPCOD  = MST.CMPCOD
			  AND EXGOFCCOD = MST.DSTEXGOFC
			  )
			AND HIS.MALSTA     = 'ARR'
			AND SEG.TRAFLG     = 'N'
			AND HIS.FLTCARIDR <> SEG.FLTCARIDR
	]]>	</QRY:Source>
	</QRY:Definition>

<QRY:Definition>
<QRY:Id>222</QRY:Id>
<QRY:Source Name="mail.operations.findresditstatus" Type="NATIVE">
	<![CDATA[
				SELECT MMR.RDTSND RDTSND
    			  FROM MALRDT MMR
 				WHERE MMR.CMPCOD = ?
 				AND  MMR.MALIDR = ?
 				AND MMR.EVTCOD = ?
 				AND MMR.EVTPRT = ?

	]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>223</QRY:Id>
<QRY:Source Name="mail.operations.findlatestmailbagresdit" Type="NATIVE">
	<![CDATA[
		SELECT RDT.EVTCOD
		  FROM MALRDT RDT
		  WHERE RDT.MALIDR = ?
		  AND RDT.SEQNUM = (SELECT MAX (SEQNUM)
                                           FROM MALRDT
                                          WHERE MALIDR = ?)
	]]>
</QRY:Source>
</QRY:Definition>


<QRY:Definition>
	<QRY:Id>224</QRY:Id>
	<QRY:Source Name="mail.operations.resditeventreceiver" Type="PROCEDURE">
		<![CDATA[
			CALL PKG_MAL_SND_RDT.spr_evt_receiver (?, ?, ?)
		]]>
	</QRY:Source>
</QRY:Definition>

<QRY:Definition>
	<QRY:Id>225</QRY:Id>
	<QRY:Source Name="mail.operations.resdittimermanager" Type="PROCEDURE">
		<![CDATA[
			CALL PKG_MAL_SND_RDT.spr_tim_manger (?, ?, ?)
		]]>
	</QRY:Source>
</QRY:Definition>



	<QRY:Definition>
				<QRY:Id>227</QRY:Id>
				<QRY:Source Name="mail.operations.findulddetailsforresditwithoutcardit" Type="NATIVE">
									<![CDATA[
									SELECT ULDRDT.ULDNUM,ULDRDT.SEQNUM,ULDRDT.EVTDATUTC,ULDRDT.POACARCOD, 'UL' EQPQLF, null NUMCODLSTAGY,null TYPCOD,(CASE WHEN ARL.APHCODUSE = 2  THEN ARL.TWOAPHCOD ELSE ARL.THRAPHCOD END)  AS FLTCARCOD,  ULDRDT.CONJRNIDR
						   			FROM MALULDRDT ULDRDT
									LEFT OUTER JOIN SHRARLMST ARL
										 ON ULDRDT.CMPCOD = ARL.CMPCOD
									AND ULDRDT.FLTCARIDR  = ARL.ARLIDR
									  WHERE ULDRDT.CMPCOD = ?
									AND ULDRDT.EVTCOD     = ?
									AND ULDRDT.RDTSND     = ?
									AND ULDRDT.EVTPRT     = ?
									AND ULDRDT.MSGSEQNUM  = ?
									
									]]>
				</QRY:Source>
	</QRY:Definition>


<QRY:Definition>
		<QRY:Id>228</QRY:Id>
		<QRY:Source Name="mail.operations.findtransportforuldresdit" Type="NATIVE">
			<![CDATA[
			SELECT DISTINCT    FLT.FLTCARCOD
                || '#'
                || ULD.FLTCARIDR
                || '#'
                || ULD.FLTNUM
                || '#'
                || ULD.FLTSEQNUM
                || '#'
                || ULD.SEGSERNUM AS FLIGHTID,
                ULD.EVTDATUTC, ULD.EVTPRT
           FROM MALULDRDT ULD, MALFLT FLT
          WHERE ULD.CMPCOD = ?
            AND ULD.EVTDATUTC =
                   (SELECT MAX (ULD2.EVTDATUTC)
                      FROM MALULDRDT ULD2
                     WHERE ULD2.MSGSEQNUM = ULD.MSGSEQNUM
                       AND ULD2.EVTCOD = ULD.EVTCOD
                       AND ULD2.EVTPRT = ULD.EVTPRT)
            AND ULD.MSGSEQNUM = ?
            AND ULD.EVTCOD = ?
            AND ULD.EVTPRT = ?
            AND FLT.FLTCARIDR = ULD.FLTCARIDR
            AND FLT.FLTNUM = ULD.FLTNUM
            AND FLT.FLTSEQNUM = ULD.FLTSEQNUM
            AND ULD.FLTSEQNUM > 0
			]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
		<QRY:Id>229</QRY:Id>
				<QRY:Source Name="mail.operations.findmailbagdetailsforresdit" Type="NATIVE">
					<![CDATA[
					SELECT DISTINCT RDT.MALIDR,RDT.MALSEQNUM,RDT.EVTDATUTC,RDT.CONNUM,RDT.POACARCOD,RDT.MALBOXIDR,RDT.PTYIDR,FLT.FLTCARCOD,RDT.SEQNUM,RCP.DSPIDR,CDTCON.EQPQLF,MST.ORGCOD,MST.DSTCOD
					FROM MALRDT RDT
					INNER JOIN MALMST MST
					ON MST.CMPCOD = RDT.CMPCOD
					AND MST.MALSEQNUM = RDT.MALSEQNUM
					LEFT OUTER JOIN MALFLT FLT
						 ON RDT.CMPCOD = FLT.CMPCOD
					AND RDT.FLTCARIDR  = FLT.FLTCARIDR
					AND RDT.FLTNUM     = FLT.FLTNUM
					AND RDT.FLTSEQNUM  = FLT.FLTSEQNUM

					INNER JOIN MALCDTMST CDT
						 ON RDT.CMPCOD = CDT.CMPCOD
					AND RDT.CDTKEY     = CDT.CDTKEY

					INNER JOIN MALCDTRCP RCP
						 ON RDT.CMPCOD = RCP.CMPCOD
					AND RDT.CDTKEY     = RCP.CDTKEY
					AND RDT.MALIDR = RCP.RCPIDR

					LEFT OUTER JOIN MALCDTCON CDTCON
					 ON RCP.CMPCOD = CDTCON.CMPCOD AND
					 RCP.CDTKEY = CDTCON.CDTKEY AND
					 RCP.DSPIDR = CDTCON.CONJRNIDR
					WHERE CDT.CMPCOD = ?
					AND CDT.CSGDOCNUM  = ?
					AND RDT.MSGSEQNUM  = ?
					AND RDT.EVTCOD     = ?
					AND RDT.RDTSND     = ?
					AND RDT.EVTPRT     = ?
					]]>
		</QRY:Source>
	</QRY:Definition>

		<QRY:Definition>
		<QRY:Id>230</QRY:Id>
				<QRY:Source Name="mail.operations.findtransportformailresdit" Type="NATIVE">
					<![CDATA[
					SELECT DISTINCT    SHR.TWOAPHCOD
		                || '#'
		                || MAL.FLTCARIDR
		                || '#'
		                || MAL.FLTNUM
		                || '#'
		                || MAL.FLTSEQNUM
		                || '#'
		                || MAL.SEGSERNUM AS FLIGHTID,
		                MAL.EVTDATUTC, MAL.EVTPRT,SHR.ARLNAM
		           FROM MALRDT MAL, SHRARLMST SHR
		          WHERE MAL.CMPCOD = ?
		            AND MAL.EVTDATUTC =
		                   (SELECT MAX (MAL2.EVTDATUTC)
		                      FROM MALRDT MAL2
		                     WHERE MAL2.MSGSEQNUM = MAL.MSGSEQNUM
		                       AND MAL2.EVTCOD = MAL.EVTCOD
		                       AND MAL2.EVTPRT = MAL.EVTPRT)
		            AND MAL.MSGSEQNUM = ?
		            AND MAL.EVTCOD = ?
		            AND MAL.EVTPRT = ?
		            AND SHR.ARLIDR = MAL.FLTCARIDR
					]]>
		</QRY:Source>
	</QRY:Definition>


	<QRY:Definition>
		<QRY:Id>231</QRY:Id>
		<QRY:Source Name="mail.operations.findpartialresditflagforpa" Type="NATIVE">
			<![CDATA[
				SELECT prtrdt,msgevtloc,POACOD,CMPCOD,POANAM
				FROM MALPOAMST
				WHERE    cmpcod = ?
					 AND poacod = ?
			 ]]>
		</QRY:Source>
	</QRY:Definition>

		<QRY:Definition>
		<QRY:Id>232</QRY:Id>
		<QRY:Source Name="mail.operations.findmailbagdetailsforxxresdit" Type="NATIVE">
			<![CDATA[
					SELECT DISTINCT rdt.malidr,rdt.malseqnum, rdt.evtdatutc, rdt.connum, rdt.poacarcod,
						   			(CASE  WHEN aphcoduse = 2 THEN twoaphcod
										   ELSE thraphcod
									 END ) fltcarcod,rdt.seqnum,rdt.MALBOXIDR,rdt.PTYIDR,MST.ORGCOD,MST.DSTCOD
					FROM MALRDT rdt
					INNER JOIN MALMST MST
					ON MST.CMPCOD = RDT.CMPCOD
					AND MST.MALSEQNUM = RDT.MALSEQNUM
						 LEFT OUTER JOIN SHRARLMST flt ON
					    	       		rdt.cmpcod = flt.cmpcod
								  		AND rdt.fltcaridr = flt.arlidr
					WHERE rdt.cmpcod = ?
					      AND rdt.msgseqnum = ?
					      AND rdt.evtcod = ?
					      AND rdt.rdtsnd = ?
					      AND rdt.evtprt = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
  <QRY:Definition>
	<QRY:Id>233</QRY:Id>
	<QRY:Source Name="mail.operations.findmailresditforevent" Type="NATIVE">
			<![CDATA[
			SELECT resdit FROM com.ibsplc.neoicargo.mail.component.MailResdit resdit
                                WHERE resdit.companyCode = ?1
                                AND   resdit.mailIdr = ?2
                                AND resdit.eventCode = ?3
                                AND resdit.mailSequenceNumber = ?4
                                AND resdit.eventAirport = ?5
                                AND resdit.carrierId = ?6
                                AND resdit.flightNumber = ?7
                                AND resdit.flightSequenceNumber = ?8
                                AND resdit.segmentSerialNumber = ?9
                                AND resdit.resditSent =?10
			]]>
		</QRY:Source>
	</QRY:Definition>
		<QRY:Definition>
	<QRY:Id>234</QRY:Id>
	<QRY:Source Name="mail.operations.findimportmanifestdetails" Type="NATIVE">
		<![CDATA[
			SELECT FLT.CMPCOD,
			  FLT.FLTCARIDR,
			  FLT.FLTNUM,
			  FLT.FLTSEQNUM,
			  FLT.POL,
			  FLT.POU,
			  ULD.ULDNUM,
			  ULD.SEGSERNUM,
			  ULD.BAGCNT,
			  ULD.BAGWGT,
			  ULD.RCVBAG,
			  ULD.RCVWGT,
			  MALMST.DSN,
			  MALMST.MSTDOCNUM,
              MALMST.SHPPFX,
			  MALMST.ORGEXGOFC,
			  MALMST.DSTEXGOFC,
			  MALMST.MALCLS,
			  MALMST.YER,
			  MALMST.MALSUBCLS,
			  MALMST.MALCTG,
			  MALMST.DSN,
			  MALMST.RSN,
			  MALMST.HSN,
			  MALMST.REGIND,
			  MALMST.WGT,
			  MAL.ACPBAG,
			  ARPDTL.DOCOWRCOD,
			  ARPDTL.DOCOWRIDR,
			  ARPDTL.MSTDOCNUM,
			  MAL.ACPWGT,
			  MAL.RCVBAG DSNRCVBAG,
			  MAL.RCVWGT DSNRCVWGT,
			  'Y' PLTENBFLG,
			  MALMST.MALIDR,
			  CON.POAFLG,
			  MAL.ARRSTA MALARRFLG
			FROM MALFLTSEG FLT
			INNER JOIN MALULDSEG ULD
			ON FLT.FLTCARIDR  = ULD.FLTCARIDR
			AND FLT.FLTNUM    = ULD.FLTNUM
			AND FLT.FLTSEQNUM = ULD.FLTSEQNUM
			AND FLT.SEGSERNUM = ULD.SEGSERNUM
			AND FLT.CMPCOD    = ULD.CMPCOD
			LEFT OUTER JOIN MALFLTCON CON
			ON CON.CMPCOD     = ULD.CMPCOD
			AND CON.FLTCARIDR = ULD.FLTCARIDR
			AND CON.FLTNUM    = ULD.FLTNUM
			AND CON.FLTSEQNUM = ULD.FLTSEQNUM
			AND CON.SEGSERNUM = ULD.SEGSERNUM
			AND CON.CONNUM    = ULD.ULDNUM
			LEFT OUTER JOIN MALULDSEGDTL MAL
			ON FLT.CMPCOD     = MAL.CMPCOD
			AND FLT.FLTCARIDR = MAL.FLTCARIDR
			AND FLT.FLTNUM    = MAL.FLTNUM
			AND FLT.FLTSEQNUM = MAL.FLTSEQNUM
			AND FLT.SEGSERNUM = MAL.SEGSERNUM
			AND ULD.ULDNUM    = MAL.ULDNUM
			LEFT OUTER JOIN MALARPULDDTL ARPDTL
			ON MAL.CMPCOD     = ARPDTL.CMPCOD
			AND MAL.ULDNUM    = arpdtl.connum
			AND MAL.SCNPRT    = ARPDTL.ARPCOD
			AND MAL.FLTCARIDR = ARPDTL.FLTCARIDR
			AND MAL.MALSEQNUM = ARPDTL.MALSEQNUM
			LEFT OUTER JOIN MALMST MALMST
			ON MAL.CMPCOD     = MALMST.CMPCOD
			AND MAL.MALSEQNUM = MALMST.MALSEQNUM
			WHERE FLT.CMPCOD     = ?
			AND FLT.FLTCARIDR    = ?
			AND FLT.FLTNUM       = ?
			AND FLT.FLTSEQNUM    = ?
			AND FLT.POU          = ?
			ORDER BY ULD.ULDNUM,
			  ULD.SEGSERNUM,
			  MALMST.DSN,
			  MALMST.MSTDOCNUM,
              MALMST.SHPPFX,
			  MALMST.ORGEXGOFC,
			  MALMST.DSTEXGOFC,
			  MALMST.YER,
			  MALMST.MALSUBCLS,
			  MALMST.MALCTG,
			  MALMST.MALIDR
			]]>
		</QRY:Source>
	</QRY:Definition>
<QRY:Definition>
 <QRY:Id>298</QRY:Id>
  	<QRY:Source Name="mail.operations.findOnlineFlightsAndConatiners" Type="NATIVE">
			<![CDATA[
					SELECT DISTINCT LEG.CMPCOD,
					  LEG.FLTCARIDR,
					  LEG.FLTNUM,
					  LEG.FLTSEQNUM,
					  LEG.LEGSERNUM,
					  CON.SEGSERNUM,
					  LEG.STA FLTDAT,
					  LEG.LEGDST ARPCOD,
					  LEG.LEGORG,
					  LEG.LEGDST,
					  ASGFLTSEG.POU,
					  LEG.STD,
					  LEG.STA,
					  CON.CONNUM ULDNUM,
					  CON.RMK REMARK,
					  CON.POACOD SBCODE,
					  CON.CONJRNIDR,
					  CON.INTFLG,
					  CON.ACPFLG,
					  CON.TRAFLG AS CONTRAFLG,
					  CON.DSTCOD,
					  CON.POAFLG,
					  CON.DLVFLG,
					  CON.ARRSTA CONARRSTA
					FROM MALFLTSEG ASGFLTSEG,
					  FLTOPRLEG LEG,
					  MALFLTCON CON
					WHERE CON.CMPCOD                                        = LEG.CMPCOD
					AND CON.FLTCARIDR                                       = LEG.FLTCARIDR
					AND CON.FLTNUM                                          = LEG.FLTNUM
					AND CON.FLTSEQNUM                                       = LEG.FLTSEQNUM
					AND CON.POU                                             = LEG.LEGDST
					AND CON.CONTYP                                          ='U'
					AND ASGFLTSEG.CMPCOD                                    = CON.CMPCOD
					AND ASGFLTSEG.FLTCARIDR                                 = CON.FLTCARIDR
					AND ASGFLTSEG.FLTNUM                                    = CON.FLTNUM
					AND ASGFLTSEG.FLTSEQNUM                                 = CON.FLTSEQNUM
					AND ASGFLTSEG.SEGSERNUM                                 = CON.SEGSERNUM
					AND ASGFLTSEG.CMPCOD                                    = ?
					AND ASGFLTSEG.POU                                       =LEG.LEGDST
					%s
					WHERE ARPPAR.CMPCOD                                       = LEG.CMPCOD
					AND ARPPAR.PARCOD                                       ='mailtracking.defaults.staoffsetforarrival'
					AND ARPPAR.ARPCOD                                       = ASGFLTSEG.POU
					AND TO_NUMBER(COALESCE(ARPPAR.PARVAL,'0'))                   >0 ) ))
					AND( NOT EXISTS
					  (SELECT 1
					  FROM MALFLT INBFLT
					  WHERE ASGFLTSEG.CMPCOD  = INBFLT.CMPCOD
					  AND ASGFLTSEG.FLTNUM    =INBFLT.FLTNUM
					  AND ASGFLTSEG.FLTSEQNUM = INBFLT.FLTSEQNUM
					  AND ASGFLTSEG.POU       = INBFLT.ARPCOD
					  AND ASGFLTSEG.FLTCARIDR = INBFLT.FLTCARIDR
					  AND INBFLT.IMPCLSFLG       = 'C'
					  ) )
			]]>
	</QRY:Source>
  </QRY:Definition>
   <QRY:Definition>
 <QRY:Id>299</QRY:Id>
  	<QRY:Source Name="mail.operations.findMailbagsforArrival" Type="NATIVE">
			<![CDATA[
					SELECT DISTINCT FLT.CMPCOD,
					  FLT.FLTCARIDR,
					  FLT.FLTNUM,
					  FLT.FLTSEQNUM,
					  FLT.POL,
					  FLT.POU,
					  ULD.ULDNUM,
					  ULD.SEGSERNUM,
					  ULD.BAGCNT,
					  ULD.BAGWGT,
					  ULD.RCVBAG,
					  ULD.RCVWGT,
					  ULD.LSTUPDTIM SEGLSTUPDTIM,
					  CON.RMK REMARK,
					  CON.POAFLG,
					  CON.DSTCOD,
					  CON.LEGSERNUM,
					  CON.TRAFLG    AS CONTRAFLG,
					  CON.LSTUPDTIM AS CONLSTUPDTIM,
					  CON.ARRSTA CONARRSTA,
					  CON.DLVFLG,
					  CON.ACPFLG,
					  CON.INTFLG,
					  CON.CONJRNIDR,
					  CON.POACOD SBCODE,
					  CON.CONNUM AS INVCONNUM,
					  CON.CONTYP,
					  MALMST.MALIDR,
					  MALMST.MALSEQNUM,
					  MAL.DLVSTA,
					  MAL.ACPSTA AS MALACPSTA,
					  MAL.ARRSTA,
					  MAL.TRAFLG AS MALTRAFLG,
					  MALMST.DMGFLG,
					  MALMST.SELNUM,
					  MAL.ARRSELNUM,
					  MAL.MRASTA MALMRASTA,
					  MALMST.DSN,
					  MALMST.ORGEXGOFC,
					  MALMST.DSTEXGOFC,
					  MALMST.MALCLS,
					  MALMST.YER,
					  MALMST.MALSUBCLS,
					  MALMST.MALCTG MALCTGCOD,
					  MALMST.DSN,
					  MALMST.RSN,
					  MALMST.HSN,
					  MALMST.REGIND,
					  MALMST.WGT,
					  'Y' PLTENBFLG,
					  MALMST.LSTUPDTIM MALLSTUPDTIM,
					  MALMST.MALCMPCOD MALCMPCOD,
					  NULL CURCOD,
					  NULL MALRAT,
					  ULD.RELFLG RELFLG,
					  MALMST.CSGDOCNUM CSGDOCNUM,
						MALMST.POACOD,
					  ULD.RMK RMKS,
					  MALMST.MALSTA,
					  MALMST.SCNPRT,
					  MALMST.FLTNUM MALFLTNUM,
					  MALMST.FLTCARIDR MALFLTCARIDR,
					  MALMST.FLTSEQNUM MALFLTSEQNUM,
					  MALMST.VOL VOL,
					  MALMST.SCNDAT,
					  MALMST.ORGCOD,
					  MALMST.DSTCOD MALDSTCOD,
					  MAL.CONNUM MALCONNUM,
					  Actmst.TWOAPHCOD FLTCARCOD,
					  CASE
						WHEN INBFLT.IMPCLSFLG IS NULL
						THEN 'O'
						ELSE INBFLT.IMPCLSFLG
					  END CLSFLG
					FROM MALFLTSEG FLT
					INNER JOIN SHRARLACTMST ACTMST
					ON FLT.CMPCOD = ACTMST.CMPCOD
					AND FLT.FLTCARIDR = ACTMST.ARLIDR
					INNER JOIN MALULDSEG ULD
					ON FLT.FLTCARIDR  =ULD.FLTCARIDR
					AND FLT.FLTNUM    = ULD.FLTNUM
					AND FLT.FLTSEQNUM =ULD.FLTSEQNUM
					AND FLT.SEGSERNUM =ULD.SEGSERNUM
					AND Flt.Cmpcod    = Uld.Cmpcod
					LEFT OUTER JOIN MALFLT INBFLT
					ON FLT.FLTCARIDR  =INBFLT.FLTCARIDR
					AND FLT.FLTNUM    = INBFLT.FLTNUM
					AND FLT.FLTSEQNUM =INBFLT.FLTSEQNUM
					AND FLT.POU       =INBFLT.ARPCOD
					LEFT OUTER JOIN MALFLTCON CON
					ON ULD.CMPCOD     =CON.CMPCOD
					AND ULD.FLTCARIDR =CON.FLTCARIDR
					AND ULD.FLTNUM    =CON.FLTNUM
					AND ULD.FLTSEQNUM =CON.FLTSEQNUM
					AND ULD.ULDNUM    =CON.CONNUM
					AND ULD.SEGSERNUM =CON.SEGSERNUM
					LEFT OUTER JOIN MALULDSEGDTL MAL
					ON ULD.CMPCOD     =MAL.CMPCOD
					AND ULD.FLTCARIDR =MAL.FLTCARIDR
					AND ULD.FLTNUM    =MAL.FLTNUM
					AND ULD.FLTSEQNUM =MAL.FLTSEQNUM
					AND ULD.SEGSERNUM =MAL.SEGSERNUM
					AND ULD.ULDNUM    =MAL.ULDNUM
					AND (MAL.ARRSTA    ='N' OR  (coalesce(MAL.ARRSTA,'N') ='Y' AND coalesce(MAL.DLVSTA,'N')='N'))
					LEFT OUTER JOIN MALMST MALMST
					ON MAL.CMPCOD    = MALMST.CMPCOD
					AND MAL.MALSEQNUM    =MALMST.MALSEQNUM
					WHERE FLT.CMPCOD = ?
					AND FLT.FLTCARIDR = ?
					AND FLT.FLTNUM = ?
					AND FLT.FLTSEQNUM = ?
					AND FLT.POU = ?
					ORDER BY ULDNUM
			]]>
	</QRY:Source>
  </QRY:Definition>
     <QRY:Definition>
   <QRY:Id>300</QRY:Id>
  	<QRY:Source Name="mail.operations.findflightsforArrival" Type="NATIVE">
			<![CDATA[
					SELECT DISTINCT LEG.CMPCOD,
					  LEG.FLTCARIDR,
					  LEG.FLTNUM,
					  LEG.FLTSEQNUM,
					  LEG.LEGSERNUM,
					  LEG.STA FLTDAT,
					  LEG.LEGDST ARPCOD,
					  LEG.LEGORG,
					  LEG.LEGDST,
					  ASGFLTSEG.POU,
					  LEG.STD,
					  LEG.STA
					FROM MALFLTSEG ASGFLTSEG,
					  FLTOPRLEG LEG
					WHERE ASGFLTSEG.CMPCOD                                  = LEG.CMPCOD
					AND ASGFLTSEG.FLTCARIDR                                 = LEG.FLTCARIDR
					AND ASGFLTSEG.FLTNUM                                    = LEG.FLTNUM
					AND ASGFLTSEG.FLTSEQNUM                                 = LEG.FLTSEQNUM
					AND ASGFLTSEG.CMPCOD                                    = ?
					AND ASGFLTSEG.POU                                       =LEG.LEGDST
					  %s
					  FROM SHRUSEARPPAR ARPPAR1
					  WHERE ARPPAR1.CMPCOD                   = LEG.CMPCOD
					  AND ARPPAR1.PARCOD                     ='mailtracking.defaults.staoffsetforarrival'
					  AND ARPPAR1.ARPCOD                     = ASGFLTSEG.POU
					  AND TO_NUMBER(COALESCE(ARPPAR1.PARVAL,'0')) > 0
					  ) ))
					AND( NOT EXISTS
					  (SELECT 1
					  FROM MALFLT INBFLT
					  WHERE ASGFLTSEG.CMPCOD  = INBFLT.CMPCOD
					  AND ASGFLTSEG.FLTNUM    =INBFLT.FLTNUM
					  AND ASGFLTSEG.FLTSEQNUM = INBFLT.FLTSEQNUM
					  AND ASGFLTSEG.POU       = INBFLT.ARPCOD
					  AND ASGFLTSEG.FLTCARIDR = INBFLT.FLTCARIDR
					  AND INBFLT.IMPCLSFLG       = 'C'
					  ) )
			]]>
	</QRY:Source>
  </QRY:Definition>
	 <QRY:Definition>
		<QRY:Id>290</QRY:Id>
		<QRY:Source Name="mail.operations.findFlightForMailOperationClosure" Type="NATIVE">
			<![CDATA[
	      			SELECT LEG.CMPCOD,LEG.FLTCARIDR,LEG.FLTNUM,LEG.FLTSEQNUM,LEG.LEGSERNUM,
				       LEG.STA,LEG.STD,MTK.FLTCARCOD, MTK.ARPCOD LEGORG ,LEG.LEGDST,ARPPAR.PARVAL,FLTSEG.POU,LEG.STD FLTDAT,LEG.STA ,FLT.FLTROU ,FLT.FLTTYP,FLT.FLTOWN
				FROM MALFLT MTK,FLTOPRMST FLT,FLTOPRLEG LEG,SHRUSEARPPAR ARPPAR,MALFLTSEG FLTSEG
				WHERE MTK.CMPCOD = FLT.CMPCOD AND
				      MTK.FLTCARIDR = FLT.FLTCARIDR AND
					  MTK.FLTNUM = FLT.FLTNUM AND
					  MTK.FLTSEQNUM = FLT.FLTSEQNUM AND
				      MTK.CMPCOD = LEG.CMPCOD AND
				      MTK.FLTCARIDR = LEG.FLTCARIDR AND
				      MTK.FLTNUM = LEG.FLTNUM AND
				      MTK.FLTSEQNUM= LEG.FLTSEQNUM AND
				      MTK.LEGSERNUM = LEG.LEGSERNUM AND
				      %s
                      AND ARPPAR.PARCOD ='mailtracking.defaults.departureOffset'
					  AND MTK.EXPCLSFLG = 'O'
						AND MTK.CMPCOD = FLTSEG.CMPCOD
						AND MTK.FLTNUM=FLTSEG.FLTNUM
						AND MTK.FLTSEQNUM = FLTSEG.FLTSEQNUM
						AND MTK.FLTCARIDR = FLTSEG.FLTCARIDR
			            AND MTK.ARPCOD = FLTSEG.POL
						AND ARPPAR.CMPCOD = FLTSEG.CMPCOD
						      AND ARPPAR.ARPCOD = FLTSEG.POL
						AND TO_NUMBER(COALESCE(ARPPAR.PARVAL,'0')) >0
	      			      AND MTK.CMPCOD = ?
			]]>
		</QRY:Source>
 	</QRY:Definition>
	<QRY:Definition>
			<QRY:Id>187</QRY:Id>
			<QRY:Source Name="mail.operations.findanycontainerinassignedflight" Type="NATIVE">
				<![CDATA[
					SELECT 1 CON
  						FROM MALFLT FLT INNER JOIN MALFLTSEG FLTSEG
					    ON FLT.FLTCARIDR = FLTSEG.FLTCARIDR
							 AND FLT.FLTNUM = FLTSEG.FLTNUM
							 AND FLT.FLTSEQNUM = FLTSEG.FLTSEQNUM
							 AND FLT.CMPCOD = FLTSEG.CMPCOD
						     AND FLT.ARPCOD=FLTSEG.POL
						   INNER JOIN MALULDSEG ULDSEG
						   ON FLTSEG.FLTCARIDR = ULDSEG.FLTCARIDR
							 AND FLTSEG.FLTNUM = ULDSEG.FLTNUM
							 AND FLTSEG.FLTSEQNUM = ULDSEG.FLTSEQNUM
							 AND FLTSEG.SEGSERNUM = ULDSEG.SEGSERNUM
							 AND FLTSEG.CMPCOD = ULDSEG.CMPCOD
					 WHERE
					     FLT.CMPCOD = ?
						AND FLT.FLTCARIDR = ?
						AND FLT.FLTNUM = ?
						AND FLT.FLTSEQNUM = ?
						AND FLT.ARPCOD = ?
						AND	FLT.LEGSERNUM = ?
						
				 ]]>
			</QRY:Source>
		</QRY:Definition>
<QRY:Definition>
	<QRY:Id>274</QRY:Id>
	 <QRY:Source Name="mail.operations.findimportflightsforarrival" Type="NATIVE">
		<![CDATA[
				SELECT FLTSEG.CMPCOD,
  SHR.TWOAPHCOD FLTCARCOD,
			  FLTSEG.FLTCARIDR,
			  FLTSEG.FLTNUM,
			  FLTSEG.FLTSEQNUM,
			  LEG.LEGSERNUM,
  FLTSEG.POU,
  LEG.STA FLTDAT,
  FLTSEG.POL,
  FLTSEG.POU,
  FLTSEG.SEGSERNUM,
  LEG.LEGDST,
				LEG.ATA AS ARRIVALTIME
			FROM FLTOPRLEG LEG,
			  MALFLTSEG FLTSEG,
  SHRSYSPAR PERIOD1,
  SHRSYSPAR OFFSET1,
			  SHRARLMST_VW SHR
			WHERE FLTSEG.CMPCOD  = LEG.CMPCOD
			AND FLTSEG.FLTNUM    =LEG.FLTNUM
			AND FLTSEG.FLTSEQNUM = LEG.FLTSEQNUM
			AND FLTSEG.FLTCARIDR = LEG.FLTCARIDR
			AND LEG.LEGDST = FLTSEG.POU
			AND SHR.CMPCOD = FLTSEG.CMPCOD
			AND SHR.ARLIDR = FLTSEG.FLTCARIDR
AND OFFSET1.CMPCOD   = LEG.CMPCOD
AND OFFSET1.PARCOD   = 'mailtracking.defaults.autoclosurejoboffset'
AND PERIOD1.CMPCOD   = LEG.CMPCOD
AND PERIOD1.PARCOD   = 'mailtracking.defaults.autoclosurejobperiod'
			AND FLTSEG.CMPCOD    = ?
%s
			AND( NOT EXISTS
  (SELECT INBFLT.CMPCOD,
    INBFLT.FLTCARIDR,
    INBFLT.FLTNUM,
    INBFLT.FLTSEQNUM,
    INBFLT.LEGSERNUM,
    INBFLT.arpcod
			  FROM MALFLT INBFLT
			  WHERE LEG.CMPCOD  = INBFLT.CMPCOD
			  AND LEG.FLTNUM    =INBFLT.FLTNUM
			  AND LEG.FLTSEQNUM = INBFLT.FLTSEQNUM
			  AND LEG.LEGSERNUM = INBFLT.LEGSERNUM
			  AND LEG.FLTCARIDR = INBFLT.FLTCARIDR
			  AND INBFLT.arpcod    = LEG.LEGDST
                AND INBFLT.IMPCLSFLG = 'C'
                )
			OR EXISTS
			  (SELECT 1
			  FROM MALULDSEGDTL MALSEG,
				SHRSYSPAR SYSPAR
							WHERE MALSEG.CMPCOD = FLTSEG.CMPCOD
								AND MALSEG.FLTNUM=FLTSEG.FLTNUM
								AND MALSEG.FLTSEQNUM = FLTSEG.FLTSEQNUM
								AND MALSEG.FLTCARIDR = FLTSEG.FLTCARIDR
								AND MALSEG.SEGSERNUM = FLTSEG.SEGSERNUM
                 AND SYSPAR. PARCOD = 'mailtracking.defaults.importmailstomra'
			  AND SYSPAR.PARVAL    = 'Y'
  AND MALSEG.DLVSTA   <> 'Y'
  AND TRAFLG          <> 'Y'
			  ) )
			AND EXISTS
			  (SELECT 1
			  FROM SHRUSEARPPAR ARPPAR
						      WHERE ARPPAR.CMPCOD = FLTSEG.CMPCOD
						      AND ARPPAR.ARPCOD = FLTSEG.POU
						      AND ARPPAR.PARCOD ='mailtracking.defaults.nonMechanisedPort'
							AND ARPPAR.PARVAL ='Y'
				)

		]]>
	 </QRY:Source>
	 </QRY:Definition>
	  <QRY:Definition>
			<QRY:Id>275</QRY:Id>
				<QRY:Source Name="mail.operations.finddespatches" Type="NATIVE">
				<![CDATA[
						SELECT MAX(MALMST.CMPCOD)CMPCOD,
						          MAX(MALMST.CSGDOCNUM) CSGDOCNUM,
						          MAX(MALMST.POACOD) POACOD,
						          MAX(MALMST.CSGSEQNUM)CSGSEQNUM,
						          MAX(MALMST.DSN)DSN,
						          MAX(MALMST.ORGEXGOFC)ORGEXGOFC,
						          MAX(MALMST.DSTEXGOFC)DSTEXGOFC,
						          MAX(MALMST.MALCLS)MALCLS,
						          MAX(MALMST.YER)YER,
						          MAX(MALMST.MALSEQNUM)MALSEQNUM,
						          MAX(MALMST.MALIDR)MALIDR,
						          MAX(MALMST.MALCTG) MALCTGCOD,
						          MAX(MALMST.MALSUBCLS) MALSUBCLS,
						          MAX(MALMST.HSN) HSN,
						          MAX(MALMST.RSN)RSN,
						          MAX(MALMST.REGIND)REGIND,
						          MAX(COALESCE(ULDSEG.ACPBAG,CSGMAL.BAGCNT ))ACPBAG,
						          MAX(COALESCE(ULDSEG.ACPWGT,MALMST.WGT ))ACPWGT,
						          MAX(COALESCE(ULDSEG.ULDNUM,CSGMAL.ULDNUM)) ULDNUM,
						          MAX(COALESCE(ULDSEG.ULDNUM,MALMST.CONNUM)) CONNUM,
						          MAX(CSGMST.CSGDAT) CSGDAT,
						          MAX(CONMST.CONTYP) CONTYP,
						          MAX(
						          CASE
						            WHEN ULDSEG.ULDNUM IS NULL
						            THEN 'CAP'
						            ELSE ''
						          END) DSNSTA,
								  MAX (
									CASE
									  WHEN MALMST.MALTYP = 'M'
									  THEN 'Y'
									  ELSE 'N'
								   END) AS PLTENBFLG,
						          MAX(COALESCE(FLT.ARPCOD ,CSGMST.ARPCOD)) ARPCOD,
						          MAX(COALESCE (ULDSEG.FLTNUM , RTG.FLTNUM)) FLTNUM,
						          MAX( COALESCE(FLT.FLTDAT, RTG.FLTDAT)) FLTDAT,
						          MAX(COALESCE(FLT.FLTCARCOD, RTG.FLTCARCOD)) FLTCARCOD,
						          MAX(CONMST.POU)POU,
						          MAX(CONMST.DSTCOD)DSTCOD,
						          MAX(ULDSEG.RCVBAG)RCVBAG,
						          MAX(ULDSEG.RCVWGT)RCVWGT,
						          MAX(ULDSEG.TRAFLG) TRAFLG,
						          MAX(ULDSEG.STDBAG) STDBAG,
						          MAX(ULDSEG.STDWGT) STDWGT,
						          MAX(ULDSEG.ACPUSR) ACPUSR,
						          MAX(ULDSEG.ACPDAT) ACPDAT,
						          MAX(ULDSEG.DLVSTA) DLVFLG,
						          MAX(CONMST.POAFLG)POAFLG ,
						          '' OFLFLG,
						          MAX(FLT.LEGSERNUM) LEGSERNUM,
						          MALMST.DSNIDR
							FROM MALMST MALMST
							INNER JOIN SHRCTYMST ORGCTY
							ON ORGCTY.CMPCOD  = MALMST.CMPCOD
							AND ORGCTY.CTYCOD =
							  (SELECT CTYCOD
							  FROM MALEXGOFCMST
							  WHERE CMPCOD  = MALMST.CMPCOD
							  AND EXGOFCCOD = MALMST.ORGEXGOFC
							  )
							INNER JOIN SHRCTYMST DSTCTY
							ON DSTCTY.CMPCOD  = MALMST.CMPCOD
							AND DSTCTY.CTYCOD =
							  (SELECT CTYCOD
							  FROM MALEXGOFCMST
							  WHERE CMPCOD  = MALMST.CMPCOD
							  AND EXGOFCCOD = MALMST.DSTEXGOFC
							  )
							LEFT OUTER JOIN MALCSGMST CSGMST
							ON CSGMST.CMPCOD     = MALMST.CMPCOD
							AND CSGMST.CSGDOCNUM = MALMST.CSGDOCNUM
							AND CSGMST.POACOD    = MALMST.POACOD
							AND CSGMST.CSGSEQNUM = MALMST.CSGSEQNUM
							LEFT OUTER JOIN MALCSGDTL CSGMAL
							ON CSGMAL.CMPCOD     = CSGMST.CMPCOD
							AND CSGMAL.CSGDOCNUM = CSGMST.CSGDOCNUM
							AND CSGMAL.POACOD    = CSGMST.POACOD
							AND CSGMAL.CSGSEQNUM = CSGMST.CSGSEQNUM
							LEFT OUTER JOIN MALULDSEGDTL ULDSEG
							ON ULDSEG.CMPCOD     = MALMST.CMPCOD
							AND ULDSEG.MALSEQNUM = MALMST.MALSEQNUM
							LEFT OUTER JOIN MALFLT FLT
							ON ULDSEG.CMPCOD     = FLT.CMPCOD
							AND ULDSEG.FLTCARIDR = FLT.FLTCARIDR
							AND ULDSEG.FLTNUM    = FLT.FLTNUM
							AND ULDSEG.FLTSEQNUM = FLT.FLTSEQNUM
							LEFT OUTER JOIN MALFLTCON CONMST
							ON CONMST.FLTCARIDR  = FLT.FLTCARIDR
							AND CONMST.FLTNUM    = FLT.FLTNUM
							AND CONMST.FLTSEQNUM = FLT.FLTSEQNUM
							AND CONMST.LEGSERNUM = FLT.LEGSERNUM
							AND ULDSEG.CONNUM       = CONMST.CONNUM
							AND ULDSEG.SEGSERNUM    = CONMST.SEGSERNUM
							LEFT OUTER JOIN MALCSGRTG RTG
							ON RTG.CMPCOD     = MALMST.CMPCOD
							AND RTG.CSGDOCNUM = MALMST.CSGDOCNUM
							AND RTG.POACOD    = MALMST.POACOD
							AND RTG.CSGSEQNUM = MALMST.CSGSEQNUM
							AND RTG.RTGSERNUM = 1
							 WHERE
					    ]]>
				</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>276</QRY:Id>
		<QRY:Source Name="mail.operations.findupucodenameforpostalauthority" Type="NATIVE">
			<![CDATA[
			SELECT DTL.PARVAL||'-'||DTL.PTYIDR UPUCODNAME
			  FROM MALPOADTL DTL
			 WHERE DTL.CMPCOD = ?
			 AND DTL.POACOD = ? AND  DTL.PARCOD='UPUCOD' AND TRUNC(current_date) between TRUNC(DTL.VLDFRM) and TRUNC(DTL.VLDTOO)

				]]>
		</QRY:Source>
		</QRY:Definition>
		 <QRY:Definition>
		<QRY:Id>277</QRY:Id>
		<QRY:Source Name="mail.operations.findpacodeformailboxid" Type="NATIVE">
			<![CDATA[

			SELECT  MAX(MST.POACOD)
			  FROM MALEXGOFCMST MST
			 WHERE MST.CMPCOD = ?
			 AND MST.MALBOXIDR = ? AND  MST.ACTFLG='A'
			 AND MST.EXGOFCCOD = ?

				]]>
		</QRY:Source>
		</QRY:Definition>
		<QRY:Definition>
        <QRY:Id>278</QRY:Id>
        <QRY:Source Name="mail.operations.findpendinguldresdits" Type="OBJECT">
			<![CDATA[
			SELECT RESDIT FROM ULDRESDIT RESDIT
					WHERE RESDIT.ULDRESDITPK.COMPANYCODE = ?
					AND     RESDIT.ULDRESDITPK.ULDNUMBER = ?
					AND RESDIT.ULDRESDITPK.EVENTCODE = ?
					AND RESDIT.EVENTAIRPORT = ?
					AND RESDIT.CARRIERID = ?
			]]>
         </QRY:Source>
  </QRY:Definition>
  <QRY:Definition>
	<QRY:Id>279</QRY:Id>
	<QRY:Source Name="mail.operations.findresditevents" Type="NATIVE">
		<![CDATA[
			SELECT    EVT.CSGDOCNUM,
  					  EVT.EVTCOD         ,
					  EVT.EVTPRT         ,
					  EVT.MSGSEQNUM      ,
					  EVT.POACOD         ,
					  EVT.MSGVERNUM      ,
					  ARP.ARPNAM         ,
					  EVT.CDTEXT         ,

					  EVT.EVTDAT,
					  MST.ACTSDRIDR		 ,
					  MST.RCTIDR,
					  MALBOX.MALBOXDES,
                      EVT.FLTCARIDR,
                      EVT.FLTNUM,
                      EVT.FLTSEQNUM,
                      EVT.SEGSERNUM,
					  EVT.SHPPFX,
					  EVT.MSTDOCNUM,
					  (SELECT
                        CASE
                            WHEN arl.aphcoduse = 2 THEN arl.twoaphcod
                            WHEN arl.aphcoduse = 3 THEN arl.thraphcod
                        END
                        FROM shrarlmst arl WHERE
                        EVT.cmpcod = arl.cmpcod
                        AND EVT.fltcaridr = arl.arlidr) FLTCARCOD,

            MALBOX.RDTVERNUM,
            MALBOX.MSGEVTLOC,
            MALBOX.PRTRDT
					   FROM MALRDTEVT EVT
					LEFT OUTER JOIN MALCDTMST MST
						 ON MST.CMPCOD = EVT.CMPCOD
					AND MST.CSGDOCNUM  = EVT.CSGDOCNUM
					AND MST.SDRIDR     = EVT.POACOD
					AND EVT.CDTEXT     = 'Y'
          LEFT OUTER JOIN MALMALBOX MALBOX
          ON EVT.CMPCOD=MALBOX.CMPCOD
          AND COALESCE(MST.ACTSDRIDR,EVT.MALBOXIDR)=MALBOX.MALBOXIDR          
					LEFT OUTER JOIN SHRARPMST ARP
						 ON EVT.CMPCOD =ARP.CMPCOD
					AND EVT.EVTPRT     = ARP.ARPCOD
					  WHERE EVT.CMPCOD = ?
					AND EVT.RDTREDTIM  = 'N'
					ORDER BY EVT.MSGSEQNUM
			]]>
	</QRY:Source>
</QRY:Definition>
<QRY:Definition>
		<QRY:Id>280</QRY:Id>
		<QRY:Source Name="mail.operations.findMailbagsforFlightSegments" Type="NATIVE">
			<![CDATA[
				SELECT 1
					FROM MALFLTSEG seg
						LEFT OUTER JOIN MALULDSEGDTL MALSEG
						ON seg.fltnum  =malseg.fltnum
					AND seg.fltcaridr =malseg.fltcaridr
					AND seg.segsernum = malseg.segsernum
					AND seg.fltseqnum = malseg.fltseqnum
						AND SEG.CMPCOD = MALSEG.CMPCOD
						INNER JOIN  MALFLTCON FLTCON
						ON fltcon.fltnum  =SEG.fltnum
						AND fltcon.fltcaridr =SEG.fltcaridr
						AND fltcon.segsernum = SEG.segsernum
						AND fltcon.FLTSEQNUM = SEG.FLTSEQNUM
						AND FLTCON.CMPCOD = SEG.CMPCOD
					AND seg.cmpcod = ?
					AND seg.fltnum  = ?
					AND seg.fltcaridr =?
					AND seg.fltseqnum =?
			]]>
		</QRY:Source>
	</QRY:Definition>
 <QRY:Definition>
<QRY:Id>285</QRY:Id>
<QRY:Source Name="mail.operations.findmailbagsfortransportcompletedresdit" Type="NATIVE">
                <![CDATA[
				SELECT MST.MALIDR,MST.DSTEXGOFC,
				  MST.SEGSERNUM,
				  MST.SCNDAT,
				  MST.CONNUM ULDNUM,
				  MST.SCNPRT,
				  MST.CONTYP,
				  MST.MALSEQNUM,
				  MST.POU,
          MST.ORGEXGOFC,
          MST.DSTEXGOFC,
          MST.ORGCOD,
          MST.DSTCOD,
          MST.MALCTG,
          MST.MALSUBCLS,
          MST.CSGDOCNUM,
          FLT.FLTCARCOD
				FROM MALFLT FLT ,
				  MALMST MST
				WHERE FLT.FLTCARIDR =MST.FLTCARIDR
				AND FLT.FLTNUM      =MST.FLTNUM
				AND FLT.FLTSEQNUM   =MST.FLTSEQNUM
				AND FLT.ARPCOD      =MST.SCNPRT
				AND FLT.CMPCOD      =MST.CMPCOD
				AND MST.CMPCOD      = ?
				AND MST.FLTCARIDR   = ?
				AND MST.FLTNUM      = ?
				AND MST.FLTSEQNUM   = ?
				AND MST.POU         = ?
				UNION
				  (SELECT MST.MALIDR,MST.DSTEXGOFC,
					MST.SEGSERNUM,
					MST.SCNDAT,
					MST.CONNUM,
					MST.SCNPRT,
					MST.CONTYP,
					MST.MALSEQNUM,
					MST.POU,
          MST.ORGEXGOFC,
          MST.DSTEXGOFC,
          MST.ORGCOD,
          MST.DSTCOD,
          MST.MALCTG,
          MST.MALSUBCLS,
          MST.CSGDOCNUM,
          FLT.FLTCARCOD
				  FROM MALFLT FLT ,
					MALMST MST
				  WHERE FLT.FLTCARIDR =MST.FLTCARIDR
				  AND FLT.FLTNUM      =MST.FLTNUM
				  AND FLT.FLTSEQNUM   =MST.FLTSEQNUM
				  AND FLT.ARPCOD      =MST.SCNPRT
				  AND FLT.CMPCOD      =MST.CMPCOD
				  AND MST.CMPCOD      = ?
				  AND MST.FLTCARIDR   = ?
				  AND MST.FLTNUM      = ?
				  AND MST.FLTSEQNUM   = ?
				  AND MST.SCNPRT      = ?
				  )
     ]]>
  </QRY:Source>
  </QRY:Definition>
<QRY:Definition>
          <QRY:Id>286</QRY:Id>
          <QRY:Source Name="mail.operations.finduldsfortransportcompletedresdit" Type="NATIVE">
				<![CDATA[
					SELECT MST.CONNUM,
					  MST.SEGSERNUM,
					  MST.ASGDAT,
					  MST.ASGPRT,
					  MST.CONJRNIDR,
					  MST.POACOD SBCODE
					FROM MALFLT FLT
					INNER JOIN MALFLTSEG FLTSEG
					ON FLT.FLTCARIDR  =FLTSEG.FLTCARIDR
					AND FLT.FLTNUM    =FLTSEG.FLTNUM
					AND FLT.FLTSEQNUM =FLTSEG.FLTSEQNUM
					AND FLT.CMPCOD    =FLTSEG.CMPCOD
					INNER JOIN MALFLTCON MST
					ON FLTSEG.FLTCARIDR  =MST.FLTCARIDR
					AND FLTSEG.FLTNUM    =MST.FLTNUM
					AND FLTSEG.FLTSEQNUM =MST.FLTSEQNUM
					AND FLTSEG.CMPCOD    =MST.CMPCOD
					AND FLTSEG.POL       = MST.ASGPRT
					AND FLTSEG.POU       = MST.POU
					WHERE
					MST.POAFLG     = 'Y'
					AND MST.CONTYP       = 'U'
					AND FLT.CMPCOD       =?
					AND FLT.FLTCARIDR    =?
					AND FLT.FLTNUM       =?
					AND FLT.FLTSEQNUM    =?
				]]>
		</QRY:Source>
  </QRY:Definition>
	<QRY:Definition>
	<QRY:Id>287</QRY:Id>
	<QRY:Source Name="mail.operations.findalluldresdits" Type="OBJECT">
			<![CDATA[
			SELECT resdit FROM UldResdit resdit
				WHERE resdit.uldResditPK.companyCode = ?
				AND	resdit.uldResditPK.uldNumber = ?
				AND resdit.uldResditPK.eventCode = ?
				AND resdit.eventAirport = ?
				AND resdit.carrierId = ?
				AND resdit.flightNumber = ?
				AND resdit.flightSequenceNumber = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
  <QRY:Definition>
	<QRY:Id>295</QRY:Id>
	<QRY:Source Name="mail.operations.findOperationalFlightForMRD" Type="NATIVE">
		<![CDATA[
				  SELECT
					  FLTLEG.ATA ATA,
					  FLTMST.CMPCOD CMPCOD,
					  FLTMST.FLTNUM FLTNUM,
					  (SELECT TWOAPHCOD
					  FROM SHRARLMST
					  WHERE CMPCOD  = FLTMST.CMPCOD
					  AND ARLIDR = FLTLEG.FLTCARIDR) FLTCARCOD,
					  FLTMST.FLTCARIDR FLTCARIDR,
					  FLTMST.FLTSEQNUM FLTSEQNUM,
					  FLTMST.FLTDAT FLTDAT,
					  FLTLEG.LEGDST LEGDST,
					  FLTLEG.LEGORG LEGORG,
					  FLTLEG.STA STA
					FROM FLTOPRMST FLTMST
					INNER JOIN FLTOPRLEG FLTLEG
					ON FLTMST.CMPCOD   = FLTLEG.CMPCOD
					AND FLTMST.FLTNUM  = FLTLEG.FLTNUM
						AND FLTMST.FLTCARIDR=FLTLEG.FLTCARIDR
					AND FLTMST.FLTSEQNUM =  FLTLEG.FLTSEQNUM


				  ]]>
	</QRY:Source>
  </QRY:Definition>
<QRY:Definition>
	<QRY:Id>280</QRY:Id>
		<QRY:Source Name="mail.operations.findcarditreferencedetails" Type="NATIVE">
			<![CDATA[
				SELECT
					RFF.* , MST.CSGDOCNUM
				FROM
					MALCDTMST MST , MALCDTREF RFF
				WHERE
					MST.CDTKEY = RFF.CDTKEY AND
					MST.CMPCOD = RFF.CMPCOD AND
					RFF.RFFQLF = 'AHI' AND
					MST.CDTTYP <> '1' AND
					MST.CMPCOD = ?

			]]>
			</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
		<QRY:Id>296</QRY:Id>
		<QRY:Source Name="mail.operations.findconsignmentroutingdetails" Type="NATIVE">
			<![CDATA[
				    SELECT   RTG.CMPCOD, RTG.CSGDOCNUM, RTG.CSGSEQNUM, RTG.POACOD,
         				  RTG.RTGSERNUM, RTG.FLTCARCOD, ARL.ARLIDR,
						  RTG.FLTNUM, RTG.FLTDAT, RTG.POU, RTG.POL
					FROM MALCSGRTG RTG INNER JOIN SHRARLMST ARL
						  ON ARL.CMPCOD = RTG.CMPCOD
						  AND ARL.TWOAPHCOD = RTG.FLTCARCOD
				    WHERE RTG.CMPCOD = ?
						  AND RTG.CSGDOCNUM = ?
						  AND RTG.POACOD = ?
						  AND RTG.CSGSEQNUM = (SELECT MAX(CSGSEQNUM) FROM MALCSGRTG WHERE CMPCOD  = ?
								AND CSGDOCNUM = ? AND RTG.POACOD    = ?)
				   ORDER BY RTGSERNUM
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>284</QRY:Id>
		<QRY:Source Name="mail.operations.findcitycodeforexchangeoffice" Type="NATIVE">
			<![CDATA[
				SELECT CTYCOD
				  FROM MALEXGOFCMST
				  WHERE CMPCOD = ?
					AND EXGOFCCOD = ?
			]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
		<QRY:Id>310</QRY:Id>
		<QRY:Source Name="mail.operations.findroutingdetails" Type="NATIVE">
			<![CDATA[
			 SELECT TRT.CMPCOD,
			  TRT.CARCOD      ,
			  TRT.CARIDR      ,
			  TRT.FLTNUM      ,
			  TRT.FLTSEQNUM   ,
			  TRT.ORGCOD  POL    ,
			  TRT.DSTCOD  POU    ,
			  TRT.ARRDAT      ,
			  TRT.DEPTIM
			   FROM MALCDTMST MST
			INNER JOIN MALCDTTRT TRT
			     ON MST.CMPCOD = TRT.CMPCOD
			AND MST.CDTKEY     = TRT.CDTKEY
			  WHERE MST.CMPCOD = ?
			AND MST.CSGDOCNUM  = ?
			AND MST.SDRIDR     = ?
			ORDER BY TRTSERNUM
					]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
				<QRY:Id>311</QRY:Id>
				<QRY:Source Name="mail.operations.findmailbagforresditfromcardit" Type="NATIVE">
									<![CDATA[
									SELECT DISTINCT RCP.RCPIDR MALIDR,RDT.EVTDATUTC,RDT.ULDNUM,RDT.POACARCOD,FLT.FLTCARCOD,RDT.SEQNUM,null MALBOXIDR,null PTYIDR,RCP.DSPIDR,'UL' EQPQLF
									FROM MALULDRDT RDT
         							  LEFT OUTER JOIN MALFLT FLT
												ON RDT.CMPCOD = FLT.CMPCOD
												AND RDT.FLTCARIDR  = FLT.FLTCARIDR
												AND RDT.FLTNUM     = FLT.FLTNUM
												AND RDT.FLTSEQNUM  = FLT.FLTSEQNUM
									  INNER JOIN MALCDTMST CDT
												ON RDT.CMPCOD   = CDT.CMPCOD
												AND RDT.CDTKEY  = CDT.CDTKEY
									  INNER JOIN MALCDTRCP RCP
											  ON RDT.CMPCOD = RCP.CMPCOD
											     AND RDT.CDTKEY     = RCP.CDTKEY
												 AND RDT.CONJRNIDR = RCP.DSPIDR
									          	  WHERE RDT.CMPCOD = ?
												  AND RDT.MSGSEQNUM  = ?
												  AND RDT.EVTCOD     = ?
												  AND RDT.RDTSND     = ?
												  AND RDT.EVTPRT     = ?
									]]>
				</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
		<QRY:Id>312</QRY:Id>
			<QRY:Source Name="mail.operations.findulddetailsforresdit" Type="NATIVE">
				<![CDATA[
				SELECT ULDRDT.ULDNUM,ULDRDT.SEQNUM,ULDRDT.EVTDATUTC,ULDRDT.POACARCOD,
				  CDTCON.EQPQLF, CDTCON.NUMCODLSTAGY, CDTCON.TYPCOD,
				  (CASE WHEN ARL.APHCODUSE = 2  THEN ARL.TWOAPHCOD
	                            ELSE ARL.THRAPHCOD END)  AS FLTCARCOD,CDTCON.CONJRNIDR
				FROM MALULDRDT ULDRDT
				  INNER JOIN MALCDTCON CDTCON ON
				  	CDTCON.CMPCOD = ULDRDT.CMPCOD
				   AND CDTCON.CDTKEY = ULDRDT.CDTKEY
				   AND CDTCON.CONNUM = ULDRDT.ULDNUM
				 INNER JOIN MALCDTMST CDTMST ON
				  	CDTCON.CMPCOD = CDTMST.CMPCOD
				 	AND CDTCON.CDTKEY = CDTMST.CDTKEY
				 LEFT OUTER JOIN SHRARLMST ARL ON
				 	ULDRDT.CMPCOD = ARL.CMPCOD
				 	AND ULDRDT.FLTCARIDR= ARL.ARLIDR
				WHERE CDTMST.CMPCOD = ?
				   AND CDTMST.CSGDOCNUM = ?
				   AND ULDRDT.EVTCOD = ?
				   AND ULDRDT.RDTSND = ?
				   AND ULDRDT.EVTPRT = ?
				   AND ULDRDT.MSGSEQNUM = ?
				]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>333</QRY:Id>
		<QRY:Source Name="mail.operations.findmailresditsforresditstatusupdate" Type="OBJECT">
				<![CDATA[
				 SELECT resdit FROM MailResdit resdit
					 WHERE resdit.mailResditPK.companyCode = ?
					 AND resdit.interchangeControlReference = ?
				]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>334</QRY:Id>
	<QRY:Source Name="mail.operations.finduldresditsforresditstatusupdate" Type="OBJECT">
				<![CDATA[
				 SELECT resdit FROM UldResdit resdit
					 WHERE resdit.uldResditPK.companyCode = ?
					 AND resdit.interchangeControlReference = ?
				]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>335</QRY:Id>
		<QRY:Source Name="mail.operations.findallmailresditsforfilelog" Type="OBJECT">
				<![CDATA[
				 SELECT mailresditfilelog FROM MailResditFileLog mailresditfilelog
					 WHERE mailresditfilelog.mailResditFileLogPK.companyCode = ?
					 AND mailresditfilelog.mailResditFileLogPK.interchangeControlReference = ?
					 AND mailresditfilelog.resditFileName = ?
				]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>137</QRY:Id>
	<QRY:Source Name="mail.operations.findotherdsnsforsameawb" Type="OBJECT">
			<![CDATA[
			SELECT  ULDSEG.FLTCARIDR,
				  ULDSEG.FLTNUM,
				  ULDSEG.FLTSEQNUM,
				  ULDSEG.SEGSERNUM,
				  MST.DSN,
				  MST.ORGEXGOFC,
				  MST.DSTEXGOFC,
				  MST.MALCTG,
				  MST.MALSUBCLS,
				  MST.YER,
				  ULDSEG.ULDNUM,
				  ULDSEG.CMPCOD ,
				  ULDSEG.ACPBAG BAGS ,
				  ULDSEG.ACPWGT WGT
				FROM MALULDSEGDTL ULDSEG,
				MALMST MST
				WHERE  MST.CMPCOD = ULDSEG.CMPCOD AND
			   MST.MALSEQNUM = ULDSEG.MALSEQNUM AND
			   ULDSEG.CMPCOD= ?   AND
               MST.DOCOWRIDR = ?    AND
		       MST.MSTDOCNUM = ?  AND
		       MST.DUPNUM = ?   AND
		       MST.SEQNUM = ?   AND
			   NOT EXISTS (SELECT  1 FROM MALULDSEGDTL WHERE
								 ULDSEG.CMPCOD=CMPCOD AND
								 ULDSEG.FLTCARIDR=FLTCARIDR AND
								 ULDSEG.FLTNUM=FLTNUM AND
								 ULDSEG.FLTSEQNUM=FLTSEQNUM AND
								 ULDSEG.SEGSERNUM=SEGSERNUM AND
								 ULDSEG.MALSEQNUM=MALSEQNUM AND
								 ULDSEG.ULDNUM=ULDNUM AND
			                     FLTCARIDR =  ?  AND
					             FLTNUM =   ?  AND
							     FLTSEQNUM = ?  AND
							     SEGSERNUM = ?  AND
								 MALSEQNUM = ? AND
							     ULDNUM= ? )
				]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>142</QRY:Id>
	<QRY:Source Name="mail.operations.findimportmanifestedmailsinbulk" Type="NATIVE">
		<![CDATA[
				SELECT FLT.CMPCOD,
				FLT.FLTNUM,
				FLT.FLTSEQNUM,
				FLT.FLTCARIDR,
				FLT.SEGSERNUM,
				FLT.POL,
				ULD.ULDNUM,
				MST.DSN,
				MST.ORGEXGOFC,
				MST.DSTEXGOFC,
				MST.YER,
				MST.MALCTG MALCTGCOD,
				MST.MALSUBCLS,
				MST.MALCLS,
				MST.RSN,
				MST.HSN,
				MST.REGIND,
				MST.WGT,
				MST.DSPWGT,
				MST.DSPWGTUNT,
				CASE
				WHEN MST.MALTYP='D'
				THEN 'N'
				ELSE 'Y'
				END PLTENBFLG,
				CSGMST.CSGDOCNUM CSGDOCNUM,
				CSGMST.CSGSEQNUM CSGSEQNUM,
				CSGMST.POACOD POACOD,
				CSGMST.CSGDAT CSGDAT,
				MST.DSPDAT ACPDAT,
				MALSEG.ACPWGT CSGACPWGT,
				MALSEG.ACPBAG CSGACPBAG,
				MALSEG.STDBAG CSGSTDBAG,
				MALSEG.STDWGT CSGSTDWGT,
				NULL ACPUSR,
				MST.MALIDR MALIDR,
				MALSEG.DMGFLG DMGFLG,
				MALSEG.DLVSTA DLVSTA,
				MALSEG.FRMCARCOD MALFRMCARCOD,
				MALSEG.CONNUM,
				'B' AS CONTYP,
				(SELECT MST.SCNDAT
				FROM MALMST MST
				WHERE MST.CMPCOD  = MALSEG.CMPCOD
				AND MST.MALSEQNUM = MALSEG.MALSEQNUM
				AND MST.FLTCARIDR = MALSEG.FLTCARIDR
				AND MST.FLTNUM    = MALSEG.FLTNUM
				AND MST.FLTSEQNUM = MALSEG.FLTSEQNUM
				AND MST.SEGSERNUM = MALSEG.SEGSERNUM
				AND MST.CONNUM    = MALSEG.CONNUM
				AND MST.MALSTA   IN (?,?,?,?)
				AND MST.SCNPRT    = ?
				) SCNDAT
				FROM MALFLTSEG FLT
				INNER JOIN MALULDSEG ULD
				ON FLT.CMPCOD     = ULD.CMPCOD
				AND FLT.FLTCARIDR = ULD.FLTCARIDR
				AND FLT.FLTNUM    = ULD.FLTNUM
				AND FLT.FLTSEQNUM = ULD.FLTSEQNUM
				AND FLT.SEGSERNUM = ULD.SEGSERNUM
				LEFT OUTER JOIN MALULDSEGDTL MALSEG
				ON ULD.CMPCOD     = MALSEG.CMPCOD
				AND ULD.FLTCARIDR = MALSEG.FLTCARIDR
				AND ULD.FLTNUM    = MALSEG.FLTNUM
				AND ULD.FLTSEQNUM = MALSEG.FLTSEQNUM
				AND ULD.SEGSERNUM = MALSEG.SEGSERNUM
				AND ULD.ULDNUM    = MALSEG.ULDNUM
				AND (MALSEG.ACPSTA='Y'
				OR MALSEG.ARRSTA  ='Y')
				INNER JOIN MALMST MST
				ON MALSEG.CMPCOD     = MST.CMPCOD
				AND MALSEG.MALSEQNUM = MST.MALSEQNUM
				LEFT OUTER JOIN MALCSGMST CSGMST
				ON CSGMST.CMPCOD     = MST.CMPCOD
				AND CSGMST.CSGDOCNUM = MST.CSGDOCNUM
				AND CSGMST.POACOD    = MST.POACOD
				AND CSGMST.CSGSEQNUM = MST.CSGSEQNUM
				WHERE ULD.CMPCOD     =?
				AND ULD.FLTCARIDR    = ?
				AND ULD.FLTNUM       = ?
				AND ULD.FLTSEQNUM    = ?
				AND ULD.SEGSERNUM    = ?
				AND FLT.POL          = ?
				AND ULD.ULDNUM       = ?
				ORDER BY DSN,
				ORGEXGOFC,
				DSTEXGOFC,
				YER,
				MALCTGCOD,
				MALSUBCLS,
				MALIDR,
				CSGDOCNUM,
				CSGSEQNUM,
				POACOD
		 ]]>
	  </QRY:Source>
	  </QRY:Definition>
	  <QRY:Definition>
	<QRY:Id>143</QRY:Id>
	<QRY:Source Name="mail.operations.findimportmanifestedmailsinuld" Type="NATIVE">
		<![CDATA[
				SELECT FLT.CMPCOD,
				FLT.FLTNUM,
				FLT.FLTSEQNUM,
				FLT.FLTCARIDR,
				FLT.SEGSERNUM,
				FLT.POL,
				ULD.ULDNUM,
				MST.DSN,
				MST.ORGEXGOFC,
				MST.DSTEXGOFC,
				MST.YER,
				MST.MALCTG MALCTGCOD,
				MST.MALSUBCLS,
				MST.MALCLS,
				MST.RSN,
				MST.HSN,
				MST.REGIND,
				MST.WGT,
				MST.DSPWGT,
				MST.DSPWGTUNT,
				CASE
				WHEN MST.MALTYP='D'
				THEN 'N'
				ELSE 'Y'
				END PLTENBFLG,
				CSGMST.CSGDOCNUM CSGDOCNUM,
				CSGMST.CSGSEQNUM CSGSEQNUM,
				CSGMST.POACOD POACOD,
				CSGMST.CSGDAT CSGDAT,
				MST.DSPDAT ACPDAT,
				MALSEG.ACPWGT CSGACPWGT,
				MALSEG.ACPBAG CSGACPBAG,
				MALSEG.STDBAG CSGSTDBAG,
				MALSEG.STDWGT CSGSTDWGT,
				NULL ACPUSR,
				MST.MALIDR MALIDR,
				MALSEG.DMGFLG DMGFLG,
				MALSEG.DLVSTA DLVSTA,
				MALSEG.FRMCARCOD MALFRMCARCOD,
				MALSEG.CONNUM CONNUM,
				'U' AS CONTYP,
				(SELECT MST.SCNDAT
				FROM MALMST MST
				WHERE MST.CMPCOD  = MALSEG.CMPCOD
				AND MST.MALSEQNUM = MALSEG.MALSEQNUM
				AND MST.FLTCARIDR = MALSEG.FLTCARIDR
				AND MST.FLTNUM    = MALSEG.FLTNUM
				AND MST.FLTSEQNUM = MALSEG.FLTSEQNUM
				AND MST.SEGSERNUM = MALSEG.SEGSERNUM
				AND MST.CONNUM    = MALSEG.CONNUM
				AND MST.MALSTA   IN (?,?,?,?)
				AND MST.SCNPRT    = ?
				) SCNDAT
				FROM MALFLTSEG FLT
				INNER JOIN MALULDSEG ULD
				ON FLT.CMPCOD     = ULD.CMPCOD
				AND FLT.FLTCARIDR = ULD.FLTCARIDR
				AND FLT.FLTNUM    = ULD.FLTNUM
				AND FLT.FLTSEQNUM = ULD.FLTSEQNUM
				AND FLT.SEGSERNUM = ULD.SEGSERNUM
				LEFT OUTER JOIN MALULDSEGDTL MALSEG
				ON ULD.CMPCOD     = MALSEG.CMPCOD
				AND ULD.FLTCARIDR = MALSEG.FLTCARIDR
				AND ULD.FLTNUM    = MALSEG.FLTNUM
				AND ULD.FLTSEQNUM = MALSEG.FLTSEQNUM
				AND ULD.SEGSERNUM = MALSEG.SEGSERNUM
				AND ULD.ULDNUM    = MALSEG.ULDNUM
				AND (MALSEG.ACPSTA='Y'
				OR MALSEG.ARRSTA  ='Y')
				INNER JOIN MALMST MST
				ON MALSEG.CMPCOD     = MST.CMPCOD
				AND MALSEG.MALSEQNUM = MST.MALSEQNUM
				LEFT OUTER JOIN MALCSGMST CSGMST
				ON CSGMST.CMPCOD     = MST.CMPCOD
				AND CSGMST.CSGDOCNUM = MST.CSGDOCNUM
				AND CSGMST.POACOD    = MST.POACOD
				AND CSGMST.CSGSEQNUM = MST.CSGSEQNUM
				WHERE ULD.CMPCOD     =?
				AND ULD.FLTCARIDR    = ?
				AND ULD.FLTNUM       = ?
				AND ULD.FLTSEQNUM    = ?
				AND ULD.SEGSERNUM    = ?
				AND FLT.POL          = ?
				AND ULD.ULDNUM       = ?
				ORDER BY DSN,
				ORGEXGOFC,
				DSTEXGOFC,
				YER,
				MALCTGCOD,
				MALSUBCLS,
				MALIDR,
				CSGDOCNUM,
				CSGSEQNUM,
				POACOD
				]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
<QRY:Id>138</QRY:Id>
	<QRY:Source Name="mail.operations.findMailOnHandDetailsFlight" Type="NATIVE">
<![CDATA[

      SELECT CMPCOD,ASGPRT ,
  DSTCOD ,
  SUBCLSGRP ,
  (
  CASE
    WHEN CONTYP = 'U'
    THEN SUBSTR(CONNUM, 0,3)
    ELSE 'BULK'
  END) CONTYP,
  SUM(
  CASE
    WHEN CONTYP = 'U'
    THEN 1
    ELSE NULL
  END )COUNTOFULD,
  SUM (
  CASE
    WHEN CONTYP = 'B'
    THEN 1
    ELSE 0
  END) NOMT ,
  MIN(SCNDAT) SCNDAT,
  MIN(SCNPRT) SCNPRT,
   SUM(VOL)
FROM (
  (SELECT MST.CMPCOD,
    (
    CASE
      WHEN MST.CONTYP = 'U'
      THEN MST.CONNUM
      ELSE 'BULK'
    END) CONNUM,
    MST.ASGPRT ASGPRT,
    MST.POU ,
    MST.DSTCOD DSTCOD,
    MST.CONTYP CONTYP,
    MST.ARRSTA,
    (SELECT
      CASE
        WHEN ( SUM (
          CASE
            WHEN CLSMST.SUBCLSGRP = 'EMS'
            THEN 1
            ELSE 0
          END) / (COUNT(CLSMST.SUBCLSGRP))) > MIN(PAR.PARVAL/100)
        THEN 'EMS'
        ELSE 'NONEMS'
      END
    FROM MALULDSEGDTL MALSEG ,
      MALSUBCLSMST CLSMST ,
	  MALMST MALMST,
      SHRSYSPAR PAR
    WHERE MST.CMPCOD     =MALSEG.CMPCOD
    AND MST.CONNUM       =MALSEG.CONNUM
    AND MST.FLTCARIDR    =MALSEG.FLTCARIDR
    AND MST.FLTNUM       =MALSEG.FLTNUM
    AND MST.FLTSEQNUM    =MALSEG.FLTSEQNUM
    AND MST.SEGSERNUM    =MALSEG.SEGSERNUM
    AND MALMST.CMPCOD    =MALSEG.CMPCOD
    AND MALMST.FLTNUM    =MALSEG.FLTNUM
    AND MALMST.FLTCARIDR =MALSEG.FLTCARIDR
    AND MALMST.FLTSEQNUM =MALSEG.FLTSEQNUM
    AND MALMST.SEGSERNUM =MALSEG.SEGSERNUM
    AND MALMST.CONNUM    =MALSEG.CONNUM
    AND MALMST.CMPCOD    =CLSMST.CMPCOD
    AND MALMST.MALSUBCLS =CLSMST.SUBCLSCOD
    AND PAR.CMPCOD       = MST.CMPCOD
    AND PAR.PARCOD       = 'mailtracking.defaults.emssubclasspercentage'
    ) SUBCLSGRP ,
    (SELECT MIN(SCNDAT)
    FROM MALULDSEGDTL MALSEG
    WHERE MST.CMPCOD  =MALSEG.CMPCOD
    AND MST.CONNUM    =MALSEG.CONNUM
    AND MST.FLTCARIDR =MALSEG.FLTCARIDR
    AND MST.FLTNUM    =MALSEG.FLTNUM
    AND MST.FLTSEQNUM =MALSEG.FLTSEQNUM
    AND MST.SEGSERNUM =MALSEG.SEGSERNUM
    ) SCNDAT,
	 (SELECT MIN(SCNPRT)
    FROM MALULDSEGDTL MALSEG
    WHERE MST.CMPCOD  =MALSEG.CMPCOD
    AND MST.CONNUM    =MALSEG.CONNUM
    AND MST.FLTCARIDR =MALSEG.FLTCARIDR
    AND MST.FLTNUM    =MALSEG.FLTNUM
    AND MST.FLTSEQNUM =MALSEG.FLTSEQNUM
    AND MST.SEGSERNUM =MALSEG.SEGSERNUM
    ) SCNPRT,
	  (SELECT SUM(MALSEG.WGT/COMMST.DENFAC)
          FROM MALULDSEGDTL MALSEG ,SHRCOMMST COMMST
           WHERE MST.CMPCOD =MALSEG.CMPCOD
           AND MST.CONNUM =MALSEG.CONNUM
           AND MST.FLTCARIDR =MALSEG.FLTCARIDR
           AND MST.FLTNUM =MALSEG.FLTNUM
           AND MST.FLTSEQNUM =MALSEG.FLTSEQNUM
           AND MST.SEGSERNUM =MALSEG.SEGSERNUM
          AND MALSEG.CMPCOD= COMMST.CMPCOD
          AND COMMST.COMCOD = 'MAL'
           ) VOL
  FROM MALFLTCON MST
  INNER JOIN MALFLT ASG
  ON MST.ASGPRT    = ASG.ARPCOD
  AND MST.CMPCOD   =ASG.CMPCOD
  AND MST.FLTCARIDR=ASG.FLTCARIDR
  AND MST.FLTNUM   =ASG.FLTNUM
  AND MST.FLTSEQNUM=ASG.FLTSEQNUM
  AND MST.LEGSERNUM=ASG.LEGSERNUM
  AND (EXISTS
    (SELECT 1
    FROM MALULDSEGDTL MALSEG
    WHERE MST.CMPCOD  =MALSEG.CMPCOD
    AND MST.CONNUM    =MALSEG.CONNUM
    AND MST.FLTCARIDR =MALSEG.FLTCARIDR
    AND MST.FLTNUM    =MALSEG.FLTNUM
    AND MST.FLTSEQNUM =MALSEG.FLTSEQNUM
    AND MST.SEGSERNUM =MALSEG.SEGSERNUM
    ))
  AND MST.CMPCOD         = ?
  AND MST.ASGPRT         = ?
  AND MST.TXNCOD         = 'ASG'
  AND MST.ACPFLG         ='Y'
  AND COALESCE(MST.ARRSTA ,'N')        ='N'
  AND TRUNC(MST.ASGDAT) >= to_date(?, 'DD-MM-yyyy')
  AND TRUNC(MST.ASGDAT) <= to_date(?, 'DD-MM-yyyy')
  AND ASG.EXPCLSFLG        <> 'C'
]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>139</QRY:Id>
	<QRY:Source Name="mail.operations.findMailOnHandDetails" Type="NATIVE">
<![CDATA[
	SELECT CMPCOD,ASGPRT ,
  DSTCOD ,
  SUBCLSGRP ,
  (
  CASE
    WHEN CONTYP = 'U'
    THEN SUBSTR(CONNUM, 0,3)
    ELSE 'BULK'
  END) CONTYP,
  SUM(
  CASE
    WHEN CONTYP = 'U'
    THEN 1
    ELSE NULL
  END )COUNTOFULD,
  SUM (
  CASE
    WHEN CONTYP = 'B'
    THEN 1
    ELSE 0
  END) NOMT ,
  MIN(SCNDAT) SCNDAT,
  MIN(SCNPRT) SCNPRT,
  SUM(VOL)
FROM (
  (SELECT MST.CMPCOD,
    (
    CASE
      WHEN MST.CONTYP = 'U'
      THEN MST.CONNUM
      ELSE 'BULK'
    END) CONNUM,
    MST.ASGPRT ASGPRT,
    MST.POU ,
    MST.DSTCOD DSTCOD,
    MST.CONTYP CONTYP,
    MST.ARRSTA,
    (SELECT
      CASE
        WHEN ( SUM (
          CASE
            WHEN CLSMST.SUBCLSGRP = 'EMS'
            THEN 1
            ELSE 0
          END) / (COUNT(CLSMST.SUBCLSGRP))) > MIN(PAR.PARVAL/100)
        THEN 'EMS'
        ELSE 'NONEMS'
      END
    FROM MALULDSEGDTL MALSEG ,
      MALSUBCLSMST CLSMST ,
	  MALMST MALMST,
      SHRSYSPAR PAR
    WHERE MST.CMPCOD     =MALSEG.CMPCOD
    AND MST.CONNUM       =MALSEG.CONNUM
    AND MST.FLTCARIDR    =MALSEG.FLTCARIDR
    AND MST.FLTNUM       =MALSEG.FLTNUM
    AND MST.FLTSEQNUM    =MALSEG.FLTSEQNUM
    AND MST.SEGSERNUM    =MALSEG.SEGSERNUM
    AND MALMST.CMPCOD    =MALSEG.CMPCOD
    AND MALMST.FLTNUM    =MALSEG.FLTNUM
    AND MALMST.FLTCARIDR =MALSEG.FLTCARIDR
    AND MALMST.FLTSEQNUM =MALSEG.FLTSEQNUM
    AND MALMST.SEGSERNUM =MALSEG.SEGSERNUM
    AND MALMST.CONNUM    =MALSEG.CONNUM
    AND MALMST.CMPCOD    =CLSMST.CMPCOD
    AND MALMST.MALSUBCLS =CLSMST.SUBCLSCOD
    AND PAR.CMPCOD       = MST.CMPCOD
    AND PAR.PARCOD       = 'mailtracking.defaults.emssubclasspercentage'
    ) SUBCLSGRP ,
    (SELECT MIN(SCNDAT)
    FROM MALULDSEGDTL MALSEG
    WHERE MST.CMPCOD  =MALSEG.CMPCOD
    AND MST.CONNUM    =MALSEG.CONNUM
    AND MST.FLTCARIDR =MALSEG.FLTCARIDR
    AND MST.FLTNUM    =MALSEG.FLTNUM
    AND MST.FLTSEQNUM =MALSEG.FLTSEQNUM
    AND MST.SEGSERNUM =MALSEG.SEGSERNUM
    ) SCNDAT,
	 (SELECT MIN(SCNPRT)
    FROM MALULDSEGDTL MALSEG
    WHERE MST.CMPCOD  =MALSEG.CMPCOD
    AND MST.CONNUM    =MALSEG.CONNUM
    AND MST.FLTCARIDR =MALSEG.FLTCARIDR
    AND MST.FLTNUM    =MALSEG.FLTNUM
    AND MST.FLTSEQNUM =MALSEG.FLTSEQNUM
    AND MST.SEGSERNUM =MALSEG.SEGSERNUM
    ) SCNPRT,
	   (SELECT SUM(MALSEG.WGT/COMMST.DENFAC)
          FROM MALULDSEGDTL MALSEG ,SHRCOMMST COMMST
           WHERE MST.CMPCOD =MALSEG.CMPCOD
           AND MST.CONNUM =MALSEG.CONNUM
           AND MST.FLTCARIDR =MALSEG.FLTCARIDR
           AND MST.FLTNUM =MALSEG.FLTNUM
           AND MST.FLTSEQNUM =MALSEG.FLTSEQNUM
           AND MST.SEGSERNUM =MALSEG.SEGSERNUM
          AND MALSEG.CMPCOD= COMMST.CMPCOD
          AND COMMST.COMCOD = 'MAL'
           ) VOL
  FROM MALFLTCON MST
  INNER JOIN MALFLT ASG
  ON MST.ASGPRT    = ASG.ARPCOD
  AND MST.CMPCOD   =ASG.CMPCOD
  AND MST.FLTCARIDR=ASG.FLTCARIDR
  AND MST.FLTNUM   =ASG.FLTNUM
  AND MST.FLTSEQNUM=ASG.FLTSEQNUM
  AND MST.LEGSERNUM=ASG.LEGSERNUM
  AND (EXISTS
    (SELECT 1
    FROM MALULDSEGDTL MALSEG
    WHERE MST.CMPCOD  =MALSEG.CMPCOD
    AND MST.CONNUM    =MALSEG.CONNUM
    AND MST.FLTCARIDR =MALSEG.FLTCARIDR
    AND MST.FLTNUM    =MALSEG.FLTNUM
    AND MST.FLTSEQNUM =MALSEG.FLTSEQNUM
    AND MST.SEGSERNUM =MALSEG.SEGSERNUM
    ))
  AND MST.CMPCOD         =?
  AND MST.ASGPRT         =?
  AND MST.TXNCOD         = 'ASG'
  AND MST.ACPFLG         ='Y'
  AND COALESCE(MST.ARRSTA ,'N')        ='N'
  AND TRUNC(MST.ASGDAT) >= to_date(?, 'DD-MM-yyyy')
  AND TRUNC(MST.ASGDAT) <= to_date(?, 'DD-MM-yyyy')
  AND ASG.EXPCLSFLG        <> 'C'

				]]>
		</QRY:Source>
  </QRY:Definition>
<QRY:Definition>
		<QRY:Id>140</QRY:Id>
		<QRY:Source Name="mail.operations.findMailOnHandDetailsparttwo" Type="NATIVE">
	<![CDATA[
		SELECT MST.CMPCOD,
    (
    CASE
      WHEN MST.CONTYP = 'U'
      THEN MST.CONNUM
      ELSE 'BULK'
    END) CONNUM,
    MST.ASGPRT ASGPRT,
    MST.POU ,
    MST.DSTCOD DSTCOD,
    MST.CONTYP CONTYP,
    MST.ARRSTA,
    (SELECT
      CASE
        WHEN ( SUM (
          CASE
            WHEN CLSMST.SUBCLSGRP = 'EMS'
            THEN 1
            ELSE 0
          END) / (COUNT(CLSMST.SUBCLSGRP))) > MIN(PAR.PARVAL/100)
        THEN 'EMS'
        ELSE 'NONEMS'
      END
    FROM MALMST MALMST ,
      MALSUBCLSMST CLSMST ,
      SHRSYSPAR PAR
    WHERE MST.CMPCOD     =MALMST.CMPCOD
    AND MST.CONNUM       =MALMST.CONNUM
    AND MST.ASGPRT       =MALMST.SCNPRT
    AND MALMST.CMPCOD    =CLSMST.CMPCOD
    AND MALMST.MALSUBCLS =CLSMST.SUBCLSCOD
    AND PAR.CMPCOD       = MST.CMPCOD
    AND PAR.PARCOD       = 'mailtracking.defaults.emssubclasspercentage'
    ) SUBCLSGRP,
    (SELECT MIN(SCNDAT)
    FROM MALMST MALMST
    WHERE MST.CMPCOD =MALMST.CMPCOD
    AND MST.CONNUM   =MALMST.CONNUM
    AND MST.ASGPRT   =MALMST.SCNPRT
    ) SCNDAT,
	(SELECT MIN(SCNPRT)
    FROM MALMST MALMST
    WHERE MST.CMPCOD =MALMST.CMPCOD
    AND MST.CONNUM   =MALMST.CONNUM
    AND MST.ASGPRT   =MALMST.SCNPRT
    ) SCNPRT,
	(SELECT SUM(MALMST.WGT/DENFAC)
          FROM MALMST MALMST ,SHRCOMMST COMMST
           WHERE MST.CMPCOD =MALMST.CMPCOD
           AND MST.CONNUM =MALMST.CONNUM
           AND MST.ASGPRT =MALMST.SCNPRT
          AND MALMST.CMPCOD= COMMST.CMPCOD
          AND COMMST.COMCOD = 'MAL'
		   AND MALMST.FLTNUM =  '-1'
           ) VOL
  FROM MALFLTCON MST
  WHERE EXISTS
    (SELECT 1
    FROM MALMST MALMST
    WHERE MALMST.CMPCOD =MST.CMPCOD
    AND MALMST.CONNUM   =MST.CONNUM
    AND MALMST.SCNPRT   =MST.ASGPRT
    AND MALMST.FLTNUM   = '-1'
    AND MALMST.MALSTA  IN ('ACP','ASG','DMG','OFL','TRA')
    )
  AND MST.CMPCOD         = ?
  AND MST.TXNCOD         = 'ASG'
  AND MST.ASGPRT         = ?
  AND MST.FLTNUM         = '-1'
  AND MST.ACPFLG         ='Y'
  AND COALESCE(MST.ARRSTA ,'N')        ='N'
  AND TRUNC(MST.ASGDAT) >= to_date(?, 'DD-MM-yyyy')
  AND TRUNC(MST.ASGDAT) <= to_date(?, 'DD-MM-yyyy')

				]]>
		</QRY:Source>
  </QRY:Definition>
  <QRY:Definition>
 	<QRY:Id>141</QRY:Id>
	<QRY:Source Name="mail.operations.findMailOnHandDetailsCarrier" Type="NATIVE">
<![CDATA[
	SELECT CMPCOD,ASGPRT ,
  DSTCOD ,
  SUBCLSGRP ,
  (
  CASE
    WHEN CONTYP = 'U'
    THEN SUBSTR(CONNUM, 0,3)
    ELSE 'BULK'
  END) CONTYP,
  SUM(
  CASE
    WHEN CONTYP = 'U'
    THEN 1
    ELSE NULL
  END )COUNTOFULD,
  SUM (
  CASE
    WHEN CONTYP = 'B'
    THEN 1
    ELSE 0
  END) NOMT ,
  MIN(SCNDAT) SCNDAT,
  MIN(SCNPRT) SCNPRT,
  SUM(VOL)
FROM (
  (SELECT MST.CMPCOD,
    (
    CASE
      WHEN MST.CONTYP = 'U'
      THEN MST.CONNUM
      ELSE 'BULK'
    END) CONNUM,
    MST.ASGPRT ASGPRT,
    MST.POU ,
    MST.DSTCOD DSTCOD,
    MST.CONTYP CONTYP,
    MST.ARRSTA,
    (SELECT
      CASE
        WHEN ( SUM (
          CASE
            WHEN CLSMST.SUBCLSGRP = 'EMS'
            THEN 1
            ELSE 0
          END) / (COUNT(CLSMST.SUBCLSGRP))) > MIN(PAR.PARVAL/100)
        THEN 'EMS'
        ELSE 'NONEMS'
      END
    FROM MALMST MALMST ,
      MALSUBCLSMST CLSMST ,
      SHRSYSPAR PAR
    WHERE MST.CMPCOD     =MALMST.CMPCOD
    AND MST.CONNUM       =MALMST.CONNUM
    AND MST.ASGPRT       =MALMST.SCNPRT
    AND MALMST.CMPCOD    =CLSMST.CMPCOD
    AND MALMST.MALSUBCLS =CLSMST.SUBCLSCOD
    AND PAR.CMPCOD       = MST.CMPCOD
    AND PAR.PARCOD       = 'mailtracking.defaults.emssubclasspercentage'
    ) SUBCLSGRP,
    (SELECT MIN(SCNDAT)
    FROM MALMST MALMST
    WHERE MST.CMPCOD =MALMST.CMPCOD
    AND MST.CONNUM   =MALMST.CONNUM
    AND MST.ASGPRT   =MALMST.SCNPRT
	AND COALESCE(MST.POU,MST.DSTCOD)=MALMST.POU
    ) SCNDAT,
	(SELECT MIN(SCNPRT)
    FROM MALMST MALMST
    WHERE MST.CMPCOD =MALMST.CMPCOD
    AND MST.CONNUM   =MALMST.CONNUM
    AND MST.ASGPRT   =MALMST.SCNPRT
    ) SCNPRT,
	  (SELECT SUM(MALMST.WGT/DENFAC)
          FROM MALMST MALMST ,SHRCOMMST COMMST
           WHERE MST.CMPCOD =MALMST.CMPCOD
           AND MST.CONNUM =MALMST.CONNUM
           AND MST.ASGPRT =MALMST.SCNPRT
          AND MALMST.CMPCOD= COMMST.CMPCOD
          AND COMMST.COMCOD = 'MAL'
		   AND MALMST.FLTNUM =  '-1'
           ) VOL
  FROM MALFLTCON MST
  WHERE EXISTS
    (SELECT 1
    FROM MALMST MALMST
    WHERE MALMST.CMPCOD =MST.CMPCOD
    AND MALMST.CONNUM   =MST.CONNUM
    AND MALMST.SCNPRT   =MST.ASGPRT
    AND MALMST.FLTNUM   = '-1'
    AND MALMST.MALSTA  IN ('ACP','ASG','DMG','OFL','TRA')
    )
  AND MST.CMPCOD         = ?
  AND MST.TXNCOD         = 'ASG'
  AND MST.ASGPRT         = ?
  AND MST.FLTNUM         = '-1'
  AND MST.ACPFLG         ='Y'
  AND COALESCE(MST.ARRSTA ,'N')        ='N'
  AND TRUNC(MST.ASGDAT) >= to_date(?, 'DD-MM-yyyy')
  AND TRUNC(MST.ASGDAT) <= to_date(?, 'DD-MM-yyyy')
				]]>
		</QRY:Source>
	</QRY:Definition>
<QRY:Definition>
		<QRY:Id>143</QRY:Id>
		<QRY:Source Name="mail.operations.processMailOperationFromFile" Type="PROCEDURE">
			<![CDATA[
				CALL Pkg_Frmwrk_Extdta.spr_main(?,?,?,?,?,?,?)
			]]>
	</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
		<QRY:Id>144</QRY:Id>
		<QRY:Source Name="mail.operations.fetchDataForOfflineUpload" Type="PROCEDURE">
			<![CDATA[
				   SELECT CMPCOD,
  FILTYP,
  FILNAM,
  SERNUM,
  REF001,
  REF002,
  REF003,
  REF004,
  REF005,
  REF006,
  REF007,
  REF008,
  REF009,
  REF010
FROM SHRGENEXTTAB
WHERE CMPCOD=?
AND FILTYP  =?
ORDER BY SERNUM
			]]>
	</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>145</QRY:Id>
		<QRY:Source Name="mail.operations.removeDataFromTempTable" Type="PROCEDURE">
			<![CDATA[
				CALL PKG_MAL_SND_RDT.SPR_MAIL_UPL(?,?,?,?,?,?,?)
				]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>146</QRY:Id>
			<QRY:Source Name="mail.operations.findconaudit" Type="NATIVE">
				<![CDATA[
				SELECT
				    CMPCOD,ADLINF,ACTCOD,UPDUSR,STNCOD,UPDTXNTIM
				FROM
				    MALFLTCONAUD
				WHERE
					CMPCOD = ?
				    AND TRUNC(UPDTXNTIMUTC) >= ?
				    AND TRUNC(UPDTXNTIMUTC) <= ?

				]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>146</QRY:Id>
		<QRY:Source Name="mail.operations.findmailbagidformailtag" Type="NATIVE">
			<![CDATA[
				SELECT MST.CMPCOD ,
				  MST.MALSEQNUM ,
				  MST.MALIDR ,
				  MST.ORGEXGOFC ,
				  MST.DSTEXGOFC ,
				  MST.MALCTG ,
				  MST.MALSUBCLS ,
				  MST.YER ,
				  MST.DSN ,
				  MST.RSN ,
				  MST.HSN ,
				  MST.REGIND ,
				  MST.WGT
				FROM MALMST MST
				WHERE MST.CMPCOD  = ?
				AND MST.ORGEXGOFC = ?
				AND MST.DSTEXGOFC = ?
				AND MST.MALCTG    = ?
				AND MST.MALSUBCLS = ?
				AND MST.YER       = ?
				AND MST.DSN       = ?
				AND MST.RSN       = ?
				AND MST.HSN       = ?
				AND MST.REGIND    = ?
				AND MST.WGT       = ?
				]]>
		</QRY:Source>
	</QRY:Definition>
<QRY:Definition>
		<QRY:Id>143</QRY:Id>
		<QRY:Source Name="mail.operations.findmailaudithistorydetails" Type="NATIVE">
			<![CDATA[
		SELECT MALAUD.CMPCOD,
		  MALAUD.STNCOD,
		  MALAUD.UPDTXNTIMUTC,
		  MALAUD.ADLINF,
		  MALAUD.SERNUM,
		  MALAUD.MALIDR,
		  HIS.HISSEQNUM ,
		  HIS.ACTCOD,
		  CASE
			WHEN CFG.TXNCOD IS NOT NULL
			THEN CFG.TXNCODDES
			ELSE MALAUD.ACTCOD
		  END ACTCODDES ,
		  HIS.HISFLDNAM,
		  HIS.HISFLDOLDVAL,
		  HIS.HISFLDNEWVAL,
		  MALAUD.UPDTXNTIM,
		  MALAUD.UPDUSR
		FROM MALAUD MALAUD
		INNER JOIN SHRAUDTXNCFG CFG
		ON MALAUD.CMPCOD  = CFG.CMPCOD
		AND MALAUD.ACTCOD = CFG.TXNCOD
		LEFT OUTER JOIN MALAUDHIS HIS
		ON HIS.MALSEQNUM  = MALAUD.MALSEQNUM
		AND MALAUD.CMPCOD = HIS.CMPCOD
		AND MALAUD.SERNUM = HIS.SERNUM
		WHERE MALAUD.CMPCOD  = ?
		AND MALAUD.MALIDR    = ?
			]]>
	</QRY:Source>
  </QRY:Definition>
  <QRY:Definition>
		<QRY:Id>144</QRY:Id>
		<QRY:Source Name="mail.operations.findaudittransactioncodes" Type="NATIVE">
			<![CDATA[
		SELECT CFG.TXNCOD,CFG.TXNCODDES
		FROM SHRAUDTXNCFG CFG
		WHERE CFG.CMPCOD = ?
		 ]]>
	  </QRY:Source>
	  </QRY:Definition>

	   <QRY:Definition>
		<QRY:Id>145</QRY:Id>
		<QRY:Source Name="mail.operations.findmailbagcountincontainer" Type="NATIVE">
			<![CDATA[
		 select count(malseqnum) mailbagcount from
          maluldsegdtl
          where
        CMPCOD    = ?
					AND FLTCARIDR = ?
					AND FLTNUM    = ?
					AND FLTSEQNUM = ?
					and segsernum=?
          and connum=?
		 ]]>
	  </QRY:Source>
	  </QRY:Definition>
		<QRY:Definition>
	<QRY:Id>147</QRY:Id>
		<QRY:Source Name="mail.operations.findexchangeofficeforpa" Type="NATIVE">
			<![CDATA[
				SELECT EXGOFC.EXGOFCCOD,
				EXGOFC.ARPCOD
				FROM MALEXGOFCMST EXGOFC
				WHERE EXGOFC.CMPCOD  = ?
				AND EXGOFC.POACOD = ?
				AND EXGOFC.ACTFLG = 'A'
				]]>
		</QRY:Source>
	</QRY:Definition>
  <QRY:Definition>
		<QRY:Id>148</QRY:Id>
		<QRY:Source Name="mail.operations.findAwbAtachedMailbagDetails" Type="NATIVE">
			<![CDATA[
		SELECT MALMST.CMPCOD,
		  MALMST.DSN,
		  MALMST.ORGEXGOFC,
		  MALMST.DSTEXGOFC,
		  MALMST.MALCLS,
		  MALMST.YER,
		  MALMST.MALSEQNUM,
		  MALMST.MALIDR,
		  MALMST.MALCTG MALCTGCOD,
		  MALMST.MALSUBCLS,
		  MALMST.HSN,
		  MALMST.RSN,
		  MALMST.REGIND,
		  MALMST.WGT,
		  MALMST.MALSTA,
		  (SELECT TWOAPHCOD
		  FROM SHRARLMST
		  WHERE CMPCOD = FLTDTL.CMPCOD
		  AND ARLIDR   = FLTDTL.FLTCARIDR
		  ) FLTCARCOD,
		  FLTDTL.FLTNUM,
		  FLTDTL.FLTSEQNUM,
		  FLTDTL.FLTCARIDR,
		  FLTDTL.SEGSERNUM,
		  MALMST.CONNUM,
          MALMST.CONTYP,
		  MALMST.POU,
		  MALMST.SCNPRT,
		  MALMST.SHPPFX,
		  MALMST.MSTDOCNUM,
		  MALMST.DUPNUM,
		  MALMST.SEQNUM,
		  MALMST.FLTNUM MALMSTFLTNUM,
		  MALMST.FLTSEQNUM MALMSTFLTSEQNUM,
		  COALESCE(BKGMST.ISSSPLBKG,'N') SPLIND
		FROM CAPBKGMST BKGMST
		INNER JOIN MALMST MALMST
		ON MALMST.CMPCOD =BKGMST.CMPCOD
		 AND MALMST.MSTDOCNUM=BKGMST.MSTDOCNUM
		 AND MALMST.DOCOWRIDR=BKGMST.DOCOWRIDR
		 AND MALMST.DUPNUM=BKGMST.DUPNUM
		 AND MALMST.SEQNUM=BKGMST.SEQNUM
		 AND MALMST.MALSTA <> 'DLV'
		-- AND BKGMST.BKGSTA = 'C'
		LEFT OUTER JOIN MALBKGFLTDTL FLTDTL
		ON MALMST.CMPCOD    =FLTDTL.CMPCOD
		AND MALMST.MALSEQNUM=FLTDTL.MALSEQNUM
		AND FLTDTL.BKGSTA='BKD'

				]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>149</QRY:Id>
		<QRY:Source Name="mail.operations.findMailBagsforReassign" Type="NATIVE">
			<![CDATA[
 SELECT MST.MALSEQNUM ,MST.FLTSEQNUM, MST.FLTNUM FROM MALMST MST
WHERE  MST.MALSTA IN ('ACP','ASG')
AND MST.MSTDOCNUM=?

				]]>
		</QRY:Source>
	</QRY:Definition>
   <QRY:Definition>
      <QRY:Id>150</QRY:Id>
		<QRY:Source Name="mail.operations.findmailboxid" Type="NATIVE">
			<![CDATA[
				SELECT MAX(MST.ACTSDRIDR) MALBOX
				FROM MALCDTRCP RCP,
				  MALCDTMST MST
				WHERE MST.CMPCOD = RCP.CMPCOD
				AND MST.CDTKEY   = RCP.CDTKEY
				AND RCP.CMPCOD   = ?
				AND RCP.RCPIDR   = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
  <QRY:Definition>
		<QRY:Id>148</QRY:Id>
		<QRY:Source Name="mail.operations.findAgentCodeOfPostalAuthority" Type="NATIVE">
			<![CDATA[
		 SELECT POADTL.PARVAL
				FROM MALPOADTL POADTL
				WHERE POADTL.CMPCOD  = ?
				AND POADTL.POACOD = ?
				AND TRUNC(current_date) BETWEEN TRUNC(POADTL.VLDFRM) AND TRUNC(POADTL.VLDTOO)
				AND POADTL.PARCOD   ='AGTCOD'
				]]>
		</QRY:Source>
	</QRY:Definition>
  <QRY:Definition>
		<QRY:Id>149</QRY:Id>
		<QRY:Source Name="mail.operations.findmailbagsfordsn" Type="NATIVE">
			<![CDATA[
			SELECT MST.CMPCOD ,
			  MST.MALSEQNUM ,
			  MST.MALIDR ,
			  MST.ORGEXGOFC ,
			  MST.DSTEXGOFC ,
			  MST.MALCLS,
			  MST.MALCTG ,
			  MST.MALSUBCLS ,
			  MST.YER ,
			  MST.DSN ,
			  MST.RSN ,
			  MST.HSN ,
			  MST.REGIND ,
			  MST.WGT,
			  MST.VOL,
			  MST.VOLUNT,
			  MST.POU,
			  MST.DOCOWRIDR,
			  MST.SHPPFX,
			  MST.MSTDOCNUM,
			  MST.DUPNUM,
			  MST.SEQNUM,
			  MST.POACOD,
			  MST.ORGCOD,
			  MST.DSTCOD,
			  MST.CSGDOCNUM,
			  MST.CSGSEQNUM
			FROM MALMST MST
			INNER JOIN MALULDSEGDTL ULDSEG
			ON ULDSEG.CMPCOD    =MST.CMPCOD
			AND ULDSEG.MALSEQNUM=MST.MALSEQNUM
			AND ULDSEG.FLTCARIDR=MST.FLTCARIDR
			AND ULDSEG.FLTNUM   =MST.FLTNUM
			AND ULDSEG.FLTSEQNUM=MST.FLTSEQNUM
			AND ULDSEG.SEGSERNUM=MST.SEGSERNUM
			WHERE MST.CMPCOD    = ?
			AND MST.FLTNUM      = ?
			AND MST.FLTSEQNUM   = ?
			AND MST.FLTCARIDR   = ?
				]]>
		</QRY:Source>
	</QRY:Definition>
			<QRY:Definition>
	<QRY:Id>150</QRY:Id>
		<QRY:Source Name="mail.operations.findmailtagdetails" Type="NATIVE">
			<![CDATA[
				SELECT ORGEXG.EXGCODDES,
  (SELECT upucod.PARVAL
  FROM malpoadtl upucod
  WHERE upucod.poacod=ORGPOA.poacod
  AND upucod.parcod  ='UPUCOD'
AND MST.SCNDAT BETWEEN upucod.VLDFRM AND upucod.VLDTOO
)  OPRORG ,
  (SELECT upucod.PARVAL
  FROM malpoadtl upucod
  WHERE upucod.poacod=DSTPOA.poacod
  AND upucod.parcod  ='UPUCOD'
AND MST.SCNDAT BETWEEN upucod.VLDFRM AND upucod.VLDTOO
)  OPRDST,
DSTEXG.EXGCODDES as DSTEXGCOD,
ORGPOA.POANAM,
DSTPOA.POANAM as DSTPOANAM,
MST.MALCTG,
MST.DSN,
CSG.CSGDAT,
CDT.RCPTYP,
MST.RSN,
MST.ORGEXGOFC,
MST.DSTEXGOFC,
MST.SELNUM,
MST.MALSUBCLS,
MST.WGT,
MST.HSN,
MST.REGIND,
MST.MALIDR,
MST.YER,
RTG.FLTCARCOD,
RTG.FLTNUM,
RTG.FLTDAT,
RTG.POU,
RTG.POL,
CSG.CSGTYP FROM MALMST MST
 
INNER JOIN MALEXGOFCMST ORGEXG
ON MST.CMPCOD                                                              = ORGEXG.CMPCOD
AND MST.ORGEXGOFC                                                             = ORGEXG.EXGOFCCOD
INNER JOIN MALEXGOFCMST DSTEXG
ON MST.CMPCOD                                                                = DSTEXG.CMPCOD
AND MST.DSTEXGOFC                                                             = DSTEXG.EXGOFCCOD
INNER JOIN MALPOAMST ORGPOA
ON ORGEXG.CMPCOD                                                             =ORGPOA.CMPCOD
AND ORGEXG.POACOD                                                             =ORGPOA.POACOD
INNER JOIN MALPOAMST DSTPOA
ON DSTEXG.CMPCOD                                                             = DSTPOA.CMPCOD
AND DSTEXG.POACOD                                                             =DSTPOA.POACOD
LEFT OUTER JOIN MALCSGMST CSG
ON MST.CMPCOD                                                                = CSG.CMPCOD 
AND MST.CSGDOCNUM = CSG.CSGDOCNUM
AND MST.CSGSEQNUM = CSG.CSGSEQNUM
AND MST.POACOD                                                                = CSG.POACOD
LEFT OUTER JOIN MALCDTRCP CDT
ON (MST.CMPCOD = CDT.CMPCOD
AND MST.MALIDR = CDT.RCPIDR)
LEFT OUTER JOIN MALCSGRTG RTG
ON MST.CMPCOD                                                                = RTG.CMPCOD 
AND MST.CSGDOCNUM                                                                    = RTG.CSGDOCNUM
AND MST.CSGSEQNUM                                                             = RTG.CSGSEQNUM
INNER JOIN MALPOAMST POAMST
ON MST.CMPCOD                                                                =POAMST.CMPCOD
AND MST.POACOD                                                                =POAMST.POACOD
AND ((TO_NUMBER(TO_CHAR(current_date,'YYYYMMDD'))) - (TO_NUMBER(TO_CHAR(MST.DSPDAT,'YYYYMMDD')))<= POAMST.DUPMALPRD
OR POAMST.DUPMALPRD                                                                  = 0 )
WHERE MST.CMPCOD = ? AND
MST.MALIDR = ?
				]]>
		</QRY:Source>
	</QRY:Definition>

	 <QRY:Definition>
		<QRY:Id>151</QRY:Id>
		<QRY:Source Name="mail.operations.findMailbagResditEvents" Type="NATIVE">
			<![CDATA[
		 SELECT RDT.CMPCOD,
  RDT.MALIDR ,
  RDT.EVTDAT ,
  RDT.EVTCOD ,
  RDT.PROSTA,
  RDT.RDTSND,
  RDT.RDTFALRSNCOD,
  RDT.EVTPRT
FROM
  MALRDT RDT
  WHERE RDT.CMPCOD     = ?
  AND RDT.MALIDR    =?
				]]>
		</QRY:Source>
	</QRY:Definition>


		 <QRY:Definition>
		<QRY:Id>152</QRY:Id>
		<QRY:Source Name="mail.operations.findmailbagtotals" Type="NATIVE">
			<![CDATA[
		 	      	SELECT COUNT(*) ||'-'|| SUM(WGT) GRDTOT
FROM
  (SELECT  MALMST.MALIDR MALIDR,
    MAX(MALMST.WGT) WGT
  FROM  MALCSGMST CSGMST
  INNER JOIN  MALCSGDTL CSGDTL
  ON CSGMST.CMPCOD     = CSGDTL.CMPCOD
  AND CSGMST.CSGDOCNUM = CSGDTL.CSGDOCNUM
      AND CSGMST.CSGSEQNUM = CSGDTL.CSGSEQNUM
  AND CSGMST.POACOD    = CSGDTL.POACOD
  INNER JOIN MALMST MALMST
  ON MALMST.CMPCOD     = CSGDTL.CMPCOD
  AND MALMST.MALSEQNUM = CSGDTL.MALSEQNUM
      AND MALMST.CSGSEQNUM = CSGDTL.CSGSEQNUM
      AND MALMST.CSGDOCNUM = CSGDTL.CSGDOCNUM
      AND MALMST.POACOD    = CSGDTL.POACOD
  LEFT OUTER JOIN MALCSGRTG TRT
  ON CSGMST.CMPCOD     = TRT.CMPCOD
  AND CSGMST.CSGDOCNUM = TRT.CSGDOCNUM
  AND CSGMST.CSGSEQNUM   =TRT.CSGSEQNUM
  AND CSGMST.POACOD      =TRT.POACOD


				]]>
		</QRY:Source>
	</QRY:Definition>

<QRY:Definition>
<QRY:Id>153</QRY:Id>
<QRY:Source Name="mail.operations.findCoTerminusAirports" Type="NATIVE">
	<![CDATA[

SELECT MTK.CMPCOD,
	MTK.ARPCOD ,
	MTK.GPACOD,
	MTK.RSDMOD,
	MTK.TRKFLG,
	MTK.SERNUM,
	MTK.LSTUPDTIM ,
	MTK.LSTUPDUSR
	FROM MALCTSARP MTK
		WHERE MTK.CMPCOD  = ?
		AND MTK.GPACOD = ?

]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>154</QRY:Id>
<QRY:Source Name="mail.operations.validateCoTerminusAirports" Type="NATIVE">
	<![CDATA[

	SELECT MTK.ARPCOD ARPCOD
	from MALCTSARP MTK
	WHERE MTK.CMPCOD=?
	AND INSTR(MTK.ARPCOD,?,1)>0
	AND INSTR(MTK.ARPCOD,?,1)>0
	AND MTK.RSDMOD=?
	AND MTK.GPACOD=?

]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>155</QRY:Id>
<QRY:Source Name="mail.operations.findserviceleveldetails" Type="NATIVE">
	<![CDATA[
	SELECT mailServiceLevel
	FROM com.ibsplc.icargo.business.mail.operations.MailServiceLevel as  mailServiceLevel
	WHERE mailServiceLevel.mailServiceLevelPK.companyCode = ?
]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>156</QRY:Id>
<QRY:Source Name="mail.operations.findmailservicelevel" Type="NATIVE">
	<![CDATA[
	SELECT MALSRV.MALSRVLVL
	FROM MALSRVLVLMAP MALSRV
	WHERE MALSRV.CMPCOD=?
	AND MALSRV.POACOD=?
	AND MALSRV.MALCTG=?
	AND MALSRV.MALCLS=?
	AND MALSRV.MALSUBCLS=?
		 ]]>
	  </QRY:Source>
	  </QRY:Definition>
	<QRY:Definition>
	<QRY:Id>10</QRY:Id>
		<QRY:Source Name="mail.operations.findmailstatus" Type="NATIVE">
			<![CDATA[
			SELECT MST.MALIDR,
  MST.SCNPRT,
 MST.DSN,
 MST.MSTDOCNUM,
 MST.DOCOWRIDR,
 MST.MALCLS,
 MST.MALTYP,
 MST.WGT,
 DTL.ACPBAG,
  MST.SCNDAT,
 DTL.DLVSTA,
 EXGOFCMST.CNTCOD,
 EXGOFCMST.CTYCOD,
 SUBSTR (MST.ORGEXGOFC,3,3) ORG,
 SUBSTR (MST.DSTEXGOFC,3,3) DST,
 COALESCE(EXGOFCMST.ARPCOD,CTYMST.SRVARPCOD) ARPCOD,
  MST.MALSTA,
  BKGFLTDTL.FLTCARCOD ||'-'|| BKGFLTDTL.FLTNUM FLTNUM,
  BKGFLTDTL.FLTDAT FLTDAT
  ,
  MALHIS.SCNDAT UTCSCNDAT

 FROM MALMST MST
 INNER JOIN MALULDSEGDTL DTL
 ON MST.CMPCOD=DTL.CMPCOD
 AND MST.MALSEQNUM = DTL.MALSEQNUM
AND MST.FLTNUM = DTL.FLTNUM
AND MST.FLTSEQNUM=DTL.FLTSEQNUM
LEFT OUTER JOIN (select CMPCOD,MALSEQNUM,SCNDAT from MALHIS
where MALSTA='DLV') MALHIS  on
MALHIS.CMPCOD=DTL.CMPCOD
AND MALHIS.MALSEQNUM=DTL.MALSEQNUM
 LEFT OUTER JOIN MALEXGOFCMST EXGOFCMST
 ON MST.cmpcod =EXGOFCMST.cmpcod
 AND EXGOFCMST.EXGOFCCOD = MST.ORGEXGOFC
 LEFT OUTER JOIN SHRCTYMST CTYMST
 ON EXGOFCMST.cmpcod =CTYMST.cmpcod
 AND EXGOFCMST.CTYCOD =CTYMST.CTYCOD
LEFT OUTER JOIN CAPBKGFLTDTL BKGFLTDTL
ON MST.CMPCOD    =BKGFLTDTL.CMPCOD
AND MST.DOCOWRIDR   =BKGFLTDTL.DOCOWRIDR
AND MST.MSTDOCNUM   =BKGFLTDTL.MSTDOCNUM

 WHERE MST.CMPCOD= ?
 AND ( (SUBSTR (MST.ORGEXGOFC,3,3)) IN ( select CTYCOD from SHRCTYMST where SRVARPCOD=? and CMPCOD=?))
 AND TO_NUMBER(TO_CHAR(MST.SCNDAT,'YYYYMMDD')) >= ?
AND TO_NUMBER(TO_CHAR(MST.SCNDAT,'YYYYMMDD')) <= ?
			]]>
		</QRY:Source>
	</QRY:Definition>

<QRY:Definition>
<QRY:Id>157</QRY:Id>
<QRY:Source Name="mail.operations.finduspspostalcalendardetails" Type="NATIVE">
	<![CDATA[
	SELECT CMPCOD,
		   GPACOD,
		   CALTYP,
		   SERNUM,
		   CALPRD,
		   PRDFRM,
		   PRDTOO,
		   CGRSUBDAT,
		   CGRDELCUTOFFDAT,
		   CUTOFFWEKFIR,
		   CUTOFFWEKSEC,
		   CUTOFFWEKTHR,
		   CUTOFFWEKFOU,
		   CUTOFFWEKFIV,
		   PAYEFTDAT,
		   INCCALDAT,
		   INCEFTDAT,
		   INCRCVDAT,
		   CLMGENDAT
	FROM MALCALMST
	WHERE CMPCOD = ? AND
		  CALTYP= ? AND
		  GPACOD = ?
]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>157</QRY:Id>
<QRY:Source Name="mail.operations.generateconsignmentdetailsreportforAV7" Type="NATIVE">
	<![CDATA[
	SELECT MAX(CMPCOD) CMPCOD ,MAX(CSGDOCNUM) CSGDOCNUM,MAX(POACOD) POACOD,ORGEXGOFC,DSTEXGOFC,SUBCLSGRP,MAX(CSGDAT) CSGDAT,
	  MAX(RMK) RMK,MAX(FLTDTL) FLTDTL,MAX(FLTRUT) FLTRUT,MAX(CTYCODORG) CTYCODORG,



	  MAX(ARPCODORG) ARPCODORG,
	  MAX(CNTCODORG) CNTCODORG,
	  MAX(CNTCODDST) CNTCODDST,
	  MAX(CTYCODDST) CTYCODDST,
	  MAX(ARPCODDST) ARPCODDST,
	  SUM(LCCNT) LC_CNT,
	  SUM(LCWGT) LC_WGT,
	  SUM(CPCNT) CP_CNT,
	  SUM(CPWGT) CP_WGT,
	  (SUM(LCWGT)+SUM(CPCNT)) TOTCNT,
	  (SUM(LCWGT)+SUM(CPWGT)) TOTWGT,
	  RTGSERNUM,
	  FLTCARCOD,
	  FLTNUM,
      POL
	FROM
	  (SELECT CSG.CMPCOD CMPCOD,
		CSG.CSGDOCNUM CSGDOCNUM,
		CSG.POACOD POACOD,
		CSG.CSGSEQNUM CSGSEQNUM,
		CSG.CSGDAT CSGDAT,
		CSG.OPRTYP OPRTYP ,
		CSG.CSGTYP CSGTYP,
		CSG.RMK RMK,
		CSG.FLTDTL,
		CSG.FLTRUT,
		ORGOFC.CTYCOD CTYCODORG,
		ORGOFC.ARPCOD ARPCODORG,
		ORGOFC.CNTCOD CNTCODORG,
		ORGOFC.EXGOFCCOD ORGEXGOFC,
		DSTOFC.CTYCOD CTYCODDST,
		DSTOFC.ARPCOD ARPCODDST,
		DSTOFC.CNTCOD CNTCODDST,
		DSTOFC.EXGOFCCOD DSTEXGOFC,
		SUBCLS.SUBCLSGRP,
		CASE
		  WHEN SUBCLS.SUBCLSGRP = 'LC'
		  THEN 1
		  ELSE 0
		END LCCNT,
		CASE
		  WHEN SUBCLS.SUBCLSGRP = 'LC'
		  THEN MALMST.WGT
		  ELSE 0
		END LCWGT,
		CASE
		  WHEN SUBCLS.SUBCLSGRP = 'CP'
		  THEN 1
		  ELSE 0
		END CPCNT,
		CASE
		  WHEN SUBCLS.SUBCLSGRP = 'CP'
		  THEN MALMST.WGT
		  ELSE 0
		END CPWGT,
		RTG.FLTCARCOD FLTCARCOD,
		RTG.FLTNUM FLTNUM ,
		RTG.RTGSERNUM RTGSERNUM,
		RTG.POL POL
	  FROM MALCSGMST CSG
	  INNER JOIN MALCSGDTL MAL
	  ON CSG.CMPCOD     = MAL.CMPCOD
	  AND CSG.CSGDOCNUM = MAL.CSGDOCNUM
	  AND CSG.POACOD    = MAL.POACOD
	  AND CSG.CSGSEQNUM = MAL.CSGSEQNUM
	  INNER JOIN MALMST MALMST
	  ON MAL.CMPCOD     = MALMST.CMPCOD
	  AND MAL.MALSEQNUM = MALMST.MALSEQNUM
	  INNER JOIN MALSUBCLSMST SUBCLS
	  ON MALMST.CMPCOD     = SUBCLS.CMPCOD
	  AND MALMST.MALSUBCLS = SUBCLS.SUBCLSCOD
	  INNER JOIN MALEXGOFCMST ORGOFC
	  ON MALMST.CMPCOD     = ORGOFC.CMPCOD
	  AND MALMST.ORGEXGOFC = ORGOFC.EXGOFCCOD
	  INNER JOIN MALEXGOFCMST DSTOFC
	  ON MALMST.CMPCOD     = DSTOFC.CMPCOD
	  AND MALMST.DSTEXGOFC = DSTOFC.EXGOFCCOD
	  LEFT OUTER JOIN MALCSGRTG RTG
	  ON CSG.CMPCOD     = RTG.CMPCOD
	  AND CSG.CSGDOCNUM = RTG.CSGDOCNUM
	  AND CSG.POACOD    = RTG.POACOD
	  AND CSG.CSGSEQNUM = RTG.CSGSEQNUM
	  WHERE CSG.CMPCOD     = ?
	  AND CSG.CSGDOCNUM    = ?
	  AND CSG.POACOD       = ?)qry
	GROUP BY ORGEXGOFC,DSTEXGOFC,SUBCLSGRP ,RTGSERNUM, FLTCARCOD,FLTNUM,POL




]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>158</QRY:Id>
<QRY:Source Name="mail.operations.findMailHandoverDetails" Type="NATIVE">
	<![CDATA[
	SELECT * FROM MALHNDTIM
	WHERE CMPCOD=?
	]]>
		</QRY:Source>
	</QRY:Definition>

<QRY:Definition>
<QRY:Id>159</QRY:Id>
<QRY:Source Name="mail.operations.findscheduledarrivaltimeforflight" Type="NATIVE">
	<![CDATA[
	SELECT STA
FROM FLTOPRLEG
WHERE CMPCOD =?
AND FLTNUM   =?
AND FLTCARIDR=?
AND FLTSEQNUM=?
AND LEGSERNUM=?
		 ]]>
	  </QRY:Source>
	  </QRY:Definition>
<QRY:Definition>
<QRY:Id>160</QRY:Id>
<QRY:Source Name="mail.operations.findhandovertime" Type="NATIVE">
	<![CDATA[
SELECT HNDTIM
FROM MALHNDTIM
WHERE CMPCOD=?
AND ARPCOD  =?
AND GPACOD  =?

		 ]]>
	  </QRY:Source>
	  </QRY:Definition>
<QRY:Definition>
<QRY:Id>161</QRY:Id>
<QRY:Source Name="mail.operations.findrdtoffset" Type="NATIVE">
	<![CDATA[
SELECT RDTOFT,
  RDTDAY
FROM MALRDTREQDLVTIM
WHERE CMPCOD=?
AND DSTARPCOD  =?
AND MALTYP  =?

		 ]]>
	  </QRY:Source>
	  </QRY:Definition>

<QRY:Definition>
<QRY:Id>162</QRY:Id>
<QRY:Source Name="mail.operations.listServiceStandardDetails" Type="NATIVE">
	<![CDATA[

SELECT CMPCOD,
GPACOD,
ORGCOD,
DSTCOD,
SRVLVL,
SCNWVDFLG,
SRVSTD,
CTRIDR,
TAGIDX
FROM MALSRVSTDCFG
WHERE GPACOD=?
AND CMPCOD=?

]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>163</QRY:Id>
<QRY:Source Name="mail.operations.findgpacontractdetails" Type="NATIVE">
	<![CDATA[
	SELECT * FROM MALGPACTR WHERE CMPCOD=? AND GPACOD=?
]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>164</QRY:Id>
<QRY:Source Name="mail.operations.checkReceivedFromTruckEnabled" Type="NATIVE">
	<![CDATA[
	SELECT MAX(MTK.ARPCOD) ARPCOD
from MALCTSARP MTK
WHERE INSTR(MTK.ARPCOD,?,1)>0
AND INSTR(MTK.ARPCOD,?,1)>0
AND MTK.TRKFLG='Y'
AND MTK.GPACOD=?
		 ]]>
	  </QRY:Source>
	  </QRY:Definition>

	    <QRY:Definition>
<QRY:Id>165</QRY:Id>
<QRY:Source Name="mail.operations.findAwbPartialOflPcs" Type="NATIVE">
<![CDATA[
select
(select oflpcs from OPRSEGSHP where cmpcod=? and mstdocnum =? and docowridr=? and dupnum=? and seqnum=? and fltnum=? and fltseqnum=? and rownum=1) -
(select count(*) from malmst where cmpcod=? and mstdocnum =? and docowridr=? and dupnum=? and seqnum=? and malsta='OFL' ) OFLPCS
from dual
]]>
  </QRY:Source>
  </QRY:Definition>


  	    <QRY:Definition>
<QRY:Id>166</QRY:Id>
<QRY:Source Name="mail.operations.findMailbagsForAWB" Type="NATIVE">
<![CDATA[

WITH  BKDFLT AS
(SELECT DISTINCT FLTCARIDR, FLTSEQNUM,FLTNUM, UBRNUM, CMPCOD,MAX(SPLCNT) SPLCNT FROM (
SELECT MAX(FLT.FLTCARIDR) FLTCARIDR, MAX(FLT.FLTSEQNUM) FLTSEQNUM, MAX(FLT.FLTNUM) FLTNUM, COUNT(FLT.FLTORG) SPLCNT,MAX(MST.UBRNUM) UBRNUM,MAX(MST.CMPCOD) CMPCOD
 FROM CAPBKGMST MST
     INNER JOIN CAPBKGFLTDTL FLT
     ON MST.CMPCOD = FLT.CMPCOD
     AND MST.UBRNUM = FLT.UBRNUM
     WHERE FLT.CMPCOD = ?
     AND FLT.FLTNUM IS NOT NULL
     AND MST.BKGSTA <> 'X'
     AND MST.DOCOWRIDR = ?
     AND MST.MSTDOCNUM = ?
     AND MST.SEQNUM = ?
     AND MST.DUPNUM = ?
 GROUP BY MST.UBRNUM, FLT.FLTORG
 HAVING  COUNT(FLTORG) > 1
         UNION ALL
        SELECT MAX(FLT.FLTCARIDR) FLTCARIDR, MAX(FLT.FLTSEQNUM) FLTSEQNUM, MAX(FLT.FLTNUM) FLTNUM, COUNT(FLT.FLTDST) SPLCNT,MAX(MST.UBRNUM) UBRNUM, MAX(MST.CMPCOD) CMPCOD
 FROM
     CAPBKGMST MST
     INNER JOIN CAPBKGFLTDTL FLT
     ON MST.CMPCOD = FLT.CMPCOD
     AND MST.UBRNUM = FLT.UBRNUM
     WHERE FLT.CMPCOD = ?
     AND FLT.FLTNUM IS NOT NULL
     AND MST.BKGSTA <> 'X'
     AND MST.DOCOWRIDR = ?
     AND MST.MSTDOCNUM = ?
     AND MST.SEQNUM = ?
     AND MST.DUPNUM = ?
 GROUP BY MST.UBRNUM, FLT.FLTDST
 HAVING  COUNT(FLTDST) > 1
         )
         GROUP BY FLTCARIDR, FLTSEQNUM,FLTNUM, UBRNUM, CMPCOD
   )
SELECT MALMST.CMPCOD,
  MALMST.DSN,
  MALMST.ORGEXGOFC,
  MALMST.DSTEXGOFC,
  MALMST.MALCLS,
  MALMST.YER,
  MALMST.MALSEQNUM,
  MALMST.MALIDR,
  MALMST.MALCTG MALCTGCOD,
  MALMST.MALSUBCLS,
  MALMST.HSN,
  MALMST.RSN,
  MALMST.REGIND,
  MALMST.WGT,
  MALMST.MALSTA,
  (SELECT TWOAPHCOD
  FROM SHRARLMST
  WHERE CMPCOD = FLTDTL.CMPCOD
  AND ARLIDR   = FLTDTL.FLTCARIDR
  ) FLTCARCOD,
  FLTDTL.FLTNUM,
  FLTDTL.FLTSEQNUM,
  FLTDTL.FLTCARIDR,
  FLTDTL.SEGSERNUM,
  MALMST.CONNUM,
  MALMST.CONTYP,
  MALMST.POU,
  MALMST.SCNPRT,
  MALMST.SHPPFX,
  MALMST.MSTDOCNUM,
  MALMST.DUPNUM,
  MALMST.SEQNUM,
  MALMST.FLTNUM MALMSTFLTNUM,
  MALMST.FLTSEQNUM MALMSTFLTSEQNUM,
  CASE WHEN COALESCE(BKDFLT.SPLCNT,0) = 0 THEN 'N' ELSE 'Y' END SPLIND
FROM CAPBKGMST BKGMST
INNER JOIN MALMST MALMST
ON MALMST.CMPCOD =BKGMST.CMPCOD
AND MALMST.MSTDOCNUM=BKGMST.MSTDOCNUM
AND MALMST.DOCOWRIDR=BKGMST.DOCOWRIDR
AND MALMST.DUPNUM=BKGMST.DUPNUM
AND MALMST.SEQNUM=BKGMST.SEQNUM
AND BKGMST.BKGSTA <> 'X'
LEFT OUTER JOIN BKDFLT BKDFLT
ON BKDFLT.CMPCOD = MALMST.CMPCOD
AND BKDFLT.UBRNUM = BKGMST.UBRNUM
LEFT OUTER JOIN MALBKGFLTDTL FLTDTL
ON FLTDTL.CMPCOD    =MALMST.CMPCOD
AND FLTDTL.MALSEQNUM=MALMST.MALSEQNUM
AND FLTDTL.BKGSTA='BKD'
AND FLTDTL.FLTCARIDR = ?
AND FLTDTL.FLTNUM = ?
AND FLTDTL.FLTSEQNUM = ?
WHERE MALMST.CMPCOD = ?
AND MALMST.DOCOWRIDR = ?
AND MALMST.MSTDOCNUM = ?
AND MALMST.SEQNUM = ?
AND MALMST.DUPNUM = ?
AND COALESCE(FLTDTL.FLTCARIDR||'-'||FLTDTL.FLTSEQNUM||'-'||FLTDTL.FLTNUM,0) = 
COALESCE(CASE WHEN COALESCE(BKDFLT.SPLCNT,0) = 0 THEN FLTDTL.FLTCARIDR||'-'||FLTDTL.FLTSEQNUM||'-'||FLTDTL.FLTNUM ELSE  ? END  ,0)


]]>
  </QRY:Source>
  </QRY:Definition>

<QRY:Definition>
<QRY:Id>167</QRY:Id>
<QRY:Source Name="mail.operations.findMailBookingCount" Type="NATIVE">
	<![CDATA[
SELECT CASE WHEN MAX(mst.malseqnum) IS NULL THEN '0' ELSE '1' END MALBKG
FROM malmst mst inner join malbkgfltdtl fltdtl on mst.cmpcod=fltdtl.cmpcod
  and mst.malseqnum=fltdtl.malseqnum
  where mst.cmpcod=?
  and mst.malseqnum=?
		 ]]>
	  </QRY:Source>
	  </QRY:Definition>

	   <QRY:Definition>
		<QRY:Id>167</QRY:Id>
		<QRY:Source Name="mail.operations.findAWBAttachedMailbags" Type="NATIVE">
			<![CDATA[
SELECT MALMST.CMPCOD,
  MALMST.DSN,
  MALMST.ORGEXGOFC,
  MALMST.DSTEXGOFC,
  MALMST.MALCLS,
  MALMST.YER,

MALMST.MALSEQNUM,
  MALMST.MALIDR,
  MALMST.MALCTG MALCTGCOD,
  MALMST.MALSUBCLS,
  MALMST.HSN,
  MALMST.RSN,

MALMST.REGIND,
  MALMST.WGT,
  MALMST.MALSTA,
  NULL FLTCARCOD,
  NULL FLTNUM,
  NULL FLTSEQNUM,
  NULL
FLTCARIDR,
  MALMST.SEGSERNUM,
  MALMST.CONNUM,
  MALMST.CONTYP,
  MALMST.POU,
  MALMST.SCNPRT,
  MALMST.SHPPFX,

MALMST.MSTDOCNUM,
  MALMST.DUPNUM,
  MALMST.SEQNUM,
  MALMST.FLTNUM MALMSTFLTNUM,
  MALMST.FLTSEQNUM
MALMSTFLTSEQNUM,
  'N'  SPLIND
FROM CAPBKGMST BKGMST
INNER JOIN MALMST MALMST
ON MALMST.CMPCOD =BKGMST.CMPCOD
AND
MALMST.MSTDOCNUM=BKGMST.MSTDOCNUM
AND MALMST.DOCOWRIDR=BKGMST.DOCOWRIDR
AND MALMST.DUPNUM=BKGMST.DUPNUM
AND
MALMST.SEQNUM=BKGMST.SEQNUM
AND BKGMST.BKGSTA <> 'X'
WHERE MALMST.CMPCOD = ?
AND MALMST.DOCOWRIDR = ?
AND
MALMST.MSTDOCNUM = ?
AND MALMST.SEQNUM = ?
AND MALMST.DUPNUM = ?
			]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
		<QRY:Id>235</QRY:Id>
		<QRY:Source Name="mail.operations.findEmptyULDsInMailFlight" Type="NATIVE">
			<![CDATA[
SELECT distinct uld.cmpcod,uld.fltcaridr,uld.fltnum,uld.fltseqnum,uld.segsernum,uld.uldnum connum, fltseg.pol asgprt, fltseg.pou
					FROM MALFLT flt, MALFLTSEG fltseg, MALULDSEG uld
					WHERE  flt.cmpcod = fltseg.cmpcod
					AND flt.fltcaridr = fltseg.fltcaridr
					AND flt.fltnum = fltseg.fltnum
					AND flt.fltseqnum = fltseg.fltseqnum
					AND flt.arpcod = fltseg.pol
					AND fltseg.cmpcod = uld.cmpcod
					AND fltseg.fltcaridr = uld.fltcaridr
					AND fltseg.fltnum = uld.fltnum
					AND fltseg.fltseqnum = uld.fltseqnum
					AND fltseg.segsernum = uld.segsernum
					AND substr(ULD.ULDNUM, 0, 4) <> 'BULK'
          AND NOT EXISTS (select 1 from MALULDSEGDTL DTL where DTL.cmpcod=uld.cmpcod
          AND DTL.fltcaridr=uld.fltcaridr
          AND DTL.fltnum=uld.fltnum
          AND DTL.fltseqnum=uld.fltseqnum
          AND DTL.segsernum=uld.segsernum
          AND DTL.ULDNUM=uld.ULDNUM)
		  AND flt.cmpcod = ?
					AND flt.fltcaridr = ?
					AND flt.fltnum = ?
					AND flt.fltseqnum = ?
					AND flt.arpcod = ?
			]]>
		</QRY:Source>
	</QRY:Definition>




	<QRY:Definition>
		<QRY:Id>153</QRY:Id>
		<QRY:Source Name="mail.operations.findflightuldcontainerdetails" Type="NATIVE">
			<![CDATA[
(SELECT distinct CMPCOD,
  FLTCARIDR,
  FLTCARCOD,--Carrier code
  FLTNUM,
  CONNUM,
  FLTSEQNUM,
  LEGSERNUM,
  SEGSERNUM,
  FLTDAT,
	POU,
	ASGPRT,
	DSTCOD,
	POAFLG,
  ACPFLG,
  ARRSTA,
 OFLFLG,
 TRNFLG,
CONTYP,
 CONLSTUPDTIM,
CONJRNIDR,
POACOD,
ACTULDWGT,
ASGDATUTC,
WHSCOD,
LOCCOD,
TRFCARCOD,
RMK,
ULDFRMCARCOD,
USRCOD,
ULDLSTUPDTIM,
LSTUPDUSR,
CNTIDR,
ULDFULIND,
TXNCOD,
  --COUNT(MALSEQNUM) MALCNT,--Total mailbag count
  --SUM(WGT) MALWGT,--Total mailbag weight
--uplist airport
 -- DSTCOD,--destination
 -- (COUNT(MALSEQNUM) OVER (PARTITION BY CMPCOD,FLTCARCOD,FLTSEQNUM,CONNAM,ASGPRT,DSTCOD) )MALCNT,
 -- (SUM(WGT) OVER (PARTITION BY FLTNUM,FLTCARCOD,FLTSEQNUM,CONNAM,ASGPRT,DSTCOD) )WGT
--  (COUNT(distinct CONNUM) )CONCNT,
  (COUNT(MALSEQNUM)  )MALCNT,
  (SUM(WGT))WGT,
   (MAX(DSPWGTUNT)) DSPWGTUNT,
 MIN(REQDLVTIM) REQDLVTIM,
 SUM(PROCHG) PROCHG,
 SUM(CASE WHEN PROCHG IS NOT NULL  AND PROCHG >0 THEN 1 ELSE 0 END) RATEDCOUNT,
 BASCURCOD
FROM ((SELECT  ASG.FLTDAT FLTDAT,
                    CON.CMPCOD CMPCOD,
					CON.FLTCARIDR FLTCARIDR,
					CON.FLTCARCOD FLTCARCOD,
					CON.FLTNUM FLTNUM,
					CON.FLTSEQNUM FLTSEQNUM,
					CON.LEGSERNUM LEGSERNUM,
					CON.SEGSERNUM SEGSERNUM,
					CON.CONNUM CONNUM,
					CON.POU POU,
					CON.ASGPRT ASGPRT,
					CON.DSTCOD DSTCOD,
					CON.POAFLG POAFLG,
					CON.ACPFLG ACPFLG,
					CON.ARRSTA ARRSTA,
					CON.OFLFLG OFLFLG,
					CON.TRNFLG TRNFLG,
					CON.CONTYP CONTYP,
					CON.LSTUPDTIM AS CONLSTUPDTIM,
					CON.CONJRNIDR CONJRNIDR,
					CON.POACOD POACOD,
          CON.ACTULDWGT ACTULDWGT,
          CON.ASGDATUTC ASGDATUTC,
		  CON.USRCOD USRCOD,
		  CON.LSTUPDUSR LSTUPDUSR,
		  CON.RMK RMK,
		  CON.CNTIDR CNTIDR,
		  CON.ULDFULIND ULDFULIND,
		  CON.TXNCOD TXNCOD,
         (
					CASE
					WHEN CON.CONTYP = 'B'
					THEN 0
					ELSE RTG.RTGSERNUM
					END) AS RTGSERNUM,
					(
					CASE
					WHEN CON.CONTYP = 'B'
					THEN ''
					ELSE TO_CHAR (RTG.ONWFLTDAT, 'DD-MON-YYYY' )
					END) AS ONWFLTDAT,
					(
					CASE
					WHEN CON.CONTYP = 'B'
					THEN ''
					ELSE RTG.ONWFLTNUM
					END) AS ONWFLTNUM,
					(
					CASE
					WHEN CON.CONTYP = 'B'
					THEN ''
					ELSE RTG.ONWFLTCARCOD
					END) AS ONWFLTCARCOD,
					(
					CASE
					WHEN CON.CONTYP = 'B'
					THEN ''
					ELSE RTG.POU
					END) AS RTGPOU,
					(
					CASE
					WHEN CON.CONTYP = 'B'
					THEN 0
					ELSE RTG.ONWFLTCARIDR
					END) ONWFLTCARIDR,
					(
					CASE
					WHEN CON.CONTYP = 'B'
					THEN 0
					ELSE ULD.BAGCNT
					END) AS ULDBAGCNT,
					(
					CASE
					WHEN CON.CONTYP = 'B'
					THEN 0
					ELSE ULD.BAGWGT
					END) AS ULDBAGWGT,
					ULD.WHSCOD WHSCOD,
					ULD.LOCCOD LOCCOD,
          ULD.TRFCARCOD TRFCARCOD,
					ULD.FRMCARCOD ULDFRMCARCOD,
					ULD.LSTUPDTIM AS ULDLSTUPDTIM,
					MALMST.MALIDR MALIDR,
					MALMST.DSN DSN,
					MALMST.ORGEXGOFC ORGEXGOFC,
					MALMST.DSTEXGOFC DSTEXGOFC,
					MALMST.MALCLS MALCLS,
					MALMST.MALSUBCLS MALSUBCLS,
					MALMST.MALCTG MALCTGCOD,
					MALMST.YER YER,
					MALMST.MALSEQNUM MALSEQNUM,
          MALMST.VOL VOL,
          MALMST.SELNUM SELNUM,
          MALMST.DMGFLG DMGFLG,
          MALMST.CSGDOCNUM CSGDOCNUM,
          MALMST.POACOD MALPOA,
          MALMST.MALRMK MALRMK,
          MALMST.MSTDOCNUM MSTDOCNUM,
          MALMST.SHPPFX SHPPFX,
					MAL.ACPBAG DSNACPBAG,
					MALMST.WGT WGT,
					MALMST.DSPWGTUNT DSPWGTUNT,
					(
					CASE
					WHEN MALMST.MALTYP = 'M'
					THEN 'Y'
					ELSE 'N'
					END) AS PLTENBFLG,
					MAL.STDBAG DSNSTDBAG,
					MAL.STDWGT DSNSTDWGT,
				  --MAL.UBRNUM,
					'' MALRAT,
					'' CURCOD,
					--,
					--BKGMST.LSTUPDTIM BKGLSTUPDTIM,
					--FLTDTL.LSTUPDTIM BKGFLTUPDTIM
					MALMST.REQDLVTIM,
					COALESCE (BLGDTL.NETAMTBASCUR,PROBLGDTL.NETAMTBASCUR) PROCHG ,
					SYSPAR.PARVAL  BASCURCOD
					FROM MALFLTCON CON
					INNER JOIN MALFLT ASG
                    ON CON.ASGPRT     = ASG.ARPCOD
                    AND CON.CMPCOD    =ASG.CMPCOD
                    AND CON.FLTCARIDR =ASG.FLTCARIDR
                    AND CON.FLTNUM    =ASG.FLTNUM
                    AND CON.FLTSEQNUM =ASG.FLTSEQNUM
					AND CON.LEGSERNUM =ASG.LEGSERNUM
					INNER JOIN SHRSYSPAR SYSPAR
					ON CON.CMPCOD     = SYSPAR.CMPCOD
					AND SYSPAR.PARCOD ='shared.airline.basecurrency'
					LEFT OUTER JOIN MALFLTCONRTG RTG
					ON CON.CMPCOD     = RTG.CMPCOD
					AND CON.ASGPRT    = RTG.ASGPRT
					AND CON.CONNUM    = RTG.CONNUM
					AND CON.FLTCARIDR = RTG.FLTCARIDR
					AND CON.FLTNUM    = RTG.FLTNUM
					AND CON.FLTSEQNUM = RTG.FLTSEQNUM
					AND CON.LEGSERNUM = RTG.LEGSERNUM
					LEFT OUTER  JOIN MALULDSEG ULD
					ON CON.CMPCOD     = ULD.CMPCOD
					AND CON.FLTCARIDR = ULD.FLTCARIDR
					AND CON.FLTNUM    = ULD.FLTNUM
					AND CON.FLTSEQNUM = ULD.FLTSEQNUM
					AND CON.SEGSERNUM = ULD.SEGSERNUM
					AND CON.CONNUM    = ULD.ULDNUM
					LEFT OUTER JOIN MALULDSEGDTL MAL
					ON ULD.CMPCOD     = MAL.CMPCOD
					AND ULD.FLTCARIDR = MAL.FLTCARIDR
					AND ULD.FLTNUM    = MAL.FLTNUM
					AND ULD.FLTSEQNUM = MAL.FLTSEQNUM
					AND ULD.SEGSERNUM = MAL.SEGSERNUM
					AND ULD.ULDNUM    = MAL.ULDNUM
					--LEFT OUTER JOIN CAPBKGMST BKGMST
					--ON BKGMST.CMPCOD  = MAL.CMPCOD
				  --AND BKGMST.UBRNUM = MAL.UBRNUM
					--LEFT OUTER JOIN CAPBKGFLTDTL FLTDTL
					--ON FLTDTL.CMPCOD  = BKGMST.CMPCOD
					--AND FLTDTL.UBRNUM = BKGMST.UBRNUM
					LEFT OUTER  JOIN MALMST MALMST
					ON MALMST.CMPCOD     = MAL.CMPCOD
					AND MALMST.MALSEQNUM = MAL.MALSEQNUM
					 LEFT OUTER JOIN MALMRABLGDTL BLGDTL
					ON BLGDTL.CMPCOD =MALMST.CMPCOD 
					AND BLGDTL.MALSEQNUM=MALMST.MALSEQNUM 
					AND (BLGDTL.PAYFLG = 'R' OR (BLGDTL.PAYFLG = 'T' AND  BLGDTL.JONFLG = 'Y'))
					LEFT OUTER JOIN MALMRAPROBLGDTL PROBLGDTL
					ON PROBLGDTL.CMPCOD =MALMST.CMPCOD 
					AND PROBLGDTL.MALSEQNUM=MALMST.MALSEQNUM 
					AND (PROBLGDTL.PAYFLG = 'R' OR (PROBLGDTL.PAYFLG = 'T' AND  PROBLGDTL.JONFLG = 'Y'))
					WHERE CON.CMPCOD     =?
					AND CON.FLTCARIDR    =?
					AND CON.FLTNUM       =?
					AND CON.FLTSEQNUM    =?
					AND CON.ASGPRT       =?
					AND CON.CONTYP       ='U'
					AND CON.ACPFLG  ='Y'


			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>154</QRY:Id>
	<QRY:Source Name="mail.operations.findflightcontainermaildetails" Type="OBJECT">
			<![CDATA[
					(SELECT CON.CMPCOD CMPCOD,
					CON.FLTCARIDR FLTCARIDR,
					CON.FLTNUM FLTNUM,
					CON.FLTSEQNUM FLTSEQNUM,
					CON.LEGSERNUM LEGSERNUM,
					CON.SEGSERNUM SEGSERNUM,
					CON.CONNUM CONNUM,
					CON.POU POU,
					CON.ASGPRT ASGPRT,
					CON.DSTCOD DSTCOD,
					CON.POAFLG POAFLG,
					CON.ACPFLG ACPFLG,
					CON.ARRSTA ARRSTA,
					CON.OFLFLG OFLFLG,
					CON.TRNFLG,
					CON.CONTYP,
					CON.LSTUPDTIM AS CONLSTUPDTIM,
					CON.CONJRNIDR,
					CON.POACOD,
          CON.ACTULDWGT,
          CON.ASGDATUTC,
         (
					CASE
					WHEN CON.CONTYP = 'B'
					THEN 0
					ELSE RTG.RTGSERNUM
					END) AS RTGSERNUM,
					(
					CASE
					WHEN CON.CONTYP = 'B'
					THEN ''
					ELSE TO_CHAR (RTG.ONWFLTDAT, 'DD-MON-YYYY' )
					END) AS ONWFLTDAT,
					(
					CASE
					WHEN CON.CONTYP = 'B'
					THEN ''
					ELSE RTG.ONWFLTNUM
					END) AS ONWFLTNUM,
					(
					CASE
					WHEN CON.CONTYP = 'B'
					THEN ''
					ELSE RTG.ONWFLTCARCOD
					END) AS ONWFLTCARCOD,
					(
					CASE
					WHEN CON.CONTYP = 'B'
					THEN ''
					ELSE RTG.POU
					END) AS RTGPOU,
					(
					CASE
					WHEN CON.CONTYP = 'B'
					THEN 0
					ELSE RTG.ONWFLTCARIDR
					END) ONWFLTCARIDR,
					(
					CASE
					WHEN CON.CONTYP = 'B'
					THEN 0
					ELSE ULD.BAGCNT
					END) AS ULDBAGCNT,
					(
					CASE
					WHEN CON.CONTYP = 'B'
					THEN 0
					ELSE ULD.BAGWGT
					END) AS ULDBAGWGT,
					ULD.WHSCOD WHSCOD,
					ULD.LOCCOD LOCCOD,
          ULD.TRFCARCOD,
          ULD.RMK,
					ULD.FRMCARCOD ULDFRMCARCOD,
					ULD.LSTUPDTIM AS ULDLSTUPDTIM,
					MALMST.MALIDR MALIDR,
					MALMST.DSN DSN,
					MALMST.ORGEXGOFC ORGEXGOFC,
					MALMST.DSTEXGOFC DSTEXGOFC,
					MALMST.MALCLS MALCLS,
					MALMST.MALSUBCLS MALSUBCLS,
					MALMST.MALCTG MALCTGCOD,
					MALMST.YER YER,
					MALMST.MALSEQNUM MALSEQNUM,
          MALMST.VOL VOL,
          MALMST.SELNUM SELNUM,
          MALMST.DMGFLG DMGFLG,
          MALMST.CSGDOCNUM CSGDOCNUM,
          MALMST.POACOD MALPOA,
          MALMST.RMK MALRMK,
          MALMST.MSTDOCNUM MSTDOCNUM,
          MALMST.SHPPFX SHPPFX,
					MAL.ACPBAG DSNACPBAG,
					MALMST.WGT WGT,
					(
					CASE
					WHEN MALMST.MALTYP = 'M'
					THEN 'Y'
					ELSE 'N'
					END) AS PLTENBFLG,
					MAL.STDBAG DSNSTDBAG,
					MAL.STDWGT DSNSTDWGT,
				  --MAL.UBRNUM,
					'' MALRAT,
					'' CURCOD
					--,
					--BKGMST.LSTUPDTIM BKGLSTUPDTIM,
					--FLTDTL.LSTUPDTIM BKGFLTUPDTIM
					FROM MALFLTCON CON
					LEFT OUTER JOIN MALFLTCONRTG RTG
					ON CON.CMPCOD     = RTG.CMPCOD
					AND CON.ASGPRT    = RTG.ASGPRT
					AND CON.CONNUM    = RTG.CONNUM
					AND CON.FLTCARIDR = RTG.FLTCARIDR
					AND CON.FLTNUM    = RTG.FLTNUM
					AND CON.FLTSEQNUM = RTG.FLTSEQNUM
					AND CON.LEGSERNUM = RTG.LEGSERNUM
					LEFT OUTER  JOIN MALULDSEG ULD
					ON CON.CMPCOD     = ULD.CMPCOD
					AND CON.FLTCARIDR = ULD.FLTCARIDR
					AND CON.FLTNUM    = ULD.FLTNUM
					AND CON.FLTSEQNUM = ULD.FLTSEQNUM
					AND CON.SEGSERNUM = ULD.SEGSERNUM
					AND CON.CONNUM    = ULD.ULDNUM
					LEFT OUTER JOIN MALULDSEGDTL MAL
					ON ULD.CMPCOD     = MAL.CMPCOD
					AND ULD.FLTCARIDR = MAL.FLTCARIDR
					AND ULD.FLTNUM    = MAL.FLTNUM
					AND ULD.FLTSEQNUM = MAL.FLTSEQNUM
					AND ULD.SEGSERNUM = MAL.SEGSERNUM
					AND ULD.ULDNUM    = MAL.ULDNUM
					--LEFT OUTER JOIN CAPBKGMST BKGMST
					--ON BKGMST.CMPCOD  = MAL.CMPCOD
				  --AND BKGMST.UBRNUM = MAL.UBRNUM
					--LEFT OUTER JOIN CAPBKGFLTDTL FLTDTL
					--ON FLTDTL.CMPCOD  = BKGMST.CMPCOD
					--AND FLTDTL.UBRNUM = BKGMST.UBRNUM
					LEFT OUTER  JOIN MALMST MALMST
					ON MALMST.CMPCOD     = MAL.CMPCOD
					AND MALMST.MALSEQNUM = MAL.MALSEQNUM
					WHERE CON.CMPCOD     =?
					AND CON.FLTCARIDR    =?
					AND CON.FLTNUM       =?
					AND CON.FLTSEQNUM    =?
					AND CON.ASGPRT       =?
					AND CON.CONNUM       =?
					AND CON.CONTYP       ='U'
					)
					UNION
					(SELECT CON.CMPCOD CMPCOD,
					CON.FLTCARIDR FLTCARIDR,
					CON.FLTNUM FLTNUM,
					CON.FLTSEQNUM FLTSEQNUM,
					CON.LEGSERNUM LEGSERNUM,
					CON.SEGSERNUM SEGSERNUM,
					CON.CONNUM CONNUM,
					CON.POU POU,
					CON.ASGPRT ASGPRT,
					CON.DSTCOD DSTCOD,
					CON.POAFLG POAFLG,
					CON.ACPFLG ACPFLG,
					CON.ARRSTA ARRSTA,
					CON.OFLFLG OFLFLG,
					CON.TRNFLG,
					CON.CONTYP,
					CON.LSTUPDTIM AS CONLSTUPDTIM,
					CON.CONJRNIDR,
					CON.POACOD,
          CON.ACTULDWGT,
          CON.ASGDATUTC,
					(
					CASE
					WHEN CON.CONTYP = 'B'
					THEN 0
					ELSE RTG.RTGSERNUM
					END) AS RTGSERNUM,
					(
					CASE
					WHEN CON.CONTYP = 'B'
					THEN ''
					ELSE TO_CHAR (RTG.ONWFLTDAT, 'DD-MON-YYYY' )
					END) AS ONWFLTDAT,
					(
					CASE
					WHEN CON.CONTYP = 'B'
					THEN ''
					ELSE RTG.ONWFLTNUM
					END) AS ONWFLTNUM,
					(
					CASE
					WHEN CON.CONTYP = 'B'
					THEN ''
					ELSE RTG.ONWFLTCARCOD
					END) AS ONWFLTCARCOD,
					(
					CASE
					WHEN CON.CONTYP = 'B'
					THEN ''
					ELSE RTG.POU
					END) AS RTGPOU,
					(
					CASE
					WHEN CON.CONTYP = 'B'
					THEN 0
					ELSE RTG.ONWFLTCARIDR
					END) ONWFLTCARIDR,
					(
					CASE
					WHEN CON.CONTYP = 'B'
					THEN 0
					ELSE ULD.BAGCNT
					END) AS ULDBAGCNT,
					(
					CASE
					WHEN CON.CONTYP = 'B'
					THEN 0
					ELSE ULD.BAGWGT
					END) AS ULDBAGWGT,
					ULD.WHSCOD WHSCOD,
					ULD.LOCCOD LOCCOD,
          ULD.TRFCARCOD,ULD.RMK,
					ULD.FRMCARCOD ULDFRMCARCOD,
					ULD.LSTUPDTIM AS ULDLSTUPDTIM,
          MALMST.MALIDR MALIDR,
					MALMST.DSN DSN,
					MALMST.ORGEXGOFC ORGEXGOFC,
					MALMST.DSTEXGOFC DSTEXGOFC,
					MALMST.MALCLS MALCLS,
					MALMST.MALSUBCLS MALSUBCLS,
					MALMST.MALCTG MALCTGCOD,
					MALMST.YER YER,
					MALMST.MALSEQNUM MALSEQNUM,
          MALMST.VOL VOL,
          MALMST.SELNUM SELNUM,
          MALMST.DMGFLG DMGFLG,
          MALMST.CSGDOCNUM CSGDOCNUM,
          MALMST.POACOD MALPOA,
          MALMST.RMK MALRMK,
          MALMST.MSTDOCNUM MSTDOCNUM,
          MALMST.SHPPFX SHPPFX,
					MAL.ACPBAG DSNACPBAG,
					MALMST.WGT WGT,
					(
					CASE
					WHEN MALMST.MALTYP = 'M'
					THEN 'Y'
					ELSE 'N'
					END) AS PLTENBFLG,
					MAL.STDBAG DSNSTDBAG,
					MAL.STDWGT DSNSTDWGT,
				  --MAL.UBRNUM,
					'' MALRAT,
					'' CURCOD
					--,
					--BKGMST.LSTUPDTIM BKGLSTUPDTIM,
					--FLTDTL.LSTUPDTIM BKGFLTUPDTIM
					FROM MALFLTCON CON
					LEFT OUTER JOIN MALFLTCONRTG RTG
					ON CON.CMPCOD     = RTG.CMPCOD
					AND CON.ASGPRT    = RTG.ASGPRT
					AND CON.CONNUM    = RTG.CONNUM
					AND CON.FLTCARIDR = RTG.FLTCARIDR
					AND CON.FLTNUM    = RTG.FLTNUM
					AND CON.FLTSEQNUM = RTG.FLTSEQNUM
					AND CON.LEGSERNUM = RTG.LEGSERNUM
					LEFT OUTER  JOIN MALULDSEG ULD
					ON CON.CMPCOD     = ULD.CMPCOD
					AND CON.FLTCARIDR = ULD.FLTCARIDR
					AND CON.FLTNUM    = ULD.FLTNUM
					AND CON.FLTSEQNUM = ULD.FLTSEQNUM
					AND CON.SEGSERNUM = ULD.SEGSERNUM
					LEFT OUTER JOIN MALULDSEGDTL MAL
					ON ULD.CMPCOD     = MAL.CMPCOD
					AND ULD.FLTCARIDR = MAL.FLTCARIDR
					AND ULD.FLTNUM    = MAL.FLTNUM
					AND ULD.FLTSEQNUM = MAL.FLTSEQNUM
					AND ULD.SEGSERNUM = MAL.SEGSERNUM
					AND ULD.ULDNUM    = MAL.ULDNUM
					AND CON.CONNUM    = MAL.CONNUM
					--LEFT OUTER JOIN CAPBKGMST BKGMST
					--ON BKGMST.CMPCOD  = MAL.CMPCOD
				  --AND BKGMST.UBRNUM = MAL.UBRNUM
					--LEFT OUTER JOIN CAPBKGFLTDTL FLTDTL
					--ON FLTDTL.CMPCOD  = BKGMST.CMPCOD
					--AND FLTDTL.UBRNUM = BKGMST.UBRNUM
					LEFT OUTER  JOIN MALMST MALMST
					ON MALMST.CMPCOD     = MAL.CMPCOD
					AND MALMST.MALSEQNUM = MAL.MALSEQNUM
					WHERE CON.CMPCOD     =?
					AND CON.FLTCARIDR    =?
					AND CON.FLTNUM       =?
					AND CON.FLTSEQNUM    =?
					AND CON.ASGPRT       =?
					AND CON.CONNUM       =?
					AND CON.CONTYP       ='B'
					)
				ORDER BY CONNUM,
				DSN,
				ORGEXGOFC,
				DSTEXGOFC,
				MALCLS,
			    MALSUBCLS,
				MALCTGCOD,
				YER
			]]>
		</QRY:Source>
	</QRY:Definition>
	  <QRY:Definition>
		<QRY:Id>155</QRY:Id>
		<QRY:Source Name="mail.operations.findoutboundflightsdetailsforpreadvice" Type="NATIVE">
			<![CDATA[
		WITH MALTRUCKACRTYPES AS
    (SELECT PARVAL,
					CMPCOD
    FROM SHRSYSPAR
    WHERE PARCOD = 'mail.operations.truckaircrafttypesforoperations'
			) 

				]]>
		</QRY:Source>
	</QRY:Definition>
<QRY:Definition>
		<QRY:Id>156</QRY:Id>
		<QRY:Source Name="mail.operations.findoutboundflightdetailsforuld" Type="NATIVE">
			<![CDATA[
		 GROUP BY MALMST.CMPCOD,
      TRT.FLTCARIDR,
      TRT.FLTNUM,
      TRT.FLTSEQNUM
    ORDER BY MALMST.CMPCOD,
      TRT.FLTCARIDR,
      TRT.FLTNUM,
      TRT.FLTSEQNUM
    )
SELECT CMPCOD,
  ARPCOD,
  FLTCARIDR,
  FLTNUM,
  FLTSEQNUM,
  FLTDAT,
  LEGSERNUM,
  FLTROU,
  FLTORG,
  FLTDST,
  FLTTYP,
  FLTSTA,
  ACRTYP,
  LEGORG,
  EXPCLSFLG,
  DEPGTE,
  FLTDATPREFIX,
DEPTIM,
    %s,
MAX(RCPWGT) RCPWGT,
MAX(RCPIDRCNT) RCPIDRCNT,
MAX(DCSSTA)DCSSTA,
MAX(DCSREJRSN) DCSREJRSN
from
(SELECT CMPCOD,
  ARPCOD,
  FLTCARIDR,
  FLTNUM,
  FLTSEQNUM,
  FLTDAT,
  LEGSERNUM,
  FLTROU,
  FLTORG,
  FLTDST,
  FLTTYP,
  FLTSTA,
  ACRTYP,
  LEGORG,
  EXPCLSFLG,
  DEPGTE,
  ARVGTE,
  
 
connam,

  DEPTIM,
COUNT(distinct CONNUM) CONCNT,
  (COUNT(MALSEQNUM)  )MALCNT,
(SUM(WGT))WGT,
 MAX(RCPWGT) RCPWGT,
 MAX(RCPIDRCNT)RCPIDRCNT,
FLTDATPREFIX,
 MAX(DCSSTA) DCSSTA,
 MAX(DCSREJRSN) DCSREJRSN
    FROM (
      (SELECT  DISTINCT FLTMST.CMPCOD,
    MALFLT.ARPCOD,
  --  MALFLT.FLTCARCOD,
    FLTMST.FLTCARIDR,
    FLTMST.FLTNUM,
    FLTMST.FLTSEQNUM,
    FLTMST.FLTDAT,
    MALFLT.LEGSERNUM,
    FLTMST.FLTROU,
    FLTMST.FLTORG,
    FLTMST.FLTDST,
    FLTMST.FLTTYP,
    FLTMST.FLTSTA,
    FLTLEG.ACRTYP,
	FLTLEG.LEGORG,
    FLTLEG.DEPGTE,
	FLTLEG.ARVGTE,
    
    FLTCON.CONNUM,
    COALESCE(MALFLT.EXPCLSFLG,'N') EXPCLSFLG,
    COALESCE(MALMST.WGT,0) WGT,
    SUBSTR(FLTCON.CONNUM,1,3) CONNAM,
    MALMST.MALSEQNUM,
        COALESCE(FLTLEG.ATD, FLTLEG.ETD, FLTLEG.STD)DEPTIM,
                    (
    CASE
      WHEN FLTLEG.ATD IS NOT NULL
      THEN 'A'
          ELSE (
            CASE
           WHEN FLTLEG.ETD IS NOT NULL
           THEN 'E'
              ELSE (
                CASE
                 WHEN FLTLEG.STD IS NOT NULL
                 THEN 'S'
                 ELSE ''
                 END)
            END)
        END)AS FLTDATPREFIX ,
        COALESCE(PREADV.RCPWGT,0)RCPWGT,
   COALESCE(PREADV.RCPIDRCNT,0)RCPIDRCNT,
   DCSSTA, 
   DCSREJRSN
      FROM FLTOPRMST FLTMST
      LEFT JOIN FLTOPRLEG FLTLEG
      ON FLTMST.CMPCOD     = FLTLEG.CMPCOD
      AND FLTMST.FLTNUM    = FLTLEG.FLTNUM
      AND FLTMST.FLTCARIDR = FLTLEG.FLTCARIDR
      AND FLTMST.FLTSEQNUM = FLTLEG.FLTSEQNUM
      LEFT JOIN OPRDWSMST DWSMST
      ON FLTLEG.CMPCOD     = DWSMST.CMPCOD
      AND FLTLEG.FLTNUM    = DWSMST.FLTNUM
      AND FLTLEG.FLTCARIDR = DWSMST.FLTCARIDR
      AND FLTLEG.FLTSEQNUM = DWSMST.FLTSEQNUM
      AND FLTLEG.LEGORG    = DWSMST.ARPCOD
      INNER JOIN MALFLT MALFLT
      ON MALFLT.CMPCOD     = FLTLEG.CMPCOD
     
    AND MALFLT.FLTNUM    = FLTLEG.FLTNUM
    AND MALFLT.FLTCARIDR = FLTLEG.FLTCARIDR
    AND MALFLT.FLTSEQNUM = FLTLEG.FLTSEQNUM
    AND MALFLT.ARPCOD    = FLTLEG.LEGORG
      LEFT JOIN MALFLTCON FLTCON
      ON MALFLT.CMPCOD     = FLTCON.CMPCOD
      AND MALFLT.ARPCOD    = FLTCON.ASGPRT
      AND MALFLT.FLTCARIDR = FLTCON.FLTCARIDR
      AND MALFLT.FLTNUM    = FLTCON.FLTNUM
      AND MALFLT.FLTSEQNUM = FLTCON.FLTSEQNUM
      AND MALFLT.LEGSERNUM = FLTCON.LEGSERNUM
      LEFT JOIN MALULDSEG ULDSEG
      ON FLTCON.CMPCOD     = ULDSEG.CMPCOD
      AND FLTCON.FLTCARIDR = ULDSEG.FLTCARIDR
      AND FLTCON.FLTNUM    = ULDSEG.FLTNUM
      AND FLTCON.FLTSEQNUM = ULDSEG.FLTSEQNUM
      AND FLTCON.SEGSERNUM = ULDSEG.SEGSERNUM
      AND FLTCON.CONNUM    = ULDSEG.ULDNUM
      LEFT JOIN MALULDSEGDTL SEGDTL
      ON ULDSEG.CMPCOD     = SEGDTL.CMPCOD
      AND ULDSEG.FLTCARIDR = SEGDTL.FLTCARIDR
      AND ULDSEG.FLTNUM    = SEGDTL.FLTNUM
      AND ULDSEG.FLTSEQNUM = SEGDTL.FLTSEQNUM
      AND ULDSEG.SEGSERNUM = SEGDTL.SEGSERNUM
      AND ULDSEG.ULDNUM    = SEGDTL.ULDNUM
      LEFT JOIN MALMST MALMST
      ON SEGDTL.CMPCOD     = MALMST.CMPCOD
      AND SEGDTL.MALSEQNUM = MALMST.MALSEQNUM
      LEFT JOIN PREADVSMY PREADV
      ON MALFLT.CMPCOD     = PREADV.CMPCOD
      AND MALFLT.FLTCARIDR = PREADV.FLTCARIDR
      AND MALFLT.FLTNUM    = PREADV.FLTNUM
      AND MALFLT.FLTSEQNUM = PREADV.FLTSEQNUM
      LEFT JOIN FLTOPRSEG FLTSEG
      ON FLTMST.CMPCOD     = FLTSEG.CMPCOD
      AND FLTMST.FLTNUM    = FLTSEG.FLTNUM
      AND FLTMST.FLTCARIDR = FLTSEG.FLTCARIDR
      AND FLTMST.FLTSEQNUM = FLTSEG.FLTSEQNUM
      LEFT JOIN MALFLTSEG MALFLTSEG
      ON FLTSEG.SEGORG     = MALFLTSEG.POL
      AND FLTSEG.SEGDST    = MALFLTSEG.POU
      AND FLTSEG.CMPCOD    = MALFLTSEG.CMPCOD
      AND FLTSEG.FLTNUM    = MALFLTSEG.FLTNUM
      AND FLTSEG.FLTCARIDR = MALFLTSEG.FLTCARIDR
      AND FLTSEG.FLTSEQNUM = MALFLTSEG.FLTSEQNUM
--AND FLTSEG.SEGORG = MALFLTSEG.POL
AND FLTSEG.SEGORG = FLTLEG.LEGORG
      LEFT JOIN FLTOPROPRREF FLTREF
      ON FLTLEG.CMPCOD     = FLTREF.CMPCOD
      AND FLTLEG.FLTNUM    = FLTREF.FLTNUM
      AND FLTLEG.FLTCARIDR = FLTREF.FLTCARIDR
      AND FLTLEG.FLTSEQNUM = FLTREF.FLTSEQNUM
      AND FLTLEG.LEGSERNUM = FLTREF.LEGSERNUM
      LEFT JOIN MALTRUCKACRTYPES MALTRUKTYP
      ON FLTMST.CMPCOD  = MALTRUKTYP.CMPCOD
      WHERE FLTMST.CMPCOD = ?
  AND FLTMST.FLTCARIDR      = ?
  AND FLTCON.CONTYP = 'U'
      
  AND FLTCON.ACPFLG ='Y'
				]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>156</QRY:Id>
		<QRY:Source Name="mail.operations.findoutboundflightdetailsforbulk" Type="NATIVE">
			<![CDATA[
		   )
UNION ALL
  (SELECT  DISTINCT FLTMST.CMPCOD,
    MALFLT.ARPCOD,
   
    FLTMST.FLTCARIDR,
    FLTMST.FLTNUM,
    FLTMST.FLTSEQNUM,
    FLTMST.FLTDAT,
    MALFLT.LEGSERNUM,
    FLTMST.FLTROU,
    FLTMST.FLTORG,
    FLTMST.FLTDST,
    FLTMST.FLTTYP,
    FLTMST.FLTSTA,
    FLTLEG.ACRTYP,
	FLTLEG.LEGORG,
    FLTLEG.DEPGTE,
	FLTLEG.ARVGTE,
    
    FLTCON.CONNUM,
    COALESCE(MALFLT.EXPCLSFLG,'N') EXPCLSFLG,
    COALESCE(MALMST.WGT,0) WGT,
    'BULK' CONNAM,
    MALMST.MALSEQNUM,
        COALESCE(FLTLEG.ATD, FLTLEG.ETD, FLTLEG.STD)DEPTIM,
                    (
    CASE
      WHEN FLTLEG.ATD IS NOT NULL
      THEN 'A'
          ELSE (
            CASE
           WHEN FLTLEG.ETD IS NOT NULL
           THEN 'E'
              ELSE (
                CASE
                 WHEN FLTLEG.STD IS NOT NULL
                 THEN 'S'
                 ELSE ''
                 END)
            END)
        END)AS FLTDATPREFIX ,
        COALESCE(PREADV.RCPWGT,0)RCPWGT,
   COALESCE(PREADV.RCPIDRCNT,0)RCPIDRCNT,
   DCSSTA,
   DCSREJRSN
      FROM FLTOPRMST FLTMST
      LEFT JOIN FLTOPRLEG FLTLEG
      ON FLTMST.CMPCOD     = FLTLEG.CMPCOD
      AND FLTMST.FLTNUM    = FLTLEG.FLTNUM
      AND FLTMST.FLTCARIDR = FLTLEG.FLTCARIDR
      AND FLTMST.FLTSEQNUM = FLTLEG.FLTSEQNUM
      LEFT JOIN OPRDWSMST DWSMST
      ON FLTLEG.CMPCOD     = DWSMST.CMPCOD
      AND FLTLEG.FLTNUM    = DWSMST.FLTNUM
      AND FLTLEG.FLTCARIDR = DWSMST.FLTCARIDR
      AND FLTLEG.FLTSEQNUM = DWSMST.FLTSEQNUM
      AND FLTLEG.LEGORG    = DWSMST.ARPCOD
      INNER JOIN MALFLT MALFLT
      ON MALFLT.CMPCOD     = FLTLEG.CMPCOD
     
    AND MALFLT.FLTNUM    = FLTLEG.FLTNUM
    AND MALFLT.FLTCARIDR = FLTLEG.FLTCARIDR
    AND MALFLT.FLTSEQNUM = FLTLEG.FLTSEQNUM
    AND MALFLT.ARPCOD    = FLTLEG.LEGORG
      LEFT JOIN MALFLTCON FLTCON
      ON MALFLT.CMPCOD     = FLTCON.CMPCOD
      AND MALFLT.ARPCOD    = FLTCON.ASGPRT
      AND MALFLT.FLTCARIDR = FLTCON.FLTCARIDR
      AND MALFLT.FLTNUM    = FLTCON.FLTNUM
      AND MALFLT.FLTSEQNUM = FLTCON.FLTSEQNUM
      AND MALFLT.LEGSERNUM = FLTCON.LEGSERNUM
      LEFT JOIN MALULDSEG ULDSEG
      ON FLTCON.CMPCOD     = ULDSEG.CMPCOD
      AND FLTCON.FLTCARIDR = ULDSEG.FLTCARIDR
      AND FLTCON.FLTNUM    = ULDSEG.FLTNUM
      AND FLTCON.FLTSEQNUM = ULDSEG.FLTSEQNUM
      AND FLTCON.SEGSERNUM = ULDSEG.SEGSERNUM
    AND ULDSEG.ULDNUM LIKE '%BULK-%'
      LEFT JOIN MALULDSEGDTL SEGDTL
      ON FLTCON.CMPCOD     = SEGDTL.CMPCOD
      AND FLTCON.FLTCARIDR = SEGDTL.FLTCARIDR
      AND FLTCON.FLTNUM    = SEGDTL.FLTNUM
      AND FLTCON.FLTSEQNUM = SEGDTL.FLTSEQNUM
      AND FLTCON.SEGSERNUM = SEGDTL.SEGSERNUM
      AND FLTCON.CONNUM    = SEGDTL.CONNUM
      LEFT JOIN MALMST MALMST
      ON SEGDTL.CMPCOD     = MALMST.CMPCOD
      AND SEGDTL.MALSEQNUM = MALMST.MALSEQNUM
      LEFT JOIN PREADVSMY PREADV
      ON MALFLT.CMPCOD     = PREADV.CMPCOD
      AND MALFLT.FLTCARIDR = PREADV.FLTCARIDR
      AND MALFLT.FLTNUM    = PREADV.FLTNUM
      AND MALFLT.FLTSEQNUM = PREADV.FLTSEQNUM
      --AND SEGDTL.CONNUM = PREADV.CONNUM(+)
      LEFT JOIN FLTOPRSEG FLTSEG
      ON FLTMST.CMPCOD     = FLTSEG.CMPCOD
      AND FLTMST.FLTNUM    = FLTSEG.FLTNUM
      AND FLTMST.FLTCARIDR = FLTSEG.FLTCARIDR
      AND FLTMST.FLTSEQNUM = FLTSEG.FLTSEQNUM
      LEFT JOIN MALFLTSEG MALFLTSEG
      ON FLTSEG.SEGORG     = MALFLTSEG.POL
      AND FLTSEG.SEGDST    = MALFLTSEG.POU
      AND FLTSEG.CMPCOD    = MALFLTSEG.CMPCOD
      AND FLTSEG.FLTNUM    = MALFLTSEG.FLTNUM
      AND FLTSEG.FLTCARIDR = MALFLTSEG.FLTCARIDR
      AND FLTSEG.FLTSEQNUM = MALFLTSEG.FLTSEQNUM
AND FLTSEG.SEGORG = MALFLTSEG.POL
AND FLTSEG.SEGORG = FLTLEG.LEGORG
      LEFT JOIN FLTOPROPRREF FLTREF
      ON FLTLEG.CMPCOD     = FLTREF.CMPCOD
      AND FLTLEG.FLTNUM    = FLTREF.FLTNUM
      AND FLTLEG.FLTCARIDR = FLTREF.FLTCARIDR
      AND FLTLEG.FLTSEQNUM = FLTREF.FLTSEQNUM
      AND FLTLEG.LEGSERNUM = FLTREF.LEGSERNUM
      LEFT JOIN MALTRUCKACRTYPES MALTRUKTYP
      ON FLTMST.CMPCOD  = MALTRUKTYP.CMPCOD
      WHERE FLTMST.CMPCOD = ?
  AND FLTMST.FLTCARIDR      = ?
  AND FLTCON.CONTYP = 'B'
  AND FLTCON.ACPFLG ='Y'
				]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>156</QRY:Id>
		<QRY:Source Name="mail.operations.findoutboundflightdetailsfornotacceptedflights" Type="NATIVE">
			<![CDATA[
UNION ALL
      (SELECT FLTMST.CMPCOD,
    FLTLEG.LEGORG,
    FLTMST.FLTCARIDR,
    FLTMST.FLTNUM,
    FLTMST.FLTSEQNUM,
    FLTMST.FLTDAT,
    FLTLEG.LEGSERNUM,
    FLTMST.FLTROU,
    FLTMST.FLTORG,
    FLTMST.FLTDST,
    FLTMST.FLTTYP,
    FLTMST.FLTSTA,
    FLTLEG.ACRTYP,
	FLTLEG.LEGORG,
    FLTLEG.DEPGTE,--GateInfo
	FLTLEG.ARVGTE,--GateInfo
    --Manifest Info
    NULL CONNUM,
    COALESCE(MALFLT.EXPCLSFLG,'N') EXPCLSFLG,
    NULL WGT,
    NULL CONNAM,
    NULL MALSEQNUM,
        COALESCE(FLTLEG.ATD, FLTLEG.ETD, FLTLEG.STD)DEPTIM,
                    (
    CASE
      WHEN FLTLEG.ATD IS NOT NULL
      THEN 'A'
          ELSE (
            CASE
           WHEN FLTLEG.ETD IS NOT NULL
           THEN 'E'
              ELSE (
                CASE
                 WHEN FLTLEG.STD IS NOT NULL
                 THEN 'S'
                 ELSE ''
                 END)
            END)
    END)AS FLTDATPREFIX,
        COALESCE(PREADV.RCPWGT,0)RCPWGT,
        COALESCE(PREADV.RCPIDRCNT,0)RCPIDRCNT,
  DCSSTA,--DCS INFO
  DCSREJRSN
      FROM FLTOPRMST FLTMST
      LEFT JOIN FLTOPRLEG FLTLEG
      ON FLTMST.CMPCOD     = FLTLEG.CMPCOD
      AND FLTMST.FLTNUM    = FLTLEG.FLTNUM
      AND FLTMST.FLTCARIDR = FLTLEG.FLTCARIDR
      AND FLTMST.FLTSEQNUM = FLTLEG.FLTSEQNUM
      LEFT JOIN MALFLT MALFLT
ON FLTLEG.FLTNUM = MALFLT.FLTNUM    
AND FLTLEG.FLTCARIDR = MALFLT.FLTCARIDR
AND FLTLEG.FLTSEQNUM = MALFLT.FLTSEQNUM
AND FLTLEG.LEGORG   = MALFLT.ARPCOD
     --AND MALFLT.LEGSERNUM (+) = FLTLEG.LEGSERNUM
      LEFT JOIN FLTOPRSEG FLTSEG
      ON FLTMST.CMPCOD     = FLTSEG.CMPCOD
      AND FLTMST.FLTNUM    = FLTSEG.FLTNUM
      AND FLTMST.FLTCARIDR = FLTSEG.FLTCARIDR
      AND FLTMST.FLTSEQNUM = FLTSEG.FLTSEQNUM
      LEFT JOIN OPRDWSMST DWSMST
      ON FLTLEG.CMPCOD     = DWSMST.CMPCOD
      AND FLTLEG.FLTNUM    = DWSMST.FLTNUM
      AND FLTLEG.FLTCARIDR = DWSMST.FLTCARIDR
      AND FLTLEG.FLTSEQNUM = DWSMST.FLTSEQNUM
	  AND FLTLEG.LEGORG = DWSMST.ARPCOD
      LEFT JOIN PREADVSMY PREADV
      ON FLTMST.CMPCOD     = PREADV.CMPCOD
      AND FLTMST.FLTCARIDR = PREADV.FLTCARIDR
      AND FLTMST.FLTNUM    = PREADV.FLTNUM
      AND FLTMST.FLTSEQNUM = PREADV.FLTSEQNUM
	 --AND FLTLEG.LEGSERNUM     = DWSMST.LEGSERNUM(+)
     
      LEFT JOIN FLTOPROPRREF FLTREF
      ON FLTLEG.CMPCOD     = FLTREF.CMPCOD
      AND FLTLEG.FLTNUM    = FLTREF.FLTNUM
      AND FLTLEG.FLTCARIDR = FLTREF.FLTCARIDR
      AND FLTLEG.FLTSEQNUM = FLTREF.FLTSEQNUM
      AND FLTLEG.LEGSERNUM = FLTREF.LEGSERNUM
      LEFT JOIN MALTRUCKACRTYPES MALTRUKTYP
      ON FLTMST.CMPCOD  = MALTRUKTYP.CMPCOD
      WHERE FLTMST.CMPCOD = ?
    AND NOT EXISTS
      (SELECT 1
      FROM MALFLTCON FLTCON
  WHERE FLTLEG.CMPCOD  = FLTCON.CMPCOD
  AND FLTLEG.LEGORG    = FLTCON.ASGPRT
  AND FLTLEG.FLTCARIDR = FLTCON.FLTCARIDR
  AND FLTLEG.FLTNUM    = FLTCON.FLTNUM
  AND FLTLEG.FLTSEQNUM = FLTCON.FLTSEQNUM
      AND FLTCON.ACPFLG    ='Y'
      )
  AND FLTMST.FLTCARIDR      = ?
]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>160</QRY:Id>
		<QRY:Source Name="mail.operations.findmailbagsincontaineruld" Type="NATIVE">
			<![CDATA[
		  SELECT
		  MALMST.CMPCOD,
	MALMST.DSN DSN,
    MALMST.ORGEXGOFC ORGEXGOFC,
    MALMST.DSTEXGOFC DSTEXGOFC,
    MALMST.MALCLS MALCLS,
    MALMST.MALSUBCLS MALSUBCLS,
    MALMST.MALCTG MALCTGCOD,
    MALMST.YER YER,
    MALMST.MALSEQNUM MALSEQNUM,
    MALMST.WGT MALWGT,
    MAL.ACPBAG DSNACPBAG,
    MAL.ACPWGT DSNACPWGT,
    MALMST.SCNPRT,
    MALMST.SCNDAT,
    CON.CONNUM CONNUM,
	CON.SEGSERNUM SEGSERNUM,
    MALMST.SCNUSR,
    MALMST.MALSTA,
    MALMST.OPRSTA,
    MALMST.CONTYP,
    MALMST.POU,
    MALMST.WGT,
	MALMST.MALCMPCOD,
	MALMST.DSPWGT DSPWGT,
	MALMST.DSPWGTUNT DSPWGTUNT,
    MALMST.CSGDOCNUM,
    MALMST.CSGSEQNUM,
    MALMST.POACOD,
    MALMST.DMGFLG,
    MALMST.LSTUPDTIM,
    MALMST.REQDLVTIM,
    MALMST.MSTDOCNUM,
    MALMST.SHPPFX ,
  	MALMST.RSN RSN,
    MALMST.HSN HSN,
	MALMST.REGIND REGIND,
	MALMST.VOL VOL,
    ROW_NUMBER() OVER(ORDER BY 1)  AS RNK ,
    MALMST.FLTCARIDR,
    MALMST.FLTNUM,
    MALMST.FLTSEQNUM,
	MALMST.MALRMK,
	MALMST.ORGCOD ORGCOD,
	MALMST.DSTCOD DSTCOD,
	MALMST.VOLUNT VOLUNT,
    CON.LEGSERNUM LEGSERNUM,
    MALMST.POAFLG POAFLG,
	MALMST.ACPPOACONNUM ACPPOACONNUM,
	MALMST.ACPARPCOD ACPARPCOD,
	CON.FLTCARCOD FLTCARCOD,
    
	 MALMST.MALIDR MALIDR,
    (
    CASE
      WHEN MALMST.MALTYP = 'M'
      THEN 'Y'
      ELSE 'N'
    END) AS PLTENBFLG,
	(CASE
    WHEN CSGDTL.MALSEQNUM IS NOT NULL
    THEN 'Y'
    ELSE 'N'
    END) AS CRDPRT,
    MAL.STDBAG DSNSTDBAG,
    MAL.STDWGT DSNSTDWGT,
	MAL.FRMCARCOD FRMCARCOD,
    '' MALRAT,
    '' CURCOD,
	MAL.MRASTA,
	MALMST.MALSRVLVL MALSRVLVL,
	MALMST.TRPSRVENDTIM TRPSRVENDTIM,
	(CASE WHEN (SELECT MAX(FLTNUM) FROM MALCSGRTG CSGRTG 
    WHERE CSGRTG.CMPCOD=CSGDTL.CMPCOD AND CSGRTG.CSGDOCNUM=CSGDTL.CSGDOCNUM 
    AND  CSGRTG.CSGSEQNUM=CSGDTL.CSGSEQNUM and CSGRTG.POACOD=CSGDTL.POACOD) IS NOT NULL
    THEN 'Y'  
    ELSE 'N'
    END )AS RTGAVL
         FROM MALFLTCON CON
  LEFT OUTER JOIN MALFLTCONRTG RTG
  ON CON.CMPCOD     = RTG.CMPCOD
  AND CON.ASGPRT    = RTG.ASGPRT
  AND CON.CONNUM    = RTG.CONNUM
  AND CON.FLTCARIDR = RTG.FLTCARIDR
  AND CON.FLTNUM    = RTG.FLTNUM
  AND CON.FLTSEQNUM = RTG.FLTSEQNUM
  AND CON.LEGSERNUM = RTG.LEGSERNUM
					LEFT OUTER  JOIN MALULDSEG ULD
					ON CON.CMPCOD     = ULD.CMPCOD
					AND CON.FLTCARIDR = ULD.FLTCARIDR
					AND CON.FLTNUM    = ULD.FLTNUM
					AND CON.FLTSEQNUM = ULD.FLTSEQNUM
					AND CON.SEGSERNUM = ULD.SEGSERNUM
					AND CON.CONNUM    = ULD.ULDNUM
					LEFT OUTER JOIN MALULDSEGDTL MAL
					ON ULD.CMPCOD     = MAL.CMPCOD
					AND ULD.FLTCARIDR = MAL.FLTCARIDR
					AND ULD.FLTNUM    = MAL.FLTNUM
					AND ULD.FLTSEQNUM = MAL.FLTSEQNUM
					AND ULD.SEGSERNUM = MAL.SEGSERNUM
					AND ULD.ULDNUM    = MAL.ULDNUM
					INNER JOIN MALMST MALMST
					ON MALMST.CMPCOD     = MAL.CMPCOD
					AND MALMST.MALSEQNUM = MAL.MALSEQNUM
					LEFT OUTER JOIN MALCSGDTL CSGDTL
                    ON MALMST.CMPCOD     = CSGDTL.CMPCOD
                    AND MALMST.MALSEQNUM = CSGDTL.MALSEQNUM
                    AND MALMST.CSGSEQNUM = CSGDTL.CSGSEQNUM
                    AND MALMST.CSGDOCNUM = CSGDTL.CSGDOCNUM
                    AND MALMST.POACOD    = CSGDTL.POACOD

  WHERE CON.CMPCOD     = ?
  AND CON.FLTCARIDR    = ?
  AND CON.FLTNUM       = ?
  AND CON.FLTSEQNUM    = ?
  AND CON.ASGPRT       = ?
  AND CON.CONNUM       = ?
  AND CON.CONTYP       = 'U'

  ]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>163</QRY:Id>
		<QRY:Source Name="mail.operations.findmailbagsincontainerbulk" Type="NATIVE">
			<![CDATA[
	SELECT
    MST.DSN DSN,
    MST.ORGEXGOFC ORGEXGOFC,
    MST.DSTEXGOFC DSTEXGOFC,
    MST.MALCLS MALCLS,
    MST.MALSUBCLS MALSUBCLS,
    MST.MALCTG MALCTGCOD,
    MST.YER YER,
    MST.MALSEQNUM MALSEQNUM,
    MST.WGT MALWGT,
	MST.DSPWGT DSPWGT,
	MST.DSPWGTUNT DSPWGTUNT,
    MAL.ACPBAG DSNACPBAG,
    MAL.ACPWGT DSNACPWGT,
    MST.SCNPRT,
    MST.SCNDAT,
    MST.SCNUSR,
    MST.MALSTA,
    MST.OPRSTA,
    MST.CONTYP,
    MST.POU,
    MST.WGT,
	MALMST.MALCMPCOD,
    MST.CSGDOCNUM,
    MST.CSGSEQNUM,
    MST.POACOD,
    MST.DMGFLG,
    MST.LSTUPDTIM,
    MST.REQDLVTIM,
    MST.MSTDOCNUM,
    MST.SHPPFX ,
	MST.RSN RSN,
    MST.HSN HSN,
    ROW_NUMBER() OVER(ORDER BY 1) AS RNK ,
    MST.FLTCARIDR,
    MST.FLTNUM,
    MST.FLTSEQNUM,
    CON.SEGSERNUM SEGSERNUM,
    CON.LEGSERNUM LEGSERNUM,
	CON.CONNUM CONNUM,
    MST.POAFLG POAFLG,
	MST.ACPPOACONNUM ACPPOACONNUM,
	MST.ACPARPCOD ACPARPCOD,
	MST.MALIDR MALIDR,
	MST.ORGCOD ORGCOD ,
	MST.DSTCOD DSTCOD,
	HIS.FLTCARCOD FLTCARCOD,
    HIS.FLTDAT FLTDAT,
    (
    CASE
      WHEN MST.MALTYP = 'M'
      THEN 'Y'
      ELSE 'N'
    END) AS PLTENBFLG,
    MAL.STDBAG DSNSTDBAG,
    MAL.STDWGT DSNSTDWGT,
    '' MALRAT,
    '' CURCOD
FROM MALMST MST
INNER JOIN MALHIS HIS
ON MST.CMPCOD     = HIS.CMPCOD
AND MST.MALSEQNUM = HIS.MALSEQNUM
AND MST.MALSTA   <> 'NEW'
AND HIS.MALHISIDR =
  (SELECT MAX (MALHISIDR)
  FROM MALHIS
  WHERE MALSEQNUM = MST.MALSEQNUM
  AND CMPCOD      = MST.CMPCOD
  AND MALSTA      = MST.MALSTA
  AND SCNPRT      = MST.SCNPRT
  )
  LEFT OUTER JOIN MALULDSEGDTL MAL
  ON HIS.CMPCOD     = MAL.CMPCOD
  AND HIS.MALSEQNUM = MAL.MALSEQNUM
  INNER JOIN MALULDSEG ULD
  ON ULD.CMPCOD     = MAL.CMPCOD
  AND ULD.FLTCARIDR = MAL.FLTCARIDR
  AND ULD.FLTNUM    = MAL.FLTNUM
  AND ULD.FLTSEQNUM = MAL.FLTSEQNUM
  AND ULD.SEGSERNUM = MAL.SEGSERNUM
  AND ULD.ULDNUM    = MAL.ULDNUM
  INNER JOIN MALFLTCON CON
  ON CON.CMPCOD     = ULD.CMPCOD
  AND CON.FLTCARIDR = ULD.FLTCARIDR
  AND CON.FLTNUM    = ULD.FLTNUM
  AND CON.FLTSEQNUM = ULD.FLTSEQNUM
  AND CON.SEGSERNUM = ULD.SEGSERNUM
  AND CON.CONNUM    = ULD.ULDNUM
  LEFT OUTER JOIN MALFLTCONRTG RTG
  ON CON.CMPCOD     = RTG.CMPCOD
  AND CON.ASGPRT    = RTG.ASGPRT
  AND CON.CONNUM    = RTG.CONNUM
  AND CON.FLTCARIDR = RTG.FLTCARIDR
  AND CON.FLTNUM    = RTG.FLTNUM
  AND CON.FLTSEQNUM = RTG.FLTSEQNUM
  AND CON.LEGSERNUM = RTG.LEGSERNUM
            INNER JOIN MALHIS HIS
ON MALMST.CMPCOD     = HIS.CMPCOD
AND MALMST.MALSEQNUM = HIS.MALSEQNUM
AND MALMST.MALSTA   <> 'NEW'
AND HIS.MALHISIDR =
  (SELECT MAX (MALHISIDR)
  FROM MALHIS
  WHERE MALSEQNUM = MALMST.MALSEQNUM
  AND CMPCOD      = MALMST.CMPCOD
  AND MALSTA      = MALMST.MALSTA
  AND SCNPRT      = MALMST.SCNPRT
  )
  WHERE CON.CMPCOD     = ?
  AND CON.FLTCARIDR    = ?
  AND CON.FLTNUM       = ?
  AND CON.FLTSEQNUM    = ?
  AND CON.ASGPRT       = ?
  AND CON.CONNUM       = ?
  AND CON.CONTYP       = 'B'
  ORDER BY CON.CONNUM,
  CON.SEGSERNUM,
  MALMST.DSN,
  MALMST.ORGEXGOFC,
  MALMST.DSTEXGOFC,
  MALMST.MALSUBCLS,
  MALMST.MALCTG,
  MALMST.YER
  )]]>
		</QRY:Source>
	</QRY:Definition>

<QRY:Definition>
	<QRY:Id>401</QRY:Id>
	<QRY:Source Name="mail.operations.findmailbagsinulddsnview" Type="NATIVE">
			<![CDATA[
SELECT CMPCOD,
  DSN,
  ORGEXGOFC,
  DSTEXGOFC,
  MAX(MALCLS) MALCLS,
  MALSUBCLS,
  MALCTGCOD,
  YER,
  PLTENBFLG,
  MAX(CSGDOCNUM) CSGDOCNUM,
  MAX(CSGSEQNUM) CSGSEQNUM,
  MAX(POACOD)POACOD,
  MAX(DOCOWRCOD) DOCOWRCOD,
  MAX(DOCOWRIDR) DOCOWRIDR,
  MAX(SEQNUM) SEQNUM,
  MAX(DUPNUM) DUPNUM,
  MAX(MSTDOCNUM) MSTDOCNUM,
  COUNT(MALSEQNUM) DSNCNT,
  SUM(MALWGT) DSNWGT
FROM
  (SELECT
    CON.CONNUM CONNUM,
	CON.SEGSERNUM SEGSERNUM,
    MALMST.CMPCOD CMPCOD,
    MALMST.DSN DSN,
    MALMST.ORGEXGOFC ORGEXGOFC,
    MALMST.DSTEXGOFC DSTEXGOFC,
    MALMST.MALCLS MALCLS,
    MALMST.MALSUBCLS MALSUBCLS,
    MALMST.MALCTG MALCTGCOD,
    MALMST.YER YER,
    MALMST.MALSEQNUM MALSEQNUM,
    MALMST.WGT MALWGT,
    MALMST.SHPPFX DOCOWRCOD,
    MALMST.DOCOWRIDR DOCOWRIDR,
    MALMST.SEQNUM SEQNUM,
    MALMST.DUPNUM DUPNUM,
    MALMST.MSTDOCNUM MSTDOCNUM,
	MALMST.CSGDOCNUM CSGDOCNUM,
    MALMST.CSGSEQNUM CSGSEQNUM,
    MALMST.POACOD POACOD,
    MAL.ACPBAG DSNACPBAG,
    MAL.ACPWGT DSNACPWGT,
    MALMST.SCNPRT,
    MALMST.SCNDAT,
    MALMST.SCNUSR,
    MALMST.MALSTA,
    MALMST.OPRSTA,
    MALMST.CONTYP,
    MALMST.POU,
    MALMST.WGT,
   -- MALMST.CSGDOCNUM,
   -- MALMST.CSGSEQNUM,
   -- MALMST.POACOD,
    MALMST.DMGFLG,
    MALMST.LSTUPDTIM,
    MALMST.REQDLVTIM,
   -- MALMST.MSTDOCNUM,
    MALMST.SHPPFX ,
  	MALMST.RSN RSN,
    MALMST.HSN HSN,
    ROW_NUMBER() OVER(ORDER BY 1)  AS RNK ,
    MALMST.FLTCARIDR,
    MALMST.FLTNUM,
    MALMST.FLTSEQNUM,
    CON.LEGSERNUM LEGSERNUM,
    CON.POAFLG POAFLAG,
	MALMST.MALIDR MALIDR,
    (
    CASE
      WHEN MALMST.MALTYP = 'M'
      THEN 'Y'
      ELSE 'N'
    END) AS PLTENBFLG,
    MAL.STDBAG DSNSTDBAG,
    MAL.STDWGT DSNSTDWGT,
    '' MALRAT,
    '' CURCOD
--FROM MALMST MST
--INNER JOIN MALHIS HIS
--ON MALMST.CMPCOD     = HIS.CMPCOD
--AND MALMST.MALSEQNUM = HIS.MALSEQNUM
--AND MALMST.MALSTA   <> 'NEW'
--AND HIS.MALHISIDR =
  ---(SELECT MAX (MALHISIDR)
  --FROM MALHIS
 -- WHERE MALSEQNUM = MALMST.MALSEQNUM
 -- AND CMPCOD      = MALMST.CMPCOD
--  AND MALSTA      = MALMST.MALSTA
 -- AND SCNPRT      = MALMST.SCNPRT
 -- )
         FROM MALFLTCON CON
  LEFT OUTER JOIN MALFLTCONRTG RTG
  ON CON.CMPCOD     = RTG.CMPCOD
  AND CON.ASGPRT    = RTG.ASGPRT
  AND CON.CONNUM    = RTG.CONNUM
  AND CON.FLTCARIDR = RTG.FLTCARIDR
  AND CON.FLTNUM    = RTG.FLTNUM
  AND CON.FLTSEQNUM = RTG.FLTSEQNUM
  AND CON.LEGSERNUM = RTG.LEGSERNUM
					LEFT OUTER  JOIN MALULDSEG ULD
					ON CON.CMPCOD     = ULD.CMPCOD
					AND CON.FLTCARIDR = ULD.FLTCARIDR
					AND CON.FLTNUM    = ULD.FLTNUM
					AND CON.FLTSEQNUM = ULD.FLTSEQNUM
					AND CON.SEGSERNUM = ULD.SEGSERNUM
					AND CON.CONNUM    = ULD.ULDNUM
					LEFT OUTER JOIN MALULDSEGDTL MAL
					ON ULD.CMPCOD     = MAL.CMPCOD
					AND ULD.FLTCARIDR = MAL.FLTCARIDR
					AND ULD.FLTNUM    = MAL.FLTNUM
					AND ULD.FLTSEQNUM = MAL.FLTSEQNUM
					AND ULD.SEGSERNUM = MAL.SEGSERNUM
					AND ULD.ULDNUM    = MAL.ULDNUM
					--LEFT OUTER JOIN CAPBKGMST BKGMST
					--ON BKGMST.CMPCOD  = MAL.CMPCOD
				  --AND BKGMST.UBRNUM = MAL.UBRNUM
					--LEFT OUTER JOIN CAPBKGFLTDTL FLTDTL
					--ON FLTDTL.CMPCOD  = BKGMST.CMPCOD
					--AND FLTDTL.UBRNUM = BKGMST.UBRNUM
					LEFT OUTER  JOIN MALMST MALMST
					ON MALMST.CMPCOD     = MAL.CMPCOD
					AND MALMST.MALSEQNUM = MAL.MALSEQNUM
  WHERE CON.CMPCOD     = ?
  AND CON.FLTCARIDR    = ?
  AND CON.FLTNUM       = ?
  AND CON.FLTSEQNUM    = ?
  AND CON.ASGPRT       = ?
  AND CON.CONNUM       = ?
  AND CON.CONTYP       = 'U'

]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>402</QRY:Id>
	<QRY:Source Name="mail.operations.findmailbagsinbulkdsnview" Type="NATIVE">
			<![CDATA[
	SELECT CMPCOD,
  DSN,
  ORGEXGOFC,
  DSTEXGOFC,
  MAX(MALCLS) MALCLS,
  MALSUBCLS,
  MALCTGCOD,
  YER,
  MAX(CSGDOCNUM) CSGDOCNUM,
  MAX(CSGSEQNUM) CSGSEQNUM,
  MAX(POACOD) POACOD,
  MAX(DOCOWRCOD) DOCOWRCOD,
  MAX(DOCOWRIDR) DOCOWRIDR,
  MAX(SEQNUM) SEQNUM,
  MAX(DUPNUM) DUPNUM,
  MAX(MSTDOCNUM) MSTDOCNUM,
  COUNT(MALSEQNUM) DSNCNT,
  SUM(MALWGT) DSNWGT
FROM
  (SELECT CON.CONNUM CONNUM,
	CON.SEGSERNUM SEGSERNUM,
	MALMST.CMPCOD CMPCOD,
    MALMST.DSN DSN,
    MALMST.ORGEXGOFC ORGEXGOFC,
    MALMST.DSTEXGOFC DSTEXGOFC,
    MALMST.MALCLS MALCLS,
    MALMST.MALSUBCLS MALSUBCLS,
    MALMST.MALCTG MALCTGCOD,
    MALMST.YER YER,
    MALMST.MALSEQNUM MALSEQNUM,
    MALMST.WGT MALWGT,
    MALMST.SHPPFX DOCOWRCOD,
    MALMST.DOCOWRIDR DOCOWRIDR,
    MALMST.SEQNUM SEQNUM,
    MALMST.DUPNUM DUPNUM,
    MALMST.MSTDOCNUM MSTDOCNUM,
	MALMST.CSGDOCNUM CSGDOCNUM,
    MALMST.CSGSEQNUM CSGSEQNUM,
    MALMST.POACOD POACOD,
    MAL.ACPBAG DSNACPBAG,
    MAL.ACPWGT DSNACPWGT,
	MALMST.MALIDR MALIDR,
    (
    CASE
      WHEN MALMST.MALTYP = 'M'
      THEN 'Y'
      ELSE 'N'
    END) AS PLTENBFLG,
    MAL.STDBAG DSNSTDBAG,
    MAL.STDWGT DSNSTDWGT,
    '' MALRAT,
    '' CURCOD
  FROM MALFLTCON CON
  LEFT JOIN MALFLTCONRTG RTG
  ON CON.CMPCOD  = RTG.CMPCOD
  AND CON.ASGPRT    = RTG.ASGPRT
  AND CON.CONNUM    = RTG.CONNUM
  AND CON.FLTCARIDR = RTG.FLTCARIDR
  AND CON.FLTNUM    = RTG.FLTNUM
  AND CON.FLTSEQNUM = RTG.FLTSEQNUM
  AND CON.LEGSERNUM = RTG.LEGSERNUM
  LEFT JOIN MALULDSEG ULD
  ON CON.CMPCOD    = ULD.CMPCOD
  AND CON.FLTCARIDR = ULD.FLTCARIDR
  AND CON.FLTNUM    = ULD.FLTNUM
  AND CON.FLTSEQNUM = ULD.FLTSEQNUM
  AND CON.SEGSERNUM = ULD.SEGSERNUM
                    AND ULD.ULDNUM  LIKE '%BULK-%'
  LEFT JOIN MALULDSEGDTL MAL
  ON ULD.CMPCOD       = MAL.CMPCOD
  AND ULD.FLTCARIDR    = MAL.FLTCARIDR
  AND ULD.FLTNUM       = MAL.FLTNUM
  AND ULD.FLTSEQNUM    = MAL.FLTSEQNUM
  AND ULD.SEGSERNUM    = MAL.SEGSERNUM
  AND ULD.ULDNUM       = MAL.ULDNUM
  LEFT JOIN MALMST MALMST
  ON MAL.CMPCOD       = MALMST.CMPCOD
  AND MAL.MALSEQNUM    = MALMST.MALSEQNUM
  INNER JOIN MALHIS HIS
  ON MALMST.CMPCOD    = HIS.CMPCOD
                    AND MALMST.MALSEQNUM = HIS.MALSEQNUM
  WHERE CON.CONNUM       = MAL.CONNUM
                    AND MALMST.MALSTA   <> 'NEW'
                    AND HIS.MALHISIDR =
                   (SELECT MAX (MALHISIDR)
                    FROM MALHIS
                    WHERE MALSEQNUM = MALMST.MALSEQNUM
                    AND CMPCOD      = MALMST.CMPCOD
                    AND MALSTA      = MALMST.MALSTA
                    AND SCNPRT      = MALMST.SCNPRT
                    )
  AND CON.CMPCOD     = ?
  AND CON.FLTCARIDR    = ?
  AND CON.FLTNUM       = ?
  AND CON.FLTSEQNUM    = ?
  AND CON.ASGPRT       = ?
  AND CON.CONNUM       = ?
  AND CON.CONTYP       = 'B'

  

]]>
		</QRY:Source>
	</QRY:Definition>
<QRY:Definition>
	<QRY:Id>403</QRY:Id>
	<QRY:Source Name="mail.operations.findcarditsgroupviewacceptedcount" Type="NATIVE">
			<![CDATA[
			WITH ACCEPTEDCOUNT AS
  (SELECT COUNT(*)COUNT,SUM(RCPWGT) ACCPWGT,
    DSTCOD
  FROM
    (SELECT DISTINCT MALMST.MALIDR MALIDR,
      TRT.FLTNUM,
      TRT.FLTDAT DEPTIM,
      TRT.FLTCARCOD CARCOD,
      MALMST.ORGEXGOFC ORGEXGOFF,
      MALMST.DSTEXGOFC DSTEXGOFF,
      MALMST.YER DSPYER,
      MALMST.DSN DSPSRLNUM,
      MALMST.RSN RCPSRLNUM,
      MALMST.MALCTG MALCTGCOD,
      MALMST.MALSUBCLS MALSUBCOD,
      MALMST.REGIND RCPRGDINS ,
      MALMST.HSN HSTRCPNUM,
      MALMST.WGT RCPWGT,
      MALMST.CMPCOD,
      MALMST.SHPPFX,
      MALMST.MSTDOCNUM,
      CSGMST.CSGDOCNUM,
      CSGMST.CSGDAT CSGCMPDAT,
      CSGMST.CSGDAT CDTRCVDAT,
      MALMST.POACOD AS SDRIDR,
      CSGDTL.ULDNUM CONNUM,
      (SELECT 'Y'
      FROM DUAL
      WHERE EXISTS
        (SELECT 1
        FROM MALMST MALMST
        WHERE MALMST.CMPCOD  = CSGDTL.CMPCOD
        AND MALMST.MALSEQNUM =CSGDTL.MALSEQNUM
        AND (MALMST.MALSTA  !='NEW'
        AND MALMST.MALSTA   !='BKD'
        AND MALMST.MALSTA   !='CAN')
        )
      ) ACP ,
      MALMST.DUPNUM,
      MALMST.SEQNUM,
      MALMST.DOCOWRIDR,
      MALMST.REQDLVTIM,
      MALMST.DSTCOD
    FROM MALCSGDTL CSGDTL
    INNER JOIN MALMST MALMST
    ON MALMST.CMPCOD     = CSGDTL.CMPCOD
    AND MALMST.MALSEQNUM = CSGDTL.MALSEQNUM
    AND MALMST.CSGSEQNUM = CSGDTL.CSGSEQNUM
    AND MALMST.CSGDOCNUM = CSGDTL.CSGDOCNUM
    AND MALMST.POACOD    = CSGDTL.POACOD
    INNER JOIN MALCSGMST CSGMST
    ON CSGMST.CMPCOD     = CSGDTL.CMPCOD
    AND CSGMST.CSGDOCNUM = CSGDTL.CSGDOCNUM
    AND CSGMST.CSGSEQNUM = CSGDTL.CSGSEQNUM
    AND CSGMST.POACOD    = CSGDTL.POACOD
    LEFT OUTER JOIN MALCSGRTG TRT
    ON CSGMST.CMPCOD       = TRT.CMPCOD
    AND CSGMST.CSGDOCNUM   = TRT.CSGDOCNUM
    AND CSGMST.CSGSEQNUM   =TRT.CSGSEQNUM
    AND CSGMST.POACOD      =TRT.POACOD
    AND MALMST.MALSTA NOT IN('NEW','BKD','CAN')
	  ]]>
</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>403</QRY:Id>
		<QRY:Source Name="mail.operations.findcarditsgroupviewcount" Type="NATIVE">
			<![CDATA[
	SELECT COUNT(*) COUNT ,
  SUM(RCPWGT)TOTWGT,
  DSTCOD,
  max(cnt) ACCPCNT,
  max(accpwgt) ACCPWGT
FROM
  (SELECT DISTINCT ACCEPTEDCOUNT.COUNT cnt,
   ACCEPTEDCOUNT.ACCPWGT accpwgt,
    MALMST.MALIDR MALIDR,
    TRT.FLTNUM,
    TRT.FLTDAT DEPTIM,
    TRT.FLTCARCOD CARCOD,
    MALMST.ORGEXGOFC,
    MALMST.DSTEXGOFC,
    MALMST.YER,
    MALMST.DSN,
    MALMST.RSN,
    MALMST.MALCTG,
    MALMST.MALSUBCLS,
    RCPRGDINS ,
    MALMST.HSTRCPNUM,
    RCPWGT,
    MALMST.CMPCOD,
    MALMST.SHPPFX,
    MALMST.MSTDOCNUM,
    CSGMST.CSGDOCNUM,
    CSGMST.CSGDAT CSGCMPDAT,
    CSGMST.CSGDAT CDTRCVDAT,
    MALMST.SDRIDR,
    CSGDTL.ULDNUM CONNUM,
    (SELECT 'Y'
    FROM DUAL
    WHERE EXISTS
      (SELECT 1
      FROM MALMST MALMST
      WHERE MALMST.CMPCOD  = CSGDTL.CMPCOD
      AND MALMST.MALSEQNUM =CSGDTL.MALSEQNUM
      AND (MALMST.MALSTA  !='NEW'
      AND MALMST.MALSTA   !='BKD'
      AND MALMST.MALSTA   !='CAN')
      )
    ) ACP ,
    MALMST.DUPNUM,
    MALMST.SEQNUM,
    MALMST.DOCOWRIDR,
    MALMST.REQDLVTIM,
    MALMST.DSTCOD
  FROM MALCSGDTL CSGDTL
  INNER JOIN
    (SELECT MALMST.MALIDR MALIDR,
      MALMST.ORGEXGOFC,
      MALMST.DSTEXGOFC,
      MALMST.YER,
      MALMST.DSN,
      MALMST.RSN,
      MALMST.MALCTG,
      MALMST.MALSUBCLS,
      MALMST.REGIND RCPRGDINS ,
      MALMST.HSN HSTRCPNUM,
      MALMST.WGT RCPWGT,
      MALMST.CMPCOD,
      MALMST.SHPPFX,
      MALMST.MSTDOCNUM,
      MALMST.POACOD AS SDRIDR,
      MALMST.DUPNUM,
      MALMST.SEQNUM,
      MALMST.DOCOWRIDR,
      MALMST.REQDLVTIM,
      MALMST.CSGSEQNUM,
      MALMST.CSGDOCNUM,
      malmst.MALSEQNUM,
	  MALMST.MALSTA,
	  MALMST.FLTCARIDR,
      MALMST.FLTSEQNUM,
      MALMST.FLTNUM,
	  MALMST.ORGCOD,
	  MALMST.DSTCOD
    FROM MALMST
    ) MALMST
  ON MALMST.CMPCOD     = CSGDTL.CMPCOD
  AND MALMST.MALSEQNUM = CSGDTL.MALSEQNUM
  AND MALMST.CSGSEQNUM = CSGDTL.CSGSEQNUM
  AND MALMST.CSGDOCNUM = CSGDTL.CSGDOCNUM
  AND MALMST.SDRIDR    = CSGDTL.POACOD
  INNER JOIN MALCSGMST CSGMST
  ON CSGMST.CMPCOD     = CSGDTL.CMPCOD
  AND CSGMST.CSGDOCNUM = CSGDTL.CSGDOCNUM
  AND CSGMST.CSGSEQNUM = CSGDTL.CSGSEQNUM
  AND CSGMST.POACOD    = CSGDTL.POACOD
  LEFT OUTER JOIN MALCSGRTG TRT
  ON CSGMST.CMPCOD     = TRT.CMPCOD
  AND CSGMST.CSGDOCNUM = TRT.CSGDOCNUM
  AND CSGMST.CSGSEQNUM =TRT.CSGSEQNUM
  AND CSGMST.POACOD    =TRT.POACOD
  LEFT OUTER JOIN ACCEPTEDCOUNT
  ON ACCEPTEDCOUNT.DSTCOD=malmst.DSTCOD

	  ]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>403</QRY:Id>
	<QRY:Source Name="mail.operations.findcarditssummaryview" Type="OBJECT">
			<![CDATA[
	select count(*)COUNT, sum(RCPWGT)TOTWGT
     from (SELECT DISTINCT MALMST.MALIDR MALIDR,
        TRT.FLTNUM,
        TRT.FLTDAT DEPTIM,
        TRT.FLTCARCOD CARCOD,
        MALMST.ORGEXGOFC ORGEXGOFF,
        MALMST.DSTEXGOFC DSTEXGOFF,
        MALMST.YER DSPYER,
        MALMST.DSN DSPSRLNUM,
        MALMST.RSN RCPSRLNUM,
        MALMST.MALCTG MALCTGCOD,
        MALMST.MALSUBCLS MALSUBCOD,
        MALMST.REGIND RCPRGDINS ,
        MALMST.HSN HSTRCPNUM,
        MALMST.WGT RCPWGT,
        MALMST.CMPCOD,
        MALMST.SHPPFX,
        MALMST.MSTDOCNUM,
        CSGMST.CSGDOCNUM,
        CSGMST.CSGDAT CSGCMPDAT,
        CSGMST.CSGDAT CDTRCVDAT,
        MALMST.POACOD AS SDRIDR,
        CSGDTL.ULDNUM CONNUM,
        (SELECT 'Y'
        FROM DUAL
        WHERE EXISTS
          (SELECT 1
          FROM MALMST MALMST
          WHERE MALMST.CMPCOD  = CSGDTL.CMPCOD
          AND MALMST.MALSEQNUM =CSGDTL.MALSEQNUM
          AND (MALMST.MALSTA  !='NEW'
          AND MALMST.MALSTA   !='BKD'
          AND MALMST.MALSTA   !='CAN'
          AND MALMST.MALSTA   !='OFL')
          )
        ) ACP ,
        MALMST.DUPNUM,
        MALMST.SEQNUM,
        MALMST.DOCOWRIDR,
        MALMST.REQDLVTIM,
		MALMST.DSTCOD
      FROM MALCSGDTL CSGDTL
      INNER JOIN MALMST MALMST
      ON MALMST.CMPCOD     = CSGDTL.CMPCOD
      AND MALMST.MALSEQNUM = CSGDTL.MALSEQNUM
      AND MALMST.CSGSEQNUM = CSGDTL.CSGSEQNUM
      AND MALMST.CSGDOCNUM = CSGDTL.CSGDOCNUM
      AND MALMST.POACOD    = CSGDTL.POACOD
      INNER JOIN MALCSGMST CSGMST
      ON CSGMST.CMPCOD     = CSGDTL.CMPCOD
      AND CSGMST.CSGDOCNUM = CSGDTL.CSGDOCNUM
      AND CSGMST.CSGSEQNUM = CSGDTL.CSGSEQNUM
      AND CSGMST.POACOD    = CSGDTL.POACOD
      LEFT OUTER JOIN MALCSGRTG TRT
      ON CSGMST.CMPCOD     = TRT.CMPCOD
      AND CSGMST.CSGDOCNUM = TRT.CSGDOCNUM
      AND CSGMST.CSGSEQNUM =TRT.CSGSEQNUM
      AND CSGMST.POACOD    =TRT.POACOD
      --WHERE CSGMST.CMPCOD  = ?
	  ]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>404</QRY:Id>
	<QRY:Source Name="mail.operations.findcarrierlistdetailsuld" Type="NATIVE">
			<![CDATA[
	SELECT CMPCOD,
  ASGPRT,
  FLTCARIDR,
  DSTCOD,
  MAX(POAFLG) POAFLG,
  MAX(ACPFLG) ACPFLG,
  MAX(OFLFLG)OFLFLG,
  FLTCARCOD,



  %s
FROM 

  (SELECT CMPCOD,
    CONNAM,
    ASGPRT,
    DSTCOD,
    FLTCARIDR,
    MAX(POAFLG) POAFLG,
    MAX(ACPFLG)ACPFLG,
    MAX(OFLFLG) OFLFLG,
    FLTCARCOD,
    COUNT(DISTINCT CONNUM) CONCNT,
    (SUM(
    CASE
      WHEN MALSEQNUM >0
      THEN 1
      ELSE 0
    END ))MALCNT,
    (COALESCE(SUM(DSNACPWGT),0)) WGT
  FROM (
    (SELECT MST.CMPCOD CMPCOD,
    MST.FLTCARCOD FLTCARCOD,
    MST.DSTCOD DSTCOD,
    MST.CONNUM CONNUM,
    MST.FLTCARIDR FLTCARIDR,
    MST.FLTNUM FLTNUM,
    MST.ASGPRT ASGPRT,
    MST.FLTSEQNUM FLTSEQNUM,
    MST.LEGSERNUM LEGSERNUM,
    MST.SEGSERNUM SEGSERNUM,
    MST.POAFLG POAFLG,
    MST.ACPFLG ACPFLG,
    MST.OFLFLG OFLFLG,
    MST.CONTYP,
    MST.LSTUPDTIM CONLSTUPDTIM,
    MST.CONJRNIDR,
    MST.POACOD,
    MST.TRNFLG,
    ULD.ACPBAG ULDBAGCNT,
    ULD.ACPWGT ULDBAGWGT,
    MST.RMK RMK,
    ULD.WHSCOD WHSCOD,
    ULD.LOCCOD LOCCOD,
    ULD.FRMCARCOD FRMCARCOD,
    ULD.LSTUPDTIM ULDLSTUPDTIM,
    MALMST.DSN DSN,
    MALMST.MALCLS MALCLS,
    MALMST.MALSUBCLS MALSUBCLS,
    MALMST.MALCTG MALCTGCOD,
    MALMST.ORGEXGOFC ORGEXGOFC,
    MALMST.DSTEXGOFC DSTEXGOFC,
    MALMST.YER YER,
    MALMST.MALSEQNUM MALSEQNUM,
    ARPULD.STDBAG DSNSTDBAG,
    ARPULD.ACPBAG DSNACPBAG,
    ARPULD.STDWGT DSNSTDWGT,
    ARPULD.ACPWGT DSNACPWGT,
    (
    CASE
      WHEN MALMST.MALTYP = 'M'
      THEN 'Y'
      ELSE 'N'
    END) AS PLTENBFLG,
    SUBSTR(MST.CONNUM,1,3) CONNAM
  FROM MALFLTCON MST
  LEFT OUTER JOIN MALARPULDDTL ARPULD
  ON MST.CMPCOD     = ARPULD.CMPCOD
  AND MST.CONNUM    = ARPULD.CONNUM
  AND MST.ASGPRT    = ARPULD.ARPCOD
  AND MST.FLTCARIDR = ARPULD.FLTCARIDR
  LEFT JOIN MALARPULD ULD
  ON ARPULD.CMPCOD     = ULD.CMPCOD
  AND ARPULD.ARPCOD    = ULD.ARPCOD
  AND ARPULD.FLTCARIDR = ULD.FLTCARIDR
  AND ARPULD.ULDNUM    = ULD.ULDNUM
  AND MST.DSTCOD       = ULD.DSTCOD
  LEFT OUTER JOIN MALMST MALMST
  ON ARPULD.CMPCOD     = MALMST.CMPCOD
  AND ARPULD.MALSEQNUM = MALMST.MALSEQNUM
  WHERE MST.CMPCOD     = ?
  AND MST.FLTCARIDR    = ?
  AND MST.CONTYP       = 'U'
  AND MST.TXNCOD       = 'ASG'
  AND MST.FLTSEQNUM    = '-1'




	  ]]>
		</QRY:Source>
	</QRY:Definition>














		<QRY:Definition>
	<QRY:Id>405</QRY:Id>
	<QRY:Source Name="mail.operations.findcarrierlistdetailsbulk" Type="NATIVE">
			<![CDATA[
	 )
UNION ALL
  (SELECT MST.CMPCOD CMPCOD ,
    MST.FLTCARCOD FLTCARCOD,
    MST.DSTCOD DSTCOD,
    MST.CONNUM CONNUM ,
    MST.FLTCARIDR FLTCARIDR,
    MST.FLTNUM FLTNUM,
    MST.ASGPRT ASGPRT,
    MST.FLTSEQNUM FLTSEQNUM,
    MST.LEGSERNUM LEGSERNUM,
    MST.SEGSERNUM SEGSERNUM,
    MST.POAFLG POAFLG,
    MST.ACPFLG ACPFLG,
    MST.OFLFLG OFLFLG,
    MST.CONTYP,
    MST.LSTUPDTIM CONLSTUPDTIM,
    MST.CONJRNIDR,
    MST.POACOD,
    MST.TRNFLG,
      ULD.ACPBAG ULDBAGCNT,
      ULD.ACPWGT ULDBAGWGT,
    MST.RMK RMK ,
    ULD.WHSCOD WHSCOD,
    ULD.LOCCOD LOCCOD,
      ULD.FRMCARCOD FRMCARCOD,
      ULD.LSTUPDTIM ULDLSTUPDTIM,
      MALMST.DSN DSN,
      MALMST.MALCLS MALCLS,
      MALMST.MALSUBCLS MALSUBCLS,
      MALMST.MALCTG MALCTGCOD,
      MALMST.ORGEXGOFC ORGEXGOFC,
      MALMST.DSTEXGOFC DSTEXGOFC,
      MALMST.YER YER,
      MALMST.MALSEQNUM MALSEQNUM,
    CONARP.STDBAG DSNSTDBAG ,
    CONARP.ACPBAG DSNACPBAG,
    CONARP.STDWGT DSNSTDWGT ,
    CONARP.ACPWGT DSNACPWGT,
    (
    CASE
        WHEN MALMST.MALTYP = 'M'
      THEN 'Y'
      ELSE 'N'
    END) AS PLTENBFLG,
      'BULK' CONNAM
  FROM MALFLTCON MST
  LEFT OUTER JOIN MALARPULDDTL CONARP
  ON MST.CMPCOD     = CONARP.CMPCOD
  AND MST.CONNUM    = CONARP.CONNUM
  AND MST.ASGPRT    = CONARP.ARPCOD
  AND MST.FLTCARIDR = CONARP.FLTCARIDR
  AND MST.FLTNUM    = '-1'
  LEFT OUTER JOIN MALARPULD ULD
  ON CONARP.CMPCOD     = ULD.CMPCOD
  AND CONARP.ARPCOD    = ULD.ARPCOD
  AND CONARP.FLTCARIDR = ULD.FLTCARIDR
  AND MST.DSTCOD       = ULD.DSTCOD
  AND CONARP.CONNUM    = ULD.ULDNUM
  LEFT OUTER JOIN MALMST MALMST
    ON CONARP.CMPCOD     =MALMST.CMPCOD
    AND CONARP.MALSEQNUM = MALMST.MALSEQNUM
  WHERE MST.CMPCOD     = ?
  AND MST.FLTCARIDR    = ?
  AND MST.CONTYP       ='B'
  AND MST.TXNCOD       = 'ASG'
  AND MST.FLTSEQNUM    = '-1'

   ]]>
		</QRY:Source>
	</QRY:Definition>
		<QRY:Definition>
	<QRY:Id>405</QRY:Id>
	<QRY:Source Name="mail.operations.findcarrierlistdetailsempty" Type="NATIVE">
			<![CDATA[
	 )
  UNION ALL
    (SELECT MST.CMPCOD CMPCOD,
      MST.FLTCARCOD FLTCARCOD,
      MST.DSTCOD DSTCOD,
      MST.CONNUM CONNUM,
      MST.FLTCARIDR FLTCARIDR,
      MST.FLTNUM FLTNUM,
      MST.ASGPRT ASGPRT,
      MST.FLTSEQNUM FLTSEQNUM,
      MST.LEGSERNUM LEGSERNUM,
      MST.SEGSERNUM SEGSERNUM,
      MST.POAFLG POAFLG,
      MST.ACPFLG ACPFLG,
      MST.OFLFLG OFLFLG,
      MST.CONTYP,
      MST.LSTUPDTIM CONLSTUPDTIM,
      MST.CONJRNIDR,
      MST.POACOD,
      MST.TRNFLG,
      ULD.ACPBAG ULDBAGCNT,
      ULD.ACPWGT ULDBAGWGT,
      MST.RMK RMK,
      ULD.WHSCOD WHSCOD,
      ULD.LOCCOD LOCCOD,
      ULD.FRMCARCOD FRMCARCOD,
      ULD.LSTUPDTIM ULDLSTUPDTIM,
      '' DSN,
      '' MALCLS,
      '' MALSUBCLS,
      '' MALCTGCOD,
      '' ORGEXGOFC,
      '' DSTEXGOFC,
      0 YER,
      0 MALSEQNUM,
      0 DSNSTDBAG,
      0 DSNACPBAG,
      0 DSNSTDWGT,
      0 DSNACPWGT,
      '' PLTENBFLG,
      SUBSTR(MST.CONNUM,1,3) CONNAM
    FROM MALFLTCON MST
    LEFT OUTER JOIN MALARPULDDTL CONARP
    ON MST.CMPCOD     = CONARP.CMPCOD
    AND MST.FLTCARIDR = CONARP.FLTCARIDR
    AND MST.ASGPRT    =CONARP.ARPCOD
    AND MST.CONNUM    =CONARP.CONNUM
    LEFT OUTER JOIN MALARPULD ULD
    ON CONARP.CMPCOD     = ULD.CMPCOD
    AND CONARP.FLTCARIDR = ULD.FLTCARIDR
    AND CONARP.CONNUM    = ULD.ULDNUM
    WHERE MST.CMPCOD     = ?
    AND MST.FLTCARIDR    = ?
    AND MST.TXNCOD       = 'ASG'
    AND MST.FLTSEQNUM    = '-1'

	  ]]>
		</QRY:Source>
	</QRY:Definition>


	<QRY:Definition>
	<QRY:Id>404</QRY:Id>
	<QRY:Source Name="mail.operations.findcarriercontainersinuld" Type="NATIVE">
			<![CDATA[
(SELECT  CMPCOD,
 CONNUM,
 ASGPRT,
  DSTCOD,
  FLTCARIDR,
  POAFLG,
	ACPFLG,
	OFLFLG,
	FLTCARCOD,
	CONTYP,
	CONLSTUPDTIM,
	CONJRNIDR,
	POACOD,
	TRNFLG,
	ACTULDWGT,
	CNTIDR,
	RMK,
	WHSCOD,
	USRCOD,
	LOCCOD,
	FRMCARCOD,
	ULDLSTUPDTIM,
	FLTNUM,
  FLTSEQNUM,
  LEGSERNUM,
  ULDFULIND,
  TXNCOD,
  MIN(REQDLVTIM) REQDLVTIM,
  MAX(SEGSERNUM)SEGSERNUM ,
  (COUNT(MALSEQNUM))MALCNT,
  (SUM(WGT))WGT,
  SUM(PROCHG) PROCHG,
  SUM(
  CASE
    WHEN PROCHG IS NOT NULL
    AND PROCHG   >0
    THEN 1
    ELSE 0
  END) RATEDCOUNT,
  BASCURCOD
FROM
				 ((SELECT MST.CMPCOD CMPCOD,
				  MST.CONNUM CONNUM,
				  MST.FLTCARIDR FLTCARIDR,
				  MST.FLTNUM FLTNUM,
				  MST.ASGPRT ASGPRT,
				  MST.FLTSEQNUM FLTSEQNUM,
				  MST.LEGSERNUM LEGSERNUM,
				  MST.SEGSERNUM SEGSERNUM,
				  MST.DSTCOD DSTCOD,
				  MST.POAFLG POAFLG,
				  MST.ACPFLG ACPFLG,
				  MST.OFLFLG OFLFLG,
				  MST.FLTCARCOD FLTCARCOD,
				  MST.CONTYP,
				  MST.LSTUPDTIM CONLSTUPDTIM,
				  MST.CONJRNIDR,
				  MST.POACOD,
				  MST.TRNFLG,
				  MST.ACTULDWGT ACTULDWGT,
				  MST.CNTIDR CNTIDR,
				  MST.USRCOD USRCOD,
				  ULD.ACPBAG ULDBAGCNT,
				  ULD.ACPWGT ULDBAGWGT,
				  MST.RMK RMK,
				  ULD.WHSCOD WHSCOD,
				  ULD.LOCCOD LOCCOD,
				  ULD.FRMCARCOD FRMCARCOD,
				  ULD.LSTUPDTIM ULDLSTUPDTIM,
				  MALMST.DSN DSN,
				  MALMST.MALCLS MALCLS,
				  MALMST.MALSUBCLS MALSUBCLS,
				  MALMST.MALCTG MALCTGCOD,
				  MALMST.ORGEXGOFC ORGEXGOFC,
				  MALMST.DSTEXGOFC DSTEXGOFC,
				  MALMST.YER YER,
				  MALMST.MALSEQNUM MALSEQNUM,
				  ARPULD.STDBAG DSNSTDBAG,
				  ARPULD.ACPBAG DSNACPBAG,
				  ARPULD.STDWGT DSNSTDWGT,
				  MALMST.WGT WGT,
				MST.ULDFULIND ULDFULIND,
				MST.TXNCOD TXNCOD,
				(
				CASE
				WHEN MALMST.MALTYP = 'M'
				THEN 'Y'
				ELSE 'N'
				END) AS PLTENBFLG,
				MALMST.REQDLVTIM,
				COALESCE (BLGDTL.NETAMTBASCUR,PROBLGDTL.NETAMTBASCUR) PROCHG,
				SYSPAR.PARVAL BASCURCOD
				FROM MALFLTCON MST
				INNER JOIN SHRSYSPAR SYSPAR
				ON MST.CMPCOD     = SYSPAR.CMPCOD
				AND SYSPAR.PARCOD ='shared.airline.basecurrency'
				LEFT OUTER JOIN MALARPULDDTL ARPULD
                ON MST.CMPCOD     = ARPULD.CMPCOD
                AND MST.CONNUM    = ARPULD.CONNUM
                AND MST.ASGPRT    = ARPULD.ARPCOD
                AND MST.FLTCARIDR = ARPULD.FLTCARIDR
                LEFT JOIN MALARPULD ULD
                ON ARPULD.CMPCOD     = ULD.CMPCOD
                AND ARPULD.ARPCOD    = ULD.ARPCOD
                AND ARPULD.FLTCARIDR = ULD.FLTCARIDR
                AND ARPULD.ULDNUM    = ULD.ULDNUM
                AND MST.DSTCOD       = ULD.DSTCOD
				LEFT OUTER JOIN MALMST MALMST
				ON ARPULD.CMPCOD     = MALMST.CMPCOD
				AND ARPULD.MALSEQNUM    = MALMST.MALSEQNUM
				LEFT OUTER JOIN MALMRABLGDTL BLGDTL
				ON BLGDTL.CMPCOD    =MALMST.CMPCOD
				AND BLGDTL.MALSEQNUM=MALMST.MALSEQNUM
				AND (BLGDTL.PAYFLG = 'R' OR (BLGDTL.PAYFLG = 'T' AND  BLGDTL.JONFLG = 'Y'))
				LEFT OUTER JOIN MALMRAPROBLGDTL PROBLGDTL
				ON PROBLGDTL.CMPCOD    =MALMST.CMPCOD
				AND PROBLGDTL.MALSEQNUM=MALMST.MALSEQNUM
				AND (PROBLGDTL.PAYFLG = 'R' OR (PROBLGDTL.PAYFLG = 'T' AND  PROBLGDTL.JONFLG = 'Y'))
				WHERE MST.CMPCOD  = ?
				AND MST.FLTCARIDR = ?
				AND MST.ASGPRT    = ?
				AND MST.CONTYP    = 'U'
				AND MST.TXNCOD    = 'ASG'
				AND MST.FLTSEQNUM = '-1'
	  ]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>405</QRY:Id>
	<QRY:Source Name="mail.operations.findcarriercontainetsinbulk" Type="NATIVE">
			<![CDATA[
	         (SELECT MST.CMPCOD CMPCOD ,
				  MST.CONNUM CONNUM ,
				  MST.FLTCARIDR FLTCARIDR,
				  MST.FLTNUM FLTNUM,
				  MST.ASGPRT ASGPRT,
				  MST.FLTSEQNUM FLTSEQNUM,
				  MST.LEGSERNUM LEGSERNUM,
				  MST.SEGSERNUM SEGSERNUM,
				  MST.DSTCOD DSTCOD,
				  MST.POAFLG POAFLG,
				  MST.ACPFLG ACPFLG,
				  MST.OFLFLG OFLFLG,
				  MST.FLTCARCOD FLTCARCOD,
				  MST.CONTYP,
				  MST.LSTUPDTIM CONLSTUPDTIM,
				  MST.CONJRNIDR,
				  MST.POACOD,
				  MST.TRNFLG,
				  MST.ACTULDWGT ACTULDWGT,
				  MST.CNTIDR CNTIDR,
				  MST.USRCOD USRCOD,
				  0 ULDBAGCNT,
				  0 ULDBAGWGT,
				  MST.RMK RMK ,
				  ULD.WHSCOD WHSCOD,
				  ULD.LOCCOD LOCCOD,
				  '' FRMCARCOD,
				  NULL ULDLSTUPDTIM,
				  DSNMST.DSN DSN,
				  DSNMST.MALCLS MALCLS,
				  DSNMST.MALSUBCLS MALSUBCLS,
				  DSNMST.MALCTG MALCTGCOD,
				  DSNMST.ORGEXGOFC ORGEXGOFC,
				  DSNMST.DSTEXGOFC DSTEXGOFC,
				  DSNMST.YER YER,
				  DSNMST.MALSEQNUM MALSEQNUM,
				  CONARP.STDBAG DSNSTDBAG ,
				  CONARP.ACPBAG DSNACPBAG,
				  CONARP.STDWGT DSNSTDWGT ,
				  CONARP.ACPWGT DSNACPWGT,
		          MST.ULDFULIND ULDFULIND,
				  MST.TXNCOD TXNCOD,
				  (
				  CASE
					WHEN DSNMST.MALTYP = 'M'
					THEN 'Y'
					ELSE 'N'
				  END) AS PLTENBFLG,
				  DSNMST.REQDLVTIM,
				 COALESCE (BLGDTL.NETAMTBASCUR,PROBLGDTL.NETAMTBASCUR) PROCHG ,
				SYSPAR.PARVAL AS BASCURCOD
				FROM MALFLTCON MST
				INNER JOIN SHRSYSPAR SYSPAR
				ON MST.CMPCOD     = SYSPAR.CMPCOD
				AND SYSPAR.PARCOD ='shared.airline.basecurrency'
				LEFT OUTER JOIN MALARPULDDTL CONARP
                ON MST.CMPCOD     = CONARP.CMPCOD
				AND MST.CONNUM    = CONARP.CONNUM
                AND MST.ASGPRT    = CONARP.ARPCOD
                AND MST.FLTCARIDR = CONARP.FLTCARIDR
                AND MST.FLTNUM    = '-1'
                LEFT OUTER JOIN MALARPULD ULD
                ON CONARP.CMPCOD     = ULD.CMPCOD
                AND CONARP.ARPCOD    = ULD.ARPCOD
                AND CONARP.FLTCARIDR = ULD.FLTCARIDR
                AND MST.DSTCOD       = ULD.DSTCOD
                AND CONARP.CONNUM    = ULD.ULDNUM
				LEFT OUTER JOIN MALMST DSNMST
				ON CONARP.CMPCOD     =DSNMST.CMPCOD
				 AND CONARP.FLTCARIDR =DSNMST.FLTCARIDR
				AND CONARP.MALSEQNUM = DSNMST.MALSEQNUM
				LEFT OUTER JOIN MALMRABLGDTL BLGDTL
				ON BLGDTL.CMPCOD    =DSNMST.CMPCOD
				AND BLGDTL.MALSEQNUM=DSNMST.MALSEQNUM
				AND (BLGDTL.PAYFLG = 'R' OR (BLGDTL.PAYFLG = 'T' AND  BLGDTL.JONFLG = 'Y'))
				LEFT OUTER JOIN MALMRAPROBLGDTL PROBLGDTL
				ON PROBLGDTL.CMPCOD    =DSNMST.CMPCOD
				AND PROBLGDTL.MALSEQNUM=DSNMST.MALSEQNUM
				AND (PROBLGDTL.PAYFLG = 'R' OR (PROBLGDTL.PAYFLG = 'T' AND  PROBLGDTL.JONFLG = 'Y'))
				WHERE MST.CMPCOD     = ?
				AND MST.FLTCARIDR    = ?
				AND MST.ASGPRT       = ?
				AND MST.CONTYP       ='B'
				AND MST.TXNCOD       = 'ASG'
				AND MST.FLTSEQNUM    = '-1'
	  ]]>
		</QRY:Source>
	</QRY:Definition>
		<QRY:Definition>
	<QRY:Id>405</QRY:Id>
	<QRY:Source Name="mail.operations.findcarriercontainersempty" Type="OBJECT">
			<![CDATA[
 (SELECT MST.CMPCOD CMPCOD,
				  MST.CONNUM CONNUM,
				  MST.FLTCARIDR FLTCARIDR,
				  MST.FLTNUM FLTNUM,
				  MST.ASGPRT ASGPRT,
				  MST.FLTSEQNUM FLTSEQNUM,
				  MST.LEGSERNUM LEGSERNUM,
				  MST.SEGSERNUM SEGSERNUM,
				  MST.DSTCOD DSTCOD,
				  MST.POAFLG POAFLG,
				  MST.ACPFLG ACPFLG,
				  MST.OFLFLG OFLFLG,
				  MST.FLTCARCOD FLTCARCOD,
				  MST.CONTYP,
				  MST.LSTUPDTIM AS CONLSTUPDTIM,
				  MST.CONJRNIDR,
				  MST.POACOD,
				  MST.TRNFLG,
				  MST.ACTULDWGT ACTULDWGT,
				  MST.CNTIDR CNTIDR,
				  MST.USRCOD USRCOD,
				  0 ULDBAGCNT,
				  0 ULDBAGWGT,
				  '' RMK,
				  ULD.WHSCOD WHSCOD,
				  ULD.LOCCOD LOCCOD,
				  ULD.FRMCARCOD FRMCARCOD,
				  NULL ULDLSTUPDTIM,
				  '' DSN,
				  '' MALCLS,
				  '' MALSUBCLS,
				  '' MALCTGCOD,
				  '' ORGEXGOFC,
				  '' DSTEXGOFC,
				  0 YER,
				  null MALSEQNUM,
				  0 DSNSTDBAG,
				  0 DSNACPBAG,
				  0 DSNSTDWGT,
				  0 DSNACPWGT,
				  '' PLTENBFLG,
				  null REQDLVTIM
				FROM MALFLTCON MST
				LEFT OUTER  JOIN MALARPULD ULD
				ON MST.CMPCOD     = ULD.CMPCOD
				AND MST.FLTCARIDR = ULD.FLTCARIDR
				AND MST.CONNUM    = ULD.ULDNUM
				WHERE MST.CMPCOD     = ?
				AND MST.FLTCARIDR    = ?
				AND MST.ASGPRT       = ?
				AND MST.TXNCOD       = 'ASG'
				AND MST.FLTSEQNUM    = '-1'
	  ]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>405</QRY:Id>
	<QRY:Source Name="mail.operations.findmailbagsinbulkuld" Type="NATIVE">
			<![CDATA[
 SELECT    CON.LEGSERNUM LEGSERNUM,
         CON.POAFLG POAFLAG,
		 CON.SEGSERNUM SEGSERNUM,
		 MALMST.CMPCOD CMPCOD,
         MALMST.DSN DSN,
    MALMST.ORGEXGOFC ORGEXGOFC,
    MALMST.DSTEXGOFC DSTEXGOFC,
    MALMST.MALCLS MALCLS,
    MALMST.MALSUBCLS MALSUBCLS,
    MALMST.MALCTG MALCTGCOD,
    MALMST.YER YER,
    MALMST.MALSEQNUM MALSEQNUM,
    MALMST.WGT MALWGT,
	MALMST.MALCMPCOD MALCMPCOD,
	MALMST.VOL VOL,
    MAL.ACPBAG DSNACPBAG,
    MAL.ACPWGT DSNACPWGT,
    MALMST.SCNPRT,
    MALMST.SCNDAT,
    CON.CONNUM CONNUM,
    MALMST.SCNUSR,
    MALMST.MALSTA,
    MALMST.OPRSTA,
    MALMST.CONTYP,
    MALMST.POU,
    MALMST.WGT,
    MALMST.CSGDOCNUM,
    MALMST.CSGSEQNUM,
    MALMST.POACOD,
    MALMST.DMGFLG,
    MALMST.LSTUPDTIM,
    MALMST.REQDLVTIM,
    MALMST.MSTDOCNUM,
    MALMST.SHPPFX ,
	  MALMST.RSN RSN,
    MALMST.HSN HSN,
	MALMST.MALRMK,
    ROW_NUMBER () OVER (ORDER BY NULL) AS RNK ,
    MALMST.FLTCARIDR,
    MALMST.FLTNUM,
    MALMST.FLTSEQNUM,
    MALMST.MALIDR MALIDR,
	MALMST.ORGCOD ORGCOD,
	MALMST.DSTCOD DSTCOD,
	MALMST.VOLUNT VOLUNT,
    (
    CASE
      WHEN MALMST.MALTYP = 'M'
      THEN 'Y'
      ELSE 'N'
    END) AS PLTENBFLG,
	  (
    CASE
      WHEN CSGDTL.MALSEQNUM IS NOT NULL
      THEN 'Y'
      ELSE 'N'
      END) AS CRDPRT,
    MAL.STDBAG DSNSTDBAG,
    MAL.STDWGT DSNSTDWGT,
	MAL.FRMCARCOD FRMCARCOD,
    '' MALRAT,
    '' CURCOD,
	MAL.MRASTA,
	MALMST.MALSRVLVL MALSRVLVL,
	MALMST.TRPSRVENDTIM TRPSRVENDTIM,
	(CASE
     WHEN (SELECT MAX(FLTNUM)
     FROM MALCSGRTG CSGRTG
     WHERE CSGRTG.CMPCOD =CSGDTL.CMPCOD
     AND CSGRTG.CSGDOCNUM=CSGDTL.CSGDOCNUM
     AND CSGRTG.CSGSEQNUM=CSGDTL.CSGSEQNUM
     AND CSGRTG.POACOD   =CSGDTL.POACOD) IS NOT NULL
     THEN 'Y'
     ELSE 'N'
     END) AS RTGAVL,
	 CSGDTL.ULDNUM BLYCRTIDR	 
					FROM MALFLTCON CON
LEFT JOIN MALFLTCONRTG RTG
ON CON.CMPCOD     = RTG.CMPCOD
AND CON.ASGPRT    = RTG.ASGPRT
AND CON.CONNUM    = RTG.CONNUM
AND CON.FLTCARIDR = RTG.FLTCARIDR
AND CON.FLTNUM    = RTG.FLTNUM
AND CON.FLTSEQNUM = RTG.FLTSEQNUM
AND CON.LEGSERNUM = RTG.LEGSERNUM
LEFT JOIN MALULDSEG ULD
ON CON.CMPCOD     = ULD.CMPCOD
AND CON.FLTCARIDR = ULD.FLTCARIDR
AND CON.FLTNUM    = ULD.FLTNUM
AND CON.FLTSEQNUM = ULD.FLTSEQNUM
AND CON.SEGSERNUM = ULD.SEGSERNUM

                    AND ULD.ULDNUM  LIKE '%BULK-%'
LEFT JOIN MALULDSEGDTL MAL
ON ULD.CMPCOD     = MAL.CMPCOD
AND ULD.FLTCARIDR = MAL.FLTCARIDR
AND ULD.FLTNUM    = MAL.FLTNUM
AND ULD.FLTSEQNUM = MAL.FLTSEQNUM
AND ULD.SEGSERNUM = MAL.SEGSERNUM
AND ULD.ULDNUM    = MAL.ULDNUM
INNER JOIN MALMST MALMST
ON MAL.CMPCOD     = MALMST.CMPCOD
                    AND MAL.MALSEQNUM      = MALMST.MALSEQNUM
LEFT JOIN MALCSGDTL CSGDTL
ON MALMST.CMPCOD     = CSGDTL.CMPCOD
AND MALMST.MALSEQNUM = CSGDTL.MALSEQNUM
AND MALMST.CSGSEQNUM = CSGDTL.CSGSEQNUM
AND MALMST.CSGDOCNUM = CSGDTL.CSGDOCNUM
AND MALMST.POACOD    = CSGDTL.POACOD
                    --AND MALMST.CMPCOD     = HIS.CMPCOD
                    --AND MALMST.MALSEQNUM = HIS.MALSEQNUM
                    --AND MALMST.MALSTA   <> 'NEW'
                    --AND HIS.MALHISIDR =
                   --(SELECT MAX (MALHISIDR)
                    --FROM MALHIS
                   -- WHERE MALSEQNUM = MALMST.MALSEQNUM
                    --AND CMPCOD      = MALMST.CMPCOD
                    --AND MALSTA      = MALMST.MALSTA
                    --AND SCNPRT      = MALMST.SCNPRT
                    --)
WHERE CON.CONNUM = MAL.CONNUM
  	                AND CON.CMPCOD       = ?
					AND CON.FLTCARIDR    = ?
					AND CON.FLTNUM       = ?
					AND CON.FLTSEQNUM    = ?
					AND CON.ASGPRT       = ?
					AND CON.CONNUM       = ?
					AND CON.CONTYP       = 'B'

	  ]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>160</QRY:Id>
		<QRY:Source Name="mail.operations.findmailbagsincarrieruld" Type="NATIVE">
			<![CDATA[
	              SELECT MST.CMPCOD CMPCOD,
				  MST.CONNUM CONNUM,
				  MST.FLTCARIDR FLTCARIDR,
				  MST.FLTNUM FLTNUM,
				  MST.ASGPRT ASGPRT,
				  MST.FLTSEQNUM FLTSEQNUM,
				  MST.LEGSERNUM LEGSERNUM,
				  MST.SEGSERNUM SEGSERNUM,
				  MALMST.DSTCOD DSTCOD,
				  MST.POAFLG POAFLG,
				  MST.ACPFLG ACPFLG,
				  MST.OFLFLG OFLFLG,
				  MST.FLTCARCOD FLTCARCOD,
				  MALMST.VOL VOL,
				  MST.CONTYP,
				  MST.LSTUPDTIM CONLSTUPDTIM,
				  MST.CONJRNIDR,
				  MALMST.POACOD,
				  MST.TRNFLG,
				  ULD.ACPBAG ULDBAGCNT,
				  ULD.ACPWGT ULDBAGWGT,
				  ULD.RMK RMK,
				  ULD.WHSCOD WHSCOD,
				  ULD.LOCCOD LOCCOD,
				  ARPULD.FRMCARCOD FRMCARCOD,
				  ULD.LSTUPDTIM ULDLSTUPDTIM,
				  --MALMST.CMPCOD CMPCOD,
				  MALMST.DSN DSN,
				  MALMST.MALCLS MALCLS,
				  MALMST.SCNDAT SCNDAT,
				  MALMST.SCNPRT SCNPRT,
				  MALMST.SCNUSR SCNUSR,
				  MALMST.MALSTA MALSTA,
				  MALMST.MALSUBCLS MALSUBCLS,
				  MALMST.MALCTG MALCTGCOD,
				  MALMST.ORGEXGOFC ORGEXGOFC,
				  MALMST.DSTEXGOFC DSTEXGOFC,
				  MALMST.YER YER,
				  MALMST.MALSEQNUM MALSEQNUM,
				  MALMST.MALIDR MALIDR,
				  MALMST.ORGCOD ORGCOD,
				  MALMST.WGT WGT,
				  MALMST.DSPWGT DSPWGT,
				  MALMST.DSPWGTUNT DSPWGTUNT,
				  MALMST.RSN RSN,
				  MALMST.CSGDOCNUM CSGDOCNUM,
				  MALMST.VOLUNT VOLUNT,
				  MALMST.MALRMK MALRMK,
				  MALMST.MALSRVLVL MALSRVLVL,
				  MALMST.TRPSRVENDTIM TRPSRVENDTIM,
				  MALMST.REQDLVTIM REQDLVTIM,
				  MALMST.MSTDOCNUM,
                  MALMST.SHPPFX,
				  MALMST.DMGFLG,
				  MALMST.ACPPOACONNUM ACPPOACONNUM,
				  MALMST.ACPARPCOD ACPARPCOD,
				  ARPULD.STDBAG DSNSTDBAG,
				  ARPULD.ACPBAG DSNACPBAG,
				  ARPULD.STDWGT DSNSTDWGT,
				  ARPULD.ACPWGT DSNACPWGT,
				(
				CASE
				WHEN MALMST.MALTYP = 'M'
				THEN 'Y'
				ELSE 'N'
				END) AS PLTENBFLG,
				 (
                  CASE
                   WHEN CSGDTL.MALSEQNUM IS NOT NULL
                   THEN 'Y'
                   ELSE 'N'
                 END) AS CRDPRT
				FROM MALFLTCON MST
				INNER JOIN MALARPULD ULD
				ON MST.CMPCOD     = ULD.CMPCOD
				AND MST.ASGPRT    = ULD.ARPCOD
				AND MST.FLTCARIDR = ULD.FLTCARIDR
				AND MST.CONNUM    = ULD.ULDNUM
				LEFT OUTER JOIN MALARPULDDTL ARPULD
				ON ULD.CMPCOD = ARPULD.CMPCOD
				AND ULD.ULDNUM = ARPULD.ULDNUM
				AND ULD.ARPCOD = ARPULD.ARPCOD
				AND ULD.FLTCARIDR = ARPULD.FLTCARIDR
				AND ARPULD.CONNUM NOT LIKE '%BULK-ARR%'
				INNER JOIN MALMST MALMST
				ON ARPULD.CMPCOD     = MALMST.CMPCOD
				AND ARPULD.MALSEQNUM    = MALMST.MALSEQNUM
				LEFT OUTER JOIN MALCSGDTL CSGDTL
                ON MALMST.CMPCOD     = CSGDTL.CMPCOD
                AND MALMST.MALSEQNUM = CSGDTL.MALSEQNUM
                AND MALMST.CSGSEQNUM = CSGDTL.CSGSEQNUM
                AND MALMST.CSGDOCNUM = CSGDTL.CSGDOCNUM
                AND MALMST.POACOD    = CSGDTL.POACOD
				WHERE MST.CMPCOD  = ?
				AND MST.FLTCARIDR = ?
				AND MST.ASGPRT    = ?
				AND MST.CONTYP    = 'U'
				AND MST.TXNCOD    = 'ASG'
				AND MST.FLTSEQNUM = '-1'
                AND MST.CONNUM=?

  ]]>
		</QRY:Source>
	</QRY:Definition>
<QRY:Definition>
		<QRY:Id>163</QRY:Id>
		<QRY:Source Name="mail.operations.findmailbagsincarrierbulk" Type="NATIVE">
			<![CDATA[
	  SELECT MST.CMPCOD CMPCOD ,
				  MST.CONNUM CONNUM ,
				  MST.FLTCARIDR FLTCARIDR,
				  MST.FLTNUM FLTNUM,
				  MST.ASGPRT ASGPRT,
				  MST.FLTSEQNUM FLTSEQNUM,
				  MST.LEGSERNUM LEGSERNUM,
				  MST.SEGSERNUM SEGSERNUM,
				  DSNMST.DSTCOD DSTCOD,
				  MST.POAFLG POAFLG,
				  MST.ACPFLG ACPFLG,
				  MST.OFLFLG OFLFLG,
				  MST.FLTCARCOD FLTCARCOD,
				  MST.CONTYP,
				  MST.LSTUPDTIM CONLSTUPDTIM,
				  MST.CONJRNIDR,
				  DSNMST.POACOD,
				  MST.TRNFLG,
				  0 ULDBAGCNT,
				  0 ULDBAGWGT,
				  ULD.RMK RMK ,
				  ULD.WHSCOD WHSCOD,
				  ULD.LOCCOD LOCCOD,
				  NULL ULDLSTUPDTIM,
				  DSNMST.DSN DSN,
				  DSNMST.MALCLS MALCLS,
				  DSNMST.MALSUBCLS MALSUBCLS,
				  DSNMST.MALCTG MALCTGCOD,
				  DSNMST.ORGEXGOFC ORGEXGOFC,
				  DSNMST.DSTEXGOFC DSTEXGOFC,
				  DSNMST.YER YER,
				  DSNMST.MALSEQNUM MALSEQNUM,
				  DSNMST.ORGCOD ORGCOD,
				  DSNMST.MALIDR MALIDR,
                  DSNMST.SCNDAT SCNDAT,
                  DSNMST.SCNPRT SCNPRT,
				  DSNMST.SCNUSR SCNUSR,
				  DSNMST.MALSTA MALSTA,
				  DSNMST.WGT WGT,
				  DSNMST.VOL VOL,
				  DSNMST.DSPWGT DSPWGT,
				  DSNMST.DSPWGTUNT DSPWGTUNT,
				  DSNMST.RSN RSN,
				  DSNMST.CSGDOCNUM CSGDOCNUM,
				  DSNMST.MALRMK MALRMK,
				  DSNMST.VOLUNT VOLUNT,
				  DSNMST.MALSRVLVL MALSRVLVL,
				  DSNMST.TRPSRVENDTIM TRPSRVENDTIM,
				  DSNMST.REQDLVTIM REQDLVTIM,
				  DSNMST.MSTDOCNUM,
                  DSNMST.SHPPFX,
				  DSNMST.DMGFLG,
				  DSNMST.ACPPOACONNUM ACPPOACONNUM,
				  DSNMST.ACPARPCOD ACPARPCOD,
				  CONARP.STDBAG DSNSTDBAG ,
				  CONARP.ACPBAG DSNACPBAG,
				  CONARP.STDWGT DSNSTDWGT ,
				  CONARP.ACPWGT DSNACPWGT,
				  CONARP.FRMCARCOD FRMCARCOD,
				  (
				  CASE
					WHEN DSNMST.MALTYP = 'M'
					THEN 'Y'
					ELSE 'N'
				  END) AS PLTENBFLG,
				    (
                      CASE
                      WHEN CSGDTL.MALSEQNUM IS NOT NULL
                      THEN 'Y'
                       ELSE 'N'
                    END) AS CRDPRT,
					CSGDTL.ULDNUM BLYCRTIDR
				FROM MALFLTCON MST
				INNER JOIN MALARPULD ULD
				ON MST.CMPCOD     = ULD.CMPCOD
				AND MST.ASGPRT    = ULD.ARPCOD
				AND MST.FLTCARIDR = ULD.FLTCARIDR
				INNER JOIN MALARPULDDTL CONARP
				ON ULD.CMPCOD     = CONARP.CMPCOD
				AND ULD.FLTCARIDR = CONARP.FLTCARIDR
				AND ULD.ARPCOD    =CONARP.ARPCOD
				AND ULD.ULDNUM    =CONARP.ULDNUM
				AND MST.CONNUM    = CONARP.CONNUM
				INNER JOIN MALMST DSNMST
				ON CONARP.CMPCOD     =DSNMST.CMPCOD
				 AND CONARP.FLTCARIDR =DSNMST.FLTCARIDR
				AND CONARP.MALSEQNUM = DSNMST.MALSEQNUM
				LEFT OUTER JOIN MALCSGDTL CSGDTL
				ON DSNMST.CMPCOD     = CSGDTL.CMPCOD
                AND DSNMST.MALSEQNUM = CSGDTL.MALSEQNUM
                AND DSNMST.CSGSEQNUM = CSGDTL.CSGSEQNUM
                AND DSNMST.CSGDOCNUM = CSGDTL.CSGDOCNUM
                AND DSNMST.POACOD    = CSGDTL.POACOD
				WHERE MST.CMPCOD     = ?
				AND MST.FLTCARIDR    = ?
				AND MST.ASGPRT       = ?
				AND MST.CONTYP       ='B'
				AND MST.TXNCOD       = 'ASG'
				AND MST.FLTSEQNUM    = '-1'
                AND MST.CONNUM = ?

  ]]>
		</QRY:Source>
	</QRY:Definition>
<QRY:Definition>
	<QRY:Id>401</QRY:Id>
	<QRY:Source Name="mail.operations.findmailbagsincarrierdsnview" Type="NATIVE">
			<![CDATA[
SELECT CMPCOD,
  DSN,
  ORGEXGOFC,
  DSTEXGOFC,
  MAX(MALCLS) MALCLS,
  MALSUBCLS,
  MALCTGCOD,
  YER,
  MAX(CSGDOCNUM) CSGDOCNUM,
  MAX(POACOD) POACOD,
  MAX(DOCOWRCOD) DOCOWRCOD,
  MAX(SEQNUM) SEQNUM,
  MAX(DUPNUM) DUPNUM,
  MAX(MSTDOCNUM) MSTDOCNUM,
  COUNT(MALSEQNUM) DSNCNT,
  SUM(MALWGT) DSNWGT
FROM
				 (SELECT MALMST.CMPCOD CMPCOD,
				  MST.CONNUM CONNUM,
				  MST.FLTCARIDR FLTCARIDR,
				  MST.FLTNUM FLTNUM,
				  MST.ASGPRT ASGPRT,
				  MST.FLTSEQNUM FLTSEQNUM,
				  MST.LEGSERNUM LEGSERNUM,
				  MST.SEGSERNUM SEGSERNUM,
				  MST.DSTCOD DSTCOD,
				  MST.POAFLG POAFLG,
				  MST.ACPFLG ACPFLG,
				  MST.OFLFLG OFLFLG,
				  MST.FLTCARCOD FLTCARCOD,
				  MST.CONTYP,
				  MST.LSTUPDTIM CONLSTUPDTIM,
				  MST.CONJRNIDR,
				  MST.TRNFLG,
				  ULD.ACPBAG ULDBAGCNT,
				  ULD.ACPWGT ULDBAGWGT,
				  ULD.RMK RMK,
				  ULD.WHSCOD WHSCOD,
				  ULD.LOCCOD LOCCOD,
				  ARPULD.FRMCARCOD FRMCARCOD,
				  ULD.LSTUPDTIM ULDLSTUPDTIM,
				  MALMST.DSN DSN,
                  MALMST.ORGEXGOFC ORGEXGOFC,
                  MALMST.DSTEXGOFC DSTEXGOFC,
				  MALMST.MALCLS MALCLS,
				  MALMST.MALSUBCLS MALSUBCLS,
				  MALMST.MALCTG MALCTGCOD,
				  MALMST.YER YER,
				  MALMST.MALSEQNUM MALSEQNUM,
                  MALMST.WGT MALWGT,
                  MALMST.SHPPFX DOCOWRCOD,
                  MALMST.DOCOWRIDR DOCOWRIDR,
                  MALMST.SEQNUM SEQNUM,
                  MALMST.DUPNUM DUPNUM,
                  MALMST.MSTDOCNUM MSTDOCNUM,
				  MALMST.CSGDOCNUM CSGDOCNUM,
                  MALMST.CSGSEQNUM CSGSEQNUM,
                  MALMST.POACOD POACOD,
				  ARPULD.STDBAG DSNSTDBAG,
				  ARPULD.ACPBAG DSNACPBAG,
				  ARPULD.STDWGT DSNSTDWGT,
				  ARPULD.ACPWGT DSNACPWGT,
				(
				CASE
				WHEN MALMST.MALTYP = 'M'
				THEN 'Y'
				ELSE 'N'
				END) AS PLTENBFLG
				FROM MALFLTCON MST
				INNER JOIN MALARPULD ULD
				ON MST.CMPCOD     = ULD.CMPCOD
				AND MST.ASGPRT    = ULD.ARPCOD
				AND MST.FLTCARIDR = ULD.FLTCARIDR
				AND MST.CONNUM    = ULD.ULDNUM
				LEFT OUTER JOIN MALARPULDDTL ARPULD
				ON ULD.CMPCOD = ARPULD.CMPCOD
				AND ULD.ULDNUM = ARPULD.ULDNUM
				AND ULD.ARPCOD = ARPULD.ARPCOD
				AND ULD.FLTCARIDR = ARPULD.FLTCARIDR
				INNER JOIN MALMST MALMST
				ON ARPULD.CMPCOD     = MALMST.CMPCOD
				AND ARPULD.MALSEQNUM    = MALMST.MALSEQNUM
				AND ARPULD.CONNUM    = MALMST.CONNUM
				WHERE MST.CMPCOD  = ?
				AND MST.FLTCARIDR = ?
				AND MST.ASGPRT    = ?
				AND MST.CONTYP    = 'U'
				AND MST.TXNCOD    = 'ASG'
				AND MST.FLTSEQNUM = '-1'
                AND MST.CONNUM    = ?

]]>
		</QRY:Source>
	</QRY:Definition>
<QRY:Definition>
	<QRY:Id>402</QRY:Id>
	<QRY:Source Name="mail.operations.findmailbagsincarrierbulkdsnview" Type="NATIVE">
			<![CDATA[
	SELECT CMPCOD,
  DSN,
  ORGEXGOFC,
  DSTEXGOFC,
  MAX(MALCLS) MALCLS,
  MALSUBCLS,
  MALCTGCOD,
  YER,
  MAX(CSGDOCNUM) CSGDOCNUM,
  MAX(CSGSEQNUM) CSGSEQNUM,
  MAX(POACOD) POACOD,
  MAX(DOCOWRCOD) DOCOWRCOD,

  MAX(SEQNUM) SEQNUM,
  MAX(DUPNUM) DUPNUM,
  MAX(MSTDOCNUM) MSTDOCNUM,
  COUNT(MALSEQNUM) DSNCNT,
  SUM(DSNACPWGT) DSNWGT
FROM
                 (SELECT MST.CMPCOD CMPCOD ,
                  MST.CONNUM CONNUM ,
                  MST.FLTCARIDR FLTCARIDR,
                  MST.FLTNUM FLTNUM,
                  MST.ASGPRT ASGPRT,
                  MST.FLTSEQNUM FLTSEQNUM,
                  MST.LEGSERNUM LEGSERNUM,
                  MST.SEGSERNUM SEGSERNUM,
                  MST.DSTCOD DSTCOD,
                  MST.POAFLG POAFLG,
                  MST.ACPFLG ACPFLG,
                  MST.OFLFLG OFLFLG,
                  MST.FLTCARCOD FLTCARCOD,
                  MST.CONTYP,
                  MST.LSTUPDTIM CONLSTUPDTIM,
                  MST.CONJRNIDR,
                  MALMST.POACOD,
                  MST.TRNFLG,
                  0 ULDBAGCNT,
                  0 ULDBAGWGT,
                  ULD.RMK RMK ,
                  ULD.WHSCOD WHSCOD,
                  ULD.LOCCOD LOCCOD,
                  CONARP.FRMCARCOD FRMCARCOD,
                  NULL ULDLSTUPDTIM,
                  MALMST.DSN DSN,
                  MALMST.MALCLS MALCLS,
                  MALMST.MALSUBCLS MALSUBCLS,
                  MALMST.MALCTG MALCTGCOD,
                  MALMST.ORGEXGOFC ORGEXGOFC,
                  MALMST.DSTEXGOFC DSTEXGOFC,
                  MALMST.YER YER,
                  MALMST.MALSEQNUM MALSEQNUM,
                  MALMST.ORGCOD ORGCOD,
                  MALMST.CSGDOCNUM CSGDOCNUM,
                  MALMST.CSGSEQNUM CSGSEQNUM,
                  MALMST.SHPPFX DOCOWRCOD,
                  MALMST.DOCOWRIDR DOCOWRIDR,
                  MALMST.SEQNUM SEQNUM,
                  MALMST.DUPNUM DUPNUM,
                  MALMST.MSTDOCNUM MSTDOCNUM,
				  MALMST.MALSTA MALSTA,
                  --DSNMST.DSTCOD DSTCOD,
                  CONARP.STDBAG DSNSTDBAG ,
                  CONARP.ACPBAG DSNACPBAG,
                  CONARP.STDWGT DSNSTDWGT ,
                  CONARP.ACPWGT DSNACPWGT,
               (
               CASE
                  WHEN MALMST.MALTYP = 'M'
                  THEN 'Y'
                  ELSE 'N'
               END) AS PLTENBFLG
               FROM MALFLTCON MST
               INNER JOIN MALARPULD ULD
               ON MST.CMPCOD     = ULD.CMPCOD
               AND MST.ASGPRT    = ULD.ARPCOD
               AND MST.FLTCARIDR = ULD.FLTCARIDR
               INNER JOIN MALARPULDDTL CONARP
               ON ULD.CMPCOD     = CONARP.CMPCOD
               AND ULD.FLTCARIDR = CONARP.FLTCARIDR
               AND ULD.ARPCOD    =CONARP.ARPCOD
               AND ULD.ULDNUM    =CONARP.ULDNUM
               AND MST.CONNUM    = CONARP.CONNUM
               INNER JOIN MALMST MALMST
               ON CONARP.CMPCOD     =MALMST.CMPCOD
               AND CONARP.FLTCARIDR =MALMST.FLTCARIDR
               AND CONARP.MALSEQNUM = MALMST.MALSEQNUM
               WHERE MST.CMPCOD     = ?
               AND MST.FLTCARIDR    = ?
               AND MST.ASGPRT       = ?
               AND MST.CONTYP       ='B'
               AND MST.TXNCOD       = 'ASG'
               AND MST.FLTSEQNUM    = '-1'
               AND MST.CONNUM = ?

]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>403</QRY:Id>
	<QRY:Source Name="mail.operations.findlyinglistssummaryview" Type="OBJECT">
			<![CDATA[
	select count(*)COUNT, sum(RCPWGT)TOTWGT
     from (SELECT DISTINCT MALMST.MALIDR MALIDR,
        TRT.FLTNUM,
        TRT.FLTDAT DEPTIM,
        TRT.FLTCARCOD CARCOD,
        MALMST.ORGEXGOFC ORGEXGOFF,
        MALMST.DSTEXGOFC DSTEXGOFF,
        MALMST.YER DSPYER,
        MALMST.DSN DSPSRLNUM,
        MALMST.RSN RCPSRLNUM,
        MALMST.MALCTG MALCTGCOD,
        MALMST.MALSUBCLS MALSUBCOD,
        MALMST.REGIND RCPRGDINS ,
        MALMST.HSN HSTRCPNUM,
        MALMST.WGT RCPWGT,
        MALMST.CMPCOD,
        MALMST.SHPPFX,
        MALMST.MSTDOCNUM,
        CSGMST.CSGDOCNUM,
        CSGMST.CSGDAT CSGCMPDAT,
        CSGMST.CSGDAT CDTRCVDAT,
        MALMST.POACOD AS SDRIDR,
        CSGDTL.ULDNUM CONNUM,
        (SELECT 'Y'
        FROM DUAL
        WHERE EXISTS
          (SELECT 1
          FROM MALMST MALMST
          WHERE MALMST.CMPCOD  = CSGDTL.CMPCOD
          AND MALMST.MALSEQNUM =CSGDTL.MALSEQNUM
          AND (MALMST.MALSTA  !='NEW'
          AND MALMST.MALSTA   !='BKD'
          AND MALMST.MALSTA   !='CAN'
          AND MALMST.MALSTA   !='OFL')
          )
        ) ACP ,
        MALMST.DUPNUM,
        MALMST.SEQNUM,
        MALMST.DOCOWRIDR,
        MALMST.REQDLVTIM,
        (select COALESCE(mst.arpcod,cty.srvarpcod) a from malexgofcmst mst, shrctymst cty where
mst.cmpcod = cty.cmpcod
and mst.ctycod = cty.ctycod
and mst.exgofccod=malmst.dstexgofc
and mst.cmpcod=malmst.cmpcod)DSTCOD
      FROM MALCSGDTL CSGDTL
      INNER JOIN MALMST MALMST
      ON MALMST.CMPCOD     = CSGDTL.CMPCOD
      AND MALMST.MALSEQNUM = CSGDTL.MALSEQNUM
      AND MALMST.CSGSEQNUM = CSGDTL.CSGSEQNUM
      AND MALMST.CSGDOCNUM = CSGDTL.CSGDOCNUM
      AND MALMST.POACOD    = CSGDTL.POACOD
      INNER JOIN MALCSGMST CSGMST
      ON CSGMST.CMPCOD     = CSGDTL.CMPCOD
      AND CSGMST.CSGDOCNUM = CSGDTL.CSGDOCNUM
      AND CSGMST.CSGSEQNUM = CSGDTL.CSGSEQNUM
      AND CSGMST.POACOD    = CSGDTL.POACOD
      LEFT OUTER JOIN MALCSGRTG TRT
      ON CSGMST.CMPCOD     = TRT.CMPCOD
      AND CSGMST.CSGDOCNUM = TRT.CSGDOCNUM
      AND CSGMST.CSGSEQNUM =TRT.CSGSEQNUM
      AND CSGMST.POACOD    =TRT.POACOD
      WHERE CSGMST.CMPCOD  = ?
	  ]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
			<QRY:Id>164</QRY:Id>
				<QRY:Source Name="mail.operations.findcapturednotaccpetedmailbagssummaryview" Type="NATIVE">
				<![CDATA[
					select count(*)COUNT, sum(WGT)TOTWGT
                      from (SELECT CSGMAL.CMPCOD,
						  CSGMST.CSGDAT SCNDAT,
						  CSGMAL.CSGDOCNUM,
						  CSGMAL.POACOD,
						  CSGMAL.CSGSEQNUM,
						  CSGMST.OPRTYP OPRSTA,
						  CSGMST.ARPCOD SCNPRT,
						  RTG.FLTCARCOD,
						  RTG.FLTCARIDR,
						  RTG.FLTNUM,
						  RTG.FLTDAT,
						  RTG.FLTSEQNUM,
						  MALMST.DSN,
						  MALMST.ORGEXGOFC,
						  MALMST.DSTEXGOFC,
						  MALMST.MALCLS,
						  MALMST.YER,
						  MALMST.WGT WGT,
						  MALMST.MALSEQNUM,
						  MALMST.MALIDR,
						  MALMST.MALCTG MALCTGCOD,
						  MALMST.MALSUBCLS,
						  MALMST.HSN,
						  MALMST.RSN,
						  MALMST.REGIND,
						  MALMST.REQDLVTIM,
						CSGMST.STDWGT ACPWGT,
						  CSGMAL.ULDNUM CONNUM,
					   CSGMST.STDBAG ACPBAG,
						  CSGMST.CSGDAT,
						  CSGMST.LSTUPDUSR SCNUSR,
						  CSGMST.LSTUPDUSR,
						  'CAP' MALSTA
						FROM MALCSGMST CSGMST
						INNER JOIN MALCSGDTL CSGMAL
						ON CSGMAL.CMPCOD     = CSGMST.CMPCOD
						AND CSGMAL.CSGDOCNUM = CSGMST.CSGDOCNUM
						AND CSGMAL.POACOD    = CSGMST.POACOD
						AND CSGMAL.CSGSEQNUM = CSGMST.CSGSEQNUM
						INNER JOIN MALMST MALMST
						ON MALMST.CMPCOD  = CSGMAL.CMPCOD
						AND MALMST.MALSEQNUM = CSGMAL.MALSEQNUM
						AND COALESCE(MALMST.MALSTA,'N') ='NEW'
						INNER JOIN MALCSGRTG RTG
						ON RTG.CMPCOD     = CSGMST.CMPCOD
						AND RTG.CSGDOCNUM = CSGMST.CSGDOCNUM
						AND RTG.POACOD    = CSGMST.POACOD
						AND RTG.CSGSEQNUM = CSGMST.CSGSEQNUM
						AND RTG.RTGSERNUM =
						  (SELECT MIN(RTGSERNUM)
						  FROM MALCSGRTG
						  WHERE CMPCOD  = CSGMST.CMPCOD
						  AND CSGDOCNUM = CSGMST.CSGDOCNUM
						  AND POACOD    = CSGMST.POACOD
						  AND CSGSEQNUM = CSGMST.CSGSEQNUM
					    ]]>
				</QRY:Source>
	</QRY:Definition>
	 <QRY:Definition>
		<QRY:Id>165</QRY:Id>
		<QRY:Source Name="mail.operations.findinboundflightdetailsprefix" Type="NATIVE">
			<![CDATA[
						SELECT CMPCOD,
								  FLTNUM,
								  FLTDAT,
								  FLTCARIDR,
								  FLTSEQNUM,
								  FLTCARCOD,
								  LEGDST,
								  LEGORG,
								  FLTSTA,
								  FLTROU,
								  STA,
								  ETA,
								  ATA,
								  ACRTYP,
								  ARVGTE,
								  LEGSERNUM,
								  ARRTIM,
								  IMPCLSFLG,
								  SUM(TOTACPBAG) TOTACPBAG,
								  SUM(TOTACPWGT)TOTACPWGT,
                                  SUM(TOTRCVBAG)TOTRCVBAG,
                                  SUM(TOTRCVWGT)TOTRCVWGT,
								  MAX(ULDCHK) ULDCHK,
								  MAX(ONLARPPAR) ONLARPPAR
								FROM
								  (SELECT FLTMST.CMPCOD,
									FLTMST.FLTNUM,
									FLTMST.FLTDAT,
									FLTMST.FLTCARIDR,
									FLTMST.FLTSEQNUM,
									ARLMST.TWOAPHCOD FLTCARCOD,
									FLTLEG.LEGDST,
									FLTLEG.LEGORG,
									FLTMST.FLTSTA,
									FLTMST.FLTTYP,
									FLTMST.FLTROU,
									FLTLEG.STA,
									FLTLEG.ETA,
									FLTLEG.ATA,
									FLTLEG.ACRTYP,
									FLTLEG.ARVGTE,
									FLTLEG.LEGSERNUM,
									COALESCE(FLTLEG.ATA, FLTLEG.ETA, FLTLEG.STA)ARRTIM,
									MALFLT.IMPCLSFLG,
									SEGDTL.ACPBAG TOTACPBAG,
                                    SEGDTL.ACPWGT TOTACPWGT,
                                    SEGDTL.RCVBAG TOTRCVBAG,
                                    SEGDTL.RCVWGT TOTRCVWGT,
									ULDSEG.ULDNUM ULDCHK,
									CASE WHEN ARPPAR.PARVAL IS NULL OR ARPPAR.PARVAL    ='N' THEN 'Y' WHEN ARPPAR.PARVAL ='Y'  AND FLTLEG.ATD    IS NOT NULL  THEN 'Y'
									ELSE 'N'  END AS ONLARPPAR
  from FLTOPRMST FLTMST
  inner join FLTOPRLEG FLTLEG
  on FLTMST.CMPCOD     = FLTLEG.CMPCOD
									 
									AND FLTMST.FLTNUM         = FLTLEG.FLTNUM
									AND FLTMST.FLTCARIDR      = FLTLEG.FLTCARIDR
									AND FLTMST.FLTSEQNUM      = FLTLEG.FLTSEQNUM
  inner join FLTOPRSEG FLTSEG
  on FLTMST.CMPCOD     = FLTSEG.CMPCOD
									AND FLTMST.FLTNUM         = FLTSEG.FLTNUM
									AND FLTMST.FLTCARIDR      = FLTSEG.FLTCARIDR
									AND FLTMST.FLTSEQNUM      = FLTSEG.FLTSEQNUM
  left outer join MALULDSEG ULDSEG
  on FLTSEG.CMPCOD     = ULDSEG.CMPCOD
  and FLTSEG.FLTCARIDR = ULDSEG.FLTCARIDR
  and FLTSEG.FLTNUM    = ULDSEG.FLTNUM
  and FLTSEG.FLTSEQNUM = ULDSEG.FLTSEQNUM
  and FLTSEG.SEGSERNUM = ULDSEG.SEGSERNUM
  left outer join MALULDSEGDTL SEGDTL
  on ULDSEG.CMPCOD     = SEGDTL.CMPCOD
  and ULDSEG.FLTCARIDR = SEGDTL.FLTCARIDR
  and ULDSEG.FLTNUM    = SEGDTL.FLTNUM
  and ULDSEG.FLTSEQNUM = SEGDTL.FLTSEQNUM
  and ULDSEG.SEGSERNUM = SEGDTL.SEGSERNUM
  and ULDSEG.ULDNUM    = SEGDTL.ULDNUM
  left outer join MALMST MALMST
  on SEGDTL.CMPCOD     = MALMST.CMPCOD
  and SEGDTL.MALSEQNUM = MALMST.MALSEQNUM
  left outer join MALFLT MALFLT
  on FLTLEG.CMPCOD     = MALFLT.CMPCOD
  and FLTLEG.FLTNUM    = MALFLT.FLTNUM
  and FLTLEG.FLTCARIDR = MALFLT.FLTCARIDR
  and FLTLEG.FLTSEQNUM = MALFLT.FLTSEQNUM
  and FLTLEG.LEGSERNUM = MALFLT.LEGSERNUM
  and FLTLEG.LEGDST    = MALFLT.ARPCOD
  inner join SHRARLMST ARLMST
  on FLTMST.CMPCOD     = ARLMST.CMPCOD
                                    AND FLTMST.FLTCARIDR=    ARLMST.ARLIDR
  left outer join FLTOPROPRREF FLTREF
  on FLTLEG.CMPCOD     = FLTREF.CMPCOD
  and FLTLEG.FLTNUM    = FLTREF.FLTNUM
  and FLTLEG.FLTCARIDR = FLTREF.FLTCARIDR
  and FLTLEG.FLTSEQNUM = FLTREF.FLTSEQNUM
  and FLTLEG.LEGSERNUM = FLTREF.LEGSERNUM
  and FLTREF.OPRREF='Y'
  LEFT OUTER JOIN SHRARPMST ARPMST
        ON FLTLEG.CMPCOD     = ARPMST.CMPCOD
        and FLTLEG.legorg=ARPMST.arpcod
         LEFT OUTER JOIN SHRUSEARPPAR ARPPAR
         ON ARPMST.CMPCOD= ARPPAR.CMPCOD
         AND ARPMST.ARPCOD=ARPPAR.ARPCOD
         AND ARPPAR.PARCOD='operations.flthandling.isonlinehandledairport'
  where 1              =1	
				]]>
		</QRY:Source>
	</QRY:Definition>
	 <QRY:Definition>
		<QRY:Id>166</QRY:Id>
		<QRY:Source Name="mail.operations.findinboundflightdetailssuffix" Type="NATIVE">
			<![CDATA[
						UNION ALL
						SELECT
    fltmst.cmpcod,
								FLTMST.FLTNUM,
								FLTMST.FLTDAT,
								FLTMST.FLTCARIDR,
								FLTMST.FLTSEQNUM,
    arlmst.twoaphcod fltcarcod,
								FLTLEG.LEGDST,
								FLTLEG.LEGORG,
								FLTMST.FLTSTA,
								FLTMST.FLTROU,
								FLTLEG.STA,
								FLTLEG.ETA,
								FLTLEG.ATA,
								FLTLEG.ACRTYP,
								FLTLEG.ARVGTE,
								FLTLEG.LEGSERNUM,
								COALESCE(FLTLEG.ATA, FLTLEG.ETA, FLTLEG.STA)ARRTIM,
								MALFLT.IMPCLSFLG,
								SEGDTL.ACPBAG TOTACPBAG,
								SEGDTL.ACPWGT TOTACPWGT,
								SEGDTL.RCVBAG TOTRCVBAG,
    segdtl.rcvwgt totrcvwgt,
    null uldchk
FROM
    fltoprmst fltmst
    INNER JOIN fltoprleg fltleg ON fltmst.cmpcod = fltleg.cmpcod
							   
							   
								AND FLTMST.FLTNUM         = FLTLEG.FLTNUM
								AND FLTMST.FLTCARIDR      = FLTLEG.FLTCARIDR
								AND FLTMST.FLTSEQNUM      = FLTLEG.FLTSEQNUM
    INNER JOIN fltoprseg fltseg ON fltmst.cmpcod = fltseg.cmpcod
								AND FLTMST.FLTNUM         = FLTSEG.FLTNUM
								AND FLTMST.FLTCARIDR      = FLTSEG.FLTCARIDR
								AND FLTMST.FLTSEQNUM      = FLTSEG.FLTSEQNUM
    LEFT OUTER JOIN maluldseg uldseg ON fltseg.cmpcod = uldseg.cmpcod
                                        AND fltseg.fltcaridr = uldseg.fltcaridr
                                        AND fltseg.fltnum = uldseg.fltnum
                                        AND fltseg.fltseqnum = uldseg.fltseqnum
                                        AND fltseg.segsernum = uldseg.segsernum
    LEFT OUTER JOIN maluldsegdtl segdtl ON uldseg.cmpcod = segdtl.cmpcod
                                           AND uldseg.fltcaridr = segdtl.fltcaridr
                                           AND uldseg.fltnum = segdtl.fltnum
                                           AND uldseg.fltseqnum = segdtl.fltseqnum
                                           AND uldseg.segsernum = segdtl.segsernum
                                           AND uldseg.uldnum = segdtl.uldnum
							  AND ULDSEG.ULDNUM LIKE '%BULK-%'
    LEFT OUTER JOIN malmst malmst ON segdtl.cmpcod = malmst.cmpcod
                                     AND segdtl.malseqnum = malmst.malseqnum
    LEFT OUTER JOIN malflt malflt ON fltleg.cmpcod = malflt.cmpcod
                                     AND fltleg.fltnum = malflt.fltnum
                                     AND fltleg.fltcaridr = malflt.fltcaridr
                                     AND fltleg.fltseqnum = malflt.fltseqnum
                                     AND fltleg.legsernum = malflt.legsernum
                                     AND fltleg.legdst = malflt.arpcod
    LEFT OUTER JOIN malfltcon fltcon ON malflt.cmpcod = fltcon.cmpcod
                                        AND malflt.arpcod = fltcon.asgprt
                                        AND malflt.fltcaridr = fltcon.fltcaridr
                                        AND malflt.fltnum = fltcon.fltnum
                                        AND malflt.fltseqnum = fltcon.fltseqnum
                                        AND malflt.legsernum = fltcon.legsernum
							  AND FLTCON.CONTYP    = 'B'	
    LEFT OUTER JOIN shrarlmst arlmst ON fltmst.cmpcod = arlmst.cmpcod
                                   AND fltmst.fltcaridr = arlmst.arlidr
WHERE
    1 = 1	
				]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>166</QRY:Id>
		<QRY:Source Name="mail.operations.findinboundnewflightdetails" Type="NATIVE">
			<![CDATA[
				UNION ALL
						SELECT
    fltmst.cmpcod,
						  FLTMST.FLTNUM,
						  FLTMST.FLTDAT,
						  FLTMST.FLTCARIDR,
						  FLTMST.FLTSEQNUM,
						  ARLMST.TWOAPHCOD FLTCARCOD,
						  FLTLEG.LEGDST,
						  FLTLEG.LEGORG,
						  FLTMST.FLTSTA,
						  FLTMST.FLTROU,
						  FLTLEG.STA,
						  FLTLEG.ETA,
						  FLTLEG.ATA,
						  FLTLEG.ACRTYP,
						  FLTLEG.ARVGTE,
						  FLTLEG.LEGSERNUM,
						  COALESCE(FLTLEG.ATA, FLTLEG.ETA, FLTLEG.STA)ARRTIM,
						  'N' IMPCLSFLG,
						  0 TOTACPBAG,
						  0 TOTACPWGT,
						  0 TOTRCVBAG,
    0 totrcvwgt,
    null uldchk
FROM
    fltoprmst fltmst
    INNER JOIN fltoprleg fltleg ON fltmst.cmpcod = fltleg.cmpcod
                                   AND fltmst.fltnum = fltleg.fltnum
                                   AND fltmst.fltcaridr = fltleg.fltcaridr
                                   AND fltmst.fltseqnum = fltleg.fltseqnum
    INNER JOIN shrarlmst arlmst ON fltmst.cmpcod = arlmst.cmpcod
                                   AND fltmst.fltcaridr = arlmst.arlidr
                                   AND NOT EXISTS (
        SELECT
            1
        FROM
            malfltcon fltcon
        WHERE
            fltleg.cmpcod = fltcon.cmpcod
            AND fltleg.legorg = fltcon.asgprt
            AND fltleg.fltcaridr = fltcon.fltcaridr
            AND fltleg.fltnum = fltcon.fltnum
            AND fltleg.fltseqnum = fltcon.fltseqnum
						  )
WHERE
    fltmst.fltsta != 'CAN'
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>166</QRY:Id>
		<QRY:Source Name="mail.operations.findinboundmanifestdetails" Type="NATIVE">
			<![CDATA[
						SELECT CMPCOD,
							  FLTCARIDR,
							  FLTNUM,
							  FLTSEQNUM,
							  
							  SEGSERNUM,
							  CONNUM,
							  COUNT(CONNUM) CONCOUNT ,
							  SUM(WGT) TOTWGT,
							  SUM(MALCOUNT) MALCOUNT
							FROM
							  (SELECT MALFLT.CMPCOD,
								malflt.FLTCARIDR,
								MALFLT.FLTNUM,
								MALFLT.FLTSEQNUM,
								
								SEG.SEGSERNUM,
								(
								CASE
								  WHEN CONTYP = 'U'
								  THEN SUBSTR(CONNUM, 0,4)
								  ELSE 'BULK'
								END) CONNUM,
								(SELECT SUM(SEGDTL1.WGT)
								FROM MALULDSEGDTL SEGDTL1
								WHERE SEGDTL1.CMPCOD  = FLTCON.CMPCOD
								AND SEGDTL1.FLTCARIDR = FLTCON.FLTCARIDR
								AND SEGDTL1.FLTNUM    = FLTCON.FLTNUM
								AND SEGDTL1.FLTSEQNUM = FLTCON.FLTSEQNUM
								AND SEGDTL1.SEGSERNUM = FLTCON.SEGSERNUM
								AND SEGDTL1.CONNUM    = FLTCON.CONNUM
								) WGT,
							  (SELECT COUNT(SEGDTL1.MALSEQNUM)
								FROM MALULDSEGDTL SEGDTL1
								WHERE SEGDTL1.CMPCOD  = FLTCON.CMPCOD
								AND SEGDTL1.FLTCARIDR = FLTCON.FLTCARIDR
								AND SEGDTL1.FLTNUM    = FLTCON.FLTNUM
								AND SEGDTL1.FLTSEQNUM = FLTCON.FLTSEQNUM
								AND SEGDTL1.SEGSERNUM = FLTCON.SEGSERNUM
								AND SEGDTL1.CONNUM    = FLTCON.CONNUM
								) MALCOUNT
							  FROM MALFLT MALFLT,
							    FLTOPRLEG LEG,
								MALFLTSEG SEG,
								MALFLTCON FLTCON
							  WHERE MALFLT.CMPCOD  = SEG.CMPCOD
							  AND MALFLT.FLTNUM    = SEG.FLTNUM
							  AND MALFLT.FLTCARIDR = SEG.FLTCARIDR
							  AND MALFLT.FLTSEQNUM = SEG.FLTSEQNUM
							  AND MALFLT.ARPCOD    = SEG.POU
							  AND MALFLT.FLTNUM =LEG.FLTNUM
                              AND MALFLT.FLTSEQNUM= LEG.FLTSEQNUM
                              AND MALFLT.LEGSERNUM= LEG.LEGSERNUM
							  AND MALFLT.CMPCOD    = FLTCON.CMPCOD
							  AND MALFLT.ARPCOD    = FLTCON.POU
							  AND MALFLT.FLTCARIDR = FLTCON.FLTCARIDR
							  AND MALFLT.FLTNUM    = FLTCON.FLTNUM
							  AND MALFLT.FLTSEQNUM = FLTCON.FLTSEQNUM
							  AND MALFLT.LEGSERNUM = FLTCON.LEGSERNUM
							  AND SEG.POU = FLTCON.POU
				]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>167</QRY:Id>
		<QRY:Source Name="mail.operations.findinboundmanifestdetailssuffix" Type="NATIVE">
			<![CDATA[
			UNION
						SELECT MALFLT.CMPCOD,
								malflt.FLTCARIDR,
								MALFLT.FLTNUM,
								MALFLT.FLTSEQNUM,
								
								SEG.SEGSERNUM,
								(
								CASE
								  WHEN CONTYP = 'U'
								  THEN SUBSTR(CONNUM, 0,4)
								  ELSE 'BULK'
								END) CONNUM,
								(SELECT SUM(SEGDTL1.WGT)
								FROM MALULDSEGDTL SEGDTL1
								WHERE SEGDTL1.CMPCOD  = FLTCON.CMPCOD
								AND SEGDTL1.FLTCARIDR = FLTCON.FLTCARIDR
								AND SEGDTL1.FLTNUM    = FLTCON.FLTNUM
								AND SEGDTL1.FLTSEQNUM = FLTCON.FLTSEQNUM
								AND SEGDTL1.SEGSERNUM = FLTCON.SEGSERNUM
								AND SEGDTL1.CONNUM    = FLTCON.CONNUM
								) WGT,
							  (SELECT COUNT(SEGDTL1.MALSEQNUM)
								FROM MALULDSEGDTL SEGDTL1
								WHERE SEGDTL1.CMPCOD  = FLTCON.CMPCOD
								AND SEGDTL1.FLTCARIDR = FLTCON.FLTCARIDR
								AND SEGDTL1.FLTNUM    = FLTCON.FLTNUM
								AND SEGDTL1.FLTSEQNUM = FLTCON.FLTSEQNUM
								AND SEGDTL1.SEGSERNUM = FLTCON.SEGSERNUM
								AND SEGDTL1.CONNUM    = FLTCON.CONNUM
								) MALCOUNT
							  FROM MALFLT MALFLT,
								MALFLTSEG SEG,
								FLTOPRLEG LEG,
								MALFLTCON FLTCON
							  WHERE MALFLT.CMPCOD  = SEG.CMPCOD
							  AND MALFLT.FLTNUM    = SEG.FLTNUM
							  AND MALFLT.FLTCARIDR = SEG.FLTCARIDR
							  AND MALFLT.FLTSEQNUM = SEG.FLTSEQNUM
							  AND MALFLT.ARPCOD    = SEG.POL
							  AND MALFLT.FLTNUM    =LEG.FLTNUM
                              AND MALFLT.FLTSEQNUM= LEG.FLTSEQNUM
                              AND MALFLT.LEGSERNUM= LEG.LEGSERNUM
							  AND MALFLT.CMPCOD    = FLTCON.CMPCOD
							  AND MALFLT.ARPCOD    = FLTCON.ASGPRT
							  AND MALFLT.FLTCARIDR = FLTCON.FLTCARIDR
							  AND MALFLT.FLTNUM    = FLTCON.FLTNUM
							  AND MALFLT.FLTSEQNUM = FLTCON.FLTSEQNUM
							  AND MALFLT.LEGSERNUM = FLTCON.LEGSERNUM
							  AND SEG.POU = FLTCON.POU
				]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
 <QRY:Id>153</QRY:Id>
 <QRY:Source Name="mail.operations.findinboundflightcontainerdetails" Type="NATIVE">
			   <![CDATA[
						( 			  SELECT DISTINCT CMPCOD,
											FLTCARIDR,
											FLTNUM,
											CONNUM,
											ULDNUM,
											FLTSEQNUM,
											SEGSERNUM,
											POU,
											ASGPRT,
											DSTCOD,
								MIN(POAFLG) POAFLG,
								MIN(ACPFLG)	ACPFLG,
								MIN(ARRSTA) ARRSTA,
								MIN(OFLFLG) OFLFLG,
								MIN(TRNFLG) TRNFLG,
								MAX(DLVFLG)	DLVFLG,
											CONTYP,
								MIN(INTFLG) INTFLG,
								MIN(PLTENBFLG) PLTENBFLG,
								MAX(CONLSTUPDTIM) CONLSTUPDTIM,
											CONJRNIDR,
											POACOD,
											ACTULDWGT,
								MAX(ASGDATUTC) ASGDATUTC,
											LOCCOD,
								MAX(RMK) RMK,
								MAX(USRCOD) USRCOD,
								MAX(ULDLSTUPDTIM) ULDLSTUPDTIM,
								MAX(LSTUPDUSR) LSTUPDUSR,
											MAX(ONWFLTDAT) ONWFLTDAT,
											MAX(ONWFLTNUM) ONWFLTNUM,
											MAX(RTGPOU) RTGPOU,
											MAX(RTGSERNUM) RTGSERNUM,
											MAX(ONWFLTCARCOD) ONWFLTCARCOD,
											(COUNT(MALSEQNUM) )MALCNT,
											(SUM(
											CASE
											   WHEN MALSTA='DLV'
											   THEN 1
											   ELSE 0
											   END)  )DLVCNT,
											(SUM(DSNWGT))WGT,
											SUM(RCVBAG) RCVBAG,
											SUM(RCVWGT) RCVWGT,
											SUM(ACPBAG) ACPBAG,
											SUM(ACPWGT) ACPWGT,
											COUNT(DISTINCT(MALDST)) DESTCOUNT,
                                            MAX(MALDST) MALDST,
											MIN(REQDLVTIM) REQDLVTIM,
											LEGSERNUM
										  FROM (
											(SELECT DISTINCT FLT.CMPCOD CMPCOD,
											  FLT.FLTCARIDR FLTCARIDR,
											  FLT.FLTNUM FLTNUM,
											  FLT.FLTSEQNUM FLTSEQNUM,
											  LEG.LEGSERNUM LEGSERNUM,
											  ULD.SEGSERNUM SEGSERNUM,											
											  ULD.ULDNUM CONNUM,
											  FLT.POU POU,
											  FLT.POL ASGPRT,
											  COALESCE(CON.DSTCOD,FLT.POU) DSTCOD,
											  CON.POAFLG POAFLG,
											  CON.ACPFLG ACPFLG,
											  CON.ARRSTA ARRSTA,
											  COALESCE(CON.OFLFLG,'N') OFLFLG,
											  COALESCE(CON.TRNFLG,'N')TRNFLG,
											  MAL.DLVSTA DLVFLG,
											  MALMST.MALSTA MALSTA,
											  COALESCE(CON.CONTYP,'B') CONTYP,
											  CON.INTFLG INTFLG,
											  CON.LSTUPDTIM AS CONLSTUPDTIM,
											  CON.CONJRNIDR CONJRNIDR,
											  CON.POACOD POACOD,
											  CON.ACTULDWGT ACTULDWGT,
											  CON.ASGDATUTC ASGDATUTC,
											  CON.USRCOD USRCOD,
											  CON.LSTUPDUSR LSTUPDUSR,
											  ULD.ULDNUM ULDNUM,
											  ULD.LOCCOD LOCCOD,
											  COALESCE(CON.RMK,ULD.RMK) RMK,
											  ULD.FRMCARCOD ULDFRMCARCOD,
											  ULD.LSTUPDTIM AS ULDLSTUPDTIM,
											  MALMST.MALIDR MALIDR,
											  MALMST.DSN DSN,
											  MALMST.ORGEXGOFC ORGEXGOFC,
											  MALMST.DSTEXGOFC DSTEXGOFC,
											  MALMST.MALCLS MALCLS,
											  MALMST.MALSUBCLS MALSUBCLS,
											  MALMST.MALCTG MALCTGCOD,
											  MALMST.YER YER,
											  MALMST.MALSEQNUM MALSEQNUM,
											  MALMST.VOL VOL,
											  MALMST.SELNUM SELNUM,
											  MALMST.DMGFLG DMGFLG,
											  MALMST.CSGDOCNUM CSGDOCNUM,
											  MALMST.POACOD MALPOA,
											  MALMST.MALRMK MALRMK,
											  MALMST.MSTDOCNUM MSTDOCNUM,
											  MALMST.SHPPFX SHPPFX,
											  
											  MAL.WGT DSNWGT,
											  MAL.RCVBAG RCVBAG,
											  MAL.RCVWGT RCVWGT,
											  MAL.ACPBAG ACPBAG,
											  MAL.ACPWGT ACPWGT,
											  TO_CHAR(RTG.ONWFLTDAT,'DD-Mon-YYYY') ONWFLTDAT,
											  RTG.ONWFLTNUM,
											  RTG.POU RTGPOU,
											  RTG.RTGSERNUM,
											  RTG.ONWFLTCARCOD,
											  (
											  CASE
												WHEN MALMST.MALTYP = 'M'
												THEN 'Y'
												ELSE 'N'
											  END) AS PLTENBFLG,
											  MAL.STDBAG DSNSTDBAG,
											  MAL.STDWGT DSNSTDWGT,
											  MALMST.DSTCOD MALDST,
											  DSTEXG.CTYCOD DSTCTYCOD,
											  MALMST.REQDLVTIM REQDLVTIM
											FROM MALFLTSEG FLT
											INNER JOIN MALULDSEG ULD
											ON FLT.FLTCARIDR  =ULD.FLTCARIDR
											AND FLT.FLTNUM    = ULD.FLTNUM
											AND FLT.FLTSEQNUM =ULD.FLTSEQNUM
											AND FLT.SEGSERNUM =ULD.SEGSERNUM
											AND FLT.CMPCOD    = ULD.CMPCOD
											  LEFT OUTER JOIN FLTOPRLEG LEG
											ON FLT.FLTCARIDR  =LEG.FLTCARIDR
											AND FLT.FLTNUM    = LEG.FLTNUM
											AND FLT.FLTSEQNUM =LEG.FLTSEQNUM
											AND FLT.POU       =LEG.LEGDST
											AND FLT.CMPCOD    = LEG.CMPCOD
											LEFT OUTER JOIN MALFLTCON CON
											ON ULD.CMPCOD     =CON.CMPCOD
											AND ULD.FLTCARIDR =CON.FLTCARIDR
											AND ULD.FLTNUM    =CON.FLTNUM
											AND ULD.FLTSEQNUM =CON.FLTSEQNUM
											AND ULD.SEGSERNUM =CON.SEGSERNUM
											AND ULD.ULDNUM    =CON.CONNUM
											LEFT OUTER JOIN MALULDSEGDTL MAL
											ON ULD.CMPCOD     = MAL.CMPCOD
											AND ULD.FLTCARIDR = MAL.FLTCARIDR
											AND ULD.FLTNUM    = MAL.FLTNUM
											AND ULD.FLTSEQNUM = MAL.FLTSEQNUM
											AND ULD.SEGSERNUM = MAL.SEGSERNUM
											AND ULD.ULDNUM    = MAL.ULDNUM

											LEFT OUTER JOIN MALMST MALMST
											ON MAL.MALSEQNUM = MALMST.MALSEQNUM
											AND MAL.CMPCOD   = MALMST.CMPCOD
											LEFT OUTER JOIN MALEXGOFCMST DSTEXG
											ON DSTEXG.CMPCOD     = MALMST.CMPCOD
											AND DSTEXG.EXGOFCCOD = MALMST.DSTEXGOFC
											LEFT OUTER JOIN MALCSGMST CSGMST
											ON CSGMST.CMPCOD     = MALMST.CMPCOD
											AND CSGMST.CSGDOCNUM = MALMST.CSGDOCNUM
											AND CSGMST.POACOD    = MALMST.POACOD
											AND CSGMST.CSGSEQNUM = MALMST.CSGSEQNUM
											LEFT OUTER JOIN MALCSGRTG CSGRTG
											ON CSGRTG.CMPCOD                  = CSGMST.CMPCOD
											AND CSGRTG.CSGDOCNUM              = CSGMST.CSGDOCNUM
											AND CSGRTG.CSGSEQNUM              = CSGMST.CSGSEQNUM
											AND CSGRTG.POACOD                 = CSGMST.POACOD
											LEFT OUTER JOIN MALFLTCONRTG RTG
											ON CON.CMPCOD     = RTG.CMPCOD
											AND CON.CONNUM                    = RTG.CONNUM
											AND CON.ASGPRT    = RTG.ASGPRT
											AND CON.FLTCARIDR = RTG.FLTCARIDR
											AND CON.FLTNUM    = RTG.FLTNUM
											AND CON.FLTSEQNUM = RTG.FLTSEQNUM
											AND CON.LEGSERNUM = RTG.LEGSERNUM
											AND SUBSTR(CSGMST.CSGDOCNUM,0,3) <> 'ACM'
											WHERE FLT.CMPCOD                  =?
											AND FLT.FLTCARIDR                 =?
											AND FLT.FLTNUM                    =?
											AND FLT.FLTSEQNUM                 =?
											AND FLT.POU                       =?



			   ]]>
  </QRY:Source>
 </QRY:Definition>
 <QRY:Definition>
		<QRY:Id>154</QRY:Id>
		<QRY:Source Name="mail.operations.findinboundmailbagdetails" Type="NATIVE">
			<![CDATA[
					(SELECT DISTINCT FLT.CMPCOD CMPCOD,
						  FLT.FLTCARIDR FLTCARIDR,
						  FLT.FLTNUM FLTNUM,
						  FLT.FLTSEQNUM FLTSEQNUM,


						--  COALESCE(CON.LEGSERNUM,INBFLT.LEGSERNUM)LEGSERNUM,
						  --COALESCE(CON.LEGSERNUM,INBFLT.LEGSERNUM)LEGSERNUM,

						  ULD.SEGSERNUM SEGSERNUM,
						  ULD.ULDNUM CONNUM,
						  FLT.POU POU,
					  CON.ASGPRT ASGPRT,
					  CON.POAFLG POAFLG,
					  CON.ACPFLG ACPFLG,
					  CON.ARRSTA ARRSTA,
						  COALESCE(CON.OFLFLG,'N') OFLFLG,
						  COALESCE(CON.TRNFLG,'N') MALTRAFLG,
					  CON.DLVFLG DLVSTA,
						  COALESCE(CON.CONTYP,'B') CONTYP,
						  CON.INTFLG INTFLG,
					  CON.LSTUPDTIM AS CONLSTUPDTIM,
						  CON.CONJRNIDR CONJRNIDR,
						  CON.POACOD POACOD,
						  CON.ACTULDWGT ACTULDWGT,
						  CON.ASGDATUTC ASGDATUTC,
						  CON.USRCOD USRCOD,
						  CON.LSTUPDUSR LSTUPDUSR,
					  (
					  CASE
							WHEN (CSGRTG.FLTNUM IS NOT NULL)
							THEN 'Y'
							ELSE 'N'
						  END ) AS RTGAVL,
					  (
					  CASE
						WHEN CON.CONTYP = 'B'
							THEN 0
							ELSE RTG.RTGSERNUM
						  END) AS RTGSERNUM,
					  (
					  CASE
						WHEN CON.CONTYP = 'B'
						THEN ''
							ELSE TO_CHAR (RTG.ONWFLTDAT, 'DD-MON-YYYY' )
						  END) AS ONWFLTDAT,
					  (
					  CASE
						WHEN CON.CONTYP = 'B'
						THEN ''
							ELSE RTG.ONWFLTNUM
						  END) AS ONWFLTNUM,
					  (
					  CASE
						WHEN CON.CONTYP = 'B'
						THEN ''
							ELSE RTG.ONWFLTCARCOD
						  END) AS ONWFLTCARCOD,
					  (
					  CASE
						WHEN CON.CONTYP = 'B'
							THEN ''
							ELSE RTG.POU
						  END) AS RTGPOU,
					  (
					  CASE
						WHEN CON.CONTYP = 'B'
						THEN 0
							ELSE RTG.ONWFLTCARIDR
						  END) ONWFLTCARIDR,
					  (
					  CASE
						WHEN CON.CONTYP = 'B'
						THEN 0
							ELSE ULD.BAGCNT
						  END) AS ULDBAGCNT,
						  (
						  CASE
							WHEN CON.CONTYP = 'B'
							THEN 0
						ELSE ULD.BAGWGT
					  END) AS ULDBAGWGT,
					  ULD.WHSCOD WHSCOD,
					  MAL.TRFCARCOD,
						  ULD.ULDNUM ULDNUM,
						  ULD.LOCCOD LOCCOD,
						  COALESCE(CON.RMK,ULD.RMK) RMK,
					  ULD.FRMCARCOD ULDFRMCARCOD,
					  ULD.LSTUPDTIM AS ULDLSTUPDTIM,
					  MALMST.MALIDR MALIDR,
					  MALMST.DSN DSN,
					  MALMST.HSN HSN,
					  MALMST.RSN RSN,
					  MALMST.REGIND REGIND,
					  MALMST.WGT WGT,
						  MALMST.DSPWGT,
                          MALMST.DSPWGTUNT,
					  MALMST.ORGEXGOFC ORGEXGOFC,
					  MALMST.DSTEXGOFC DSTEXGOFC,
					  MALMST.MALCLS MALCLS,
					  MALMST.MALSUBCLS MALSUBCLS,
					  MALMST.MALCTG MALCTGCOD,
					  MALMST.YER YER,
					  MALMST.MALSEQNUM MALSEQNUM,
					  MALMST.VOL VOL,
					  MALMST.VOLUNT VOLUNT,
					  MALMST.MALCMPCOD MALCMPCOD,
					  MALMST.SELNUM SELNUM,
					  MALMST.SCNDAT SCNDAT,
					  MALMST.DMGFLG DMGFLG,
					  MALMST.MALSTA MALSTA,
					  MALMST.CSGDOCNUM CSGDOCNUM,
					  MALMST.POACOD MALPOA,
					  MALMST.MALRMK MALRMK,
					  MALMST.MSTDOCNUM MSTDOCNUM,
					  MALMST.SHPPFX SHPPFX,
					  MALMST.ORGCOD ORGCOD,
					  MALMST.DSTCOD DSTCOD,
					  MALMST.ONNTIMDLVFLG ONNTIMDLVFLG,
                      MALMST.SCNWVDFLG SCNWVDFLG,
					  --CSGRTG.FLTNUM CSGFLTNUM,
					  MAL.ACPBAG DSNACPBAG,
					  MAL.ACPWGT DSNACPWGT,
					  (
					  CASE
						WHEN MALMST.MALTYP = 'M'
						THEN 'Y'
						ELSE 'N'
					  END) AS PLTENBFLG,
					 (
					 CASE
					    WHEN EXISTS
                        ( SELECT 1
                          FROM SHRCTYMST CTY1
                          WHERE CTY1.CMPCOD = MALMST.CMPCOD
                          AND CTY1.CTYCOD   =
                            (SELECT CTYCOD
                             FROM MALEXGOFCMST
                             WHERE CMPCOD  = MALMST.CMPCOD
                             AND EXGOFCCOD = MALMST.ORGEXGOFC
                            )
                             AND ( CTY1 .SRVARPCOD IS NULL
                            OR CTY1 .SRVARPCOD    <> FLT.POU )
                        )
                        AND EXISTS
						(SELECT 1
                        FROM SHRCTYMST CTY1
                        WHERE CTY1.CMPCOD = MALMST.CMPCOD
                        AND CTY1.CTYCOD   =
                        (SELECT CTYCOD
                        FROM MALEXGOFCMST
                        WHERE CMPCOD  = MALMST.CMPCOD
                        AND EXGOFCCOD = MALMST.DSTEXGOFC
                        )
                        AND ( CTY1 .SRVARPCOD IS NULL
                        OR CTY1 .SRVARPCOD    <> FLT.POU )
                        )
                        THEN 'Y'
                        ELSE 'N'
                        END) AS TRNFLG,
					  MAL.STDBAG DSNSTDBAG,
						  MAL.STDWGT DSNSTDWGT,
						  MALMST.DSTCOD MALDST,
						  MALMST.REQDLVTIM REQDLVTIM,
						  MALMST.TRPSRVENDTIM TRPSRVENDTIM,
						  MALMST.MALSRVLVL MALSRVLVL
						FROM MALFLTSEG FLT
						INNER JOIN MALULDSEG ULD
						ON FLT.FLTCARIDR  =ULD.FLTCARIDR
						AND FLT.FLTNUM    = ULD.FLTNUM
						AND FLT.FLTSEQNUM =ULD.FLTSEQNUM
						AND FLT.SEGSERNUM =ULD.SEGSERNUM
						AND FLT.CMPCOD    = ULD.CMPCOD
						--LEFT OUTER JOIN MALFLT INBFLT
						--ON FLT.FLTCARIDR  =INBFLT.FLTCARIDR
						--AND FLT.FLTNUM    = INBFLT.FLTNUM
						--AND FLT.FLTSEQNUM =INBFLT.FLTSEQNUM
						--AND FLT.POU       =INBFLT.ARPCOD
					LEFT OUTER JOIN MALULDSEGDTL MAL
					ON ULD.CMPCOD     = MAL.CMPCOD
					AND ULD.FLTCARIDR = MAL.FLTCARIDR
					AND ULD.FLTNUM    = MAL.FLTNUM
					AND ULD.FLTSEQNUM = MAL.FLTSEQNUM
					AND ULD.SEGSERNUM = MAL.SEGSERNUM
					AND ULD.ULDNUM    = MAL.ULDNUM
						LEFT OUTER JOIN MALFLTCON CON
						ON ULD.CMPCOD     =CON.CMPCOD
						AND ULD.FLTCARIDR =CON.FLTCARIDR
						AND ULD.FLTNUM    =CON.FLTNUM
						AND ULD.FLTSEQNUM =CON.FLTSEQNUM
						AND ULD.SEGSERNUM =CON.SEGSERNUM
						AND MAL.CONNUM    =CON.CONNUM
					LEFT OUTER JOIN MALMST MALMST
						ON MAL.MALSEQNUM = MALMST.MALSEQNUM
						AND MAL.CMPCOD   = MALMST.CMPCOD
					LEFT OUTER JOIN MALCSGMST CSGMST
      ON CSGMST.CMPCOD     = MALMST.CMPCOD
      AND CSGMST.CSGDOCNUM = MALMST.CSGDOCNUM
      AND CSGMST.POACOD    = MALMST.POACOD
      AND CSGMST.CSGSEQNUM = MALMST.CSGSEQNUM
      LEFT OUTER JOIN MALCSGRTG CSGRTG
      ON CSGRTG.CMPCOD                  = CSGMST.CMPCOD
      AND CSGRTG.CSGDOCNUM              = CSGMST.CSGDOCNUM
      AND CSGRTG.CSGSEQNUM              = CSGMST.CSGSEQNUM
      AND CSGRTG.POACOD                 = CSGMST.POACOD
						LEFT OUTER JOIN MALFLTCONRTG RTG
						ON CON.CMPCOD                     = RTG.CMPCOD
						AND CON.CONNUM                    = RTG.CONNUM
						AND CON.ASGPRT                    = RTG.ASGPRT
						AND CON.FLTCARIDR                 = RTG.FLTCARIDR
						AND CON.FLTNUM                    = RTG.FLTNUM
						AND CON.FLTSEQNUM                 = RTG.FLTSEQNUM
						AND CON.LEGSERNUM                 = RTG.LEGSERNUM
      AND SUBSTR(CSGMST.CSGDOCNUM,0,3) <> 'ACM'
						WHERE FLT.CMPCOD                  = ?
						AND FLT.FLTCARIDR                 = ?
						AND FLT.FLTNUM                    = ?
						AND FLT.FLTSEQNUM                 = ?
						AND FLT.POU                       = ?
					AND ULD.ULDNUM       =?

				]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>155</QRY:Id>
		<QRY:Source Name="mail.operations.findinbounddsndetails" Type="NATIVE">
			<![CDATA[
					  (SELECT CMPCOD,
						DSN,
						ORGEXGOFC,
						DSTEXGOFC,
						MAX(MALCLS) MALCLS,
						MALSUBCLS,
						MALCTGCOD,
						YER,
						(
						CASE
						  WHEN (MAX(CSGFLTNUM) IS NOT NULL)
						  THEN 'Y'
						  ELSE 'N'
						END ) AS RTGAVL,
						MAX(PLTENBFLG) PLTENBFLG,
						MAX(POACOD) POACOD,
						MAX(SCNPRT) SCNPRT,
						MAX(POU) POU,
						MAX(DOCOWRCOD) DOCOWRCOD,
						MAX(DOCOWRIDR) DOCOWRIDR,
						MAX(SEQNUM) SEQNUM,
						MAX(DUPNUM) DUPNUM,
						MAX(MSTDOCNUM) MSTDOCNUM,
						MAX(ORGCOD) ORGCOD,
						MAX(DSTCOD) DSTCOD,
							  COUNT(MALSEQNUM) DSNCNT,
						SUM(MALWGT) DSNWGT,
						SUM(DSNACPWGT) DSNACPWGT,
							  SUM(DSNACPBAG) DSNACPCNT,
						SUM(DSNRCVWGT) DSNRCVWGT,
							  SUM(DSNRCVBAG) DSNRCVCNT,
						RMK,
						CSGDOCNUM
					  FROM
						(SELECT MALMST.CMPCOD CMPCOD,
						  MALMST.DSN DSN,
						  MALMST.ORGEXGOFC ORGEXGOFC,
						  MALMST.DSTEXGOFC DSTEXGOFC,
						  MALMST.MALCLS MALCLS,
						  MALMST.MALSUBCLS MALSUBCLS,
						  MALMST.MALCTG MALCTGCOD,
						  MALMST.YER YER,
						  MALMST.POACOD POACOD,
						  MALMST.SCNPRT SCNPRT,
						  MALMST.POU POU,
						  MALMST.MALSEQNUM MALSEQNUM,
						  MALMST.WGT MALWGT,
						  MALMST.SHPPFX DOCOWRCOD,
						  MALMST.DOCOWRIDR DOCOWRIDR,
						  MALMST.SEQNUM SEQNUM,
						  MALMST.DUPNUM DUPNUM,
						  MALMST.MSTDOCNUM MSTDOCNUM,
						  MALMST.ORGCOD ORGCOD,
						  MALMST.DSTCOD DSTCOD,
						  MAL.ACPBAG DSNACPBAG,
						  MAL.ACPWGT DSNACPWGT,
						  MAL.RCVBAG DSNRCVBAG,
						  MAL.RCVWGT DSNRCVWGT,
						  MALMST.MALIDR MALIDR,
						  CSGRTG.FLTNUM CSGFLTNUM,
						  MALMST.CSGDOCNUM CSGDOCNUM,
						  (
						  CASE
							WHEN MALMST.MALTYP = 'M'
							THEN 'Y'
							ELSE 'N'
						  END) AS PLTENBFLG,
						  MAL.STDBAG DSNSTDBAG,
						  MAL.STDWGT DSNSTDWGT,
						  CON.RMK RMK
							  FROM MALFLTSEG FLT
						INNER JOIN MALULDSEG ULD
							  ON FLT.FLTCARIDR  =ULD.FLTCARIDR
							  AND FLT.FLTNUM    = ULD.FLTNUM
							  AND FLT.FLTSEQNUM =ULD.FLTSEQNUM
							  AND FLT.SEGSERNUM =ULD.SEGSERNUM
							  AND FLT.CMPCOD    = ULD.CMPCOD
							  LEFT OUTER JOIN MALULDSEGDTL MAL
						ON ULD.CMPCOD     = MAL.CMPCOD
						AND ULD.FLTCARIDR = MAL.FLTCARIDR
						AND ULD.FLTNUM    = MAL.FLTNUM
						AND ULD.FLTSEQNUM = MAL.FLTSEQNUM
						AND ULD.SEGSERNUM = MAL.SEGSERNUM
						AND ULD.ULDNUM    = MAL.ULDNUM
							  LEFT OUTER JOIN MALFLTCON CON
							  ON ULD.CMPCOD     =CON.CMPCOD
							  AND ULD.FLTCARIDR =CON.FLTCARIDR
							  AND ULD.FLTNUM    =CON.FLTNUM
							  AND ULD.FLTSEQNUM =CON.FLTSEQNUM
							  AND ULD.SEGSERNUM =CON.SEGSERNUM
							  AND MAL.CONNUM    =CON.CONNUM
							  LEFT OUTER JOIN MALMST MALMST
							  ON MAL.MALSEQNUM = MALMST.MALSEQNUM
							  AND MAL.CMPCOD   = MALMST.CMPCOD
						LEFT OUTER JOIN MALCSGMST CSGMST
						ON CSGMST.CMPCOD     = MALMST.CMPCOD
						AND CSGMST.CSGDOCNUM = MALMST.CSGDOCNUM
						AND CSGMST.POACOD    = MALMST.POACOD
						AND CSGMST.CSGSEQNUM = MALMST.CSGSEQNUM
						LEFT OUTER JOIN MALCSGRTG CSGRTG
						ON CSGRTG.CMPCOD                  = CSGMST.CMPCOD
						AND CSGRTG.CSGDOCNUM              = CSGMST.CSGDOCNUM
						AND CSGRTG.CSGSEQNUM              = CSGMST.CSGSEQNUM
						AND CSGRTG.POACOD                 = CSGMST.POACOD
						LEFT OUTER JOIN MALFLTCONRTG RTG
						ON CON.CMPCOD     = RTG.CMPCOD
							  AND CON.CONNUM                    = RTG.CONNUM
						AND CON.ASGPRT    = RTG.ASGPRT
						AND CON.FLTCARIDR = RTG.FLTCARIDR
						AND CON.FLTNUM    = RTG.FLTNUM
						AND CON.FLTSEQNUM = RTG.FLTSEQNUM
						AND CON.LEGSERNUM = RTG.LEGSERNUM
							  AND SUBSTR(CSGMST.CSGDOCNUM,0,3) <> 'ACM'
							  WHERE FLT.CMPCOD                  = ?
							  AND FLT.FLTCARIDR                 = ?
							  AND FLT.FLTNUM                    = ?
							  AND FLT.FLTSEQNUM                 = ?
							  AND FLT.POU                       = ?
											  AND ULD.ULDNUM    = ?




					    ]]>
				</QRY:Source>
	</QRY:Definition>
   <QRY:Definition>
	<QRY:Id>235</QRY:Id>
		<QRY:Source Name="mail.operations.findoffloaddsn" Type="NATIVE">
			<![CDATA[
				SELECT MAX(MST.CMPCOD) CMPCOD ,
				MAX(MST.CONNUM) CONNUM,
				MAX(MST.ASGPRT)ASGPRT,
				MAX(MST.FLTCARIDR)FLTCARIDR ,
				MAX(MST.FLTNUM) FLTNUM,
				MAX(MST.FLTSEQNUM)FLTSEQNUM ,
				MAX(MST.LEGSERNUM)LEGSERNUM,
				MAX(MST.ACPFLG)ACPFLG,
				MAX(MST.SEGSERNUM)SEGSERNUM,
				MAX(MST.CONTYP)CONTYP,
				MAX(MST.POU)POU,
				MAX(MST.DSTCOD ) DSTCOD,
				MAX(MST.FLTCARCOD)FLTCARCOD,
				MAX(MST.LSTUPDTIM)LSTUPDTIM,
				MAX(MAL.MALSTA)MALSTA,
				SUM(MAL.WGT)WGT,
				MAL.DSN,
				MAX(MAL.CSGDOCNUM) CSGDOCNUM,
				MAX(MAL.MALCLS)MALCLS,
				MAX(MAL.MALSUBCLS)MALSUBCLS,
				MAX(MAL.MALCTG)MALCTG,
				MAX(SEGDTL.ULDNUM)ULDNUM,
				MAX(MAL.ORGEXGOFC)ORGEXGOFC,
				MAX(MAL.DSTEXGOFC)DSTEXGOFC,
				MAX(MAL.YER)YER,
				MAX(MAL.MALIDR)MALIDR,
				MAX(MAL.POACOD)POACOD,
				MAX(MAL.CSGSEQNUM)CSGSEQNUM,
				MAX(MAL.OPRSTA)OPRSTA,
				MAX(MST.POAFLG)POAFLG,
				MAX(ASG.FLTDAT)FLTDAT,
                SUM(COALESCE(SEGDTL.ACPBAG,0)) BAGS
					FROM MALFLT ASG,
					MALFLTSEG FLTSEG,
					MALULDSEGDTL SEGDTL,
					MALFLTCON MST,
					MALMST MAL
						WHERE ASG.CMPCOD     = FLTSEG.CMPCOD
						AND ASG.FLTCARIDR    =FLTSEG.FLTCARIDR
						AND ASG.FLTNUM       =FLTSEG.FLTNUM
						AND ASG.FLTSEQNUM    =FLTSEG.FLTSEQNUM
						AND ASG.ARPCOD       =FLTSEG.POL
						AND FLTSEG.CMPCOD    =SEGDTL.CMPCOD
						AND FLTSEG.FLTCARIDR =SEGDTL.FLTCARIDR
						AND FLTSEG.FLTNUM    =SEGDTL.FLTNUM
						AND FLTSEG.FLTSEQNUM =SEGDTL.FLTSEQNUM
						AND FLTSEG.SEGSERNUM =SEGDTL.SEGSERNUM
						AND MST.CMPCOD       = SEGDTL.CMPCOD
						AND MST.FLTCARIDR    = SEGDTL.FLTCARIDR
						AND MST.FLTNUM       = SEGDTL.FLTNUM
						AND MST.FLTSEQNUM    = SEGDTL.FLTSEQNUM
						AND MST.SEGSERNUM    = SEGDTL.SEGSERNUM
						AND SEGDTL.CONNUM    =MST.CONNUM
						AND SEGDTL.CMPCOD    =MAL.CMPCOD
						AND SEGDTL.MALSEQNUM = MAL.MALSEQNUM
						AND
					    ]]>
				</QRY:Source>
	</QRY:Definition>
<QRY:Definition>
		<QRY:Id>236</QRY:Id>
		<QRY:Source Name="mail.operations.findcarditdsndetails" Type="NATIVE">
			<![CDATA[
					SELECT FLTNUM,
        FLTDAT,
        CARCOD,
        ORGEXGOFF,
        DSTEXGOFF,
        DSPYER,
        DSPSRLNUM,
        MALCTGCOD,
        COUNT(MALSEQNUM) MALCNT,
        MALSUBCLS,
        SUM(WGT) RCPWGT,
        CMPCOD,
        SHPPFX,
        MSTDOCNUM,
        CSGDOCNUM,
        CSGDAT,
        POACOD,
        CONNUM,
        MAX(ACPSTA) ACPSTA,
        REQDLVTIM
		FROM(
		SELECT TRT.FLTNUM,
							TRT.FLTDAT FLTDAT,
							TRT.FLTCARCOD CARCOD,
							MALMST.ORGEXGOFC ORGEXGOFF,
							MALMST.DSTEXGOFC DSTEXGOFF,
							MALMST.YER DSPYER,
							MALMST.DSN DSPSRLNUM,
							MALMST.MALCTG MALCTGCOD,
        MALMST.MALSEQNUM,
                            MALMST.MALSUBCLS MALSUBCLS,
        MALMST.WGT,
							MALMST.CMPCOD,
							MALMST.SHPPFX,
							MALMST.MSTDOCNUM,
							CSGMST.CSGDOCNUM,
							CSGMST.CSGDAT CSGDAT,
							MALMST.POACOD POACOD,
							CSGDTL.ULDNUM CONNUM,
        
        (CASE
							  WHEN MALMST.MALSTA='NEW'
							  THEN 'N'
							  WHEN MALMST.MALSTA='BKD'
							  THEN 'N'
							  WHEN MALMST.MALSTA='CAN'
							  THEN 'N'
							  WHEN MALMST.MALSTA='OFL'
							  THEN 'N'
							  ELSE 'Y'
							END) ACPSTA,
							MALMST.REQDLVTIM 
                          FROM MALCSGMST CSGMST
						  INNER JOIN MALCSGDTL CSGDTL
						  ON CSGMST.CMPCOD     = CSGDTL.CMPCOD
						  AND CSGMST.CSGDOCNUM = CSGDTL.CSGDOCNUM
						  AND CSGMST.CSGSEQNUM = CSGDTL.CSGSEQNUM
						  AND CSGMST.POACOD    = CSGDTL.POACOD
						  INNER JOIN MALMST MALMST
						  ON MALMST.CMPCOD     = CSGDTL.CMPCOD
						  AND MALMST.MALSEQNUM = CSGDTL.MALSEQNUM
						  AND MALMST.CSGSEQNUM = CSGDTL.CSGSEQNUM
						  AND MALMST.CSGDOCNUM = CSGDTL.CSGDOCNUM
						  AND MALMST.POACOD    = CSGDTL.POACOD
						  LEFT OUTER JOIN MALCSGRTG TRT
						  ON CSGMST.CMPCOD         = TRT.CMPCOD
						  AND CSGMST.CSGDOCNUM     = TRT.CSGDOCNUM
						  AND CSGMST.CSGSEQNUM     =TRT.CSGSEQNUM
						  AND CSGMST.POACOD        =TRT.POACOD
					    ]]>
				</QRY:Source>
	</QRY:Definition>
	
<QRY:Definition>
<QRY:Id>165</QRY:Id>
<QRY:Source Name="mail.operations.findRdtMasterDetails" Type="NATIVE">
	<![CDATA[
select * from MALRDTREQDLVTIM where CMPCOD=?
]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>166</QRY:Id>
<QRY:Source Name="mail.operations.findIncentiveConfigurationDetails" Type="NATIVE">
	<![CDATA[
	SELECT CFGMST.CMPCOD,
	CFGMST.INSSERNUM,
	POACOD,
	INCFLG,
	SRVRSPLANFLG,
	INCPER,
	VLDFRMDAT,
	VLDTOODAT,
    CFGDTL.SEQNUM,
	CFGDTL.PARTYP,
	CFGDTL.PARCOD,
	CFGDTL.PARVAL,
	CFGDTL.EXCFLG,
	PAREXP,
	BSSEXP ,
	DISPAREXP
    FROM MALMRAINCCFGMST CFGMST,MALMRAINCCFGDTL CFGDTL
    WHERE CFGMST.CMPCOD=CFGDTL.CMPCOD
	AND CFGMST.INSSERNUM=CFGDTL.INSSERNUM
	AND CFGMST.CMPCOD=?
	AND CFGMST.POACOD=?
	]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>235</QRY:Id>
	<QRY:Source Name="mail.operations.findOutboundRunnerFlights" Type="NATIVE">
		<![CDATA[
			SELECT EXPFLT.CMPCOD,
EXPFLT.FLTCARIDR,
EXPFLT.FLTCARCOD,
EXPFLT.FLTNUM,
EXPFLT.FLTSEQNUM,
EXPFLT.LEGSERNUM,
EXPFLT.ARPCOD,
MALCON.CONNUM ULDNUM,
MALCON.POU,
 CASE
						WHEN MALCON.CONTYP='B'
						THEN 'Y'
						ELSE 'N'
					  END BARROWFLG,
 NULL BDPCMPSTA,
 COALESCE(LEG.ATD, COALESCE(LEG.ETD, LEG.STD)) FLTDAT,
 CASE WHEN LEG.ATD IS NOT NULL THEN 'A' WHEN LEG.ETD IS NOT NULL THEN 'E' ELSE 'S' END FLTDATIND,
LEG.DEPGTE GATE,
LEG.ACRTYP,
MALCON.CNTIDR CONIDR,
MALCON.ACTULDWGT ACTULDWGT,
NULL ULDPTY,
NULL LOCCOD,
(SELECT SUM(ACPBAG)
    FROM MALULDSEGDTL SEGDTL
	WHERE SEGDTL.CMPCOD  = MALCON.CMPCOD
	AND SEGDTL.FLTCARIDR = MALCON.FLTCARIDR
	AND SEGDTL.FLTNUM    =MALCON.FLTNUM
	AND SEGDTL.FLTSEQNUM    =MALCON.FLTSEQNUM
	AND SEGDTL.CONNUM    = MALCON.CONNUM
	GROUP BY MALCON.CONNUM
    ) ACPBAG,
	LEG.LEGORG,
	LEG.LEGDST
FROM MALFLT EXPFLT
INNER JOIN FLTOPRLEG LEG
ON EXPFLT.FLTNUM = LEG.FLTNUM
AND EXPFLT.FLTCARIDR = LEG.FLTCARIDR
AND EXPFLT.FLTSEQNUM = LEG.FLTSEQNUM
AND EXPFLT.LEGSERNUM = LEG.LEGSERNUM
AND EXPFLT.ARPCOD = LEG.LEGORG
AND EXPFLT.CMPCOD = LEG.CMPCOD
INNER JOIN FLTOPRSEG SEG
ON LEG.FLTNUM = SEG.FLTNUM
AND LEG.FLTCARIDR = SEG.FLTCARIDR
AND LEG.FLTSEQNUM = SEG.FLTSEQNUM
AND LEG.LEGORG = SEG.SEGORG
AND LEG.CMPCOD = SEG.CMPCOD
INNER JOIN MALFLTCON MALCON
ON SEG.FLTCARIDR = MALCON.FLTCARIDR
AND SEG.FLTNUM = MALCON.FLTNUM
AND SEG.FLTSEQNUM = MALCON.FLTSEQNUM
AND SEG.CMPCOD = MALCON.CMPCOD
AND SEG.SEGSERNUM = MALCON.SEGSERNUM
WHERE EXPFLT.CMPCOD = ?
AND EXPFLT.ARPCOD = ?
AND EXPFLT.EXPCLSFLG <> 'C'
AND PKG_FRMWRK.FUN_STRING_CHECK('O', COALESCE(EXPFLT.GTECLRSTA, 'N'), ',') <= 0
AND LEG.ATD IS NULL
 AND NOT EXISTS(
               SELECT 1 FROM WHSRUNSTR RUNSTR,
               WHSRUNSTRULD STRULD
               WHERE RUNSTR.CMPCOD= STRULD.CMPCOD
               AND RUNSTR.ARPCOD=STRULD.ARPCOD
               AND RUNSTR.STRIDR=STRULD.STRIDR
               AND STRULD.CMPCOD = MALCON.CMPCOD
               AND STRULD.ULDNUM = MALCON.CONNUM
               AND RUNSTR.CMPCOD = MALCON.CMPCOD
               AND RUNSTR.FLTCARIDR = MALCON.FLTCARIDR
               AND RUNSTR.FLTSEQNUM = MALCON.FLTSEQNUM
               AND RUNSTR.FLTNUM = MALCON.FLTNUM
            )
	]]>
	</QRY:Source>
</QRY:Definition>
<QRY:Definition>
	<QRY:Id>236</QRY:Id>
	<QRY:Source Name="mail.operations.findInboundRunnerFlights" Type="NATIVE">
		<![CDATA[
					SELECT
						LEG.CMPCOD,
						LEG.FLTCARIDR,
						MALCON.FLTCARCOD,
						LEG.FLTNUM,
						LEG.FLTSEQNUM,
						LEG.LEGSERNUM,
						LEG.LEGDST ARPCOD,
			MALCON.CONNUM ULDNUM,
      MALCON.POU,
	  MALCON.ACTULDWGT ACTULDWGT,
 CASE
							WHEN MALCON.CONTYP = 'B' THEN 'Y'
						ELSE 'N'
					  END BARROWFLG,
			NULL BDPCMPSTA,
			COALESCE(LEG.ATA, COALESCE(LEG.ETA, LEG.STA)) FLTDAT,
			CASE WHEN LEG.ATA IS NOT NULL THEN 'A' WHEN LEG.ETA IS NOT NULL THEN 'E' ELSE 'S' END FLTDATIND,
      LEG.ARVGTE GATE,
			LEG.ACRTYP,
			case when MALCON.CONTYP='B'
			then Pkg_Frmwrk.FUN_REM_DUP((select %1$s 
				 from oprdwsblk dwsblk
				 where dwsblk.cmpcod=leg.cmpcod
				 and dwsblk.fltnum=leg.fltnum
				 and dwsblk.fltcaridr=leg.fltcaridr
				 and dwsblk.fltseqnum=leg.fltseqnum
				 and dwsblk.pou=leg.legdst
				 and dwsblk.conidr in(select fldval from shronetim where fldtyp='mail.operations.contentid')))
			else MALCON.CNTIDR end CONIDR,
			NULL ULDPTY,
						(
							SELECT
								SUM(ACPBAG)
							  FROM
								MALULDSEGDTL SEGDTL
							 WHERE
								SEGDTL.CMPCOD      = MALCON.CMPCOD
				AND SEGDTL.FLTCARIDR = MALCON.FLTCARIDR
				AND SEGDTL.FLTNUM    =MALCON.FLTNUM
				AND SEGDTL.FLTSEQNUM    =MALCON.FLTSEQNUM
				AND SEGDTL.CONNUM    = MALCON.CONNUM
							 GROUP BY
								MALCON.CONNUM
				) ACPBAG,
				(SELECT SUM(RCVWGT)
				FROM MALULDSEGDTL SEGDTL
				WHERE SEGDTL.CMPCOD  = MALCON.CMPCOD
				AND SEGDTL.FLTCARIDR = MALCON.FLTCARIDR
				AND SEGDTL.FLTNUM    =MALCON.FLTNUM
				AND SEGDTL.FLTSEQNUM =MALCON.FLTSEQNUM
				AND SEGDTL.CONNUM    = MALCON.CONNUM
				GROUP BY MALCON.CONNUM
				) MFGWGT,
				(select sum(UNTCNT) from WHSRUNSTR RUNSTR where
				  RUNSTR.FLTCARIDR = LEG.FLTCARIDR
				  AND RUNSTR.FLTNUM = LEG.FLTNUM
				  AND RUNSTR.FLTSEQNUM = LEG.FLTSEQNUM
				  AND RUNSTR.LEGSERNUM = LEG.LEGSERNUM
				  AND RUNSTR.ARPCOD = LEG.LEGDST
				  AND RUNSTR.CMPCOD = LEG.CMPCOD) UNTCNT,
				  IMPFLT.GTECLRSTA,
				  LEG.LEGORG,
					LEG.LEGDST
					  FROM
						MALFLTCON MALCON
						 INNER JOIN FLTOPRSEG SEG ON MALCON.FLTNUM      = SEG.FLTNUM
						   AND MALCON.FLTCARIDR   = SEG.FLTCARIDR
						   AND MALCON.FLTSEQNUM   = SEG.FLTSEQNUM
						   AND MALCON.SEGSERNUM   = SEG.SEGSERNUM
						   AND MALCON.CMPCOD      = SEG.CMPCOD
						 INNER JOIN FLTOPRLEG LEG ON SEG.FLTNUM      = LEG.FLTNUM
						   AND SEG.FLTCARIDR   = LEG.FLTCARIDR
						   AND SEG.FLTSEQNUM   = LEG.FLTSEQNUM
						   AND SEG.SEGDST      = LEG.LEGDST
						   AND SEG.CMPCOD      = LEG.CMPCOD
						  LEFT OUTER JOIN MALFLT IMPFLT ON LEG.FLTNUM      = IMPFLT.FLTNUM
						   AND LEG.FLTCARIDR   = IMPFLT.FLTCARIDR
						   AND LEG.FLTSEQNUM   = IMPFLT.FLTSEQNUM
						   AND LEG.LEGSERNUM   = IMPFLT.LEGSERNUM
						   AND LEG.LEGDST      = IMPFLT.ARPCOD
						   AND LEG.CMPCOD      = IMPFLT.CMPCOD
					 WHERE
						LEG.CMPCOD   = ?
						   AND LEG.LEGDST   = ?
						   AND COALESCE(IMPFLT.IMPCLSFLG, 'N') <> 'C'
						   AND COALESCE(IMPFLT.GTECLRSTA, 'N') <> 'Y'
			AND NOT EXISTS(
							SELECT
								1
							  FROM
								WHSRUNSTR RUNSTR,
               WHSRUNSTRULD STRULD,
			   MALULDSEGDTL SEGDTL
							 WHERE
								RUNSTR.CMPCOD      = STRULD.CMPCOD
               AND RUNSTR.ARPCOD=STRULD.ARPCOD
               AND RUNSTR.STRIDR=STRULD.STRIDR
               AND STRULD.CMPCOD = MALCON.CMPCOD

               AND RUNSTR.CMPCOD = MALCON.CMPCOD
               AND RUNSTR.FLTCARIDR = MALCON.FLTCARIDR
               AND RUNSTR.FLTSEQNUM = MALCON.FLTSEQNUM
               AND RUNSTR.FLTNUM = MALCON.FLTNUM
			   AND SEGDTL.CMPCOD = MALCON.CMPCOD
			   AND SEGDTL.FLTCARIDR = MALCON.FLTCARIDR
			   AND SEGDTL.FLTSEQNUM = MALCON.FLTSEQNUM
			   AND SEGDTL.FLTNUM = MALCON.FLTNUM
			   AND SEGDTL.CONNUM = MALCON.CONNUM
			   AND STRULD.ULDNUM = SEGDTL.ULDNUM
			   AND RUNSTR.CMPCOD = LEG.CMPCOD
			   AND RUNSTR.FLTCARIDR = LEG.FLTCARIDR
			   AND RUNSTR.FLTSEQNUM = LEG.FLTSEQNUM
			   AND RUNSTR.FLTNUM = LEG.FLTNUM
			   AND RUNSTR.LEGSERNUM = LEG.LEGSERNUM
			   AND RUNSTR.RUNTYP = 'I'
			   AND RUNSTR.STRCONTYP = 'M'
			   AND RUNSTR.ARPCOD = ?
			   
            )
			AND( (SELECT CEIL(SUM (ULDDTL.ACPWGT)/
				  (SELECT parval
				  FROM shrsyspar
				  WHERE parcod='warehouse.defaults.maximumcartweight'
				  )%2$s ) ACPWGT
				FROM MALULDSEG ULD
				INNER JOIN MALULDSEGDTL ULDDTL
				ON ULD.CMPCOD     = ULDDTL.CMPCOD
				AND ULD.FLTCARIDR = ULDDTL.FLTCARIDR
				AND ULD.FLTNUM    = ULDDTL.FLTNUM
				AND ULD.FLTSEQNUM = ULDDTL.FLTSEQNUM
				AND ULD.SEGSERNUM = ULDDTL.SEGSERNUM
				AND ULD.ULDNUM    = ULDDTL.ULDNUM
				WHERE ULD.CMPCOD  = MALCON.CMPCOD
				AND ULD.ULDNUM    = 'BULK'
				  ||'-'
				  ||LEG.LEGDST
				AND ULD.FLTCARIDR = MALCON.FLTCARIDR
				AND ULD.FLTNUM    = MALCON.FLTNUM
				AND ULD.FLTSEQNUM = MALCON.FLTSEQNUM
				AND ULD.SEGSERNUM = MALCON.SEGSERNUM
				GROUP BY ULD.ULDNUM,
				  ULD.LOCCOD) 
			  <>
			(SELECT COUNT(1)
				FROM WHSRUNSTR RUNSTR,
				  WHSRUNSTRULD STRULD
				WHERE RUNSTR.CMPCOD  = STRULD.CMPCOD
				AND RUNSTR.ARPCOD    =STRULD.ARPCOD
				AND RUNSTR.STRIDR    =STRULD.STRIDR
				AND RUNSTR.CMPCOD    = LEG.CMPCOD
				AND RUNSTR.FLTCARIDR = LEG.FLTCARIDR
				AND RUNSTR.FLTSEQNUM = LEG.FLTSEQNUM
				AND RUNSTR.FLTNUM    = LEG.FLTNUM
				AND RUNSTR.LEGSERNUM = LEG.LEGSERNUM
				AND RUNSTR.RUNTYP    = 'I'
				AND RUNSTR.STRCONTYP = 'M'
				AND RUNSTR.ARPCOD    = ?
				AND (STRULD.BARROWFLG='Y'
				OR STRULD.ULDNUM LIKE '%3$s')
			)
			OR (MALCON.CONTYP <> 'B') )
	]]>
	</QRY:Source>
</QRY:Definition>
<QRY:Definition>
	<QRY:Id>237</QRY:Id>
	<QRY:Source Name="mail.operations.findRefusedRunnerFlights" Type="NATIVE">
		<![CDATA[
			WITH REFFLT AS (
                        SELECT
                            seg.segsernum, 
                            expflt.cmpcod,
                            expflt.fltcaridr,
                            expflt.fltcarcod,
                            expflt.fltnum,
                            expflt.fltseqnum,
                            expflt.legsernum,
                            expflt.arpcod,
                            NULL bdpcmpsta,
 CASE
						WHEN MALCON.CONTYP='B'
						THEN 'Y'
						ELSE 'N'
					  END BARROWFLG,
 NULL BDPCMPSTA,
 COALESCE(LEG.ATD, COALESCE(LEG.ETD, LEG.STD)) FLTDAT,
 CASE WHEN LEG.ATD IS NOT NULL THEN 'A' WHEN LEG.ETD IS NOT NULL THEN 'E' ELSE 'S' END FLTDATIND,
LEG.DEPGTE GATE,
LEG.ACRTYP,
MALCON.CNTIDR CONIDR,
NULL ULDPTY,
NULL LOCCOD,
(SELECT SUM(ACPBAG)
    FROM MALULDSEGDTL SEGDTL
	WHERE SEGDTL.CMPCOD  = MALCON.CMPCOD
	AND SEGDTL.FLTCARIDR = MALCON.FLTCARIDR
	AND SEGDTL.FLTNUM    =MALCON.FLTNUM
	AND SEGDTL.FLTSEQNUM    =MALCON.FLTSEQNUM
	AND SEGDTL.CONNUM    = MALCON.CONNUM
	GROUP BY MALCON.CONNUM
    ) ACPBAG,
	LEG.LEGORG,
	LEG.LEGDST
FROM MALFLT EXPFLT
INNER JOIN FLTOPRLEG LEG
ON EXPFLT.FLTNUM = LEG.FLTNUM
AND EXPFLT.FLTCARIDR = LEG.FLTCARIDR
AND EXPFLT.FLTSEQNUM = LEG.FLTSEQNUM
AND EXPFLT.LEGSERNUM = LEG.LEGSERNUM
AND EXPFLT.ARPCOD = LEG.LEGORG
AND EXPFLT.CMPCOD = LEG.CMPCOD
INNER JOIN FLTOPRSEG SEG
ON LEG.FLTNUM = SEG.FLTNUM
AND LEG.FLTCARIDR = SEG.FLTCARIDR
AND LEG.FLTSEQNUM = SEG.FLTSEQNUM
AND LEG.LEGORG = SEG.SEGORG
AND LEG.CMPCOD = SEG.CMPCOD
			INNER JOIN MALOFLDTL OFLDTL
ON SEG.FLTCARIDR  = OFLDTL.FLTCARIDR
AND SEG.FLTNUM    = OFLDTL.FLTNUM
AND SEG.FLTSEQNUM = OFLDTL.FLTSEQNUM
AND SEG.CMPCOD    = OFLDTL.CMPCOD
AND SEG.SEGSERNUM = OFLDTL.SEGSERNUM
INNER JOIN MALFLTCON MALCON
ON OFLDTL.FLTCARIDR = MALCON.FLTCARIDR
AND OFLDTL.CMPCOD   = MALCON.CMPCOD
AND OFLDTL.CONNUM   = MALCON.CONNUM
WHERE OFLDTL.OFLTYP ='F'
AND MALCON.FLTNUM   ='-1'
AND MALCON.FLTSEQNUM=-1
AND PKG_FRMWRK.FUN_STRING_CHECK('R', COALESCE(EXPFLT.GTECLRSTA, 'N'), ',') <= 0
AND EXPFLT.CMPCOD = ?
			AND EXPFLT.ARPCOD = ?
			AND NOT EXISTS(
               SELECT 1 FROM WHSRUNSTR RUNSTR,
               WHSRUNSTRULD STRULD
               WHERE RUNSTR.CMPCOD= STRULD.CMPCOD
               AND RUNSTR.ARPCOD=STRULD.ARPCOD
               AND RUNSTR.STRIDR=STRULD.STRIDR
               AND STRULD.CMPCOD = OFLDTL.CMPCOD
                 AND STRULD.ULDNUM = OFLDTL.CONNUM
               AND RUNSTR.CMPCOD = OFLDTL.CMPCOD
               AND RUNSTR.FLTCARIDR = OFLDTL.FLTCARIDR
               AND RUNSTR.FLTSEQNUM = OFLDTL.FLTSEQNUM
               AND RUNSTR.FLTNUM = OFLDTL.FLTNUM
            )

	]]>
	</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>238</QRY:Id>
<QRY:Source Name="mail.operations.findcloseoutdate" Type="NATIVE">
	<![CDATA[
	SELECT CDTHNDOVR.CLNDAT
	FROM MALCDTHNDOVR CDTHNDOVR,
	MALCDTRCP CDTRCP
	WHERE CDTHNDOVR.CMPCOD=CDTRCP.CMPCOD
	AND CDTHNDOVR.CDTKEY=CDTRCP.CDTKEY
	AND CDTHNDOVR.CLNDAT IS NOT NULL
	AND CDTRCP.RCPIDR=?
	]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>239</QRY:Id>
<QRY:Source Name="mail.operations.findservicestandard" Type="NATIVE">
	<![CDATA[
	SELECT SRVSTDCFG.SRVSTD
	FROM
	--MALSRVLVLMAP SRVLVL,
  	MALSRVSTDCFG SRVSTDCFG
	--WHERE SRVLVL.CMPCOD = SRVSTD.CMPCOD
	--AND SRVLVL.MALSRVLVL = SRVSTD.SRVLVL
	--AND SRVLVL.POACOD = SRVSTD.GPACOD
	WHERE SRVSTDCFG.CMPCOD = ?
	AND SRVSTDCFG.GPACOD = ?
		AND SRVSTDCFG.ORGCOD = ?
			AND SRVSTDCFG.DSTCOD = ?
				AND SRVSTDCFG.SRVLVL = ?
	]]>
</QRY:Source>
</QRY:Definition>


<QRY:Definition>
	<QRY:Id>240</QRY:Id>
	<QRY:Source Name="mail.operations.findMailbagsWithConsignmentForTruckFlight" Type="NATIVE">
		<![CDATA[
			SELECT DISTINCT
              MALMST.MALIDR MALIDR,
              TRT.FLTNUM,
			  TRT.FLTSEQNUM,
              TRT.FLTDAT DEPTIM,
              TRT.FLTCARCOD CARCOD,
              MALMST.ORGEXGOFC ORGEXGOFF,
              MALMST.DSTEXGOFC DSTEXGOFF,
              MALMST.YER DSPYER,
              MALMST.DSN DSPSRLNUM,
              MALMST.RSN RCPSRLNUM,
              MALMST.MALCTG MALCTGCOD,
              MALMST.MALSUBCLS MALSUBCOD,
              MALMST.REGIND RCPRGDINS ,
              MALMST.HSN HSTRCPNUM,
              MALMST.WGT RCPWGT,
              MALMST.CMPCOD,
              MALMST.SHPPFX,
              MALMST.MSTDOCNUM,
			  MALMST.POU,
              MALMST.VOL ,
              CSGMST.CSGDOCNUM,
              CSGMST.CSGDAT CSGCMPDAT,
              CSGMST.CSGDAT CDTRCVDAT,
              MALMST.POACOD AS SDRIDR,
              CSGDTL.ULDNUM CONNUM,
              (
                SELECT
                  'Y'
                FROM
                  DUAL
                WHERE
                  EXISTS
                  (
                    SELECT
                      1
                    FROM
                      MALMST MALMST
                    WHERE
                      MALMST.CMPCOD      = CSGDTL.CMPCOD
                    AND MALMST.MALSEQNUM =CSGDTL.MALSEQNUM
                    AND
                      (
                        MALMST.MALSTA   !='NEW'
                      AND MALMST.MALSTA !='BKD'
                      AND MALMST.MALSTA !='CAN'
                      )
                  )
              )
              ACP ,
              MALMST.DUPNUM,
              MALMST.SEQNUM,
              MALMST.DOCOWRIDR,
			  MALMST.REQDLVTIM
            FROM
              MALCSGDTL CSGDTL
            INNER JOIN MALMST MALMST
            ON
              MALMST.CMPCOD      = CSGDTL.CMPCOD
            AND MALMST.MALSEQNUM = CSGDTL.MALSEQNUM
            AND MALMST.CSGSEQNUM = CSGDTL.CSGSEQNUM
            AND MALMST.CSGDOCNUM = CSGDTL.CSGDOCNUM
            AND MALMST.POACOD    = CSGDTL.POACOD
            INNER JOIN MALCSGMST CSGMST
            ON
              CSGMST.CMPCOD      = CSGDTL.CMPCOD
            AND CSGMST.CSGDOCNUM = CSGDTL.CSGDOCNUM
            AND CSGMST.CSGSEQNUM = CSGDTL.CSGSEQNUM
            AND CSGMST.POACOD    = CSGDTL.POACOD
            LEFT OUTER JOIN MALCSGRTG TRT
            ON
              CSGMST.CMPCOD      = TRT.CMPCOD
            AND CSGMST.CSGDOCNUM = TRT.CSGDOCNUM
            AND CSGMST.CSGSEQNUM =TRT.CSGSEQNUM
            AND CSGMST.POACOD    =TRT.POACOD

            INNER JOIN  FLTOPRMST FLTMST
            ON TRT.CMPCOD = FLTMST.CMPCOD
            AND TRT.FLTCARIDR = FLTMST.FLTCARIDR
            AND TRT.FLTNUM = FLTMST.FLTNUM
            AND TRT.FLTSEQNUM = FLTMST.FLTSEQNUM
            AND FLTMST.FLTTYP='T'
            WHERE
              CSGMST.CMPCOD       = ?
            AND TRT.FLTCARCOD     = ?
            AND TRT.FLTNUM        = ?
            AND TRUNC(TRT.FLTDAT) = ?
            AND TRT.POL           = ?

	]]>
	</QRY:Source>
</QRY:Definition>

<QRY:Definition>
	<QRY:Id>241</QRY:Id>
	<QRY:Source Name="mail.operations.findAllMailbagsForTruckFlight" Type="NATIVE">
		<![CDATA[
			SELECT
              MST.CMPCOD,
              MST.MALIDR,
              MST.ORGEXGOFC ORGEXGOFF,
              MST.DSTEXGOFC DSTEXGOFF,
              MST.YER DSPYER,
              MST.DSN DSPSRLNUM,
			  MST.RSN RCPSRLNUM,
			  MST.REGIND RCPRGDINS ,
              MST.HSN HSTRCPNUM,
              MST.MALCLS,
              MST.MALCTG MALCTGCOD,
              MST.MALSUBCLS MALSUBCOD,
              MST.SCNPRT,
              MST.SCNDAT,
              MST.CONNUM CONNUM,
              MST.SCNUSR,
              MST.MALSTA,
              MST.OPRSTA,
              MST.CONTYP,
              MST.POU,
              MST.WGT RCPWGT,
              MST.CSGDOCNUM,
              MST.CSGSEQNUM,
              MST.POACOD,
              MST.DMGFLG,
              MST.LSTUPDTIM,
              MST.REQDLVTIM,
              MST.MSTDOCNUM,
              MST.SHPPFX ,
              ROW_NUMBER() OVER(ORDER BY 1) AS RNK ,
              MST.FLTCARIDR,
              MST.FLTNUM,
              MST.FLTSEQNUM,
              MST.SEGSERNUM,
			  MST.VOL,
              HIS.FLTCARCOD,
              HIS.FLTDAT DEPTIM,
              (
                SELECT
                  POAFLG
                FROM
                  MALFLTCON CONMST
                WHERE
                  MST.FLTCARIDR   = CONMST.FLTCARIDR
                AND MST.FLTNUM    = CONMST.FLTNUM
                AND MST.FLTSEQNUM = CONMST.FLTSEQNUM
                AND MST.CONNUM    = CONMST.CONNUM
                AND MST.CMPCOD    = CONMST.CMPCOD
                AND ROWNUM        = 1
              ) AS POAFLG,
              (
                SELECT
                  LEGSERNUM
                FROM
                  MALFLTCON CONMST
                WHERE
                  MST.FLTCARIDR   = CONMST.FLTCARIDR
                AND MST.FLTNUM    = CONMST.FLTNUM
                AND MST.FLTSEQNUM = CONMST.FLTSEQNUM
                AND MST.CONNUM    = CONMST.CONNUM
                AND MST.SCNPRT    = CONMST.ASGPRT
                AND MST.CMPCOD    = CONMST.CMPCOD
              ) AS LEGSERNUM,
              (
                SELECT
                  'Y'
                FROM
                  MALHIS
                WHERE
                  MALSEQNUM = MST.MALSEQNUM
                AND CMPCOD  =MST.CMPCOD
                AND SCNPRT  =MST.SCNPRT
                AND MALSTA  ='ARR'
              ) AS ARRSTA,
              (
                SELECT DISTINCT
                  'Y'
                FROM
                  MALHIS
                WHERE
                  MALSEQNUM = MST.MALSEQNUM
                AND CMPCOD  =MST.CMPCOD
                AND SCNPRT  =MST.SCNPRT
                AND MALSTA  ='TRA'
              ) AS TRAFLG
            FROM
              MALMST MST
            INNER JOIN MALHIS HIS
            ON
              MST.CMPCOD      = HIS.CMPCOD
            AND MST.MALSEQNUM = HIS.MALSEQNUM
            AND MST.MALSTA   <> 'NEW'
            AND HIS.MALHISIDR =
              (
                SELECT
                  MAX (MALHISIDR)
                FROM
                  MALHIS
                WHERE
                  MALSEQNUM = MST.MALSEQNUM
                AND CMPCOD  = MST.CMPCOD
                AND MALSTA  = MST.MALSTA
                AND SCNPRT  = MST.SCNPRT
              )
              INNER JOIN  FLTOPRMST FLTMST
            ON MST.CMPCOD = FLTMST.CMPCOD
            AND MST.FLTCARIDR = FLTMST.FLTCARIDR
            AND MST.FLTNUM = FLTMST.FLTNUM
            AND MST.FLTSEQNUM = FLTMST.FLTSEQNUM
            AND FLTMST.FLTTYP='T'
            WHERE MST.SCNPRT   = ?
            AND MST.CMPCOD   =?
            AND MST.FLTNUM = ?
			AND MST.FLTCARIDR = ?
            AND MST.FLTSEQNUM = ?

	]]>
	</QRY:Source>
</QRY:Definition>
   <QRY:Definition>
<QRY:Id>167</QRY:Id>
<QRY:Source Name="mail.operations.findRoutingIndex" Type="NATIVE">
	<![CDATA[
select idx.orgcod,idx.dstcod,
idx.rtgseqnum,
idx.rtgidx,idx.pldeffdat,idx.plddisdat,leg.legorg,leg.legdst,leg.legrtg,leg.legflt,leg.legdeptim,leg.legarvtim
from malrtgidx idx ,malrtgidxleg leg where
idx.cmpcod=leg.cmpcod
and idx.rtgseqnum=leg.rtgseqnum
and idx.rtgidx=leg.rtgidx
AND idx.rtgidx=?
and idx.cmpcod=?
and leg.legrtg=(select twoaphcod from shrarlmst arlmst,shrsyspar syspar
WHERE syspar.cmpcod = arlmst.cmpcod
				AND syspar.parcod   ='logonattributes.ownairlineidentifier'
%s 
AND arlmst.cmpcod=idx.cmpcod)
%s
		]]>
 </QRY:Source>
	</QRY:Definition>
	<!-- modifed as part of ICRD-337151 starts-->
	<QRY:Definition>
	<QRY:Id>243</QRY:Id>
	<QRY:Source Name="mail.operations.findforcemajeureapplicablemailsforops" Type="NATIVE">
		<![CDATA[
			SELECT DISTINCT MST.CMPCOD,
			  MST.MALIDR,
			  MST.MALSEQNUM,
			  MST.SCNPRT,
			  MST.FLTCARIDR,
			  HIS.FLTCARCOD,
			  HIS.FLTDAT,
			  MST.FLTNUM,
			  MST.FLTSEQNUM,
			  MST.OPRSTA,
			  MST.WGT,
			  MST.ORGCOD ORGARPCOD,
			  MST.DSTCOD DSTARPCOD,
			  MST.CSGDOCNUM,
			  MST.SCNUSR LSTUPDUSR
			FROM MALMST MST
			INNER JOIN MALHIS HIS
			ON HIS.CMPCOD     =MST.CMPCOD
			AND HIS.MALSEQNUM =MST.MALSEQNUM
			LEFT OUTER JOIN MALFLT FLT
			ON HIS.CMPCOD     =FLT.CMPCOD
			AND HIS.FLTNUM    =FLT.FLTNUM
			AND HIS.FLTCARIDR =FLT.FLTCARIDR
			AND HIS.FLTSEQNUM =FLT.FLTSEQNUM
			LEFT OUTER JOIN FLTOPRMST FLTMST
			ON FLTMST.CMPCOD     =FLT.CMPCOD
			AND FLTMST.FLTNUM    =FLT.FLTNUM
			AND FLTMST.FLTCARIDR =FLT.FLTCARIDR
			AND FLTMST.FLTSEQNUM =FLT.FLTSEQNUM
			LEFT OUTER JOIN FLTOPRLEG FLTLEG
			ON FLTLEG.CMPCOD     =FLT.CMPCOD
			AND FLTLEG.FLTNUM    =FLT.FLTNUM
			AND FLTLEG.FLTCARIDR =FLT.FLTCARIDR
			AND FLTLEG.FLTSEQNUM =FLT.FLTSEQNUM
			AND FLTLEG.LEGSERNUM =FLT.LEGSERNUM
			WHERE MST.MALSTA   NOT IN('NEW','RTN')
			AND MST.CMPCOD = ?
		]]>
	</QRY:Source>
</QRY:Definition>
<QRY:Definition>
	<QRY:Id>244</QRY:Id>
	<QRY:Source Name="mail.operations.findforcemajeureapplicablemailsforcardit" Type="NATIVE">
		<![CDATA[
			SELECT DISTINCT MST.CMPCOD,
			  MST.MALIDR,
			  MST.MALSEQNUM,
			  MST.SCNPRT,
 ARL.TWOAPHCOD FLTCARCOD,
        MST.FLTCARIDR,
			  MST.FLTNUM,
			  MST.FLTSEQNUM,
        MAX(CSGRTG.FLTDAT) FLTDAT,
			  MST.OPRSTA,
			  MST.WGT,
        MST.ORGCOD,
        MST.DSTCOD,
			  MST.CSGDOCNUM,
        MST.SCNUSR LSTUPDUSR
			FROM MALCSGDTL CSGDTL,
			  MALMST MST,
			  MALCSGRTG CSGRTG,
  MALCSGMST CSGMST,
  SHRARLMST ARL
			WHERE CSGDTL.CMPCOD  = MST.CMPCOD
			AND CSGDTL.MALSEQNUM = MST.MALSEQNUM
			AND CSGDTL.CMPCOD    = CSGRTG.CMPCOD
			AND CSGDTL.POACOD    = CSGRTG.POACOD
			AND CSGDTL.CSGDOCNUM = CSGRTG.CSGDOCNUM
			AND CSGDTL.CSGSEQNUM = CSGRTG.CSGSEQNUM
			AND CSGRTG.CMPCOD    = CSGMST.CMPCOD
			AND CSGRTG.POACOD    = CSGMST.POACOD
			AND CSGRTG.CSGDOCNUM = CSGMST.CSGDOCNUM
			AND CSGRTG.CSGSEQNUM = CSGMST.CSGSEQNUM
AND MST.CMPCOD                                      = ARL.CMPCOD
AND MST.FLTCARIDR                                   = ARL.ARLIDR
			AND MST.CMPCOD = ?
		]]>
	</QRY:Source>
</QRY:Definition>
<QRY:Definition>
		<QRY:Id>245</QRY:Id>
		<QRY:Source Name="mail.operations.saveForceMajeureRequest" Type="PROCEDURE">
			<![CDATA[
					CALL pkg_mal_operations_defaults.SPR_MAL_REQ_FORCE_MAJEURE
					(
						?,
						?,
						?,
						?,
						?,
						?,
						?,
						?,
						?,
						?,
						?,
						?,
						?,
						?,
						?,
						?,
						?,
						?
					)
				]]>
		</QRY:Source>

	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>246</QRY:Id>
	<QRY:Source Name="mail.operations.findforcemjeurerequestdetails" Type="NATIVE">
		<![CDATA[
			SELECT FORC.CMPCOD,
			  FORC.MALIDR,
			  FORC.FLTCARCOD,
			  FORC.ARPCOD SCNPRT,
			  FORC.FLTNUM,
			  FORC.FLTDAT,
			  FORC.OPRSRC,
			  FORC.OPRTYP,
			  (SELECT OPRSTA FROM MALMST
					WHERE CMPCOD = FORC.CMPCOD
					  AND MALSEQNUM = FORC.MALSEQNUM
			   ) OPRSTA,
			  FORC.WGT,
			  FORC.ORGARPCOD,
			  FORC.DSTARPCOD,
			  FORC.CSGDOCNUM,
			  FORC.FORMJRIDR,
			  FORC.FORMJRSTA,
			  FORC.SEQNUM,
			  FORC.REQRMK,
			  FORC.APRRMK,
			  FORC.LSTUPDUSR
			FROM MALFORMJRREQMST FORC
			WHERE FORC.CMPCOD  =?
			AND FORC.FORMJRIDR =?
		]]>
	</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>248</QRY:Id>
	<QRY:Source Name="mail.operations.findforcemjeurerequestids" Type="NATIVE">
		<![CDATA[
			SELECT DISTINCT FORMJRIDR,
			  REQDAT,
			  FILPAR,
			  REQRMK
			FROM MALFORMJRREQMST
			WHERE CMPCOD=?
		]]>
	</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>249</QRY:Id>
		<QRY:Source Name="mail.operations.updateForceMajeureRequest" Type="PROCEDURE">
			<![CDATA[
					CALL pkg_mal_operations_defaults.SPR_MAL_UPDATE_FORCE_MAJEURE
					(
						?,
						?,
						?,
						?,
						?,
						?
					)
				]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>250</QRY:Id>
	<QRY:Source Name="mail.operations.findAllContainersInAssignedFlight" Type="NATIVE">
	<![CDATA[
	SELECT DISTINCT con.connum ,con.contyp,
  fltseg.pol asgprt,
  fltseg.pou
  ,con.CMPCOD,con.FLTCARIDR,con.FLTNUM,con.FLTSEQNUM,con.LEGSERNUM
FROM MALFLT flt,
  MALFLTSEG fltseg,
  malfltcon con
WHERE flt.cmpcod              = fltseg.cmpcod
AND flt.fltcaridr             = fltseg.fltcaridr
AND flt.fltnum                = fltseg.fltnum
AND flt.fltseqnum             = fltseg.fltseqnum
AND flt.arpcod                = fltseg.pol
AND fltseg.cmpcod             = con.cmpcod
AND fltseg.fltcaridr          = con.fltcaridr
AND fltseg.fltnum             = con.fltnum
AND fltseg.fltseqnum          = con.fltseqnum
AND fltseg.segsernum          = con.segsernum
AND flt.cmpcod                = ?
AND flt.fltcaridr             = ?
AND flt.fltnum                = ?
AND flt.fltseqnum             = ?
AND flt.arpcod                = ?
					    ]]>
				</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>251</QRY:Id>
		<QRY:Source Name="mail.operations.fetchMailDataForOfflineUpload" Type="PROCEDURE">
			<![CDATA[
				   SELECT TAB.CMPCOD,
  TAB.FILTYP,
  TAB.FILNAM,
  TAB.SERNUM,
  TAB.REF001,
  TAB.REF002,
  TAB.REF003,
   MST.MALSEQNUM,
  MST.MALIDR,
  MST.SCNDAT,
  MST.DSPDAT,
  OFCMST.POACOD,
  OFCMST.ARPCOD ORGAPRCOD,
  OFCMST.CTYCOD ORGCITYCOD,
  OFCMST2.ARPCOD DSTARPCOD,
  OFCMST2.CTYCOD DSTCITYCOD,
  OFCMST.EXGOFCCOD ORGNOFCEXGCOD,
  OFCMST2.EXGOFCCOD DSTNOFCEXGCOD,
  SUBSTR (TAB.REF001,13,1) MALCTGCOD
FROM SHRGENEXTTAB TAB
LEFT OUTER JOIN MALMST MST
ON TAB.CMPCOD = MST.CMPCOD
AND TAB.REF001 = MST.MALIDR
INNER JOIN MALEXGOFCMST OFCMST
ON OFCMST.CMPCOD = TAB.CMPCOD
AND OFCMST.EXGOFCCOD = SUBSTR (TAB.REF001, 0, 6)
INNER JOIN MALEXGOFCMST OFCMST2
ON OFCMST2.CMPCOD = TAB.CMPCOD
AND OFCMST2.EXGOFCCOD = SUBSTR (TAB.REF001, 7, 6)
WHERE TAB.CMPCOD= ?
AND TAB.FILTYP  = ?
ORDER BY TAB.SERNUM
					    ]]>
				</QRY:Source>
	</QRY:Definition>
			  	<!-- Added as part of ICRD-229584 starts-->
	<QRY:Definition>
	<QRY:Id>251</QRY:Id>
	<QRY:Source Name="mail.operations.getmanifestinfo" Type="NATIVE">
	<![CDATA[
SELECT
  CASE
    WHEN MST.MALSTA='ARR'
    THEN 'Y'
    ELSE DTL.ARRSTA
  END ARRSTA,
  DTL.CMPCOD,
  DTL.FLTCARIDR,
  DTL.FLTNUM,
  DTL.ULDNUM,
  DTL.FLTSEQNUM,
  DTL.SEGSERNUM,
  DTL.ACPSTA,
  CON.ASGPRT,
  CON.CONTYP,
  LEG.LEGSERNUM,
  CON.POAFLG
FROM MALMST MST
INNER JOIN MALULDSEGDTL DTL
ON MST.CMPCOD    =DTL.CMPCOD
AND MST.MALSEQNUM=DTL.MALSEQNUM
LEFT OUTER JOIN FLTOPRSEG SEG
ON DTL.CMPCOD     = SEG.CMPCOD
AND DTL.FLTNUM = SEG.FLTNUM
AND DTL.FLTCARIDR = SEG.FLTCARIDR
AND DTL.FLTSEQNUM = SEG.FLTSEQNUM
AND DTL.SEGSERNUM = SEG.SEGSERNUM
LEFT OUTER JOIN FLTOPRLEG LEG ON LEG.CMPCOD = SEG.CMPCOD
                                     AND LEG.FLTNUM = SEG.FLTNUM
                                     AND LEG.FLTCARIDR = SEG.FLTCARIDR
                                     AND LEG.FLTSEQNUM = SEG.FLTSEQNUM
                                     AND LEG.LEGDST = SEG.SEGDST
LEFT OUTER JOIN MALFLTCON CON
ON DTL.CMPCOD     =CON.CMPCOD
AND DTL.FLTCARIDR =CON.FLTCARIDR
AND DTL.FLTNUM    =CON.FLTNUM
AND DTL.FLTSEQNUM =CON.FLTSEQNUM
AND DTL.SEGSERNUM =CON.SEGSERNUM
AND DTL.CONNUM    =CON.CONNUM
WHERE MST.CMPCOD = ?
AND MST.MALSEQNUM = ?
AND SEG.SEGDST = ?
]]>
	</QRY:Source>
	</QRY:Definition>
	<!--Added as part of ICRD-229584 ends -->
    <!--Added by A-7794 as part of ICRD-232299 -->
<QRY:Definition>
		<QRY:Id>252</QRY:Id>
		<QRY:Source Name="mail.operations.checkScanWavedAirport" Type="NATIVE">
			<![CDATA[
		  SELECT MAX(SCNWVDFLG) SCNWVDFLG FROM MALSRVSTDCFG WHERE CMPCOD = ? AND GPACOD = ? AND DSTCOD = ?
					    ]]>
				</QRY:Source>
	</QRY:Definition>

    <QRY:Definition>
		<QRY:Id>253</QRY:Id>
		<QRY:Source Name="mail.operations.findServiceFailureDetails" Type="NATIVE">
			<![CDATA[
					 SELECT COUNT(*) AS TOTAL,
  SUM(
  CASE
    WHEN NOT EXISTS
      (SELECT 1
      FROM MALHIS HIS2
      WHERE MALSTA      ='ACP'
      AND MAL.MALSEQNUM = HIS2.MALSEQNUM
      AND MAL.CMPCOD    = HIS2.CMPCOD
      AND (HIS2.SCNPRT  = MAL.ORGCOD
      OR EXISTS
        (SELECT ARPCOD
        FROM MALCTSARP CTS
        WHERE MAL.CMPCOD                =CTS.CMPCOD
        AND CTS.RSDMOD                  ='6'
        AND MAL.POACOD                  =CTS.GPACOD
		AND MAL.DSPDAT BETWEEN CTS.VLDFRMDAT AND CTS.VLDTOODAT
        AND INSTR(CTS.ARPCOD,MAL.ORGCOD)>0
		AND INSTR(CTS.ARPCOD,HIS2.SCNPRT)>0
        ))
      )
    AND EXISTS
      (SELECT 1
      FROM MALHIS HIS2
      WHERE MALSTA      ='DLV'
      AND MAL.MALSEQNUM = HIS2.MALSEQNUM
      AND MAL.CMPCOD    = HIS2.CMPCOD
      AND (HIS2.SCNPRT  = MAL.DSTCOD
      OR EXISTS
        (SELECT ARPCOD
        FROM MALCTSARP CTS
        WHERE MAL.CMPCOD                =CTS.CMPCOD
        AND CTS.RSDMOD                  ='21'
        AND MAL.POACOD                  = CTS.GPACOD
		AND MAL.DSPDAT BETWEEN CTS.VLDFRMDAT AND CTS.VLDTOODAT
        AND INSTR(CTS.ARPCOD,MAL.DSTCOD)>0
		AND INSTR(CTS.ARPCOD,HIS2.SCNPRT)>0
        ))
      )
    THEN 1
    ELSE 0
  END )MISSINGORGSCAN,
  SUM(
  CASE
    WHEN NOT EXISTS
      (SELECT 1
      FROM MALHIS HIS2
      WHERE MALSTA      ='DLV'
      AND MAL.MALSEQNUM = HIS2.MALSEQNUM
      AND MAL.CMPCOD    = HIS2.CMPCOD
      AND (HIS2.SCNPRT  = MAL.DSTCOD
      OR EXISTS
        (SELECT ARPCOD
        FROM MALCTSARP CTS
        WHERE MAL.CMPCOD                =CTS.CMPCOD
        AND CTS.RSDMOD                  ='21'
        AND MAL.POACOD                  = CTS.GPACOD
		AND MAL.DSPDAT BETWEEN CTS.VLDFRMDAT AND CTS.VLDTOODAT
        AND INSTR(CTS.ARPCOD,MAL.DSTCOD)>0
		AND INSTR(CTS.ARPCOD,HIS2.SCNPRT)>0
        ))
      )
    AND EXISTS
      (SELECT 1
      FROM MALHIS HIS2
      WHERE MALSTA      ='ACP'
      AND MAL.MALSEQNUM = HIS2.MALSEQNUM
      AND MAL.CMPCOD    = HIS2.CMPCOD
      AND (HIS2.SCNPRT  = MAL.ORGCOD
      OR EXISTS
        (SELECT ARPCOD
        FROM MALCTSARP CTS
        WHERE MAL.CMPCOD                =CTS.CMPCOD
        AND CTS.RSDMOD                  ='6'
        AND MAL.POACOD                  =CTS.GPACOD
		AND MAL.DSPDAT BETWEEN CTS.VLDFRMDAT AND CTS.VLDTOODAT
        AND INSTR(CTS.ARPCOD,MAL.ORGCOD)>0
		AND INSTR(CTS.ARPCOD,HIS2.SCNPRT)>0
        ))
      )
    THEN 1
    ELSE 0
  END) MISSINGDLVSCAN,
  SUM(
  CASE
    WHEN NOT EXISTS
      (SELECT 1
      FROM MALHIS HIS2
      WHERE MALSTA      ='ACP'
      AND MAL.MALSEQNUM = HIS2.MALSEQNUM
      AND MAL.CMPCOD    = HIS2.CMPCOD
      AND (HIS2.SCNPRT  = MAL.ORGCOD
      OR EXISTS
        (SELECT ARPCOD
        FROM MALCTSARP CTS
        WHERE MAL.CMPCOD                =CTS.CMPCOD
        AND CTS.RSDMOD                  ='6'
        AND MAL.POACOD                  =CTS.GPACOD
		AND MAL.DSPDAT BETWEEN CTS.VLDFRMDAT AND CTS.VLDTOODAT
        AND INSTR(CTS.ARPCOD,MAL.ORGCOD)>0
		AND INSTR(CTS.ARPCOD,HIS2.SCNPRT)>0
        ))
      )
    AND NOT EXISTS
      (SELECT 1
      FROM MALHIS HIS2
      WHERE MALSTA      ='DLV'
      AND MAL.MALSEQNUM = HIS2.MALSEQNUM
      AND MAL.CMPCOD    = HIS2.CMPCOD
      AND (HIS2.SCNPRT  = MAL.DSTCOD
      OR EXISTS
        (SELECT ARPCOD
        FROM MALCTSARP CTS
        WHERE MAL.CMPCOD                =CTS.CMPCOD
        AND CTS.RSDMOD                  ='21'
        AND MAL.POACOD                  = CTS.GPACOD
		AND MAL.DSPDAT BETWEEN CTS.VLDFRMDAT AND CTS.VLDTOODAT
        AND INSTR(CTS.ARPCOD,MAL.DSTCOD)>0
		AND INSTR(CTS.ARPCOD,HIS2.SCNPRT)>0
        ))
      )
    THEN 1
    ELSE 0
  END) MISSINGBOTHSCAN
FROM MALMST MAL
LEFT OUTER JOIN MALHIS HIS
ON MAL.MALSEQNUM = HIS.MALSEQNUM
AND MAL.CMPCOD   = HIS.CMPCOD
WHERE MAL.CMPCOD = ?
AND HIS.SCNPRT   = ?
AND HIS.MALHISIDR=
  (SELECT MAX(Z.MALHISIDR)
  FROM MALHIS Z
  WHERE Z.CMPCOD =MAL.CMPCOD
  AND Z.MALSEQNUM=MAL.MALSEQNUM
  AND Z.SCNPRT   = ?
  )
AND( NOT EXISTS
  (SELECT 1
  FROM MALHIS HIS2
  WHERE MALSTA      ='ACP'
  AND MAL.MALSEQNUM = HIS2.MALSEQNUM
  AND MAL.CMPCOD    = HIS2.CMPCOD
  AND (HIS2.SCNPRT  = MAL.ORGCOD
  OR EXISTS
    (SELECT ARPCOD
    FROM MALCTSARP CTS
    WHERE MAL.CMPCOD                =CTS.CMPCOD
    AND CTS.RSDMOD                  ='6'
    AND MAL.POACOD                  =CTS.GPACOD
	AND MAL.DSPDAT BETWEEN CTS.VLDFRMDAT AND CTS.VLDTOODAT
    AND INSTR(CTS.ARPCOD,MAL.ORGCOD)>0
	AND INSTR(CTS.ARPCOD,HIS2.SCNPRT)>0
    ))
  )
AND NOT EXISTS
  (SELECT 1
  FROM MALHIS HIS2
  WHERE MALSTA      ='DLV'
  AND MAL.MALSEQNUM = HIS2.MALSEQNUM
  AND MAL.CMPCOD    = HIS2.CMPCOD
  AND (HIS2.SCNPRT  = MAL.DSTCOD
  OR EXISTS
    (SELECT ARPCOD
    FROM MALCTSARP CTS
    WHERE MAL.CMPCOD                =CTS.CMPCOD
    AND CTS.RSDMOD                  ='21'
    AND MAL.POACOD                  = CTS.GPACOD
	AND MAL.DSPDAT BETWEEN CTS.VLDFRMDAT AND CTS.VLDTOODAT
    AND INSTR(CTS.ARPCOD,MAL.DSTCOD)>0
	AND INSTR(CTS.ARPCOD,HIS2.SCNPRT)>0
    ))
  )
OR (NOT EXISTS
  (SELECT 1
  FROM MALHIS HIS2
  WHERE MALSTA      ='DLV'
  AND MAL.MALSEQNUM = HIS2.MALSEQNUM
  AND MAL.CMPCOD    = HIS2.CMPCOD
  AND (HIS2.SCNPRT  = MAL.DSTCOD
  OR EXISTS
    (SELECT ARPCOD
    FROM MALCTSARP CTS
    WHERE MAL.CMPCOD                =CTS.CMPCOD
    AND CTS.RSDMOD                  ='21'
    AND MAL.POACOD                  = CTS.GPACOD
	AND MAL.DSPDAT BETWEEN CTS.VLDFRMDAT AND CTS.VLDTOODAT
    AND INSTR(CTS.ARPCOD,MAL.DSTCOD)>0
	AND INSTR(CTS.ARPCOD,HIS2.SCNPRT)>0
    ))
  )
AND EXISTS
  (SELECT 1
  FROM MALHIS HIS2
  WHERE MALSTA      ='ACP'
  AND MAL.MALSEQNUM = HIS2.MALSEQNUM
  AND MAL.CMPCOD    = HIS2.CMPCOD
  AND (HIS2.SCNPRT  = MAL.ORGCOD
  OR EXISTS
    (SELECT ARPCOD
    FROM MALCTSARP CTS
    WHERE MAL.CMPCOD                =CTS.CMPCOD
    AND CTS.RSDMOD                  ='6'
    AND MAL.POACOD                  =CTS.GPACOD
	AND MAL.DSPDAT BETWEEN CTS.VLDFRMDAT AND CTS.VLDTOODAT
    AND INSTR(CTS.ARPCOD,MAL.ORGCOD)>0
	AND INSTR(CTS.ARPCOD,HIS2.SCNPRT)>0
    ))
  ))
OR (NOT EXISTS
  (SELECT 1
  FROM MALHIS HIS2
  WHERE MALSTA      ='ACP'
  AND MAL.MALSEQNUM = HIS2.MALSEQNUM
  AND MAL.CMPCOD    = HIS2.CMPCOD
  AND (HIS2.SCNPRT  = MAL.ORGCOD
  OR EXISTS
    (SELECT ARPCOD
    FROM MALCTSARP CTS
    WHERE MAL.CMPCOD                =CTS.CMPCOD
    AND CTS.RSDMOD                  ='6'
    AND MAL.POACOD                  =CTS.GPACOD
	AND MAL.DSPDAT BETWEEN CTS.VLDFRMDAT AND CTS.VLDTOODAT
    AND INSTR(CTS.ARPCOD,MAL.ORGCOD)>0
	AND INSTR(CTS.ARPCOD,HIS2.SCNPRT)>0
    ))
  )
AND EXISTS
  (SELECT 1
  FROM MALHIS HIS2
  WHERE MALSTA      ='DLV'
  AND MAL.MALSEQNUM = HIS2.MALSEQNUM
  AND MAL.CMPCOD    = HIS2.CMPCOD
  AND (HIS2.SCNPRT  = MAL.DSTCOD
  OR EXISTS
    (SELECT ARPCOD
    FROM MALCTSARP CTS
    WHERE MAL.CMPCOD                =CTS.CMPCOD
    AND CTS.RSDMOD                  ='21'
    AND MAL.POACOD                  = CTS.GPACOD
	AND MAL.DSPDAT BETWEEN CTS.VLDFRMDAT AND CTS.VLDTOODAT
    AND INSTR(CTS.ARPCOD,MAL.DSTCOD)>0
	AND INSTR(CTS.ARPCOD,HIS2.SCNPRT)>0
    ))
  )
))
AND (MAL.SCNWVDFLG     = 'N'
OR MAL.SCNWVDFLG      IS NULL)
					]]>
				</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
		<QRY:Id>254</QRY:Id>
		<QRY:Source Name="mail.operations.findStationOntimeDetails" Type="NATIVE">
			<![CDATA[
			SELECT COUNT(*) AS TOTAL,
  SUM(
  CASE
    WHEN ONNTIMDLVFLG = 'Y'
    THEN 1
    ELSE 0
  END )ONTIMDLV,
  SUM(
  CASE
    WHEN ONNTIMDLVFLG = 'N'
    THEN 1
    ELSE 0
  END) NOTONTIMDLV
FROM MALMST MAL
LEFT OUTER JOIN MALHIS HIS
ON MAL.MALSEQNUM       = HIS.MALSEQNUM
AND MAL.CMPCOD         = HIS.CMPCOD
WHERE MAL.CMPCOD       = ?
AND HIS.SCNPRT         = ?
AND (MAL.ONNTIMDLVFLG  = 'Y'
OR (MAL.ONNTIMDLVFLG   = 'N'))
         ]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
		<QRY:Id>255</QRY:Id>
		<QRY:Source Name="mail.operations.findForceMajeureMailbagCountDetails" Type="NATIVE">
			<![CDATA[
			 SELECT COUNT(*) AS TOTAL,
  SUM(
  CASE
    WHEN FORMJRSTA='APR'
    THEN 1
    ELSE 0
  END )APPROVED,
  SUM(
  CASE
    WHEN FORMJRSTA='REQ'
    THEN 1
    ELSE 0
  END )RAISED,
  SUM(
  CASE
    WHEN FORMJRSTA='REJ'
    THEN 1
    ELSE 0
  END )REJECTED
FROM
  (SELECT DISTINCT MAL.MALIDR,
    MAL.SCNPRT,
    MAL.ORGCOD,
    MAL.REQDLVTIM,
    MAL.CSGDOCNUM,
    MAL.MALSTA,
    MAL.MALSRVLVL,
    MAL.DSTCOD,
    MAL.ONNTIMDLVFLG,
    MAL.MALSEQNUM,
    (SELECT H.SCNDAT
    FROM MALHIS H
    WHERE H.CMPCOD =MAL.CMPCOD
    AND H.MALSEQNUM=MAL.MALSEQNUM
    AND H.MALHISIDR=
      (SELECT MAX(Z.MALHISIDR)
      FROM MALHIS Z
      WHERE Z.CMPCOD =MAL.CMPCOD
      AND Z.MALSEQNUM=MAL.MALSEQNUM
      )
    ) SCNDAT,
    FORCEMJR.FORMJRSTA
FROM MALMST MAL,
    MALHIS HIS,
    MALFORMJRREQMST FORCEMJR
  WHERE MAL.MALSEQNUM    = HIS.MALSEQNUM(+)
AND MAL.CMPCOD         = HIS.CMPCOD(+)
  AND MAL.MALSEQNUM      = FORCEMJR.MALSEQNUM
  AND MAL.CMPCOD         = FORCEMJR.CMPCOD
AND MAL.CMPCOD         = ?
AND HIS.SCNPRT         = ?
         ]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
		<QRY:Id>256</QRY:Id>
		<QRY:Source Name="mail.operations.findServiceFailureMailbags" Type="NATIVE">
			<![CDATA[
					  WITH HIS AS
  (SELECT MALSEQNUM,
    MAX(MALHISIDR),
    CMPCOD
  FROM MALHIS
  WHERE CMPCOD                                      = ?
  AND SCNPRT                                        = ?
  AND TO_NUMBER(TO_CHAR(TRUNC(SCNDAT),'YYYYMMDD')) >= ?
  AND TO_NUMBER(TO_CHAR(TRUNC(SCNDAT),'YYYYMMDD')) <= ?
  GROUP BY CMPCOD,
    MALSEQNUM
  )
					  SELECT MAL.MALIDR,
  MAL.ORGEXGOFC,
  MAL.DSTEXGOFC,
  MAL.SCNPRT,
  MAL.ORGCOD,
  MAL.REQDLVTIM,
  MAL.CSGDOCNUM,
  MAL.MALSTA,
  MAL.MALSRVLVL,
  MAL.DSTCOD,
  MAL.ONNTIMDLVFLG,
  MAL.MALSEQNUM,
  (SELECT H.SCNDAT
  FROM MALHIS H
  WHERE H.CMPCOD =MAL.CMPCOD
  AND H.MALSEQNUM=MAL.MALSEQNUM
  AND H.MALSTA   ='DLV'
  AND H.MALHISIDR=
    (SELECT MAX(Z.MALHISIDR)
    FROM MALHIS Z
    WHERE Z.CMPCOD =MAL.CMPCOD
    AND Z.MALSEQNUM=MAL.MALSEQNUM
    AND Z.MALSTA   ='DLV'
    )
  )SCNDAT
FROM MALMST MAL ,
  HIS
WHERE MAL.CMPCOD = HIS.CMPCOD
AND MAL.MALSEQNUM= HIS.MALSEQNUM
AND (MAL.SCNWVDFLG     = 'N'
OR MAL.SCNWVDFLG      IS NULL)
					    ]]>
				</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
		<QRY:Id>257</QRY:Id>
		<QRY:Source Name="mail.operations.findStationOntimeMailbags" Type="NATIVE">
			<![CDATA[
			SELECT DISTINCT MAL.MALIDR,
  MAL.ORGCOD,
  MAL.DSTCOD,
  MAL.REQDLVTIM,
  MAL.CSGDOCNUM,
  MAL.MALSTA,
  MAL.MALSRVLVL,
  MAL.ONNTIMDLVFLG,
  MAL.MALSEQNUM,
  MAL.SCNPRT SCNPRT,
  (SELECT H.SCNDAT
  FROM MALHIS H
  WHERE H.CMPCOD =MAL.CMPCOD
  AND H.MALSEQNUM=MAL.MALSEQNUM
  AND H.MALHISIDR=
    (SELECT MAX(Z.MALHISIDR)
    FROM MALHIS Z
    WHERE Z.CMPCOD =MAL.CMPCOD
    AND Z.MALSEQNUM=MAL.MALSEQNUM
    AND Z.MALSTA   = 'DLV'
    )
  )SCNDAT
FROM MALMST MAL
LEFT OUTER JOIN MALHIS HIS
ON MAL.MALSEQNUM       = HIS.MALSEQNUM
AND MAL.CMPCOD         = HIS.CMPCOD
WHERE MAL.CMPCOD       = ?
AND HIS.SCNPRT         = ?
AND TO_NUMBER(TO_CHAR(TRUNC(HIS.SCNDAT),'YYYYMMDD')) >= ?
AND TO_NUMBER(TO_CHAR(TRUNC(HIS.SCNDAT),'YYYYMMDD')) <= ?
         ]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
		<QRY:Id>258</QRY:Id>
		<QRY:Source Name="mail.operations.findForceMajeureRequestedMailbags" Type="NATIVE">
		<![CDATA[
	SELECT DISTINCT MAL.MALIDR,
  MAL.SCNPRT,
  MAL.ORGCOD,
  MAL.REQDLVTIM,
  MAL.CSGDOCNUM,
  MAL.MALSTA,
  MAL.MALSRVLVL,
  MAL.DSTCOD,
  MAL.ONNTIMDLVFLG,
  MAL.MALSEQNUM,
  (SELECT H.SCNDAT
  FROM MALHIS H
  WHERE H.CMPCOD =MAL.CMPCOD
  AND H.MALSEQNUM=MAL.MALSEQNUM
  AND H.MALHISIDR=
    (SELECT MAX(Z.MALHISIDR)
    FROM MALHIS Z
    WHERE Z.CMPCOD =MAL.CMPCOD
    AND Z.MALSEQNUM=MAL.MALSEQNUM
    )
  ) SCNDAT
FROM MALMST MAL,
  MALHIS HIS,
  MALFORMJRREQMST FORCEMJR
WHERE MAL.MALSEQNUM = HIS.MALSEQNUM(+)
AND MAL.CMPCOD      = HIS.CMPCOD(+)
AND MAL.MALSEQNUM   = FORCEMJR.MALSEQNUM
AND MAL.CMPCOD      = FORCEMJR.CMPCOD
AND MAL.CMPCOD      = ?
AND HIS.SCNPRT= ?
AND TO_NUMBER(TO_CHAR(TRUNC(HIS.SCNDAT),'YYYYMMDD')) >= ?
AND TO_NUMBER(TO_CHAR(TRUNC(HIS.SCNDAT),'YYYYMMDD')) <= ?
         ]]>
		</QRY:Source>
	</QRY:Definition>

<QRY:Definition>
		<QRY:Id>259</QRY:Id>
		<QRY:Source Name="mail.operations.findMailbagDetailsForMailbagEnquiryHHT" Type="NATIVE">
		<![CDATA[
SELECT
MALSTA,
MALSEQNUM,
SCNDAT,
SCNPRT,
WGT,
FLTNUM,
TWOAPHCOD,
FLTDAT,
CONNUM,
POU,
ORGCOD,
DSTCOD,
ACTWGT,
ACTWGTDSP,
ACTWGTDSPUNT,
CSGDOCNUM,
CSGDAT,
REQDLVTIM,
SCNUSR,
MALRMK,
FLTCARIDR,
FLTSEQNUM,

%s
FROM

(SELECT

MST.MALSTA MALSTA,
MST.MALSEQNUM MALSEQNUM,
MST.SCNDAT SCNDAT,
MST.SCNPRT SCNPRT,
MST.WGT WGT,
MST.FLTNUM FLTNUM,
ARL.TWOAPHCOD TWOAPHCOD,
FLT.FLTDAT FLTDAT,
MST.CONNUM CONNUM,
MST.POU POU,
MST.ORGCOD ORGCOD,
MST.DSTCOD DSTCOD,
MST.ACTWGT ACTWGT,
MST.ACTWGTDSP ACTWGTDSP,
MST.ACTWGTDSPUNT ACTWGTDSPUNT,
MST.CSGDOCNUM CSGDOCNUM,
CSG.CSGDAT CSGDAT,
MST.REQDLVTIM REQDLVTIM,
MST.SCNUSR SCNUSR,
MST.MALRMK MALRMK,
MST.FLTSEQNUM FLTSEQNUM,
MST.FLTCARIDR FLTCARIDR,
RTG.FLTNUM as RTGFLTNUM,
RTG.FLTCARCOD AS RTGCARCOD,
RTG.FLTDAT AS RTGFLTDAT

FROM

MALMST MST

LEFT OUTER JOIN MALCSGMST CSG
ON
MST.CMPCOD = CSG.CMPCOD AND
MST.POACOD = CSG.POACOD AND
MST.CSGDOCNUM = CSG.CSGDOCNUM AND
MST.CSGSEQNUM = CSG.CSGSEQNUM

LEFT OUTER JOIN FLTOPRMST FLT
ON
MST.FLTNUM = FLT.FLTNUM AND
MST.FLTCARIDR = FLT.FLTCARIDR AND
MST.FLTSEQNUM = FLT.FLTSEQNUM AND
MST.CMPCOD = FLT.CMPCOD

LEFT OUTER JOIN MALCSGRTG RTG
ON
MST.CMPCOD = RTG.CMPCOD AND
MST.POACOD = RTG.POACOD AND
MST.CSGDOCNUM = RTG.CSGDOCNUM AND
MST.CSGSEQNUM = RTG.CSGSEQNUM

LEFT OUTER JOIN SHRARLMST ARL
ON
MST.CMPCOD     = ARL.CMPCOD AND
MST.FLTCARIDR = ARL.ARLIDR

WHERE

MST.CMPCOD = ?
AND MST.MALIDR = ?
AND MST.DSPDAT=(select MAX(DSPDAT) from MALMST where CMPCOD=? AND MALIDR=?)
)MST

GROUP BY
MALSTA,
MALSEQNUM,
SCNDAT,
SCNPRT,
WGT,
FLTNUM,
TWOAPHCOD,
FLTDAT,
CONNUM,
POU,
ORGCOD,
DSTCOD,
ACTWGT,
ACTWGTDSP,
ACTWGTDSPUNT,
CSGDOCNUM,
CSGDAT,
REQDLVTIM,
SCNUSR,
MALRMK,
FLTCARIDR,
FLTSEQNUM

         ]]>
		</QRY:Source>
	</QRY:Definition>

<QRY:Definition>
<QRY:Id>260</QRY:Id>
<QRY:Source Name="mail.operations.findInvoicPeriodDetails" Type="NATIVE">
	<![CDATA[
	SELECT GPACOD,PRDFRM,PRDTOO FROM MALCALMST WHERE CMPCOD = ? AND GPACOD = ? AND CALTYP = ?
AND TO_NUMBER(TO_CHAR(to_date(?,'YYYYMMDD'),'YYYYMMDD')) BETWEEN TO_NUMBER(TO_CHAR(PRDFRM,'YYYYMMDD')) AND TO_NUMBER(TO_CHAR(PRDTOO,'YYYYMMDD'))
]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>261</QRY:Id>
<QRY:Source Name="mail.operations.findMailbagDetailsForDuplicate" Type="NATIVE">
	<![CDATA[
	SELECT * FROM MALMST WHERE CMPCOD=? AND MALIDR=? order by malseqnum desc
]]>
</QRY:Source>
</QRY:Definition>

	<QRY:Definition>
<QRY:Id>262</QRY:Id>
<QRY:Source Name="mail.operations.findServiceResponsiveIndicator" Type="NATIVE">
	<![CDATA[
SELECT (CASE WHEN ?='MP' THEN  MAX(SRVINDMILPRE) WHEN ?='MD' THEN MAX(SRVINDMILDEF) WHEN ?='ME' THEN MAX(SRVINMILVEXP)
WHEN ?='CP' THEN MAX(SRVINDCIVPRE) WHEN ?='CD' THEN MAX(SRVINDCIVDEF) WHEN ?='CE' THEN MAX(SRVINDCIVEXP) END) SRVIND
FROM CAPMALCGRRSPMST WHERE PRCTYP='IA' AND CMPCOD=? AND POACOD=? AND ORGCOD=? AND DSTCOD=?
AND ? BETWEEN VLDSTRDAT AND VLDENDDAT AND
%s
GROUP BY ORGCOD,DSTCOD,POACOD,VLDSTRDAT,VLDENDDAT,
SRVINDMILPRE,SRVINDMILDEF,SRVINMILVEXP,SRVINDCIVPRE,SRVINDCIVDEF,SRVINDCIVEXP

]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>263</QRY:Id>
<QRY:Source Name="mail.operations.findMailboxIdFromConfig" Type="NATIVE">
	<![CDATA[
	WITH malpar AS
  ( SELECT 'ORGEXGOFC' keycod, ? keyval FROM dual
                    union all
                  SELECT 'DSTEXGOFC' keycod, ? keyval FROM dual
				   union all
                  SELECT 'ORG' keycod, ? keyval FROM dual
				   union all
                  SELECT 'DST' keycod, ? keyval FROM dual
				   union all
                  SELECT 'MALCTG' keycod, ? keyval FROM dual
				   union all
                  SELECT 'MALSUBCLS' keycod, ? keyval FROM dual
				   union all
                  SELECT 'XXRES' keycod, ? keyval FROM dual
                  ),
  cfgpar AS
  (SELECT cfg.cmpcod,
    cfg.MSGCFGSEQNUM,
    CFG.MALBOXID,
    par.parcod,
    par.parval,
    MST.PARPRY
  FROM MALMSGCFGPAR par
  INNER JOIN MALMSGPARMST mst
  ON par.cmpcod  = MST.cmpcod
  AND par.parcod = MST.parcod
  INNER JOIN MALMSGCFG cfg
  ON par.cmpcod        = cfg.cmpcod
  AND par.MSGCFGSEQNUM = cfg.MSGCFGSEQNUM
  AND TRUNC(current_date) BETWEEN TRUNC(CFG.VLDFRMDAT) AND TRUNC(CFG.VLDTOODAT)
                    where par.cmpcod = ?
                  )
SELECT cmpcod,
  MALBOXID ,
  MTH,
  pry
FROM
  (SELECT cmpcod,
    MALBOXID,
    MTH,
    pry
  FROM
    (SELECT MAX(cfgpar.cmpcod) CMPCOD,
      cfgpar.MSGCFGSEQNUM,
      cfgpar.MALBOXID,
      COUNT(cfgpar.MALBOXID) MTH,
      SUM(TO_NUMBER(cfgpar.PARPRY))pry
                        from  cfgpar
    INNER JOIN malpar
    ON malpar.keycod = cfgpar.parcod
    AND instr(','
      ||cfgpar.parval
      ||',', ','
      ||malpar.keyval
      ||',')>0
    GROUP BY cfgpar.cmpcod,
      cfgpar.MALBOXID,
      cfgpar.MSGCFGSEQNUM
    )INC
  ORDER BY inc.pry DESC,
    inc.mth DESC
  )MST
]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
	<QRY:Id>264</QRY:Id>
		<QRY:Source Name="mail.operations.findmailevent" Type="NATIVE">
			<![CDATA[
				SELECT * FROM
				MALEVT CFG
				WHERE
				CFG.CMPCOD = ?
				AND CFG.MALBOXIDR = ?
]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>266</QRY:Id>
<QRY:Source Name="mail.operations.findPerformanceMailbags" Type="NATIVE">
	<![CDATA[
( SELECT MAL.MALIDR,
      MAL.ORGEXGOFC,
      MAL.DSTEXGOFC,
      MAL.SCNPRT,
      MAL.ORGCOD,
      MAL.REQDLVTIM,
      MAL.CSGDOCNUM,
      MAL.MALSTA,
      MAL.MALSRVLVL,
      MAL.DSTCOD,
      MAL.ONNTIMDLVFLG,
      MAL.MALSEQNUM,
      MAL.DSPDAT,
      MAL.CMPCOD,
	  MAL.POACOD,
      CASE
        WHEN EXISTS
          (SELECT 1
          FROM MALRDT HIS2
          WHERE MALSTA      ='74'
          AND MAL.MALSEQNUM = HIS2.MALSEQNUM
          AND MAL.CMPCOD    = HIS2.CMPCOD
          AND (HIS2.EVTPRT  = MAL.ORGCOD
          OR EXISTS
            (SELECT ARPCOD
            FROM MALCTSARP CTS
            WHERE MAL.CMPCOD                 =CTS.CMPCOD
            AND CTS.RSDMOD                   ='74'
            AND MAL.POACOD                   =CTS.GPACOD
			AND MAL.DSPDAT BETWEEN CTS.VLDFRMDAT AND CTS.VLDTOODAT
            AND INSTR(CTS.ARPCOD,MAL.ORGCOD) >0
            AND INSTR(CTS.ARPCOD,HIS2.EVTPRT)>0
            ))
          )
        THEN 'N'
        ELSE'Y'
      END MISORGSCAN,
      CASE
        WHEN EXISTS
          (SELECT 1
          FROM MALHIS HIS2
          WHERE MALSTA      ='DLV'
          AND MAL.MALSEQNUM = HIS2.MALSEQNUM
          AND MAL.CMPCOD    = HIS2.CMPCOD
          AND (HIS2.SCNPRT  = MAL.DSTCOD
          OR EXISTS
            (SELECT ARPCOD
            FROM MALCTSARP CTS
            WHERE MAL.CMPCOD                 =CTS.CMPCOD
            AND CTS.RSDMOD                   ='21'
            AND MAL.POACOD                   =CTS.GPACOD
			AND MAL.DSPDAT BETWEEN CTS.VLDFRMDAT AND CTS.VLDTOODAT
            AND INSTR(CTS.ARPCOD,MAL.DSTCOD) >0
            AND INSTR(CTS.ARPCOD,HIS2.SCNPRT)>0
            ))
          )
        THEN 'N'
        ELSE 'Y'
      END MISDLVSCAN,
      (SELECT HIS2.SCNDAT
      FROM MALHIS HIS2
      WHERE MALSTA      ='DLV'
      AND MAL.MALSEQNUM = HIS2.MALSEQNUM
      AND MAL.CMPCOD    = HIS2.CMPCOD
      AND (HIS2.SCNPRT  = MAL.DSTCOD
      OR EXISTS
        (SELECT ARPCOD
        FROM MALCTSARP CTS
        WHERE MAL.CMPCOD                 =CTS.CMPCOD
        AND CTS.RSDMOD                   ='21'
        AND MAL.POACOD                   =CTS.GPACOD
		AND MAL.DSPDAT BETWEEN CTS.VLDFRMDAT AND CTS.VLDTOODAT
        AND INSTR(CTS.ARPCOD,MAL.DSTCOD) >0
        AND INSTR(CTS.ARPCOD,HIS2.SCNPRT)>0
        ))
      ) SCNDAT,
      FORCEMJR.FORMJRSTA
    FROM MALMST MAL
  LEFT OUTER JOIN MALFORMJRREQMST FORCEMJR
  ON MAL.MALSEQNUM   = FORCEMJR.MALSEQNUM
  AND MAL.CMPCOD     = FORCEMJR.CMPCOD
    WHERE (MAL.SCNWVDFLG  = 'N'
    OR MAL.SCNWVDFLG   IS NULL)
	AND MAL.MALSTA <> 'NEW'
]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>265</QRY:Id>
<QRY:Source Name="mail.operations.findPerformanceMailbagsServiceFailureCount" Type="NATIVE">
	<![CDATA[
SELECT SUM(case when (misorgscan ='Y' and misdlvscan ='N') then 1 else 0 end) MISSINGORGSCAN,
SUM(case when (misorgscan ='N' and misdlvscan ='Y') then 1 else 0 end) MISSINGDLVSCAN ,
SUM(case when (misorgscan ='Y' and misdlvscan ='Y') then 1 else 0 end) MISSINGBOTHSCAN,
SUM(case when (misorgscan ='N' and misdlvscan ='') then 1 else 0 end) NOOMIS,
COUNT(*) TOTAL
FROM
]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>266</QRY:Id>
<QRY:Source Name="mail.operations.findPerformanceMailbagsOntimeMailbagsCount" Type="NATIVE">
	<![CDATA[
SELECT SUM(case when (ONNTIMDLVFLG ='Y') then 1 else 0 end) ONTIMDLV,
SUM(case when (ONNTIMDLVFLG ='N') then 1 else 0 end) NOTONTIMDLV ,
COUNT(*) TOTAL
FROM
]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>266</QRY:Id>
<QRY:Source Name="mail.operations.findPerformanceMailbagsForceMejureCount" Type="NATIVE">
	<![CDATA[
SELECT SUM(case when (FORMJRSTA ='APR') then 1 else 0 end) APPROVED,
SUM(case when (FORMJRSTA ='REJ') then 1 else 0 end) REJECTED ,
SUM(case when (FORMJRSTA ='REQ') then 1 else 0 end) RAISED ,
SUM(
  CASE
    WHEN (FORMJRSTA is not null)
    THEN 1
    ELSE 0
  END) TOTAL FROM
]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>267</QRY:Id>
<QRY:Source Name="mail.operations.findPerformanceMailbagsSelect" Type="NATIVE">
	<![CDATA[
SELECT MALIDR,
  CMPCOD,
  ORGEXGOFC,
  DSTEXGOFC,
  SCNPRT,
  ORGCOD,
  REQDLVTIM,
  CSGDOCNUM,
  MALSTA,
  MALSRVLVL,
  DSTCOD,
  ONNTIMDLVFLG,
  MALSEQNUM,
  DSPDAT,
  FORMJRSTA,
  POACOD,
  SCNDAT  FROM
]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>268</QRY:Id>
<QRY:Source Name="mail.operations.findTempCarditMessages" Type="NATIVE">
	<![CDATA[
SELECT * FROM (SELECT   dense_rank() over (order  by TMP.seqnum) RNK,
TMP.CMPCOD,
TMP.SEQNUM,
TMP.SYNIDR,
TMP.SYNVER,
TMP.SNDIDR,
TMP.PRCFLD,
TMP.SNDPRTIDRQFR,
TMP.RECPNTIDR,
TMP.RCPPRTIDRQFR,
TMP.PRPDAT,
TMP.ICHCTLREF,
TMP.TSTIND,
TMP.INTCHGCNLCNT,
TMP.TRLINTCHGCNLREF,
TMP.CTLAGY,
TMP.MSGREFNUM,
TMP.MSGTYP,
TMP.MSGVER,
TMP.MSGRELNUM,
TMP.ASNASGCOD,
TMP.CNSMNTIDR,
TMP.MSGFUN,
TMP.DTMPRDQLF,
TMP.DTMFMTQLF,
TMP.TRLMSGREFNUM,
TMP.NUMSEG,
TMP.ERRCAR,
TMP.MALCATCODIDR,
TMP.CNSCMPDAT,
TMP.MALCATCOD,
TMP.REQDLVTIM,
TMP.TRPSTGQFR,
TMP.CNVREFNUM,
TMP.TRSIDR,
TMP.CARIDR,
TMP.DEPLOCQFR,
TMP.DEPPLC,
TMP.ARRLOCQFR,
TMP.ARRPLC,
TMP.TRPDEPDAT,
TMP.TRPARRDAT,
TMP.DOMTRPSTGQFR,
TMP.DOMCNVREFNUM,
TMP.DOMTRSIDR,
TMP.DOMCARIDR,
TMP.TRPMODTRNSPT,
TMP.CARNAM,
TMP.CODLSTQFR,
TMP.AGYCARCOD,
TMP.TSRLEGRAT,
TMP.CNTREF,
TMP.DOMDEPLOCQFR,
TMP.DOMDEPPLC,
TMP.DOMARRLOCQFR,
TMP.DOMARRPLC,
TMP.DEPPLCNAM,
DEPCODLSTQFR,
TMP.DEPCODLSTAGY,
TMP.ARRPLCNAM,
TMP.ARRCODLSTQFR,
TMP.ARRCODLSTAGY,
TMP.TRPDTMPRDQLF,
TMP.TRPDTMFMTQFR,
TMP.DEPDAT,
TMP.ARRDAT,
MAL.NUMPKG,
MAL.RCPTYP,
MAL.PKGTYP,
MAL.DRTAGNUM,
MAL.REFQFR,
MAL.RCPIDR,
MAL.DGRIND,
MAL.INSIND,
MAL.HNDCLS,
MAL.CODLSTAGY,
MAL.MSRAPPQFR,
MAL.RCPWGTTYP,
MAL.MSRUNTQFR,
MAL.DOCMSGNAMCOD,
MAL.DSPIDN,
MAL.ORGEXEOFF,
MAL.DSTEXEOFF,
MAL.RCPMALCATCOD,
MAL.MALSUBCLSCOD,
MAL.LSTDGTYAR,
MAL.DSPNUM,
MAL.RCPSERNUM,
MAL.HGHNUMRCPIND,
MAL.RGDINSIND,
MAL.RCPWGT,
TMP.MALCLSCOD,
TMP.CNLVAL,
TMP.TOTPCSCNLQFR,
TMP.NUMRCP,
TMP.TOTPCSMSRUNTQFR,
TMP.TOTWGTCNLQFR,
TMP.WGTRCP,
TMP.TOTWGTMSRUNTQFR,
TMP.CNSCRTREFNUM,
TMP.TRPCRTREFQFR,
TMP.HNDOVRTRPSTGQFR,
TMP.HNDOVRORGLOCQFR,
TMP.HNDOVRORGLOCIDR,
TMP.HNDOVRORGNAM,
TMP.HNDOVRORGCODQFR,
TMP.HNDOVRORGCODAGY,
TMP.HNDOVRDSTLOCQFR,
TMP.HNDOVRDSTLOCIDR,
TMP.HNDOVRDSTNAM,
TMP.HNDOVRDSTCODQFR,
TMP.HNDOVRDSTCODAGY,
TMP.HNDOVRDTMQFR,
TMP.HNDOVRDTMFMTQFR,
TMP.HNDOVRORGCUTOFF,
TMP.HNDOVRDSTCUTOFF,
TMP.EQPQFR,
TMP.CTRNUM,
TMP.CODLSTRSPAGY,
TMP.CTRTYP,
TMP.CTRCODLSTQFR,
TMP.TYPCODLSTRSPAGY,
TMP.CTRJNYIDR,
TMP.MSRAPP,
TMP.MSRDIM,
TMP.CTRMSRUNTQFR,
TMP.CTRWGT,
TMP.SELNUM,
TMP.MSGPRC,
TMP.PRCSTA,
MAL.CONSELNUM,
TMP.ERRCOD,
TMP.MSGSEQNUM
FROM MALCDTMSGTMP TMP,MALCDTMSGRCPTMP MAL
WHERE TMP.CMPCOD=MAL.CMPCOD
AND TMP.SEQNUM=MAL.SEQNUM
AND TMP.CNSMNTIDR=MAL.CNSMNTIDR
AND TMP.MSGPRC ='N'
AND TMP.CMPCOD=?
]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>269</QRY:Id>
<QRY:Source Name="mail.operations.findDeviationMailbags_query" Type="NATIVE">
	<![CDATA[
		WITH DSPSTRTDAT AS (
			SELECT
				PARVAL,
				CMPCOD
			FROM
				SHRSYSPAR
			WHERE
				PARCOD = 'mail.operatios.deviationlistenabledate'
		), 
		disdevlistpaswithnoconsignment as
              (select   parval, cmpcod
                from shrsyspar
                where parcod = 'mail.operations.deviationrestrictedPAswithoutconsignments'
              ), MST AS (
			SELECT
				MST.CMPCOD,
				MST.MALIDR,
				MST.ORGEXGOFC,
				MST.DSTEXGOFC,
				MST.YER,
				MST.DSN,
				MST.RSN,
				MST.HSN,
				MST.REGIND,
				MST.MALCLS,
				MST.MALCTG   MALCTGCOD,
				MST.MALSUBCLS,
				MST.SCNPRT,
				MST.SCNDAT,
				MST.CONNUM,
				MST.SCNUSR,
				MST.MALSTA,
				MST.OPRSTA,
				MST.CONTYP,
				MST.POU,
				MST.WGT,
				MST.DSPWGT,
				MST.DSPWGTUNT,
				MST.CSGDOCNUM,
				MST.CSGSEQNUM,
				MST.POACOD,
				MST.DMGFLG,
				MST.LSTUPDTIM,
				MST.REQDLVTIM,
				MST.MSTDOCNUM,
				MST.SHPPFX,
				MST.MALSEQNUM,
				MST.ORGCOD,
				MST.DSTCOD,
				MST.ACTWGT,
				MST.ACTWGTDSP,
				MST.ACTWGTDSPUNT,
				MST.MALSRVLVL,
				MST.ONNTIMDLVFLG,
				MST.VOL,
				MST.VOLUNT,
				MST.FLTCARIDR,
				MST.FLTNUM,
				MST.FLTSEQNUM,
				MST.SEGSERNUM,
				(
					SELECT
					COALESCE(MAX(LEGSERNUM), 0)
					FROM
						MALFLTCON CONMST
					WHERE
						MST.FLTCARIDR = CONMST.FLTCARIDR
						AND MST.FLTNUM = CONMST.FLTNUM
						AND MST.FLTSEQNUM = CONMST.FLTSEQNUM
						AND MST.CONNUM = CONMST.CONNUM
						AND MST.CMPCOD = CONMST.CMPCOD
				) AS LEGSERNUM,
				(
					SELECT
						CSGDAT
					FROM
						MALCSGMST CSGMST
					WHERE
						CSGMST.CMPCOD = MST.CMPCOD
						AND CSGMST.CSGDOCNUM = MST.CSGDOCNUM
						AND CSGMST.POACOD = MST.POACOD
						AND CSGMST.CSGSEQNUM = MST.CSGSEQNUM
				) CSGDAT,
				(SELECT MAX('Y')
        FROM MALHIS
        WHERE MALSEQNUM = MST.MALSEQNUM
						AND CMPCOD = MST.CMPCOD
        AND MALSTA NOT IN ( 'NEW', 'BKG', 'CAN', 'OFL', 'CDT', 'ARR', 'ARV' )
						AND SCNPRT = ?
				) ACP,
				(
					SELECT
						MAX(SCNDTL.SCNDAT)
					FROM
						MALSCNDTL SCNDTL
					WHERE
						SCNDTL.CMPCOD = MST.CMPCOD
						AND SCNDTL.SCNPRT = ?
			AND (TO_NUMBER(TO_CHAR(current_date,'YYYYMMDD'))) - (TO_NUMBER(TO_CHAR(SCNDTL.SCNDAT,'YYYYMMDD'))) <= 30
						AND MST.MALIDR = SCNDTL.MALIDR
				) SCNSCNDAT,
				CTSDLV.ARPCOD,
				(SELECT MAX('Y')
        FROM MALULDSEGDTL SEGDTL,
						MALFLTSEG SEG
        WHERE SEGDTL.CMPCOD  = SEG.CMPCOD
						AND SEGDTL.FLTCARIDR = SEG.FLTCARIDR
						AND SEGDTL.FLTNUM = SEG.FLTNUM
						AND SEGDTL.FLTSEQNUM = SEG.FLTSEQNUM
						AND SEGDTL.SEGSERNUM = SEG.SEGSERNUM
						AND SEGDTL.CMPCOD = MST.CMPCOD
						AND SEGDTL.MALSEQNUM = MST.MALSEQNUM
						AND SEGDTL.ACPSTA = 'Y'
						AND SEG.POL = ?
				) ULDSEGFLG,
				(
					SELECT MAX('Y')
        FROM MALHIS HIS
        WHERE MST.CMPCOD   = HIS.CMPCOD
						AND MST.MALSEQNUM = HIS.MALSEQNUM
        AND HIS.MALSTA    IN ( 'TRA', 'ASG' )
						AND HIS.FLTCARIDR <> ?
						AND HIS.SCNPRT = ?
				) TRAOUTFLG,
				(
                 SELECT
                 MAX('Y')
                 FROM
                 malhis his
                 WHERE
                 mst.cmpcod = his.cmpcod
                 AND mst.malseqnum = his.malseqnum
                 AND his.malsta IN (
                  'HDR'
                  )
                 AND his.fltcaridr = ?
                 AND his.scnprt <> ?
                 AND mst.orgcod =  ?
                 ) trainflg,
				(
					SELECT MAX('Y')
        FROM MALHIS HIS
        WHERE MST.CMPCOD  = HIS.CMPCOD
						AND MST.MALSEQNUM = HIS.MALSEQNUM
        AND HIS.MALSTA   IN ( 'DLV' )
						AND HIS.SCNPRT = ?
				) DLVFLG,
				(
					SELECT MAX('Y')
        FROM MALULDSEGDTL SEGDTL,
						MALFLTSEG SEG
        WHERE SEGDTL.CMPCOD  = SEG.CMPCOD
						AND SEGDTL.FLTCARIDR = SEG.FLTCARIDR
						AND SEGDTL.FLTNUM = SEG.FLTNUM
						AND SEGDTL.FLTSEQNUM = SEG.FLTSEQNUM
						AND SEGDTL.SEGSERNUM = SEG.SEGSERNUM
						AND SEGDTL.CMPCOD = MST.CMPCOD
						AND SEGDTL.MALSEQNUM = MST.MALSEQNUM
						AND SEG.POU = ?
						AND MST.DSTCOD <> SEG.POU
						AND EXISTS (
							SELECT MAX(1)
          FROM MALHIS HIS
          WHERE MST.CMPCOD   = HIS.CMPCOD
								AND MST.MALSEQNUM = HIS.MALSEQNUM
								AND ( HIS.MALSTA = 'DLV'
          OR ( HIS.MALSTA   IN ( 'TRA', 'ASG' )
										   AND HIS.FLTCARIDR <> ? ) )
						)
				) DLVTRAFLAG,
				(SELECT MAX('Y')
        FROM MALHIS HIS
        WHERE MST.CMPCOD  = HIS.CMPCOD
						AND MST.MALSEQNUM = HIS.MALSEQNUM
						AND MST.MALSTA <> 'NEW'
						AND HIS.MALSTA <> 'CDT'
						AND HIS.MALSRC <> 'RESDIT'
						AND HIS.SCNPRT <> ?
						AND MST.ORGCOD = ?
				) ANYSCANFLAG,
				(SELECT MAX('Y')
        FROM MALULDSEGDTL SEGDTL,
						MALFLTSEG SEG
        WHERE SEGDTL.CMPCOD  = SEG.CMPCOD
						AND SEGDTL.FLTCARIDR = SEG.FLTCARIDR
						AND SEGDTL.FLTNUM = SEG.FLTNUM
						AND SEGDTL.FLTSEQNUM = SEG.FLTSEQNUM
						AND SEGDTL.SEGSERNUM = SEG.SEGSERNUM
						AND SEGDTL.CMPCOD = MST.CMPCOD
						AND SEGDTL.MALSEQNUM = MST.MALSEQNUM
						AND SEG.POU = ?
				) IMPULDSEGDTLFLAG,
				(SELECT MAX('Y')
        FROM MALCSGRTG RTG
        WHERE MST.CMPCOD  = RTG.CMPCOD
						AND MST.CSGDOCNUM = RTG.CSGDOCNUM
						AND MST.CSGSEQNUM = RTG.CSGSEQNUM
						AND RTG.POU = ?

				) RTGFLG

			FROM
				MALMST MST
				LEFT OUTER JOIN DSPSTRTDAT ON MST.CMPCOD = DSPSTRTDAT.CMPCOD
				left outer join disdevlistpaswithnoconsignment
                on mst.cmpcod = disdevlistpaswithnoconsignment.cmpcod
				LEFT OUTER JOIN MALCTSARP CTSDLV ON CTSDLV.CMPCOD = MST.CMPCOD
													AND CTSDLV.RSDMOD = '21'
													AND CTSDLV.GPACOD = MST.POACOD
													AND MST.DSPDAT BETWEEN CTSDLV.VLDFRMDAT AND CTSDLV.VLDTOODAT
													AND INSTR(CTSDLV.ARPCOD, MST.DSTCOD) > 0
			WHERE
				MST.CMPCOD = ?
				AND CASE
					WHEN DSPSTRTDAT.PARVAL IS NULL
						 OR DSPSTRTDAT.PARVAL = 'N' THEN 1
					WHEN MST.DSPDAT >= TO_DATE(DSPSTRTDAT.PARVAL, 'DD-MM-yyyy HH24:MI:SS') THEN 1
					ELSE 0
				END = 1
				 and
                  case when disdevlistpaswithnoconsignment.parval is not null
                      and  INSTR (disdevlistpaswithnoconsignment.parval,mst.poacod,1)>0
                      and not exists(
                      select 1 from malcsgdtl csg
where
csg.cmpcod = mst.cmpcod
and csg.malseqnum = mst.malseqnum
and csg.csgdocnum = mst.csgdocnum
and csg.csgseqnum = mst.csgseqnum
and csg.poacod = mst.poacod
                      )

 then 0   else 1
                  end                                               = 1
    
				AND TO_NUMBER(TO_CHAR(MST.DSPDAT, 'YYYYMMDD')) >= ?
				AND TO_NUMBER(TO_CHAR(MST.DSPDAT, 'YYYYMMDD')) <= ?
				#FILTERCONDITION#
		)
]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>269</QRY:Id>
<QRY:Source Name="mail.operations.findDeviationMailbags_query1" Type="NATIVE">
	<![CDATA[

		SELECT DISTINCT 
			MST.CMPCOD,
			MST.MALIDR,
			MST.ORGEXGOFC,
			MST.DSTEXGOFC,
			MST.YER,
			MST.DSN,
			MST.RSN,
			MST.HSN,
			MST.REGIND,
			MST.MALCLS,
			MST.MALCTGCOD,
			MST.MALSUBCLS,
			MST.SCNPRT,
			MST.SCNDAT,
			MST.CONNUM,
			MST.SCNUSR,
			MST.MALSTA,
			MST.OPRSTA,
			MST.CONTYP,
			MST.POU,
			MST.WGT,
			MST.DSPWGT,
			MST.DSPWGTUNT,
			MST.CSGDOCNUM,
			MST.CSGSEQNUM,
			MST.POACOD,
			MST.DMGFLG,
			MST.LSTUPDTIM,
			MST.REQDLVTIM,
			MST.MSTDOCNUM,
			MST.SHPPFX,
			MST.MALSEQNUM,
			MST.ORGCOD,
			MST.DSTCOD,
			MST.ACTWGT,
			MST.ACTWGTDSP,
			MST.ACTWGTDSPUNT,
			MST.MALSRVLVL,
			MST.ONNTIMDLVFLG,
			MST.VOL,
			MST.VOLUNT,
			MST.FLTCARIDR,
			MST.FLTNUM,
			MST.FLTSEQNUM,
			MST.SEGSERNUM,
			MST.LEGSERNUM,
			MST.CSGDAT,
			ACP,
			SCNSCNDAT   ERRSCNDAT,
			? ERRSCNPRT,
			'OBMISSED' AS ERRORCOD
		FROM
			MST
		WHERE
			MST.MALSTA <> 'RTN'
			AND ( MST.DSTCOD <> ?
				  AND COALESCE(INSTR(ARPCOD, ?), 0) <= 0 )
			AND COALESCE(ULDSEGFLG, 'N') <> 'Y'
			AND COALESCE(TRAOUTFLG, 'N') <> 'Y'
			AND COALESCE(DLVFLG, 'N')  <> 'Y'
			AND COALESCE(trainflg, 'N')  <> 'Y' 
			AND ( COALESCE(DLVTRAFLAG, 'N') = 'Y'
				  OR COALESCE(ANYSCANFLAG, 'N') = 'Y' )
	]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>269</QRY:Id>
<QRY:Source Name="mail.operations.findDeviationMailbags_query2" Type="NATIVE">
	<![CDATA[

		SELECT
			MST.CMPCOD,
			MST.MALIDR,
			MST.ORGEXGOFC,
			MST.DSTEXGOFC,
			MST.YER,
			MST.DSN,
			MST.RSN,
			MST.HSN,
			MST.REGIND,
			MST.MALCLS,
			MST.MALCTGCOD,
			MST.MALSUBCLS,
			MST.SCNPRT,
			MST.SCNDAT,
			MST.CONNUM,
			MST.SCNUSR,
			MST.MALSTA,
			MST.OPRSTA,
			MST.CONTYP,
			MST.POU,
			MST.WGT,
			MST.DSPWGT,
			MST.DSPWGTUNT,
			MST.CSGDOCNUM,
			MST.CSGSEQNUM,
			MST.POACOD,
			MST.DMGFLG,
			MST.LSTUPDTIM,
			MST.REQDLVTIM,
			MST.MSTDOCNUM,
			MST.SHPPFX,
			MST.MALSEQNUM,
			MST.ORGCOD,
			MST.DSTCOD,
			MST.ACTWGT,
			MST.ACTWGTDSP,
			MST.ACTWGTDSPUNT,
			MST.MALSRVLVL,
			MST.ONNTIMDLVFLG,
			MST.VOL,
			MST.VOLUNT,
			MST.FLTCARIDR,
			MST.FLTNUM,
			MST.FLTSEQNUM,
			MST.SEGSERNUM,
			MST.LEGSERNUM,
			MST.CSGDAT,
			ACP,
			SCNSCNDAT   ERRSCNDAT,
			? ERRSCNPRT,
			'IBUNPLANED' AS ERRORCOD
		FROM
			MST
		WHERE
			MST.MALSTA <> 'RTN'
			AND MST.ORGCOD <> ?
            AND MST.DSTCOD <> ?
			AND COALESCE(ULDSEGFLG, 'N') != 'Y'
			AND COALESCE(IMPULDSEGDTLFLAG, 'N') = 'Y'
			AND COALESCE(TRAOUTFLG, 'N') != 'Y'
			AND COALESCE(RTGFLG, 'N') != 'Y'
          ]]>
</QRY:Source>
</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>270</QRY:Id>
		<QRY:Source Name="mail.operations.findflightbulkcontainerdetails" Type="NATIVE">
			<![CDATA[
						(SELECT ASG.FLTDAT FLTDAT,
					CON.CMPCOD CMPCOD,
					CON.FLTCARIDR FLTCARIDR,
					CON.FLTCARCOD FLTCARCOD,
					CON.FLTNUM FLTNUM,
					CON.FLTSEQNUM FLTSEQNUM,
					CON.LEGSERNUM LEGSERNUM,
					CON.SEGSERNUM SEGSERNUM,
					CON.CONNUM CONNUM,
					CON.POU POU,
					CON.ASGPRT ASGPRT,
					CON.DSTCOD DSTCOD,
					CON.POAFLG POAFLG,
					CON.ACPFLG ACPFLG,
					CON.ARRSTA ARRSTA,
					CON.OFLFLG OFLFLG,
					CON.TRNFLG,
					CON.CONTYP,
					CON.LSTUPDTIM AS CONLSTUPDTIM,
					CON.CONJRNIDR,
					CON.POACOD,
          CON.ACTULDWGT,
          CON.ASGDATUTC,
		  CON.USRCOD USRCOD,
		  CON.LSTUPDUSR LSTUPDUSR,
		  CON.RMK RMK,
		  CON.CNTIDR CNTIDR,
		  CON.ULDFULIND ULDFULIND,
		  CON.TXNCOD TXNCOD,
					(
					CASE
					WHEN CON.CONTYP = 'B'
					THEN 0
					ELSE RTG.RTGSERNUM
					END) AS RTGSERNUM,
					(
					CASE
					WHEN CON.CONTYP = 'B'
					THEN ''
					ELSE TO_CHAR (RTG.ONWFLTDAT, 'DD-MON-YYYY' )
					END) AS ONWFLTDAT,
					(
					CASE
					WHEN CON.CONTYP = 'B'
					THEN ''
					ELSE RTG.ONWFLTNUM
					END) AS ONWFLTNUM,
					(
					CASE
					WHEN CON.CONTYP = 'B'
					THEN ''
					ELSE RTG.ONWFLTCARCOD
					END) AS ONWFLTCARCOD,
					(
					CASE
					WHEN CON.CONTYP = 'B'
					THEN ''
					ELSE RTG.POU
					END) AS RTGPOU,
					(
					CASE
					WHEN CON.CONTYP = 'B'
					THEN 0
					ELSE RTG.ONWFLTCARIDR
					END) ONWFLTCARIDR,
					(
					CASE
					WHEN CON.CONTYP = 'B'
					THEN 0
					ELSE ULD.BAGCNT
					END) AS ULDBAGCNT,
					(
					CASE
					WHEN CON.CONTYP = 'B'
					THEN 0
					ELSE ULD.BAGWGT
					END) AS ULDBAGWGT,
					ULD.WHSCOD WHSCOD,
					ULD.LOCCOD LOCCOD,
          ULD.TRFCARCOD,
					ULD.FRMCARCOD ULDFRMCARCOD,
					ULD.LSTUPDTIM AS ULDLSTUPDTIM,
          MALMST.MALIDR MALIDR,
					MALMST.DSN DSN,
					MALMST.ORGEXGOFC ORGEXGOFC,
					MALMST.DSTEXGOFC DSTEXGOFC,
					MALMST.MALCLS MALCLS,
					MALMST.MALSUBCLS MALSUBCLS,
					MALMST.MALCTG MALCTGCOD,
					MALMST.YER YER,
					MALMST.MALSEQNUM MALSEQNUM,
          MALMST.VOL VOL,
          MALMST.SELNUM SELNUM,
          MALMST.DMGFLG DMGFLG,
          MALMST.CSGDOCNUM CSGDOCNUM,
          MALMST.POACOD MALPOA,
          MALMST.MALRMK MALRMK,
          MALMST.MSTDOCNUM MSTDOCNUM,
          MALMST.SHPPFX SHPPFX,
					MAL.ACPBAG DSNACPBAG,
					MALMST.WGT WGT,
					MALMST.DSPWGTUNT DSPWGTUNT,
					(
					CASE
					WHEN MALMST.MALTYP = 'M'
					THEN 'Y'
					ELSE 'N'
					END) AS PLTENBFLG,
					MAL.STDBAG DSNSTDBAG,
					MAL.STDWGT DSNSTDWGT,
				  --MAL.UBRNUM,
					'' MALRAT,
					'' CURCOD,
					MALMST.REQDLVTIM, 
					COALESCE (BLGDTL.NETAMTBASCUR,PROBLGDTL.NETAMTBASCUR) PROCHG ,
					SYSPAR.PARVAL  BASCURCOD

				    FROM MALFLTCON CON
					INNER JOIN MALFLT ASG
                    ON CON.ASGPRT     = ASG.ARPCOD
                    AND CON.CMPCOD    =ASG.CMPCOD
                    AND CON.FLTCARIDR =ASG.FLTCARIDR
                    AND CON.FLTNUM    =ASG.FLTNUM
                    AND CON.FLTSEQNUM =ASG.FLTSEQNUM
                    AND CON.LEGSERNUM = ASG.LEGSERNUM
					INNER JOIN SHRSYSPAR SYSPAR
					ON CON.CMPCOD     = SYSPAR.CMPCOD
					AND SYSPAR.PARCOD ='shared.airline.basecurrency'
                    LEFT OUTER JOIN MALFLTCONRTG RTG
					ON CON.CMPCOD     = RTG.CMPCOD
					AND CON.ASGPRT    = RTG.ASGPRT
					AND CON.CONNUM    = RTG.CONNUM
					AND CON.FLTCARIDR = RTG.FLTCARIDR
					AND CON.FLTNUM    = RTG.FLTNUM
					AND CON.FLTSEQNUM = RTG.FLTSEQNUM
					AND CON.LEGSERNUM = RTG.LEGSERNUM
                    LEFT OUTER  JOIN MALULDSEG ULD
					ON CON.CMPCOD     = ULD.CMPCOD
					AND CON.FLTCARIDR = ULD.FLTCARIDR
					AND CON.FLTNUM    = ULD.FLTNUM
					AND CON.FLTSEQNUM = ULD.FLTSEQNUM
					AND CON.SEGSERNUM = ULD.SEGSERNUM
                    AND ULD.ULDNUM  LIKE '%BULK-%'
                    LEFT OUTER JOIN MALULDSEGDTL MAL
					ON ULD.CMPCOD     = MAL.CMPCOD
					AND ULD.FLTCARIDR = MAL.FLTCARIDR
					AND ULD.FLTNUM    = MAL.FLTNUM
					AND ULD.FLTSEQNUM = MAL.FLTSEQNUM
					AND ULD.SEGSERNUM = MAL.SEGSERNUM
					AND ULD.ULDNUM    = MAL.ULDNUM
			  	    AND CON.CONNUM    = MAL.CONNUM
                    LEFT OUTER  JOIN MALMST MALMST
					ON MALMST.CMPCOD     = MAL.CMPCOD
					AND MALMST.MALSEQNUM = MAL.MALSEQNUM
					LEFT OUTER JOIN MALMRABLGDTL BLGDTL
					ON BLGDTL.CMPCOD =MALMST.CMPCOD 
					AND BLGDTL.MALSEQNUM=MALMST.MALSEQNUM 
					AND (BLGDTL.PAYFLG = 'R' OR (BLGDTL.PAYFLG = 'T' AND  BLGDTL.JONFLG = 'Y'))
					LEFT OUTER JOIN MALMRAPROBLGDTL PROBLGDTL
					ON PROBLGDTL.CMPCOD =MALMST.CMPCOD 
					AND PROBLGDTL.MALSEQNUM=MALMST.MALSEQNUM 
					AND (PROBLGDTL.PAYFLG = 'R' OR (PROBLGDTL.PAYFLG = 'T' AND  PROBLGDTL.JONFLG = 'Y'))
					WHERE CON.CMPCOD     =?
					AND CON.FLTCARIDR    =?
					AND CON.FLTNUM       =?
					AND CON.FLTSEQNUM    =?
					AND CON.ASGPRT       =?
					AND CON.CONTYP       ='B'
					AND CON.ACPFLG  ='Y'

			]]>
		</QRY:Source>
	</QRY:Definition>
 <QRY:Definition>
 <QRY:Id>271</QRY:Id>
  	<QRY:Source Name="mail.operations.findnumberofbarrowspresentintheflightorcarrier" Type="NATIVE">
			<![CDATA[
				SELECT COUNT(*) AS COUNT
							FROM MALFLTCON
									WHERE FLTCARIDR =?
									AND FLTNUM      =?
									AND FLTSEQNUM   =?
									AND ASGPRT      = ?
									AND POU         = ?
									AND CONTYP      ='B'
			]]>
	</QRY:Source>
  </QRY:Definition>
  <QRY:Definition>
<QRY:Id>272</QRY:Id>
<QRY:Source Name="mail.operations.findroutingforconsignment" Type="NATIVE">
<![CDATA[
SELECT POU,
  POL
FROM MALCSGRTG
WHERE CMPCOD =?
AND POACOD   =?
AND CSGDOCNUM=?
AND POU = ?
			]]>
	</QRY:Source>
  </QRY:Definition>

<QRY:Definition>
<QRY:Id>273</QRY:Id>
<QRY:Source Name="mail.operations.isValidContainerForULDlevelArrivalOrDelivery" Type="NATIVE">
<![CDATA[
select  distinct 'Y'  NOTVALCONFORDLV
					FROM MALFLTCON CON
					INNER JOIN MALULDSEGDTL MALSEG
					ON CON.CMPCOD     = MALSEG.CMPCOD
					AND CON.FLTCARIDR = MALSEG.FLTCARIDR
					AND CON.FLTNUM    = MALSEG.FLTNUM
					AND CON.FLTSEQNUM = MALSEG.FLTSEQNUM
					AND CON.SEGSERNUM = MALSEG.SEGSERNUM
					AND CON.CONNUM    = MALSEG.ULDNUM
					AND( MALSEG.ARRSTA='Y' OR MALSEG.DLVSTA='Y')
					WHERE CON.CMPCOD    = ?
					AND CON.FLTCARIDR   = ?
					AND CON.FLTNUM      = ?
					AND CON.FLTSEQNUM   = ?
					AND CON.LEGSERNUM   = ?
					AND CON.ASGPRT      = ?
					AND CON.CONNUM      = ?
					AND CON.CONTYP      = 'U'
			]]>
	</QRY:Source>
  </QRY:Definition>

  <QRY:Definition>
<QRY:Id>274</QRY:Id>
<QRY:Source Name="mail.operations.findbulkcountforoutbound" Type="NATIVE">
<![CDATA[
SELECT SUM (  CASE
    WHEN CONTYP = 'B'
    THEN 1
    ELSE 0
  END) BULKCOUNT  FROM
          MALFLTCON
          WHERE
          CMPCOD    =?
          AND FLTCARIDR = ?
          AND FLTNUM    = ?
          AND FLTSEQNUM = ?
          AND DSTCOD=?
          AND ASGPRT=?
          ]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>313</QRY:Id>
<QRY:Source Name="mail.operations.findmailbagsfromoalresditprocessing" Type="NATIVE">
<![CDATA[
SELECT DISTINCT SCNPRT,SCNDAT,CMPCOD,MALSEQNUM,CONNUM,MALSTA,POU,CONTYP
FROM MALHIS
WHERE CMPCOD=?
AND   CONNUM=?
AND   MALSTA='ASG'
AND   MALSRC='RESDIT'	 

          ]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>314</QRY:Id>
<QRY:Source Name="mail.operations.findPerformanceMailbagsForceMejure" Type="NATIVE">
	<![CDATA[
( SELECT MAL.MALIDR,
      MAL.ORGEXGOFC,
      MAL.DSTEXGOFC,
      MAL.SCNPRT,
      MAL.ORGCOD,
      MAL.REQDLVTIM,
      MAL.CSGDOCNUM,
      MAL.MALSTA,
      MAL.MALSRVLVL,
      MAL.DSTCOD,
      MAL.ONNTIMDLVFLG,
      MAL.MALSEQNUM,
      MAL.DSPDAT,
      MAL.CMPCOD,
	  MAL.POACOD,
      CASE
        WHEN EXISTS
          (SELECT 1
          FROM MALRDT HIS2
          WHERE EVTCOD      ='74'
          AND MAL.MALSEQNUM = HIS2.MALSEQNUM
          AND MAL.CMPCOD    = HIS2.CMPCOD
          AND (HIS2.EVTPRT  = MAL.ORGCOD
          OR EXISTS
            (SELECT ARPCOD
            FROM MALCTSARP CTS
            WHERE MAL.CMPCOD                 =CTS.CMPCOD
            AND CTS.RSDMOD                   ='74'
            AND MAL.POACOD                   =CTS.GPACOD
			AND MAL.DSPDAT BETWEEN CTS.VLDFRMDAT AND CTS.VLDTOODAT
            AND INSTR(CTS.ARPCOD,MAL.ORGCOD) >0
            AND INSTR(CTS.ARPCOD,HIS2.EVTPRT)>0
            ))
          )
        THEN 'N'
        ELSE'Y'
      END MISORGSCAN,
      CASE
        WHEN EXISTS
          (SELECT 1
          FROM MALHIS HIS2
          WHERE MALSTA      ='DLV'
          AND MAL.MALSEQNUM = HIS2.MALSEQNUM
          AND MAL.CMPCOD    = HIS2.CMPCOD
          AND (HIS2.SCNPRT  = MAL.DSTCOD
          OR EXISTS
            (SELECT ARPCOD
            FROM MALCTSARP CTS
            WHERE MAL.CMPCOD                 =CTS.CMPCOD
            AND CTS.RSDMOD                   ='21'
            AND MAL.POACOD                   =CTS.GPACOD
			AND MAL.DSPDAT BETWEEN CTS.VLDFRMDAT AND CTS.VLDTOODAT
            AND INSTR(CTS.ARPCOD,MAL.DSTCOD) >0
            AND INSTR(CTS.ARPCOD,HIS2.SCNPRT)>0
            ))
          )
        THEN 'N'
        ELSE 'Y'
      END MISDLVSCAN,
      (SELECT HIS2.SCNDAT
      FROM MALHIS HIS2
      WHERE MALSTA      ='DLV'
      AND MAL.MALSEQNUM = HIS2.MALSEQNUM
      AND MAL.CMPCOD    = HIS2.CMPCOD
      AND (HIS2.SCNPRT  = MAL.DSTCOD
      OR EXISTS
        (SELECT ARPCOD
        FROM MALCTSARP CTS
        WHERE MAL.CMPCOD                 =CTS.CMPCOD
        AND CTS.RSDMOD                   ='21'
        AND MAL.POACOD                   =CTS.GPACOD
		AND MAL.DSPDAT BETWEEN CTS.VLDFRMDAT AND CTS.VLDTOODAT
        AND INSTR(CTS.ARPCOD,MAL.DSTCOD) >0
        AND INSTR(CTS.ARPCOD,HIS2.SCNPRT)>0
        ))
      ) SCNDAT,
      FORCEMJR.FORMJRSTA
	  FROM MALMST MAL
    LEFT OUTER JOIN MALFORMJRREQMST FORCEMJR
  ON MAL.MALSEQNUM   = FORCEMJR.MALSEQNUM
  AND MAL.CMPCOD     = FORCEMJR.CMPCOD
	WHERE MAL.MALSTA <> 'NEW'
]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>315</QRY:Id>
<QRY:Source Name="mail.operations.findMailbagForPABuiltContainer" Type="NATIVE">
<![CDATA[
SELECT  MST.CMPCOD,MST.MALIDR,MST.MALSEQNUM,MST.CONNUM,DTL.MALJNRIDR,CSGMST.CSGDAT,MST.WGT,MST.POU,MST.MALCLS,MST.ORGCOD,MST.DSTCOD,MST.ORGEXGOFC,
MST.DSTEXGOFC,MST.MALCTG,MST.MALSUBCLS,MST.FLTCARIDR,MST.FLTNUM,MST.FLTSEQNUM,MST.SEGSERNUM,MST.CSGSEQNUM,MST.CSGDOCNUM
FROM   MALCSGMST CSGMST INNER JOIN MALCSGDTL DTL
ON CSGMST.CMPCOD=DTL.CMPCOD
AND CSGMST.POACOD=DTL.POACOD
AND CSGMST.CSGDOCNUM=DTL.CSGDOCNUM
AND CSGMST.CSGSEQNUM=DTL.CSGSEQNUM
INNER JOIN MALMST MST ON
DTL.CMPCOD=MST.CMPCOD
AND DTL.MALSEQNUM=MST.MALSEQNUM
AND DTL.CSGDOCNUM=MST.CSGDOCNUM
AND DTL.CSGSEQNUM=MST.CSGSEQNUM
AND DTL.ULDNUM=MST.CONNUM
WHERE
 MST.MALSTA='NEW'
AND  MST.CMPCOD=?
AND DTL.ULDNUM=?     

]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>316</QRY:Id>
<QRY:Source Name="mail.operations.findcontainerinfofordeviatedmailbag" Type="NATIVE">
	<![CDATA[
		SELECT
			ULDSEGDTL.CONNUM,
			FLTCON.CONTYP
		FROM
			MALULDSEGDTL ULDSEGDTL,
			MALULDSEG ULDSEG,
			MALFLTSEG FLTSEG,
			MALFLTCON FLTCON
		WHERE
			ULDSEG.CMPCOD = ULDSEGDTL.CMPCOD
			AND ULDSEG.FLTCARIDR = ULDSEGDTL.FLTCARIDR
			AND ULDSEG.FLTNUM = ULDSEGDTL.FLTNUM
			AND ULDSEG.FLTSEQNUM = ULDSEGDTL.FLTSEQNUM
			AND ULDSEG.ULDNUM = ULDSEGDTL.ULDNUM
			AND ULDSEG.SEGSERNUM = ULDSEGDTL.SEGSERNUM
			AND FLTSEG.CMPCOD = ULDSEG.CMPCOD
			AND FLTSEG.FLTCARIDR = ULDSEG.FLTCARIDR
			AND FLTSEG.FLTNUM = ULDSEG.FLTNUM
			AND FLTSEG.FLTSEQNUM = ULDSEG.FLTSEQNUM
			AND FLTCON.CMPCOD = FLTSEG.CMPCOD
			AND FLTCON.FLTCARIDR = FLTSEG.FLTCARIDR
			AND FLTCON.FLTNUM = FLTSEG.FLTNUM
			AND FLTCON.FLTSEQNUM = FLTSEG.FLTSEQNUM
			AND FLTCON.CONNUM = ULDSEG.ULDNUM
			AND ULDSEG.SEGSERNUM = FLTSEG.SEGSERNUM
			AND ULDSEGDTL.CMPCOD  =  ?
			AND ULDSEGDTL.MALSEQNUM = ?
			AND FLTSEG.POU =  ?
      

]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
	<QRY:Id>501</QRY:Id>
		<QRY:Source Name="mail.operations.findflightassignedmailsinuldinboundforreact" Type="NATIVE">
			<![CDATA[
						SELECT CON.CMPCOD,
					  CON.FLTCARIDR,
					  CON.FLTNUM,
					  CON.CONNUM,
					  CON.FLTSEQNUM,
					  CON.LEGSERNUM,
					  CON.ASGPRT,
					  CON.CONTYP,
					  CON.SEGSERNUM,
					  CON.CNTIDR,
					  CON.POU,
					  CON.POAFLG,
					  MALMST.MALSRVLVL MALSRVLVL,
					  MALMST.ORGCOD ORGCOD,
					  MALMST.DSTCOD DSTCOD,
					  MALMST.DSN,
					  MALMST.ORGEXGOFC,
					  MALMST.DSTEXGOFC,
					  MALMST.YER,
					  MALMST.MALCTG MALCTGCOD,
					  MALMST.MALSUBCLS,
					  MALMST.RSN,
					  MALMST.HSN,
					  MALMST.REGIND,
					  MALMST.MALCLS,
					  MALMST.MALTYP,
					  MALMST.MALRMK,
					  MALMST.WGT,
					  MALMST.DSPWGT,
					  MALMST.DSPWGTUNT,
					  MALMST.CSGDOCNUM CSGDOCNUM,
					  MALMST.CSGSEQNUM CSGSEQNUM,
					  MALMST.POACOD POACOD,
					  CSGMST.CSGDAT CSGDAT,
					  MALMST.DSPDAT ACPDAT,
					  MALSEG.ACPWGT CSGACPWGT,
					  MALSEG.ACPBAG CSGACPBAG,
					  MALSEG.STDBAG CSGSTDBAG,
					  MALSEG.STDWGT CSGSTDWGT,
					  NULL ACPUSR,
					  MALMST.MALIDR MALIDR,
					  MALMST.MALSEQNUM MALSEQNUM,
					  MALSEG.DMGFLG DMGFLG,
					  MALMST.SELNUM,
					  MALSEG.ARRSELNUM,
					  MALSEG.FRMCARCOD MALFRMCARCOD,
					  MALMST.VOL,
					  MALMST.VOLUNT,
					  0 STDVOL,
					  0 ACPVOL,
					  MALMST.CSGDOCNUM MALCSGDOCNUM,
					  MALMST.CSGSEQNUM MALCSGDOCSEQ,
					  MALMST.POACOD MALPOACOD,
					  MALMST.MALCMPCOD MALCMPCOD,
					  MALMST.SCNPRT SCNPRT,
					  MALMST.MALSTA MALSTA,
					  MALMST.OPRSTA OPRSTA,
					  CASE
						WHEN EXISTS
						  (SELECT 1
						  FROM MALHIS HIS
						  WHERE HIS.CMPCOD = MALMST.CMPCOD
						  AND HIS.MALSEQNUM=MALMST.MALSEQNUM
						  AND HIS.MALSTA  IN ('ARR')
						  )
						THEN 'Y'
						ELSE 'N'
					  END ARRSTA,
					  DMGMAL.DMGCOD,
					  DMGMAL.DMGDAT,
					  DMGMAL.ARPCOD,
					  DMGMAL.DMGDES,
					  DMGMAL.RMK,
					  MALMST.SCNDAT SCNDAT,
					  MALMST.LSTUPDTIM MALLSTUPDTIM,
					  NULL BLYCRTIDR,
					  MALSEG.RCVBAG,
					  MALSEG.DLVBAG
					FROM MALFLTCON CON
					INNER JOIN MALULDSEGDTL MALSEG
					ON CON.CMPCOD     = MALSEG.CMPCOD
					AND CON.FLTCARIDR = MALSEG.FLTCARIDR
					AND CON.FLTNUM    = MALSEG.FLTNUM
					AND CON.FLTSEQNUM = MALSEG.FLTSEQNUM
					AND CON.SEGSERNUM = MALSEG.SEGSERNUM
					AND CON.CONNUM    = MALSEG.ULDNUM
					AND MALSEG.ARRSTA = 'Y'
					LEFT OUTER JOIN MALMST MALMST
					ON MALSEG.MALSEQNUM = MALMST.MALSEQNUM
					AND MALSEG.CMPCOD   = MALMST.CMPCOD
					LEFT OUTER JOIN MALDMGDTL DMGMAL
					ON MALMST.MALSEQNUM = DMGMAL.MALSEQNUM
					AND MALMST.CMPCOD   = DMGMAL.CMPCOD
					LEFT OUTER JOIN MALCSGMST CSGMST
					ON CSGMST.CMPCOD     = MALMST.CMPCOD
					AND CSGMST.CSGDOCNUM = MALMST.CSGDOCNUM
					AND CSGMST.POACOD    = MALMST.POACOD
					AND CSGMST.CSGSEQNUM = MALMST.CSGSEQNUM
					WHERE CON.CMPCOD    = ?
					AND CON.FLTCARIDR   = ?
					AND CON.FLTNUM      = ?
					AND CON.FLTSEQNUM   = ?
					AND CON.LEGSERNUM   = ?
					AND CON.ASGPRT      = ?
					AND CON.CONNUM      = ?
					AND CON.CONTYP      = 'U'
					ORDER BY DSN,
					  ORGEXGOFC,
					  DSTEXGOFC,
					  YER,
					  MALCTGCOD,
					  MALSUBCLS,
					  CSGDOCNUM,
					  CSGSEQNUM,
					  POACOD
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	
	<QRY:Id>502</QRY:Id>
		<QRY:Source Name="mail.operations.findflightassignedmailsinbulkinboundforreact" Type="OBJECT">
			<![CDATA[
					SELECT CON.CMPCOD,
					CON.FLTCARIDR,
					CON.FLTNUM,
					CON.CONNUM,
					CON.FLTSEQNUM,
					CON.LEGSERNUM,
					CON.ASGPRT,
					CON.CONTYP,
					CON.SEGSERNUM,
					CON.CNTIDR,
					CON.POU,
					CON.POAFLG,
					MALMST.MALSRVLVL MALSRVLVL,
					MALMST.ORGCOD ORGCOD,
					MALMST.DSTCOD DSTCOD,
					MALMST.DSN,
					MALMST.ORGEXGOFC,
					MALMST.DSTEXGOFC,
					MALMST.YER,
					MALMST.MALCTG MALCTGCOD,
					MALMST.MALSUBCLS,
					MALMST.MALCLS,
					MALMST.RSN,
					MALMST.HSN,
					MALMST.REGIND,
					MALMST.MALTYP,
					MALMST.MALRMK,
					MALMST.WGT,
					MALMST.DSPWGT,
					MALMST.DSPWGTUNT,
					MALMST.CSGDOCNUM CSGDOCNUM,
					MALMST.CSGSEQNUM CSGSEQNUM,
					MALMST.POACOD POACOD,
					CSGMST.CSGDAT CSGDAT,
					MALMST.DSPDAT ACPDAT,
					MALSEG.ACPWGT CSGACPWGT,
					MALSEG.ACPBAG CSGACPBAG,
					MALSEG.STDBAG CSGSTDBAG,
					MALSEG.STDWGT CSGSTDWGT,
					NULL ACPUSR,
					MALMST.MALIDR MALIDR,
					MALMST.MALSEQNUM MALSEQNUM,
					MALSEG.DMGFLG DMGFLG,
					MALMST.SELNUM,
					MALSEG.ARRSELNUM,
					MALSEG.FRMCARCOD MALFRMCARCOD,
					MALMST.VOL,
					MALMST.VOLUNT,
					0 STDVOL,
					0 ACPVOL,
					MALMST.CSGDOCNUM MALCSGDOCNUM,
					MALMST.CSGSEQNUM MALCSGDOCSEQ,
					MALMST.POACOD MALPOACOD,
					MALMST.MALCMPCOD MALCMPCOD,
					MALMST.SCNPRT SCNPRT,
					MALMST.MALSTA MALSTA,
					MALMST.OPRSTA OPRSTA,
					CASE
					WHEN EXISTS
					(SELECT 1
					FROM MALHIS HIS
					WHERE HIS.CMPCOD  = MALMST.CMPCOD
					AND HIS.MALSEQNUM = MALMST.MALSEQNUM
					AND HIS.MALSTA   IN ('ARR')
					)
					THEN 'Y'
					ELSE 'N'
					END ARRSTA,
					DMGMAL.DMGCOD,
					DMGMAL.DMGDAT,
					DMGMAL.ARPCOD,
					DMGMAL.DMGDES,
					DMGMAL.RMK,
					MALMST.SCNDAT SCNDAT,
					MALMST.LSTUPDTIM MALLSTUPDTIM,
					NULL BLYCRTIDR
					FROM MALFLTCON CON
					LEFT OUTER JOIN MALULDSEGDTL MALSEG
					ON CON.CMPCOD     = MALSEG.CMPCOD
					AND CON.FLTCARIDR = MALSEG.FLTCARIDR
					AND CON.FLTNUM    = MALSEG.FLTNUM
					AND CON.FLTSEQNUM = MALSEG.FLTSEQNUM
					AND CON.SEGSERNUM = MALSEG.SEGSERNUM
					AND CON.CONNUM    = MALSEG.CONNUM
					AND MALSEG.ARRSTA = 'Y'
					LEFT OUTER JOIN MALMST MALMST
					ON MALSEG.CMPCOD    =MALMST.CMPCOD
					AND MALSEG.MALSEQNUM=MALMST.MALSEQNUM
					LEFT OUTER JOIN MALDMGDTL DMGMAL
					ON MALMST.CMPCOD     = DMGMAL.CMPCOD
					AND MALMST.MALSEQNUM = DMGMAL.MALSEQNUM
					LEFT OUTER JOIN MALCSGMST CSGMST
					ON CSGMST.CMPCOD     = MALMST.CMPCOD
					AND CSGMST.CSGDOCNUM = MALMST.CSGDOCNUM
					AND CSGMST.POACOD    = MALMST.POACOD
					AND CSGMST.CSGSEQNUM = MALMST.CSGSEQNUM
					WHERE CON.CMPCOD     = ?
					AND CON.FLTCARIDR    = ?
					AND CON.FLTNUM       = ?
					AND CON.FLTSEQNUM    = ?
					AND CON.LEGSERNUM    = ?
					AND CON.ASGPRT       = ?
					AND CON.CONNUM       = ?
					AND CON.CONTYP       = 'B'
					ORDER BY DSN,
					ORGEXGOFC,
					DSTEXGOFC,
					YER,
					MALCTGCOD,
					MALSUBCLS,
					CSGDOCNUM,
					CSGSEQNUM,
					POACOD
			]]>
		</QRY:Source>
	</QRY:Definition>


	<QRY:Definition>
		<QRY:Id>503</QRY:Id>
		<QRY:Source Name="mail.operations.findmailsinstorageunit" Type="OBJECT">
			<![CDATA[
						SELECT * FROM MALMST MST WHERE CMPCOD = 'DNAE' AND MALSTA = 'ARR' AND STGUNT = ?
			]]>
		</QRY:Source>
	</QRY:Definition>


<QRY:Definition>
	<QRY:Id>317</QRY:Id>
	<QRY:Source Name="mail.operations.findApprovedForceMajeureDetails" Type="NATIVE">
		<![CDATA[
			SELECT REQMST.CMPCOD,
			  REQMST.MALIDR,
			  REQMST.FLTCARCOD,
			  REQMST.ARPCOD SCNPRT,
			  REQMST.FORMJRIDR,
			  REQMST.FORMJRSTA,
			  REQMST.LODSCNFRCMJRFLG,
			  REQMST.RCVSCNFRCMJRFLG,
			  REQMST.DLVSCNFRCMJRFLG,
			  REQMST.LATDLVFRCMJRFLG,
			  REQMST.ALLSCNFRCMJRFLG
			FROM MALFORMJRREQMST REQMST
			WHERE REQMST.FORMJRSTA='APR'
            AND REQMST.CMPCOD =?

		]]>
	</QRY:Source>
	</QRY:Definition>

	
	<QRY:Definition>
	<QRY:Id>318</QRY:Id>
	<QRY:Source Name="mail.operations.findmailDetails" Type="NATIVE">
		<![CDATA[
		
		select 
  DISTINCT
    cmpcod,
    malidr,
    orgexgofc,
    dstexgofc,
    yer,
    dsn,
    rsn,
    hsn,
    regind,
    malcls,
     malctgcod,
    malsubcls,
    scnprt,
    scndat,
    connum,
    scnusr,
    malsta,
    oprsta,
    contyp,
    pou,
    wgt,
    dspwgt,
    dspwgtunt,
    csgdocnum,
    csgseqnum,
    poacod,
    dmgflg,
    lstupdtim,
    reqdlvtim,
    mstdocnum,
    shppfx,
    malseqnum,
    orgcod,
    dstcod,
    actwgt,
    actwgtdsp,
    actwgtdspunt,
    malsrvlvl,
    onntimdlvflg,
    vol,
    volunt,
    trpsrvendtim,
    fltcaridr,
    fltnum,
    fltseqnum,
    segsernum,
    fltcarcod,
    fltdat,
    poaflg,
    legsernum,
     arrsta,
    pol,
    traflg,
	ROW_NUMBER() OVER (ORDER BY NULL) AS RNK	   
from (
SELECT DISTINCT
    mst.cmpcod,
    mst.malidr,
    mst.orgexgofc,
    mst.dstexgofc,
    mst.yer,
    mst.dsn,
    mst.rsn,
    mst.hsn,
    mst.regind,
    mst.malcls,
    mst.malctg malctgcod,
    mst.malsubcls,
    his.scnprt,
    his.scndat,
    COALESCE(segdtl.connum,mst.connum) connum,
    his.scnusr,
    mst.malsta,
    mst.oprsta,
    his.contyp,
    his.pou,
    mst.wgt,
    mst.dspwgt,
    mst.dspwgtunt,
    mst.csgdocnum,
    mst.csgseqnum,
    mst.poacod,
    mst.dmgflg,
    mst.lstupdtim,
    mst.reqdlvtim,
    mst.mstdocnum,
    mst.shppfx,
    mst.malseqnum,
    mst.orgcod,
    mst.dstcod,
    mst.actwgt,
    mst.actwgtdsp,
    mst.actwgtdspunt,
    mst.malsrvlvl,
    mst.onntimdlvflg,
    mst.vol,
    mst.volunt,
    mst.trpsrvendtim,
    segdtl.fltcaridr,
    segdtl.fltnum,
    segdtl.fltseqnum,
    segdtl.segsernum,
    his.fltcarcod,
    his.fltdat,
    mst.poaflg,
    conmst.legsernum AS legsernum,
    segdtl.arrsta AS arrsta,
    seg.pol AS pol,
    (
        SELECT DISTINCT
            'Y'
        FROM
            malhis
        WHERE
            malseqnum = mst.malseqnum
            AND cmpcod = mst.cmpcod
            AND scnprt = his.scnprt
            AND malsta = 'TRA'
    ) AS traflg,

     MAX(utcscndat) over(partition by his.cmpcod,his.malseqnum) maxutcscndat,
    utcscndat

FROM
     malhis his
    INNER JOIN  malmst mst ON  mst.cmpcod = his.cmpcod
                             AND mst.malseqnum = his.malseqnum
                             AND mst.malsta <> 'NEW'
                             AND coalesce(mst.malsrc,'N') <> 'FORCEACP'
                             and   his.malsta IN (
        'ARR',
        'DLV',
        'ACP',
        'NEW',
        'TRA',
        'OFL',
        'DMG',
        'CAN',
        'ASG',
        'BKD',
        'RTN',
		'HDR'
  )

    LEFT OUTER JOIN maluldsegdtl segdtl ON segdtl.cmpcod = his.cmpcod
                                           AND segdtl.malseqnum = his.malseqnum
                                           AND segdtl.fltnum = his.fltnum
                                           AND segdtl.fltcaridr = his.fltcaridr
                                           AND segdtl.fltseqnum = his.fltseqnum
                                           AND segdtl.segsernum = his.segsernum
    LEFT OUTER JOIN malfltseg seg ON segdtl.fltcaridr = seg.fltcaridr
                                     AND segdtl.fltnum = seg.fltnum
                                     AND segdtl.fltseqnum = seg.fltseqnum
                                     AND segdtl.segsernum = seg.segsernum
                                     AND segdtl.cmpcod = seg.cmpcod
    LEFT OUTER JOIN malfltcon conmst ON segdtl.fltcaridr = conmst.fltcaridr
                                        AND segdtl.fltnum = conmst.fltnum
                                        AND segdtl.fltseqnum = conmst.fltseqnum
                                        AND segdtl.connum = conmst.connum
                                        AND segdtl.cmpcod = conmst.cmpcod
                                        AND segdtl.segsernum = conmst.segsernum
		]]>
	</QRY:Source>
	</QRY:Definition>



	
	<QRY:Definition>
	<QRY:Id>319</QRY:Id>
	<QRY:Source Name="mail.operations.findMailBoxForPA" Type="NATIVE">
		<![CDATA[
			SELECT MAX(MALBOXIDR) MALBOXIDR
			FROM MALMALBOX MALBOX
			WHERE MALBOX.CMPCOD =?
			AND MALBOX.MALBOXOWR=?
			AND MALBOX.MALBOXOWRTYP='PA'
		]]>
	</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>320</QRY:Id>
	<QRY:Source Name="mail.operations.findNotupliftedMailsInCarrierforDeviationlist" Type="NATIVE">
		<![CDATA[

		   SELECT
			MALULD.CMPCOD,
			MALULD.ARPCOD,
			MALULD.FLTCARIDR,
			MALULD.ULDNUM,
			ULD.FLTCARCOD,
			MST.MALIDR
		FROM
			MALARPULDDTL MALULD,
			MALARPULD ULD,
			MALMST MST
		WHERE
			MALULD.CMPCOD = ULD.CMPCOD
			AND MALULD.ARPCOD = ULD.ARPCOD
			AND MALULD.ULDNUM = ULD.ULDNUM
			AND MST.CMPCOD = MALULD.CMPCOD
			AND MST.MALSEQNUM = MALULD.MALSEQNUM
			AND MALULD.CMPCOD = ?
			AND MALULD.ARPCOD = ?
			AND MALULD.MALSEQNUM = ?
	]]>
	</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>321</QRY:Id>
	<QRY:Source Name="mail.operations.getmanifestinfofornextsegment" Type="NATIVE">
		<![CDATA[
			SELECT
            DTL.CMPCOD,
            DTL.FLTCARIDR,
            DTL.FLTNUM,
            DTL.ULDNUM,
            DTL.FLTSEQNUM,
            DTL.SEGSERNUM,
            DTL.ACPSTA,
            CON.ASGPRT,
            CON.CONTYP,
            LEG.LEGSERNUM
            FROM MALMST MST
            INNER JOIN MALULDSEGDTL DTL
            ON MST.CMPCOD    =DTL.CMPCOD
            AND MST.MALSEQNUM=DTL.MALSEQNUM
            LEFT OUTER JOIN FLTOPRSEG SEG
            ON DTL.CMPCOD     = SEG.CMPCOD
            AND DTL.FLTNUM = SEG.FLTNUM
            AND DTL.FLTCARIDR = SEG.FLTCARIDR
            AND DTL.FLTSEQNUM = SEG.FLTSEQNUM
            AND DTL.SEGSERNUM = SEG.SEGSERNUM
            LEFT OUTER JOIN FLTOPRLEG LEG ON LEG.CMPCOD = SEG.CMPCOD
                                     AND LEG.FLTNUM = SEG.FLTNUM
                                     AND LEG.FLTCARIDR = SEG.FLTCARIDR
                                     AND LEG.FLTSEQNUM = SEG.FLTSEQNUM
                                     AND LEG.LEGORG = SEG.SEGORG
            LEFT OUTER JOIN MALFLTCON CON
            ON DTL.CMPCOD     =CON.CMPCOD
            AND DTL.FLTCARIDR =CON.FLTCARIDR
            AND DTL.FLTNUM    =CON.FLTNUM
            AND DTL.FLTSEQNUM =CON.FLTSEQNUM
            AND DTL.SEGSERNUM =CON.SEGSERNUM
            AND DTL.CONNUM    =CON.CONNUM
            WHERE MST.CMPCOD = ?
            AND MST.MALSEQNUM = ?
            AND SEG.SEGORG = ?
	]]>
	</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>322</QRY:Id>
	<QRY:Source Name="mail.operations.checkMailbagInContainerAlreadyUsedInNextSegment" Type="NATIVE">
		<![CDATA[
			SELECT
                CASE
                WHEN MAX(FLTSEG.CMPCOD) IS NULL
                AND MAX(ARPULD.CMPCOD)  IS NULL
                THEN 'N'
                ELSE 'Y'
                END MALEXT
                FROM MALFLTCON FLTCON
                INNER JOIN MALULDSEG ULDSEG
                ON ULDSEG.CMPCOD    =FLTCON.CMPCOD
                AND ULDSEG.FLTCARIDR=FLTCON.FLTCARIDR
                AND ULDSEG.FLTNUM   =FLTCON.FLTNUM
                AND ULDSEG.FLTSEQNUM=FLTCON.FLTSEQNUM
                AND ULDSEG.SEGSERNUM=FLTCON.SEGSERNUM
                AND ULDSEG.ULDNUM   =FLTCON.CONNUM
                INNER JOIN MALULDSEGDTL DTL
                ON DTL.CMPCOD    =FLTCON.CMPCOD
                AND DTL.FLTNUM   =FLTCON.FLTNUM
                AND DTL.FLTCARIDR=FLTCON.FLTCARIDR
                AND DTL.FLTSEQNUM=FLTCON.FLTSEQNUM
                AND DTL.SEGSERNUM=FLTCON.SEGSERNUM
                AND DTL.ULDNUM   =FLTCON.CONNUM
                LEFT OUTER JOIN MALARPULDDTL ARPULD
                ON ARPULD.CMPCOD    =DTL.CMPCOD
                AND ARPULD.MALSEQNUM=DTL.MALSEQNUM
                AND ARPULD.ARPCOD   =?
				AND ARPULD.CONNUM NOT LIKE '%BULK-ARR%'
                AND ARPULD.ULDNUM NOT LIKE '%BULK-ARR%'
                LEFT OUTER JOIN MALULDSEGDTL DTLTMP
                ON DTLTMP.CMPCOD    =DTL.CMPCOD
                AND DTLTMP.MALSEQNUM=DTL.MALSEQNUM
                LEFT OUTER JOIN MALFLTSEG FLTSEG
                ON FLTSEG.CMPCOD    =DTLTMP.CMPCOD
                AND FLTSEG.FLTCARIDR=DTLTMP.FLTCARIDR
                AND FLTSEG.FLTNUM   =DTLTMP.FLTNUM
                AND FLTSEG.FLTSEQNUM=DTLTMP.FLTSEQNUM
                AND FLTSEG.SEGSERNUM=DTLTMP.SEGSERNUM
                AND FLTSEG.POL      =?
                WHERE
				FLTCON.CMPCOD =?
                AND FLTCON.CONNUM =?
                AND FLTCON.TRNFLG='Y'
	]]>
	</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>323</QRY:Id>
	<QRY:Source Name="mail.operations.findTransferManifestConsignmentDetails" Type="NATIVE">
		<![CDATA[
			SELECT DISTINCT
				CSGMST.CSGDOCNUM,
				CSGMST.POACOD,
				CSGMST.CMPCOD
			FROM
				MALTRFMFT TRFMST
				INNER JOIN MALTRFMFTDTL TRFDTL ON TRFMST.CMPCOD = TRFDTL.CMPCOD
												  AND TRFMST.TRFMFTIDR = TRFDTL.TRFMFTIDR
				INNER JOIN MALMST MAL ON MAL.CMPCOD = TRFDTL.CMPCOD
											  AND MAL.MALSEQNUM = TRFDTL.MALSEQNUM
				INNER JOIN MALCSGMST CSGMST ON CSGMST.CMPCOD = MAL.CMPCOD
													AND CSGMST.CSGDOCNUM = MAL.CSGDOCNUM
													AND CSGMST.POACOD = MAL.POACOD
			WHERE
			    CSGMST.CSGDOCNUM is not null
				AND TRFMST.CMPCOD = ?
				AND TRFMST.TRFMFTIDR = ?
	]]>
	</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>320</QRY:Id>
	<QRY:Source Name="mail.operations.findConsignmentScreeningDetails" Type="NATIVE">
	<![CDATA[
		SELECT
    mst.cmpcod,
    dtl.stdbag,
    mst.stdbag      bag,
    dtl.stdwgt,
    mst.stdwgt      wgt,
    dtl.secstapty,
    dtl.secstadat,
    dtl.adlsecinf,
    dtl.rmk,
    mst.secstacod,
    dtl.aplregtrpdir,
    dtl.aplregbrdagyaut,
    dtl.aplregrefidr,
    dtl.aplregflg,
    dtl.scrloc,
    dtl.secscrmthcod,
    dtl.scraplaut,
    dtl.scraplreg,
    dtl.scrdtltyp,
    dtl.sernum,
    dtl.scrres,
    dtl.csgsrc,
    mst.csgdocnum,
    mst.csgseqnum,
    mst.poacod,
    mst.csgdat,
    mst.csgorg,
    mst.csgdst,
    poa.cntcod,
    rtg.fltcarcod,
    rtg.pol,
    rtg.pou,
    rtg.rtgsernum,
    (
        SELECT
            MAX(malctg)
        FROM
            malmst mal
        WHERE
            mal.cmpcod = mst.cmpcod
            AND mal.csgdocnum = mst.csgdocnum
        GROUP BY
            mal.cmpcod,
            mal.csgdocnum
    ) malctg,
    dtl.agttyp,
    dtl.cntcod      isocntcode,
    dtl.agtidr,
    dtl.expdat,
    dtl.scersncod,
    dtl.sceaplaut,
    dtl.sceaplreg,
    mst.csgisrnam,
    mst.adlsecinf   mstadlsecinf
FROM
    malcsgmst mst
    INNER JOIN malpoamst poa ON poa.cmpcod = mst.cmpcod
                                AND poa.poacod = mst.poacod
    LEFT OUTER JOIN malcsgcsddtl dtl ON mst.cmpcod = dtl.cmpcod
                                        AND mst.csgdocnum = dtl.csgdocnum
                                        AND mst.csgseqnum = dtl.csgseqnum
    									AND dtl.scrlvl = 'C'
LEFT OUTER JOIN malcsgrtg rtg ON mst.cmpcod = rtg.cmpcod
                                     AND mst.csgdocnum = rtg.csgdocnum
                                     AND mst.csgseqnum = rtg.csgseqnum
WHERE
    mst.cmpcod = ?
    AND mst.csgdocnum = ?
AND mst.poacod = ?
UNION ALL
SELECT
    mst.cmpcod,
    dtl.stdbag,
    csg.stdbag      bag,
    dtl.stdwgt,
    csg.stdwgt      wgt,
    dtl.secstapty,
    dtl.secstadat,
    dtl.adlsecinf,
    dtl.rmk,
    mst.secstacod,
    dtl.aplregtrpdir,
    dtl.aplregbrdagyaut,
    dtl.aplregrefidr,
    dtl.aplregflg,
    dtl.scrloc,
    dtl.secscrmthcod,
    dtl.scraplaut,
    dtl.scraplreg,
    dtl.scrdtltyp,
    dtl.sernum,
    dtl.scrres,
    dtl.csgsrc,
    mst.csgdocnum,
    mst.csgseqnum,
    mst.poacod,
    csg.csgdat,
    csg.csgorg,
    csg.csgdst,
    poa.cntcod,
    rtg.fltcarcod,
    rtg.pol,
    rtg.pou,
    rtg.rtgsernum,
    mst.malctg,
    dtl.agttyp,
    dtl.cntcod      isocntcode,
    dtl.agtidr,
    dtl.expdat,
    dtl.scersncod,
    dtl.sceaplaut,
    dtl.sceaplreg,
    csg.csgisrnam   csgisrnam,
    csg.adlsecinf   adlsecinf
FROM
    malmst mst
    INNER JOIN malcsgmst csg ON mst.cmpcod = csg.cmpcod
                                AND mst.csgdocnum = csg.csgdocnum
                                AND mst.csgseqnum = csg.csgseqnum
    INNER JOIN malpoamst poa ON poa.cmpcod = mst.cmpcod
                                AND poa.poacod = mst.poacod
    LEFT OUTER JOIN malcsgcsddtl dtl ON mst.cmpcod = dtl.cmpcod
                                        AND mst.MALSEQNUM = dtl.MALSEQNUM
                                        AND dtl.scrlvl = 'M'
    LEFT OUTER JOIN malcsgrtg rtg ON csg.cmpcod = rtg.cmpcod
                                     AND csg.csgdocnum = rtg.csgdocnum
                                     AND csg.csgseqnum = rtg.csgseqnum
WHERE
    csg.cmpcod = ?
    AND csg.csgdocnum = ?
	]]>
	</QRY:Source>
	</QRY:Definition>





	<QRY:Definition>
		<QRY:Id>318</QRY:Id>
		<QRY:Source Name="postgres.mail.operations.findoutboundflightdetailsforuld" Type="NATIVE">
			<![CDATA[
		 GROUP BY MALMST.CMPCOD,TRT.FLTCARIDR,TRT.FLTNUM,TRT.FLTSEQNUM,CSGDTL.ULDNUM   ORDER BY  MALMST.CMPCOD,TRT.FLTCARIDR,TRT.FLTNUM,TRT.FLTSEQNUM,CSGDTL.ULDNUM)
SELECT CMPCOD,
  ARPCOD,
  FLTCARIDR,
  FLTNUM,
  FLTSEQNUM,
  FLTDAT,
  LEGSERNUM,
  FLTROU,
  FLTORG,
  FLTDST,
  FLTTYP,
  FLTSTA,
  ACRTYP,
  LEGORG,
  EXPCLSFLG,
  DEPGTE,
  FLTDATPREFIX,
LISTAGG(CONNAM,',') within group (order by connam) CONNAM ,
DEPTIM,
LISTAGG(CONCNT,',') within group (order by connam) CONCNT ,
LISTAGG(MALCNT,',') within group (order by connam) MALCNT ,
LISTAGG(wgt,',') within group (order by connam) wgt,
MAX(RCPWGT) RCPWGT,
MAX(RCPIDRCNT) RCPIDRCNT,
MAX(DCSSTA)DCSSTA,
MAX(DCSREJRSN) DCSREJRSN
from
(SELECT CMPCOD,
  ARPCOD,
  FLTCARIDR,
  FLTNUM,
  FLTSEQNUM,
  FLTDAT,
  LEGSERNUM,
  FLTROU,
  FLTORG,
  FLTDST,
  FLTTYP,
  FLTSTA,
  ACRTYP,
  LEGORG,
  EXPCLSFLG,
  DEPGTE,
  ARVGTE,
connam,
  DEPTIM,
COUNT(distinct CONNUM) CONCNT,
  (COUNT(MALSEQNUM)  )MALCNT,
(SUM(WGT))WGT,
 MAX(RCPWGT) RCPWGT,
 MAX(RCPIDRCNT)RCPIDRCNT,
FLTDATPREFIX,
 MAX(DCSSTA) DCSSTA,
 MAX(DCSREJRSN) DCSREJRSN
FROM
( (SELECT FLTMST.CMPCOD,
    MALFLT.ARPCOD,
  --  MALFLT.FLTCARCOD,
    FLTMST.FLTCARIDR,
    FLTMST.FLTNUM,
    FLTMST.FLTSEQNUM,
    FLTMST.FLTDAT,
    MALFLT.LEGSERNUM,
    FLTMST.FLTROU,
    FLTMST.FLTORG,
    FLTMST.FLTDST,
    FLTMST.FLTTYP,
    FLTMST.FLTSTA,
    FLTLEG.ACRTYP,
	FLTLEG.LEGORG,
    FLTLEG.DEPGTE,
	FLTLEG.ARVGTE,
    FLTCON.CONNUM,
    COALESCE(MALFLT.EXPCLSFLG,'N') EXPCLSFLG,
    COALESCE(MALMST.WGT,0) WGT,
    SUBSTR(FLTCON.CONNUM,1,3) CONNAM,
    MALMST.MALSEQNUM,
     COALESCE(FLTLEG.ATD,
    FLTLEG.ETD,
    FLTLEG.STD)DEPTIM,
                    (
    CASE
      WHEN FLTLEG.ATD IS NOT NULL
      THEN 'A'
      ELSE (CASE
           WHEN FLTLEG.ETD IS NOT NULL
           THEN 'E'
           ELSE (CASE
                 WHEN FLTLEG.STD IS NOT NULL
                 THEN 'S'
                 ELSE ''
                 END)
            END)
    END)AS FLTDATPREFIX
 , COALESCE(PREADV.RCPWGT,0)RCPWGT,
   COALESCE(PREADV.RCPIDRCNT,0)RCPIDRCNT,
   DCSSTA, 
   DCSREJRSN
  FROM FLTOPRMST FLTMST
LEFT JOIN FLTOPRLEG FLTLEG
ON fltmst.cmpcod     = FLTLEG.cmpcod
AND fltmst.fltnum    = FLTLEG.fltnum
AND fltmst.fltcaridr = FLTLEG.fltcaridr
AND fltmst.fltseqnum = FLTLEG.fltseqnum
LEFT JOIN oprdwsmst dwsmst
ON FLTLEG.cmpcod     = dwsmst.cmpcod
AND FLTLEG.fltnum    = dwsmst.fltnum
AND FLTLEG.fltcaridr = dwsmst.fltcaridr
AND FLTLEG.fltseqnum = dwsmst.fltseqnum
AND FLTLEG.legsernum = dwsmst.legsernum
AND FLTLEG.legorg    = dwsmst.arpcod
INNER JOIN malflt malflt
ON malflt.cmpcod     = FLTLEG.cmpcod
AND malflt.fltnum    = FLTLEG.fltnum
AND malflt.fltcaridr = FLTLEG.fltcaridr
AND malflt.fltseqnum = FLTLEG.fltseqnum
AND malflt.arpcod    = FLTLEG.legorg
AND malflt.legsernum = FLTLEG.legsernum
LEFT JOIN malfltcon fltcon
ON malflt.cmpcod     = fltcon.cmpcod
AND malflt.arpcod    = fltcon.asgprt
AND malflt.fltcaridr = fltcon.fltcaridr
AND malflt.fltnum    = fltcon.fltnum
AND malflt.fltseqnum = fltcon.fltseqnum
AND malflt.legsernum = fltcon.legsernum
LEFT JOIN maluldseg uldseg
ON fltcon.cmpcod     = uldseg.cmpcod
AND fltcon.fltcaridr = uldseg.fltcaridr
AND fltcon.fltnum    = uldseg.fltnum
AND fltcon.fltseqnum = uldseg.fltseqnum
AND fltcon.segsernum = uldseg.segsernum
AND fltcon.connum    = uldseg.uldnum
LEFT JOIN maluldsegdtl segdtl
ON uldseg.cmpcod     = segdtl.cmpcod
AND uldseg.fltcaridr = segdtl.fltcaridr
AND uldseg.fltnum    = segdtl.fltnum
AND uldseg.fltseqnum = segdtl.fltseqnum
AND uldseg.segsernum = segdtl.segsernum
AND uldseg.uldnum    = segdtl.uldnum
LEFT JOIN malmst malmst
ON segdtl.cmpcod     = malmst.cmpcod
AND segdtl.malseqnum = malmst.malseqnum
LEFT JOIN preadvsmy preadv
ON segdtl.cmpcod     = preadv.cmpcod
AND segdtl.fltcaridr = preadv.fltcaridr
AND segdtl.fltnum    = preadv.fltnum
AND segdtl.fltseqnum = preadv.fltseqnum
LEFT JOIN fltoprseg fltseg
ON fltmst.cmpcod     = fltseg.cmpcod
AND fltmst.fltnum    = fltseg.fltnum
AND fltmst.fltcaridr = fltseg.fltcaridr
AND fltmst.fltseqnum = fltseg.fltseqnum
LEFT JOIN MALFLTSEG MALFLTSEG
ON FLTSEG.CMPCOD     = MALFLTSEG.CMPCOD
AND FLTSEG.SEGDST    = MALFLTSEG.POU
AND FLTSEG.FLTNUM    = MALFLTSEG.FLTNUM
AND FLTSEG.FLTCARIDR = MALFLTSEG.FLTCARIDR
AND FLTSEG.FLTSEQNUM = MALFLTSEG.FLTSEQNUM
AND FLTSEG.SEGORG = MALFLTSEG.POL
LEFT JOIN FLTOPROPRREF FLTREF
ON FLTLEG.CMPCOD     = FLTREF.CMPCOD
AND FLTLEG.FLTNUM    = FLTREF.FLTNUM
AND FLTLEG.FLTCARIDR = FLTREF.FLTCARIDR
AND FLTLEG.FLTSEQNUM = FLTREF.FLTSEQNUM
AND FLTLEG.LEGSERNUM = FLTREF.LEGSERNUM
  AND FLTMST.CMPCOD         = ?
  AND FLTMST.FLTCARIDR      = ?
  AND FLTCON.CONTYP = 'U'
  AND FLTCON.ACPFLG ='Y'
				]]>
		</QRY:Source>
	</QRY:Definition>	
	<QRY:Definition>
		<QRY:Id>318</QRY:Id>
		<QRY:Source Name="postgres.mail.operations.findoutboundflightdetailsforbulk" Type="NATIVE">
			<![CDATA[
		   )
UNION ALL
  (SELECT FLTMST.CMPCOD,
    MALFLT.ARPCOD,
    FLTMST.FLTCARIDR,
    FLTMST.FLTNUM,
    FLTMST.FLTSEQNUM,
    FLTMST.FLTDAT,
    MALFLT.LEGSERNUM,
    FLTMST.FLTROU,
    FLTMST.FLTORG,
    FLTMST.FLTDST,
    FLTMST.FLTTYP,
    FLTMST.FLTSTA,
    FLTLEG.ACRTYP,
	FLTLEG.LEGORG,
    FLTLEG.DEPGTE,
	FLTLEG.ARVGTE,
    FLTCON.CONNUM,
    COALESCE(MALFLT.EXPCLSFLG,'N') EXPCLSFLG,
    COALESCE(MALMST.WGT,0) WGT,
    'BULK' CONNAM,
    MALMST.MALSEQNUM,
      COALESCE(FLTLEG.ATD,
    FLTLEG.ETD,
    FLTLEG.STD)DEPTIM,
                    (
    CASE
      WHEN FLTLEG.ATD IS NOT NULL
      THEN 'A'
      ELSE (CASE
           WHEN FLTLEG.ETD IS NOT NULL
           THEN 'E'
           ELSE (CASE
                 WHEN FLTLEG.STD IS NOT NULL
                 THEN 'S'
                 ELSE ''
                 END)
            END)
    END)AS FLTDATPREFIX
 , COALESCE(PREADV.RCPWGT,0)RCPWGT,
   COALESCE(PREADV.RCPIDRCNT,0)RCPIDRCNT,
   DCSSTA,
   DCSREJRSN
  FROM FLTOPRMST FLTMST
LEFT JOIN FLTOPRLEG FLTLEG
ON fltmst.cmpcod     = FLTLEG.cmpcod
AND fltmst.fltnum    = FLTLEG.fltnum
AND fltmst.fltcaridr = FLTLEG.fltcaridr
AND fltmst.fltseqnum = FLTLEG.fltseqnum
LEFT JOIN oprdwsmst dwsmst
ON FLTLEG.cmpcod     = dwsmst.cmpcod
AND FLTLEG.fltnum    = dwsmst.fltnum
AND FLTLEG.fltcaridr = dwsmst.fltcaridr
AND FLTLEG.fltseqnum = dwsmst.fltseqnum
AND FLTLEG.legsernum = dwsmst.legsernum
AND FLTLEG.legorg    = dwsmst.arpcod
INNER JOIN malflt malflt
ON malflt.cmpcod     = FLTLEG.cmpcod
AND malflt.fltnum    = FLTLEG.fltnum
AND malflt.fltcaridr = FLTLEG.fltcaridr
AND malflt.fltseqnum = FLTLEG.fltseqnum
AND malflt.arpcod    = FLTLEG.legorg
AND malflt.legsernum = FLTLEG.legsernum
LEFT JOIN malfltcon fltcon
ON malflt.cmpcod     = fltcon.cmpcod
AND malflt.arpcod    = fltcon.asgprt
AND malflt.fltcaridr = fltcon.fltcaridr
AND malflt.fltnum    = fltcon.fltnum
AND malflt.fltseqnum = fltcon.fltseqnum
AND malflt.legsernum = fltcon.legsernum
LEFT JOIN maluldseg uldseg
ON fltcon.cmpcod     = uldseg.cmpcod
AND fltcon.fltcaridr = uldseg.fltcaridr
AND fltcon.fltnum    = uldseg.fltnum
AND fltcon.fltseqnum = uldseg.fltseqnum
AND fltcon.segsernum = uldseg.segsernum
AND fltcon.connum    = uldseg.uldnum
LEFT JOIN maluldsegdtl segdtl
ON uldseg.cmpcod     = segdtl.cmpcod
AND uldseg.fltcaridr = segdtl.fltcaridr
AND uldseg.fltnum    = segdtl.fltnum
AND uldseg.fltseqnum = segdtl.fltseqnum
AND uldseg.segsernum = segdtl.segsernum
AND uldseg.uldnum    = segdtl.uldnum
LEFT JOIN malmst malmst
ON segdtl.cmpcod     = malmst.cmpcod
AND segdtl.malseqnum = malmst.malseqnum
LEFT JOIN preadvsmy preadv
ON segdtl.cmpcod     = preadv.cmpcod
AND segdtl.fltcaridr = preadv.fltcaridr
AND segdtl.fltnum    = preadv.fltnum
AND segdtl.fltseqnum = preadv.fltseqnum
LEFT JOIN fltoprseg fltseg
ON fltmst.cmpcod     = fltseg.cmpcod
AND fltmst.fltnum    = fltseg.fltnum
AND fltmst.fltcaridr = fltseg.fltcaridr
AND fltmst.fltseqnum = fltseg.fltseqnum
LEFT JOIN MALFLTSEG MALFLTSEG
ON FLTSEG.CMPCOD     = MALFLTSEG.CMPCOD
AND FLTSEG.SEGDST    = MALFLTSEG.POU
AND FLTSEG.FLTNUM    = MALFLTSEG.FLTNUM
AND FLTSEG.FLTCARIDR = MALFLTSEG.FLTCARIDR
AND FLTSEG.FLTSEQNUM = MALFLTSEG.FLTSEQNUM
AND FLTSEG.SEGORG = MALFLTSEG.POL
LEFT JOIN FLTOPROPRREF FLTREF
ON FLTLEG.CMPCOD     = FLTREF.CMPCOD
AND FLTLEG.FLTNUM    = FLTREF.FLTNUM
AND FLTLEG.FLTCARIDR = FLTREF.FLTCARIDR
AND FLTLEG.FLTSEQNUM = FLTREF.FLTSEQNUM
AND FLTLEG.LEGSERNUM = FLTREF.LEGSERNUM
  AND FLTMST.CMPCOD         = ?
  AND FLTMST.FLTCARIDR      = ?
  AND FLTCON.CONTYP = 'B'
  AND FLTCON.ACPFLG ='Y'
				]]>
		</QRY:Source>
	</QRY:Definition>	
	<QRY:Definition>
		<QRY:Id>318</QRY:Id>
		<QRY:Source Name="postgres.mail.operations.findoutboundflightdetailsfornotacceptedflights" Type="NATIVE">
			<![CDATA[
UNION ALL
  (
     SELECT FLTMST.CMPCOD,
    FLTLEG.LEGORG,
    FLTMST.FLTCARIDR,
    FLTMST.FLTNUM,
    FLTMST.FLTSEQNUM,
    FLTMST.FLTDAT,
    FLTLEG.LEGSERNUM,
    FLTMST.FLTROU,
    FLTMST.FLTORG,
    FLTMST.FLTDST,
    FLTMST.FLTTYP,
    FLTMST.FLTSTA,
    FLTLEG.ACRTYP,
	FLTLEG.LEGORG,
    FLTLEG.DEPGTE,--GateInfo
	FLTLEG.ARVGTE,--GateInfo
    --Manifest Info
    NULL CONNUM,
    COALESCE(MALFLT.EXPCLSFLG,'N') EXPCLSFLG,
    NULL WGT,
    NULL CONNAM,
    NULL MALSEQNUM,
      COALESCE(FLTLEG.ATD,
    FLTLEG.ETD,
    FLTLEG.STD)DEPTIM,
                    (
    CASE
      WHEN FLTLEG.ATD IS NOT NULL
      THEN 'A'
      ELSE (CASE
           WHEN FLTLEG.ETD IS NOT NULL
           THEN 'E'
           ELSE (CASE
                 WHEN FLTLEG.STD IS NOT NULL
                 THEN 'S'
                 ELSE ''
                 END)
            END)
    END)AS FLTDATPREFIX,
   0 RCPWGT,
  0 RCPIDRCNT,
  DCSSTA,
  DCSREJRSN
  FROM FLTOPRMST FLTMST
LEFT JOIN FLTOPRLEG FLTLEG
ON FLTMST.cmpcod     = FLTLEG.cmpcod
AND FLTMST.fltnum    = FLTLEG.fltnum
AND FLTMST.fltcaridr = FLTLEG.fltcaridr
AND FLTMST.fltseqnum = FLTLEG.fltseqnum
LEFT JOIN OPRDWSMST DWSMST
ON FLTLEG.CMPCOD     = DWSMST.CMPCOD
AND FLTLEG.FLTNUM    = DWSMST.FLTNUM
AND FLTLEG.FLTCARIDR = DWSMST.FLTCARIDR
AND FLTLEG.FLTSEQNUM = DWSMST.FLTSEQNUM
AND FLTLEG.LEGORG    = DWSMST.ARPCOD
LEFT JOIN MALFLT MALFLT
ON MALFLT.cmpcod     = FLTLEG.cmpcod
AND MALFLT.fltnum    = FLTLEG.fltnum
AND MALFLT.fltcaridr = FLTLEG.fltcaridr
AND MALFLT.fltseqnum = FLTLEG.fltseqnum
AND MALFLT.arpcod    = FLTLEG.legorg
LEFT JOIN FLTOPRSEG FLTSEG
ON FLTMST.CMPCOD     = FLTSEG.CMPCOD
AND FLTMST.FLTNUM    = FLTSEG.FLTNUM
AND FLTMST.FLTCARIDR = FLTSEG.FLTCARIDR
AND FLTMST.FLTSEQNUM = FLTSEG.FLTSEQNUM
LEFT JOIN FLTOPROPRREF FLTREF
ON FLTLEG.CMPCOD     = FLTREF.CMPCOD
AND FLTLEG.FLTNUM    = FLTREF.FLTNUM
AND FLTLEG.FLTCARIDR = FLTREF.FLTCARIDR
AND FLTLEG.FLTSEQNUM = FLTREF.FLTSEQNUM
AND FLTLEG.LEGSERNUM = FLTREF.LEGSERNUM
WHERE NOT EXISTS
      (SELECT 1
  FROM malfltcon fltcon
  WHERE FLTLEG.cmpcod  = fltcon.cmpcod
  AND FLTLEG.legorg    = fltcon.asgprt
  AND FLTLEG.fltcaridr = fltcon.fltcaridr
  AND FLTLEG.fltnum    = fltcon.fltnum
  AND FLTLEG.fltseqnum = fltcon.fltseqnum
  AND FLTMST.CMPCOD         = ?
  AND FLTMST.FLTCARIDR      = ?
]]>
		</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>
	<QRY:Id>320</QRY:Id>
	<QRY:Source Name="mail.operations.findInboundFlightOperationsDetails" Type="NATIVE">
		<![CDATA[
			WITH FLTDETAIL AS (
	SELECT FLTMST.CMPCOD, LEG.FLTCARIDR, LEG.FLTNUM, LEG.FLTSEQNUM, ARLMST.APHCODUSE, ARLMST.TWOAPHCOD,
		ARLMST.THRAPHCOD, LEG.LEGDST, LEG.LEGORG, LEG.ATA, LEG.ETA, LEG.STA, LEG.LEGSERNUM, LEG.TALNUM,
		LEG.ACRTYP, FLTMST.FLTROU, FLTMST.FLTDAT, FLTMST.FLTTYP, FLTMST.DOMFLTFLG
	FROM FLTOPRLEG LEG
	INNER JOIN SHRARLMST ARLMST
		ON ARLMST.CMPCOD  = LEG.CMPCOD
		AND ARLMST.ARLIDR = LEG.FLTCARIDR
	INNER JOIN FLTOPRMST FLTMST
		ON LEG.CMPCOD     = FLTMST.CMPCOD
		AND LEG.FLTNUM    = FLTMST.FLTNUM
		AND LEG.FLTCARIDR = FLTMST.FLTCARIDR
		AND LEG.FLTSEQNUM = FLTMST.FLTSEQNUM
    INNER JOIN MALFLT MALFLT
		ON MALFLT.FLTNUM    = FLTMST.FLTNUM
		AND MALFLT.FLTCARIDR = FLTMST.FLTCARIDR
		AND MALFLT.FLTSEQNUM = FLTMST.FLTSEQNUM
		AND MALFLT.CMPCOD    = ?
    INNER JOIN MALFLTSEG FLTSEG
		ON FLTSEG.FLTCARIDR  =MALFLT.FLTCARIDR
		AND FLTSEG.FLTNUM    = MALFLT.FLTNUM
		AND FLTSEG.FLTSEQNUM =MALFLT.FLTSEQNUM
		AND FLTSEG.CMPCOD    = MALFLT.CMPCOD
				]]>
	</QRY:Source>
</QRY:Definition>
<QRY:Definition>
	<QRY:Id>321</QRY:Id>
	<QRY:Source Name="mail.operations.findInboundFlightOperationsDetails_one" Type="NATIVE">
		<![CDATA[
    SELECT FLTDETAIL.CMPCOD, FLTDETAIL.FLTCARIDR, FLTDETAIL.FLTNUM, FLTDETAIL.FLTSEQNUM, 
		MAX(FLTDETAIL.APHCODUSE) AS APHCODUSE, MAX(FLTDETAIL.TWOAPHCOD) AS TWOAPHCOD, MAX(FLTDETAIL.THRAPHCOD) AS THRAPHCOD, MAX(FLTDETAIL.LEGDST) AS LEGDST,
		MAX(FLTDETAIL.LEGORG) AS LEGORG, 
		MAX(FLTDETAIL.ATA) AS ATA, MAX(FLTDETAIL.ETA) AS ETA, MAX(FLTDETAIL.STA) AS STA,
		FLTDETAIL.LEGSERNUM,
		MAX(FLTDETAIL.TALNUM) AS TALNUM, MAX(FLTDETAIL.ACRTYP) AS ACRTYP, 
		MAX(FLTDETAIL.FLTROU) AS FLTROU,
		FLTDETAIL.FLTDAT,
		MAX(FLTDETAIL.FLTTYP) AS FLTTYP , MAX(FLTDETAIL.DOMFLTFLG) AS DOMFLTFLG,
		MAX(NULL) AS CIQTIM,MAX(NULL) AS BDNCMPTIM, MAX(NULL) AS EPSTIM,
		FLTSEG.POU, FLTSEG.POL,
		MAX(NULL) AS ADDSCC,MAX( 0) AS MFTPCS,MAX(0) AS MFTWGT,
		MAX(ULD.RCVBAG) AS RCVPCS, MAX(ULD.RCVWGT) AS RCVWGT, MAX(ULD.RMK) AS RMK,
		ULD.ULDNUM,
		MAX(NULL) AS ULDSTA, MAX(0) AS GRSWGT, MAX(NULL) AS BSEFLG,
		MAX(RMPULD.RCVHNDFLG) AS RCVHNDFLG, MAX(RMPULD.FWDLOCCOD) AS FWDLOCCOD ,
		MAX(0) AS NETWGT, MAX(0) AS TARWGT,
		MAX(ULD.RMK) AS ULDRMK,
		MAX(NULL) AS SHPPFX, MAX(NULL) AS MSTDOCNUM, MAX(NULL) AS DOCOWRIDR, MAX(NULL) AS DUPNUM,
		MAX(NULL) AS SEQNUM , MAX(NULL) AS PRDNAM, MAX(0) AS STDWGT, MAX(0) AS STDPCS, MAX(NULL) AS SCCCOD, MAX(NULL) AS ORGCOD, 
		MAX(NULL) AS DSTCOD, MAX(NULL) AS CNSNAM, MAX(NULL) AS SHPDES,  MAX(NULL) AS ULDPOS, 
		MAX(NULL) AS BDNITN, MAX(NULL) AS BDNCPLFLG,
		ULD.SEGSERNUM,
		MAX( NULL) AS DMGDOCNUM, MAX(0) AS BLKCNT
	FROM MALULDSEG  ULD
	INNER JOIN FLTDETAIL
		ON FLTDETAIL.FLTNUM     = ULD.FLTNUM
		AND FLTDETAIL.FLTCARIDR = ULD.FLTCARIDR
		AND FLTDETAIL.FLTSEQNUM = ULD.FLTSEQNUM
		AND FLTDETAIL.CMPCOD    = ULD.CMPCOD
	INNER JOIN MALFLTSEG FLTSEG
		ON FLTSEG.FLTCARIDR  =ULD.FLTCARIDR
		AND FLTSEG.FLTNUM    = ULD.FLTNUM
		AND FLTSEG.FLTSEQNUM =ULD.FLTSEQNUM
		AND FLTSEG.SEGSERNUM =ULD.SEGSERNUM
		AND FLTSEG.CMPCOD    = ULD.CMPCOD
    INNER JOIN MALFLTCON CON
		ON ULD.CMPCOD     =CON.CMPCOD
		AND ULD.FLTCARIDR =CON.FLTCARIDR
		AND ULD.FLTNUM    =CON.FLTNUM
		AND ULD.FLTSEQNUM =CON.FLTSEQNUM
		AND ULD.SEGSERNUM =CON.SEGSERNUM
		AND ULD.ULDNUM    =CON.CONNUM
		AND CON.CONTYP = 'U'
    LEFT OUTER JOIN MALULDSEGDTL MAL
        ON ULD.CMPCOD     = MAL.CMPCOD
        AND ULD.FLTCARIDR = MAL.FLTCARIDR
        AND ULD.FLTNUM    = MAL.FLTNUM
        AND ULD.FLTSEQNUM = MAL.FLTSEQNUM
        AND ULD.SEGSERNUM = MAL.SEGSERNUM
        AND ULD.ULDNUM    = MAL.ULDNUM
    LEFT OUTER JOIN WHSRMPULD RMPULD
		ON ULD.FLTNUM     = RMPULD.FLTNUM
		AND ULD.FLTCARIDR = RMPULD.FLTCARIDR
		AND ULD.FLTSEQNUM = RMPULD.FLTSEQNUM
		AND ULD.CMPCOD    = RMPULD.CMPCOD
		AND ULD.ULDNUM    = RMPULD.ULDNUM
		AND FLTDETAIL.LEGDST = RMPULD.ARPCOD
			]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
	<QRY:Id>322</QRY:Id>
		<QRY:Source Name="mail.operations.findOffloadULDDetailsAtAirport" Type="NATIVE">
		<![CDATA[
	SELECT OFLD.CMPCOD, OFLD.FLTCARIDR, OFLD.FLTNUM, OFLD.FLTSEQNUM, LEG.LEGORG,
	null as ULDSHPPCS, OFLD.OFLBAG OFLPCS, B.APHCODUSE,B.TWOAPHCOD,
	B.THRAPHCOD, LEG.ATD, LEG.ETD, LEG.STD, OFLD.CONNUM AS ULDNUM,
    NULL AS SHPPFX, NULL AS MSTDOCNUM, NULL AS DOCOWRIDR, NULL AS DUPNUM, NULL AS SEQNUM,
    RMPULD.RCVHNDFLG, LEG.LEGSERNUM, NULL AS SCCOD, 0  AS BLKCNT
  FROM MALOFLDTL OFLD
  INNER JOIN SHRARLMST B
    ON B.CMPCOD  = OFLD.CMPCOD
    AND B.ARLIDR = OFLD.FLTCARIDR
  INNER JOIN FLTOPRLEG LEG
    ON OFLD.CMPCOD     = LEG.CMPCOD
    AND OFLD.FLTNUM    = LEG.FLTNUM
    AND OFLD.FLTCARIDR = LEG.FLTCARIDR
    AND OFLD.FLTSEQNUM = LEG.FLTSEQNUM
  INNER JOIN FLTOPRMST FLTMST
	ON LEG.CMPCOD     = FLTMST.CMPCOD
	AND LEG.FLTNUM    = FLTMST.FLTNUM
	AND LEG.FLTCARIDR = FLTMST.FLTCARIDR
	AND LEG.FLTSEQNUM = FLTMST.FLTSEQNUM
  INNER JOIN MALFLT MALFLT
	ON MALFLT.FLTNUM    = FLTMST.FLTNUM
	AND MALFLT.FLTCARIDR = FLTMST.FLTCARIDR
	AND MALFLT.FLTSEQNUM = FLTMST.FLTSEQNUM
  INNER JOIN MALARPULD OFLDULD
	ON OFLD.CMPCOD     =OFLDULD.CMPCOD
    AND OFLD.FLTCARIDR =OFLDULD.FLTCARIDR
    AND OFLD.CONNUM    =OFLDULD.ULDNUM
  INNER JOIN MALFLTCON CON
	ON OFLDULD.CMPCOD     =CON.CMPCOD
	AND OFLDULD.FLTCARIDR =CON.FLTCARIDR
	AND OFLDULD.ULDNUM    =CON.CONNUM
    AND CON.FLTNUM = '-1'
	AND CON.FLTSEQNUM = -1
	AND CON.LEGSERNUM = -1
	AND CON.CONTYP = 'U'	
  LEFT OUTER JOIN WHSRMPULD RMPULD
    ON RMPULD.CMPCOD     = OFLD.CMPCOD
	AND RMPULD.ARPCOD     = LEG.LEGORG
	AND RMPULD.FLTCARIDR = OFLD.FLTCARIDR
	AND RMPULD.FLTNUM    = OFLD.FLTNUM
	AND RMPULD.FLTSEQNUM = OFLD.FLTSEQNUM
	AND RMPULD.RMPHDLTYP = 'R'
	AND RMPULD.ULDNUM    = OFLD.CONNUM
    AND OFLD.OFLTYP    = 'F'
		WHERE OFLD.CMPCOD  = ?
		AND LEG.LEGORG     = ?
		AND TO_NUMBER(TO_CHAR(OFLD.OFLDAT, 'ddMMyyyy'))   >= ?
		AND TO_NUMBER(TO_CHAR(OFLD.OFLDAT, 'ddMMyyyy'))   <= ?
		]]>
		</QRY:Source>
</QRY:Definition>



 <QRY:Definition>
	<QRY:Id>323</QRY:Id>
	<QRY:Source Name="mail.operations.findmaildetailsfornewstatus" Type="NATIVE">
	<![CDATA[

	                      SELECT CSGMAL.CMPCOD,
						  CSGMST.CSGDAT SCNDAT,
						  CSGMAL.CSGDOCNUM,
						  CSGMAL.POACOD,
						  CSGMAL.CSGSEQNUM,
						  CSGMST.OPRTYP OPRSTA,
						  CSGMST.ARPCOD SCNPRT,
						  RTG.FLTCARCOD,
						  RTG.FLTCARIDR,
						  RTG.FLTNUM,
						  RTG.FLTDAT,
						  RTG.FLTSEQNUM,
						  MALMST.DSN,
						  MALMST.ORGEXGOFC,
						  MALMST.DSTEXGOFC,
						  MALMST.MALCLS,
						  MALMST.YER,
						  MALMST.MALSEQNUM,
						  MALMST.MALIDR,
						  MALMST.MALCTG MALCTGCOD,
						  MALMST.MALSUBCLS,
						  MALMST.HSN,
						  MALMST.RSN,
						  MALMST.WGT WGT,
						  MALMST.REGIND,
						  MALMST.REQDLVTIM,
						  MALMST.ONNTIMDLVFLG,
						  CSGMST.STDWGT ACPWGT,
						  CSGMAL.ULDNUM CONNUM,
					      CSGMST.STDBAG ACPBAG,
						  CSGMST.CSGDAT,
						  MALMST.LSTUPDUSR SCNUSR,
						  MALMST.LSTUPDUSR,
						  MALMST. MALSTA,
						  MALMST.ORGCOD,
						  MALMST.DSTCOD
						FROM MALCSGMST CSGMST
						INNER JOIN MALCSGDTL CSGMAL
						ON CSGMAL.CMPCOD     = CSGMST.CMPCOD
						AND CSGMAL.CSGDOCNUM = CSGMST.CSGDOCNUM
						AND CSGMAL.POACOD    = CSGMST.POACOD
						AND CSGMAL.CSGSEQNUM = CSGMST.CSGSEQNUM
						INNER JOIN MALMST MALMST
						ON MALMST.CMPCOD  = CSGMAL.CMPCOD
						AND MALMST.MALSEQNUM = CSGMAL.MALSEQNUM
						AND (COALESCE(MALMST.MALSTA,'N') ='NEW'
                        OR  COALESCE(MALMST.MALSRC,'N') ='FORCEACP')
						INNER JOIN MALCSGRTG RTG
						ON RTG.CMPCOD     = CSGMST.CMPCOD
						AND RTG.CSGDOCNUM = CSGMST.CSGDOCNUM
						AND RTG.POACOD    = CSGMST.POACOD
						AND RTG.CSGSEQNUM = CSGMST.CSGSEQNUM
						AND RTG.RTGSERNUM =
						  (SELECT MIN(RTGSERNUM)
						  FROM MALCSGRTG
						  WHERE CMPCOD  = CSGMST.CMPCOD
						  AND CSGDOCNUM = CSGMST.CSGDOCNUM
						  AND POACOD    = CSGMST.POACOD
						  AND CSGSEQNUM = CSGMST.CSGSEQNUM
	]]>
	</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>323</QRY:Id>
	<QRY:Source Name="mail.operations.findtransfermanifestid" Type="NATIVE">
	 <![CDATA[
	    SELECT TRFMFTIDR FROM MALTRFMFTDTL WHERE
       CMPCOD=?
       AND MALSEQNUM=?
       AND   COALESCE(TRFSTA,'N') <> 'TRFREJ'
	 ]]>
	</QRY:Source>
	</QRY:Definition>


   <QRY:Definition>
	<QRY:Id>321</QRY:Id>
	<QRY:Source Name="mail.operations.consignmentDetailsSummaryReport" Type="NATIVE">
	<![CDATA[
  SELECT
  max(CSGDOCNUM) CSGDOCNUM,
  DSN,
  ORGEXGOFC ,
  DSTEXGOFC,
  YER ,
  MALCTGCOD,
  MALSUBCLS ,
  SUM(WGT) WGT ,
  SUM(PCS) PCS,
  max(CSGDAT)CSGDAT,
  max (CSGTYP) CSGTYP,
  max(RMK) RMK,
  max(ARPCOD)ARPCOD ,
  max(SUBTYP) SUBTYP,
  max(ULDNUM) ULDNUM,
  max(POACOD) POACOD,
  max(FLTRUT) FLTRUT,
  max(SUBCLSGRP) SUBCLSGRP,
  max(ARLNAM)ARLNAM,
  max(FSTFLTDEPDAT)FSTFLTDEPDAT,
  max(POANAM) POANAM,
  max(FLTNUM) FLTNUM,
  max(FLTDAT)FLTDAT,
  max(POU) POU,
  max(POL) POL,
  max(FLTCARCOD)FLTCARCOD,
  max(RTGSERNUM)RTGSERNUM,
  max(ORGEXGOFCDES) ORGEXGOFCDES,
  max(DSTEXGOFCDES) DSTEXGOFCDES,
  max(OPRORG) OPRORG,
  max(OPRDST) OPRDST,
  max(CONSELNUM) CONSELNUM,
  max(TRPMNS) TRPMNS,
  max(CSGPRI) CSGPRI,
  max(FLTTYP) FLTTYP,
  MAX(POLARPNAM) POLARPNAM,
  MAX(POUARPNAM) POUARPNAM
FROM
(SELECT CSG.CMPCOD CMPCOD,
    CSG.CSGDOCNUM CSGDOCNUM,
    CSG.POACOD POACOD,
    CSG.CSGSEQNUM CSGSEQNUM,
    CSG.CSGDAT CSGDAT,
    CSG.OPRTYP OPRTYP ,
    CSG.LSTUPDTIM,
    CSG.LSTUPDUSR,
    CSG.CSGTYP CSGTYP,
    CSG.RMK RMK,
    CSG.STDBAG STDBAG,
    CSG.STDWGT STDWGT,
    CSG.ARPCOD ARPCOD,
    CSG.SUBTYP,
    CSG.POANAM,
    CSG.FSTFLTDEPDAT,
    MALMST.DSN DSN,
    MALMST.ORGEXGOFC ORGEXGOFC,
    MALMST.DSTEXGOFC DSTEXGOFC,
    MALMST.YER YER,
    MALMST.MALCTG MALCTGCOD,
    MALMST.MALSUBCLS MALSUBCLS,
    COALESCE(MAL.ULDNUM,'N') ULDNUM,
    0 RTGSERNUM,
    NULL FLTCARCOD,
    NULL FLTNUM,
    CURRENT_DATE FLTDAT,
    NULL POU,
    NULL POL,
    CSG.FLTRUT,
    SUBCLS.SUBCLSGRP,
    ARL.ARLNAM,
    MALMST.WGT,
    1 PCS,
    CSG.ORGEXGOFCDES,
    CSG.DSTEXGOFCDES,
    CSG.OPRORG,
	CSG.OPRDST,
    MAL.CONSELNUM  ,
    CSG.TRPMNS,
    CSG.CSGPRI,
    NULL FLTTYP,
	NULL POLARPNAM,
    NULL POUARPNAM
  FROM MALCSGMST CSG
  INNER JOIN MALCSGDTL MAL
  ON CSG.CMPCOD     = MAL.CMPCOD
  AND CSG.CSGDOCNUM = MAL.CSGDOCNUM
  AND CSG.POACOD    = MAL.POACOD
  AND CSG.CSGSEQNUM = MAL.CSGSEQNUM
  INNER JOIN MALMST MALMST
  ON MAL.CMPCOD     = MALMST.CMPCOD
  AND MAL.MALSEQNUM = MALMST.MALSEQNUM
  INNER JOIN  MALSUBCLSMST SUBCLS
  ON MALMST.CMPCOD = SUBCLS.CMPCOD
  AND MALMST.MALSUBCLS = SUBCLS.SUBCLSCOD
  INNER JOIN  SHRARLMST ARL
  ON CSG.CMPCOD = ARL.CMPCOD
  AND CSG.ARLCOD = ARL.TWOAPHCOD
  WHERE CSG.CMPCOD  = ?
  and CSG.CSGDOCNUM = ?
  and CSG.POACOD    = ?) MST
  GROUP BY ORGEXGOFC ,
  DSTEXGOFC,
  MALCTGCOD,
  MALSUBCLS ,
  YER ,
  DSN,
  ULDNUM
  union all
  select
    CSG.CSGDOCNUM CSGDOCNUM,
    NULL DSN,
    NULL ORGEXGOFC,
    NULL DSTEXGOFC,
    NULL YER,
    NULL MALCTGCOD,
    NULL MALSUBCLS,
    NULL WGT,
    NULL PCS,
    NULL CSGDAT,
    NULL CSGTYP,
    NULL RMK,
    NULL ARPCOD ,
    NULL SUBTYP,
    NULL ULDNUM,
    NULL POACOD,
    NULL FLTRUT,
    NULL SUBCLSGRP,
    NULL ARLNAM,
    NULL FSTFLTDEPDAT,
    NULL POANAM,
    RTG.FLTNUM FLTNUM,
    RTG.FLTDAT FLTDAT,
    RTG.POU POU,
    RTG.POL POL,
    RTG.FLTCARCOD FLTCARCOD,
    RTG.RTGSERNUM RTGSERNUM,
    NULL ORGEXGOFCDES,
  NULL DSTEXGOFCDES,
  NULL OPRORG,
  NULL OPRDST,
  NULL CONSELNUM ,
 NULL TRPMNS,
  NULL  CSGPRI,
  FLT.FLTTYP,
  (SELECT ARPNAM FROM SHRARPMST WHERE CMPCOD = RTG.CMPCOD AND ARPCOD = RTG.POL
  ) POLARPNAM,
  (SELECT ARPNAM FROM SHRARPMST WHERE CMPCOD = RTG.CMPCOD AND ARPCOD = RTG.POU
  ) POUARPNAM
    FROM MALCSGMST CSG
  INNER JOIN MALCSGRTG RTG
  ON CSG.CMPCOD     = RTG.CMPCOD
  AND CSG.CSGDOCNUM = RTG.CSGDOCNUM
  and CSG.POACOD    = RTG.POACOD
  and CSG.CSGSEQNUM = RTG.CSGSEQNUM
  LEFT OUTER JOIN FLTOPRMST FLT
  ON FLT.CMPCOD     = RTG.CMPCOD
  AND FLT.FLTCARIDR = RTG.FLTCARIDR
  AND FLT.FLTNUM    = RTG.FLTNUM
  AND FLT.FLTSEQNUM = RTG.FLTSEQNUM
  WHERE CSG.CMPCOD  = ?
  AND CSG.CSGDOCNUM = ?
  AND CSG.POACOD    = ?
  ORDER BY RTGSERNUM
	]]>
	</QRY:Source>
	</QRY:Definition>

	<QRY:Definition>

	<QRY:Id>322</QRY:Id>
	<QRY:Source Name="mail.operations.findRefusedRunnerFlightsPart2" Type="NATIVE">
		<![CDATA[
			)
            SELECT REFFLT.*,
                            malcon.connum uldnum,
                            malcon.actuldwgt actuldwgt,
                            CASE
                                WHEN malcon.contyp = 'B'   THEN 'Y'
                                ELSE 'N'
                            END barrowflg,
                            malcon.cntidr conidr,
                            (
                                SELECT
                                    SUM(acpbag)
                                FROM
                                    maluldsegdtl segdtl
                                WHERE
                                    segdtl.cmpcod = malcon.cmpcod
                                    AND segdtl.fltcaridr = malcon.fltcaridr
                                    AND segdtl.fltnum = malcon.fltnum
                                    AND segdtl.fltseqnum = malcon.fltseqnum
                                    AND segdtl.connum = malcon.connum
                                GROUP BY
                                    malcon.connum
                            ) acpbag
                            FROM REFFLT
                            INNER JOIN malofldtl ofldtl ON REFFLT.fltcaridr = ofldtl.fltcaridr
                                                           AND REFFLT.fltnum = ofldtl.fltnum
                                                           AND REFFLT.fltseqnum = ofldtl.fltseqnum
                                                           AND REFFLT.cmpcod = ofldtl.cmpcod
                                                           AND REFFLT.segsernum = ofldtl.segsernum
                            INNER JOIN malfltcon malcon ON ofldtl.fltcaridr = malcon.fltcaridr
                                                           AND ofldtl.cmpcod = malcon.cmpcod
                                                           AND ofldtl.connum = malcon.connum
                            where ofldtl.ofltyp = 'F'
                            AND malcon.fltnum = '-1'
                            AND malcon.fltseqnum = - 1
                            AND NOT EXISTS (
                                SELECT
                                    1
                                FROM
                                    whsrunstr runstr,
                                    whsrunstruld struld
                                WHERE
                                    runstr.cmpcod = struld.cmpcod
                                    AND runstr.arpcod = struld.arpcod
                                    AND runstr.stridr = struld.stridr
                                    AND struld.cmpcod = ofldtl.cmpcod
                                    AND struld.uldnum = ofldtl.connum
                                    AND runstr.cmpcod = ofldtl.cmpcod
                                    AND runstr.fltcaridr = ofldtl.fltcaridr
                                    AND runstr.fltseqnum = ofldtl.fltseqnum
                                    AND runstr.fltnum = ofldtl.fltnum
									AND runstr.arpcod = REFFLT.arpcod
                                    AND runstr.runtyp = 'I')
				${partiallyrefused}
	]]>
	</QRY:Source>
	<QRY:Extensions>
		 <QRY:Extension CompanyCode="AA">
			 <QRY:Token Name="partiallyrefused">
							UNION        
                            SELECT REFFLT.*,
                            dwsblk.cntidr uldnum,
                            dwsblk.actwgt actuldwgt,
                            'Y' as barrowflg,
                            dwsblk.conidr conidr,
                            (
                                SELECT
                                    SUM(acpbag)
                                FROM
                                    maluldsegdtl segdtl
                                WHERE
                                    segdtl.cmpcod = dwsblk.cmpcod
                                    AND segdtl.fltcaridr = dwsblk.fltcaridr
                                    AND segdtl.fltnum = dwsblk.fltnum
                                    AND segdtl.fltseqnum = dwsblk.fltseqnum
                                    AND segdtl.connum = dwsblk.cntidr
                                GROUP BY
                                    dwsblk.cntidr
                            ) acpbag
                            FROM REFFLT
                            INNER JOIN oprdwsblk dwsblk ON REFFLT.fltcaridr = dwsblk.fltcaridr
                                                           AND REFFLT.fltnum = dwsblk.fltnum
                                                           AND REFFLT.fltseqnum = dwsblk.fltseqnum
                                                           AND REFFLT.cmpcod = dwsblk.cmpcod
                                                           AND REFFLT.legsernum = dwsblk.legsernum
                            where dwsblk.blkrmk like '%PARTIAL REFUSAL%'
                            AND NOT EXISTS (
                                SELECT
                                    1
                                FROM
                                    whsrunstr runstr,
                                    whsrunstruld struld
                                WHERE
                                    runstr.cmpcod = struld.cmpcod
                                    AND runstr.arpcod = struld.arpcod
                                    AND runstr.stridr = struld.stridr
                                    AND struld.cmpcod = dwsblk.cmpcod
                                    AND struld.uldnum = dwsblk.cntidr
                                    AND runstr.cmpcod = dwsblk.cmpcod
                                    AND runstr.fltcaridr = dwsblk.fltcaridr
                                    AND runstr.fltseqnum = dwsblk.fltseqnum
                                    AND runstr.fltnum = dwsblk.fltnum
									AND runstr.arpcod = REFFLT.arpcod
                                    AND runstr.runtyp = 'I'
                            )
                            UNION        
                            SELECT REFFLT.*,
                            dwsuld.uldnum uldnum,
                            dwsuld.actwgt actuldwgt,
                            'N' as barrowflg,
                            dwsuld.conidr conidr,
                            (
                                SELECT
                                    SUM(acpbag)
                                FROM
                                    maluldsegdtl segdtl
                                WHERE
                                    segdtl.cmpcod = dwsuld.cmpcod
                                    AND segdtl.fltcaridr = dwsuld.fltcaridr
                                    AND segdtl.fltnum = dwsuld.fltnum
                                    AND segdtl.fltseqnum = dwsuld.fltseqnum
                                    AND segdtl.connum = dwsuld.uldnum
                                GROUP BY
                                    dwsuld.uldnum
                            ) acpbag
                            FROM REFFLT
                            INNER JOIN oprdwsuld dwsuld ON REFFLT.fltcaridr = dwsuld.fltcaridr
                                                           AND REFFLT.fltnum = dwsuld.fltnum
                                                           AND REFFLT.fltseqnum = dwsuld.fltseqnum
                                                           AND REFFLT.cmpcod = dwsuld.cmpcod
                                                           AND REFFLT.legsernum = dwsuld.legsernum
                            where dwsuld.blkrmk like '%PARTIAL REFUSAL%'
                            AND NOT EXISTS (
                                SELECT
                                    1
                                FROM
                                    whsrunstr runstr,
                                    whsrunstruld struld
                                WHERE
                                    runstr.cmpcod = struld.cmpcod
                                    AND runstr.arpcod = struld.arpcod
                                    AND runstr.stridr = struld.stridr
                                    AND struld.cmpcod = dwsuld.cmpcod
                                    AND struld.uldnum = dwsuld.uldnum
                                    AND runstr.cmpcod = dwsuld.cmpcod
                                    AND runstr.fltcaridr = dwsuld.fltcaridr
                                    AND runstr.fltseqnum = dwsuld.fltseqnum
                                    AND runstr.fltnum = dwsuld.fltnum
									AND runstr.arpcod = REFFLT.arpcod
                                    AND runstr.runtyp = 'I'
                            )
                </QRY:Token>
		 </QRY:Extension>
		 <QRY:Extension CompanyCode="4ALL">
			 <QRY:Token Name="partiallyrefused"></QRY:Token>
		 </QRY:Extension> 		 		 
	</QRY:Extensions>
</QRY:Definition>

<QRY:Definition>
	<QRY:Id>324</QRY:Id>
	<QRY:Source Name="mail.operations.findMailbagBillingStatus" Type="NATIVE">
	 <![CDATA[
	     SELECT
			CMPCOD,
			MALSEQNUM,
			BLGSTA
		FROM
			MALMRAGPABLGDTL
		WHERE
			CMPCOD = ?
			AND MALSEQNUM = ?
	 ]]>
	</QRY:Source>
</QRY:Definition>
<QRY:Definition>
		<QRY:Id>323</QRY:Id>
		<QRY:Source Name="mail.operations.saveforcemajeurerequestforupload" Type="PROCEDURE">
			<![CDATA[
					CALL pkg_mal_operations_defaults.spr_formjrreq_upl(?,?,?,?)
				]]>
		</QRY:Source>
	</QRY:Definition>


   <QRY:Definition>
	<QRY:Id>323</QRY:Id>
		<QRY:Source Name="mail.operations.findExportFlightOperationsDetails" Type="NATIVE">
<![CDATA[
	SELECT  FLTMST.CMPCOD,
  LEG.FLTCARIDR,
  LEG.FLTNUM,
  LEG.FLTSEQNUM,
  FLT.POU,
  FLT.POL,
  LEG.STA,
  ARLMST.APHCODUSE,
  ARLMST.TWOAPHCOD,
  ARLMST.THRAPHCOD,
  ULD.ULDNUM ULDNUM,
  LEG.LEGDST,
  LEG.LEGORG,
  LEG.ATD,
  LEG.ETD,
  LEG.STD,
  LEG.LEGSERNUM,
  LEG.TALNUM,
  LEG.ACRTYP,
  FLTMST.FLTROU,
  FLTMST.FLTDAT,
  FLTMST.FLTTYP,
  FLTMST.DOMFLTFLG,
  ULD.BAGCNT MFTPCS ,
  ULD.BAGWGT MFTWGT,
  ULD.RCVBAG RCVPCS,
  ULD.RCVWGT,
  ULD.BAGWGT NETWGT,
  ULD.BAGWGT GRSWGT
FROM MALFLTSEG FLT
INNER JOIN MALULDSEG ULD
ON FLT.CMPCOD     = ULD.CMPCOD
AND FLT.FLTCARIDR = ULD.FLTCARIDR
AND FLT.FLTNUM    = ULD.FLTNUM
AND FLT.FLTSEQNUM = ULD.FLTSEQNUM
AND FLT.SEGSERNUM = ULD.SEGSERNUM
LEFT OUTER JOIN MALULDSEGDTL MALSEG
ON ULD.CMPCOD     = MALSEG.CMPCOD
AND ULD.FLTCARIDR = MALSEG.FLTCARIDR
AND ULD.FLTNUM    = MALSEG.FLTNUM
AND ULD.FLTSEQNUM = MALSEG.FLTSEQNUM
AND ULD.SEGSERNUM = MALSEG.SEGSERNUM
AND ULD.ULDNUM    = MALSEG.ULDNUM
INNER JOIN MALFLTCON CON
ON CON.CMPCOD     = MALSEG.CMPCOD
AND CON.FLTCARIDR = MALSEG.FLTCARIDR
AND CON.FLTNUM    = MALSEG.FLTNUM
AND CON.FLTSEQNUM = MALSEG.FLTSEQNUM
AND CON.SEGSERNUM = MALSEG.SEGSERNUM
AND CON.CONNUM    = MALSEG.CONNUM
INNER JOIN MALFLT EXPFLT
ON MALSEG.CMPCOD     = EXPFLT.CMPCOD
AND MALSEG.FLTNUM    = EXPFLT.FLTNUM
AND MALSEG.FLTCARIDR = EXPFLT.FLTCARIDR
AND MALSEG.FLTSEQNUM = EXPFLT.FLTSEQNUM
INNER JOIN FLTOPRLEG LEG
ON FLT.CMPCOD     = LEG.CMPCOD
AND FLT.FLTNUM    = LEG.FLTNUM
AND FLT.FLTCARIDR = LEG.FLTCARIDR
AND FLT.FLTSEQNUM = LEG.FLTSEQNUM
AND FLT.POL       =LEG.LEGORG
INNER JOIN FLTOPRMST FLTMST
ON LEG.CMPCOD     = FLTMST.CMPCOD
AND LEG.FLTNUM    = FLTMST.FLTNUM
AND LEG.FLTCARIDR = FLTMST.FLTCARIDR
AND LEG.FLTSEQNUM = FLTMST.FLTSEQNUM
INNER JOIN SHRARLMST ARLMST
ON ARLMST.CMPCOD      = FLT.CMPCOD
AND ARLMST.ARLIDR     = FLT.FLTCARIDR
AND EXPFLT.EXPCLSFLG <> 'C'
AND MALSEG.ACPSTA     = 'Y'
AND CON.CONTYP        = 'U'
		]]>
		</QRY:Source>
</QRY:Definition>
<QRY:Definition>
	<QRY:Id>324</QRY:Id>
	<QRY:Source Name="mail.operations.fetchconsignmentdetailsforupload" Type="NATIVE">
		<![CDATA[
SELECT
    CMPCOD   CMPCOD,
    REF001   MALIDR,
    REF002   CSGDOCNUM,
    REF003   CSGDAT,
    REF004   MALBOXIDR,
    REF005   CSGTYP,
    REF006   CSGSUBTYP,
    REF007   OPRTYP,
    REF008   ULDNUM,
    REF009   LEGONEFLTNUM,
    REF010   LEGONEFLTDAT,
    REF011   LEGONEPOL,
    REF012   LEGONEPOU,
    REF013   LEGTWOFLTNUM,
    REF014   LEGTWOFLTDAT,
    REF015   LEGTWOPOL,
    REF016   LEGTWOPOU,
    REF017   LEGTHRFLTNUM,
    REF018   LEGTHRFLTDAT,
    REF019   LEGTHRPOL,
    REF020   LEGTHRPOU,
    REF021   LEGFORFLTNUM,
    REF022   LEGFORFLTDAT,
    REF023   LEGFORPOL,
    REF024   LEGFORPOU,
    REF025   SECRSNCOD,
    REF026   SECSTAPTY,
    REF027   SECSCRMTHCODONE,
    REF028   SCRAPLAUTONE,
    REF029   SCRAPLREGONE,
    REF030   SECSCRMTHCODTWO,
    REF031   SCRAPLAUTTWO,
    REF032   SCRAPLREGTWO,
    REF033   RMK
FROM
    SHRGENEXTTAB
WHERE
      CMPCOD = ?
    AND FILTYP = ?
ORDER BY
    SERNUM
		]]>
	</QRY:Source>
</QRY:Definition>
	  	<QRY:Definition>
		<QRY:Id>325</QRY:Id>
		<QRY:Source Name="mail.operations.findallpasspoacodes" Type="NATIVE">
				<![CDATA[
				SELECT MST.CMPCOD,
					  MST.POACOD,
					  MST.POANAM,
					  MST.POAADR,
					  MST.AUTEMLREQ,
					  MST.CNTCOD,
					  MST.EMLADR,
					  DTL.BLGSRC,
					  DTL.BLGFRQ,
                      MST.SECEMLADRONE,
                      MST.SECEMLADRTWO,
					  MST.STLCURCOD
					FROM
					  MALPOAMST MST,
					  MALPOADTL DTL
					WHERE MST.CMPCOD = DTL.CMPCOD
					AND MST.POACOD = DTL.POACOD
					AND MST.CMPCOD = ?
					AND MST.ACTFLG='ACTIVE'
					AND DTL.PARCOD = 'PASBLGID'
					AND ((? BETWEEN DTL.VLDFRM AND DTL.VLDTOO) AND (? BETWEEN DTL.VLDFRM AND DTL.VLDTOO))
		]]>
	</QRY:Source>
</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>326</QRY:Id>
		<QRY:Source Name="mail.operations.findoutboundlistflightdetails" Type="NATIVE">
			<![CDATA[


SELECT CMPCOD,
  ARPCOD,
  FLTCARIDR,
  FLTNUM,
  FLTSEQNUM,
  FLTDAT,
  LEGSERNUM,
  FLTROU,
  FLTORG,
  FLTDST,
  FLTTYP,
  FLTSTA,
  ACRTYP,
  LEGORG,
  EXPCLSFLG,
  DEPGTE,
  FLTDATPREFIX,
DEPTIM,
STD,
STA,
    %s,
MAX(DCSSTA)DCSSTA,
MAX(DCSREJRSN) DCSREJRSN
from
(SELECT CMPCOD,
  ARPCOD,
  FLTCARIDR,
  FLTNUM,
  FLTSEQNUM,
  FLTDAT,
  LEGSERNUM,
  FLTROU,
  FLTORG,
  FLTDST,
  FLTTYP,
  FLTSTA,
  ACRTYP,
  LEGORG,
  EXPCLSFLG,
  DEPGTE,
  ARVGTE,


connam,

  DEPTIM,
  STD,
  STA,
COUNT(distinct CONNUM) CONCNT,
  (COUNT(MALSEQNUM)  )MALCNT,
(SUM(WGT))WGT,
MAX(DSPWGTUNT) DSPWGTUNT,
FLTDATPREFIX,
 MAX(DCSSTA) DCSSTA,
 MAX(DCSREJRSN) DCSREJRSN
    FROM (
      (SELECT DISTINCT FLTMST.CMPCOD,
          COALESCE(MALFLT.ARPCOD,FLTLEG.LEGORG) ARPCOD,
          FLTMST.FLTCARIDR,
          FLTMST.FLTNUM,
          FLTMST.FLTSEQNUM,
          FLTMST.FLTDAT,
          COALESCE( MALFLT.LEGSERNUM,FLTLEG.LEGSERNUM) LEGSERNUM,
          FLTMST.FLTROU,
          FLTMST.FLTORG,
          FLTMST.FLTDST,
          FLTMST.FLTTYP,
          FLTMST.FLTSTA,
          FLTLEG.ACRTYP,
          FLTLEG.LEGORG,
          FLTLEG.DEPGTE,
          FLTLEG.ARVGTE,
          FLTCON.CONNUM,
          COALESCE(MALFLT.EXPCLSFLG,'N') EXPCLSFLG,
          COALESCE(MALMST.WGT,0) WGT,
          MALMST.DSPWGTUNT DSPWGTUNT,
          (CASE
          WHEN FLTCON.CONTYP IS NOT NULL
          THEN(CASE
          WHEN FLTCON.CONTYP = 'U'
          THEN SUBSTR(FLTCON.CONNUM,1,3)
          ELSE 'BULK'
          end
          )
          ELSE NULL
          end) AS CONNAM,
          MALMST.MALSEQNUM,
          COALESCE(FLTLEG.ATD, FLTLEG.ETD, FLTLEG.STD)DEPTIM,
		  FLTLEG.STD,
          FLTLEG.STA,
          (
          CASE
            WHEN FLTLEG.ATD IS NOT NULL
            THEN 'A'
            ELSE (
              CASE
                WHEN FLTLEG.ETD IS NOT NULL
                THEN 'E'
                ELSE (
                  CASE
                    WHEN FLTLEG.STD IS NOT NULL
                    THEN 'S'
                    ELSE ''
                  END)
              END)
          END)AS FLTDATPREFIX ,
          DCSSTA,
          DCSREJRSN
        FROM FLTOPRMST FLTMST
        LEFT JOIN FLTOPRLEG FLTLEG
        ON FLTMST.CMPCOD     = FLTLEG.CMPCOD
        AND FLTMST.FLTNUM    = FLTLEG.FLTNUM
        AND FLTMST.FLTCARIDR = FLTLEG.FLTCARIDR
        AND FLTMST.FLTSEQNUM = FLTLEG.FLTSEQNUM
        LEFT JOIN OPRDWSMST DWSMST
        ON FLTLEG.CMPCOD     = DWSMST.CMPCOD
        AND FLTLEG.FLTNUM    = DWSMST.FLTNUM
        AND FLTLEG.FLTCARIDR = DWSMST.FLTCARIDR
        AND FLTLEG.FLTSEQNUM = DWSMST.FLTSEQNUM
        AND FLTLEG.LEGORG    = DWSMST.ARPCOD
        LEFT JOIN MALFLT MALFLT
        ON MALFLT.CMPCOD     = FLTLEG.CMPCOD
        AND MALFLT.FLTNUM    = FLTLEG.FLTNUM
        AND MALFLT.FLTCARIDR = FLTLEG.FLTCARIDR
        AND MALFLT.FLTSEQNUM = FLTLEG.FLTSEQNUM
        AND MALFLT.ARPCOD    = FLTLEG.LEGORG
        LEFT  JOIN MALFLTCON FLTCON
        ON MALFLT.CMPCOD     = FLTCON.CMPCOD
        AND MALFLT.ARPCOD    = FLTCON.ASGPRT
        AND MALFLT.FLTCARIDR = FLTCON.FLTCARIDR
        AND MALFLT.FLTNUM    = FLTCON.FLTNUM
        AND MALFLT.FLTSEQNUM = FLTCON.FLTSEQNUM
        AND MALFLT.LEGSERNUM = FLTCON.LEGSERNUM
        LEFT  JOIN MALULDSEG ULDSEG
        ON FLTCON.CMPCOD     = ULDSEG.CMPCOD
        AND FLTCON.FLTCARIDR = ULDSEG.FLTCARIDR
        AND FLTCON.FLTNUM    = ULDSEG.FLTNUM
        AND FLTCON.FLTSEQNUM = ULDSEG.FLTSEQNUM
        AND FLTCON.SEGSERNUM = ULDSEG.SEGSERNUM
        LEFT  JOIN MALULDSEGDTL SEGDTL
        ON FLTCON.CMPCOD     = SEGDTL.CMPCOD
        AND FLTCON.FLTCARIDR = SEGDTL.FLTCARIDR
        AND FLTCON.FLTNUM    = SEGDTL.FLTNUM
        AND FLTCON.FLTSEQNUM = SEGDTL.FLTSEQNUM
        AND FLTCON.SEGSERNUM = SEGDTL.SEGSERNUM
        AND FLTCON.CONNUM    = SEGDTL.CONNUM
        LEFT JOIN MALMST MALMST
        ON SEGDTL.CMPCOD     = MALMST.CMPCOD
        AND SEGDTL.MALSEQNUM = MALMST.MALSEQNUM
        LEFT JOIN FLTOPRSEG FLTSEG ON
        FLTMST.CMPCOD = FLTSEG.CMPCOD
        AND FLTMST.FLTNUM    = FLTSEG.FLTNUM
        AND FLTMST.FLTCARIDR = FLTSEG.FLTCARIDR
        AND FLTMST.FLTSEQNUM = FLTSEG.FLTSEQNUM
        LEFT  JOIN MALFLTSEG MALFLTSEG
        ON FLTSEG.SEGORG     = MALFLTSEG.POL
        AND FLTSEG.SEGDST    = MALFLTSEG.POU
        AND FLTSEG.CMPCOD    = MALFLTSEG.CMPCOD
        AND FLTSEG.FLTNUM    = MALFLTSEG.FLTNUM
        AND FLTSEG.FLTCARIDR = MALFLTSEG.FLTCARIDR
        AND FLTSEG.FLTSEQNUM = MALFLTSEG.FLTSEQNUM
        AND FLTSEG.SEGORG    = MALFLTSEG.POL
        AND FLTSEG.SEGORG    = FLTLEG.LEGORG
        LEFT JOIN FLTOPROPRREF FLTREF
        ON FLTLEG.CMPCOD     = FLTREF.CMPCOD
        AND FLTLEG.FLTNUM    = FLTREF.FLTNUM
        AND FLTLEG.FLTCARIDR = FLTREF.FLTCARIDR
        AND FLTLEG.FLTSEQNUM = FLTREF.FLTSEQNUM
        AND FLTLEG.LEGSERNUM = FLTREF.LEGSERNUM
        LEFT JOIN MALTRUCKACRTYPES MALTRUKTYP
        ON FLTMST.CMPCOD     = MALTRUKTYP.CMPCOD
      WHERE FLTMST.CMPCOD = ?
      AND FLTMST.FLTCARIDR      = ?
				]]>
		</QRY:Source>
	</QRY:Definition>
<QRY:Definition>
	<QRY:Id>327</QRY:Id>
	<QRY:Source Name="mail.operations.findcontainerjourneyid" Type="NATIVE">
		<![CDATA[
			SELECT DISTINCT
				DTL.CMPCOD,
				DTL.MALJNRIDR,				
				RTG.FLTCARIDR,
				RTG.FLTCARCOD,
				RTG.FLTNUM,
				RTG.FLTSEQNUM,
				RTG.FLTDAT
			FROM
				MALCSGMST   MST
				INNER JOIN MALCSGDTL   DTL ON DTL.CMPCOD = MST.CMPCOD
											AND DTL.CSGDOCNUM = MST.CSGDOCNUM
											AND DTL.CSGSEQNUM = MST.CSGSEQNUM
											AND DTL.POACOD = MST.POACOD
				LEFT OUTER JOIN MALCSGRTG   RTG ON RTG.CMPCOD = DTL.CMPCOD
											AND RTG.CSGDOCNUM = DTL.CSGDOCNUM
											AND RTG.CSGSEQNUM = DTL.CSGSEQNUM
											AND RTG.POACOD = DTL.POACOD
			WHERE
				DTL.CMPCOD =?
				AND DTL.ULDNUM =?				
				AND TO_NUMBER(TO_CHAR(TRUNC(MST.CSGDAT), 'YYYYMMDD')) >= TO_NUMBER(TO_CHAR(TO_DATE(?),'YYYYMMDD'))
				AND TO_NUMBER(TO_CHAR(TRUNC(MST.CSGDAT), 'YYYYMMDD')) <= TO_NUMBER(TO_CHAR(TO_DATE(?),'YYYYMMDD'))				
		]]>
	</QRY:Source>
</QRY:Definition>
<QRY:Definition>
	<QRY:Id>328</QRY:Id>
	<QRY:Source Name="mail.operations.getMailbagsforArrival" Type="NATIVE">
		<![CDATA[					
SELECT SEGDTL.CMPCOD,
  MST.MALIDR,
  MST.MALSEQNUM,
  SEGDTL.SCNDAT,
  SEGDTL.CONNUM,
  SEGDTL.SCNPRT,
  SEGDTL.FLTNUM,
  SEGDTL.FLTSEQNUM,
  ARLMST.TWOAPHCOD FLTCARCOD,
  SEGDTL.FLTCARIDR,  
  SEGDTL.SEGSERNUM,  
  MST.CONTYP,
  MST.MALSTA,
  MST.POU,
  MST.ORGEXGOFC,
  MST.DSTEXGOFC,
  MST.MALCTG MALCTGCOD,
  MST.MALSUBCLS,
  MST.POACOD,
  MST.ORGCOD,
  MST.DSTCOD,
  MST.LSTUPDUSR
FROM MALMST MST
INNER JOIN MALULDSEGDTL SEGDTL
ON MST.CMPCOD        = SEGDTL.CMPCOD
AND MST.MALSEQNUM    = SEGDTL.MALSEQNUM
LEFT OUTER JOIN SHRARLMST ARLMST
ON SEGDTL.FLTCARIDR  = ARLMST.ARLIDR
AND SEGDTL.CMPCOD    = ARLMST.CMPCOD
WHERE SEGDTL.ACPSTA  ='N'
AND SEGDTL.ARRSTA    ='Y'
AND SEGDTL.CMPCOD    = ?
AND SEGDTL.FLTCARIDR =?
AND SEGDTL.FLTNUM    = ?
AND SEGDTL.FLTSEQNUM = ?
		]]>
	</QRY:Source>
</QRY:Definition>	
  <QRY:Definition>
<QRY:Id>328</QRY:Id>
<QRY:Source Name="mail.operations.findflightauditdetails" Type="NATIVE">
<![CDATA[
		SELECT FLTAUD.CMPCOD,
		FLTAUD.STNCOD,
		FLTAUD.UPDUSR,
		FLTAUD.UPDTXNTIM,
		FLTAUD.ACTCOD,
		FLTAUD.ADLINF,
		FLTAUD.AUDRMK,
		FLTAUD.TRGPNT
		FROM MALFLTAUD FLTAUD
		INNER JOIN MALFLT MALFLT
		ON FLTAUD.CMPCOD = MALFLT.CMPCOD
		AND FLTAUD.FLTNUM = MALFLT.FLTNUM
		AND FLTAUD.FLTSEQNUM = MALFLT.FLTSEQNUM
		AND FLTAUD.LEGSERNUM = MALFLT.LEGSERNUM
		AND FLTAUD.FLTCARIDR = MALFLT.FLTCARIDR
		AND FLTAUD.ARPCOD = MALFLT.ARPCOD
		AND FLTAUD.FLTNUM = ?
		AND MALFLT.FLTDAT = ?
          ]]>
</QRY:Source>
</QRY:Definition>
 <QRY:Definition>
<QRY:Id>329</QRY:Id>
<QRY:Source Name="mail.operations.findflightPureContainerDetails" Type="NATIVE">
<![CDATA[
		SELECT DISTINCT CMPCOD,
  FLTCARIDR,
  FLTNUM,
  ULDNUM,
  FLTSEQNUM,
  CONTYP,
  ASGPRT,
  POU,
  FLTDAT,
  (COUNT(MALSEQNUM) )MALCNT,
  COUNT(DISTINCT(MALDST)) DESTCOUNT,
  CASE
    WHEN COUNT(DISTINCT(MALDST)) > 1
    THEN 'MIXED'
    WHEN COUNT(DISTINCT(MALDST)) = 1
    AND MAX(MALDST)              =POU
    THEN 'TERMINATING'
    WHEN COUNT(DISTINCT(MALDST)) =0
    THEN 'NO MAILBAGS'
    ELSE 'PURE'
  END ULDTYP
FROM (
  (SELECT FLT.CMPCOD CMPCOD,
    FLT.FLTCARIDR FLTCARIDR,
    FLT.FLTNUM FLTNUM,
    FLT.FLTSEQNUM FLTSEQNUM,
    ULD.SEGSERNUM SEGSERNUM,
    FLT.POU POU,
    FLT.POL ASGPRT,
    COALESCE(CON.DSTCOD, FLT.POU) DSTCOD,
    COALESCE(CON.CONTYP, 'B') CONTYP,
    ULD.ULDNUM ULDNUM,
	 INBFLT.FLTDAT FLTDAT,
    MALMST.MALSEQNUM MALSEQNUM,
    MALMST.DSTCOD MALDST
  FROM MALFLTSEG FLT
  INNER JOIN MALULDSEG ULD
  ON FLT.FLTCARIDR  = ULD.FLTCARIDR
  AND FLT.FLTNUM    = ULD.FLTNUM
  AND FLT.FLTSEQNUM = ULD.FLTSEQNUM
  AND FLT.SEGSERNUM = ULD.SEGSERNUM
  AND FLT.CMPCOD    = ULD.CMPCOD
  LEFT OUTER JOIN FLTOPRMST INBFLT
  ON FLT.FLTCARIDR  = INBFLT.FLTCARIDR
  AND FLT.FLTNUM    = INBFLT.FLTNUM
  AND FLT.FLTSEQNUM = INBFLT.FLTSEQNUM
  AND FLT.CMPCOD    = INBFLT.CMPCOD
  LEFT OUTER JOIN MALFLTCON CON
  ON ULD.CMPCOD     = CON.CMPCOD
  AND ULD.FLTCARIDR = CON.FLTCARIDR
  AND ULD.FLTNUM    = CON.FLTNUM
  AND ULD.FLTSEQNUM = CON.FLTSEQNUM
  AND ULD.SEGSERNUM = CON.SEGSERNUM
  AND ULD.ULDNUM    = CON.CONNUM
  LEFT OUTER JOIN MALULDSEGDTL MAL
  ON ULD.CMPCOD     = MAL.CMPCOD
  AND ULD.FLTCARIDR = MAL.FLTCARIDR
  AND ULD.FLTNUM    = MAL.FLTNUM
  AND ULD.FLTSEQNUM = MAL.FLTSEQNUM
  AND ULD.SEGSERNUM = MAL.SEGSERNUM
  AND ULD.ULDNUM    = MAL.ULDNUM
  LEFT OUTER JOIN MALMST MALMST
  ON MAL.MALSEQNUM = MALMST.MALSEQNUM
  AND MAL.CMPCOD   = MALMST.CMPCOD
  LEFT OUTER JOIN MALEXGOFCMST DSTEXG
  ON DSTEXG.CMPCOD     = MALMST.CMPCOD
  AND DSTEXG.EXGOFCCOD = MALMST.DSTEXGOFC
  WHERE FLT.CMPCOD     = ?
  AND FLT.FLTCARIDR    = ?
  AND FLT.FLTNUM       = ?
  AND FLT.FLTSEQNUM    = ?
  AND FLT.POU          = ?
  ) ) MST
GROUP BY CMPCOD,
  FLTCARIDR,
  FLTNUM,
  FLTSEQNUM,
  SEGSERNUM,
  ULDNUM,
  CONTYP,
  ASGPRT,
  POU,
  FLTDAT
          ]]>
</QRY:Source>
</QRY:Definition>
 <QRY:Definition>
<QRY:Id>330</QRY:Id>
<QRY:Source Name="mail.operations.listmailbagSecurityDetails" Type="NATIVE">
<![CDATA[
SELECT mst.malidr,
mst.malseqnum,
  mst.orgcod,
  mst.dstcod,
  mst.SECSTACOD,
  dtl.scrloc,
  dtl.scrdtltyp,
  dtl.SERNUM,
  dtl.SECSCRMTHCOD,
  dtl.SECSTAPTY,
  dtl.SCRRES,
  dtl.SECSTADAT,
  dtl.CSGSRC,
  dtl.AGTTYP,
  dtl.CNTCOD,
  dtl.AGTIDR,
  dtl.EXPDAT,
  dtl.SCRAPLAUT,
  dtl.SCRAPLREG,
  dtl.APLREGTRPDIR,
  dtl.APLREGBRDAGYAUT,
  dtl.APLREGREFIDR,
  dtl.APLREGFLG,
  mst.CSGDOCNUM,
  mst.POACOD,
  dtl.SCRLVL,
  dtl.AGTSERNUM,
  mst.mstdocnum,
  mst.shppfx
FROM malcsgcsddtl dtl,
  malmst mst
WHERE mst.cmpcod  = dtl.cmpcod
AND mst.malseqnum = dtl.malseqnum
AND dtl.cmpcod    = ?
AND dtl.scrlvl    = 'M'
AND mst.malidr    = ?
UNION ALL
SELECT mst.malidr,
mst.malseqnum,
  mst.orgcod,
  mst.dstcod,
   coalesce (mstcsg.SECSTACOD,mst.secstacod) secstacod,
  dtl.scrloc,
  dtl.scrdtltyp,
     dtl.SERNUM,
  dtl.SECSCRMTHCOD,
  dtl.SECSTAPTY,
  dtl.SCRRES,
  dtl.SECSTADAT,
  dtl.CSGSRC,
  dtl.AGTTYP,
  dtl.CNTCOD,
  dtl.AGTIDR,
  dtl.EXPDAT,
  dtl.SCRAPLAUT,
  dtl.SCRAPLREG,
  dtl.APLREGTRPDIR,
  dtl.APLREGBRDAGYAUT,
  dtl.APLREGREFIDR,
  dtl.APLREGFLG,
  dtl.CSGDOCNUM,
  dtl.POACOD,
  dtl.SCRLVL,
  dtl.AGTSERNUM,
  mst.mstdocnum,
  mst.shppfx
FROM malcsgcsddtl dtl,
  malcsgmst mstcsg,
  malmst mst
WHERE mst.cmpcod  = dtl.cmpcod


AND mstcsg.csgdocnum = dtl.csgdocnum


AND mstcsg.csgseqnum = dtl.csgseqnum


AND mstcsg.poacod    = dtl.poacod


AND mstcsg.cmpcod    = mst.cmpcod


AND mstcsg.csgdocnum = mst.csgdocnum


AND mstcsg.csgseqnum = mst.csgseqnum


AND mstcsg.poacod    = mst.poacod

AND dtl.cmpcod    = ?
AND dtl.scrlvl    = 'C'

AND mst.malidr    = ?

order by sernum desc
 ]]>

</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>331</QRY:Id>
<QRY:Source Name="mail.operations.findagentcodefromupucode" Type="NATIVE">
	<![CDATA[
	SELECT
	mst.poacod,
	dtlagt.parval agtcod,
	dtlupu.parval upucod
	FROM
	malpoamst mst,
	malpoadtl dtlupu,
	malpoadtl dtlagt
	WHERE
	mst.cmpcod = dtlupu.cmpcod
	AND mst.poacod = dtlupu.poacod
	AND mst.cmpcod = dtlagt.cmpcod
	AND mst.poacod = dtlagt.poacod
	AND dtlupu.parval= ?
	AND dtlupu.parcod = 'UPUCOD'
	AND dtlagt.parcod = 'AGTCOD'
	AND mst.cmpcod = ?
	]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>332</QRY:Id>
<QRY:Source Name="mail.operations.findMailSequenceNumberForMailbagSecurity" Type="NATIVE">
	<![CDATA[
	SELECT MALSEQNUM,
	ORGCOD,
	DSTCOD,
	MALIDR
	FROM MALMST MST
	INNER JOIN MALPOAMST POAMST
	ON MST.CMPCOD  =POAMST.CMPCOD
	AND MST.POACOD =POAMST.POACOD
	WHERE MST.CMPCOD =?
	 AND MST.MALIDR=?
	AND (TO_NUMBER(TO_CHAR(current_date,'YYYYMMDD'))-TO_NUMBER(TO_CHAR(MST.DSPDAT,'YYYYMMDD')) <= POAMST.DUPMALPRD
	OR POAMST.DUPMALPRD = 0 )

	]]>
</QRY:Source>
</QRY:Definition>  
<QRY:Definition>
<QRY:Id>333</QRY:Id>
<QRY:Source Name="mail.operations.findScreeningDetails" Type="NATIVE">
	<![CDATA[

		SELECT DTL.CMPCOD CMYCOD
	FROM MALCSGCSDDTL DTL,
	  MALMST MST
	WHERE MST.CMPCOD  = DTL.CMPCOD
	and MST.MALSEQNUM = DTL.MALSEQNUM
	AND DTL.CMPCOD    = ?
	AND DTL.SCRLVL    = 'M'
	AND DTL.SCRDTLTYP = 'CS'
	AND MST.MALIDR    = ?
	UNION ALL
	SELECT  DTL.CMPCOD CMYCOD
	FROM MALMST MST,
	  MALCSGMST MSTCSG,
	 MALCSGCSDDTL DTL
	WHERE MST.CMPCOD  = MSTCSG.CMPCOD
	AND MST.CSGDOCNUM = MSTCSG.CSGDOCNUM
	AND MST.CSGSEQNUM = MSTCSG.CSGSEQNUM
	AND MST.POACOD    = MSTCSG.POACOD
	AND MSTCSG.CMPCOD    = DTL.CMPCOD
	AND MSTCSG.CSGDOCNUM = DTL.CSGDOCNUM
	AND MSTCSG.CSGSEQNUM = DTL.CSGSEQNUM
	AND MSTCSG.POACOD    = DTL.POACOD
	AND DTL.CMPCOD    = ?
	AND DTL.SCRLVL    = 'C'
	AND DTL.SCRDTLTYP = 'CS'
	AND MST.MALIDR    = ?
	
	]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>334</QRY:Id>
<QRY:Source Name="mail.operations.findRoutingDetailsForPrint" Type="NATIVE">
	<![CDATA[
  	SELECT seg.pou
	FROM maluldsegdtl dtl,
	malfltseg seg
	WHERE dtl.cmpcod  = seg.cmpcod
	AND dtl.fltcaridr = seg.fltcaridr
	AND dtl.fltnum    = seg.fltnum
	AND dtl.fltseqnum = seg.fltseqnum
	AND dtl.segsernum = seg.segsernum
	AND dtl.cmpcod    = ?
	AND dtl.malseqnum = ?

	]]>
</QRY:Source>
</QRY:Definition>   
<QRY:Definition>
<QRY:Id>335</QRY:Id>
<QRY:Source Name="mail.operations.findMailbagsAttachedToAWBNo" Type="NATIVE">
	<![CDATA[
	SELECT WGT,
	MALIDR,
	MSTDOCNUM
	FROM MALMST
	WHERE cmpcod  = ?
	AND dupnum    = ?
	AND seqnum = ?
	AND mstdocnum = ?
	AND csgdocnum !=?
	]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>336</QRY:Id>
<QRY:Source Name="mail.operations.findRegulatedCarrierForMailbag" Type="NATIVE">
	<![CDATA[

	SELECT 
  DTL.SCRDTLTYP,
  DTL.SERNUM,
  DTL.CSGSRC,
  DTL.AGTTYP,
  DTL.CNTCOD,
  DTL.AGTIDR,
  DTL.EXPDAT,
  DTL.CSGDOCNUM,
  DTL.POACOD,
  DTL.SCRLVL
FROM MALCSGCSDDTL DTL
WHERE DTL.CMPCOD    = ?
AND DTL.SCRLVL    = 'M'
AND DTL.MALSEQNUM    = ?
AND DTL.AGTTYP    = 'RC'
ORDER BY SERNUM DESC	
	]]>
</QRY:Source>
</QRY:Definition>


<QRY:Definition>
		<QRY:Id>337</QRY:Id>
			<QRY:Source Name="mail.operations.findLatestContainerAssignmentForUldDelivery" Type="NATIVE">
				<![CDATA[
					SELECT MST.CMPCOD,
					  MST.POAFLG,
					  MST.CONNUM,
					  MST.ASGPRT,
					  MST.FLTCARIDR,
					  MST.FLTNUM,
					  MST.FLTSEQNUM,
					  MST.SEGSERNUM,
					  MST.LEGSERNUM,
					  MST.FLTCARCOD,
					  MST.DSTCOD,
					  MST.ACPFLG,
					  FLT.FLTDAT,
					  FLT.EXPCLSFLG CLSFLG,
					  MST.POU,
					  MST.CONTYP,
					  MST.ARRSTA,
					  MST.LSTUPDTIM,
					  MST.TXNCOD,
					  ULDSEG.RELFLG,
					  MST.RMK,
					  MST.TRNFLG,
					  MST.OFLFLG,
					  MST.ACTULDWGT,
					  MST.ASGDAT
					FROM MALFLTCON MST
					LEFT OUTER JOIN MALFLT FLT
					ON MST.CMPCOD     = FLT.CMPCOD
					AND MST.ASGPRT    = FLT.ARPCOD
					AND MST.FLTCARIDR = FLT.FLTCARIDR
					AND MST.FLTNUM    = FLT.FLTNUM
					AND MST.FLTSEQNUM = FLT.FLTSEQNUM
					AND MST.LEGSERNUM = FLT.LEGSERNUM
					LEFT OUTER JOIN MALULDSEG ULDSEG
					ON MST.CMPCOD     = ULDSEG.CMPCOD
					AND MST.FLTCARIDR = ULDSEG.FLTCARIDR
					AND MST.FLTNUM    = ULDSEG.FLTNUM
					AND MST.FLTSEQNUM = ULDSEG.FLTSEQNUM
					AND MST.SEGSERNUM = ULDSEG.SEGSERNUM
					AND MST.CONNUM    = ULDSEG.ULDNUM
					WHERE MST.CMPCOD  = ?
					AND MST.CONNUM    = ?
					AND MST.POU       = ?
					
					

					]]>
			</QRY:Source>
	</QRY:Definition>


<QRY:Definition>
<QRY:Id>338</QRY:Id>
<QRY:Source Name="mail.operations.findLoadPlanVersionsForContainer" Type="NATIVE">
	<![CDATA[
	SELECT 
  FLTCON.CMPCOD,
  FLTCON.FLTCARIDR,
  FLTCON.FLTNUM,
  FLTCON.FLTSEQNUM,
  FLTCON.LODPLNVER,
  FLTCON.SEGORG,
  FLTCON.SEGDST,
  FLTCON.CONNUM,
  FLTCON.LODPLNSTA
FROM MALLODPLNFLTCON FLTCON	
WHERE FLTCON.CMPCOD    = ?
AND FLTCON.CONNUM    = ?
AND FLTCON.ULDREFNUM    = ?	
	]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>339</QRY:Id>
<QRY:Source Name="mail.operations.findLoadPlanDetails" Type="NATIVE">
	<![CDATA[
	SELECT * FROM MALLODPLNFLTCON LODPLNCON
WHERE LODPLNCON.CMPCOD  = ?
AND LODPLNCON.FLTCARIDR = ?
AND LODPLNCON.FLTNUM    = ?
AND LODPLNCON.FLTSEQNUM = ?

	]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>340</QRY:Id>
<QRY:Source Name="mail.operations.findRAacceptingForMailbag" Type="NATIVE">
<![CDATA[
SELECT mst.malidr,
mst.malseqnum,
  mst.orgcod,
  mst.dstcod,
  mst.SECSTACOD,
  dtl.scrloc,
  dtl.scrdtltyp,
  dtl.SERNUM,
  dtl.SECSCRMTHCOD,
  dtl.SECSTAPTY,
  dtl.SCRRES,
  dtl.SECSTADAT,
  dtl.CSGSRC,
  dtl.AGTTYP,
  dtl.CNTCOD,
  dtl.AGTIDR,
  dtl.EXPDAT,
  dtl.SCRAPLAUT,
  dtl.SCRAPLREG,
  dtl.APLREGTRPDIR,
  dtl.APLREGBRDAGYAUT,
  dtl.APLREGREFIDR,
  dtl.APLREGFLG,
  mst.CSGDOCNUM,
  mst.POACOD,
  dtl.SCRLVL,
  dtl.arpcod
FROM malcsgcsddtl dtl,
  malmst mst
WHERE mst.cmpcod  = dtl.cmpcod
AND mst.malseqnum = dtl.malseqnum
AND dtl.cmpcod    = ?
AND dtl.scrlvl    = 'M'
AND mst.malseqnum    = ?
UNION ALL
SELECT mst.malidr,
mst.malseqnum,
  mst.orgcod,
  mst.dstcod,
  mstcsg.SECSTACOD,
  dtl.scrloc,
  dtl.scrdtltyp,
     dtl.SERNUM,
  dtl.SECSCRMTHCOD,
  dtl.SECSTAPTY,
  dtl.SCRRES,
  dtl.SECSTADAT,
  dtl.CSGSRC,
  dtl.AGTTYP,
  dtl.CNTCOD,
  dtl.AGTIDR,
  dtl.EXPDAT,
  dtl.SCRAPLAUT,
  dtl.SCRAPLREG,
  dtl.APLREGTRPDIR,
  dtl.APLREGBRDAGYAUT,
  dtl.APLREGREFIDR,
  dtl.APLREGFLG,
  dtl.CSGDOCNUM,
  dtl.POACOD,
  dtl.SCRLVL,
  dtl.arpcod
FROM malcsgcsddtl dtl,
  malcsgmst mstcsg,
  malmst mst
WHERE mst.cmpcod  = dtl.cmpcod
AND mstcsg.csgdocnum = dtl.csgdocnum
AND mstcsg.csgseqnum = dtl.csgseqnum
AND mstcsg.poacod    = dtl.poacod
AND mstcsg.cmpcod    = mst.cmpcod
AND mstcsg.csgdocnum = mst.csgdocnum
AND mstcsg.csgseqnum = mst.csgseqnum
AND mstcsg.poacod    = mst.poacod
AND dtl.cmpcod    = ?
AND dtl.scrlvl    = 'C'
AND mst.malseqnum    = ?
order by sernum desc
 ]]>

</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>341</QRY:Id>
<QRY:Source Name="mail.operations.findRoutingDetailsForMailBag" Type="NATIVE">
	<![CDATA[
 SELECT seg.pol pol
FROM maluldsegdtl dtl, malfltseg seg
WHERE dtl.cmpcod  = seg.cmpcod
AND dtl.fltcaridr = seg.fltcaridr
AND dtl.fltnum    = seg.fltnum
AND dtl.fltseqnum = seg.fltseqnum
AND dtl.segsernum = seg.segsernum
AND dtl.cmpcod    = ?
AND dtl.malseqnum = ?
AND seg.pou       =?

	]]>
</QRY:Source>
</QRY:Definition> 
<QRY:Definition>
<QRY:Id>342</QRY:Id>
<QRY:Source Name="mail.operations.findlatestregulatedagentissuing" Type="NATIVE">
	<![CDATA[

	SELECT 
  MAX(DTL.SERNUM) SERNUM
FROM MALCSGCSDDTL DTL
WHERE DTL.CMPCOD    = ?
AND DTL.AGTTYP    = 'RI'
AND DTL.SCRLOC=?	
	]]>
</QRY:Source>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>343</QRY:Id>
<QRY:Source Name="mail.operations.findscreeningmethodwithoutagentsernum" Type="NATIVE">
	<![CDATA[

SELECT
  DTL.CMPCOD,
  DTL.SCRLOC,
  DTL.SCRDTLTYP,
  DTL.SERNUM,
  DTL.SECSCRMTHCOD,
  DTL.SECSTAPTY,
  DTL.SCRRES,
  DTL.SECSTADAT,
  DTL.CSGSRC,
  DTL.CSGDOCNUM,
  DTL.POACOD,
  DTL.SCRLVL,
  DTL.MALSEQNUM
FROM MALCSGCSDDTL DTL
WHERE DTL.CMPCOD    = ?
AND DTL.SCRDTLTYP    = 'SM'
AND DTL.AGTSERNUM    = 0
AND DTL.SCRLOC=?
	]]>
</QRY:Source>
</QRY:Definition> 

<QRY:Definition>
<QRY:Id>344</QRY:Id>
<QRY:Source Name="mail.operations.fetchmailindicatorforprogress" Type="NATIVE">
	<![CDATA[

SELECT
  DISTINCT FLTSEG.FLTCARIDR , FLTSEG.FLTNUM, FLTSEG.FLTSEQNUM
  FROM MALFLTSEG FLTSEG
  JOIN MALULDSEGDTL MALSEG
  ON FLTSEG.FLTNUM = MALSEG.FLTNUM
  AND FLTSEG.FLTCARIDR = MALSEG.FLTCARIDR
  AND FLTSEG.SEGSERNUM = MALSEG.SEGSERNUM
  AND FLTSEG.FLTSEQNUM = MALSEG.FLTSEQNUM
  AND FLTSEG.CMPCOD = MALSEG.CMPCOD
  where FLTSEG.CMPCOD = ?
AND POU = ?
	]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
	<QRY:Id>600</QRY:Id>
		<QRY:Source Name="mail.operations.findflightassignedmailsinuldwithoutacceptance" Type="NATIVE">
			<![CDATA[
						SELECT CON.CMPCOD, 
					  CON.FLTCARIDR,
					  CON.FLTNUM,
					  CON.CONNUM,
					  CON.FLTSEQNUM,
					  CON.LEGSERNUM,
					  CON.ASGPRT,
					  CON.CONTYP,
					  CON.SEGSERNUM,
					  CON.CNTIDR,
					  CON.POU,
					  CON.POAFLG,
					  MALMST.MALSRVLVL MALSRVLVL,
					  MALMST.ORGCOD ORGCOD,
					  MALMST.DSTCOD DSTCOD,
					  MALMST.DSN,
					  MALMST.ORGEXGOFC,
					  MALMST.DSTEXGOFC,
					  MALMST.YER,
					  MALMST.MALCTG MALCTGCOD,
					  MALMST.MALSUBCLS,
					  MALMST.RSN,
					  MALMST.HSN,
					  MALMST.REGIND,
					  MALMST.MALCLS,
					  MALMST.MALTYP,
					  MALMST.MALRMK,
					  MALMST.WGT,
					  MALMST.DSPWGT,
					  MALMST.DSPWGTUNT,
					  MALMST.CSGDOCNUM CSGDOCNUM,
					  MALMST.CSGSEQNUM CSGSEQNUM,
					  MALMST.POACOD POACOD,
					  CSGMST.CSGDAT CSGDAT,
					  MALMST.DSPDAT ACPDAT,
					  MALSEG.ACPWGT CSGACPWGT,
					  MALSEG.ACPBAG CSGACPBAG,
					  MALSEG.STDBAG CSGSTDBAG,
					  MALSEG.STDWGT CSGSTDWGT,
					  NULL ACPUSR,
					  MALMST.MALIDR MALIDR,
					  MALMST.MALSEQNUM MALSEQNUM,
					  MALSEG.DMGFLG DMGFLG,
				      MALMST.SELNUM,
					  MALSEG.ARRSELNUM,
					  MALSEG.FRMCARCOD MALFRMCARCOD,
					  MALMST.VOL,
					  MALMST.VOLUNT,
					  0 STDVOL,
					  0 ACPVOL,
					  MALMST.CSGDOCNUM MALCSGDOCNUM,
					  MALMST.CSGSEQNUM MALCSGDOCSEQ,
					  MALMST.POACOD MALPOACOD,
					  MALMST.MALCMPCOD MALCMPCOD,
					  MALMST.SCNPRT SCNPRT,
					  MALMST.MALSTA MALSTA,
					  MALMST.OPRSTA OPRSTA,
                      MALMST.MSTDOCNUM MSTDOCNUM,
                      MALMST.DOCOWRIDR DOCOWRIDR,
                      MALMST.SHPPFX SHPPFX,
					  CON.ULDFULIND,
					  CON.ULDREFNUM,
					  CASE
						WHEN EXISTS
						  (SELECT 1
						  FROM MALHIS HIS
						  WHERE HIS.CMPCOD = MALMST.CMPCOD
						  AND HIS.MALSEQNUM=MALMST.MALSEQNUM
						  AND HIS.MALSTA  IN ('ARR')
						  )
						THEN 'Y'
						ELSE 'N'
					  END ARRSTA,
					  DMGMAL.DMGCOD,
					  DMGMAL.DMGDAT,
					  DMGMAL.ARPCOD,
					  DMGMAL.DMGDES,
					  DMGMAL.RMK,
					  MALMST.SCNDAT SCNDAT,
					  MALMST.LSTUPDTIM MALLSTUPDTIM,
					  NULL BLYCRTIDR,
					  MALMST.ACPPOACONNUM ACPPOACONNUM,
					  MALMST.ACPARPCOD ACPARPCOD,
					  MALMST.SECSTACOD SECSTACOD
					FROM MALFLTCON CON
					INNER JOIN MALULDSEGDTL MALSEG
					ON CON.CMPCOD     = MALSEG.CMPCOD
					AND CON.FLTCARIDR = MALSEG.FLTCARIDR
					AND CON.FLTNUM    = MALSEG.FLTNUM
					AND CON.FLTSEQNUM = MALSEG.FLTSEQNUM
					AND CON.SEGSERNUM = MALSEG.SEGSERNUM
					AND CON.CONNUM    = MALSEG.ULDNUM
					LEFT OUTER JOIN MALMST MALMST
					ON MALSEG.MALSEQNUM = MALMST.MALSEQNUM
					AND MALSEG.CMPCOD   = MALMST.CMPCOD
					LEFT OUTER JOIN MALDMGDTL DMGMAL
					ON MALMST.MALSEQNUM = DMGMAL.MALSEQNUM
					AND MALMST.CMPCOD   = DMGMAL.CMPCOD
					LEFT OUTER JOIN MALCSGMST CSGMST
					ON CSGMST.CMPCOD     = MALMST.CMPCOD
					AND CSGMST.CSGDOCNUM = MALMST.CSGDOCNUM
					AND CSGMST.POACOD    = MALMST.POACOD
					AND CSGMST.CSGSEQNUM = MALMST.CSGSEQNUM
					WHERE CON.CMPCOD    = ?
					AND CON.FLTCARIDR   = ?
					AND CON.FLTNUM      = ?
					AND CON.FLTSEQNUM   = ?
					AND CON.LEGSERNUM   = ?
					AND CON.ASGPRT      = ?
					AND CON.CONNUM      = ?
					AND CON.CONTYP      = 'U'
					ORDER BY DSN,
					  ORGEXGOFC,
					  DSTEXGOFC,
					  YER,
					  MALCTGCOD,
					  MALSUBCLS,
					  CSGDOCNUM,
					  CSGSEQNUM,
					  POACOD
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>601</QRY:Id>
		<QRY:Source Name="mail.operations.findflightassignedmailsinbulkwithoutacceptance" Type="NATIVE">
			<![CDATA[
					SELECT 
					MALSEG.CMPCOD,
					MALSEG.FLTCARIDR,
					MALSEG.FLTNUM,
					MALSEG.ULDNUM,
					MALSEG.FLTSEQNUM,
					MALSEG.SEGSERNUM,
					MALMST.MALSRVLVL MALSRVLVL,
					MALMST.ORGCOD ORGCOD,
					MALMST.DSTCOD DSTCOD,
					MALMST.DSN,
					MALMST.ORGEXGOFC,
					MALMST.DSTEXGOFC,
					MALMST.YER,
					MALMST.MALCTG MALCTGCOD,
					MALMST.MALSUBCLS,
					MALMST.MALCLS,
					MALMST.RSN,
					MALMST.HSN,
					MALMST.REGIND,
					MALMST.MALTYP,
					MALMST.MALRMK,
					MALMST.WGT,
					MALMST.DSPWGT,
					MALMST.DSPWGTUNT,
					MALMST.CSGDOCNUM CSGDOCNUM,
					MALMST.CSGSEQNUM CSGSEQNUM,
					MALMST.POACOD POACOD,
					CSGMST.CSGDAT CSGDAT,
					MALMST.DSPDAT ACPDAT,
					MALSEG.ACPWGT CSGACPWGT,
					MALSEG.ACPBAG CSGACPBAG,
					MALSEG.STDBAG CSGSTDBAG,
					MALSEG.STDWGT CSGSTDWGT,
					NULL ACPUSR,
					MALMST.MALIDR MALIDR,
					MALMST.MALSEQNUM MALSEQNUM,
					MALSEG.DMGFLG DMGFLG,
					MALMST.SELNUM,
					MALSEG.ARRSELNUM,
					MALSEG.FRMCARCOD MALFRMCARCOD,
					MALMST.VOL,
					MALMST.VOLUNT,
					0 STDVOL,
					0 ACPVOL,
					MALMST.CSGDOCNUM MALCSGDOCNUM,
					MALMST.CSGSEQNUM MALCSGDOCSEQ,
					MALMST.POACOD MALPOACOD,
					MALMST.MALCMPCOD MALCMPCOD,
					MALMST.SCNPRT SCNPRT,
					MALMST.MALSTA MALSTA,
					MALMST.OPRSTA OPRSTA,
					CASE
					WHEN EXISTS
					(SELECT 1
					FROM MALHIS HIS
					WHERE HIS.CMPCOD  = MALMST.CMPCOD
					AND HIS.MALSEQNUM = MALMST.MALSEQNUM
					AND HIS.MALSTA   IN ('ARR')
					)
					THEN 'Y'
					ELSE 'N'
					END ARRSTA,
					DMGMAL.DMGCOD,
					DMGMAL.DMGDAT,
					DMGMAL.ARPCOD,
					DMGMAL.DMGDES,
					DMGMAL.RMK,
					MALMST.SCNDAT SCNDAT,
					MALMST.LSTUPDTIM MALLSTUPDTIM,
					NULL BLYCRTIDR,
					MALMST.ACPPOACONNUM ACPPOACONNUM,
					MALMST.ACPARPCOD ACPARPCOD,
					MALMST.MSTDOCNUM MSTDOCNUM,
                    MALMST.DOCOWRIDR DOCOWRIDR,
                    MALMST.SHPPFX SHPPFX,
					MALMST.SECSTACOD SECSTACOD
					FROM 
					 MALULDSEGDTL MALSEG 
                    INNER JOIN MALFLT FLT 
	                ON  MALSEG.CMPCOD = FLT.CMPCOD
                  AND MALSEG.FLTCARIDR =FLT .FLTCARIDR
                  AND MALSEG.FLTNUM = FLT.FLTNUM
                  AND MALSEG.FLTSEQNUM = FLT.FLTSEQNUM
					LEFT OUTER JOIN MALMST MALMST
					ON MALSEG.CMPCOD    =MALMST.CMPCOD
					AND MALSEG.MALSEQNUM=MALMST.MALSEQNUM
					LEFT OUTER JOIN MALDMGDTL DMGMAL
					ON MALMST.CMPCOD     = DMGMAL.CMPCOD
					AND MALMST.MALSEQNUM = DMGMAL.MALSEQNUM
					LEFT OUTER JOIN MALCSGMST CSGMST
					ON CSGMST.CMPCOD     = MALMST.CMPCOD
					AND CSGMST.CSGDOCNUM = MALMST.CSGDOCNUM
					AND CSGMST.POACOD    = MALMST.POACOD
					AND CSGMST.CSGSEQNUM = MALMST.CSGSEQNUM
					WHERE MALSEG.CMPCOD     = ?
					AND MALSEG.FLTCARIDR    = ?
					AND MALSEG.FLTNUM       = ?
					AND MALSEG.FLTSEQNUM    = ?
					AND MALSEG.SEGSERNUM    = ?
					AND FLT.ARPCOD          = ?
					AND MALSEG.ULDNUM       = ?
					ORDER BY DSN,
					ORGEXGOFC,
					DSTEXGOFC,
					YER,
					MALCTGCOD,
					MALSUBCLS,
					CSGDOCNUM,
					CSGSEQNUM,
					POACOD
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>602</QRY:Id>
		<QRY:Source Name="mail.operations.getPADetails" Type="NATIVE">
			<![CDATA[
				SELECT
				  POACOD,
				  POANAM,
				  LSTUPDTIM
			  FROM MALPOAMST
			  WHERE CMPCOD = ?
			]]>
		</QRY:Source>
	</QRY:Definition>   
 <QRY:Definition>
<QRY:Id>603</QRY:Id>
<QRY:Source Name="mail.operations.checkforsecurityscreeningvalidations" Type="NATIVE">
	<![CDATA[

SELECT CMPCOD, VLDIDR, VLDSEQNUM,ERRTYP,
ORGARPCOD ,ORGARPCODFLG ,
DSTARPCOD ,DSTARPCODFLG ,
TXNARPCOD,TXNARPCODFLG,
SECSTACOD,SECSTACODFLG,
FLTTYP,FLTTYPFLG,
ORGARPCNTGRP,ORGARPCNTGRPFLG,
DSTARPCNTGRP,DSTARPCNTGRPFLG,
TXNARPCNTGRP,TXNARPCNTGRPFLG,
TXNARPGRP,TXNARPGRPFLG,
SCCGRP ,SCCGRPFLG,
APLREGDSTCNTGRP,APLREGDSTCNTGRPFLG,
SUBCLS,SUBCLSFLG,
APLREG,APLREGFLG,
DSTARPCNT,DSTARPCNTFLG,
APLREGTRSCNT,APLREGTRSCNTFLG,
APLREGTRSCNTGRP,APLREGTRSCNTGRPFLG
FROM
(
SELECT PAR.CMPCOD, PAR.VLDIDR, PAR.SEQNUM VLDSEQNUM,MST.ERRTYP,
MAX(CASE WHEN PAR.PARCOD ='ORGARPCOD' THEN PAR.PARVAL END) ORGARPCOD,
MAX(CASE WHEN PAR.PARCOD ='ORGARPCOD' THEN PAR.EXCFLG END ) ORGARPCODFLG,
MAX(CASE WHEN PAR.PARCOD ='DSTARPCOD' THEN PAR.PARVAL END) DSTARPCOD,
MAX(CASE WHEN PAR.PARCOD ='DSTARPCOD' THEN PAR.EXCFLG END ) DSTARPCODFLG,
MAX(CASE WHEN PAR.PARCOD ='TXNARPCOD' THEN PAR.PARVAL END) TXNARPCOD,
MAX(CASE WHEN PAR.PARCOD ='TXNARPCOD' THEN PAR.EXCFLG END ) TXNARPCODFLG,
MAX(CASE WHEN PAR.PARCOD ='SECSTACOD' THEN PAR.PARVAL END ) SECSTACOD,
MAX(CASE WHEN PAR.PARCOD ='SECSTACOD' THEN PAR.EXCFLG END ) SECSTACODFLG,
MAX(CASE WHEN PAR.PARCOD ='FLTTYP' THEN PAR.PARVAL END ) FLTTYP,
MAX(CASE WHEN PAR.PARCOD ='FLTTYP' THEN PAR.EXCFLG END ) FLTTYPFLG,
MAX(CASE WHEN PAR.PARCOD ='ORGARPCNTGRP' THEN PAR.PARVAL END ) ORGARPCNTGRP,
MAX(CASE WHEN PAR.PARCOD ='ORGARPCNTGRP' THEN PAR.EXCFLG END ) ORGARPCNTGRPFLG,
MAX(CASE WHEN PAR.PARCOD ='DSTARPCNTGRP' THEN PAR.PARVAL END ) DSTARPCNTGRP,
MAX(CASE WHEN PAR.PARCOD ='DSTARPCNTGRP' THEN PAR.EXCFLG END ) DSTARPCNTGRPFLG,
MAX(CASE WHEN PAR.PARCOD ='TXNARPCNTGRP' THEN PAR.PARVAL END ) TXNARPCNTGRP,
MAX(CASE WHEN PAR.PARCOD ='TXNARPCNTGRP' THEN PAR.EXCFLG END ) TXNARPCNTGRPFLG,
MAX(CASE WHEN PAR.PARCOD ='TXNARPGRP' THEN PAR.PARVAL END ) TXNARPGRP,
MAX(CASE WHEN PAR.PARCOD ='TXNARPGRP' THEN PAR.EXCFLG END ) TXNARPGRPFLG,
MAX(CASE WHEN PAR.PARCOD ='SCCGRP' THEN PAR.PARVAL END ) SCCGRP,
MAX(CASE WHEN PAR.PARCOD ='SCCGRP' THEN PAR.EXCFLG END ) SCCGRPFLG,
MAX(CASE WHEN PAR.PARCOD ='APLREGDSTCNTGRP' THEN PAR.PARVAL END ) APLREGDSTCNTGRP,
MAX(CASE WHEN PAR.PARCOD ='APLREGDSTCNTGRP' THEN PAR.EXCFLG END ) APLREGDSTCNTGRPFLG,
MAX(CASE WHEN PAR.PARCOD ='SUBCLS' THEN PAR.PARVAL END ) SUBCLS,
MAX(CASE WHEN PAR.PARCOD ='SUBCLS' THEN PAR.EXCFLG END )SUBCLSFLG,
MAX(CASE WHEN PAR.PARCOD ='APLREG' THEN PAR.PARVAL END ) APLREG,
MAX(CASE WHEN PAR.PARCOD ='APLREG' THEN PAR.EXCFLG END )APLREGFLG,
MAX(CASE WHEN PAR.PARCOD ='DSTARPCNT' THEN PAR.PARVAL END ) DSTARPCNT,
MAX(CASE WHEN PAR.PARCOD ='DSTARPCNT' THEN PAR.EXCFLG END )DSTARPCNTFLG,
MAX(CASE WHEN PAR.PARCOD ='APLREGTRSCNT' THEN PAR.PARVAL END ) APLREGTRSCNT,
MAX(CASE WHEN PAR.PARCOD ='APLREGTRSCNT' THEN PAR.EXCFLG END )APLREGTRSCNTFLG,
MAX(CASE WHEN PAR.PARCOD ='APLREGTRSCNTGRP' THEN PAR.PARVAL END ) APLREGTRSCNTGRP,
MAX(CASE WHEN PAR.PARCOD ='APLREGTRSCNTGRP' THEN PAR.EXCFLG END ) APLREGTRSCNTGRPFLG
FROM  MALCSDVLDPAR PAR
INNER JOIN MALCSDVLDMST MST ON
MST.CMPCOD = PAR.CMPCOD AND
MST.VLDIDR = PAR.VLDIDR AND
MST.SEQNUM = PAR.SEQNUM 
WHERE PAR.CMPCOD = ?
AND MST.APPTXN=?
AND TRUNC(CURRENT_DATE) BETWEEN TRUNC(MST.VLDFRM) AND TRUNC(mst.VLDTOO)
GROUP BY PAR.CMPCOD, PAR.VLDIDR, PAR.SEQNUM, MST.ERRTYP
)VALPAR
WHERE
	]]>
</QRY:Source>
</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>604</QRY:Id>
		<QRY:Source Name="mail.operations.getOfficeOfExchangeDetails" Type="NATIVE">
			<![CDATA[
				SELECT exgofccod,EXGCODDES,CNTCOD,ARPCOD,LSTUPDTIM,POACOD
				FROM malexgofcmst
				WHERE cmpcod = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>605</QRY:Id>
	<QRY:Source Name="mail.operations.getPlannedRoutingIndexDetails" Type="NATIVE">
		<![CDATA[
				select rtgidx,orgcod,dstcod from MALRTGIDX
			]]>
	</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>606</QRY:Id>
		<QRY:Source Name="mail.operations.generateCN46consignmentdetailsreport" Type="NATIVE">
			<![CDATA[
					SELECT
					MALMST.CMPCOD CMPCOD,
					MALMST.POACOD POACOD,
					CURRENT_DATE CSGDAT,
					MALMST.LSTUPDTIM,
					MALMST.LSTUPDUSR,
					(SELECT EXGCODDES FROM MALEXGOFCMST
						WHERE CMPCOD = MALMST.CMPCOD
						AND EXGOFCCOD = ORGEXGOFC
					)ORGEXGOFCDES,
					(SELECT EXGCODDES FROM MALEXGOFCMST
						WHERE CMPCOD = MALMST.CMPCOD
						AND EXGOFCCOD = DSTEXGOFC
					)DSTEXGOFCDES,
					MALMST.DSN DSN,
					MALMST.ORGEXGOFC ORGEXGOFC,
					MALMST.DSTEXGOFC DSTEXGOFC,
					MALMST.MALCLS MALCLS,
					MALMST.YER YER,
					MALMST.MALSEQNUM MALSEQNUM,
					MALMST.MALIDR MALIDR,
					MALMST.MALCTG MALCTGCOD,
					MALMST.MALSUBCLS MALSUBCLS,
					MALMST.HSN HSN,
					MALMST.RSN RSN,
					MALMST.REGIND REGIND,
					MALMST.WGT WGT,
					1 BAGCNT,
					SEGDTL.ULDNUM,
					MALFLT.FLTOWN FLTCARCOD,
					SEGDTL.FLTNUM FLTNUM,
					MALFLT.FLTDAT FLTDAT,
					MALFLT.FLTOWN,
					MALFLT.FLTDAT FSTFLTDEPDAT,
					SEGDTL.FLTCARIDR FLTCARIDR,
					MALMST.ORGCOD POL,
					MALMST.DSTCOD POU,
					MALMST.FSTSCNARP ARPCOD,
					     (SELECT ARPNAM FROM SHRARPMST WHERE CMPCOD = MALMST.CMPCOD AND ARPCOD = MALFLT.FLTDST
  ) POLARPNAM,
  (SELECT ARPNAM FROM SHRARPMST WHERE CMPCOD = MALMST.CMPCOD AND ARPCOD = MALMST.DSTCOD
  ) POUARPNAM,
    (SELECT POANAM FROM MALPOAMST WHERE CMPCOD =MALMST.CMPCOD AND POACOD =MALMST.POACOD)OPRORG
           FROM MALTRFMFTDTL TRFDTL
			INNER JOIN MALMST MALMST ON MALMST.CMPCOD = TRFDTL.CMPCOD AND MALMST.MALSEQNUM = TRFDTL.MALSEQNUM 
			INNER JOIN MALTRFMFT TRFMST  ON TRFMST.CMPCOD = TRFDTL.CMPCOD AND TRFMST.TRFMFTIDR = TRFDTL.TRFMFTIDR
			INNER JOIN MALULDSEGDTL SEGDTL ON MALMST.MALSEQNUM = SEGDTL.MALSEQNUM AND MALMST.CMPCOD = SEGDTL.CMPCOD AND  TRFMST.FRMFLTNUM = SEGDTL.FLTNUM
			INNER JOIN FLTOPRMST MALFLT ON  SEGDTL.FLTNUM = MALFLT.FLTNUM AND SEGDTL.FLTCARIDR = MALFLT.FLTCARIDR AND SEGDTL.FLTSEQNUM = MALFLT.FLTSEQNUM
			WHERE NOT exists  (SELECT 1 FROM MALCSGMST WHERE CSGDOCNUM = MALMST.CSGDOCNUM ) AND
			TRFDTL.CMPCOD = ? AND 
			TRFDTL.TRFMFTIDR = ? 
					ORDER BY
					 MALMST.MALCTG,
					MALMST.POACOD,
					MALMST.ORGEXGOFC, 
					MALMST.DSN ,
					MALMST.DSTEXGOFC 
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>607</QRY:Id>
	<QRY:Source Name="mail.operations.generateCN46consignmentDetailsSummaryReport" Type="NATIVE">
	<![CDATA[
			SELECT
    max(CSGDOCNUM) CSGDOCNUM,
    DSN,
    ORGEXGOFC ,
    DSTEXGOFC,
    max(YER) YER ,
     MALCTGCOD,
    max( MALSUBCLS) MALSUBCLS ,
    SUM(WGT) WGT ,
    SUM(PCS) PCS,
    max(CSGDAT)CSGDAT,
    max (CSGTYP) CSGTYP,
    max(RMK) RMK,
    max(ARPCOD)ARPCOD ,
    max(SUBTYP) SUBTYP,
    max(ULDNUM) ULDNUM,
    max(POACOD) POACOD,
    max(FLTRUT) FLTRUT,
    max( SUBCLSGRP) SUBCLSGRP,
    max(ARLNAM)ARLNAM,
    max(FSTFLTDEPDAT)FSTFLTDEPDAT,
    max(POANAM) POANAM,
    max(FLTNUM) FLTNUM,
    max(FLTDAT)FLTDAT,
    max(POU) POU,
    max(POL) POL,
	max (AIRTRANS) AIRTRANS,
    max(FLTCARCOD)FLTCARCOD,
    max(RTGSERNUM)RTGSERNUM,
    max(ORGEXGOFCDES) ORGEXGOFCDES,
    max(DSTEXGOFCDES) DSTEXGOFCDES,
    max(OPRORG) OPRORG,
    max(OPRDST) OPRDST,
    max(CONSELNUM) CONSELNUM,
    max(TRPMNS) TRPMNS,
    max(CSGPRI) CSGPRI,
    max(FLTTYP) FLTTYP,
    max(TRFFLTNUM)TRFFLTNUM,
    max(TRFFLTDAT) TRFFLTDAT,
    max(TRFCARCOD) TRFCARCOD,
    MAX(POLARPNAM) POLARPNAM,
    MAX(POUARPNAM) POUARPNAM,
    SUM(LCCOUNT) LCCOUNT,
    SUM(CPCOUNT) CPCOUNT,
    SUM(EMSCOUNT) EMSCOUNT,
    SUM(SVCOUNT) SVCOUNT,
    SUM(LCWEIGHT) LCWEIGHT,
    SUM(CPWEIGHT) CPWEIGHT,
    SUM(EMSWEIGHT) EMSWEIGHT,
    SUM(SVWEIGHT) SVWEIGHT
    FROM
        (SELECT MALMST.CMPCOD CMPCOD,
        null CSGDOCNUM,
        MALMST.POACOD POACOD,
        NULL CSGSEQNUM,
        CURRENT_DATE CSGDAT,
        NULL OPRTYP ,
        NULL CSGTYP,
        NULL RMK,
        NULL STDBAG,
        NULL STDWGT,
        NULL ARPCOD,
        NULL SUBTYP,
        (SELECT POANAM FROM MALPOAMST WHERE CMPCOD =MALMST.CMPCOD AND POACOD =MALMST.POACOD)POANAM,
        NULL FSTFLTDEPDAT,
        MALMST.DSN DSN,
        MALMST.ORGEXGOFC ORGEXGOFC,
        MALMST.DSTEXGOFC DSTEXGOFC,
        MALMST.YER YER,
        MALMST.MALCTG MALCTGCOD,
        MALMST.MALSUBCLS MALSUBCLS,
        COALESCE(SEGDTL.ULDNUM,'N') ULDNUM,
        0 RTGSERNUM,
        FLT.FLTOWN FLTCARCOD,
        FLT.FLTNUM FLTNUM,
        FLT.FLTDAT FLTDAT,
        FLT.FLTORG POL,
        MALMST.DSTCOD POU,
		FLT.FLTDST AIRTRANS,
        NULL FLTRUT,
        SUBCLS.SUBCLSGRP,
        ARL.ARLNAM,
        MALMST.WGT,
        1 PCS,
        (SELECT EXGCODDES FROM MALEXGOFCMST WHERE CMPCOD = MALMST.CMPCOD AND EXGOFCCOD = ORGEXGOFC)ORGEXGOFCDES,
        (SELECT EXGCODDES FROM MALEXGOFCMST WHERE CMPCOD = MALMST.CMPCOD AND EXGOFCCOD = DSTEXGOFC )DSTEXGOFCDES,
        NULL OPRORG,
        NULL OPRDST,
        MALMST.SELNUM CONSELNUM  ,
        NULL TRPMNS,
        NULL CSGPRI,
        FLT.FLTTYP FLTTYP,
        TRFMST.FRMFLTNUM  TRFFLTNUM,
        TRFMST.FRMFLTDAT TRFFLTDAT,
        TRFMST.FRMCARCOD TRFCARCOD,
        (SELECT ARPNAM FROM SHRARPMST WHERE CMPCOD = MALMST.CMPCOD AND ARPCOD = FLT.FLTDST) POLARPNAM,
        (SELECT ARPNAM FROM SHRARPMST WHERE CMPCOD = MALMST.CMPCOD AND ARPCOD = MALMST.DSTCOD) POUARPNAM,
		CASE WHEN SUBCLSGRP = 'LC' THEN 1 ELSE 0 END LCCOUNT,
		CASE WHEN SUBCLSGRP = 'CP' THEN 1 ELSE 0 END CPCOUNT,
		CASE WHEN SUBCLSGRP = 'EMS' THEN 1 ELSE 0 END EMSCOUNT,
		CASE WHEN SUBCLSGRP = 'SV' THEN 1 ELSE 0 END SVCOUNT,
		CASE WHEN SUBCLSGRP = 'LC' THEN MALMST.WGT ELSE 0 END LCWEIGHT,
		CASE WHEN SUBCLSGRP = 'CP' THEN MALMST.WGT ELSE 0 END CPWEIGHT,
		CASE WHEN SUBCLSGRP = 'EMS' THEN MALMST.WGT ELSE 0 END EMSWEIGHT,
		CASE WHEN SUBCLSGRP = 'SV' THEN MALMST.WGT ELSE 0 END SVWEIGHT
        FROM  MALTRFMFTDTL TRFDTL 
        INNER JOIN MALMST MALMST ON MALMST.CMPCOD = TRFDTL.CMPCOD AND MALMST.MALSEQNUM = TRFDTL.MALSEQNUM 
        INNER JOIN MALTRFMFT TRFMST ON TRFMST.CMPCOD = TRFDTL.CMPCOD AND TRFMST.TRFMFTIDR = TRFDTL.TRFMFTIDR
        INNER JOIN MALULDSEGDTL SEGDTL ON MALMST.MALSEQNUM = SEGDTL.MALSEQNUM AND MALMST.CMPCOD = SEGDTL.CMPCOD and TRFMST.FRMFLTNUM = segdtl.FLTNUM
        INNER JOIN  MALSUBCLSMST SUBCLS ON MALMST.CMPCOD = SUBCLS.CMPCOD AND MALMST.MALSUBCLS = SUBCLS.SUBCLSCOD
        INNER JOIN  SHRARLMST ARL ON MALMST.CMPCOD = ARL.CMPCOD AND MALMST.FLTCARIDR = ARL.ARLIDR
        INNER JOIN FLTOPRMST FLT ON FLT.CMPCOD     = SEGDTL.CMPCOD AND FLT.FLTCARIDR = SEGDTL.FLTCARIDR AND FLT.FLTNUM    = SEGDTL.FLTNUM AND FLT.FLTSEQNUM = SEGDTL.FLTSEQNUM
        WHERE NOT exists  (SELECT 1 FROM MALCSGMST WHERE CSGDOCNUM = MALMST.CSGDOCNUM ) AND
		TRFDTL.CMPCOD  = ?
        AND TRFDTL.TRFMFTIDR = ?
        ) MST
        GROUP BY ORGEXGOFC,DSTEXGOFC,DSN,MALCTGCOD,POACOD
        order by MALCTGCOD,POACOD,ORGEXGOFC
	]]>
	</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>608</QRY:Id>
		<QRY:Source Name="mail.operations.getMailbagDetails" Type="NATIVE">
			<![CDATA[
WITH malmstfull AS (
    SELECT
        mst.*
    FROM
        malmst mst,
        malhis his
    WHERE
        mst.cmpcod = his.cmpcod
        AND mst.malseqnum = his.malseqnum
        AND his.malhisidr = (
            SELECT
                MAX(malhisidr)
            FROM
                malhis hiskey
            WHERE
                hiskey.cmpcod = his.cmpcod
                AND hiskey.malseqnum = his.malseqnum
        )
        AND coalesce(intflg, 'N') = 'N'
        AND mst.dspdat > current_date - ?
        AND 1 = CASE
            WHEN mst.malsta = 'DLV' THEN 1
            WHEN mst.malsta != 'DLV'
                 AND his.utcscndat < ? THEN 1
            ELSE 0
        END
)
SELECT
    *
FROM
    (
        SELECT
            mst.malseqnum,
            mst.malidr,
            mst.wgt,
            arlmst.twoaphcod,
            seg.fltnum,
            fltseg.pol,
            fltseg.pou,
            leg.std,
            leg.stdutc,
            leg.sta,
            leg.stautc,
            his.inbsrc,
            his.outsrc,
            rdt.inbevtcod
            || CASE
                WHEN rdtdlvtra.inbdlvtra IS NOT NULL THEN ',' || rdtdlvtra.inbdlvtra
                ELSE ''
            END inbevtcod,
            CASE
                WHEN outacp.outacpscn IS NOT NULL THEN outacp.outacpscn
                                                       || ','
                                                       || rdt.outevtcod
                ELSE rdt.outevtcod
            END outevtcod,
            rdt.inbscnprt,
            rdt.outscnprt,
            seg.connum,
            hba.hbatyp,
            hba.hbapos
        FROM
            malmstfull mst
            INNER JOIN maluldsegdtl seg ON mst.cmpcod = seg.cmpcod
                                           AND mst.malseqnum = seg.malseqnum
            INNER JOIN shrarlmst arlmst ON arlmst.cmpcod = seg.cmpcod
                                           AND arlmst.arlidr = seg.fltcaridr
            INNER JOIN malfltseg fltseg ON fltseg.cmpcod = seg.cmpcod
                                           AND fltseg.fltcaridr = seg.fltcaridr
                                           AND fltseg.fltnum = seg.fltnum
                                           AND fltseg.fltseqnum = seg.fltseqnum
                                           AND fltseg.segsernum = seg.segsernum
            INNER JOIN malfltcon fltcon ON fltcon.cmpcod = seg.cmpcod
                                           AND fltcon.fltcaridr = seg.fltcaridr
                                           AND fltcon.fltnum = seg.fltnum
                                           AND fltcon.fltseqnum = seg.fltseqnum
                                           AND fltcon.segsernum = seg.segsernum
                                           AND fltcon.connum = seg.connum
            INNER JOIN fltoprleg leg ON leg.cmpcod = fltseg.cmpcod
                                        AND leg.fltcaridr = fltseg.fltcaridr
                                        AND leg.fltnum = fltseg.fltnum
                                        AND leg.fltseqnum = fltseg.fltseqnum
                                        AND leg.legorg = fltseg.pol
            LEFT OUTER JOIN malfltconhbadtl hba ON fltcon.cmpcod = hba.cmpcod
                                                   AND fltcon.uldrefnum = hba.uldrefnum
            LEFT OUTER JOIN (
                SELECT
                    cmpcod,
                    malseqnum,
                    fltcaridr,
                    fltnum,
                    fltseqnum,
                    segsernum,
                    MAX(inbsrc) inbsrc,
                    MAX(outsrc) outsrc
                FROM
                    (
                        SELECT
                            his.cmpcod,
                            his.malseqnum,
                            his.fltcaridr,
                            his.fltnum,
                            his.fltseqnum,
                            his.segsernum,
                            CASE
                                WHEN malmst.malsta != 'DLV'
                                     AND his.malsta IN (
                                    'ARR',
                                    'DLV'
                                ) THEN 'A'
                                WHEN his.malsta IN (
                                    'ARR',
                                    'DLV'
                                )
                                     AND upper(his.malsrc) LIKE 'MTK%' THEN 'M'
                                WHEN his.malsta IN (
                                    'ARR',
                                    'DLV'
                                ) THEN 'S'
                            END inbsrc,
                            CASE
                                WHEN malmst.malsta != 'DLV'
                                     AND his.malsta IN (
                                    'ACP',
                                    'ASG'
                                ) THEN 'A'
                                WHEN his.malsta IN (
                                    'ACP',
                                    'ASG'
                                )
                                     AND upper(his.malsrc) LIKE 'MTK%' THEN 'M'
                                WHEN his.malsta IN (
                                    'ACP',
                                    'ASG'
                                ) THEN 'S'
                            END outsrc
                        FROM
                            malhis his
                            INNER JOIN malmst ON ( his.cmpcod = malmst.cmpcod
                                                   AND his.malseqnum = malmst.malseqnum )
                        WHERE
                            his.malsta IN (
                                'ACP',
                                'ASG',
                                'ARR',
                                'DLV'
                            )
                    ) hisdtl
                GROUP BY
                    cmpcod,
                    malseqnum,
                    fltcaridr,
                    fltnum,
                    fltseqnum,
                    segsernum
            ) his ON his.cmpcod = mst.cmpcod
                     AND his.malseqnum = mst.malseqnum
                     AND his.fltcaridr = seg.fltcaridr
                     AND his.fltnum = seg.fltnum
                     AND his.fltseqnum = seg.fltseqnum
                     AND his.segsernum = seg.segsernum
            LEFT OUTER JOIN (
                SELECT
                    cmpcod,
                    malseqnum,
                    fltcaridr,
                    fltnum,
                    fltseqnum,
                    segsernum,
                    LISTAGG(inbevtcod, ',') WITHIN GROUP(
                        ORDER BY
                            inbevtcod
                    ) inbevtcod,
                    MAX(inbscnprt) inbscnprt,
                    LISTAGG(outevtcod, ',') WITHIN GROUP(
                        ORDER BY
                            outevtcod
                    ) outevtcod,
                    MAX(outscnprt) outscnprt
                FROM
                    (
                        SELECT
                            cmpcod,
                            malseqnum,
                            fltcaridr,
                            fltnum,
                            fltseqnum,
                            segsernum,
                            CASE
                                WHEN evtcod IN (
                                    '40',
                                    '21',
                                    '42'
                                ) THEN evtcod
                                ELSE NULL
                            END inbevtcod,
                            CASE
                                WHEN evtcod IN (
                                    '40',
                                    '21',
                                    '42'
                                ) THEN evtprt
                                ELSE NULL
                            END inbscnprt,
                            CASE
                                WHEN evtcod IN (
                                    '6'
                                ) THEN evtcod
                                ELSE NULL
                            END outevtcod,
                            CASE
                                WHEN evtcod IN (
                                    '6'
                                ) THEN evtprt
                                ELSE NULL
                            END outscnprt
                        FROM
                            malrdt rdt
                        WHERE
                            evtcod IN (
                                '40',
                                '21',
                                '42',
                                '6'
                            )
                            AND rdtsnd = 'G'
                    ) mst
                GROUP BY
                    cmpcod,
                    malseqnum,
                    fltcaridr,
                    fltnum,
                    fltseqnum,
                    segsernum
            ) rdt ON mst.cmpcod = rdt.cmpcod
                     AND mst.malseqnum = rdt.malseqnum
                     AND seg.fltcaridr = rdt.fltcaridr
                     AND seg.fltnum = rdt.fltnum
                     AND seg.fltseqnum = rdt.fltseqnum
                     AND seg.segsernum = rdt.segsernum
            LEFT OUTER JOIN (
                SELECT
                    cmpcod,
                    malseqnum,
                    evtprt,
                    LISTAGG(inbdlvtra, ',') WITHIN GROUP(
                        ORDER BY
                            inbdlvtra
                    ) inbdlvtra
                FROM
                    (
                        SELECT
                            cmpcod,
                            malseqnum,
                            evtprt,
                            CASE
                                WHEN evtcod IN (
                                    '21',
                                    '42'
                                ) THEN evtcod
                                ELSE NULL
                            END inbdlvtra
                        FROM
                            malrdt rdt
                        WHERE
                            evtcod IN (
                                '21',
                                '42'
                            )
                            AND fltseqnum <= 0
                            AND rdtsnd = 'G'
                    ) rdtdlvtra
                GROUP BY
                    cmpcod,
                    malseqnum,
                    evtprt
            ) rdtdlvtra ON seg.cmpcod = rdtdlvtra.cmpcod
                           AND seg.malseqnum = rdtdlvtra.malseqnum
                           AND fltseg.pou = rdtdlvtra.evtprt
            LEFT OUTER JOIN (
                SELECT
                    cmpcod,
                    malseqnum,
                    evtprt,
                    LISTAGG(outacpscn, ',') WITHIN GROUP(
                        ORDER BY
                            outacpscn
                    ) outacpscn
                FROM
                    (
                        SELECT
                            cmpcod,
                            malseqnum,
                            evtprt,
                            CASE
                                WHEN evtcod IN (
                                    '74'
                                ) THEN evtcod
                                ELSE NULL
                            END outacpscn
                        FROM
                            malrdt rdt
                        WHERE
                            evtcod IN (
                                '74'
                            )
                            AND fltseqnum <= 0
                            AND rdtsnd = 'G'
                    ) outacp
                GROUP BY
                    cmpcod,
                    malseqnum,
                    evtprt
            ) outacp ON seg.cmpcod = outacp.cmpcod
                        AND seg.malseqnum = outacp.malseqnum
                        AND fltseg.pol = outacp.evtprt
    ) maldat
ORDER BY
    malseqnum,
    std
				]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>609</QRY:Id>
		<QRY:Source Name="mail.operations.getMailbagDetailsForOracle" Type="NATIVE">
			<![CDATA[
				WITH malmstfull AS (
    SELECT
        mst.*
    FROM
        malmst mst,
        malhis his
    WHERE
        mst.cmpcod = his.cmpcod
        AND mst.malseqnum = his.malseqnum
        AND his.malhisidr = (
            SELECT
                MAX(malhisidr)
            FROM
                malhis hiskey
            WHERE
                hiskey.cmpcod = his.cmpcod
                AND hiskey.malseqnum = his.malseqnum
        )
        AND coalesce(intflg, 'N') = 'N'
        AND mst.dspdat > current_date - ?
        AND 1 = CASE
            WHEN mst.malsta = 'DLV' THEN 1
            WHEN mst.malsta != 'DLV'
                 AND his.utcscndat < ? THEN 1
            ELSE 0
        END
)
SELECT
    *
FROM
    (
        SELECT
            mst.malseqnum,
            mst.malidr,
            mst.wgt,
            arlmst.twoaphcod,
            seg.fltnum,
            fltseg.pol,
            fltseg.pou,
            leg.std,
            leg.stdutc,
            leg.sta,
            leg.stautc,
            his.inbsrc,
            his.outsrc,
            rdt.inbevtcod
            || CASE
                WHEN rdtdlvtra.inbdlvtra IS NOT NULL THEN ',' || rdtdlvtra.inbdlvtra
                ELSE ''
            END inbevtcod,
            CASE
                WHEN outacp.outacpscn IS NOT NULL THEN outacp.outacpscn
                                                       || ','
                                                       || rdt.outevtcod
                ELSE rdt.outevtcod
            END outevtcod,
            rdt.inbscnprt,
            rdt.outscnprt,
            seg.connum,
            hba.hbatyp,
            hba.hbapos
        FROM
            malmstfull mst
            INNER JOIN maluldsegdtl seg ON mst.cmpcod = seg.cmpcod
                                           AND mst.malseqnum = seg.malseqnum
            INNER JOIN shrarlmst arlmst ON arlmst.cmpcod = seg.cmpcod
                                           AND arlmst.arlidr = seg.fltcaridr
            INNER JOIN malfltseg fltseg ON fltseg.cmpcod = seg.cmpcod
                                           AND fltseg.fltcaridr = seg.fltcaridr
                                           AND fltseg.fltnum = seg.fltnum
                                           AND fltseg.fltseqnum = seg.fltseqnum
                                           AND fltseg.segsernum = seg.segsernum
            INNER JOIN malfltcon fltcon ON fltcon.cmpcod = seg.cmpcod
                                           AND fltcon.fltcaridr = seg.fltcaridr
                                           AND fltcon.fltnum = seg.fltnum
                                           AND fltcon.fltseqnum = seg.fltseqnum
                                           AND fltcon.segsernum = seg.segsernum
                                           AND fltcon.connum = seg.connum
            INNER JOIN fltoprleg leg ON leg.cmpcod = fltseg.cmpcod
                                        AND leg.fltcaridr = fltseg.fltcaridr
                                        AND leg.fltnum = fltseg.fltnum
                                        AND leg.fltseqnum = fltseg.fltseqnum
                                        AND leg.legorg = fltseg.pol
            LEFT OUTER JOIN malfltconhbadtl hba ON fltcon.cmpcod = hba.cmpcod
                                                   AND fltcon.uldrefnum = hba.uldrefnum
            LEFT OUTER JOIN (
                SELECT
                    cmpcod,
                    malseqnum,
                    fltcaridr,
                    fltnum,
                    fltseqnum,
                    segsernum,
                    MAX(inbsrc) inbsrc,
                    MAX(outsrc) outsrc
                FROM
                    (
                        SELECT
                            his.cmpcod,
                            his.malseqnum,
                            his.fltcaridr,
                            his.fltnum,
                            his.fltseqnum,
                            his.segsernum,
                            CASE
                                WHEN malmst.malsta != 'DLV'
                                     AND his.malsta IN (
                                    'ARR',
                                    'DLV'
                                ) THEN 'A'
                                WHEN his.malsta IN (
                                    'ARR',
                                    'DLV'
                                )
                                     AND upper(his.malsrc) LIKE 'MTK%' THEN 'M'
                                WHEN his.malsta IN (
                                    'ARR',
                                    'DLV'
                                ) THEN 'S'
                            END inbsrc,
                            CASE
                                WHEN malmst.malsta != 'DLV'
                                     AND his.malsta IN (
                                    'ACP',
                                    'ASG'
                                ) THEN 'A'
                                WHEN his.malsta IN (
                                    'ACP',
                                    'ASG'
                                )
                                     AND upper(his.malsrc) LIKE 'MTK%' THEN 'M'
                                WHEN his.malsta IN (
                                    'ACP',
                                    'ASG'
                                ) THEN 'S'
                            END outsrc
                        FROM
                            malhis his
                            INNER JOIN malmst ON ( his.cmpcod = malmst.cmpcod
                                                   AND his.malseqnum = malmst.malseqnum )
                        WHERE
                            his.malsta IN (
                                'ACP',
                                'ASG',
                                'ARR',
                                'DLV'
                            )
                    ) hisdtl
                GROUP BY
                    cmpcod,
                    malseqnum,
                    fltcaridr,
                    fltnum,
                    fltseqnum,
                    segsernum
            ) his ON his.cmpcod = mst.cmpcod
                     AND his.malseqnum = mst.malseqnum
                     AND his.fltcaridr = seg.fltcaridr
                     AND his.fltnum = seg.fltnum
                     AND his.fltseqnum = seg.fltseqnum
                     AND his.segsernum = seg.segsernum
            LEFT OUTER JOIN (
                SELECT
                    cmpcod,
                    malseqnum,
                    fltcaridr,
                    fltnum,
                    fltseqnum,
                    segsernum,
                    LISTAGG(inbevtcod, ',') WITHIN GROUP(
                        ORDER BY
                            inbevtcod
                    ) inbevtcod,
                    MAX(inbscnprt) inbscnprt,
                    LISTAGG(outevtcod, ',') WITHIN GROUP(
                        ORDER BY
                            outevtcod
                    ) outevtcod,
                    MAX(outscnprt) outscnprt
                FROM
                    (
                        SELECT
                            cmpcod,
                            malseqnum,
                            fltcaridr,
                            fltnum,
                            fltseqnum,
                            segsernum,
                            CASE
                                WHEN evtcod IN (
                                    '40',
                                    '21',
                                    '42'
                                ) THEN evtcod
                                ELSE NULL
                            END inbevtcod,
                            CASE
                                WHEN evtcod IN (
                                    '40',
                                    '21',
                                    '42'
                                ) THEN evtprt
                                ELSE NULL
                            END inbscnprt,
                            CASE
                                WHEN evtcod IN (
                                    '6'
                                ) THEN evtcod
                                ELSE NULL
                            END outevtcod,
                            CASE
                                WHEN evtcod IN (
                                    '6'
                                ) THEN evtprt
                                ELSE NULL
                            END outscnprt
                        FROM
                            malrdt rdt
                        WHERE
                            evtcod IN (
                                '40',
                                '21',
                                '42',
                                '6'
                            )
                            AND rdtsnd = 'G'
                    ) mst
                GROUP BY
                    cmpcod,
                    malseqnum,
                    fltcaridr,
                    fltnum,
                    fltseqnum,
                    segsernum
            ) rdt ON mst.cmpcod = rdt.cmpcod
                     AND mst.malseqnum = rdt.malseqnum
                     AND seg.fltcaridr = rdt.fltcaridr
                     AND seg.fltnum = rdt.fltnum
                     AND seg.fltseqnum = rdt.fltseqnum
                     AND seg.segsernum = rdt.segsernum
            LEFT OUTER JOIN (
                SELECT
                    cmpcod,
                    malseqnum,
                    evtprt,
                    LISTAGG(inbdlvtra, ',') WITHIN GROUP(
                        ORDER BY
                            inbdlvtra
                    ) inbdlvtra
                FROM
                    (
                        SELECT
                            cmpcod,
                            malseqnum,
                            evtprt,
                            CASE
                                WHEN evtcod IN (
                                    '21',
                                    '42'
                                ) THEN evtcod
                                ELSE NULL
                            END inbdlvtra
                        FROM
                            malrdt rdt
                        WHERE
                            evtcod IN (
                                '21',
                                '42'
                            )
                            AND fltseqnum <= 0
                            AND rdtsnd = 'G'
                    ) rdtdlvtra
                GROUP BY
                    cmpcod,
                    malseqnum,
                    evtprt
            ) rdtdlvtra ON seg.cmpcod = rdtdlvtra.cmpcod
                           AND seg.malseqnum = rdtdlvtra.malseqnum
                           AND fltseg.pou = rdtdlvtra.evtprt
            LEFT OUTER JOIN (
                SELECT
                    cmpcod,
                    malseqnum,
                    evtprt,
                    LISTAGG(outacpscn, ',') WITHIN GROUP(
                        ORDER BY
                            outacpscn
                    ) outacpscn
                FROM
                    (
                        SELECT
                            cmpcod,
                            malseqnum,
                            evtprt,
                            CASE
                                WHEN evtcod IN (
                                    '74'
                                ) THEN evtcod
                                ELSE NULL
                            END outacpscn
                        FROM
                            malrdt rdt
                        WHERE
                            evtcod IN (
                                '74'
                            )
                            AND fltseqnum <= 0
                            AND rdtsnd = 'G'
                    ) outacp
                GROUP BY
                    cmpcod,
                    malseqnum,
                    evtprt
            ) outacp ON seg.cmpcod = outacp.cmpcod
                        AND seg.malseqnum = outacp.malseqnum
                        AND fltseg.pol = outacp.evtprt
    ) maldat
ORDER BY
    malseqnum,
    std
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>610</QRY:Id>
		<QRY:Source Name="mail.operations.getSubclassDetails" Type="NATIVE">
			<![CDATA[
			SELECT
				SUBCLSCOD,
				DES,
				LSTUPDTIM
			FROM
				MALSUBCLSMST
			WHERE
				CMPCOD = ?
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>611</QRY:Id>
	<QRY:Source Name="mail.operations.getExchangeOfficeDetails" Type="NATIVE">
		<![CDATA[
			SELECT
				MST.CNTCOD,
				MST.CTYCOD,
				MST.EXGOFCCOD,
				MST.POACOD,
				MST.ARPCOD
			FROM
				MALEXGOFCMST MST
			LEFT
			OUTER JOIN SHRARPMST ARP ON
				MST.CTYCOD = ARP.CTYCOD
				AND MST.CMPCOD = ARP.CMPCOD
			WHERE
				MST.CMPCOD = ?
				AND (MST.ARPCOD = ?
				OR ARP.ARPCOD = ?)
			UNION
			SELECT
				MST.CNTCOD,
				MST.CTYCOD,
				MST.EXGOFCCOD,
				MST.POACOD,
				MST.ARPCOD
			FROM
				MALEXGOFCMST MST
			LEFT OUTER JOIN MALCTSARP CTS ON
				MST.CMPCOD = CTS.CMPCOD
				AND MST.POACOD = CTS.GPACOD
			WHERE
				CTS.RSDMOD IN ('21')
				AND INSTR(CTS.ARPCOD ,
				MST.ARPCOD)>0
				AND INSTR(CTS.ARPCOD ,	?)>0
		]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>612</QRY:Id>
		<QRY:Source Name="mail.operations.getMailbagDetailsForValidationFirstPart" Type="NATIVE">
			<![CDATA[
				select distinct * from (with arpgrp as(
				select arpmst.arpcod arpcod,arpmst.ctycod ctycod,ARPMST.CMPCOD CMPCOD from shrarpmst arp
				inner join shrctymst cty
				on arp.cmpcod = cty.cmpcod
				and arp.ctycod = cty.ctycod
				left outer join shrarpmst arpmst on
				cty.cmpcod = arpmst.cmpcod
				and cty.ctycod = arpmst.ctycod
				where arp.arpcod = ?
				and arp.cmpcod = ?
				),
				ctsarp as(
				select cts.cmpcod,cts.arpcod , cts.RSDMOD,cts.gpacod
				from malctsarp cts
				where instr(cts.arpcod,?) >0
				and cts.cmpcod = ?
				)
				SELECT malseqnum,malidr,orgcod,dstcod,poacod,latacttim,orgexgofc,dstexgofc,malctg,malsubcls,MST.DSPDAT,SECSTACOD
				FROM MALMST  MST INNER JOIN SHRSYSPAR DOM
				  ON DOM.cmpcod = ?
				  AND DOM.parcod   = 'mail.operations.domesticcarditcache'
				  INNER JOIN SHRSYSPAR INT
				  ON INT.cmpcod = ?
				  AND INT.parcod   = 'mail.operations.internationalcarditcache'
				LEFT OUTER JOIN arpgrp
				ON MST.CMPCOD = ARPGRP.CMPCOD
				WHERE (MST.ORGCOD =? OR MST.DSTCOD = arpgrp.arpcod)
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>613</QRY:Id>
		<QRY:Source Name="mail.operations.getMailbagDetailsForValidationSecondPart" Type="NATIVE">
			<![CDATA[
				union all
				SELECT malseqnum,malidr,orgcod,dstcod,poacod,latacttim,orgexgofc,dstexgofc,malctg,malsubcls,MST.DSPDAT,SECSTACOD
				FROM MALMST  MST INNER JOIN SHRSYSPAR DOM
				  ON DOM.cmpcod = ?
				  AND DOM.parcod   = 'mail.operations.domesticcarditcache'
				  INNER JOIN SHRSYSPAR INT
				  ON INT.cmpcod = ?
				  AND INT.parcod   = 'mail.operations.internationalcarditcache'
				LEFT OUTER JOIN ctsarp
				ON MST.CMPCOD = ctsarp.CMPCOD
				AND (instr(ctsarp.arpcod ,mst.orgcod) >0 and ctsarp.RSDMOD in ('74','24') or  (instr(ctsarp.arpcod , MST.DSTCOD ) >0 and ctsarp.RSDMOD in ('21')))
			]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>614</QRY:Id>
	<QRY:Source Name="mail.operations.findCN46TransferManifestDetails" Type="NATIVE">
		<![CDATA[
			SELECT DISTINCT
				MAL.CSGDOCNUM,
				MAL.POACOD,
				MAL.CMPCOD
			FROM
				MALTRFMFT TRFMST
				INNER JOIN MALTRFMFTDTL TRFDTL ON TRFMST.CMPCOD = TRFDTL.CMPCOD
												  AND TRFMST.TRFMFTIDR = TRFDTL.TRFMFTIDR
				INNER JOIN MALMST MAL ON MAL.CMPCOD = TRFDTL.CMPCOD
											  AND MAL.MALSEQNUM = TRFDTL.MALSEQNUM
			WHERE
			    MAL.CSGDOCNUM is  null
				AND TRFMST.CMPCOD = ?
				AND TRFMST.TRFMFTIDR = ?
	]]>
	</QRY:Source>
	</QRY:Definition>
	
		 <QRY:Definition>
	<QRY:Id>615</QRY:Id>
	<QRY:Source Name="mail.operations.finddensityfactorforpostalauthority" Type="NATIVE">
		<![CDATA[

		SELECT DTL.PARVAL
		FROM MALPOADTL DTL
		WHERE DTL.CMPCOD = ?
		AND DTL.POACOD   = ?
		AND DTL.PARCOD   ='DNCFAC'
		AND TRUNC(current_date) BETWEEN TRUNC(DTL.VLDFRM) AND TRUNC(DTL.VLDTOO)

			]]>
	</QRY:Source>
  </QRY:Definition>	 
	<QRY:Definition>
		<QRY:Id>616</QRY:Id>
		<QRY:Source Name="mail.operations.findapplicableregulationflagformailbag" Type="NATIVE">
		<![CDATA[ SELECT
    DTL.APLREGFLG APLREGFLG,DTL.SERNUM SERNUM
FROM
    MALCSGCSDDTL   DTL,
    MALMST         MST
WHERE
    MST.CMPCOD = DTL.CMPCOD
    AND MST.MALSEQNUM = DTL.MALSEQNUM
    AND DTL.CMPCOD = ?
    AND DTL.SCRLVL = 'M'
    AND MST.MALSEQNUM = ?
    AND DTL.SCRDTLTYP = 'AR' 
    AND DTL.SERNUM=(SELECT MAX(SERNUM) FROM MALCSGCSDDTL MALCSDDTL WHERE 
    MST.CMPCOD = MALCSDDTL.CMPCOD
    AND MST.MALSEQNUM = MALCSDDTL.MALSEQNUM)
UNION ALL
SELECT
    DTL.APLREGFLG APLREGFLG,DTL.SERNUM SERNUM
FROM
    MALCSGCSDDTL   DTL,
    MALCSGMST      MSTCSG,
    MALMST         MST
WHERE
    MST.CMPCOD = DTL.CMPCOD
    AND MSTCSG.CSGDOCNUM = DTL.CSGDOCNUM
    AND MSTCSG.CSGSEQNUM = DTL.CSGSEQNUM
    AND MSTCSG.POACOD = DTL.POACOD
    AND MSTCSG.CMPCOD = MST.CMPCOD
    AND MSTCSG.CSGDOCNUM = MST.CSGDOCNUM
    AND MSTCSG.CSGSEQNUM = MST.CSGSEQNUM
    AND MSTCSG.POACOD = MST.POACOD
    AND DTL.CMPCOD = ?
    AND DTL.SCRLVL = 'C'
    AND MST.MALSEQNUM = ?
    AND DTL.SCRDTLTYP = 'AR' 
    AND DTL.SERNUM=(SELECT MAX(SERNUM) FROM MALCSGCSDDTL CSDDTL WHERE 
    MST.CMPCOD = CSDDTL.CMPCOD
    AND MSTCSG.CSGDOCNUM = CSDDTL.CSGDOCNUM
    AND MSTCSG.CSGSEQNUM = CSDDTL.CSGSEQNUM
    AND MSTCSG.POACOD = CSDDTL.POACOD
    AND MSTCSG.CMPCOD = MST.CMPCOD
    AND MSTCSG.CSGDOCNUM = MST.CSGDOCNUM
    AND MSTCSG.CSGSEQNUM = MST.CSGSEQNUM
    AND MSTCSG.POACOD = MST.POACOD)
    ORDER BY SERNUM DESC
	]]>
	</QRY:Source>
	</QRY:Definition>	
	 <QRY:Definition>
	<QRY:Id>617</QRY:Id>
	<QRY:Source Name="mail.operations.preadvicedetailsforflight" Type="NATIVE">
		<![CDATA[
SELECT
                                SUM(malmst.wgt) rcpwgt,
                                malmst.cmpcod   cmpcod,
                                trt.fltcaridr   fltcaridr,
                                trt.fltnum      fltnum,
                                trt.fltseqnum,
                                MAX(trt.fltdat) deptim,
                                COUNT(malmst.malseqnum) rcpidrcnt
                            FROM
                                malcsgmst csgmst
                                INNER JOIN malcsgdtl csgdtl ON csgmst.cmpcod = csgdtl.cmpcod
                                                               AND csgmst.csgdocnum = csgdtl.csgdocnum
                                                               AND csgmst.csgseqnum = csgdtl.csgseqnum
                                                               AND csgmst.poacod = csgdtl.poacod
                                INNER JOIN malmst malmst ON malmst.cmpcod = csgdtl.cmpcod
                                                            AND malmst.malseqnum = csgdtl.malseqnum
                                                            AND malmst.csgseqnum = csgdtl.csgseqnum
                                                            AND malmst.csgdocnum = csgdtl.csgdocnum
                                                            AND malmst.poacod = csgdtl.poacod
                                INNER JOIN malcsgrtg trt ON csgmst.cmpcod = trt.cmpcod
                                                            AND csgmst.csgdocnum = trt.csgdocnum
                                                            AND csgmst.csgseqnum = trt.csgseqnum
                                                            AND csgmst.poacod = trt.poacod
                            WHERE
                                csgmst.cmpcod = ?
                                AND trt.fltcaridr = ?
                               AND trt.fltnum = ?
                                 AND trt.fltseqnum = ?
                            GROUP BY
                                malmst.cmpcod,
                                trt.fltcaridr,
                                trt.fltnum,
                                trt.fltseqnum
                            ORDER BY
                                malmst.cmpcod,
                                trt.fltcaridr,
                                trt.fltnum,
                                trt.fltseqnum
			]]>
	</QRY:Source>
  </QRY:Definition>
	<QRY:Definition>
		<QRY:Id>618</QRY:Id>
		<QRY:Source Name="mail.operations.findflightsformailinboundautoattachawb" Type="NATIVE">
			<![CDATA[
				SELECT 
				  DISTINCT LEG.CMPCOD, 
					  LEG.FLTCARIDR,
					  LEG.FLTNUM,
					  LEG.FLTSEQNUM,
					  LEG.LEGSERNUM,
					  LEG.STA FLTDAT,
					  LEG.LEGDST ARPCOD,
					  LEG.LEGORG,
					  LEG.LEGDST,
					  ASGFLTSEG.POL,
					  ASGFLTSEG.POU,
					  LEG.STD,
				  LEG.STA, 
				  (
					SELECT 
					  (
						CASE WHEN APHCODUSE = 2 THEN TWOAPHCOD ELSE THRAPHCOD END
					  ) 
					FROM 
					  SHRARLMST 
					WHERE 
					  CMPCOD = ASGFLTSEG.CMPCOD 
					  AND ARLIDR = ASGFLTSEG.FLTCARIDR
				  ) FLTCARCOD 
				FROM 
				  MALFLTSEG ASGFLTSEG 
				  INNER JOIN FLTOPRLEG LEG ON ASGFLTSEG.CMPCOD = LEG.CMPCOD 
					AND ASGFLTSEG.FLTCARIDR = LEG.FLTCARIDR
					AND ASGFLTSEG.FLTNUM    = LEG.FLTNUM
					AND ASGFLTSEG.FLTSEQNUM = LEG.FLTSEQNUM
				WHERE 
				  ASGFLTSEG.CMPCOD = ? 
					AND ASGFLTSEG.POU       = LEG.LEGDST
				]]>
		</QRY:Source>
	</QRY:Definition>  
<QRY:Definition>
<QRY:Id>619</QRY:Id>
<QRY:Source Name="mail.operations.findMailBagMLDDetails" Type="NATIVE">
<![CDATA[
  SELECT MLD.CMPCOD,
  MST.MALIDR,
  MST.MALSEQNUM,
  MLD.TXNTIM SCNDATE,  
  'MLD' || MLD.EVTMOD MALSTA,
   CASE 
  WHEN OUBEVTTIM IS NULL
  THEN MLD.RCVARPCOD
  ELSE 
  MLD.SNDARPCOD
  END AS SCNPRT,
  CASE 
  WHEN OUBFLTNUM IS NULL
  THEN MLD.INBFLTNUM
  ELSE 
  MLD.OUBFLTNUM
  END AS FLTNUM,
  CASE 
  WHEN OUBFLTDAT IS NULL
  THEN MLD.INBFLTDAT
  ELSE 
  MLD.OUBFLTDAT
  END AS FLTDAT,
  MLD.CMPCOD,
  NULL CONNUM,
  NULL DSTARPCOD,
  NULL SCNUSR,
  MLD.TXNTIMUTC UTCSCNDAT,
  MLD.MSGTIMUTC MSGTIM, 
  MST.DSTEXGOFC,
  MST.DSN,
  MST.RSN,
  MST.WGT,
  MST.MALRMK,
  0 MALHISIDR,
  MST.POACOD,
  MST.MALCTG,
  MST.MALSUBCLS,
  MST.ORGEXGOFC,
  MST.YER,
  MST.REQDLVTIM,
  MST.ONNTIMDLVFLG,
  MST.ACTWGT,
  MST.MALSRVLVL,
  MST.ORGCOD ORG,
  MST.DSTCOD DST,
  MST.CSGDOCNUM,
  MST.DSPDAT CSGDAT,
  MST.TRPSRVENDTIM,
  MLD.INBFLTSEQNUM,
  MST.CONTYP,
  NULL ADDINF,
  'N' POAULDFLG,
  'JOB' MALSRC,
  MST.ACPPOACONNUM
  ,NULL STGUNT,
  NULL SCRUSR
FROM MALMLDMST MLD,
  MALMST MST
WHERE MLD.CMPCOD  = MST.CMPCOD
AND
MLD.MALSEQNUM  = MST.MALSEQNUM
AND MLD.CMPCOD    = ?
AND MLD.PROSTA = 'SND'
]]>
</QRY:Source>
<QRY:Extensions>
	        <QRY:Extension CompanyCode="DNATA">
	            <QRY:Token Name="addlCols">
	                          ,NULL STGUNT,NULL SCRUSR
	            </QRY:Token>
	        </QRY:Extension>
	        <QRY:Extension CompanyCode="4ALL">
	                       <QRY:Token Name="addlCols"/>
	        </QRY:Extension>
      </QRY:Extensions>
</QRY:Definition>
<QRY:Definition>
<QRY:Id>620</QRY:Id>
<QRY:Source Name="mail.operations.findmailtransitdetails" Type="NATIVE">
<![CDATA[
select
CMPCOD CMPCOD,
       FLTCARCOD FLTCARCOD,
       DSTCOD MALDSTCOD,
       count(malseqnum) TOTIMPMAL,
       sum(wgt) TOTIMPMALWGT,
       sum(case when tmp.NXTSECTPLNAVL IS NULL OR tmp.NXTSECTPLNAVL = 'N' then 1 else 0 end) NOTASGMALCNT,
       sum(case when tmp.NXTSECTPLNAVL IS NULL OR tmp.NXTSECTPLNAVL = 'N' then wgt else 0 end) NOTASGMALWGT
from
       (
       select
              
              segdtl.fltcaridr ,
              segdtl.fltnum ,
              segdtl.fltseqnum,
              arlmst.twoaphcod fltcarcod,
              mst.dstcod ,
              mst.malseqnum,
              mst.wgt,
              mst.cmpcod,
              (
              select
                     MAX('Y')
              from
                     maluldsegdtl uldseg
              inner join malfltseg malflt on
                     uldseg.cmpcod = malflt.cmpcod
                     and uldseg.fltcaridr = malflt.fltcaridr
                     and uldseg.fltnum = malflt.fltnum
                     and uldseg.fltseqnum = malflt.fltseqnum
                     and uldseg.segsernum = malflt.segsernum
                     and uldseg.malseqnum = segdtl.malseqnum
                     and uldseg.cmpcod = segdtl.cmpcod
                     and malflt.pol = seg.pou ) NXTSECTPLNAVL
       from
              maluldsegdtl segdtl
       inner join malmst mst on
              segdtl.cmpcod = mst.cmpcod
              and segdtl.malseqnum = mst.malseqnum
       inner join malfltseg seg on
              segdtl.cmpcod = seg.cmpcod
              and segdtl.fltcaridr = seg.fltcaridr
              and segdtl.fltnum = seg.fltnum
              and segdtl.fltseqnum = seg.fltseqnum
              and segdtl.segsernum = seg.segsernum          
       inner join fltoprleg fltleg on
              fltleg.cmpcod = segdtl.cmpcod
              and fltleg.fltnum = segdtl.fltnum
              and fltleg.fltcaridr = segdtl.fltcaridr
              and fltleg.fltseqnum = segdtl.fltseqnum
              and fltleg.legorg=seg.pol
              and mst.dstcod != seg.pou
       inner join shrarlmst arlmst on
              fltleg.cmpcod=arlmst.cmpcod
              and fltleg.fltcaridr=arlmst.arlidr
              where 
			  SEG.POU = ?
]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
<QRY:Id>622</QRY:Id>
<QRY:Source Name="mail.operations.findmailbagnotes" Type="NATIVE">
<![CDATA[
SELECT HISNOT.RMKSERNUM,HISNOT.RMK,HISNOT.RMKDAT,HISNOT.USRNAM
FROM MALHISNOT HISNOT,MALMST MST
WHERE HISNOT.MALSEQNUM = MST.MALSEQNUM
AND HISNOT.CMPCOD = MST.CMPCOD
AND MST.MALIDR= ?
ORDER BY HISNOT.RMKDAT DESC
]]>
</QRY:Source>
</QRY:Definition>

<QRY:Definition>
		<QRY:Id>623</QRY:Id>
		<QRY:Source Name="mail.operations.findMailbagDetailsForMailInboundHHT" Type="NATIVE">
		<![CDATA[
SELECT
MALSTA,
MALSEQNUM,
SCNDAT,
SCNPRT,
WGT,
FLTNUM,
TWOAPHCOD,
FLTDAT,
CONNUM,
POU,
ORGCOD,
DSTCOD,
ACTWGT,
ACTWGTDSP,
ACTWGTDSPUNT,
CSGDOCNUM,
CSGDAT,
REQDLVTIM,
SCNUSR,
MALRMK,
FLTCARIDR,
FLTSEQNUM,

%s
FROM

(SELECT

MST.MALSTA MALSTA,
MST.MALSEQNUM MALSEQNUM,
MST.SCNDAT SCNDAT,
MST.SCNPRT SCNPRT,
MST.WGT WGT,
MST.FLTNUM FLTNUM,
ARL.TWOAPHCOD TWOAPHCOD,
FLT.FLTDAT FLTDAT,
MST.CONNUM CONNUM,
MST.POU POU,
MST.ORGCOD ORGCOD,
MST.DSTCOD DSTCOD,
MST.ACTWGT ACTWGT,
MST.ACTWGTDSP ACTWGTDSP,
MST.ACTWGTDSPUNT ACTWGTDSPUNT,
MST.CSGDOCNUM CSGDOCNUM,
CSG.CSGDAT CSGDAT,
MST.REQDLVTIM REQDLVTIM,
MST.SCNUSR SCNUSR,
MST.MALRMK MALRMK,
MST.FLTSEQNUM FLTSEQNUM,
MST.FLTCARIDR FLTCARIDR,
RTG.FLTNUM as RTGFLTNUM,
RTG.FLTCARCOD AS RTGCARCOD,
RTG.FLTDAT AS RTGFLTDAT

FROM MALMST MST
      INNER JOIN MALULDSEGDTL DTL
ON MST.CMPCOD=DTL.CMPCOD
        AND MST.MALSEQNUM = DTL.MALSEQNUM LEFT
      OUTER JOIN FLTOPRSEG SEG
      ON DTL.CMPCOD  = SEG.CMPCOD
AND DTL.FLTNUM = SEG.FLTNUM
AND DTL.FLTCARIDR = SEG.FLTCARIDR
AND DTL.FLTSEQNUM = SEG.FLTSEQNUM
AND DTL.SEGSERNUM = SEG.SEGSERNUM 

LEFT OUTER JOIN MALCSGMST CSG
ON
MST.CMPCOD = CSG.CMPCOD AND
MST.POACOD = CSG.POACOD AND
MST.CSGDOCNUM = CSG.CSGDOCNUM AND
MST.CSGSEQNUM = CSG.CSGSEQNUM

LEFT OUTER JOIN FLTOPRMST FLT
ON
MST.FLTNUM = FLT.FLTNUM AND
MST.FLTCARIDR = FLT.FLTCARIDR AND
MST.FLTSEQNUM = FLT.FLTSEQNUM AND
MST.CMPCOD = FLT.CMPCOD

LEFT OUTER JOIN MALCSGRTG RTG
ON
MST.CMPCOD = RTG.CMPCOD AND
MST.POACOD = RTG.POACOD AND
MST.CSGDOCNUM = RTG.CSGDOCNUM AND
MST.CSGSEQNUM = RTG.CSGSEQNUM

LEFT OUTER JOIN SHRARLMST ARL
ON
MST.CMPCOD     = ARL.CMPCOD AND
MST.FLTCARIDR = ARL.ARLIDR

WHERE

MST.CMPCOD = ?
AND MST.MALIDR = ?
AND SEG.SEGDST = ?
AND MST.DSPDAT=(select MAX(DSPDAT) from MALMST where CMPCOD=? AND MALIDR=?)
)MST

GROUP BY
MALSTA,
MALSEQNUM,
SCNDAT,
SCNPRT,
WGT,
FLTNUM,
TWOAPHCOD,
FLTDAT,
CONNUM,
POU,
ORGCOD,
DSTCOD,
ACTWGT,
ACTWGTDSP,
ACTWGTDSPUNT,
CSGDOCNUM,
CSGDAT,
REQDLVTIM,
SCNUSR,
MALRMK,
FLTCARIDR,
FLTSEQNUM

         ]]>
		</QRY:Source>
	</QRY:Definition>
<QRY:Definition>
<QRY:Id>624</QRY:Id>
<QRY:Source Name="mail.operations.findMailConsumed" Type="NATIVE">
<![CDATA[
select SUM(malmst.wgt) totwgt, SUM(malmst.vol) totvol,MAX(malmst.fltnum) fltnum from 
 malmst malmst inner join  maluldsegdtl   malseg
 on malmst.cmpcod      = malseg.cmpcod
 and malmst.malseqnum  =  malseg.malseqnum
 inner join fltoprseg seg
 on seg.cmpcod      = malseg.cmpcod
 and seg.fltcaridr  =  malseg.fltcaridr 
 and seg.fltnum=malseg.fltnum
 and seg.fltseqnum  =  malseg.fltseqnum
 and seg.segsernum  =  malseg.segsernum
 inner join fltoprleg fltleg on
 fltleg.cmpcod = seg.cmpcod
 and fltleg.fltnum = seg.fltnum
 and fltleg.fltcaridr = seg.fltcaridr
 and fltleg.fltseqnum = seg.fltseqnum
 INNER JOIN shrarlmst arlmst
 ON fltleg.cmpcod    =arlmst.cmpcod
 AND fltleg.fltcaridr=arlmst.arlidr
 where to_number(TO_CHAR(fltleg.sta, 'YYYYMMDD')) >= ?
 and to_number(TO_CHAR(fltleg.sta, 'YYYYMMDD')) <= ?
 and seg.segorg=?
  AND seg.segdst=?
  AND arlmst.TWOAPHCOD=?
   ]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
	<QRY:Id>625</QRY:Id>
	<QRY:Source Name="mail.operation.findMailbagsForPAWBCreation"
		Type="NATIVE">
<![CDATA[
SELECT segdtl.malseqnum,
  csgmst.csgdstexgofccod ,
  csgmst.csgorgexgofccod,
  csgmst.SHPUPUCOD ,
  csgmst.cnsupucod,
  csddtl.scrdtltyp,
  csddtl.secscrmthcod,
  csddtl.scraplaut,
  csddtl.agttyp,
  csddtl.cntcod,
  csddtl.agtidr,
  csddtl.aplregbrdagyaut,
  csddtl.aplregrefidr,
  csddtl.aplregtrpdir,
  csddtl.aplregflg,
  csgrtg.pol,
  csgrtg.pou,
  csgrtg.fltnum,
  csgrtg.fltcarcod,
  csgrtg.fltcaridr,
  csgrtg.fltdat,
  csgrtg.fltseqnum,
  csgmst.poacod,
  csgmst.csgdocnum,
  csgmst.csgseqnum,
  mst.orgexgofc,
  mst.dstexgofc,
  mst.malsubcls,
  mst.malctg,
  mst.yer,
  mst.dsn,
  csgrtg.rtgsernum,
  csddtl.sernum,
  mst.cmpcod,
  cdtmst.cdtkey,
  cdttot.malcls,
  cdttot.numrcp,
  cdttot.rcpwgt,
   mst.malidr,
   csgmst.arpcod,
   csgmst.oprtyp,
   mst.docowridr,
  mst.dupnum,
  mst.seqnum,
  mst.wgt,
  mst.ctrnum,
  csddtl.cntcod,
  csddtl.expdat,
  csddtl.secstadat,
  csddtl.secstapty,
  csddtl.adlsecinf,
   csgmst.mstdocnum
FROM maluldsegdtl segdtl
INNER JOIN malmst mst
ON segdtl.cmpcod     = mst.cmpcod
AND segdtl.malseqnum =mst.malseqnum
INNER JOIN malcsgdtl csgdtl
ON csgdtl.cmpcod     =mst.cmpcod
AND csgdtl.malseqnum =mst.malseqnum
INNER JOIN malcsgmst csgmst
ON csgmst.cmpcod     =csgdtl.cmpcod
AND csgmst.csgdocnum =csgdtl.csgdocnum
AND csgmst.csgseqnum =csgdtl.csgseqnum
AND csgmst.poacod    =csgdtl.poacod
INNER JOIN malpoadtl poadtl
ON poadtl.cmpcod  =mst.cmpcod
AND poadtl.poacod =mst.poacod
AND poadtl.parcod ='PAWBASSCONENAB'
AND poadtl.parval ='YES'
AND segdtl.acpsta = 'Y'
INNER JOIN malcdtmst cdtmst
ON cdtmst.cmpcod = csgmst.cmpcod
AND cdtmst.csgdocnum = csgmst.csgdocnum
INNER JOIN malcdttot cdttot
ON cdtmst.cmpcod = cdttot.cmpcod
AND cdtmst.cdtkey = cdttot.cdtkey
LEFT OUTER JOIN malcsgrtg csgrtg
ON csgrtg.cmpcod     =csgmst.cmpcod
AND csgrtg.csgdocnum =csgmst.csgdocnum
AND csgrtg.csgseqnum =csgmst.csgseqnum
AND csgrtg.poacod    =csgmst.poacod
LEFT OUTER JOIN malcsgcsddtl csddtl
ON csddtl.cmpcod      =mst.cmpcod
AND csddtl.csgdocnum  =mst.csgdocnum
AND csddtl.csgseqnum  =mst.csgseqnum
AND csddtl.poacod     =mst.poacod
WHERE csddtl.scrlvl     = 'C'
AND mst.mstdocnum    IS NULL
AND csgmst.shpupucod IS NOT NULL
AND mst.dspdat        > CURRENT_DATE -?
GROUP BY segdtl.malseqnum,
  csgmst.csgdstexgofccod ,
  csgmst.csgorgexgofccod,
  csgmst.SHPUPUCOD ,
  csgmst.cnsupucod,
  csddtl.scrdtltyp,
  csddtl.secscrmthcod,
  csddtl.scraplaut,
  csddtl.agttyp,
  csddtl.cntcod,
  csddtl.agtidr,
  csddtl.aplregbrdagyaut,
  csddtl.aplregrefidr,
  csddtl.aplregtrpdir,
  csddtl.aplregflg,
  csgrtg.pol,
  csgrtg.pou,
  csgrtg.fltnum,
  csgrtg.fltcarcod,
  csgrtg.fltcaridr,
  csgrtg.fltdat,
  csgrtg.fltseqnum,
  csgmst.poacod,
  csgmst.csgdocnum,
  csgmst.csgseqnum,
  mst.orgexgofc,
  mst.dstexgofc,
  mst.malsubcls,
  mst.malctg,
  mst.yer,
  mst.dsn,
  csgrtg.rtgsernum,
  csddtl.sernum,
  mst.cmpcod,
  cdtmst.cdtkey,
  cdttot.malcls,
  cdttot.numrcp,
  cdttot.rcpwgt,
   mst.malidr,
   csgmst.arpcod,
   csgmst.oprtyp,
   mst.docowridr,
  mst.dupnum,
  mst.seqnum,
  mst.wgt,
  mst.ctrnum,
  csddtl.cntcod,
  csddtl.expdat,
  csddtl.secstadat,
  csddtl.secstapty,
  csddtl.adlsecinf,
   csgmst.mstdocnum
UNION ALL
SELECT arpdtl.malseqnum,
  csgmst.csgdstexgofccod ,
  csgmst.csgorgexgofccod,
  csgmst.SHPUPUCOD ,
  csgmst.cnsupucod ,
  csddtl.scrdtltyp,
  csddtl.secscrmthcod,
  csddtl.scraplaut,
  csddtl.agttyp,
  csddtl.cntcod,
  csddtl.agtidr,
  csddtl.aplregbrdagyaut,
  csddtl.aplregrefidr,
  csddtl.aplregtrpdir,
  csddtl.aplregflg,
  csgrtg.pol,
  csgrtg.pou,
  csgrtg.fltnum,
  csgrtg.fltcarcod,
  csgrtg.fltcaridr,
  csgrtg.fltdat,
  csgrtg.fltseqnum,
  csgmst.poacod,
  csgmst.csgdocnum,
  csgmst.csgseqnum,
  mst.orgexgofc,
  mst.dstexgofc,
  mst.malsubcls,
  mst.malctg,
  mst.yer,
  mst.dsn,
  csgrtg.rtgsernum,
  csddtl.sernum,
  mst.cmpcod,
  cdtmst.cdtkey,
  cdttot.malcls,
  cdttot.numrcp,
  cdttot.rcpwgt,
   mst.malidr,
   csgmst.arpcod,
   csgmst.oprtyp,
   mst.docowridr,
  mst.dupnum,
  mst.seqnum,
  mst.wgt,
  mst.ctrnum,
  csddtl.cntcod,
  csddtl.expdat,
  csddtl.secstadat,
  csddtl.secstapty,
  csddtl.adlsecinf,
   csgmst.mstdocnum
FROM malarpulddtl arpdtl
INNER JOIN malmst mst
ON arpdtl.cmpcod     = mst.cmpcod
AND arpdtl.malseqnum =mst.malseqnum
INNER JOIN malcsgdtl csgdtl
ON csgdtl.cmpcod     =mst.cmpcod
AND csgdtl.malseqnum =mst.malseqnum
INNER JOIN malcsgmst csgmst
ON csgmst.cmpcod     =csgdtl.cmpcod
AND csgmst.csgdocnum =csgdtl.csgdocnum
AND csgmst.csgseqnum =csgdtl.csgseqnum
AND csgmst.poacod    =csgdtl.poacod
INNER JOIN malpoadtl poadtl
ON poadtl.cmpcod  =mst.cmpcod
AND poadtl.poacod =mst.poacod
AND poadtl.parcod ='PAWBASSCONENAB'
AND poadtl.parval ='YES'
INNER JOIN malcdtmst cdtmst
ON cdtmst.cmpcod = csgmst.cmpcod
AND cdtmst.csgdocnum = csgmst.csgdocnum
INNER JOIN malcdttot cdttot
ON cdtmst.cmpcod = cdttot.cmpcod
AND cdtmst.cdtkey = cdttot.cdtkey
LEFT OUTER JOIN malcsgrtg csgrtg
ON csgrtg.cmpcod     =csgmst.cmpcod
AND csgrtg.csgdocnum =csgmst.csgdocnum
AND csgrtg.csgseqnum =csgmst.csgseqnum
AND csgrtg.poacod    =csgmst.poacod
LEFT OUTER JOIN malcsgcsddtl csddtl
ON csddtl.cmpcod      =mst.cmpcod
AND csddtl.csgdocnum  =mst.csgdocnum
AND csddtl.csgseqnum  =mst.csgseqnum
AND csddtl.poacod     =mst.poacod
WHERE csddtl.scrlvl     = 'C'
AND mst.mstdocnum    IS NULL
AND csgmst.shpupucod IS NOT NULL
AND mst.dspdat        > CURRENT_DATE -?
ORDER BY CSGDOCNUM,
  CSGSEQNUM,
  MALSEQNUM,
  POACOD,
  CMPCOD
]]>
	</QRY:Source>
</QRY:Definition>
<QRY:Definition>
		<QRY:Id>626</QRY:Id>
		<QRY:Source Name="mail.operations.findMstDocNumForAWBDetails" Type="NATIVE">
			<![CDATA[
					SELECT DISTINCT cmpcod,
					  docowridr,
					  mstdocnum,
					  dupnum,
					  seqnum,
					  shppfx
					FROM MALMST
					WHERE cmpcod  = ?
					AND csgdocnum    = ?
					AND csgseqnum = ?
					AND poacod = ?

		]]>
		</QRY:Source>
		</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>627</QRY:Id>
		<QRY:Source Name="mail.operations.findContainerDetailsForReassignCarrier" Type="NATIVE">
			<![CDATA[
					select
                MST.CMPCOD,
                MST.CONNUM,
                MST.FLTCARIDR,
                MST.FLTNUM,
                MST.FLTSEQNUM,
                MST.LEGSERNUM,
                (case
                    when MST.arrsta = 'Y' then MST.POU
                    else MST.ASGPRT
                end ) as ASGPRT,
                MST.ACPFLG,
                MST.POAFLG,
                MST.POU ,
                MST.RMK,
                MST.USRCOD,
                MST.ASGDAT,
                MST.DSTCOD,
                MST.CONTYP,
                MST.FLTCARCOD MSTFLTCARCOD,
                MST.SEGSERNUM,
                MST.OFLFLG,
                MST.ARRSTA,
                MST.TRAFLG,
                MST.LSTUPDTIM,
                MST.LSTUPDUSR,
                MST.CONJRNIDR,
                MST.POACOD SBCODE,
                MST.TRNFLG,
                MST.CNTIDR,
                MST.ACTULDWGT,
                MST.ACTULDWGTDSP,
                MST.ACTULDWGTDSPUNT,
                MST.ULDFULIND
            from
                MALFLTCON MST
            where
                MST.CMPCOD = ?
                and MST.CONNUM = ?
                and MST.ASGDAT = (
                select
                    MAX (ASGDAT)
                from
                    MALFLTCON
                where
                    CMPCOD = MST.CMPCOD
                    and CONNUM = MST.CONNUM
                    and ASGPRT = MST.ASGPRT)
                and MST.TXNCOD = 'ASG'
                and coalesce(MST.ARRSTA, 'N') = 'N'
                and MST.FLTNUM = '-1'
		]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>628</QRY:Id>
		<QRY:Source Name="mail.operations.findContainerDetailsForReassignFlight" Type="NATIVE">
			<![CDATA[
					select
                MST.CMPCOD,
                MST.CONNUM,
                MST.FLTCARIDR,
                MST.FLTNUM,
                MST.FLTSEQNUM,
                MST.LEGSERNUM,
                (case
                    when MST.arrsta = 'Y' then MST.POU
                    else MST.ASGPRT
                end ) as ASGPRT,
                MST.ACPFLG,
                MST.POAFLG,
                MST.POU ,
                MST.RMK,
                MST.USRCOD,
                MST.ASGDAT,
                MST.DSTCOD,
                MST.CONTYP,
                MST.FLTCARCOD MSTFLTCARCOD,
                MST.SEGSERNUM,
                MST.OFLFLG,
                MST.ARRSTA,
                MST.TRAFLG,
                MST.LSTUPDTIM,
                MST.LSTUPDUSR,
                MST.CONJRNIDR,
                MST.POACOD SBCODE,
                MST.TRNFLG,
                MST.CNTIDR,
                MST.ACTULDWGT,
                MST.ACTULDWGTDSP,
                MST.ACTULDWGTDSPUNT,
                MST.ULDFULIND
            from
                MALFLTCON MST
            inner join MALFLT ASG on
                MST.ASGPRT = ASG.ARPCOD
                and MST.CMPCOD = ASG.CMPCOD
                and MST.FLTCARIDR = ASG.FLTCARIDR
                and MST.FLTNUM = ASG.FLTNUM
                and MST.FLTSEQNUM = ASG.FLTSEQNUM
                and MST.ASGDATUTC =(
                select
                    MAX (ASGDATUTC)
                from
                    MALFLTCON
                where
                    CONNUM = MST.CONNUM
                    and CMPCOD = MST.CMPCOD )
                and MST.LEGSERNUM = ASG.LEGSERNUM
            where
                MST.CMPCOD = ?
                and MST.CONNUM = ?
                and MST.ASGDAT = (
                select
                    MAX (ASGDAT)
                from
                    MALFLTCON
                where
                    CMPCOD = MST.CMPCOD
                    and CONNUM = MST.CONNUM
                    and ASGPRT = MST.ASGPRT)
                and MST.TXNCOD = 'ASG'
                and coalesce(MST.ARRSTA, 'N') = 'N'
		]]>
		</QRY:Source>
	</QRY:Definition>
	<QRY:Definition>
		<QRY:Id>629</QRY:Id>
		<QRY:Source Name="mail.operations.findContainerDetailsForReassignFroupBy" Type="NATIVE">
			<![CDATA[
				 group by
                MST.CMPCOD,
                MST.CONNUM,
                MST.FLTCARIDR,
                MST.FLTNUM,
                MST.FLTSEQNUM,
                MST.LEGSERNUM,
                MST.ASGPRT,
                MST.ACPFLG,
                MST.POAFLG,
                MST.POU ,
                MST.RMK,
                MST.USRCOD,
                MST.ASGDAT,
                MST.DSTCOD,
                MST.CONTYP,
                MST.FLTCARCOD,
                MST.SEGSERNUM,
                MST.OFLFLG,
                MST.ARRSTA,
                MST.TRAFLG,
                MST.LSTUPDTIM,
                MST.LSTUPDUSR,
                MST.CONJRNIDR,
                MST.POACOD ,
                MST.TRNFLG,
                MST.LSTUPDTIM ,
                MST.LSTUPDUSR,
                MST.CNTIDR,
                MST.ACTULDWGT,
                MST.ACTULDWGTDSP ,
                MST.ACTULDWGTDSPUNT,
                MST.ULDFULIND,
                MST.ULDREFNUM
		]]>
		</QRY:Source>
	</QRY:Definition>
</QRY:Definitions>